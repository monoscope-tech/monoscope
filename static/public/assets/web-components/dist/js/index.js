var tm=(F,w)=>()=>(w||F((w={exports:{}}).exports,w),w.exports);var im=tm((exports,module)=>{(function(){const w=document.createElement("link").relList;if(w&&w.supports&&w.supports("modulepreload"))return;for(const W of document.querySelectorAll('link[rel="modulepreload"]'))O(W);new MutationObserver(W=>{for(const U of W)if(U.type==="childList")for(const K of U.addedNodes)K.tagName==="LINK"&&K.rel==="modulepreload"&&O(K)}).observe(document,{childList:!0,subtree:!0});function D(W){const U={};return W.integrity&&(U.integrity=W.integrity),W.referrerPolicy&&(U.referrerPolicy=W.referrerPolicy),W.crossOrigin==="use-credentials"?U.credentials="include":W.crossOrigin==="anonymous"?U.credentials="omit":U.credentials="same-origin",U}function O(W){if(W.ep)return;W.ep=!0;const U=D(W);fetch(W.href,U)}})();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$4=globalThis,e$6=t$4.ShadowRoot&&(t$4.ShadyCSS===void 0||t$4.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s$4=Symbol(),o$6=new WeakMap;let n$4=class{constructor(w,D,O){if(this._$cssResult$=!0,O!==s$4)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=w,this.t=D}get styleSheet(){let w=this.o;const D=this.t;if(e$6&&w===void 0){const O=D!==void 0&&D.length===1;O&&(w=o$6.get(D)),w===void 0&&((this.o=w=new CSSStyleSheet).replaceSync(this.cssText),O&&o$6.set(D,w))}return w}toString(){return this.cssText}};const r$6=F=>new n$4(typeof F=="string"?F:F+"",void 0,s$4),S$1=(F,w)=>{if(e$6)F.adoptedStyleSheets=w.map(D=>D instanceof CSSStyleSheet?D:D.styleSheet);else for(const D of w){const O=document.createElement("style"),W=t$4.litNonce;W!==void 0&&O.setAttribute("nonce",W),O.textContent=D.cssText,F.appendChild(O)}},c$4=e$6?F=>F:F=>F instanceof CSSStyleSheet?(w=>{let D="";for(const O of w.cssRules)D+=O.cssText;return r$6(D)})(F):F;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:i$5,defineProperty:e$5,getOwnPropertyDescriptor:h$3,getOwnPropertyNames:r$5,getOwnPropertySymbols:o$5,getPrototypeOf:n$3}=Object,a$1=globalThis,c$3=a$1.trustedTypes,l$1=c$3?c$3.emptyScript:"",p$2=a$1.reactiveElementPolyfillSupport,d$1=(F,w)=>F,u$3={toAttribute(F,w){switch(w){case Boolean:F=F?l$1:null;break;case Object:case Array:F=F==null?F:JSON.stringify(F)}return F},fromAttribute(F,w){let D=F;switch(w){case Boolean:D=F!==null;break;case Number:D=F===null?null:Number(F);break;case Object:case Array:try{D=JSON.parse(F)}catch{D=null}}return D}},f$3=(F,w)=>!i$5(F,w),b={attribute:!0,type:String,converter:u$3,reflect:!1,useDefault:!1,hasChanged:f$3};Symbol.metadata??=Symbol("metadata"),a$1.litPropertyMetadata??=new WeakMap;let y$1=class extends HTMLElement{static addInitializer(w){this._$Ei(),(this.l??=[]).push(w)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(w,D=b){if(D.state&&(D.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(w)&&((D=Object.create(D)).wrapped=!0),this.elementProperties.set(w,D),!D.noAccessor){const O=Symbol(),W=this.getPropertyDescriptor(w,O,D);W!==void 0&&e$5(this.prototype,w,W)}}static getPropertyDescriptor(w,D,O){const{get:W,set:U}=h$3(this.prototype,w)??{get(){return this[D]},set(K){this[D]=K}};return{get:W,set(K){const q=W?.call(this);U?.call(this,K),this.requestUpdate(w,q,O)},configurable:!0,enumerable:!0}}static getPropertyOptions(w){return this.elementProperties.get(w)??b}static _$Ei(){if(this.hasOwnProperty(d$1("elementProperties")))return;const w=n$3(this);w.finalize(),w.l!==void 0&&(this.l=[...w.l]),this.elementProperties=new Map(w.elementProperties)}static finalize(){if(this.hasOwnProperty(d$1("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d$1("properties"))){const D=this.properties,O=[...r$5(D),...o$5(D)];for(const W of O)this.createProperty(W,D[W])}const w=this[Symbol.metadata];if(w!==null){const D=litPropertyMetadata.get(w);if(D!==void 0)for(const[O,W]of D)this.elementProperties.set(O,W)}this._$Eh=new Map;for(const[D,O]of this.elementProperties){const W=this._$Eu(D,O);W!==void 0&&this._$Eh.set(W,D)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(w){const D=[];if(Array.isArray(w)){const O=new Set(w.flat(1/0).reverse());for(const W of O)D.unshift(c$4(W))}else w!==void 0&&D.push(c$4(w));return D}static _$Eu(w,D){const O=D.attribute;return O===!1?void 0:typeof O=="string"?O:typeof w=="string"?w.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(w=>this.enableUpdating=w),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(w=>w(this))}addController(w){(this._$EO??=new Set).add(w),this.renderRoot!==void 0&&this.isConnected&&w.hostConnected?.()}removeController(w){this._$EO?.delete(w)}_$E_(){const w=new Map,D=this.constructor.elementProperties;for(const O of D.keys())this.hasOwnProperty(O)&&(w.set(O,this[O]),delete this[O]);w.size>0&&(this._$Ep=w)}createRenderRoot(){const w=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return S$1(w,this.constructor.elementStyles),w}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(w=>w.hostConnected?.())}enableUpdating(w){}disconnectedCallback(){this._$EO?.forEach(w=>w.hostDisconnected?.())}attributeChangedCallback(w,D,O){this._$AK(w,O)}_$ET(w,D){const O=this.constructor.elementProperties.get(w),W=this.constructor._$Eu(w,O);if(W!==void 0&&O.reflect===!0){const U=(O.converter?.toAttribute!==void 0?O.converter:u$3).toAttribute(D,O.type);this._$Em=w,U==null?this.removeAttribute(W):this.setAttribute(W,U),this._$Em=null}}_$AK(w,D){const O=this.constructor,W=O._$Eh.get(w);if(W!==void 0&&this._$Em!==W){const U=O.getPropertyOptions(W),K=typeof U.converter=="function"?{fromAttribute:U.converter}:U.converter?.fromAttribute!==void 0?U.converter:u$3;this._$Em=W,this[W]=K.fromAttribute(D,U.type)??this._$Ej?.get(W)??null,this._$Em=null}}requestUpdate(w,D,O){if(w!==void 0){const W=this.constructor,U=this[w];if(O??=W.getPropertyOptions(w),!((O.hasChanged??f$3)(U,D)||O.useDefault&&O.reflect&&U===this._$Ej?.get(w)&&!this.hasAttribute(W._$Eu(w,O))))return;this.C(w,D,O)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(w,D,{useDefault:O,reflect:W,wrapped:U},K){O&&!(this._$Ej??=new Map).has(w)&&(this._$Ej.set(w,K??D??this[w]),U!==!0||K!==void 0)||(this._$AL.has(w)||(this.hasUpdated||O||(D=void 0),this._$AL.set(w,D)),W===!0&&this._$Em!==w&&(this._$Eq??=new Set).add(w))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(D){Promise.reject(D)}const w=this.scheduleUpdate();return w!=null&&await w,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[W,U]of this._$Ep)this[W]=U;this._$Ep=void 0}const O=this.constructor.elementProperties;if(O.size>0)for(const[W,U]of O){const{wrapped:K}=U,q=this[W];K!==!0||this._$AL.has(W)||q===void 0||this.C(W,void 0,U,q)}}let w=!1;const D=this._$AL;try{w=this.shouldUpdate(D),w?(this.willUpdate(D),this._$EO?.forEach(O=>O.hostUpdate?.()),this.update(D)):this._$EM()}catch(O){throw w=!1,this._$EM(),O}w&&this._$AE(D)}willUpdate(w){}_$AE(w){this._$EO?.forEach(D=>D.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(w)),this.updated(w)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(w){return!0}update(w){this._$Eq&&=this._$Eq.forEach(D=>this._$ET(D,this[D])),this._$EM()}updated(w){}firstUpdated(w){}};y$1.elementStyles=[],y$1.shadowRootOptions={mode:"open"},y$1[d$1("elementProperties")]=new Map,y$1[d$1("finalized")]=new Map,p$2?.({ReactiveElement:y$1}),(a$1.reactiveElementVersions??=[]).push("2.1.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$3=globalThis,i$4=t$3.trustedTypes,s$3=i$4?i$4.createPolicy("lit-html",{createHTML:F=>F}):void 0,e$4="$lit$",h$2=`lit$${Math.random().toFixed(9).slice(2)}$`,o$4="?"+h$2,n$2=`<${o$4}>`,r$4=document,l=()=>r$4.createComment(""),c$2=F=>F===null||typeof F!="object"&&typeof F!="function",a=Array.isArray,u$2=F=>a(F)||typeof F?.[Symbol.iterator]=="function",d=`[ 	
\f\r]`,f$2=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,v$1=/-->/g,_=/>/g,m$1=RegExp(`>|${d}(?:([^\\s"'>=/]+)(${d}*=${d}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),p$1=/'/g,g=/"/g,$$9=/^(?:script|style|textarea|title)$/i,y=F=>(w,...D)=>({_$litType$:F,strings:w,values:D}),x=y(1),T=Symbol.for("lit-noChange"),E=Symbol.for("lit-nothing"),A=new WeakMap,C=r$4.createTreeWalker(r$4,129);function P(F,w){if(!a(F)||!F.hasOwnProperty("raw"))throw Error("invalid template strings array");return s$3!==void 0?s$3.createHTML(w):w}const V=(F,w)=>{const D=F.length-1,O=[];let W,U=w===2?"<svg>":w===3?"<math>":"",K=f$2;for(let q=0;q<D;q++){const G=F[q];let Q,Y,X=-1,J=0;for(;J<G.length&&(K.lastIndex=J,Y=K.exec(G),Y!==null);)J=K.lastIndex,K===f$2?Y[1]==="!--"?K=v$1:Y[1]!==void 0?K=_:Y[2]!==void 0?($$9.test(Y[2])&&(W=RegExp("</"+Y[2],"g")),K=m$1):Y[3]!==void 0&&(K=m$1):K===m$1?Y[0]===">"?(K=W??f$2,X=-1):Y[1]===void 0?X=-2:(X=K.lastIndex-Y[2].length,Q=Y[1],K=Y[3]===void 0?m$1:Y[3]==='"'?g:p$1):K===g||K===p$1?K=m$1:K===v$1||K===_?K=f$2:(K=m$1,W=void 0);const te=K===m$1&&F[q+1].startsWith("/>")?" ":"";U+=K===f$2?G+n$2:X>=0?(O.push(Q),G.slice(0,X)+e$4+G.slice(X)+h$2+te):G+h$2+(X===-2?q:te)}return[P(F,U+(F[D]||"<?>")+(w===2?"</svg>":w===3?"</math>":"")),O]};class N{constructor({strings:w,_$litType$:D},O){let W;this.parts=[];let U=0,K=0;const q=w.length-1,G=this.parts,[Q,Y]=V(w,D);if(this.el=N.createElement(Q,O),C.currentNode=this.el.content,D===2||D===3){const X=this.el.content.firstChild;X.replaceWith(...X.childNodes)}for(;(W=C.nextNode())!==null&&G.length<q;){if(W.nodeType===1){if(W.hasAttributes())for(const X of W.getAttributeNames())if(X.endsWith(e$4)){const J=Y[K++],te=W.getAttribute(X).split(h$2),ie=/([.?@])?(.*)/.exec(J);G.push({type:1,index:U,name:ie[2],strings:te,ctor:ie[1]==="."?H:ie[1]==="?"?I:ie[1]==="@"?L:k}),W.removeAttribute(X)}else X.startsWith(h$2)&&(G.push({type:6,index:U}),W.removeAttribute(X));if($$9.test(W.tagName)){const X=W.textContent.split(h$2),J=X.length-1;if(J>0){W.textContent=i$4?i$4.emptyScript:"";for(let te=0;te<J;te++)W.append(X[te],l()),C.nextNode(),G.push({type:2,index:++U});W.append(X[J],l())}}}else if(W.nodeType===8)if(W.data===o$4)G.push({type:2,index:U});else{let X=-1;for(;(X=W.data.indexOf(h$2,X+1))!==-1;)G.push({type:7,index:U}),X+=h$2.length-1}U++}}static createElement(w,D){const O=r$4.createElement("template");return O.innerHTML=w,O}}function S(F,w,D=F,O){if(w===T)return w;let W=O!==void 0?D._$Co?.[O]:D._$Cl;const U=c$2(w)?void 0:w._$litDirective$;return W?.constructor!==U&&(W?._$AO?.(!1),U===void 0?W=void 0:(W=new U(F),W._$AT(F,D,O)),O!==void 0?(D._$Co??=[])[O]=W:D._$Cl=W),W!==void 0&&(w=S(F,W._$AS(F,w.values),W,O)),w}let M$1=class{constructor(w,D){this._$AV=[],this._$AN=void 0,this._$AD=w,this._$AM=D}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(w){const{el:{content:D},parts:O}=this._$AD,W=(w?.creationScope??r$4).importNode(D,!0);C.currentNode=W;let U=C.nextNode(),K=0,q=0,G=O[0];for(;G!==void 0;){if(K===G.index){let Q;G.type===2?Q=new R(U,U.nextSibling,this,w):G.type===1?Q=new G.ctor(U,G.name,G.strings,this,w):G.type===6&&(Q=new z(U,this,w)),this._$AV.push(Q),G=O[++q]}K!==G?.index&&(U=C.nextNode(),K++)}return C.currentNode=r$4,W}p(w){let D=0;for(const O of this._$AV)O!==void 0&&(O.strings!==void 0?(O._$AI(w,O,D),D+=O.strings.length-2):O._$AI(w[D])),D++}};class R{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(w,D,O,W){this.type=2,this._$AH=E,this._$AN=void 0,this._$AA=w,this._$AB=D,this._$AM=O,this.options=W,this._$Cv=W?.isConnected??!0}get parentNode(){let w=this._$AA.parentNode;const D=this._$AM;return D!==void 0&&w?.nodeType===11&&(w=D.parentNode),w}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(w,D=this){w=S(this,w,D),c$2(w)?w===E||w==null||w===""?(this._$AH!==E&&this._$AR(),this._$AH=E):w!==this._$AH&&w!==T&&this._(w):w._$litType$!==void 0?this.$(w):w.nodeType!==void 0?this.T(w):u$2(w)?this.k(w):this._(w)}O(w){return this._$AA.parentNode.insertBefore(w,this._$AB)}T(w){this._$AH!==w&&(this._$AR(),this._$AH=this.O(w))}_(w){this._$AH!==E&&c$2(this._$AH)?this._$AA.nextSibling.data=w:this.T(r$4.createTextNode(w)),this._$AH=w}$(w){const{values:D,_$litType$:O}=w,W=typeof O=="number"?this._$AC(w):(O.el===void 0&&(O.el=N.createElement(P(O.h,O.h[0]),this.options)),O);if(this._$AH?._$AD===W)this._$AH.p(D);else{const U=new M$1(W,this),K=U.u(this.options);U.p(D),this.T(K),this._$AH=U}}_$AC(w){let D=A.get(w.strings);return D===void 0&&A.set(w.strings,D=new N(w)),D}k(w){a(this._$AH)||(this._$AH=[],this._$AR());const D=this._$AH;let O,W=0;for(const U of w)W===D.length?D.push(O=new R(this.O(l()),this.O(l()),this,this.options)):O=D[W],O._$AI(U),W++;W<D.length&&(this._$AR(O&&O._$AB.nextSibling,W),D.length=W)}_$AR(w=this._$AA.nextSibling,D){for(this._$AP?.(!1,!0,D);w&&w!==this._$AB;){const O=w.nextSibling;w.remove(),w=O}}setConnected(w){this._$AM===void 0&&(this._$Cv=w,this._$AP?.(w))}}class k{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(w,D,O,W,U){this.type=1,this._$AH=E,this._$AN=void 0,this.element=w,this.name=D,this._$AM=W,this.options=U,O.length>2||O[0]!==""||O[1]!==""?(this._$AH=Array(O.length-1).fill(new String),this.strings=O):this._$AH=E}_$AI(w,D=this,O,W){const U=this.strings;let K=!1;if(U===void 0)w=S(this,w,D,0),K=!c$2(w)||w!==this._$AH&&w!==T,K&&(this._$AH=w);else{const q=w;let G,Q;for(w=U[0],G=0;G<U.length-1;G++)Q=S(this,q[O+G],D,G),Q===T&&(Q=this._$AH[G]),K||=!c$2(Q)||Q!==this._$AH[G],Q===E?w=E:w!==E&&(w+=(Q??"")+U[G+1]),this._$AH[G]=Q}K&&!W&&this.j(w)}j(w){w===E?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,w??"")}}class H extends k{constructor(){super(...arguments),this.type=3}j(w){this.element[this.name]=w===E?void 0:w}}class I extends k{constructor(){super(...arguments),this.type=4}j(w){this.element.toggleAttribute(this.name,!!w&&w!==E)}}class L extends k{constructor(w,D,O,W,U){super(w,D,O,W,U),this.type=5}_$AI(w,D=this){if((w=S(this,w,D,0)??E)===T)return;const O=this._$AH,W=w===E&&O!==E||w.capture!==O.capture||w.once!==O.once||w.passive!==O.passive,U=w!==E&&(O===E||W);W&&this.element.removeEventListener(this.name,this,O),U&&this.element.addEventListener(this.name,this,w),this._$AH=w}handleEvent(w){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,w):this._$AH.handleEvent(w)}}class z{constructor(w,D,O){this.element=w,this.type=6,this._$AN=void 0,this._$AM=D,this.options=O}get _$AU(){return this._$AM._$AU}_$AI(w){S(this,w)}}const Z={I:R},j=t$3.litHtmlPolyfillSupport;j?.(N,R),(t$3.litHtmlVersions??=[]).push("3.3.0");const B=(F,w,D)=>{const O=D?.renderBefore??w;let W=O._$litPart$;if(W===void 0){const U=D?.renderBefore??null;O._$litPart$=W=new R(w.insertBefore(l(),U),U,void 0,D??{})}return W._$AI(F),W};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const s$2=globalThis;let i$3=class extends y$1{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const w=super.createRenderRoot();return this.renderOptions.renderBefore??=w.firstChild,w}update(w){const D=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(w),this._$Do=B(D,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return T}};i$3._$litElement$=!0,i$3.finalized=!0,s$2.litElementHydrateSupport?.({LitElement:i$3});const o$3=s$2.litElementPolyfillSupport;o$3?.({LitElement:i$3});(s$2.litElementVersions??=[]).push("4.2.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$2=F=>(w,D)=>{D!==void 0?D.addInitializer(()=>{customElements.define(F,w)}):customElements.define(F,w)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const o$2={attribute:!0,type:String,converter:u$3,reflect:!1,hasChanged:f$3},r$3=(F=o$2,w,D)=>{const{kind:O,metadata:W}=D;let U=globalThis.litPropertyMetadata.get(W);if(U===void 0&&globalThis.litPropertyMetadata.set(W,U=new Map),O==="setter"&&((F=Object.create(F)).wrapped=!0),U.set(D.name,F),O==="accessor"){const{name:K}=D;return{set(q){const G=w.get.call(this);w.set.call(this,q),this.requestUpdate(K,G,F)},init(q){return q!==void 0&&this.C(K,void 0,F,q),q}}}if(O==="setter"){const{name:K}=D;return function(q){const G=this[K];w.call(this,q),this.requestUpdate(K,G,F)}}throw Error("Unsupported decorator location: "+O)};function n$1(F){return(w,D)=>typeof D=="object"?r$3(F,w,D):((O,W,U)=>{const K=W.hasOwnProperty(U);return W.constructor.createProperty(U,O),K?Object.getOwnPropertyDescriptor(W,U):void 0})(F,w,D)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function r$2(F){return n$1({...F,state:!0,attribute:!1})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const e$3=(F,w,D)=>(D.configurable=!0,D.enumerable=!0,Reflect.decorate&&typeof w!="object"&&Object.defineProperty(F,w,D),D);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function e$2(F,w){return(D,O,W)=>{const U=K=>K.renderRoot?.querySelector(F)??null;return e$3(D,O,{get(){return U(this)}})}}function ensureCodeWindow(F,w){const D=F;typeof D.vscodeWindowId!="number"&&Object.defineProperty(D,"vscodeWindowId",{get:()=>w})}const mainWindow=window;class WindowManager{constructor(){this.mapWindowIdToZoomFactor=new Map}static{this.INSTANCE=new WindowManager}getZoomFactor(w){return this.mapWindowIdToZoomFactor.get(this.getWindowId(w))??1}getWindowId(w){return w.vscodeWindowId}}function addMatchMediaChangeListener(F,w,D){typeof w=="string"&&(w=F.matchMedia(w)),w.addEventListener("change",D)}function getZoomFactor(F){return WindowManager.INSTANCE.getZoomFactor(F)}const userAgent$1=navigator.userAgent,isFirefox$1=userAgent$1.indexOf("Firefox")>=0,isWebKit=userAgent$1.indexOf("AppleWebKit")>=0,isChrome$1=userAgent$1.indexOf("Chrome")>=0,isSafari$1=!isChrome$1&&userAgent$1.indexOf("Safari")>=0,isWebkitWebView=!isChrome$1&&!isSafari$1&&isWebKit;userAgent$1.indexOf("Electron/")>=0;const isAndroid$1=userAgent$1.indexOf("Android")>=0;let standalone=!1;if(typeof mainWindow.matchMedia=="function"){const F=mainWindow.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),w=mainWindow.matchMedia("(display-mode: fullscreen)");standalone=F.matches,addMatchMediaChangeListener(mainWindow,F,({matches:D})=>{standalone&&w.matches||(standalone=D)})}function getDefaultExportFromCjs$1(F){return F&&F.__esModule&&Object.prototype.hasOwnProperty.call(F,"default")?F.default:F}var browser={exports:{}},process=browser.exports={},cachedSetTimeout,cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?cachedSetTimeout=setTimeout:cachedSetTimeout=defaultSetTimout}catch{cachedSetTimeout=defaultSetTimout}try{typeof clearTimeout=="function"?cachedClearTimeout=clearTimeout:cachedClearTimeout=defaultClearTimeout}catch{cachedClearTimeout=defaultClearTimeout}})();function runTimeout(F){if(cachedSetTimeout===setTimeout)return setTimeout(F,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(F,0);try{return cachedSetTimeout(F,0)}catch{try{return cachedSetTimeout.call(null,F,0)}catch{return cachedSetTimeout.call(this,F,0)}}}function runClearTimeout(F){if(cachedClearTimeout===clearTimeout)return clearTimeout(F);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(F);try{return cachedClearTimeout(F)}catch{try{return cachedClearTimeout.call(null,F)}catch{return cachedClearTimeout.call(this,F)}}}var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){!draining||!currentQueue||(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var F=runTimeout(cleanUpNextTick);draining=!0;for(var w=queue.length;w;){for(currentQueue=queue,queue=[];++queueIndex<w;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,w=queue.length}currentQueue=null,draining=!1,runClearTimeout(F)}}process.nextTick=function(F){var w=new Array(arguments.length-1);if(arguments.length>1)for(var D=1;D<arguments.length;D++)w[D-1]=arguments[D];queue.push(new Item(F,w)),queue.length===1&&!draining&&runTimeout(drainQueue)};function Item(F,w){this.fun=F,this.array=w}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=!0;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(F){return[]};process.binding=function(F){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(F){throw new Error("process.chdir is not supported")};process.umask=function(){return 0};var browserExports=browser.exports;const process$1=getDefaultExportFromCjs$1(browserExports);function getNLSMessages(){return globalThis._VSCODE_NLS_MESSAGES}function getNLSLanguage(){return globalThis._VSCODE_NLS_LANGUAGE}const isPseudo=getNLSLanguage()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function _format$1(F,w){let D;return w.length===0?D=F:D=F.replace(/\{(\d+)\}/g,(O,W)=>{const U=W[0],K=w[U];let q=O;return typeof K=="string"?q=K:(typeof K=="number"||typeof K=="boolean"||K===void 0||K===null)&&(q=String(K)),q}),isPseudo&&(D="［"+D.replace(/[aouei]/g,"$&$&")+"］"),D}function localize(F,w,...D){return _format$1(typeof F=="number"?lookupMessage(F,w):w,D)}function lookupMessage(F,w){const D=getNLSMessages()?.[F];if(typeof D!="string"){if(typeof w=="string")return w;throw new Error(`!!! NLS MISSING: ${F} !!!`)}return D}const LANGUAGE_DEFAULT="en";let _isWindows=!1,_isMacintosh=!1,_isLinux=!1,_isNative=!1,_isWeb=!1,_isIOS=!1,_isMobile=!1,_locale,_language=LANGUAGE_DEFAULT,_platformLocale=LANGUAGE_DEFAULT,_translationsConfigFile,_userAgent;const $globalThis=globalThis;let nodeProcess;typeof $globalThis.vscode<"u"&&typeof $globalThis.vscode.process<"u"?nodeProcess=$globalThis.vscode.process:typeof process$1<"u"&&typeof process$1?.versions?.node=="string"&&(nodeProcess=process$1);const isElectronProcess=typeof nodeProcess?.versions?.electron=="string",isElectronRenderer=isElectronProcess&&nodeProcess?.type==="renderer";if(typeof nodeProcess=="object"){_isWindows=nodeProcess.platform==="win32",_isMacintosh=nodeProcess.platform==="darwin",_isLinux=nodeProcess.platform==="linux",_isLinux&&nodeProcess.env.SNAP&&nodeProcess.env.SNAP_REVISION,nodeProcess.env.CI||nodeProcess.env.BUILD_ARTIFACTSTAGINGDIRECTORY,_locale=LANGUAGE_DEFAULT,_language=LANGUAGE_DEFAULT;const F=nodeProcess.env.VSCODE_NLS_CONFIG;if(F)try{const w=JSON.parse(F);_locale=w.userLocale,_platformLocale=w.osLocale,_language=w.resolvedLanguage||LANGUAGE_DEFAULT,_translationsConfigFile=w.languagePack?.translationsConfigFile}catch{}_isNative=!0}else typeof navigator=="object"&&!isElectronRenderer?(_userAgent=navigator.userAgent,_isWindows=_userAgent.indexOf("Windows")>=0,_isMacintosh=_userAgent.indexOf("Macintosh")>=0,_isIOS=(_userAgent.indexOf("Macintosh")>=0||_userAgent.indexOf("iPad")>=0||_userAgent.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,_isLinux=_userAgent.indexOf("Linux")>=0,_isMobile=_userAgent?.indexOf("Mobi")>=0,_isWeb=!0,_language=getNLSLanguage()||LANGUAGE_DEFAULT,_locale=navigator.language.toLowerCase(),_platformLocale=_locale):console.error("Unable to resolve platform.");const isWindows=_isWindows,isMacintosh=_isMacintosh,isLinux=_isLinux,isNative=_isNative,isWeb=_isWeb,isWebWorker=_isWeb&&typeof $globalThis.importScripts=="function",webWorkerOrigin=isWebWorker?$globalThis.origin:void 0,isIOS=_isIOS,isMobile=_isMobile,userAgent=_userAgent,setTimeout0IsFaster=typeof $globalThis.postMessage=="function"&&!$globalThis.importScripts,setTimeout0=(()=>{if(setTimeout0IsFaster){const F=[];$globalThis.addEventListener("message",D=>{if(D.data&&D.data.vscodeScheduleAsyncWork)for(let O=0,W=F.length;O<W;O++){const U=F[O];if(U.id===D.data.vscodeScheduleAsyncWork){F.splice(O,1),U.callback();return}}});let w=0;return D=>{const O=++w;F.push({id:O,callback:D}),$globalThis.postMessage({vscodeScheduleAsyncWork:O},"*")}}return F=>setTimeout(F)})(),OS=_isMacintosh||_isIOS?2:_isWindows?1:3;let _isLittleEndian=!0,_isLittleEndianComputed=!1;function isLittleEndian(){if(!_isLittleEndianComputed){_isLittleEndianComputed=!0;const F=new Uint8Array(2);F[0]=1,F[1]=2,_isLittleEndian=new Uint16Array(F.buffer)[0]===513}return _isLittleEndian}const isChrome=!!(userAgent&&userAgent.indexOf("Chrome")>=0),isFirefox=!!(userAgent&&userAgent.indexOf("Firefox")>=0),isSafari=!!(!isChrome&&userAgent&&userAgent.indexOf("Safari")>=0),isEdge=!!(userAgent&&userAgent.indexOf("Edg/")>=0),isAndroid=!!(userAgent&&userAgent.indexOf("Android")>=0),BrowserFeatures={clipboard:{writeText:isNative||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:isNative||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},pointerEvents:mainWindow.PointerEvent&&("ontouchstart"in mainWindow||navigator.maxTouchPoints>0)};class KeyCodeStrMap{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(w,D){this._keyCodeToStr[w]=D,this._strToKeyCode[D.toLowerCase()]=w}keyCodeToStr(w){return this._keyCodeToStr[w]}strToKeyCode(w){return this._strToKeyCode[w.toLowerCase()]||0}}const uiMap=new KeyCodeStrMap,userSettingsUSMap=new KeyCodeStrMap,userSettingsGeneralMap=new KeyCodeStrMap,EVENT_KEY_CODE_MAP=new Array(230),scanCodeStrToInt=Object.create(null),scanCodeLowerCaseStrToInt=Object.create(null),IMMUTABLE_CODE_TO_KEY_CODE=[];for(let F=0;F<=193;F++)IMMUTABLE_CODE_TO_KEY_CODE[F]=-1;(function(){const F="",w=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",F,F],[1,1,"Hyper",0,F,0,F,F,F],[1,2,"Super",0,F,0,F,F,F],[1,3,"Fn",0,F,0,F,F,F],[1,4,"FnLock",0,F,0,F,F,F],[1,5,"Suspend",0,F,0,F,F,F],[1,6,"Resume",0,F,0,F,F,F],[1,7,"Turbo",0,F,0,F,F,F],[1,8,"Sleep",0,F,0,"VK_SLEEP",F,F],[1,9,"WakeUp",0,F,0,F,F,F],[0,10,"KeyA",31,"A",65,"VK_A",F,F],[0,11,"KeyB",32,"B",66,"VK_B",F,F],[0,12,"KeyC",33,"C",67,"VK_C",F,F],[0,13,"KeyD",34,"D",68,"VK_D",F,F],[0,14,"KeyE",35,"E",69,"VK_E",F,F],[0,15,"KeyF",36,"F",70,"VK_F",F,F],[0,16,"KeyG",37,"G",71,"VK_G",F,F],[0,17,"KeyH",38,"H",72,"VK_H",F,F],[0,18,"KeyI",39,"I",73,"VK_I",F,F],[0,19,"KeyJ",40,"J",74,"VK_J",F,F],[0,20,"KeyK",41,"K",75,"VK_K",F,F],[0,21,"KeyL",42,"L",76,"VK_L",F,F],[0,22,"KeyM",43,"M",77,"VK_M",F,F],[0,23,"KeyN",44,"N",78,"VK_N",F,F],[0,24,"KeyO",45,"O",79,"VK_O",F,F],[0,25,"KeyP",46,"P",80,"VK_P",F,F],[0,26,"KeyQ",47,"Q",81,"VK_Q",F,F],[0,27,"KeyR",48,"R",82,"VK_R",F,F],[0,28,"KeyS",49,"S",83,"VK_S",F,F],[0,29,"KeyT",50,"T",84,"VK_T",F,F],[0,30,"KeyU",51,"U",85,"VK_U",F,F],[0,31,"KeyV",52,"V",86,"VK_V",F,F],[0,32,"KeyW",53,"W",87,"VK_W",F,F],[0,33,"KeyX",54,"X",88,"VK_X",F,F],[0,34,"KeyY",55,"Y",89,"VK_Y",F,F],[0,35,"KeyZ",56,"Z",90,"VK_Z",F,F],[0,36,"Digit1",22,"1",49,"VK_1",F,F],[0,37,"Digit2",23,"2",50,"VK_2",F,F],[0,38,"Digit3",24,"3",51,"VK_3",F,F],[0,39,"Digit4",25,"4",52,"VK_4",F,F],[0,40,"Digit5",26,"5",53,"VK_5",F,F],[0,41,"Digit6",27,"6",54,"VK_6",F,F],[0,42,"Digit7",28,"7",55,"VK_7",F,F],[0,43,"Digit8",29,"8",56,"VK_8",F,F],[0,44,"Digit9",30,"9",57,"VK_9",F,F],[0,45,"Digit0",21,"0",48,"VK_0",F,F],[1,46,"Enter",3,"Enter",13,"VK_RETURN",F,F],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",F,F],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",F,F],[1,49,"Tab",2,"Tab",9,"VK_TAB",F,F],[1,50,"Space",10,"Space",32,"VK_SPACE",F,F],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,F,0,F,F,F],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",F,F],[1,64,"F1",59,"F1",112,"VK_F1",F,F],[1,65,"F2",60,"F2",113,"VK_F2",F,F],[1,66,"F3",61,"F3",114,"VK_F3",F,F],[1,67,"F4",62,"F4",115,"VK_F4",F,F],[1,68,"F5",63,"F5",116,"VK_F5",F,F],[1,69,"F6",64,"F6",117,"VK_F6",F,F],[1,70,"F7",65,"F7",118,"VK_F7",F,F],[1,71,"F8",66,"F8",119,"VK_F8",F,F],[1,72,"F9",67,"F9",120,"VK_F9",F,F],[1,73,"F10",68,"F10",121,"VK_F10",F,F],[1,74,"F11",69,"F11",122,"VK_F11",F,F],[1,75,"F12",70,"F12",123,"VK_F12",F,F],[1,76,"PrintScreen",0,F,0,F,F,F],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",F,F],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",F,F],[1,79,"Insert",19,"Insert",45,"VK_INSERT",F,F],[1,80,"Home",14,"Home",36,"VK_HOME",F,F],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",F,F],[1,82,"Delete",20,"Delete",46,"VK_DELETE",F,F],[1,83,"End",13,"End",35,"VK_END",F,F],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",F,F],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",F],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",F],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",F],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",F],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",F,F],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",F,F],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",F,F],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",F,F],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",F,F],[1,94,"NumpadEnter",3,F,0,F,F,F],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",F,F],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",F,F],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",F,F],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",F,F],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",F,F],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",F,F],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",F,F],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",F,F],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",F,F],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",F,F],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",F,F],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",F,F],[1,107,"ContextMenu",58,"ContextMenu",93,F,F,F],[1,108,"Power",0,F,0,F,F,F],[1,109,"NumpadEqual",0,F,0,F,F,F],[1,110,"F13",71,"F13",124,"VK_F13",F,F],[1,111,"F14",72,"F14",125,"VK_F14",F,F],[1,112,"F15",73,"F15",126,"VK_F15",F,F],[1,113,"F16",74,"F16",127,"VK_F16",F,F],[1,114,"F17",75,"F17",128,"VK_F17",F,F],[1,115,"F18",76,"F18",129,"VK_F18",F,F],[1,116,"F19",77,"F19",130,"VK_F19",F,F],[1,117,"F20",78,"F20",131,"VK_F20",F,F],[1,118,"F21",79,"F21",132,"VK_F21",F,F],[1,119,"F22",80,"F22",133,"VK_F22",F,F],[1,120,"F23",81,"F23",134,"VK_F23",F,F],[1,121,"F24",82,"F24",135,"VK_F24",F,F],[1,122,"Open",0,F,0,F,F,F],[1,123,"Help",0,F,0,F,F,F],[1,124,"Select",0,F,0,F,F,F],[1,125,"Again",0,F,0,F,F,F],[1,126,"Undo",0,F,0,F,F,F],[1,127,"Cut",0,F,0,F,F,F],[1,128,"Copy",0,F,0,F,F,F],[1,129,"Paste",0,F,0,F,F,F],[1,130,"Find",0,F,0,F,F,F],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",F,F],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",F,F],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",F,F],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",F,F],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",F,F],[1,136,"KanaMode",0,F,0,F,F,F],[0,137,"IntlYen",0,F,0,F,F,F],[1,138,"Convert",0,F,0,F,F,F],[1,139,"NonConvert",0,F,0,F,F,F],[1,140,"Lang1",0,F,0,F,F,F],[1,141,"Lang2",0,F,0,F,F,F],[1,142,"Lang3",0,F,0,F,F,F],[1,143,"Lang4",0,F,0,F,F,F],[1,144,"Lang5",0,F,0,F,F,F],[1,145,"Abort",0,F,0,F,F,F],[1,146,"Props",0,F,0,F,F,F],[1,147,"NumpadParenLeft",0,F,0,F,F,F],[1,148,"NumpadParenRight",0,F,0,F,F,F],[1,149,"NumpadBackspace",0,F,0,F,F,F],[1,150,"NumpadMemoryStore",0,F,0,F,F,F],[1,151,"NumpadMemoryRecall",0,F,0,F,F,F],[1,152,"NumpadMemoryClear",0,F,0,F,F,F],[1,153,"NumpadMemoryAdd",0,F,0,F,F,F],[1,154,"NumpadMemorySubtract",0,F,0,F,F,F],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",F,F],[1,156,"NumpadClearEntry",0,F,0,F,F,F],[1,0,F,5,"Ctrl",17,"VK_CONTROL",F,F],[1,0,F,4,"Shift",16,"VK_SHIFT",F,F],[1,0,F,6,"Alt",18,"VK_MENU",F,F],[1,0,F,57,"Meta",91,"VK_COMMAND",F,F],[1,157,"ControlLeft",5,F,0,"VK_LCONTROL",F,F],[1,158,"ShiftLeft",4,F,0,"VK_LSHIFT",F,F],[1,159,"AltLeft",6,F,0,"VK_LMENU",F,F],[1,160,"MetaLeft",57,F,0,"VK_LWIN",F,F],[1,161,"ControlRight",5,F,0,"VK_RCONTROL",F,F],[1,162,"ShiftRight",4,F,0,"VK_RSHIFT",F,F],[1,163,"AltRight",6,F,0,"VK_RMENU",F,F],[1,164,"MetaRight",57,F,0,"VK_RWIN",F,F],[1,165,"BrightnessUp",0,F,0,F,F,F],[1,166,"BrightnessDown",0,F,0,F,F,F],[1,167,"MediaPlay",0,F,0,F,F,F],[1,168,"MediaRecord",0,F,0,F,F,F],[1,169,"MediaFastForward",0,F,0,F,F,F],[1,170,"MediaRewind",0,F,0,F,F,F],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",F,F],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",F,F],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",F,F],[1,174,"Eject",0,F,0,F,F,F],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",F,F],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",F,F],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",F,F],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",F,F],[1,179,"LaunchApp1",0,F,0,"VK_MEDIA_LAUNCH_APP1",F,F],[1,180,"SelectTask",0,F,0,F,F,F],[1,181,"LaunchScreenSaver",0,F,0,F,F,F],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",F,F],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",F,F],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",F,F],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",F,F],[1,186,"BrowserStop",0,F,0,"VK_BROWSER_STOP",F,F],[1,187,"BrowserRefresh",0,F,0,"VK_BROWSER_REFRESH",F,F],[1,188,"BrowserFavorites",0,F,0,"VK_BROWSER_FAVORITES",F,F],[1,189,"ZoomToggle",0,F,0,F,F,F],[1,190,"MailReply",0,F,0,F,F,F],[1,191,"MailForward",0,F,0,F,F,F],[1,192,"MailSend",0,F,0,F,F,F],[1,0,F,114,"KeyInComposition",229,F,F,F],[1,0,F,116,"ABNT_C2",194,"VK_ABNT_C2",F,F],[1,0,F,96,"OEM_8",223,"VK_OEM_8",F,F],[1,0,F,0,F,0,"VK_KANA",F,F],[1,0,F,0,F,0,"VK_HANGUL",F,F],[1,0,F,0,F,0,"VK_JUNJA",F,F],[1,0,F,0,F,0,"VK_FINAL",F,F],[1,0,F,0,F,0,"VK_HANJA",F,F],[1,0,F,0,F,0,"VK_KANJI",F,F],[1,0,F,0,F,0,"VK_CONVERT",F,F],[1,0,F,0,F,0,"VK_NONCONVERT",F,F],[1,0,F,0,F,0,"VK_ACCEPT",F,F],[1,0,F,0,F,0,"VK_MODECHANGE",F,F],[1,0,F,0,F,0,"VK_SELECT",F,F],[1,0,F,0,F,0,"VK_PRINT",F,F],[1,0,F,0,F,0,"VK_EXECUTE",F,F],[1,0,F,0,F,0,"VK_SNAPSHOT",F,F],[1,0,F,0,F,0,"VK_HELP",F,F],[1,0,F,0,F,0,"VK_APPS",F,F],[1,0,F,0,F,0,"VK_PROCESSKEY",F,F],[1,0,F,0,F,0,"VK_PACKET",F,F],[1,0,F,0,F,0,"VK_DBE_SBCSCHAR",F,F],[1,0,F,0,F,0,"VK_DBE_DBCSCHAR",F,F],[1,0,F,0,F,0,"VK_ATTN",F,F],[1,0,F,0,F,0,"VK_CRSEL",F,F],[1,0,F,0,F,0,"VK_EXSEL",F,F],[1,0,F,0,F,0,"VK_EREOF",F,F],[1,0,F,0,F,0,"VK_PLAY",F,F],[1,0,F,0,F,0,"VK_ZOOM",F,F],[1,0,F,0,F,0,"VK_NONAME",F,F],[1,0,F,0,F,0,"VK_PA1",F,F],[1,0,F,0,F,0,"VK_OEM_CLEAR",F,F]],D=[],O=[];for(const W of w){const[U,K,q,G,Q,Y,X,J,te]=W;if(O[K]||(O[K]=!0,scanCodeStrToInt[q]=K,scanCodeLowerCaseStrToInt[q.toLowerCase()]=K,U&&(IMMUTABLE_CODE_TO_KEY_CODE[K]=G)),!D[G]){if(D[G]=!0,!Q)throw new Error(`String representation missing for key code ${G} around scan code ${q}`);uiMap.define(G,Q),userSettingsUSMap.define(G,J||Q),userSettingsGeneralMap.define(G,te||J||Q)}Y&&(EVENT_KEY_CODE_MAP[Y]=G)}})();var KeyCodeUtils;(function(F){function w(q){return uiMap.keyCodeToStr(q)}F.toString=w;function D(q){return uiMap.strToKeyCode(q)}F.fromString=D;function O(q){return userSettingsUSMap.keyCodeToStr(q)}F.toUserSettingsUS=O;function W(q){return userSettingsGeneralMap.keyCodeToStr(q)}F.toUserSettingsGeneral=W;function U(q){return userSettingsUSMap.strToKeyCode(q)||userSettingsGeneralMap.strToKeyCode(q)}F.fromUserSettings=U;function K(q){if(q>=98&&q<=113)return null;switch(q){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return uiMap.keyCodeToStr(q)}F.toElectronAccelerator=K})(KeyCodeUtils||(KeyCodeUtils={}));function KeyChord(F,w){const D=(w&65535)<<16>>>0;return(F|D)>>>0}class ErrorHandler{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(w){setTimeout(()=>{throw w.stack?ErrorNoTelemetry.isErrorNoTelemetry(w)?new ErrorNoTelemetry(w.message+`

`+w.stack):new Error(w.message+`

`+w.stack):w},0)}}emit(w){this.listeners.forEach(D=>{D(w)})}onUnexpectedError(w){this.unexpectedErrorHandler(w),this.emit(w)}onUnexpectedExternalError(w){this.unexpectedErrorHandler(w)}}const errorHandler=new ErrorHandler;function onUnexpectedError(F){isCancellationError(F)||errorHandler.onUnexpectedError(F)}function onUnexpectedExternalError(F){isCancellationError(F)||errorHandler.onUnexpectedExternalError(F)}function transformErrorForSerialization(F){if(F instanceof Error){const{name:w,message:D}=F,O=F.stacktrace||F.stack;return{$isError:!0,name:w,message:D,stack:O,noTelemetry:ErrorNoTelemetry.isErrorNoTelemetry(F)}}return F}const canceledName="Canceled";function isCancellationError(F){return F instanceof CancellationError?!0:F instanceof Error&&F.name===canceledName&&F.message===canceledName}class CancellationError extends Error{constructor(){super(canceledName),this.name=this.message}}function canceled(){const F=new Error(canceledName);return F.name=F.message,F}function illegalArgument(F){return F?new Error(`Illegal argument: ${F}`):new Error("Illegal argument")}function illegalState(F){return F?new Error(`Illegal state: ${F}`):new Error("Illegal state")}class NotSupportedError extends Error{constructor(w){super("NotSupported"),w&&(this.message=w)}}class ErrorNoTelemetry extends Error{constructor(w){super(w),this.name="CodeExpectedError"}static fromError(w){if(w instanceof ErrorNoTelemetry)return w;const D=new ErrorNoTelemetry;return D.message=w.message,D.stack=w.stack,D}static isErrorNoTelemetry(w){return w.name==="CodeExpectedError"}}class BugIndicatingError extends Error{constructor(w){super(w||"An unexpected bug occurred."),Object.setPrototypeOf(this,BugIndicatingError.prototype)}}function decodeKeybinding(F,w){if(typeof F=="number"){if(F===0)return null;const D=(F&65535)>>>0,O=(F&4294901760)>>>16;return O!==0?new Keybinding([createSimpleKeybinding(D,w),createSimpleKeybinding(O,w)]):new Keybinding([createSimpleKeybinding(D,w)])}else{const D=[];for(let O=0;O<F.length;O++)D.push(createSimpleKeybinding(F[O],w));return new Keybinding(D)}}function createSimpleKeybinding(F,w){const D=!!(F&2048),O=!!(F&256),W=w===2?O:D,U=!!(F&1024),K=!!(F&512),q=w===2?D:O,G=F&255;return new KeyCodeChord(W,U,K,q,G)}class KeyCodeChord{constructor(w,D,O,W,U){this.ctrlKey=w,this.shiftKey=D,this.altKey=O,this.metaKey=W,this.keyCode=U}equals(w){return w instanceof KeyCodeChord&&this.ctrlKey===w.ctrlKey&&this.shiftKey===w.shiftKey&&this.altKey===w.altKey&&this.metaKey===w.metaKey&&this.keyCode===w.keyCode}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}}class Keybinding{constructor(w){if(w.length===0)throw illegalArgument("chords");this.chords=w}}class ResolvedChord{constructor(w,D,O,W,U,K){this.ctrlKey=w,this.shiftKey=D,this.altKey=O,this.metaKey=W,this.keyLabel=U,this.keyAriaLabel=K}}class ResolvedKeybinding{}function extractKeyCode(F){if(F.charCode){const D=String.fromCharCode(F.charCode).toUpperCase();return KeyCodeUtils.fromString(D)}const w=F.keyCode;if(w===3)return 7;if(isFirefox$1)switch(w){case 59:return 85;case 60:if(isLinux)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(isMacintosh)return 57;break}else if(isWebKit){if(isMacintosh&&w===93)return 57;if(!isMacintosh&&w===92)return 57}return EVENT_KEY_CODE_MAP[w]||0}const ctrlKeyMod$1=isMacintosh?256:2048,altKeyMod=512,shiftKeyMod=1024,metaKeyMod=isMacintosh?2048:256;class StandardKeyboardEvent{constructor(w){this._standardKeyboardEventBrand=!0;const D=w;this.browserEvent=D,this.target=D.target,this.ctrlKey=D.ctrlKey,this.shiftKey=D.shiftKey,this.altKey=D.altKey,this.metaKey=D.metaKey,this.altGraphKey=D.getModifierState?.("AltGraph"),this.keyCode=extractKeyCode(D),this.code=D.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(w){return this._asKeybinding===w}_computeKeybinding(){let w=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(w=this.keyCode);let D=0;return this.ctrlKey&&(D|=ctrlKeyMod$1),this.altKey&&(D|=altKeyMod),this.shiftKey&&(D|=shiftKeyMod),this.metaKey&&(D|=metaKeyMod),D|=w,D}_computeKeyCodeChord(){let w=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(w=this.keyCode),new KeyCodeChord(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,w)}}const sameOriginWindowChainCache=new WeakMap;function getParentWindowIfSameOrigin(F){if(!F.parent||F.parent===F)return null;try{const w=F.location,D=F.parent.location;if(w.origin!=="null"&&D.origin!=="null"&&w.origin!==D.origin)return null}catch{return null}return F.parent}class IframeUtils{static getSameOriginWindowChain(w){let D=sameOriginWindowChainCache.get(w);if(!D){D=[],sameOriginWindowChainCache.set(w,D);let O=w,W;do W=getParentWindowIfSameOrigin(O),W?D.push({window:new WeakRef(O),iframeElement:O.frameElement||null}):D.push({window:new WeakRef(O),iframeElement:null}),O=W;while(O)}return D.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(w,D){if(!D||w===D)return{top:0,left:0};let O=0,W=0;const U=this.getSameOriginWindowChain(w);for(const K of U){const q=K.window.deref();if(O+=q?.scrollY??0,W+=q?.scrollX??0,q===D||!K.iframeElement)break;const G=K.iframeElement.getBoundingClientRect();O+=G.top,W+=G.left}return{top:O,left:W}}}class StandardMouseEvent{constructor(w,D){this.timestamp=Date.now(),this.browserEvent=D,this.leftButton=D.button===0,this.middleButton=D.button===1,this.rightButton=D.button===2,this.buttons=D.buttons,this.target=D.target,this.detail=D.detail||1,D.type==="dblclick"&&(this.detail=2),this.ctrlKey=D.ctrlKey,this.shiftKey=D.shiftKey,this.altKey=D.altKey,this.metaKey=D.metaKey,typeof D.pageX=="number"?(this.posx=D.pageX,this.posy=D.pageY):(this.posx=D.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=D.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);const O=IframeUtils.getPositionOfChildWindowRelativeToAncestorWindow(w,D.view);this.posx-=O.left,this.posy-=O.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class StandardWheelEvent{constructor(w,D=0,O=0){this.browserEvent=w||null,this.target=w?w.target||w.targetNode||w.srcElement:null,this.deltaY=O,this.deltaX=D;let W=!1;if(isChrome$1){const U=navigator.userAgent.match(/Chrome\/(\d+)/);W=(U?parseInt(U[1]):123)<=122}if(w){const U=w,K=w,q=w.view?.devicePixelRatio||1;if(typeof U.wheelDeltaY<"u")W?this.deltaY=U.wheelDeltaY/(120*q):this.deltaY=U.wheelDeltaY/120;else if(typeof K.VERTICAL_AXIS<"u"&&K.axis===K.VERTICAL_AXIS)this.deltaY=-K.detail/3;else if(w.type==="wheel"){const G=w;G.deltaMode===G.DOM_DELTA_LINE?isFirefox$1&&!isMacintosh?this.deltaY=-w.deltaY/3:this.deltaY=-w.deltaY:this.deltaY=-w.deltaY/40}if(typeof U.wheelDeltaX<"u")isSafari$1&&isWindows?this.deltaX=-(U.wheelDeltaX/120):W?this.deltaX=U.wheelDeltaX/(120*q):this.deltaX=U.wheelDeltaX/120;else if(typeof K.HORIZONTAL_AXIS<"u"&&K.axis===K.HORIZONTAL_AXIS)this.deltaX=-w.detail/3;else if(w.type==="wheel"){const G=w;G.deltaMode===G.DOM_DELTA_LINE?isFirefox$1&&!isMacintosh?this.deltaX=-w.deltaX/3:this.deltaX=-w.deltaX:this.deltaX=-w.deltaX/40}this.deltaY===0&&this.deltaX===0&&w.wheelDelta&&(W?this.deltaY=w.wheelDelta/(120*q):this.deltaY=w.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}}function createSingleCallFunction(F,w){const D=this;let O=!1,W;return function(){return O||(O=!0,W=F.apply(D,arguments)),W}}var Iterable;(function(F){function w(oe){return oe&&typeof oe=="object"&&typeof oe[Symbol.iterator]=="function"}F.is=w;const D=Object.freeze([]);function O(){return D}F.empty=O;function*W(oe){yield oe}F.single=W;function U(oe){return w(oe)?oe:W(oe)}F.wrap=U;function K(oe){return oe||D}F.from=K;function*q(oe){for(let ue=oe.length-1;ue>=0;ue--)yield oe[ue]}F.reverse=q;function G(oe){return!oe||oe[Symbol.iterator]().next().done===!0}F.isEmpty=G;function Q(oe){return oe[Symbol.iterator]().next().value}F.first=Q;function Y(oe,ue){let pe=0;for(const fe of oe)if(ue(fe,pe++))return!0;return!1}F.some=Y;function X(oe,ue){for(const pe of oe)if(ue(pe))return pe}F.find=X;function*J(oe,ue){for(const pe of oe)ue(pe)&&(yield pe)}F.filter=J;function*te(oe,ue){let pe=0;for(const fe of oe)yield ue(fe,pe++)}F.map=te;function*ie(oe,ue){let pe=0;for(const fe of oe)yield*ue(fe,pe++)}F.flatMap=ie;function*se(...oe){for(const ue of oe)yield*ue}F.concat=se;function re(oe,ue,pe){let fe=pe;for(const Ce of oe)fe=ue(fe,Ce);return fe}F.reduce=re;function*ae(oe,ue,pe=oe.length){for(ue<0&&(ue+=oe.length),pe<0?pe+=oe.length:pe>oe.length&&(pe=oe.length);ue<pe;ue++)yield oe[ue]}F.slice=ae;function le(oe,ue=Number.POSITIVE_INFINITY){const pe=[];if(ue===0)return[pe,oe];const fe=oe[Symbol.iterator]();for(let Ce=0;Ce<ue;Ce++){const we=fe.next();if(we.done)return[pe,F.empty()];pe.push(we.value)}return[pe,{[Symbol.iterator](){return fe}}]}F.consume=le;async function de(oe){const ue=[];for await(const pe of oe)ue.push(pe);return Promise.resolve(ue)}F.asyncToArray=de})(Iterable||(Iterable={}));function trackDisposable(F){return F}function setParentOfDisposable(F,w){}function markAsSingleton(F){return F}function isDisposable(F){return typeof F=="object"&&F!==null&&typeof F.dispose=="function"&&F.dispose.length===0}function dispose(F){if(Iterable.is(F)){const w=[];for(const D of F)if(D)try{D.dispose()}catch(O){w.push(O)}if(w.length===1)throw w[0];if(w.length>1)throw new AggregateError(w,"Encountered errors while disposing of store");return Array.isArray(F)?[]:F}else if(F)return F.dispose(),F}function combinedDisposable(...F){return toDisposable(()=>dispose(F))}function toDisposable(F){return{dispose:createSingleCallFunction(()=>{F()})}}class DisposableStore{static{this.DISABLE_DISPOSED_WARNING=!1}constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{dispose(this._toDispose)}finally{this._toDispose.clear()}}add(w){if(!w)return w;if(w===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?DisposableStore.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(w),w}deleteAndLeak(w){w&&this._toDispose.has(w)&&this._toDispose.delete(w)}}class Disposable{static{this.None=Object.freeze({dispose(){}})}constructor(){this._store=new DisposableStore,this._store}dispose(){this._store.dispose()}_register(w){if(w===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(w)}}class MutableDisposable{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(w){this._isDisposed||w===this._value||(this._value?.dispose(),this._value=w)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}}class ImmortalReference{constructor(w){this.object=w}dispose(){}}class DisposableMap{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{dispose(this._store.values())}finally{this._store.clear()}}get(w){return this._store.get(w)}set(w,D,O=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),O||this._store.get(w)?.dispose(),this._store.set(w,D)}deleteAndDispose(w){this._store.get(w)?.dispose(),this._store.delete(w)}[Symbol.iterator](){return this._store[Symbol.iterator]()}}let Node$2=class Dr{static{this.Undefined=new Dr(void 0)}constructor(w){this.element=w,this.next=Dr.Undefined,this.prev=Dr.Undefined}};class LinkedList{constructor(){this._first=Node$2.Undefined,this._last=Node$2.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Node$2.Undefined}clear(){let w=this._first;for(;w!==Node$2.Undefined;){const D=w.next;w.prev=Node$2.Undefined,w.next=Node$2.Undefined,w=D}this._first=Node$2.Undefined,this._last=Node$2.Undefined,this._size=0}unshift(w){return this._insert(w,!1)}push(w){return this._insert(w,!0)}_insert(w,D){const O=new Node$2(w);if(this._first===Node$2.Undefined)this._first=O,this._last=O;else if(D){const U=this._last;this._last=O,O.prev=U,U.next=O}else{const U=this._first;this._first=O,O.next=U,U.prev=O}this._size+=1;let W=!1;return()=>{W||(W=!0,this._remove(O))}}shift(){if(this._first!==Node$2.Undefined){const w=this._first.element;return this._remove(this._first),w}}pop(){if(this._last!==Node$2.Undefined){const w=this._last.element;return this._remove(this._last),w}}_remove(w){if(w.prev!==Node$2.Undefined&&w.next!==Node$2.Undefined){const D=w.prev;D.next=w.next,w.next.prev=D}else w.prev===Node$2.Undefined&&w.next===Node$2.Undefined?(this._first=Node$2.Undefined,this._last=Node$2.Undefined):w.next===Node$2.Undefined?(this._last=this._last.prev,this._last.next=Node$2.Undefined):w.prev===Node$2.Undefined&&(this._first=this._first.next,this._first.prev=Node$2.Undefined);this._size-=1}*[Symbol.iterator](){let w=this._first;for(;w!==Node$2.Undefined;)yield w.element,w=w.next}}const hasPerformanceNow=globalThis.performance&&typeof globalThis.performance.now=="function";class StopWatch{static create(w){return new StopWatch(w)}constructor(w){this._now=hasPerformanceNow&&w===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var Event$1;(function(F){F.None=()=>Disposable.None;function w(Me,Ne){return J(Me,()=>{},0,void 0,!0,void 0,Ne)}F.defer=w;function D(Me){return(Ne,ze=null,Qe)=>{let Ye=!1,Je;return Je=Me(at=>{if(!Ye)return Je?Je.dispose():Ye=!0,Ne.call(ze,at)},null,Qe),Ye&&Je.dispose(),Je}}F.once=D;function O(Me,Ne){return F.once(F.filter(Me,Ne))}F.onceIf=O;function W(Me,Ne,ze){return Y((Qe,Ye=null,Je)=>Me(at=>Qe.call(Ye,Ne(at)),null,Je),ze)}F.map=W;function U(Me,Ne,ze){return Y((Qe,Ye=null,Je)=>Me(at=>{Ne(at),Qe.call(Ye,at)},null,Je),ze)}F.forEach=U;function K(Me,Ne,ze){return Y((Qe,Ye=null,Je)=>Me(at=>Ne(at)&&Qe.call(Ye,at),null,Je),ze)}F.filter=K;function q(Me){return Me}F.signal=q;function G(...Me){return(Ne,ze=null,Qe)=>{const Ye=combinedDisposable(...Me.map(Je=>Je(at=>Ne.call(ze,at))));return X(Ye,Qe)}}F.any=G;function Q(Me,Ne,ze,Qe){let Ye=ze;return W(Me,Je=>(Ye=Ne(Ye,Je),Ye),Qe)}F.reduce=Q;function Y(Me,Ne){let ze;const Qe={onWillAddFirstListener(){ze=Me(Ye.fire,Ye)},onDidRemoveLastListener(){ze?.dispose()}},Ye=new Emitter$1(Qe);return Ne?.add(Ye),Ye.event}function X(Me,Ne){return Ne instanceof Array?Ne.push(Me):Ne&&Ne.add(Me),Me}function J(Me,Ne,ze=100,Qe=!1,Ye=!1,Je,at){let st,lt,Tt,Ke=0,je;const et={leakWarningThreshold:Je,onWillAddFirstListener(){st=Me(Mt=>{Ke++,lt=Ne(lt,Mt),Qe&&!Tt&&(mt.fire(lt),lt=void 0),je=()=>{const Et=lt;lt=void 0,Tt=void 0,(!Qe||Ke>1)&&mt.fire(Et),Ke=0},typeof ze=="number"?(clearTimeout(Tt),Tt=setTimeout(je,ze)):Tt===void 0&&(Tt=0,queueMicrotask(je))})},onWillRemoveListener(){Ye&&Ke>0&&je?.()},onDidRemoveLastListener(){je=void 0,st.dispose()}},mt=new Emitter$1(et);return at?.add(mt),mt.event}F.debounce=J;function te(Me,Ne=0,ze){return F.debounce(Me,(Qe,Ye)=>Qe?(Qe.push(Ye),Qe):[Ye],Ne,void 0,!0,void 0,ze)}F.accumulate=te;function ie(Me,Ne=(Qe,Ye)=>Qe===Ye,ze){let Qe=!0,Ye;return K(Me,Je=>{const at=Qe||!Ne(Je,Ye);return Qe=!1,Ye=Je,at},ze)}F.latch=ie;function se(Me,Ne,ze){return[F.filter(Me,Ne,ze),F.filter(Me,Qe=>!Ne(Qe),ze)]}F.split=se;function re(Me,Ne=!1,ze=[],Qe){let Ye=ze.slice(),Je=Me(lt=>{Ye?Ye.push(lt):st.fire(lt)});Qe&&Qe.add(Je);const at=()=>{Ye?.forEach(lt=>st.fire(lt)),Ye=null},st=new Emitter$1({onWillAddFirstListener(){Je||(Je=Me(lt=>st.fire(lt)),Qe&&Qe.add(Je))},onDidAddFirstListener(){Ye&&(Ne?setTimeout(at):at())},onDidRemoveLastListener(){Je&&Je.dispose(),Je=null}});return Qe&&Qe.add(st),st.event}F.buffer=re;function ae(Me,Ne){return(Qe,Ye,Je)=>{const at=Ne(new de);return Me(function(st){const lt=at.evaluate(st);lt!==le&&Qe.call(Ye,lt)},void 0,Je)}}F.chain=ae;const le=Symbol("HaltChainable");class de{constructor(){this.steps=[]}map(Ne){return this.steps.push(Ne),this}forEach(Ne){return this.steps.push(ze=>(Ne(ze),ze)),this}filter(Ne){return this.steps.push(ze=>Ne(ze)?ze:le),this}reduce(Ne,ze){let Qe=ze;return this.steps.push(Ye=>(Qe=Ne(Qe,Ye),Qe)),this}latch(Ne=(ze,Qe)=>ze===Qe){let ze=!0,Qe;return this.steps.push(Ye=>{const Je=ze||!Ne(Ye,Qe);return ze=!1,Qe=Ye,Je?Ye:le}),this}evaluate(Ne){for(const ze of this.steps)if(Ne=ze(Ne),Ne===le)break;return Ne}}function oe(Me,Ne,ze=Qe=>Qe){const Qe=(...st)=>at.fire(ze(...st)),Ye=()=>Me.on(Ne,Qe),Je=()=>Me.removeListener(Ne,Qe),at=new Emitter$1({onWillAddFirstListener:Ye,onDidRemoveLastListener:Je});return at.event}F.fromNodeEventEmitter=oe;function ue(Me,Ne,ze=Qe=>Qe){const Qe=(...st)=>at.fire(ze(...st)),Ye=()=>Me.addEventListener(Ne,Qe),Je=()=>Me.removeEventListener(Ne,Qe),at=new Emitter$1({onWillAddFirstListener:Ye,onDidRemoveLastListener:Je});return at.event}F.fromDOMEventEmitter=ue;function pe(Me){return new Promise(Ne=>D(Me)(Ne))}F.toPromise=pe;function fe(Me){const Ne=new Emitter$1;return Me.then(ze=>{Ne.fire(ze)},()=>{Ne.fire(void 0)}).finally(()=>{Ne.dispose()}),Ne.event}F.fromPromise=fe;function Ce(Me,Ne){return Me(ze=>Ne.fire(ze))}F.forward=Ce;function we(Me,Ne,ze){return Ne(ze),Me(Qe=>Ne(Qe))}F.runAndSubscribe=we;class Oe{constructor(Ne,ze){this._observable=Ne,this._counter=0,this._hasChanged=!1;const Qe={onWillAddFirstListener:()=>{Ne.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{Ne.removeObserver(this)}};this.emitter=new Emitter$1(Qe),ze&&ze.add(this.emitter)}beginUpdate(Ne){this._counter++}handlePossibleChange(Ne){}handleChange(Ne,ze){this._hasChanged=!0}endUpdate(Ne){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function Te(Me,Ne){return new Oe(Me,Ne).emitter.event}F.fromObservable=Te;function Re(Me){return(Ne,ze,Qe)=>{let Ye=0,Je=!1;const at={beginUpdate(){Ye++},endUpdate(){Ye--,Ye===0&&(Me.reportChanges(),Je&&(Je=!1,Ne.call(ze)))},handlePossibleChange(){},handleChange(){Je=!0}};Me.addObserver(at),Me.reportChanges();const st={dispose(){Me.removeObserver(at)}};return Qe instanceof DisposableStore?Qe.add(st):Array.isArray(Qe)&&Qe.push(st),st}}F.fromObservableLight=Re})(Event$1||(Event$1={}));class EventProfiling{static{this.all=new Set}static{this._idPool=0}constructor(w){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${w}_${EventProfiling._idPool++}`,EventProfiling.all.add(this)}start(w){this._stopWatch=new StopWatch,this.listenerCount=w}stop(){if(this._stopWatch){const w=this._stopWatch.elapsed();this.durations.push(w),this.elapsedOverall+=w,this.invocationCount+=1,this._stopWatch=void 0}}}let _globalLeakWarningThreshold=-1;class LeakageMonitor{static{this._idPool=1}constructor(w,D,O=(LeakageMonitor._idPool++).toString(16).padStart(3,"0")){this._errorHandler=w,this.threshold=D,this.name=O,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(w,D){const O=this.threshold;if(O<=0||D<O)return;this._stacks||(this._stacks=new Map);const W=this._stacks.get(w.value)||0;if(this._stacks.set(w.value,W+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=O*.5;const[U,K]=this.getMostFrequentStack(),q=`[${this.name}] potential listener LEAK detected, having ${D} listeners already. MOST frequent listener (${K}):`;console.warn(q),console.warn(U);const G=new ListenerLeakError(q,U);this._errorHandler(G)}return()=>{const U=this._stacks.get(w.value)||0;this._stacks.set(w.value,U-1)}}getMostFrequentStack(){if(!this._stacks)return;let w,D=0;for(const[O,W]of this._stacks)(!w||D<W)&&(w=[O,W],D=W);return w}}class Stacktrace{static create(){const w=new Error;return new Stacktrace(w.stack??"")}constructor(w){this.value=w}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class ListenerLeakError extends Error{constructor(w,D){super(w),this.name="ListenerLeakError",this.stack=D}}class ListenerRefusalError extends Error{constructor(w,D){super(w),this.name="ListenerRefusalError",this.stack=D}}class UniqueContainer{constructor(w){this.value=w}}const compactionThreshold=2;let Emitter$1=class{constructor(w){this._size=0,this._options=w,this._leakageMon=this._options?.leakWarningThreshold?new LeakageMonitor(w?.onListenerError??onUnexpectedError,this._options?.leakWarningThreshold??_globalLeakWarningThreshold):void 0,this._perfMon=this._options?._profName?new EventProfiling(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){this._disposed||(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose())}get event(){return this._event??=(w,D,O)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const q=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(q);const G=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],Q=new ListenerRefusalError(`${q}. HINT: Stack shows most frequent listener (${G[1]}-times)`,G[0]);return(this._options?.onListenerError||onUnexpectedError)(Q),Disposable.None}if(this._disposed)return Disposable.None;D&&(w=w.bind(D));const W=new UniqueContainer(w);let U;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(W.stack=Stacktrace.create(),U=this._leakageMon.check(W.stack,this._size+1)),this._listeners?this._listeners instanceof UniqueContainer?(this._deliveryQueue??=new EventDeliveryQueuePrivate,this._listeners=[this._listeners,W]):this._listeners.push(W):(this._options?.onWillAddFirstListener?.(this),this._listeners=W,this._options?.onDidAddFirstListener?.(this)),this._size++;const K=toDisposable(()=>{U?.(),this._removeListener(W)});return O instanceof DisposableStore?O.add(K):Array.isArray(O)&&O.push(K),K},this._event}_removeListener(w){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}const D=this._listeners,O=D.indexOf(w);if(O===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,D[O]=void 0;const W=this._deliveryQueue.current===this;if(this._size*compactionThreshold<=D.length){let U=0;for(let K=0;K<D.length;K++)D[K]?D[U++]=D[K]:W&&(this._deliveryQueue.end--,U<this._deliveryQueue.i&&this._deliveryQueue.i--);D.length=U}}_deliver(w,D){if(!w)return;const O=this._options?.onListenerError||onUnexpectedError;if(!O){w.value(D);return}try{w.value(D)}catch(W){O(W)}}_deliverQueue(w){const D=w.current._listeners;for(;w.i<w.end;)this._deliver(D[w.i++],w.value);w.reset()}fire(w){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof UniqueContainer)this._deliver(this._listeners,w);else{const D=this._deliveryQueue;D.enqueue(this,w,this._listeners.length),this._deliverQueue(D)}this._perfMon?.stop()}hasListeners(){return this._size>0}};const createEventDeliveryQueue=()=>new EventDeliveryQueuePrivate;class EventDeliveryQueuePrivate{constructor(){this.i=-1,this.end=0}enqueue(w,D,O){this.i=0,this.end=O,this.current=w,this.value=D}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class PauseableEmitter extends Emitter$1{constructor(w){super(w),this._isPaused=0,this._eventQueue=new LinkedList,this._mergeFn=w?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const w=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(w))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(w){this._size&&(this._isPaused!==0?this._eventQueue.push(w):super.fire(w))}}class DebounceEmitter extends PauseableEmitter{constructor(w){super(w),this._delay=w.delay??100}fire(w){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(w)}}class MicrotaskEmitter extends Emitter$1{constructor(w){super(w),this._queuedEvents=[],this._mergeFn=w?.merge}fire(w){this.hasListeners()&&(this._queuedEvents.push(w),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(D=>super.fire(D)),this._queuedEvents=[]}))}}class EventMultiplexer{constructor(){this.hasListeners=!1,this.events=[],this.emitter=new Emitter$1({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(w){const D={event:w,listener:null};return this.events.push(D),this.hasListeners&&this.hook(D),toDisposable(createSingleCallFunction(()=>{this.hasListeners&&this.unhook(D);const W=this.events.indexOf(D);this.events.splice(W,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(w=>this.hook(w))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(w=>this.unhook(w))}hook(w){w.listener=w.event(D=>this.emitter.fire(D))}unhook(w){w.listener?.dispose(),w.listener=null}dispose(){this.emitter.dispose();for(const w of this.events)w.listener?.dispose();this.events=[]}}class EventBufferer{constructor(){this.data=[]}wrapEvent(w,D,O){return(W,U,K)=>w(q=>{const G=this.data[this.data.length-1];if(!D){G?G.buffers.push(()=>W.call(U,q)):W.call(U,q);return}const Q=G;if(!Q){W.call(U,D(O,q));return}Q.items??=[],Q.items.push(q),Q.buffers.length===0&&G.buffers.push(()=>{Q.reducedResult??=O?Q.items.reduce(D,O):Q.items.reduce(D),W.call(U,Q.reducedResult)})},void 0,K)}bufferEvents(w){const D={buffers:new Array};this.data.push(D);const O=w();return this.data.pop(),D.buffers.forEach(W=>W()),O}}class Relay{constructor(){this.listening=!1,this.inputEvent=Event$1.None,this.inputEventListener=Disposable.None,this.emitter=new Emitter$1({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(w){this.inputEvent=w,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=w(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const shortcutEvent=Object.freeze(function(F,w){const D=setTimeout(F.bind(w),0);return{dispose(){clearTimeout(D)}}});var CancellationToken;(function(F){function w(D){return D===F.None||D===F.Cancelled||D instanceof MutableToken?!0:!D||typeof D!="object"?!1:typeof D.isCancellationRequested=="boolean"&&typeof D.onCancellationRequested=="function"}F.isCancellationToken=w,F.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Event$1.None}),F.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:shortcutEvent})})(CancellationToken||(CancellationToken={}));class MutableToken{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?shortcutEvent:(this._emitter||(this._emitter=new Emitter$1),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}let CancellationTokenSource$1=class{constructor(w){this._token=void 0,this._parentListener=void 0,this._parentListener=w&&w.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new MutableToken),this._token}cancel(){this._token?this._token instanceof MutableToken&&this._token.cancel():this._token=CancellationToken.Cancelled}dispose(w=!1){w&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof MutableToken&&this._token.dispose():this._token=CancellationToken.None}};const MicrotaskDelay=Symbol("MicrotaskDelay");function isThenable$1(F){return!!F&&typeof F.then=="function"}function createCancelablePromise(F){const w=new CancellationTokenSource$1,D=F(w.token),O=new Promise((W,U)=>{const K=w.token.onCancellationRequested(()=>{K.dispose(),U(new CancellationError)});Promise.resolve(D).then(q=>{K.dispose(),w.dispose(),W(q)},q=>{K.dispose(),w.dispose(),U(q)})});return new class{cancel(){w.cancel(),w.dispose()}then(W,U){return O.then(W,U)}catch(W){return this.then(void 0,W)}finally(W){return O.finally(W)}}}class Throttler{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(w){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=w,!this.queuedPromise){const D=()=>{if(this.queuedPromise=null,this.isDisposed)return;const O=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,O};this.queuedPromise=new Promise(O=>{this.activePromise.then(D,D).then(O)})}return new Promise((D,O)=>{this.queuedPromise.then(D,O)})}return this.activePromise=w(),new Promise((D,O)=>{this.activePromise.then(W=>{this.activePromise=null,D(W)},W=>{this.activePromise=null,O(W)})})}dispose(){this.isDisposed=!0}}const timeoutDeferred=(F,w)=>{let D=!0;const O=setTimeout(()=>{D=!1,w()},F);return{isTriggered:()=>D,dispose:()=>{clearTimeout(O),D=!1}}},microtaskDeferred=F=>{let w=!0;return queueMicrotask(()=>{w&&(w=!1,F())}),{isTriggered:()=>w,dispose:()=>{w=!1}}};class Delayer{constructor(w){this.defaultDelay=w,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(w,D=this.defaultDelay){this.task=w,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((W,U)=>{this.doResolve=W,this.doReject=U}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const W=this.task;return this.task=null,W()}}));const O=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=D===MicrotaskDelay?microtaskDeferred(O):timeoutDeferred(D,O),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new CancellationError),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}}class ThrottledDelayer{constructor(w){this.delayer=new Delayer(w),this.throttler=new Throttler}trigger(w,D){return this.delayer.trigger(()=>this.throttler.queue(w),D)}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}function timeout(F,w){return w?new Promise((D,O)=>{const W=setTimeout(()=>{U.dispose(),D()},F),U=w.onCancellationRequested(()=>{clearTimeout(W),U.dispose(),O(new CancellationError)})}):createCancelablePromise(D=>timeout(F,D))}function disposableTimeout(F,w=0,D){const O=setTimeout(()=>{F(),D&&W.dispose()},w),W=toDisposable(()=>{clearTimeout(O),D?.deleteAndLeak(W)});return D?.add(W),W}class TimeoutTimer{constructor(w,D){this._isDisposed=!1,this._token=-1,typeof w=="function"&&typeof D=="number"&&this.setIfNotSet(w,D)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(w,D){if(this._isDisposed)throw new BugIndicatingError("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,w()},D)}setIfNotSet(w,D){if(this._isDisposed)throw new BugIndicatingError("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,w()},D))}}class IntervalTimer{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(w,D,O=globalThis){if(this.isDisposed)throw new BugIndicatingError("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const W=O.setInterval(()=>{w()},D);this.disposable=toDisposable(()=>{O.clearInterval(W),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}}class RunOnceScheduler{constructor(w,D){this.timeoutToken=-1,this.runner=w,this.timeout=D,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(w=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,w)}get delay(){return this.timeout}set delay(w){this.timeout=w}isScheduled(){return this.timeoutToken!==-1}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}}let runWhenGlobalIdle,_runWhenIdle;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?_runWhenIdle=(F,w)=>{setTimeout0(()=>{if(D)return;const O=Date.now()+15;w(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,O-Date.now())}}))});let D=!1;return{dispose(){D||(D=!0)}}}:_runWhenIdle=(F,w,D)=>{const O=F.requestIdleCallback(w,typeof D=="number"?{timeout:D}:void 0);let W=!1;return{dispose(){W||(W=!0,F.cancelIdleCallback(O))}}},runWhenGlobalIdle=F=>_runWhenIdle(globalThis,F)})();class AbstractIdleValue{constructor(w,D){this._didRun=!1,this._executor=()=>{try{this._value=D()}catch(O){this._error=O}finally{this._didRun=!0}},this._handle=_runWhenIdle(w,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class GlobalIdleValue extends AbstractIdleValue{constructor(w){super(globalThis,w)}}class DeferredPromise{get isRejected(){return this.outcome?.outcome===1}get isSettled(){return!!this.outcome}constructor(){this.p=new Promise((w,D)=>{this.completeCallback=w,this.errorCallback=D})}complete(w){return new Promise(D=>{this.completeCallback(w),this.outcome={outcome:0,value:w},D()})}error(w){return new Promise(D=>{this.errorCallback(w),this.outcome={outcome:1,value:w},D()})}cancel(){return this.error(new CancellationError)}}var Promises;(function(F){async function w(O){let W;const U=await Promise.all(O.map(K=>K.then(q=>q,q=>{W||(W=q)})));if(typeof W<"u")throw W;return U}F.settled=w;function D(O){return new Promise(async(W,U)=>{try{await O(W,U)}catch(K){U(K)}})}F.withAsyncBody=D})(Promises||(Promises={}));class AsyncIterableObject{static fromArray(w){return new AsyncIterableObject(D=>{D.emitMany(w)})}static fromPromise(w){return new AsyncIterableObject(async D=>{D.emitMany(await w)})}static fromPromises(w){return new AsyncIterableObject(async D=>{await Promise.all(w.map(async O=>D.emitOne(await O)))})}static merge(w){return new AsyncIterableObject(async D=>{await Promise.all(w.map(async O=>{for await(const W of O)D.emitOne(W)}))})}static{this.EMPTY=AsyncIterableObject.fromArray([])}constructor(w,D){this._state=0,this._results=[],this._error=null,this._onReturn=D,this._onStateChanged=new Emitter$1,queueMicrotask(async()=>{const O={emitOne:W=>this.emitOne(W),emitMany:W=>this.emitMany(W),reject:W=>this.reject(W)};try{await Promise.resolve(w(O)),this.resolve()}catch(W){this.reject(W)}finally{O.emitOne=void 0,O.emitMany=void 0,O.reject=void 0}})}[Symbol.asyncIterator](){let w=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(w<this._results.length)return{done:!1,value:this._results[w++]};if(this._state===1)return{done:!0,value:void 0};await Event$1.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(w,D){return new AsyncIterableObject(async O=>{for await(const W of w)O.emitOne(D(W))})}map(w){return AsyncIterableObject.map(this,w)}static filter(w,D){return new AsyncIterableObject(async O=>{for await(const W of w)D(W)&&O.emitOne(W)})}filter(w){return AsyncIterableObject.filter(this,w)}static coalesce(w){return AsyncIterableObject.filter(w,D=>!!D)}coalesce(){return AsyncIterableObject.coalesce(this)}static async toPromise(w){const D=[];for await(const O of w)D.push(O);return D}toPromise(){return AsyncIterableObject.toPromise(this)}emitOne(w){this._state===0&&(this._results.push(w),this._onStateChanged.fire())}emitMany(w){this._state===0&&(this._results=this._results.concat(w),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(w){this._state===0&&(this._state=2,this._error=w,this._onStateChanged.fire())}}/*! @license DOMPurify 3.1.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.7/LICENSE */const{entries,setPrototypeOf,isFrozen,getPrototypeOf,getOwnPropertyDescriptor}=Object;let{freeze:freeze$1,seal,create:create$1}=Object,{apply,construct}=typeof Reflect<"u"&&Reflect;freeze$1||(freeze$1=function(w){return w});seal||(seal=function(w){return w});apply||(apply=function(w,D,O){return w.apply(D,O)});construct||(construct=function(w,D){return new w(...D)});const arrayForEach=unapply(Array.prototype.forEach),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),stringToLowerCase=unapply(String.prototype.toLowerCase),stringToString=unapply(String.prototype.toString),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),objectHasOwnProperty=unapply(Object.prototype.hasOwnProperty),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=unconstruct(TypeError);function unapply(F){return function(w){for(var D=arguments.length,O=new Array(D>1?D-1:0),W=1;W<D;W++)O[W-1]=arguments[W];return apply(F,w,O)}}function unconstruct(F){return function(){for(var w=arguments.length,D=new Array(w),O=0;O<w;O++)D[O]=arguments[O];return construct(F,D)}}function addToSet(F,w){let D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:stringToLowerCase;setPrototypeOf&&setPrototypeOf(F,null);let O=w.length;for(;O--;){let W=w[O];if(typeof W=="string"){const U=D(W);U!==W&&(isFrozen(w)||(w[O]=U),W=U)}F[W]=!0}return F}function cleanArray(F){for(let w=0;w<F.length;w++)objectHasOwnProperty(F,w)||(F[w]=null);return F}function clone(F){const w=create$1(null);for(const[D,O]of entries(F))objectHasOwnProperty(F,D)&&(Array.isArray(O)?w[D]=cleanArray(O):O&&typeof O=="object"&&O.constructor===Object?w[D]=clone(O):w[D]=O);return w}function lookupGetter(F,w){for(;F!==null;){const O=getOwnPropertyDescriptor(F,w);if(O){if(O.get)return unapply(O.get);if(typeof O.value=="function")return unapply(O.value)}F=getPrototypeOf(F)}function D(){return null}return D}const html$1=freeze$1(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg$1=freeze$1(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze$1(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze$1(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl$1=freeze$1(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mathMlDisallowed=freeze$1(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze$1(["#text"]),html=freeze$1(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),svg=freeze$1(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl=freeze$1(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze$1(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm),TMPLIT_EXPR=seal(/\${[\w\W]*}/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DOCTYPE_NAME=seal(/^html$/i),CUSTOM_ELEMENT=seal(/^[a-z][.\w]*(-[.\w]+)+$/i);var EXPRESSIONS=Object.freeze({__proto__:null,MUSTACHE_EXPR,ERB_EXPR,TMPLIT_EXPR,DATA_ATTR,ARIA_ATTR,IS_ALLOWED_URI,IS_SCRIPT_OR_DATA,ATTR_WHITESPACE,DOCTYPE_NAME,CUSTOM_ELEMENT});const NODE_TYPE={element:1,text:3,progressingInstruction:7,comment:8,document:9},getGlobal=function(){return typeof window>"u"?null:window},_createTrustedTypesPolicy=function(w,D){if(typeof w!="object"||typeof w.createPolicy!="function")return null;let O=null;const W="data-tt-policy-suffix";D&&D.hasAttribute(W)&&(O=D.getAttribute(W));const U="dompurify"+(O?"#"+O:"");try{return w.createPolicy(U,{createHTML(K){return K},createScriptURL(K){return K}})}catch{return console.warn("TrustedTypes policy "+U+" could not be created."),null}};function createDOMPurify(){let F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:getGlobal();const w=vt=>createDOMPurify(vt);if(w.version="3.1.7",w.removed=[],!F||!F.document||F.document.nodeType!==NODE_TYPE.document)return w.isSupported=!1,w;let{document:D}=F;const O=D,W=O.currentScript,{DocumentFragment:U,HTMLTemplateElement:K,Node:q,Element:G,NodeFilter:Q,NamedNodeMap:Y=F.NamedNodeMap||F.MozNamedAttrMap,HTMLFormElement:X,DOMParser:J,trustedTypes:te}=F,ie=G.prototype,se=lookupGetter(ie,"cloneNode"),re=lookupGetter(ie,"remove"),ae=lookupGetter(ie,"nextSibling"),le=lookupGetter(ie,"childNodes"),de=lookupGetter(ie,"parentNode");if(typeof K=="function"){const vt=D.createElement("template");vt.content&&vt.content.ownerDocument&&(D=vt.content.ownerDocument)}let oe,ue="";const{implementation:pe,createNodeIterator:fe,createDocumentFragment:Ce,getElementsByTagName:we}=D,{importNode:Oe}=O;let Te={};w.isSupported=typeof entries=="function"&&typeof de=="function"&&pe&&pe.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Re,ERB_EXPR:Me,TMPLIT_EXPR:Ne,DATA_ATTR:ze,ARIA_ATTR:Qe,IS_SCRIPT_OR_DATA:Ye,ATTR_WHITESPACE:Je,CUSTOM_ELEMENT:at}=EXPRESSIONS;let{IS_ALLOWED_URI:st}=EXPRESSIONS,lt=null;const Tt=addToSet({},[...html$1,...svg$1,...svgFilters,...mathMl$1,...text]);let Ke=null;const je=addToSet({},[...html,...svg,...mathMl,...xml]);let et=Object.seal(create$1(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),mt=null,Mt=null,Et=!0,Ct=!0,Nt=!1,zt=!0,ii=!1,Ci=!0,ni=!1,vi=!1,hi=!1,jt=!1,zi=!1,Ki=!1,pi=!0,mi=!1;const kt="user-content-";let ki=!0,Ii=!1,Jt={},_i=null;const Lt=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let St=null;const si=addToSet({},["audio","video","img","source","image","track"]);let Se=null;const ge=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),_e="http://www.w3.org/1998/Math/MathML",ke="http://www.w3.org/2000/svg",Fe="http://www.w3.org/1999/xhtml";let qe=Fe,tt=!1,It=null;const wt=addToSet({},[_e,ke,Fe],stringToString);let Ht=null;const ri=["application/xhtml+xml","text/html"],qt="text/html";let di=null,Zi=null;const On=D.createElement("form"),Pn=function(We){return We instanceof RegExp||We instanceof Function},Cn=function(){let We=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Zi&&Zi===We)){if((!We||typeof We!="object")&&(We={}),We=clone(We),Ht=ri.indexOf(We.PARSER_MEDIA_TYPE)===-1?qt:We.PARSER_MEDIA_TYPE,di=Ht==="application/xhtml+xml"?stringToString:stringToLowerCase,lt=objectHasOwnProperty(We,"ALLOWED_TAGS")?addToSet({},We.ALLOWED_TAGS,di):Tt,Ke=objectHasOwnProperty(We,"ALLOWED_ATTR")?addToSet({},We.ALLOWED_ATTR,di):je,It=objectHasOwnProperty(We,"ALLOWED_NAMESPACES")?addToSet({},We.ALLOWED_NAMESPACES,stringToString):wt,Se=objectHasOwnProperty(We,"ADD_URI_SAFE_ATTR")?addToSet(clone(ge),We.ADD_URI_SAFE_ATTR,di):ge,St=objectHasOwnProperty(We,"ADD_DATA_URI_TAGS")?addToSet(clone(si),We.ADD_DATA_URI_TAGS,di):si,_i=objectHasOwnProperty(We,"FORBID_CONTENTS")?addToSet({},We.FORBID_CONTENTS,di):Lt,mt=objectHasOwnProperty(We,"FORBID_TAGS")?addToSet({},We.FORBID_TAGS,di):{},Mt=objectHasOwnProperty(We,"FORBID_ATTR")?addToSet({},We.FORBID_ATTR,di):{},Jt=objectHasOwnProperty(We,"USE_PROFILES")?We.USE_PROFILES:!1,Et=We.ALLOW_ARIA_ATTR!==!1,Ct=We.ALLOW_DATA_ATTR!==!1,Nt=We.ALLOW_UNKNOWN_PROTOCOLS||!1,zt=We.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ii=We.SAFE_FOR_TEMPLATES||!1,Ci=We.SAFE_FOR_XML!==!1,ni=We.WHOLE_DOCUMENT||!1,jt=We.RETURN_DOM||!1,zi=We.RETURN_DOM_FRAGMENT||!1,Ki=We.RETURN_TRUSTED_TYPE||!1,hi=We.FORCE_BODY||!1,pi=We.SANITIZE_DOM!==!1,mi=We.SANITIZE_NAMED_PROPS||!1,ki=We.KEEP_CONTENT!==!1,Ii=We.IN_PLACE||!1,st=We.ALLOWED_URI_REGEXP||IS_ALLOWED_URI,qe=We.NAMESPACE||Fe,et=We.CUSTOM_ELEMENT_HANDLING||{},We.CUSTOM_ELEMENT_HANDLING&&Pn(We.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(et.tagNameCheck=We.CUSTOM_ELEMENT_HANDLING.tagNameCheck),We.CUSTOM_ELEMENT_HANDLING&&Pn(We.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(et.attributeNameCheck=We.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),We.CUSTOM_ELEMENT_HANDLING&&typeof We.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(et.allowCustomizedBuiltInElements=We.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ii&&(Ct=!1),zi&&(jt=!0),Jt&&(lt=addToSet({},text),Ke=[],Jt.html===!0&&(addToSet(lt,html$1),addToSet(Ke,html)),Jt.svg===!0&&(addToSet(lt,svg$1),addToSet(Ke,svg),addToSet(Ke,xml)),Jt.svgFilters===!0&&(addToSet(lt,svgFilters),addToSet(Ke,svg),addToSet(Ke,xml)),Jt.mathMl===!0&&(addToSet(lt,mathMl$1),addToSet(Ke,mathMl),addToSet(Ke,xml))),We.ADD_TAGS&&(lt===Tt&&(lt=clone(lt)),addToSet(lt,We.ADD_TAGS,di)),We.ADD_ATTR&&(Ke===je&&(Ke=clone(Ke)),addToSet(Ke,We.ADD_ATTR,di)),We.ADD_URI_SAFE_ATTR&&addToSet(Se,We.ADD_URI_SAFE_ATTR,di),We.FORBID_CONTENTS&&(_i===Lt&&(_i=clone(_i)),addToSet(_i,We.FORBID_CONTENTS,di)),ki&&(lt["#text"]=!0),ni&&addToSet(lt,["html","head","body"]),lt.table&&(addToSet(lt,["tbody"]),delete mt.tbody),We.TRUSTED_TYPES_POLICY){if(typeof We.TRUSTED_TYPES_POLICY.createHTML!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof We.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');oe=We.TRUSTED_TYPES_POLICY,ue=oe.createHTML("")}else oe===void 0&&(oe=_createTrustedTypesPolicy(te,W)),oe!==null&&typeof ue=="string"&&(ue=oe.createHTML(""));freeze$1&&freeze$1(We),Zi=We}},xt=addToSet({},["mi","mo","mn","ms","mtext"]),Ee=addToSet({},["annotation-xml"]),xe=addToSet({},["title","style","font","a","script"]),Ie=addToSet({},[...svg$1,...svgFilters,...svgDisallowed]),Pe=addToSet({},[...mathMl$1,...mathMlDisallowed]),$e=function(We){let dt=de(We);(!dt||!dt.tagName)&&(dt={namespaceURI:qe,tagName:"template"});const _t=stringToLowerCase(We.tagName),Zt=stringToLowerCase(dt.tagName);return It[We.namespaceURI]?We.namespaceURI===ke?dt.namespaceURI===Fe?_t==="svg":dt.namespaceURI===_e?_t==="svg"&&(Zt==="annotation-xml"||xt[Zt]):!!Ie[_t]:We.namespaceURI===_e?dt.namespaceURI===Fe?_t==="math":dt.namespaceURI===ke?_t==="math"&&Ee[Zt]:!!Pe[_t]:We.namespaceURI===Fe?dt.namespaceURI===ke&&!Ee[Zt]||dt.namespaceURI===_e&&!xt[Zt]?!1:!Pe[_t]&&(xe[_t]||!Ie[_t]):!!(Ht==="application/xhtml+xml"&&It[We.namespaceURI]):!1},Ge=function(We){arrayPush(w.removed,{element:We});try{de(We).removeChild(We)}catch{re(We)}},Xe=function(We,dt){try{arrayPush(w.removed,{attribute:dt.getAttributeNode(We),from:dt})}catch{arrayPush(w.removed,{attribute:null,from:dt})}if(dt.removeAttribute(We),We==="is"&&!Ke[We])if(jt||zi)try{Ge(dt)}catch{}else try{dt.setAttribute(We,"")}catch{}},ut=function(We){let dt=null,_t=null;if(hi)We="<remove></remove>"+We;else{const gi=stringMatch(We,/^[\r\n\t ]+/);_t=gi&&gi[0]}Ht==="application/xhtml+xml"&&qe===Fe&&(We='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+We+"</body></html>");const Zt=oe?oe.createHTML(We):We;if(qe===Fe)try{dt=new J().parseFromString(Zt,Ht)}catch{}if(!dt||!dt.documentElement){dt=pe.createDocument(qe,"template",null);try{dt.documentElement.innerHTML=tt?ue:Zt}catch{}}const Ti=dt.body||dt.documentElement;return We&&_t&&Ti.insertBefore(D.createTextNode(_t),Ti.childNodes[0]||null),qe===Fe?we.call(dt,ni?"html":"body")[0]:ni?dt.documentElement:Ti},ht=function(We){return fe.call(We.ownerDocument||We,We,Q.SHOW_ELEMENT|Q.SHOW_COMMENT|Q.SHOW_TEXT|Q.SHOW_PROCESSING_INSTRUCTION|Q.SHOW_CDATA_SECTION,null)},pt=function(We){return We instanceof X&&(typeof We.nodeName!="string"||typeof We.textContent!="string"||typeof We.removeChild!="function"||!(We.attributes instanceof Y)||typeof We.removeAttribute!="function"||typeof We.setAttribute!="function"||typeof We.namespaceURI!="string"||typeof We.insertBefore!="function"||typeof We.hasChildNodes!="function")},$t=function(We){return typeof q=="function"&&We instanceof q},Pt=function(We,dt,_t){Te[We]&&arrayForEach(Te[We],Zt=>{Zt.call(w,dt,_t,Zi)})},Yt=function(We){let dt=null;if(Pt("beforeSanitizeElements",We,null),pt(We))return Ge(We),!0;const _t=di(We.nodeName);if(Pt("uponSanitizeElement",We,{tagName:_t,allowedTags:lt}),We.hasChildNodes()&&!$t(We.firstElementChild)&&regExpTest(/<[/\w]/g,We.innerHTML)&&regExpTest(/<[/\w]/g,We.textContent)||We.nodeType===NODE_TYPE.progressingInstruction||Ci&&We.nodeType===NODE_TYPE.comment&&regExpTest(/<[/\w]/g,We.data))return Ge(We),!0;if(!lt[_t]||mt[_t]){if(!mt[_t]&&Si(_t)&&(et.tagNameCheck instanceof RegExp&&regExpTest(et.tagNameCheck,_t)||et.tagNameCheck instanceof Function&&et.tagNameCheck(_t)))return!1;if(ki&&!_i[_t]){const Zt=de(We)||We.parentNode,Ti=le(We)||We.childNodes;if(Ti&&Zt){const gi=Ti.length;for(let Mi=gi-1;Mi>=0;--Mi){const qi=se(Ti[Mi],!0);qi.__removalCount=(We.__removalCount||0)+1,Zt.insertBefore(qi,ae(We))}}}return Ge(We),!0}return We instanceof G&&!$e(We)||(_t==="noscript"||_t==="noembed"||_t==="noframes")&&regExpTest(/<\/no(script|embed|frames)/i,We.innerHTML)?(Ge(We),!0):(ii&&We.nodeType===NODE_TYPE.text&&(dt=We.textContent,arrayForEach([Re,Me,Ne],Zt=>{dt=stringReplace(dt,Zt," ")}),We.textContent!==dt&&(arrayPush(w.removed,{element:We.cloneNode()}),We.textContent=dt)),Pt("afterSanitizeElements",We,null),!1)},Xt=function(We,dt,_t){if(pi&&(dt==="id"||dt==="name")&&(_t in D||_t in On))return!1;if(!(Ct&&!Mt[dt]&&regExpTest(ze,dt))){if(!(Et&&regExpTest(Qe,dt))){if(!Ke[dt]||Mt[dt]){if(!(Si(We)&&(et.tagNameCheck instanceof RegExp&&regExpTest(et.tagNameCheck,We)||et.tagNameCheck instanceof Function&&et.tagNameCheck(We))&&(et.attributeNameCheck instanceof RegExp&&regExpTest(et.attributeNameCheck,dt)||et.attributeNameCheck instanceof Function&&et.attributeNameCheck(dt))||dt==="is"&&et.allowCustomizedBuiltInElements&&(et.tagNameCheck instanceof RegExp&&regExpTest(et.tagNameCheck,_t)||et.tagNameCheck instanceof Function&&et.tagNameCheck(_t))))return!1}else if(!Se[dt]){if(!regExpTest(st,stringReplace(_t,Je,""))){if(!((dt==="src"||dt==="xlink:href"||dt==="href")&&We!=="script"&&stringIndexOf(_t,"data:")===0&&St[We])){if(!(Nt&&!regExpTest(Ye,stringReplace(_t,Je,"")))){if(_t)return!1}}}}}}return!0},Si=function(We){return We!=="annotation-xml"&&stringMatch(We,at)},Pi=function(We){Pt("beforeSanitizeAttributes",We,null);const{attributes:dt}=We;if(!dt)return;const _t={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ke};let Zt=dt.length;for(;Zt--;){const Ti=dt[Zt],{name:gi,namespaceURI:Mi,value:qi}=Ti,En=di(gi);let Di=gi==="value"?qi:stringTrim(qi);if(_t.attrName=En,_t.attrValue=Di,_t.keepAttr=!0,_t.forceKeepAttr=void 0,Pt("uponSanitizeAttribute",We,_t),Di=_t.attrValue,_t.forceKeepAttr||(Xe(gi,We),!_t.keepAttr))continue;if(!zt&&regExpTest(/\/>/i,Di)){Xe(gi,We);continue}ii&&arrayForEach([Re,Me,Ne],jn=>{Di=stringReplace(Di,jn," ")});const Gn=di(We.nodeName);if(Xt(Gn,En,Di)){if(mi&&(En==="id"||En==="name")&&(Xe(gi,We),Di=kt+Di),Ci&&regExpTest(/((--!?|])>)|<\/(style|title)/i,Di)){Xe(gi,We);continue}if(oe&&typeof te=="object"&&typeof te.getAttributeType=="function"&&!Mi)switch(te.getAttributeType(Gn,En)){case"TrustedHTML":{Di=oe.createHTML(Di);break}case"TrustedScriptURL":{Di=oe.createScriptURL(Di);break}}try{Mi?We.setAttributeNS(Mi,gi,Di):We.setAttribute(gi,Di),pt(We)?Ge(We):arrayPop(w.removed)}catch{}}}Pt("afterSanitizeAttributes",We,null)},yn=function vt(We){let dt=null;const _t=ht(We);for(Pt("beforeSanitizeShadowDOM",We,null);dt=_t.nextNode();)Pt("uponSanitizeShadowNode",dt,null),!Yt(dt)&&(dt.content instanceof U&&vt(dt.content),Pi(dt));Pt("afterSanitizeShadowDOM",We,null)};return w.sanitize=function(vt){let We=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},dt=null,_t=null,Zt=null,Ti=null;if(tt=!vt,tt&&(vt="<!-->"),typeof vt!="string"&&!$t(vt))if(typeof vt.toString=="function"){if(vt=vt.toString(),typeof vt!="string")throw typeErrorCreate("dirty is not a string, aborting")}else throw typeErrorCreate("toString is not a function");if(!w.isSupported)return vt;if(vi||Cn(We),w.removed=[],typeof vt=="string"&&(Ii=!1),Ii){if(vt.nodeName){const qi=di(vt.nodeName);if(!lt[qi]||mt[qi])throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}else if(vt instanceof q)dt=ut("<!---->"),_t=dt.ownerDocument.importNode(vt,!0),_t.nodeType===NODE_TYPE.element&&_t.nodeName==="BODY"||_t.nodeName==="HTML"?dt=_t:dt.appendChild(_t);else{if(!jt&&!ii&&!ni&&vt.indexOf("<")===-1)return oe&&Ki?oe.createHTML(vt):vt;if(dt=ut(vt),!dt)return jt?null:Ki?ue:""}dt&&hi&&Ge(dt.firstChild);const gi=ht(Ii?vt:dt);for(;Zt=gi.nextNode();)Yt(Zt)||(Zt.content instanceof U&&yn(Zt.content),Pi(Zt));if(Ii)return vt;if(jt){if(zi)for(Ti=Ce.call(dt.ownerDocument);dt.firstChild;)Ti.appendChild(dt.firstChild);else Ti=dt;return(Ke.shadowroot||Ke.shadowrootmode)&&(Ti=Oe.call(O,Ti,!0)),Ti}let Mi=ni?dt.outerHTML:dt.innerHTML;return ni&&lt["!doctype"]&&dt.ownerDocument&&dt.ownerDocument.doctype&&dt.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,dt.ownerDocument.doctype.name)&&(Mi="<!DOCTYPE "+dt.ownerDocument.doctype.name+`>
`+Mi),ii&&arrayForEach([Re,Me,Ne],qi=>{Mi=stringReplace(Mi,qi," ")}),oe&&Ki?oe.createHTML(Mi):Mi},w.setConfig=function(){let vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Cn(vt),vi=!0},w.clearConfig=function(){Zi=null,vi=!1},w.isValidAttribute=function(vt,We,dt){Zi||Cn({});const _t=di(vt),Zt=di(We);return Xt(_t,Zt,dt)},w.addHook=function(vt,We){typeof We=="function"&&(Te[vt]=Te[vt]||[],arrayPush(Te[vt],We))},w.removeHook=function(vt){if(Te[vt])return arrayPop(Te[vt])},w.removeHooks=function(vt){Te[vt]&&(Te[vt]=[])},w.removeAllHooks=function(){Te={}},w}var purify=createDOMPurify();purify.version;purify.isSupported;const sanitize$1=purify.sanitize;purify.setConfig;purify.clearConfig;purify.isValidAttribute;const addHook=purify.addHook,removeHook=purify.removeHook;purify.removeHooks;purify.removeAllHooks;function identity(F){return F}class LRUCachedFunction{constructor(w,D){this.lastCache=void 0,this.lastArgKey=void 0,typeof w=="function"?(this._fn=w,this._computeKey=identity):(this._fn=D,this._computeKey=w.getCacheKey)}get(w){const D=this._computeKey(w);return this.lastArgKey!==D&&(this.lastArgKey=D,this.lastCache=this._fn(w)),this.lastCache}}class CachedFunction{get cachedValues(){return this._map}constructor(w,D){this._map=new Map,this._map2=new Map,typeof w=="function"?(this._fn=w,this._computeKey=identity):(this._fn=D,this._computeKey=w.getCacheKey)}get(w){const D=this._computeKey(w);if(this._map2.has(D))return this._map2.get(D);const O=this._fn(w);return this._map.set(w,O),this._map2.set(D,O),O}}class Lazy{constructor(w){this.executor=w,this._didRun=!1}get value(){if(!this._didRun)try{this._value=this.executor()}catch(w){this._error=w}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}function isFalsyOrWhitespace(F){return!F||typeof F!="string"?!0:F.trim().length===0}const _formatRegexp=/{(\d+)}/g;function format(F,...w){return w.length===0?F:F.replace(_formatRegexp,function(D,O){const W=parseInt(O,10);return isNaN(W)||W<0||W>=w.length?D:w[W]})}function htmlAttributeEncodeValue(F){return F.replace(/[<>"'&]/g,w=>{switch(w){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return w})}function escape(F){return F.replace(/[<>&]/g,function(w){switch(w){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return w}})}function escapeRegExpCharacters(F){return F.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function ltrim(F,w){if(!F||!w)return F;const D=w.length;if(D===0||F.length===0)return F;let O=0;for(;F.indexOf(w,O)===O;)O=O+D;return F.substring(O)}function rtrim(F,w){if(!F)return F;const D=w.length,O=F.length;if(D===0||O===0)return F;let W=O,U=-1;for(;U=F.lastIndexOf(w,W-1),!(U===-1||U+D!==W);){if(U===0)return"";W=U}return F.substring(0,W)}function convertSimple2RegExpPattern(F){return F.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function createRegExp(F,w,D={}){if(!F)throw new Error("Cannot create regex from empty string");w||(F=escapeRegExpCharacters(F)),D.wholeWord&&(/\B/.test(F.charAt(0))||(F="\\b"+F),/\B/.test(F.charAt(F.length-1))||(F=F+"\\b"));let O="";return D.global&&(O+="g"),D.matchCase||(O+="i"),D.multiline&&(O+="m"),D.unicode&&(O+="u"),new RegExp(F,O)}function regExpLeadsToEndlessLoop(F){return F.source==="^"||F.source==="^$"||F.source==="$"||F.source==="^\\s*$"?!1:!!(F.exec("")&&F.lastIndex===0)}function splitLines(F){return F.split(/\r\n|\r|\n/)}function firstNonWhitespaceIndex(F){for(let w=0,D=F.length;w<D;w++){const O=F.charCodeAt(w);if(O!==32&&O!==9)return w}return-1}function getLeadingWhitespace(F,w=0,D=F.length){for(let O=w;O<D;O++){const W=F.charCodeAt(O);if(W!==32&&W!==9)return F.substring(w,O)}return F.substring(w,D)}function lastNonWhitespaceIndex(F,w=F.length-1){for(let D=w;D>=0;D--){const O=F.charCodeAt(D);if(O!==32&&O!==9)return D}return-1}function compare(F,w){return F<w?-1:F>w?1:0}function compareSubstring(F,w,D=0,O=F.length,W=0,U=w.length){for(;D<O&&W<U;D++,W++){const G=F.charCodeAt(D),Q=w.charCodeAt(W);if(G<Q)return-1;if(G>Q)return 1}const K=O-D,q=U-W;return K<q?-1:K>q?1:0}function compareIgnoreCase(F,w){return compareSubstringIgnoreCase(F,w,0,F.length,0,w.length)}function compareSubstringIgnoreCase(F,w,D=0,O=F.length,W=0,U=w.length){for(;D<O&&W<U;D++,W++){let G=F.charCodeAt(D),Q=w.charCodeAt(W);if(G===Q)continue;if(G>=128||Q>=128)return compareSubstring(F.toLowerCase(),w.toLowerCase(),D,O,W,U);isLowerAsciiLetter(G)&&(G-=32),isLowerAsciiLetter(Q)&&(Q-=32);const Y=G-Q;if(Y!==0)return Y}const K=O-D,q=U-W;return K<q?-1:K>q?1:0}function isAsciiDigit(F){return F>=48&&F<=57}function isLowerAsciiLetter(F){return F>=97&&F<=122}function isUpperAsciiLetter(F){return F>=65&&F<=90}function equalsIgnoreCase(F,w){return F.length===w.length&&compareSubstringIgnoreCase(F,w)===0}function startsWithIgnoreCase(F,w){const D=w.length;return w.length>F.length?!1:compareSubstringIgnoreCase(F,w,0,D)===0}function commonPrefixLength(F,w){const D=Math.min(F.length,w.length);let O;for(O=0;O<D;O++)if(F.charCodeAt(O)!==w.charCodeAt(O))return O;return D}function commonSuffixLength(F,w){const D=Math.min(F.length,w.length);let O;const W=F.length-1,U=w.length-1;for(O=0;O<D;O++)if(F.charCodeAt(W-O)!==w.charCodeAt(U-O))return O;return D}function isHighSurrogate(F){return 55296<=F&&F<=56319}function isLowSurrogate(F){return 56320<=F&&F<=57343}function computeCodePoint(F,w){return(F-55296<<10)+(w-56320)+65536}function getNextCodePoint(F,w,D){const O=F.charCodeAt(D);if(isHighSurrogate(O)&&D+1<w){const W=F.charCodeAt(D+1);if(isLowSurrogate(W))return computeCodePoint(O,W)}return O}function getPrevCodePoint(F,w){const D=F.charCodeAt(w-1);if(isLowSurrogate(D)&&w>1){const O=F.charCodeAt(w-2);if(isHighSurrogate(O))return computeCodePoint(O,D)}return D}class CodePointIterator{get offset(){return this._offset}constructor(w,D=0){this._str=w,this._len=w.length,this._offset=D}setOffset(w){this._offset=w}prevCodePoint(){const w=getPrevCodePoint(this._str,this._offset);return this._offset-=w>=65536?2:1,w}nextCodePoint(){const w=getNextCodePoint(this._str,this._len,this._offset);return this._offset+=w>=65536?2:1,w}eol(){return this._offset>=this._len}}class GraphemeIterator{get offset(){return this._iterator.offset}constructor(w,D=0){this._iterator=new CodePointIterator(w,D)}nextGraphemeLength(){const w=GraphemeBreakTree.getInstance(),D=this._iterator,O=D.offset;let W=w.getGraphemeBreakType(D.nextCodePoint());for(;!D.eol();){const U=D.offset,K=w.getGraphemeBreakType(D.nextCodePoint());if(breakBetweenGraphemeBreakType(W,K)){D.setOffset(U);break}W=K}return D.offset-O}prevGraphemeLength(){const w=GraphemeBreakTree.getInstance(),D=this._iterator,O=D.offset;let W=w.getGraphemeBreakType(D.prevCodePoint());for(;D.offset>0;){const U=D.offset,K=w.getGraphemeBreakType(D.prevCodePoint());if(breakBetweenGraphemeBreakType(K,W)){D.setOffset(U);break}W=K}return O-D.offset}eol(){return this._iterator.eol()}}function nextCharLength(F,w){return new GraphemeIterator(F,w).nextGraphemeLength()}function prevCharLength(F,w){return new GraphemeIterator(F,w).prevGraphemeLength()}function getCharContainingOffset(F,w){w>0&&isLowSurrogate(F.charCodeAt(w))&&w--;const D=w+nextCharLength(F,w);return[D-prevCharLength(F,D),D]}let CONTAINS_RTL;function makeContainsRtl(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function containsRTL(F){return CONTAINS_RTL||(CONTAINS_RTL=makeContainsRtl()),CONTAINS_RTL.test(F)}const IS_BASIC_ASCII=/^[\t\n\r\x20-\x7E]*$/;function isBasicASCII(F){return IS_BASIC_ASCII.test(F)}const UNUSUAL_LINE_TERMINATORS=/[\u2028\u2029]/;function containsUnusualLineTerminators(F){return UNUSUAL_LINE_TERMINATORS.test(F)}function isFullWidthCharacter(F){return F>=11904&&F<=55215||F>=63744&&F<=64255||F>=65281&&F<=65374}function isEmojiImprecise(F){return F>=127462&&F<=127487||F===8986||F===8987||F===9200||F===9203||F>=9728&&F<=10175||F===11088||F===11093||F>=127744&&F<=128591||F>=128640&&F<=128764||F>=128992&&F<=129008||F>=129280&&F<=129535||F>=129648&&F<=129782}const UTF8_BOM_CHARACTER="\uFEFF";function startsWithUTF8BOM(F){return!!(F&&F.length>0&&F.charCodeAt(0)===65279)}function singleLetterHash(F){return F=F%(2*26),F<26?String.fromCharCode(97+F):String.fromCharCode(65+F-26)}function breakBetweenGraphemeBreakType(F,w){return F===0?w!==5&&w!==7:F===2&&w===3?!1:F===4||F===2||F===3||w===4||w===2||w===3?!0:!(F===8&&(w===8||w===9||w===11||w===12)||(F===11||F===9)&&(w===9||w===10)||(F===12||F===10)&&w===10||w===5||w===13||w===7||F===1||F===13&&w===14||F===6&&w===6)}class GraphemeBreakTree{static{this._INSTANCE=null}static getInstance(){return GraphemeBreakTree._INSTANCE||(GraphemeBreakTree._INSTANCE=new GraphemeBreakTree),GraphemeBreakTree._INSTANCE}constructor(){this._data=getGraphemeBreakRawData()}getGraphemeBreakType(w){if(w<32)return w===10?3:w===13?2:4;if(w<127)return 0;const D=this._data,O=D.length/3;let W=1;for(;W<=O;)if(w<D[3*W])W=2*W;else if(w>D[3*W+1])W=2*W+1;else return D[3*W+2];return 0}}function getGraphemeBreakRawData(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function getLeftDeleteOffset(F,w){if(F===0)return 0;const D=getOffsetBeforeLastEmojiComponent(F,w);if(D!==void 0)return D;const O=new CodePointIterator(w,F);return O.prevCodePoint(),O.offset}function getOffsetBeforeLastEmojiComponent(F,w){const D=new CodePointIterator(w,F);let O=D.prevCodePoint();for(;isEmojiModifier(O)||O===65039||O===8419;){if(D.offset===0)return;O=D.prevCodePoint()}if(!isEmojiImprecise(O))return;let W=D.offset;return W>0&&D.prevCodePoint()===8205&&(W=D.offset),W}function isEmojiModifier(F){return 127995<=F&&F<=127999}class AmbiguousCharacters{static{this.ambiguousCharacterData=new Lazy(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'))}static{this.cache=new LRUCachedFunction({getCacheKey:JSON.stringify},w=>{function D(Y){const X=new Map;for(let J=0;J<Y.length;J+=2)X.set(Y[J],Y[J+1]);return X}function O(Y,X){const J=new Map(Y);for(const[te,ie]of X)J.set(te,ie);return J}function W(Y,X){if(!Y)return X;const J=new Map;for(const[te,ie]of Y)X.has(te)&&J.set(te,ie);return J}const U=this.ambiguousCharacterData.value;let K=w.filter(Y=>!Y.startsWith("_")&&Y in U);K.length===0&&(K=["_default"]);let q;for(const Y of K){const X=D(U[Y]);q=W(q,X)}const G=D(U._common),Q=O(G,q);return new AmbiguousCharacters(Q)})}static getInstance(w){return AmbiguousCharacters.cache.get(Array.from(w))}static{this._locales=new Lazy(()=>Object.keys(AmbiguousCharacters.ambiguousCharacterData.value).filter(w=>!w.startsWith("_")))}static getLocales(){return AmbiguousCharacters._locales.value}constructor(w){this.confusableDictionary=w}isAmbiguous(w){return this.confusableDictionary.has(w)}getPrimaryConfusable(w){return this.confusableDictionary.get(w)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}}class InvisibleCharacters{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static{this._data=void 0}static getData(){return this._data||(this._data=new Set(InvisibleCharacters.getRawData())),this._data}static isInvisibleCharacter(w){return InvisibleCharacters.getData().has(w)}static get codePoints(){return InvisibleCharacters.getData()}}var define_process_env_default={};let safeProcess;const vscodeGlobal=globalThis.vscode;if(typeof vscodeGlobal<"u"&&typeof vscodeGlobal.process<"u"){const F=vscodeGlobal.process;safeProcess={get platform(){return F.platform},get arch(){return F.arch},get env(){return F.env},cwd(){return F.cwd()}}}else typeof process$1<"u"&&typeof process$1?.versions?.node=="string"?safeProcess={get platform(){return process$1.platform},get arch(){return process$1.arch},get env(){return define_process_env_default},cwd(){return define_process_env_default.VSCODE_CWD||process$1.cwd()}}:safeProcess={get platform(){return isWindows?"win32":isMacintosh?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const cwd=safeProcess.cwd,env=safeProcess.env,platform=safeProcess.platform,CHAR_UPPERCASE_A=65,CHAR_LOWERCASE_A=97,CHAR_UPPERCASE_Z=90,CHAR_LOWERCASE_Z=122,CHAR_DOT=46,CHAR_FORWARD_SLASH=47,CHAR_BACKWARD_SLASH=92,CHAR_COLON$1=58,CHAR_QUESTION_MARK=63;class ErrorInvalidArgType extends Error{constructor(w,D,O){let W;typeof D=="string"&&D.indexOf("not ")===0?(W="must not be",D=D.replace(/^not /,"")):W="must be";const U=w.indexOf(".")!==-1?"property":"argument";let K=`The "${w}" ${U} ${W} of type ${D}`;K+=`. Received type ${typeof O}`,super(K),this.code="ERR_INVALID_ARG_TYPE"}}function validateObject(F,w){if(F===null||typeof F!="object")throw new ErrorInvalidArgType(w,"Object",F)}function validateString(F,w){if(typeof F!="string")throw new ErrorInvalidArgType(w,"string",F)}const platformIsWin32=platform==="win32";function isPathSeparator$1(F){return F===CHAR_FORWARD_SLASH||F===CHAR_BACKWARD_SLASH}function isPosixPathSeparator(F){return F===CHAR_FORWARD_SLASH}function isWindowsDeviceRoot(F){return F>=CHAR_UPPERCASE_A&&F<=CHAR_UPPERCASE_Z||F>=CHAR_LOWERCASE_A&&F<=CHAR_LOWERCASE_Z}function normalizeString(F,w,D,O){let W="",U=0,K=-1,q=0,G=0;for(let Q=0;Q<=F.length;++Q){if(Q<F.length)G=F.charCodeAt(Q);else{if(O(G))break;G=CHAR_FORWARD_SLASH}if(O(G)){if(!(K===Q-1||q===1))if(q===2){if(W.length<2||U!==2||W.charCodeAt(W.length-1)!==CHAR_DOT||W.charCodeAt(W.length-2)!==CHAR_DOT){if(W.length>2){const Y=W.lastIndexOf(D);Y===-1?(W="",U=0):(W=W.slice(0,Y),U=W.length-1-W.lastIndexOf(D)),K=Q,q=0;continue}else if(W.length!==0){W="",U=0,K=Q,q=0;continue}}w&&(W+=W.length>0?`${D}..`:"..",U=2)}else W.length>0?W+=`${D}${F.slice(K+1,Q)}`:W=F.slice(K+1,Q),U=Q-K-1;K=Q,q=0}else G===CHAR_DOT&&q!==-1?++q:q=-1}return W}function formatExt(F){return F?`${F[0]==="."?"":"."}${F}`:""}function _format(F,w){validateObject(w,"pathObject");const D=w.dir||w.root,O=w.base||`${w.name||""}${formatExt(w.ext)}`;return D?D===w.root?`${D}${O}`:`${D}${F}${O}`:O}const win32={resolve(...F){let w="",D="",O=!1;for(let W=F.length-1;W>=-1;W--){let U;if(W>=0){if(U=F[W],validateString(U,`paths[${W}]`),U.length===0)continue}else w.length===0?U=cwd():(U=env[`=${w}`]||cwd(),(U===void 0||U.slice(0,2).toLowerCase()!==w.toLowerCase()&&U.charCodeAt(2)===CHAR_BACKWARD_SLASH)&&(U=`${w}\\`));const K=U.length;let q=0,G="",Q=!1;const Y=U.charCodeAt(0);if(K===1)isPathSeparator$1(Y)&&(q=1,Q=!0);else if(isPathSeparator$1(Y))if(Q=!0,isPathSeparator$1(U.charCodeAt(1))){let X=2,J=X;for(;X<K&&!isPathSeparator$1(U.charCodeAt(X));)X++;if(X<K&&X!==J){const te=U.slice(J,X);for(J=X;X<K&&isPathSeparator$1(U.charCodeAt(X));)X++;if(X<K&&X!==J){for(J=X;X<K&&!isPathSeparator$1(U.charCodeAt(X));)X++;(X===K||X!==J)&&(G=`\\\\${te}\\${U.slice(J,X)}`,q=X)}}}else q=1;else isWindowsDeviceRoot(Y)&&U.charCodeAt(1)===CHAR_COLON$1&&(G=U.slice(0,2),q=2,K>2&&isPathSeparator$1(U.charCodeAt(2))&&(Q=!0,q=3));if(G.length>0)if(w.length>0){if(G.toLowerCase()!==w.toLowerCase())continue}else w=G;if(O){if(w.length>0)break}else if(D=`${U.slice(q)}\\${D}`,O=Q,Q&&w.length>0)break}return D=normalizeString(D,!O,"\\",isPathSeparator$1),O?`${w}\\${D}`:`${w}${D}`||"."},normalize(F){validateString(F,"path");const w=F.length;if(w===0)return".";let D=0,O,W=!1;const U=F.charCodeAt(0);if(w===1)return isPosixPathSeparator(U)?"\\":F;if(isPathSeparator$1(U))if(W=!0,isPathSeparator$1(F.charCodeAt(1))){let q=2,G=q;for(;q<w&&!isPathSeparator$1(F.charCodeAt(q));)q++;if(q<w&&q!==G){const Q=F.slice(G,q);for(G=q;q<w&&isPathSeparator$1(F.charCodeAt(q));)q++;if(q<w&&q!==G){for(G=q;q<w&&!isPathSeparator$1(F.charCodeAt(q));)q++;if(q===w)return`\\\\${Q}\\${F.slice(G)}\\`;q!==G&&(O=`\\\\${Q}\\${F.slice(G,q)}`,D=q)}}}else D=1;else isWindowsDeviceRoot(U)&&F.charCodeAt(1)===CHAR_COLON$1&&(O=F.slice(0,2),D=2,w>2&&isPathSeparator$1(F.charCodeAt(2))&&(W=!0,D=3));let K=D<w?normalizeString(F.slice(D),!W,"\\",isPathSeparator$1):"";return K.length===0&&!W&&(K="."),K.length>0&&isPathSeparator$1(F.charCodeAt(w-1))&&(K+="\\"),O===void 0?W?`\\${K}`:K:W?`${O}\\${K}`:`${O}${K}`},isAbsolute(F){validateString(F,"path");const w=F.length;if(w===0)return!1;const D=F.charCodeAt(0);return isPathSeparator$1(D)||w>2&&isWindowsDeviceRoot(D)&&F.charCodeAt(1)===CHAR_COLON$1&&isPathSeparator$1(F.charCodeAt(2))},join(...F){if(F.length===0)return".";let w,D;for(let U=0;U<F.length;++U){const K=F[U];validateString(K,"path"),K.length>0&&(w===void 0?w=D=K:w+=`\\${K}`)}if(w===void 0)return".";let O=!0,W=0;if(typeof D=="string"&&isPathSeparator$1(D.charCodeAt(0))){++W;const U=D.length;U>1&&isPathSeparator$1(D.charCodeAt(1))&&(++W,U>2&&(isPathSeparator$1(D.charCodeAt(2))?++W:O=!1))}if(O){for(;W<w.length&&isPathSeparator$1(w.charCodeAt(W));)W++;W>=2&&(w=`\\${w.slice(W)}`)}return win32.normalize(w)},relative(F,w){if(validateString(F,"from"),validateString(w,"to"),F===w)return"";const D=win32.resolve(F),O=win32.resolve(w);if(D===O||(F=D.toLowerCase(),w=O.toLowerCase(),F===w))return"";let W=0;for(;W<F.length&&F.charCodeAt(W)===CHAR_BACKWARD_SLASH;)W++;let U=F.length;for(;U-1>W&&F.charCodeAt(U-1)===CHAR_BACKWARD_SLASH;)U--;const K=U-W;let q=0;for(;q<w.length&&w.charCodeAt(q)===CHAR_BACKWARD_SLASH;)q++;let G=w.length;for(;G-1>q&&w.charCodeAt(G-1)===CHAR_BACKWARD_SLASH;)G--;const Q=G-q,Y=K<Q?K:Q;let X=-1,J=0;for(;J<Y;J++){const ie=F.charCodeAt(W+J);if(ie!==w.charCodeAt(q+J))break;ie===CHAR_BACKWARD_SLASH&&(X=J)}if(J!==Y){if(X===-1)return O}else{if(Q>Y){if(w.charCodeAt(q+J)===CHAR_BACKWARD_SLASH)return O.slice(q+J+1);if(J===2)return O.slice(q+J)}K>Y&&(F.charCodeAt(W+J)===CHAR_BACKWARD_SLASH?X=J:J===2&&(X=3)),X===-1&&(X=0)}let te="";for(J=W+X+1;J<=U;++J)(J===U||F.charCodeAt(J)===CHAR_BACKWARD_SLASH)&&(te+=te.length===0?"..":"\\..");return q+=X,te.length>0?`${te}${O.slice(q,G)}`:(O.charCodeAt(q)===CHAR_BACKWARD_SLASH&&++q,O.slice(q,G))},toNamespacedPath(F){if(typeof F!="string"||F.length===0)return F;const w=win32.resolve(F);if(w.length<=2)return F;if(w.charCodeAt(0)===CHAR_BACKWARD_SLASH){if(w.charCodeAt(1)===CHAR_BACKWARD_SLASH){const D=w.charCodeAt(2);if(D!==CHAR_QUESTION_MARK&&D!==CHAR_DOT)return`\\\\?\\UNC\\${w.slice(2)}`}}else if(isWindowsDeviceRoot(w.charCodeAt(0))&&w.charCodeAt(1)===CHAR_COLON$1&&w.charCodeAt(2)===CHAR_BACKWARD_SLASH)return`\\\\?\\${w}`;return F},dirname(F){validateString(F,"path");const w=F.length;if(w===0)return".";let D=-1,O=0;const W=F.charCodeAt(0);if(w===1)return isPathSeparator$1(W)?F:".";if(isPathSeparator$1(W)){if(D=O=1,isPathSeparator$1(F.charCodeAt(1))){let q=2,G=q;for(;q<w&&!isPathSeparator$1(F.charCodeAt(q));)q++;if(q<w&&q!==G){for(G=q;q<w&&isPathSeparator$1(F.charCodeAt(q));)q++;if(q<w&&q!==G){for(G=q;q<w&&!isPathSeparator$1(F.charCodeAt(q));)q++;if(q===w)return F;q!==G&&(D=O=q+1)}}}}else isWindowsDeviceRoot(W)&&F.charCodeAt(1)===CHAR_COLON$1&&(D=w>2&&isPathSeparator$1(F.charCodeAt(2))?3:2,O=D);let U=-1,K=!0;for(let q=w-1;q>=O;--q)if(isPathSeparator$1(F.charCodeAt(q))){if(!K){U=q;break}}else K=!1;if(U===-1){if(D===-1)return".";U=D}return F.slice(0,U)},basename(F,w){w!==void 0&&validateString(w,"suffix"),validateString(F,"path");let D=0,O=-1,W=!0,U;if(F.length>=2&&isWindowsDeviceRoot(F.charCodeAt(0))&&F.charCodeAt(1)===CHAR_COLON$1&&(D=2),w!==void 0&&w.length>0&&w.length<=F.length){if(w===F)return"";let K=w.length-1,q=-1;for(U=F.length-1;U>=D;--U){const G=F.charCodeAt(U);if(isPathSeparator$1(G)){if(!W){D=U+1;break}}else q===-1&&(W=!1,q=U+1),K>=0&&(G===w.charCodeAt(K)?--K===-1&&(O=U):(K=-1,O=q))}return D===O?O=q:O===-1&&(O=F.length),F.slice(D,O)}for(U=F.length-1;U>=D;--U)if(isPathSeparator$1(F.charCodeAt(U))){if(!W){D=U+1;break}}else O===-1&&(W=!1,O=U+1);return O===-1?"":F.slice(D,O)},extname(F){validateString(F,"path");let w=0,D=-1,O=0,W=-1,U=!0,K=0;F.length>=2&&F.charCodeAt(1)===CHAR_COLON$1&&isWindowsDeviceRoot(F.charCodeAt(0))&&(w=O=2);for(let q=F.length-1;q>=w;--q){const G=F.charCodeAt(q);if(isPathSeparator$1(G)){if(!U){O=q+1;break}continue}W===-1&&(U=!1,W=q+1),G===CHAR_DOT?D===-1?D=q:K!==1&&(K=1):D!==-1&&(K=-1)}return D===-1||W===-1||K===0||K===1&&D===W-1&&D===O+1?"":F.slice(D,W)},format:_format.bind(null,"\\"),parse(F){validateString(F,"path");const w={root:"",dir:"",base:"",ext:"",name:""};if(F.length===0)return w;const D=F.length;let O=0,W=F.charCodeAt(0);if(D===1)return isPathSeparator$1(W)?(w.root=w.dir=F,w):(w.base=w.name=F,w);if(isPathSeparator$1(W)){if(O=1,isPathSeparator$1(F.charCodeAt(1))){let X=2,J=X;for(;X<D&&!isPathSeparator$1(F.charCodeAt(X));)X++;if(X<D&&X!==J){for(J=X;X<D&&isPathSeparator$1(F.charCodeAt(X));)X++;if(X<D&&X!==J){for(J=X;X<D&&!isPathSeparator$1(F.charCodeAt(X));)X++;X===D?O=X:X!==J&&(O=X+1)}}}}else if(isWindowsDeviceRoot(W)&&F.charCodeAt(1)===CHAR_COLON$1){if(D<=2)return w.root=w.dir=F,w;if(O=2,isPathSeparator$1(F.charCodeAt(2))){if(D===3)return w.root=w.dir=F,w;O=3}}O>0&&(w.root=F.slice(0,O));let U=-1,K=O,q=-1,G=!0,Q=F.length-1,Y=0;for(;Q>=O;--Q){if(W=F.charCodeAt(Q),isPathSeparator$1(W)){if(!G){K=Q+1;break}continue}q===-1&&(G=!1,q=Q+1),W===CHAR_DOT?U===-1?U=Q:Y!==1&&(Y=1):U!==-1&&(Y=-1)}return q!==-1&&(U===-1||Y===0||Y===1&&U===q-1&&U===K+1?w.base=w.name=F.slice(K,q):(w.name=F.slice(K,U),w.base=F.slice(K,q),w.ext=F.slice(U,q))),K>0&&K!==O?w.dir=F.slice(0,K-1):w.dir=w.root,w},sep:"\\",delimiter:";",win32:null,posix:null},posixCwd=(()=>{if(platformIsWin32){const F=/\\/g;return()=>{const w=cwd().replace(F,"/");return w.slice(w.indexOf("/"))}}return()=>cwd()})(),posix={resolve(...F){let w="",D=!1;for(let O=F.length-1;O>=-1&&!D;O--){const W=O>=0?F[O]:posixCwd();validateString(W,`paths[${O}]`),W.length!==0&&(w=`${W}/${w}`,D=W.charCodeAt(0)===CHAR_FORWARD_SLASH)}return w=normalizeString(w,!D,"/",isPosixPathSeparator),D?`/${w}`:w.length>0?w:"."},normalize(F){if(validateString(F,"path"),F.length===0)return".";const w=F.charCodeAt(0)===CHAR_FORWARD_SLASH,D=F.charCodeAt(F.length-1)===CHAR_FORWARD_SLASH;return F=normalizeString(F,!w,"/",isPosixPathSeparator),F.length===0?w?"/":D?"./":".":(D&&(F+="/"),w?`/${F}`:F)},isAbsolute(F){return validateString(F,"path"),F.length>0&&F.charCodeAt(0)===CHAR_FORWARD_SLASH},join(...F){if(F.length===0)return".";let w;for(let D=0;D<F.length;++D){const O=F[D];validateString(O,"path"),O.length>0&&(w===void 0?w=O:w+=`/${O}`)}return w===void 0?".":posix.normalize(w)},relative(F,w){if(validateString(F,"from"),validateString(w,"to"),F===w||(F=posix.resolve(F),w=posix.resolve(w),F===w))return"";const D=1,O=F.length,W=O-D,U=1,K=w.length-U,q=W<K?W:K;let G=-1,Q=0;for(;Q<q;Q++){const X=F.charCodeAt(D+Q);if(X!==w.charCodeAt(U+Q))break;X===CHAR_FORWARD_SLASH&&(G=Q)}if(Q===q)if(K>q){if(w.charCodeAt(U+Q)===CHAR_FORWARD_SLASH)return w.slice(U+Q+1);if(Q===0)return w.slice(U+Q)}else W>q&&(F.charCodeAt(D+Q)===CHAR_FORWARD_SLASH?G=Q:Q===0&&(G=0));let Y="";for(Q=D+G+1;Q<=O;++Q)(Q===O||F.charCodeAt(Q)===CHAR_FORWARD_SLASH)&&(Y+=Y.length===0?"..":"/..");return`${Y}${w.slice(U+G)}`},toNamespacedPath(F){return F},dirname(F){if(validateString(F,"path"),F.length===0)return".";const w=F.charCodeAt(0)===CHAR_FORWARD_SLASH;let D=-1,O=!0;for(let W=F.length-1;W>=1;--W)if(F.charCodeAt(W)===CHAR_FORWARD_SLASH){if(!O){D=W;break}}else O=!1;return D===-1?w?"/":".":w&&D===1?"//":F.slice(0,D)},basename(F,w){w!==void 0&&validateString(w,"ext"),validateString(F,"path");let D=0,O=-1,W=!0,U;if(w!==void 0&&w.length>0&&w.length<=F.length){if(w===F)return"";let K=w.length-1,q=-1;for(U=F.length-1;U>=0;--U){const G=F.charCodeAt(U);if(G===CHAR_FORWARD_SLASH){if(!W){D=U+1;break}}else q===-1&&(W=!1,q=U+1),K>=0&&(G===w.charCodeAt(K)?--K===-1&&(O=U):(K=-1,O=q))}return D===O?O=q:O===-1&&(O=F.length),F.slice(D,O)}for(U=F.length-1;U>=0;--U)if(F.charCodeAt(U)===CHAR_FORWARD_SLASH){if(!W){D=U+1;break}}else O===-1&&(W=!1,O=U+1);return O===-1?"":F.slice(D,O)},extname(F){validateString(F,"path");let w=-1,D=0,O=-1,W=!0,U=0;for(let K=F.length-1;K>=0;--K){const q=F.charCodeAt(K);if(q===CHAR_FORWARD_SLASH){if(!W){D=K+1;break}continue}O===-1&&(W=!1,O=K+1),q===CHAR_DOT?w===-1?w=K:U!==1&&(U=1):w!==-1&&(U=-1)}return w===-1||O===-1||U===0||U===1&&w===O-1&&w===D+1?"":F.slice(w,O)},format:_format.bind(null,"/"),parse(F){validateString(F,"path");const w={root:"",dir:"",base:"",ext:"",name:""};if(F.length===0)return w;const D=F.charCodeAt(0)===CHAR_FORWARD_SLASH;let O;D?(w.root="/",O=1):O=0;let W=-1,U=0,K=-1,q=!0,G=F.length-1,Q=0;for(;G>=O;--G){const Y=F.charCodeAt(G);if(Y===CHAR_FORWARD_SLASH){if(!q){U=G+1;break}continue}K===-1&&(q=!1,K=G+1),Y===CHAR_DOT?W===-1?W=G:Q!==1&&(Q=1):W!==-1&&(Q=-1)}if(K!==-1){const Y=U===0&&D?1:U;W===-1||Q===0||Q===1&&W===K-1&&W===U+1?w.base=w.name=F.slice(Y,K):(w.name=F.slice(Y,W),w.base=F.slice(Y,K),w.ext=F.slice(W,K))}return U>0?w.dir=F.slice(0,U-1):D&&(w.dir="/"),w},sep:"/",delimiter:":",win32:null,posix:null};posix.win32=win32.win32=win32;posix.posix=win32.posix=posix;const normalize=platformIsWin32?win32.normalize:posix.normalize,join$1=platformIsWin32?win32.join:posix.join,resolve=platformIsWin32?win32.resolve:posix.resolve,relative=platformIsWin32?win32.relative:posix.relative,dirname$1=platformIsWin32?win32.dirname:posix.dirname,basename$1=platformIsWin32?win32.basename:posix.basename,extname$1=platformIsWin32?win32.extname:posix.extname,sep=platformIsWin32?win32.sep:posix.sep,_schemePattern=/^\w[\w\d+.-]*$/,_singleSlashStart=/^\//,_doubleSlashStart=/^\/\//;function _validateUri(F,w){if(!F.scheme&&w)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${F.authority}", path: "${F.path}", query: "${F.query}", fragment: "${F.fragment}"}`);if(F.scheme&&!_schemePattern.test(F.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(F.path){if(F.authority){if(!_singleSlashStart.test(F.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(_doubleSlashStart.test(F.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function _schemeFix(F,w){return!F&&!w?"file":F}function _referenceResolution(F,w){switch(F){case"https":case"http":case"file":w?w[0]!==_slash&&(w=_slash+w):w=_slash;break}return w}const _empty="",_slash="/",_regexp=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class URI{static isUri(w){return w instanceof URI?!0:w?typeof w.authority=="string"&&typeof w.fragment=="string"&&typeof w.path=="string"&&typeof w.query=="string"&&typeof w.scheme=="string"&&typeof w.fsPath=="string"&&typeof w.with=="function"&&typeof w.toString=="function":!1}constructor(w,D,O,W,U,K=!1){typeof w=="object"?(this.scheme=w.scheme||_empty,this.authority=w.authority||_empty,this.path=w.path||_empty,this.query=w.query||_empty,this.fragment=w.fragment||_empty):(this.scheme=_schemeFix(w,K),this.authority=D||_empty,this.path=_referenceResolution(this.scheme,O||_empty),this.query=W||_empty,this.fragment=U||_empty,_validateUri(this,K))}get fsPath(){return uriToFsPath(this,!1)}with(w){if(!w)return this;let{scheme:D,authority:O,path:W,query:U,fragment:K}=w;return D===void 0?D=this.scheme:D===null&&(D=_empty),O===void 0?O=this.authority:O===null&&(O=_empty),W===void 0?W=this.path:W===null&&(W=_empty),U===void 0?U=this.query:U===null&&(U=_empty),K===void 0?K=this.fragment:K===null&&(K=_empty),D===this.scheme&&O===this.authority&&W===this.path&&U===this.query&&K===this.fragment?this:new Uri$1(D,O,W,U,K)}static parse(w,D=!1){const O=_regexp.exec(w);return O?new Uri$1(O[2]||_empty,percentDecode(O[4]||_empty),percentDecode(O[5]||_empty),percentDecode(O[7]||_empty),percentDecode(O[9]||_empty),D):new Uri$1(_empty,_empty,_empty,_empty,_empty)}static file(w){let D=_empty;if(isWindows&&(w=w.replace(/\\/g,_slash)),w[0]===_slash&&w[1]===_slash){const O=w.indexOf(_slash,2);O===-1?(D=w.substring(2),w=_slash):(D=w.substring(2,O),w=w.substring(O)||_slash)}return new Uri$1("file",D,w,_empty,_empty)}static from(w,D){return new Uri$1(w.scheme,w.authority,w.path,w.query,w.fragment,D)}static joinPath(w,...D){if(!w.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let O;return isWindows&&w.scheme==="file"?O=URI.file(win32.join(uriToFsPath(w,!0),...D)).path:O=posix.join(w.path,...D),w.with({path:O})}toString(w=!1){return _asFormatted(this,w)}toJSON(){return this}static revive(w){if(w){if(w instanceof URI)return w;{const D=new Uri$1(w);return D._formatted=w.external??null,D._fsPath=w._sep===_pathSepMarker?w.fsPath??null:null,D}}else return w}}const _pathSepMarker=isWindows?1:void 0;let Uri$1=class extends URI{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=uriToFsPath(this,!1)),this._fsPath}toString(w=!1){return w?_asFormatted(this,!0):(this._formatted||(this._formatted=_asFormatted(this,!1)),this._formatted)}toJSON(){const w={$mid:1};return this._fsPath&&(w.fsPath=this._fsPath,w._sep=_pathSepMarker),this._formatted&&(w.external=this._formatted),this.path&&(w.path=this.path),this.scheme&&(w.scheme=this.scheme),this.authority&&(w.authority=this.authority),this.query&&(w.query=this.query),this.fragment&&(w.fragment=this.fragment),w}};const encodeTable={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function encodeURIComponentFast(F,w,D){let O,W=-1;for(let U=0;U<F.length;U++){const K=F.charCodeAt(U);if(K>=97&&K<=122||K>=65&&K<=90||K>=48&&K<=57||K===45||K===46||K===95||K===126||w&&K===47||D&&K===91||D&&K===93||D&&K===58)W!==-1&&(O+=encodeURIComponent(F.substring(W,U)),W=-1),O!==void 0&&(O+=F.charAt(U));else{O===void 0&&(O=F.substr(0,U));const q=encodeTable[K];q!==void 0?(W!==-1&&(O+=encodeURIComponent(F.substring(W,U)),W=-1),O+=q):W===-1&&(W=U)}}return W!==-1&&(O+=encodeURIComponent(F.substring(W))),O!==void 0?O:F}function encodeURIComponentMinimal(F){let w;for(let D=0;D<F.length;D++){const O=F.charCodeAt(D);O===35||O===63?(w===void 0&&(w=F.substr(0,D)),w+=encodeTable[O]):w!==void 0&&(w+=F[D])}return w!==void 0?w:F}function uriToFsPath(F,w){let D;return F.authority&&F.path.length>1&&F.scheme==="file"?D=`//${F.authority}${F.path}`:F.path.charCodeAt(0)===47&&(F.path.charCodeAt(1)>=65&&F.path.charCodeAt(1)<=90||F.path.charCodeAt(1)>=97&&F.path.charCodeAt(1)<=122)&&F.path.charCodeAt(2)===58?w?D=F.path.substr(1):D=F.path[1].toLowerCase()+F.path.substr(2):D=F.path,isWindows&&(D=D.replace(/\//g,"\\")),D}function _asFormatted(F,w){const D=w?encodeURIComponentMinimal:encodeURIComponentFast;let O="",{scheme:W,authority:U,path:K,query:q,fragment:G}=F;if(W&&(O+=W,O+=":"),(U||W==="file")&&(O+=_slash,O+=_slash),U){let Q=U.indexOf("@");if(Q!==-1){const Y=U.substr(0,Q);U=U.substr(Q+1),Q=Y.lastIndexOf(":"),Q===-1?O+=D(Y,!1,!1):(O+=D(Y.substr(0,Q),!1,!1),O+=":",O+=D(Y.substr(Q+1),!1,!0)),O+="@"}U=U.toLowerCase(),Q=U.lastIndexOf(":"),Q===-1?O+=D(U,!1,!0):(O+=D(U.substr(0,Q),!1,!0),O+=U.substr(Q))}if(K){if(K.length>=3&&K.charCodeAt(0)===47&&K.charCodeAt(2)===58){const Q=K.charCodeAt(1);Q>=65&&Q<=90&&(K=`/${String.fromCharCode(Q+32)}:${K.substr(3)}`)}else if(K.length>=2&&K.charCodeAt(1)===58){const Q=K.charCodeAt(0);Q>=65&&Q<=90&&(K=`${String.fromCharCode(Q+32)}:${K.substr(2)}`)}O+=D(K,!0,!1)}return q&&(O+="?",O+=D(q,!1,!1)),G&&(O+="#",O+=w?G:encodeURIComponentFast(G,!1,!1)),O}function decodeURIComponentGraceful(F){try{return decodeURIComponent(F)}catch{return F.length>3?F.substr(0,3)+decodeURIComponentGraceful(F.substr(3)):F}}const _rEncodedAsHex=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function percentDecode(F){return F.match(_rEncodedAsHex)?F.replace(_rEncodedAsHex,w=>decodeURIComponentGraceful(w)):F}var Schemas;(function(F){F.inMemory="inmemory",F.vscode="vscode",F.internal="private",F.walkThrough="walkThrough",F.walkThroughSnippet="walkThroughSnippet",F.http="http",F.https="https",F.file="file",F.mailto="mailto",F.untitled="untitled",F.data="data",F.command="command",F.vscodeRemote="vscode-remote",F.vscodeRemoteResource="vscode-remote-resource",F.vscodeManagedRemoteResource="vscode-managed-remote-resource",F.vscodeUserData="vscode-userdata",F.vscodeCustomEditor="vscode-custom-editor",F.vscodeNotebookCell="vscode-notebook-cell",F.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",F.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",F.vscodeNotebookCellOutput="vscode-notebook-cell-output",F.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",F.vscodeNotebookMetadata="vscode-notebook-metadata",F.vscodeInteractiveInput="vscode-interactive-input",F.vscodeSettings="vscode-settings",F.vscodeWorkspaceTrust="vscode-workspace-trust",F.vscodeTerminal="vscode-terminal",F.vscodeChatCodeBlock="vscode-chat-code-block",F.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",F.vscodeChatSesssion="vscode-chat-editor",F.webviewPanel="webview-panel",F.vscodeWebview="vscode-webview",F.extension="extension",F.vscodeFileResource="vscode-file",F.tmp="tmp",F.vsls="vsls",F.vscodeSourceControl="vscode-scm",F.commentsInput="comment",F.codeSetting="code-setting",F.outputChannel="output"})(Schemas||(Schemas={}));function matchesScheme(F,w){return URI.isUri(F)?equalsIgnoreCase(F.scheme,w):startsWithIgnoreCase(F,w+":")}function matchesSomeScheme(F,...w){return w.some(D=>matchesScheme(F,D))}const connectionTokenQueryName="tkn";class RemoteAuthoritiesImpl{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._serverRootPath="/"}setPreferredWebSchema(w){this._preferredWebSchema=w}get _remoteResourcesPath(){return posix.join(this._serverRootPath,Schemas.vscodeRemoteResource)}rewrite(w){if(this._delegate)try{return this._delegate(w)}catch(q){return onUnexpectedError(q),w}const D=w.authority;let O=this._hosts[D];O&&O.indexOf(":")!==-1&&O.indexOf("[")===-1&&(O=`[${O}]`);const W=this._ports[D],U=this._connectionTokens[D];let K=`path=${encodeURIComponent(w.path)}`;return typeof U=="string"&&(K+=`&${connectionTokenQueryName}=${encodeURIComponent(U)}`),URI.from({scheme:isWeb?this._preferredWebSchema:Schemas.vscodeRemoteResource,authority:`${O}:${W}`,path:this._remoteResourcesPath,query:K})}}const RemoteAuthorities=new RemoteAuthoritiesImpl,VSCODE_AUTHORITY="vscode-app";class FileAccessImpl{static{this.FALLBACK_AUTHORITY=VSCODE_AUTHORITY}asBrowserUri(w){const D=this.toUri(w);return this.uriToBrowserUri(D)}uriToBrowserUri(w){return w.scheme===Schemas.vscodeRemote?RemoteAuthorities.rewrite(w):w.scheme===Schemas.file&&(isNative||webWorkerOrigin===`${Schemas.vscodeFileResource}://${FileAccessImpl.FALLBACK_AUTHORITY}`)?w.with({scheme:Schemas.vscodeFileResource,authority:w.authority||FileAccessImpl.FALLBACK_AUTHORITY,query:null,fragment:null}):w}toUri(w,D){if(URI.isUri(w))return w;if(globalThis._VSCODE_FILE_ROOT){const O=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(O))return URI.joinPath(URI.parse(O,!0),w);const W=join$1(O,w);return URI.file(W)}return URI.parse(D.toUrl(w))}}const FileAccess=new FileAccessImpl;var COI;(function(F){const w=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);F.CoopAndCoep=Object.freeze(w.get("3"));const D="vscode-coi";function O(U){let K;typeof U=="string"?K=new URL(U).searchParams:U instanceof URL?K=U.searchParams:URI.isUri(U)&&(K=new URL(U.toString(!0)).searchParams);const q=K?.get(D);if(q)return w.get(q)}F.getHeadersFromQuery=O;function W(U,K,q){if(!globalThis.crossOriginIsolated)return;const G=K&&q?"3":q?"2":"1";U instanceof URLSearchParams?U.set(D,G):U[D]=G}F.addSearchParam=W})(COI||(COI={}));function hash(F){return doHash(F,0)}function doHash(F,w){switch(typeof F){case"object":return F===null?numberHash(349,w):Array.isArray(F)?arrayHash(F,w):objectHash(F,w);case"string":return stringHash(F,w);case"boolean":return booleanHash(F,w);case"number":return numberHash(F,w);case"undefined":return numberHash(937,w);default:return numberHash(617,w)}}function numberHash(F,w){return(w<<5)-w+F|0}function booleanHash(F,w){return numberHash(F?433:863,w)}function stringHash(F,w){w=numberHash(149417,w);for(let D=0,O=F.length;D<O;D++)w=numberHash(F.charCodeAt(D),w);return w}function arrayHash(F,w){return w=numberHash(104579,w),F.reduce((D,O)=>doHash(O,D),w)}function objectHash(F,w){return w=numberHash(181387,w),Object.keys(F).sort().reduce((D,O)=>(D=stringHash(O,D),doHash(F[O],D)),w)}function leftRotate$2(F,w,D=32){const O=D-w,W=~((1<<O)-1);return(F<<w|(W&F)>>>O)>>>0}function fill(F,w=0,D=F.byteLength,O=0){for(let W=0;W<D;W++)F[w+W]=O}function leftPad(F,w,D="0"){for(;F.length<w;)F=D+F;return F}function toHexString(F,w=32){return F instanceof ArrayBuffer?Array.from(new Uint8Array(F)).map(D=>D.toString(16).padStart(2,"0")).join(""):leftPad((F>>>0).toString(16),w/4)}class StringSHA1{static{this._bigBlock32=new DataView(new ArrayBuffer(320))}constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(w){const D=w.length;if(D===0)return;const O=this._buff;let W=this._buffLen,U=this._leftoverHighSurrogate,K,q;for(U!==0?(K=U,q=-1,U=0):(K=w.charCodeAt(0),q=0);;){let G=K;if(isHighSurrogate(K))if(q+1<D){const Q=w.charCodeAt(q+1);isLowSurrogate(Q)?(q++,G=computeCodePoint(K,Q)):G=65533}else{U=K;break}else isLowSurrogate(K)&&(G=65533);if(W=this._push(O,W,G),q++,q<D)K=w.charCodeAt(q);else break}this._buffLen=W,this._leftoverHighSurrogate=U}_push(w,D,O){return O<128?w[D++]=O:O<2048?(w[D++]=192|(O&1984)>>>6,w[D++]=128|(O&63)>>>0):O<65536?(w[D++]=224|(O&61440)>>>12,w[D++]=128|(O&4032)>>>6,w[D++]=128|(O&63)>>>0):(w[D++]=240|(O&1835008)>>>18,w[D++]=128|(O&258048)>>>12,w[D++]=128|(O&4032)>>>6,w[D++]=128|(O&63)>>>0),D>=64&&(this._step(),D-=64,this._totalLen+=64,w[0]=w[64],w[1]=w[65],w[2]=w[66]),D}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),toHexString(this._h0)+toHexString(this._h1)+toHexString(this._h2)+toHexString(this._h3)+toHexString(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,fill(this._buff,this._buffLen),this._buffLen>56&&(this._step(),fill(this._buff));const w=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(w/4294967296),!1),this._buffDV.setUint32(60,w%4294967296,!1),this._step()}_step(){const w=StringSHA1._bigBlock32,D=this._buffDV;for(let X=0;X<64;X+=4)w.setUint32(X,D.getUint32(X,!1),!1);for(let X=64;X<320;X+=4)w.setUint32(X,leftRotate$2(w.getUint32(X-12,!1)^w.getUint32(X-32,!1)^w.getUint32(X-56,!1)^w.getUint32(X-64,!1),1),!1);let O=this._h0,W=this._h1,U=this._h2,K=this._h3,q=this._h4,G,Q,Y;for(let X=0;X<80;X++)X<20?(G=W&U|~W&K,Q=1518500249):X<40?(G=W^U^K,Q=1859775393):X<60?(G=W&U|W&K|U&K,Q=2400959708):(G=W^U^K,Q=3395469782),Y=leftRotate$2(O,5)+G+q+Q+w.getUint32(X*4,!1)&4294967295,q=K,K=U,U=leftRotate$2(W,30),W=O,O=Y;this._h0=this._h0+O&4294967295,this._h1=this._h1+W&4294967295,this._h2=this._h2+U&4294967295,this._h3=this._h3+K&4294967295,this._h4=this._h4+q&4294967295}}const{getWindow,getWindows,getWindowsCount,getWindowId,getWindowById,onDidRegisterWindow,onWillUnregisterWindow,onDidUnregisterWindow}=function(){const F=new Map;ensureCodeWindow(mainWindow,1);const w={window:mainWindow,disposables:new DisposableStore};F.set(mainWindow.vscodeWindowId,w);const D=new Emitter$1,O=new Emitter$1,W=new Emitter$1;function U(K,q){return(typeof K=="number"?F.get(K):void 0)??(q?w:void 0)}return{onDidRegisterWindow:D.event,onWillUnregisterWindow:W.event,onDidUnregisterWindow:O.event,registerWindow(K){if(F.has(K.vscodeWindowId))return Disposable.None;const q=new DisposableStore,G={window:K,disposables:q.add(new DisposableStore)};return F.set(K.vscodeWindowId,G),q.add(toDisposable(()=>{F.delete(K.vscodeWindowId),O.fire(K)})),q.add(addDisposableListener(K,EventType$1.BEFORE_UNLOAD,()=>{W.fire(K)})),D.fire(G),q},getWindows(){return F.values()},getWindowsCount(){return F.size},getWindowId(K){return K.vscodeWindowId},hasWindow(K){return F.has(K)},getWindowById:U,getWindow(K){const q=K;if(q?.ownerDocument?.defaultView)return q.ownerDocument.defaultView.window;const G=K;return G?.view?G.view.window:mainWindow},getDocument(K){return getWindow(K).document}}}();function clearNode(F){for(;F.firstChild;)F.firstChild.remove()}class DomListener{constructor(w,D,O,W){this._node=w,this._type=D,this._handler=O,this._options=W||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function addDisposableListener(F,w,D,O){return new DomListener(F,w,D,O)}function _wrapAsStandardMouseEvent(F,w){return function(D){return w(new StandardMouseEvent(F,D))}}function _wrapAsStandardKeyboardEvent(F){return function(w){return F(new StandardKeyboardEvent(w))}}const addStandardDisposableListener=function(w,D,O,W){let U=O;return D==="click"||D==="mousedown"||D==="contextmenu"?U=_wrapAsStandardMouseEvent(getWindow(w),O):(D==="keydown"||D==="keypress"||D==="keyup")&&(U=_wrapAsStandardKeyboardEvent(O)),addDisposableListener(w,D,U,W)};function runWhenWindowIdle(F,w,D){return _runWhenIdle(F,w,D)}class WindowIdleValue extends AbstractIdleValue{constructor(w,D){super(w,D)}}let runAtThisOrScheduleAtNextAnimationFrame,scheduleAtNextAnimationFrame;class WindowIntervalTimer extends IntervalTimer{constructor(w){super(),this.defaultTarget=w&&getWindow(w)}cancelAndSet(w,D,O){return super.cancelAndSet(w,D,O??this.defaultTarget)}}class AnimationFrameQueueItem{constructor(w,D=0){this._runner=w,this.priority=D,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(w){onUnexpectedError(w)}}static sort(w,D){return D.priority-w.priority}}(function(){const F=new Map,w=new Map,D=new Map,O=new Map,W=U=>{D.set(U,!1);const K=F.get(U)??[];for(w.set(U,K),F.set(U,[]),O.set(U,!0);K.length>0;)K.sort(AnimationFrameQueueItem.sort),K.shift().execute();O.set(U,!1)};scheduleAtNextAnimationFrame=(U,K,q=0)=>{const G=getWindowId(U),Q=new AnimationFrameQueueItem(K,q);let Y=F.get(G);return Y||(Y=[],F.set(G,Y)),Y.push(Q),D.get(G)||(D.set(G,!0),U.requestAnimationFrame(()=>W(G))),Q},runAtThisOrScheduleAtNextAnimationFrame=(U,K,q)=>{const G=getWindowId(U);if(O.get(G)){const Q=new AnimationFrameQueueItem(K,q);let Y=w.get(G);return Y||(Y=[],w.set(G,Y)),Y.push(Q),Q}else return scheduleAtNextAnimationFrame(U,K,q)}})();function getComputedStyle$1(F){return getWindow(F).getComputedStyle(F,null)}function getClientArea(F,w){const D=getWindow(F),O=D.document;if(F!==O.body)return new Dimension(F.clientWidth,F.clientHeight);if(isIOS&&D?.visualViewport)return new Dimension(D.visualViewport.width,D.visualViewport.height);if(D?.innerWidth&&D.innerHeight)return new Dimension(D.innerWidth,D.innerHeight);if(O.body&&O.body.clientWidth&&O.body.clientHeight)return new Dimension(O.body.clientWidth,O.body.clientHeight);if(O.documentElement&&O.documentElement.clientWidth&&O.documentElement.clientHeight)return new Dimension(O.documentElement.clientWidth,O.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class SizeUtils{static convertToPixels(w,D){return parseFloat(D)||0}static getDimension(w,D,O){const W=getComputedStyle$1(w),U=W?W.getPropertyValue(D):"0";return SizeUtils.convertToPixels(w,U)}static getBorderLeftWidth(w){return SizeUtils.getDimension(w,"border-left-width","borderLeftWidth")}static getBorderRightWidth(w){return SizeUtils.getDimension(w,"border-right-width","borderRightWidth")}static getBorderTopWidth(w){return SizeUtils.getDimension(w,"border-top-width","borderTopWidth")}static getBorderBottomWidth(w){return SizeUtils.getDimension(w,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(w){return SizeUtils.getDimension(w,"padding-left","paddingLeft")}static getPaddingRight(w){return SizeUtils.getDimension(w,"padding-right","paddingRight")}static getPaddingTop(w){return SizeUtils.getDimension(w,"padding-top","paddingTop")}static getPaddingBottom(w){return SizeUtils.getDimension(w,"padding-bottom","paddingBottom")}static getMarginLeft(w){return SizeUtils.getDimension(w,"margin-left","marginLeft")}static getMarginTop(w){return SizeUtils.getDimension(w,"margin-top","marginTop")}static getMarginRight(w){return SizeUtils.getDimension(w,"margin-right","marginRight")}static getMarginBottom(w){return SizeUtils.getDimension(w,"margin-bottom","marginBottom")}}class Dimension{static{this.None=new Dimension(0,0)}constructor(w,D){this.width=w,this.height=D}with(w=this.width,D=this.height){return w!==this.width||D!==this.height?new Dimension(w,D):this}static is(w){return typeof w=="object"&&typeof w.height=="number"&&typeof w.width=="number"}static lift(w){return w instanceof Dimension?w:new Dimension(w.width,w.height)}static equals(w,D){return w===D?!0:!w||!D?!1:w.width===D.width&&w.height===D.height}}function getTopLeftOffset(F){let w=F.offsetParent,D=F.offsetTop,O=F.offsetLeft;for(;(F=F.parentNode)!==null&&F!==F.ownerDocument.body&&F!==F.ownerDocument.documentElement;){D-=F.scrollTop;const W=isShadowRoot(F)?null:getComputedStyle$1(F);W&&(O-=W.direction!=="rtl"?F.scrollLeft:-F.scrollLeft),F===w&&(O+=SizeUtils.getBorderLeftWidth(F),D+=SizeUtils.getBorderTopWidth(F),D+=F.offsetTop,O+=F.offsetLeft,w=F.offsetParent)}return{left:O,top:D}}function size(F,w,D){typeof w=="number"&&(F.style.width=`${w}px`),typeof D=="number"&&(F.style.height=`${D}px`)}function getDomNodePagePosition(F){const w=F.getBoundingClientRect(),D=getWindow(F);return{left:w.left+D.scrollX,top:w.top+D.scrollY,width:w.width,height:w.height}}function getDomNodeZoomLevel(F){let w=F,D=1;do{const O=getComputedStyle$1(w).zoom;O!=null&&O!=="1"&&(D*=O),w=w.parentElement}while(w!==null&&w!==w.ownerDocument.documentElement);return D}function getTotalWidth(F){const w=SizeUtils.getMarginLeft(F)+SizeUtils.getMarginRight(F);return F.offsetWidth+w}function getContentWidth(F){const w=SizeUtils.getBorderLeftWidth(F)+SizeUtils.getBorderRightWidth(F),D=SizeUtils.getPaddingLeft(F)+SizeUtils.getPaddingRight(F);return F.offsetWidth-w-D}function getContentHeight(F){const w=SizeUtils.getBorderTopWidth(F)+SizeUtils.getBorderBottomWidth(F),D=SizeUtils.getPaddingTop(F)+SizeUtils.getPaddingBottom(F);return F.offsetHeight-w-D}function getTotalHeight(F){const w=SizeUtils.getMarginTop(F)+SizeUtils.getMarginBottom(F);return F.offsetHeight+w}function isAncestor$1(F,w){return!!w?.contains(F)}function findParentWithClass(F,w,D){for(;F&&F.nodeType===F.ELEMENT_NODE;){if(F.classList.contains(w))return F;if(D){if(typeof D=="string"){if(F.classList.contains(D))return null}else if(F===D)return null}F=F.parentNode}return null}function hasParentWithClass(F,w,D){return!!findParentWithClass(F,w,D)}function isShadowRoot(F){return F&&!!F.host&&!!F.mode}function isInShadowDOM(F){return!!getShadowRoot(F)}function getShadowRoot(F){for(;F.parentNode;){if(F===F.ownerDocument?.body)return null;F=F.parentNode}return isShadowRoot(F)?F:null}function getActiveElement(){let F=getActiveDocument().activeElement;for(;F?.shadowRoot;)F=F.shadowRoot.activeElement;return F}function isActiveElement(F){return getActiveElement()===F}function isAncestorOfActiveElement(F){return isAncestor$1(getActiveElement(),F)}function getActiveDocument(){return getWindowsCount()<=1?mainWindow.document:Array.from(getWindows()).map(({window:w})=>w.document).find(w=>w.hasFocus())??mainWindow.document}function getActiveWindow(){return getActiveDocument().defaultView?.window??mainWindow}const globalStylesheets=new Map;function createStyleSheet(F=mainWindow.document.head,w,D){const O=document.createElement("style");if(O.type="text/css",O.media="screen",w?.(O),F.appendChild(O),D&&D.add(toDisposable(()=>O.remove())),F===mainWindow.document.head){const W=new Set;globalStylesheets.set(O,W);for(const{window:U,disposables:K}of getWindows()){if(U===mainWindow)continue;const q=K.add(cloneGlobalStyleSheet(O,W,U));D?.add(q)}}return O}function cloneGlobalStyleSheet(F,w,D){const O=new DisposableStore,W=F.cloneNode(!0);D.document.head.appendChild(W),O.add(toDisposable(()=>W.remove()));for(const U of getDynamicStyleSheetRules(F))W.sheet?.insertRule(U.cssText,W.sheet?.cssRules.length);return O.add(sharedMutationObserver.observe(F,O,{childList:!0})(()=>{W.textContent=F.textContent})),w.add(W),O.add(toDisposable(()=>w.delete(W))),O}const sharedMutationObserver=new class{constructor(){this.mutationObservers=new Map}observe(F,w,D){let O=this.mutationObservers.get(F);O||(O=new Map,this.mutationObservers.set(F,O));const W=hash(D);let U=O.get(W);if(U)U.users+=1;else{const K=new Emitter$1,q=new MutationObserver(Q=>K.fire(Q));q.observe(F,D);const G=U={users:1,observer:q,onDidMutate:K.event};w.add(toDisposable(()=>{G.users-=1,G.users===0&&(K.dispose(),q.disconnect(),O?.delete(W),O?.size===0&&this.mutationObservers.delete(F))})),O.set(W,U)}return U.onDidMutate}};let _sharedStyleSheet=null;function getSharedStyleSheet(){return _sharedStyleSheet||(_sharedStyleSheet=createStyleSheet()),_sharedStyleSheet}function getDynamicStyleSheetRules(F){return F?.sheet?.rules?F.sheet.rules:F?.sheet?.cssRules?F.sheet.cssRules:[]}function createCSSRule(F,w,D=getSharedStyleSheet()){if(!(!D||!w)){D.sheet?.insertRule(`${F} {${w}}`,0);for(const O of globalStylesheets.get(D)??[])createCSSRule(F,w,O)}}function isHTMLElement(F){return F instanceof HTMLElement||F instanceof getWindow(F).HTMLElement}function isHTMLAnchorElement(F){return F instanceof HTMLAnchorElement||F instanceof getWindow(F).HTMLAnchorElement}function isSVGElement(F){return F instanceof SVGElement||F instanceof getWindow(F).SVGElement}function isMouseEvent(F){return F instanceof MouseEvent||F instanceof getWindow(F).MouseEvent}function isKeyboardEvent(F){return F instanceof KeyboardEvent||F instanceof getWindow(F).KeyboardEvent}const EventType$1={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",KEY_DOWN:"keydown",KEY_UP:"keyup",BEFORE_UNLOAD:"beforeunload",CHANGE:"change",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend"};function isEventLike(F){const w=F;return!!(w&&typeof w.preventDefault=="function"&&typeof w.stopPropagation=="function")}const EventHelper={stop:(F,w)=>(F.preventDefault(),w&&F.stopPropagation(),F)};function saveParentsScrollTop(F){const w=[];for(let D=0;F&&F.nodeType===F.ELEMENT_NODE;D++)w[D]=F.scrollTop,F=F.parentNode;return w}function restoreParentsScrollTop(F,w){for(let D=0;F&&F.nodeType===F.ELEMENT_NODE;D++)F.scrollTop!==w[D]&&(F.scrollTop=w[D]),F=F.parentNode}class FocusTracker extends Disposable{static hasFocusWithin(w){if(isHTMLElement(w)){const D=getShadowRoot(w),O=D?D.activeElement:w.ownerDocument.activeElement;return isAncestor$1(O,w)}else{const D=w;return isAncestor$1(D.document.activeElement,D.document)}}constructor(w){super(),this._onDidFocus=this._register(new Emitter$1),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new Emitter$1),this.onDidBlur=this._onDidBlur.event;let D=FocusTracker.hasFocusWithin(w),O=!1;const W=()=>{O=!1,D||(D=!0,this._onDidFocus.fire())},U=()=>{D&&(O=!0,(isHTMLElement(w)?getWindow(w):w).setTimeout(()=>{O&&(O=!1,D=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{FocusTracker.hasFocusWithin(w)!==D&&(D?U():W())},this._register(addDisposableListener(w,EventType$1.FOCUS,W,!0)),this._register(addDisposableListener(w,EventType$1.BLUR,U,!0)),isHTMLElement(w)&&(this._register(addDisposableListener(w,EventType$1.FOCUS_IN,()=>this._refreshStateHandler())),this._register(addDisposableListener(w,EventType$1.FOCUS_OUT,()=>this._refreshStateHandler())))}}function trackFocus(F){return new FocusTracker(F)}function after(F,w){return F.after(w),w}function append$1(F,...w){if(F.append(...w),w.length===1&&typeof w[0]!="string")return w[0]}function prepend$1(F,w){return F.insertBefore(w,F.firstChild),w}function reset(F,...w){F.innerText="",append$1(F,...w)}const SELECTOR_REGEX=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var Namespace;(function(F){F.HTML="http://www.w3.org/1999/xhtml",F.SVG="http://www.w3.org/2000/svg"})(Namespace||(Namespace={}));function _$(F,w,D,...O){const W=SELECTOR_REGEX.exec(w);if(!W)throw new Error("Bad use of emmet");const U=W[1]||"div";let K;return F!==Namespace.HTML?K=document.createElementNS(F,U):K=document.createElement(U),W[3]&&(K.id=W[3]),W[4]&&(K.className=W[4].replace(/\./g," ").trim()),D&&Object.entries(D).forEach(([q,G])=>{typeof G>"u"||(/^on\w+$/.test(q)?K[q]=G:q==="selected"?G&&K.setAttribute(q,"true"):K.setAttribute(q,G))}),K.append(...O),K}function $$8(F,w,...D){return _$(Namespace.HTML,F,w,...D)}$$8.SVG=function(F,w,...D){return _$(Namespace.SVG,F,w,...D)};function show(...F){for(const w of F)w.style.display="",w.removeAttribute("aria-hidden")}function hide(...F){for(const w of F)w.style.display="none",w.setAttribute("aria-hidden","true")}function computeScreenAwareSize(F,w){const D=F.devicePixelRatio*w;return Math.max(1,Math.floor(D))/F.devicePixelRatio}function windowOpenNoOpener(F){mainWindow.open(F,"_blank","noopener")}function animate(F,w){const D=()=>{w(),O=scheduleAtNextAnimationFrame(F,D)};let O=scheduleAtNextAnimationFrame(F,D);return toDisposable(()=>O.dispose())}RemoteAuthorities.setPreferredWebSchema(/^https:/.test(mainWindow.location.href)?"https":"http");function asCSSUrl(F){return F?`url('${FileAccess.uriToBrowserUri(F).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function asCSSPropertyValue(F){return`'${F.replace(/'/g,"%27")}'`}function asCssValueWithDefault(F,w){if(F!==void 0){const D=F.match(/^\s*var\((.+)\)$/);if(D){const O=D[1].split(",",2);return O.length===2&&(w=asCssValueWithDefault(O[1].trim(),w)),`var(${O[0]}, ${w})`}return F}return w}function hookDomPurifyHrefAndSrcSanitizer(F,w=!1){const D=document.createElement("a");return addHook("afterSanitizeAttributes",O=>{for(const W of["href","src"])if(O.hasAttribute(W)){const U=O.getAttribute(W);if(W==="href"&&U.startsWith("#"))continue;if(D.href=U,!F.includes(D.protocol.replace(/:$/,""))){if(w&&W==="src"&&D.href.startsWith("data:"))continue;O.removeAttribute(W)}}}),toDisposable(()=>{removeHook("afterSanitizeAttributes")})}const basicMarkupHtmlTags=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]);class ModifierKeyEmitter extends Emitter$1{constructor(){super(),this._subscriptions=new DisposableStore,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(Event$1.runAndSubscribe(onDidRegisterWindow,({window:w,disposables:D})=>this.registerListeners(w,D),{window:mainWindow,disposables:this._subscriptions}))}registerListeners(w,D){D.add(addDisposableListener(w,"keydown",O=>{if(O.defaultPrevented)return;const W=new StandardKeyboardEvent(O);if(!(W.keyCode===6&&O.repeat)){if(O.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(O.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(O.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(O.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(W.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=O.altKey,this._keyStatus.ctrlKey=O.ctrlKey,this._keyStatus.metaKey=O.metaKey,this._keyStatus.shiftKey=O.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=O,this.fire(this._keyStatus))}},!0)),D.add(addDisposableListener(w,"keyup",O=>{O.defaultPrevented||(!O.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!O.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!O.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!O.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=O.altKey,this._keyStatus.ctrlKey=O.ctrlKey,this._keyStatus.metaKey=O.metaKey,this._keyStatus.shiftKey=O.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=O,this.fire(this._keyStatus)))},!0)),D.add(addDisposableListener(w.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),D.add(addDisposableListener(w.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),D.add(addDisposableListener(w.document.body,"mousemove",O=>{O.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),D.add(addDisposableListener(w,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return ModifierKeyEmitter.instance||(ModifierKeyEmitter.instance=new ModifierKeyEmitter),ModifierKeyEmitter.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}class DragAndDropObserver extends Disposable{constructor(w,D){super(),this.element=w,this.callbacks=D,this.counter=0,this.dragStartTime=0,this.registerListeners()}registerListeners(){this.callbacks.onDragStart&&this._register(addDisposableListener(this.element,EventType$1.DRAG_START,w=>{this.callbacks.onDragStart?.(w)})),this.callbacks.onDrag&&this._register(addDisposableListener(this.element,EventType$1.DRAG,w=>{this.callbacks.onDrag?.(w)})),this._register(addDisposableListener(this.element,EventType$1.DRAG_ENTER,w=>{this.counter++,this.dragStartTime=w.timeStamp,this.callbacks.onDragEnter?.(w)})),this._register(addDisposableListener(this.element,EventType$1.DRAG_OVER,w=>{w.preventDefault(),this.callbacks.onDragOver?.(w,w.timeStamp-this.dragStartTime)})),this._register(addDisposableListener(this.element,EventType$1.DRAG_LEAVE,w=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(w))})),this._register(addDisposableListener(this.element,EventType$1.DRAG_END,w=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(w)})),this._register(addDisposableListener(this.element,EventType$1.DROP,w=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(w)}))}}const H_REGEX=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function h$1(F,...w){let D,O;Array.isArray(w[0])?(D={},O=w[0]):(D=w[0]||{},O=w[1]);const W=H_REGEX.exec(F);if(!W||!W.groups)throw new Error("Bad use of h");const U=W.groups.tag||"div",K=document.createElement(U);W.groups.id&&(K.id=W.groups.id);const q=[];if(W.groups.class)for(const Q of W.groups.class.split("."))Q!==""&&q.push(Q);if(D.className!==void 0)for(const Q of D.className.split("."))Q!==""&&q.push(Q);q.length>0&&(K.className=q.join(" "));const G={};if(W.groups.name&&(G[W.groups.name]=K),O)for(const Q of O)isHTMLElement(Q)?K.appendChild(Q):typeof Q=="string"?K.append(Q):"root"in Q&&(Object.assign(G,Q),K.appendChild(Q.root));for(const[Q,Y]of Object.entries(D))if(Q!=="className")if(Q==="style")for(const[X,J]of Object.entries(Y))K.style.setProperty(camelCaseToHyphenCase(X),typeof J=="number"?J+"px":""+J);else Q==="tabIndex"?K.tabIndex=Y:K.setAttribute(camelCaseToHyphenCase(Q),Y.toString());return G.root=K,G}function camelCaseToHyphenCase(F){return F.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}const MAX_MESSAGE_LENGTH=2e4;let ariaContainer,alertContainer,alertContainer2,statusContainer,statusContainer2;function setARIAContainer(F){ariaContainer=document.createElement("div"),ariaContainer.className="monaco-aria-container";const w=()=>{const O=document.createElement("div");return O.className="monaco-alert",O.setAttribute("role","alert"),O.setAttribute("aria-atomic","true"),ariaContainer.appendChild(O),O};alertContainer=w(),alertContainer2=w();const D=()=>{const O=document.createElement("div");return O.className="monaco-status",O.setAttribute("aria-live","polite"),O.setAttribute("aria-atomic","true"),ariaContainer.appendChild(O),O};statusContainer=D(),statusContainer2=D(),F.appendChild(ariaContainer)}function alert(F){ariaContainer&&(alertContainer.textContent!==F?(clearNode(alertContainer2),insertMessage(alertContainer,F)):(clearNode(alertContainer),insertMessage(alertContainer2,F)))}function status(F){ariaContainer&&(statusContainer.textContent!==F?(clearNode(statusContainer2),insertMessage(statusContainer,F)):(clearNode(statusContainer),insertMessage(statusContainer2,F)))}function insertMessage(F,w){clearNode(F),w.length>MAX_MESSAGE_LENGTH&&(w=w.substr(0,MAX_MESSAGE_LENGTH)),F.textContent=w,F.style.visibility="hidden",F.style.visibility="visible"}function tail(F,w=0){return F[F.length-(1+w)]}function tail2(F){if(F.length===0)throw new Error("Invalid tail call");return[F.slice(0,F.length-1),F[F.length-1]]}function equals$1(F,w,D=(O,W)=>O===W){if(F===w)return!0;if(!F||!w||F.length!==w.length)return!1;for(let O=0,W=F.length;O<W;O++)if(!D(F[O],w[O]))return!1;return!0}function removeFastWithoutKeepingOrder(F,w){const D=F.length-1;w<D&&(F[w]=F[D]),F.pop()}function binarySearch(F,w,D){return binarySearch2(F.length,O=>D(F[O],w))}function binarySearch2(F,w){let D=0,O=F-1;for(;D<=O;){const W=(D+O)/2|0,U=w(W);if(U<0)D=W+1;else if(U>0)O=W-1;else return W}return-(D+1)}function quickSelect(F,w,D){if(F=F|0,F>=w.length)throw new TypeError("invalid index");const O=w[Math.floor(w.length*Math.random())],W=[],U=[],K=[];for(const q of w){const G=D(q,O);G<0?W.push(q):G>0?U.push(q):K.push(q)}return F<W.length?quickSelect(F,W,D):F<W.length+K.length?K[0]:quickSelect(F-(W.length+K.length),U,D)}function groupBy(F,w){const D=[];let O;for(const W of F.slice(0).sort(w))!O||w(O[0],W)!==0?(O=[W],D.push(O)):O.push(W);return D}function*groupAdjacentBy(F,w){let D,O;for(const W of F)O!==void 0&&w(O,W)?D.push(W):(D&&(yield D),D=[W]),O=W;D&&(yield D)}function forEachAdjacent(F,w){for(let D=0;D<=F.length;D++)w(D===0?void 0:F[D-1],D===F.length?void 0:F[D])}function forEachWithNeighbors(F,w){for(let D=0;D<F.length;D++)w(D===0?void 0:F[D-1],F[D],D+1===F.length?void 0:F[D+1])}function coalesce(F){return F.filter(w=>!!w)}function coalesceInPlace(F){let w=0;for(let D=0;D<F.length;D++)F[D]&&(F[w]=F[D],w+=1);F.length=w}function isFalsyOrEmpty(F){return!Array.isArray(F)||F.length===0}function isNonEmptyArray(F){return Array.isArray(F)&&F.length>0}function distinct(F,w=D=>D){const D=new Set;return F.filter(O=>{const W=w(O);return D.has(W)?!1:(D.add(W),!0)})}function firstOrDefault(F,w){return F.length>0?F[0]:w}function range(F,w){let D=typeof w=="number"?F:0;typeof w=="number"?D=F:(D=0,w=F);const O=[];if(D<=w)for(let W=D;W<w;W++)O.push(W);else for(let W=D;W>w;W--)O.push(W);return O}function arrayInsert(F,w,D){const O=F.slice(0,w),W=F.slice(w);return O.concat(D,W)}function pushToStart(F,w){const D=F.indexOf(w);D>-1&&(F.splice(D,1),F.unshift(w))}function pushToEnd(F,w){const D=F.indexOf(w);D>-1&&(F.splice(D,1),F.push(w))}function pushMany(F,w){for(const D of w)F.push(D)}function insertInto(F,w,D){const O=getActualStartIndex(F,w),W=F.length,U=D.length;F.length=W+U;for(let K=W-1;K>=O;K--)F[K+U]=F[K];for(let K=0;K<U;K++)F[K+O]=D[K]}function splice$1(F,w,D,O){const W=getActualStartIndex(F,w);let U=F.splice(W,D);return U===void 0&&(U=[]),insertInto(F,W,O),U}function getActualStartIndex(F,w){return w<0?Math.max(w+F.length,0):Math.min(w,F.length)}var CompareResult;(function(F){function w(U){return U<0}F.isLessThan=w;function D(U){return U<=0}F.isLessThanOrEqual=D;function O(U){return U>0}F.isGreaterThan=O;function W(U){return U===0}F.isNeitherLessOrGreaterThan=W,F.greaterThan=1,F.lessThan=-1,F.neitherLessOrGreaterThan=0})(CompareResult||(CompareResult={}));function compareBy(F,w){return(D,O)=>w(F(D),F(O))}function tieBreakComparators(...F){return(w,D)=>{for(const O of F){const W=O(w,D);if(!CompareResult.isNeitherLessOrGreaterThan(W))return W}return CompareResult.neitherLessOrGreaterThan}}const numberComparator=(F,w)=>F-w,booleanComparator=(F,w)=>numberComparator(F?1:0,w?1:0);function reverseOrder(F){return(w,D)=>-F(w,D)}class ArrayQueue{constructor(w){this.items=w,this.firstIdx=0,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(w){let D=this.firstIdx;for(;D<this.items.length&&w(this.items[D]);)D++;const O=D===this.firstIdx?null:this.items.slice(this.firstIdx,D);return this.firstIdx=D,O}takeFromEndWhile(w){let D=this.lastIdx;for(;D>=0&&w(this.items[D]);)D--;const O=D===this.lastIdx?null:this.items.slice(D+1,this.lastIdx+1);return this.lastIdx=D,O}peek(){if(this.length!==0)return this.items[this.firstIdx]}dequeue(){const w=this.items[this.firstIdx];return this.firstIdx++,w}takeCount(w){const D=this.items.slice(this.firstIdx,this.firstIdx+w);return this.firstIdx+=w,D}}class CallbackIterable{static{this.empty=new CallbackIterable(w=>{})}constructor(w){this.iterate=w}toArray(){const w=[];return this.iterate(D=>(w.push(D),!0)),w}filter(w){return new CallbackIterable(D=>this.iterate(O=>w(O)?D(O):!0))}map(w){return new CallbackIterable(D=>this.iterate(O=>D(w(O))))}findLast(w){let D;return this.iterate(O=>(w(O)&&(D=O),!0)),D}findLastMaxBy(w){let D,O=!0;return this.iterate(W=>((O||CompareResult.isGreaterThan(w(W,D)))&&(O=!1,D=W),!0)),D}}function isString$1(F){return typeof F=="string"}function isObject$1(F){return typeof F=="object"&&F!==null&&!Array.isArray(F)&&!(F instanceof RegExp)&&!(F instanceof Date)}function isTypedArray(F){const w=Object.getPrototypeOf(Uint8Array);return typeof F=="object"&&F instanceof w}function isNumber$1(F){return typeof F=="number"&&!isNaN(F)}function isIterable(F){return!!F&&typeof F[Symbol.iterator]=="function"}function isBoolean$1(F){return F===!0||F===!1}function isUndefined(F){return typeof F>"u"}function isDefined(F){return!isUndefinedOrNull(F)}function isUndefinedOrNull(F){return isUndefined(F)||F===null}function assertType(F,w){if(!F)throw new Error("Unexpected type")}function assertIsDefined(F){if(isUndefinedOrNull(F))throw new Error("Assertion Failed: argument is undefined or null");return F}function isFunction(F){return typeof F=="function"}function validateConstraints(F,w){const D=Math.min(F.length,w.length);for(let O=0;O<D;O++)validateConstraint(F[O],w[O])}function validateConstraint(F,w){if(isString$1(w)){if(typeof F!==w)throw new Error(`argument does not match constraint: typeof ${w}`)}else if(isFunction(w)){try{if(F instanceof w)return}catch{}if(!isUndefinedOrNull(F)&&F.constructor===w||w.length===1&&w.call(void 0,F)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}class StableEditorScrollState{static capture(w){if(w.getScrollTop()===0||w.hasPendingScrollAnimation())return new StableEditorScrollState(w.getScrollTop(),w.getContentHeight(),null,0,null);let D=null,O=0;const W=w.getVisibleRanges();if(W.length>0){D=W[0].getStartPosition();const U=w.getTopForPosition(D.lineNumber,D.column);O=w.getScrollTop()-U}return new StableEditorScrollState(w.getScrollTop(),w.getContentHeight(),D,O,w.getPosition())}constructor(w,D,O,W,U){this._initialScrollTop=w,this._initialContentHeight=D,this._visiblePosition=O,this._visiblePositionScrollDelta=W,this._cursorPosition=U}restore(w){if(!(this._initialContentHeight===w.getContentHeight()&&this._initialScrollTop===w.getScrollTop())&&this._visiblePosition){const D=w.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);w.setScrollTop(D+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(w){if(this._initialContentHeight===w.getContentHeight()&&this._initialScrollTop===w.getScrollTop())return;const D=w.getPosition();if(!this._cursorPosition||!D)return;const O=w.getTopForLineNumber(D.lineNumber)-w.getTopForLineNumber(this._cursorPosition.lineNumber);w.setScrollTop(w.getScrollTop()+O,1)}}var _util;(function(F){F.serviceIds=new Map,F.DI_TARGET="$di$target",F.DI_DEPENDENCIES="$di$dependencies";function w(D){return D[F.DI_DEPENDENCIES]||[]}F.getServiceDependencies=w})(_util||(_util={}));const IInstantiationService=createDecorator("instantiationService");function storeServiceDependency(F,w,D){w[_util.DI_TARGET]===w?w[_util.DI_DEPENDENCIES].push({id:F,index:D}):(w[_util.DI_DEPENDENCIES]=[{id:F,index:D}],w[_util.DI_TARGET]=w)}function createDecorator(F){if(_util.serviceIds.has(F))return _util.serviceIds.get(F);const w=function(D,O,W){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");storeServiceDependency(w,D,W)};return w.toString=()=>F,_util.serviceIds.set(F,w),w}const ICodeEditorService=createDecorator("codeEditorService");let Position$1=class ss{constructor(w,D){this.lineNumber=w,this.column=D}with(w=this.lineNumber,D=this.column){return w===this.lineNumber&&D===this.column?this:new ss(w,D)}delta(w=0,D=0){return this.with(this.lineNumber+w,this.column+D)}equals(w){return ss.equals(this,w)}static equals(w,D){return!w&&!D?!0:!!w&&!!D&&w.lineNumber===D.lineNumber&&w.column===D.column}isBefore(w){return ss.isBefore(this,w)}static isBefore(w,D){return w.lineNumber<D.lineNumber?!0:D.lineNumber<w.lineNumber?!1:w.column<D.column}isBeforeOrEqual(w){return ss.isBeforeOrEqual(this,w)}static isBeforeOrEqual(w,D){return w.lineNumber<D.lineNumber?!0:D.lineNumber<w.lineNumber?!1:w.column<=D.column}static compare(w,D){const O=w.lineNumber|0,W=D.lineNumber|0;if(O===W){const U=w.column|0,K=D.column|0;return U-K}return O-W}clone(){return new ss(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(w){return new ss(w.lineNumber,w.column)}static isIPosition(w){return w&&typeof w.lineNumber=="number"&&typeof w.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};const IModelService=createDecorator("modelService"),ITextModelService=createDecorator("textModelService");class Action extends Disposable{constructor(w,D="",O="",W=!0,U){super(),this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=w,this._label=D,this._cssClass=O,this._enabled=W,this._actionCallback=U}get id(){return this._id}get label(){return this._label}set label(w){this._setLabel(w)}_setLabel(w){this._label!==w&&(this._label=w,this._onDidChange.fire({label:w}))}get tooltip(){return this._tooltip||""}set tooltip(w){this._setTooltip(w)}_setTooltip(w){this._tooltip!==w&&(this._tooltip=w,this._onDidChange.fire({tooltip:w}))}get class(){return this._cssClass}set class(w){this._setClass(w)}_setClass(w){this._cssClass!==w&&(this._cssClass=w,this._onDidChange.fire({class:w}))}get enabled(){return this._enabled}set enabled(w){this._setEnabled(w)}_setEnabled(w){this._enabled!==w&&(this._enabled=w,this._onDidChange.fire({enabled:w}))}get checked(){return this._checked}set checked(w){this._setChecked(w)}_setChecked(w){this._checked!==w&&(this._checked=w,this._onDidChange.fire({checked:w}))}async run(w,D){this._actionCallback&&await this._actionCallback(w)}}class ActionRunner extends Disposable{constructor(){super(...arguments),this._onWillRun=this._register(new Emitter$1),this.onWillRun=this._onWillRun.event,this._onDidRun=this._register(new Emitter$1),this.onDidRun=this._onDidRun.event}async run(w,D){if(!w.enabled)return;this._onWillRun.fire({action:w});let O;try{await this.runAction(w,D)}catch(W){O=W}this._onDidRun.fire({action:w,error:O})}async runAction(w,D){await w.run(D)}}class Separator{constructor(){this.id=Separator.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...w){let D=[];for(const O of w)O.length&&(D.length?D=[...D,new Separator,...O]:D=O);return D}static{this.ID="vs.actions.separator"}async run(){}}class SubmenuAction{get actions(){return this._actions}constructor(w,D,O,W){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=w,this.label=D,this.class=W,this._actions=O}async run(){}}class EmptySubmenuAction extends Action{static{this.ID="vs.actions.empty"}constructor(){super(EmptySubmenuAction.ID,localize("submenu.empty","(empty)"),void 0,!1)}}function toAction(F){return{id:F.id,label:F.label,tooltip:F.tooltip??F.label,class:F.class,enabled:F.enabled??!0,checked:F.checked,run:async(...w)=>F.run(...w)}}const _codiconFontCharacters=Object.create(null);function register$2(F,w){if(isString$1(w)){const D=_codiconFontCharacters[w];if(D===void 0)throw new Error(`${F} references an unknown codicon: ${w}`);w=D}return _codiconFontCharacters[F]=w,{id:F}}function getCodiconFontCharacters(){return _codiconFontCharacters}const codiconsLibrary={add:register$2("add",6e4),plus:register$2("plus",6e4),gistNew:register$2("gist-new",6e4),repoCreate:register$2("repo-create",6e4),lightbulb:register$2("lightbulb",60001),lightBulb:register$2("light-bulb",60001),repo:register$2("repo",60002),repoDelete:register$2("repo-delete",60002),gistFork:register$2("gist-fork",60003),repoForked:register$2("repo-forked",60003),gitPullRequest:register$2("git-pull-request",60004),gitPullRequestAbandoned:register$2("git-pull-request-abandoned",60004),recordKeys:register$2("record-keys",60005),keyboard:register$2("keyboard",60005),tag:register$2("tag",60006),gitPullRequestLabel:register$2("git-pull-request-label",60006),tagAdd:register$2("tag-add",60006),tagRemove:register$2("tag-remove",60006),person:register$2("person",60007),personFollow:register$2("person-follow",60007),personOutline:register$2("person-outline",60007),personFilled:register$2("person-filled",60007),gitBranch:register$2("git-branch",60008),gitBranchCreate:register$2("git-branch-create",60008),gitBranchDelete:register$2("git-branch-delete",60008),sourceControl:register$2("source-control",60008),mirror:register$2("mirror",60009),mirrorPublic:register$2("mirror-public",60009),star:register$2("star",60010),starAdd:register$2("star-add",60010),starDelete:register$2("star-delete",60010),starEmpty:register$2("star-empty",60010),comment:register$2("comment",60011),commentAdd:register$2("comment-add",60011),alert:register$2("alert",60012),warning:register$2("warning",60012),search:register$2("search",60013),searchSave:register$2("search-save",60013),logOut:register$2("log-out",60014),signOut:register$2("sign-out",60014),logIn:register$2("log-in",60015),signIn:register$2("sign-in",60015),eye:register$2("eye",60016),eyeUnwatch:register$2("eye-unwatch",60016),eyeWatch:register$2("eye-watch",60016),circleFilled:register$2("circle-filled",60017),primitiveDot:register$2("primitive-dot",60017),closeDirty:register$2("close-dirty",60017),debugBreakpoint:register$2("debug-breakpoint",60017),debugBreakpointDisabled:register$2("debug-breakpoint-disabled",60017),debugHint:register$2("debug-hint",60017),terminalDecorationSuccess:register$2("terminal-decoration-success",60017),primitiveSquare:register$2("primitive-square",60018),edit:register$2("edit",60019),pencil:register$2("pencil",60019),info:register$2("info",60020),issueOpened:register$2("issue-opened",60020),gistPrivate:register$2("gist-private",60021),gitForkPrivate:register$2("git-fork-private",60021),lock:register$2("lock",60021),mirrorPrivate:register$2("mirror-private",60021),close:register$2("close",60022),removeClose:register$2("remove-close",60022),x:register$2("x",60022),repoSync:register$2("repo-sync",60023),sync:register$2("sync",60023),clone:register$2("clone",60024),desktopDownload:register$2("desktop-download",60024),beaker:register$2("beaker",60025),microscope:register$2("microscope",60025),vm:register$2("vm",60026),deviceDesktop:register$2("device-desktop",60026),file:register$2("file",60027),fileText:register$2("file-text",60027),more:register$2("more",60028),ellipsis:register$2("ellipsis",60028),kebabHorizontal:register$2("kebab-horizontal",60028),mailReply:register$2("mail-reply",60029),reply:register$2("reply",60029),organization:register$2("organization",60030),organizationFilled:register$2("organization-filled",60030),organizationOutline:register$2("organization-outline",60030),newFile:register$2("new-file",60031),fileAdd:register$2("file-add",60031),newFolder:register$2("new-folder",60032),fileDirectoryCreate:register$2("file-directory-create",60032),trash:register$2("trash",60033),trashcan:register$2("trashcan",60033),history:register$2("history",60034),clock:register$2("clock",60034),folder:register$2("folder",60035),fileDirectory:register$2("file-directory",60035),symbolFolder:register$2("symbol-folder",60035),logoGithub:register$2("logo-github",60036),markGithub:register$2("mark-github",60036),github:register$2("github",60036),terminal:register$2("terminal",60037),console:register$2("console",60037),repl:register$2("repl",60037),zap:register$2("zap",60038),symbolEvent:register$2("symbol-event",60038),error:register$2("error",60039),stop:register$2("stop",60039),variable:register$2("variable",60040),symbolVariable:register$2("symbol-variable",60040),array:register$2("array",60042),symbolArray:register$2("symbol-array",60042),symbolModule:register$2("symbol-module",60043),symbolPackage:register$2("symbol-package",60043),symbolNamespace:register$2("symbol-namespace",60043),symbolObject:register$2("symbol-object",60043),symbolMethod:register$2("symbol-method",60044),symbolFunction:register$2("symbol-function",60044),symbolConstructor:register$2("symbol-constructor",60044),symbolBoolean:register$2("symbol-boolean",60047),symbolNull:register$2("symbol-null",60047),symbolNumeric:register$2("symbol-numeric",60048),symbolNumber:register$2("symbol-number",60048),symbolStructure:register$2("symbol-structure",60049),symbolStruct:register$2("symbol-struct",60049),symbolParameter:register$2("symbol-parameter",60050),symbolTypeParameter:register$2("symbol-type-parameter",60050),symbolKey:register$2("symbol-key",60051),symbolText:register$2("symbol-text",60051),symbolReference:register$2("symbol-reference",60052),goToFile:register$2("go-to-file",60052),symbolEnum:register$2("symbol-enum",60053),symbolValue:register$2("symbol-value",60053),symbolRuler:register$2("symbol-ruler",60054),symbolUnit:register$2("symbol-unit",60054),activateBreakpoints:register$2("activate-breakpoints",60055),archive:register$2("archive",60056),arrowBoth:register$2("arrow-both",60057),arrowDown:register$2("arrow-down",60058),arrowLeft:register$2("arrow-left",60059),arrowRight:register$2("arrow-right",60060),arrowSmallDown:register$2("arrow-small-down",60061),arrowSmallLeft:register$2("arrow-small-left",60062),arrowSmallRight:register$2("arrow-small-right",60063),arrowSmallUp:register$2("arrow-small-up",60064),arrowUp:register$2("arrow-up",60065),bell:register$2("bell",60066),bold:register$2("bold",60067),book:register$2("book",60068),bookmark:register$2("bookmark",60069),debugBreakpointConditionalUnverified:register$2("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:register$2("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:register$2("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:register$2("debug-breakpoint-data-unverified",60072),debugBreakpointData:register$2("debug-breakpoint-data",60073),debugBreakpointDataDisabled:register$2("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:register$2("debug-breakpoint-log-unverified",60074),debugBreakpointLog:register$2("debug-breakpoint-log",60075),debugBreakpointLogDisabled:register$2("debug-breakpoint-log-disabled",60075),briefcase:register$2("briefcase",60076),broadcast:register$2("broadcast",60077),browser:register$2("browser",60078),bug:register$2("bug",60079),calendar:register$2("calendar",60080),caseSensitive:register$2("case-sensitive",60081),check:register$2("check",60082),checklist:register$2("checklist",60083),chevronDown:register$2("chevron-down",60084),chevronLeft:register$2("chevron-left",60085),chevronRight:register$2("chevron-right",60086),chevronUp:register$2("chevron-up",60087),chromeClose:register$2("chrome-close",60088),chromeMaximize:register$2("chrome-maximize",60089),chromeMinimize:register$2("chrome-minimize",60090),chromeRestore:register$2("chrome-restore",60091),circleOutline:register$2("circle-outline",60092),circle:register$2("circle",60092),debugBreakpointUnverified:register$2("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:register$2("terminal-decoration-incomplete",60092),circleSlash:register$2("circle-slash",60093),circuitBoard:register$2("circuit-board",60094),clearAll:register$2("clear-all",60095),clippy:register$2("clippy",60096),closeAll:register$2("close-all",60097),cloudDownload:register$2("cloud-download",60098),cloudUpload:register$2("cloud-upload",60099),code:register$2("code",60100),collapseAll:register$2("collapse-all",60101),colorMode:register$2("color-mode",60102),commentDiscussion:register$2("comment-discussion",60103),creditCard:register$2("credit-card",60105),dash:register$2("dash",60108),dashboard:register$2("dashboard",60109),database:register$2("database",60110),debugContinue:register$2("debug-continue",60111),debugDisconnect:register$2("debug-disconnect",60112),debugPause:register$2("debug-pause",60113),debugRestart:register$2("debug-restart",60114),debugStart:register$2("debug-start",60115),debugStepInto:register$2("debug-step-into",60116),debugStepOut:register$2("debug-step-out",60117),debugStepOver:register$2("debug-step-over",60118),debugStop:register$2("debug-stop",60119),debug:register$2("debug",60120),deviceCameraVideo:register$2("device-camera-video",60121),deviceCamera:register$2("device-camera",60122),deviceMobile:register$2("device-mobile",60123),diffAdded:register$2("diff-added",60124),diffIgnored:register$2("diff-ignored",60125),diffModified:register$2("diff-modified",60126),diffRemoved:register$2("diff-removed",60127),diffRenamed:register$2("diff-renamed",60128),diff:register$2("diff",60129),diffSidebyside:register$2("diff-sidebyside",60129),discard:register$2("discard",60130),editorLayout:register$2("editor-layout",60131),emptyWindow:register$2("empty-window",60132),exclude:register$2("exclude",60133),extensions:register$2("extensions",60134),eyeClosed:register$2("eye-closed",60135),fileBinary:register$2("file-binary",60136),fileCode:register$2("file-code",60137),fileMedia:register$2("file-media",60138),filePdf:register$2("file-pdf",60139),fileSubmodule:register$2("file-submodule",60140),fileSymlinkDirectory:register$2("file-symlink-directory",60141),fileSymlinkFile:register$2("file-symlink-file",60142),fileZip:register$2("file-zip",60143),files:register$2("files",60144),filter:register$2("filter",60145),flame:register$2("flame",60146),foldDown:register$2("fold-down",60147),foldUp:register$2("fold-up",60148),fold:register$2("fold",60149),folderActive:register$2("folder-active",60150),folderOpened:register$2("folder-opened",60151),gear:register$2("gear",60152),gift:register$2("gift",60153),gistSecret:register$2("gist-secret",60154),gist:register$2("gist",60155),gitCommit:register$2("git-commit",60156),gitCompare:register$2("git-compare",60157),compareChanges:register$2("compare-changes",60157),gitMerge:register$2("git-merge",60158),githubAction:register$2("github-action",60159),githubAlt:register$2("github-alt",60160),globe:register$2("globe",60161),grabber:register$2("grabber",60162),graph:register$2("graph",60163),gripper:register$2("gripper",60164),heart:register$2("heart",60165),home:register$2("home",60166),horizontalRule:register$2("horizontal-rule",60167),hubot:register$2("hubot",60168),inbox:register$2("inbox",60169),issueReopened:register$2("issue-reopened",60171),issues:register$2("issues",60172),italic:register$2("italic",60173),jersey:register$2("jersey",60174),json:register$2("json",60175),kebabVertical:register$2("kebab-vertical",60176),key:register$2("key",60177),law:register$2("law",60178),lightbulbAutofix:register$2("lightbulb-autofix",60179),linkExternal:register$2("link-external",60180),link:register$2("link",60181),listOrdered:register$2("list-ordered",60182),listUnordered:register$2("list-unordered",60183),liveShare:register$2("live-share",60184),loading:register$2("loading",60185),location:register$2("location",60186),mailRead:register$2("mail-read",60187),mail:register$2("mail",60188),markdown:register$2("markdown",60189),megaphone:register$2("megaphone",60190),mention:register$2("mention",60191),milestone:register$2("milestone",60192),gitPullRequestMilestone:register$2("git-pull-request-milestone",60192),mortarBoard:register$2("mortar-board",60193),move:register$2("move",60194),multipleWindows:register$2("multiple-windows",60195),mute:register$2("mute",60196),noNewline:register$2("no-newline",60197),note:register$2("note",60198),octoface:register$2("octoface",60199),openPreview:register$2("open-preview",60200),package:register$2("package",60201),paintcan:register$2("paintcan",60202),pin:register$2("pin",60203),play:register$2("play",60204),run:register$2("run",60204),plug:register$2("plug",60205),preserveCase:register$2("preserve-case",60206),preview:register$2("preview",60207),project:register$2("project",60208),pulse:register$2("pulse",60209),question:register$2("question",60210),quote:register$2("quote",60211),radioTower:register$2("radio-tower",60212),reactions:register$2("reactions",60213),references:register$2("references",60214),refresh:register$2("refresh",60215),regex:register$2("regex",60216),remoteExplorer:register$2("remote-explorer",60217),remote:register$2("remote",60218),remove:register$2("remove",60219),replaceAll:register$2("replace-all",60220),replace:register$2("replace",60221),repoClone:register$2("repo-clone",60222),repoForcePush:register$2("repo-force-push",60223),repoPull:register$2("repo-pull",60224),repoPush:register$2("repo-push",60225),report:register$2("report",60226),requestChanges:register$2("request-changes",60227),rocket:register$2("rocket",60228),rootFolderOpened:register$2("root-folder-opened",60229),rootFolder:register$2("root-folder",60230),rss:register$2("rss",60231),ruby:register$2("ruby",60232),saveAll:register$2("save-all",60233),saveAs:register$2("save-as",60234),save:register$2("save",60235),screenFull:register$2("screen-full",60236),screenNormal:register$2("screen-normal",60237),searchStop:register$2("search-stop",60238),server:register$2("server",60240),settingsGear:register$2("settings-gear",60241),settings:register$2("settings",60242),shield:register$2("shield",60243),smiley:register$2("smiley",60244),sortPrecedence:register$2("sort-precedence",60245),splitHorizontal:register$2("split-horizontal",60246),splitVertical:register$2("split-vertical",60247),squirrel:register$2("squirrel",60248),starFull:register$2("star-full",60249),starHalf:register$2("star-half",60250),symbolClass:register$2("symbol-class",60251),symbolColor:register$2("symbol-color",60252),symbolConstant:register$2("symbol-constant",60253),symbolEnumMember:register$2("symbol-enum-member",60254),symbolField:register$2("symbol-field",60255),symbolFile:register$2("symbol-file",60256),symbolInterface:register$2("symbol-interface",60257),symbolKeyword:register$2("symbol-keyword",60258),symbolMisc:register$2("symbol-misc",60259),symbolOperator:register$2("symbol-operator",60260),symbolProperty:register$2("symbol-property",60261),wrench:register$2("wrench",60261),wrenchSubaction:register$2("wrench-subaction",60261),symbolSnippet:register$2("symbol-snippet",60262),tasklist:register$2("tasklist",60263),telescope:register$2("telescope",60264),textSize:register$2("text-size",60265),threeBars:register$2("three-bars",60266),thumbsdown:register$2("thumbsdown",60267),thumbsup:register$2("thumbsup",60268),tools:register$2("tools",60269),triangleDown:register$2("triangle-down",60270),triangleLeft:register$2("triangle-left",60271),triangleRight:register$2("triangle-right",60272),triangleUp:register$2("triangle-up",60273),twitter:register$2("twitter",60274),unfold:register$2("unfold",60275),unlock:register$2("unlock",60276),unmute:register$2("unmute",60277),unverified:register$2("unverified",60278),verified:register$2("verified",60279),versions:register$2("versions",60280),vmActive:register$2("vm-active",60281),vmOutline:register$2("vm-outline",60282),vmRunning:register$2("vm-running",60283),watch:register$2("watch",60284),whitespace:register$2("whitespace",60285),wholeWord:register$2("whole-word",60286),window:register$2("window",60287),wordWrap:register$2("word-wrap",60288),zoomIn:register$2("zoom-in",60289),zoomOut:register$2("zoom-out",60290),listFilter:register$2("list-filter",60291),listFlat:register$2("list-flat",60292),listSelection:register$2("list-selection",60293),selection:register$2("selection",60293),listTree:register$2("list-tree",60294),debugBreakpointFunctionUnverified:register$2("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:register$2("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:register$2("debug-breakpoint-function-disabled",60296),debugStackframeActive:register$2("debug-stackframe-active",60297),circleSmallFilled:register$2("circle-small-filled",60298),debugStackframeDot:register$2("debug-stackframe-dot",60298),terminalDecorationMark:register$2("terminal-decoration-mark",60298),debugStackframe:register$2("debug-stackframe",60299),debugStackframeFocused:register$2("debug-stackframe-focused",60299),debugBreakpointUnsupported:register$2("debug-breakpoint-unsupported",60300),symbolString:register$2("symbol-string",60301),debugReverseContinue:register$2("debug-reverse-continue",60302),debugStepBack:register$2("debug-step-back",60303),debugRestartFrame:register$2("debug-restart-frame",60304),debugAlt:register$2("debug-alt",60305),callIncoming:register$2("call-incoming",60306),callOutgoing:register$2("call-outgoing",60307),menu:register$2("menu",60308),expandAll:register$2("expand-all",60309),feedback:register$2("feedback",60310),gitPullRequestReviewer:register$2("git-pull-request-reviewer",60310),groupByRefType:register$2("group-by-ref-type",60311),ungroupByRefType:register$2("ungroup-by-ref-type",60312),account:register$2("account",60313),gitPullRequestAssignee:register$2("git-pull-request-assignee",60313),bellDot:register$2("bell-dot",60314),debugConsole:register$2("debug-console",60315),library:register$2("library",60316),output:register$2("output",60317),runAll:register$2("run-all",60318),syncIgnored:register$2("sync-ignored",60319),pinned:register$2("pinned",60320),githubInverted:register$2("github-inverted",60321),serverProcess:register$2("server-process",60322),serverEnvironment:register$2("server-environment",60323),pass:register$2("pass",60324),issueClosed:register$2("issue-closed",60324),stopCircle:register$2("stop-circle",60325),playCircle:register$2("play-circle",60326),record:register$2("record",60327),debugAltSmall:register$2("debug-alt-small",60328),vmConnect:register$2("vm-connect",60329),cloud:register$2("cloud",60330),merge:register$2("merge",60331),export:register$2("export",60332),graphLeft:register$2("graph-left",60333),magnet:register$2("magnet",60334),notebook:register$2("notebook",60335),redo:register$2("redo",60336),checkAll:register$2("check-all",60337),pinnedDirty:register$2("pinned-dirty",60338),passFilled:register$2("pass-filled",60339),circleLargeFilled:register$2("circle-large-filled",60340),circleLarge:register$2("circle-large",60341),circleLargeOutline:register$2("circle-large-outline",60341),combine:register$2("combine",60342),gather:register$2("gather",60342),table:register$2("table",60343),variableGroup:register$2("variable-group",60344),typeHierarchy:register$2("type-hierarchy",60345),typeHierarchySub:register$2("type-hierarchy-sub",60346),typeHierarchySuper:register$2("type-hierarchy-super",60347),gitPullRequestCreate:register$2("git-pull-request-create",60348),runAbove:register$2("run-above",60349),runBelow:register$2("run-below",60350),notebookTemplate:register$2("notebook-template",60351),debugRerun:register$2("debug-rerun",60352),workspaceTrusted:register$2("workspace-trusted",60353),workspaceUntrusted:register$2("workspace-untrusted",60354),workspaceUnknown:register$2("workspace-unknown",60355),terminalCmd:register$2("terminal-cmd",60356),terminalDebian:register$2("terminal-debian",60357),terminalLinux:register$2("terminal-linux",60358),terminalPowershell:register$2("terminal-powershell",60359),terminalTmux:register$2("terminal-tmux",60360),terminalUbuntu:register$2("terminal-ubuntu",60361),terminalBash:register$2("terminal-bash",60362),arrowSwap:register$2("arrow-swap",60363),copy:register$2("copy",60364),personAdd:register$2("person-add",60365),filterFilled:register$2("filter-filled",60366),wand:register$2("wand",60367),debugLineByLine:register$2("debug-line-by-line",60368),inspect:register$2("inspect",60369),layers:register$2("layers",60370),layersDot:register$2("layers-dot",60371),layersActive:register$2("layers-active",60372),compass:register$2("compass",60373),compassDot:register$2("compass-dot",60374),compassActive:register$2("compass-active",60375),azure:register$2("azure",60376),issueDraft:register$2("issue-draft",60377),gitPullRequestClosed:register$2("git-pull-request-closed",60378),gitPullRequestDraft:register$2("git-pull-request-draft",60379),debugAll:register$2("debug-all",60380),debugCoverage:register$2("debug-coverage",60381),runErrors:register$2("run-errors",60382),folderLibrary:register$2("folder-library",60383),debugContinueSmall:register$2("debug-continue-small",60384),beakerStop:register$2("beaker-stop",60385),graphLine:register$2("graph-line",60386),graphScatter:register$2("graph-scatter",60387),pieChart:register$2("pie-chart",60388),bracket:register$2("bracket",60175),bracketDot:register$2("bracket-dot",60389),bracketError:register$2("bracket-error",60390),lockSmall:register$2("lock-small",60391),azureDevops:register$2("azure-devops",60392),verifiedFilled:register$2("verified-filled",60393),newline:register$2("newline",60394),layout:register$2("layout",60395),layoutActivitybarLeft:register$2("layout-activitybar-left",60396),layoutActivitybarRight:register$2("layout-activitybar-right",60397),layoutPanelLeft:register$2("layout-panel-left",60398),layoutPanelCenter:register$2("layout-panel-center",60399),layoutPanelJustify:register$2("layout-panel-justify",60400),layoutPanelRight:register$2("layout-panel-right",60401),layoutPanel:register$2("layout-panel",60402),layoutSidebarLeft:register$2("layout-sidebar-left",60403),layoutSidebarRight:register$2("layout-sidebar-right",60404),layoutStatusbar:register$2("layout-statusbar",60405),layoutMenubar:register$2("layout-menubar",60406),layoutCentered:register$2("layout-centered",60407),target:register$2("target",60408),indent:register$2("indent",60409),recordSmall:register$2("record-small",60410),errorSmall:register$2("error-small",60411),terminalDecorationError:register$2("terminal-decoration-error",60411),arrowCircleDown:register$2("arrow-circle-down",60412),arrowCircleLeft:register$2("arrow-circle-left",60413),arrowCircleRight:register$2("arrow-circle-right",60414),arrowCircleUp:register$2("arrow-circle-up",60415),layoutSidebarRightOff:register$2("layout-sidebar-right-off",60416),layoutPanelOff:register$2("layout-panel-off",60417),layoutSidebarLeftOff:register$2("layout-sidebar-left-off",60418),blank:register$2("blank",60419),heartFilled:register$2("heart-filled",60420),map:register$2("map",60421),mapHorizontal:register$2("map-horizontal",60421),foldHorizontal:register$2("fold-horizontal",60421),mapFilled:register$2("map-filled",60422),mapHorizontalFilled:register$2("map-horizontal-filled",60422),foldHorizontalFilled:register$2("fold-horizontal-filled",60422),circleSmall:register$2("circle-small",60423),bellSlash:register$2("bell-slash",60424),bellSlashDot:register$2("bell-slash-dot",60425),commentUnresolved:register$2("comment-unresolved",60426),gitPullRequestGoToChanges:register$2("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:register$2("git-pull-request-new-changes",60428),searchFuzzy:register$2("search-fuzzy",60429),commentDraft:register$2("comment-draft",60430),send:register$2("send",60431),sparkle:register$2("sparkle",60432),insert:register$2("insert",60433),mic:register$2("mic",60434),thumbsdownFilled:register$2("thumbsdown-filled",60435),thumbsupFilled:register$2("thumbsup-filled",60436),coffee:register$2("coffee",60437),snake:register$2("snake",60438),game:register$2("game",60439),vr:register$2("vr",60440),chip:register$2("chip",60441),piano:register$2("piano",60442),music:register$2("music",60443),micFilled:register$2("mic-filled",60444),repoFetch:register$2("repo-fetch",60445),copilot:register$2("copilot",60446),lightbulbSparkle:register$2("lightbulb-sparkle",60447),robot:register$2("robot",60448),sparkleFilled:register$2("sparkle-filled",60449),diffSingle:register$2("diff-single",60450),diffMultiple:register$2("diff-multiple",60451),surroundWith:register$2("surround-with",60452),share:register$2("share",60453),gitStash:register$2("git-stash",60454),gitStashApply:register$2("git-stash-apply",60455),gitStashPop:register$2("git-stash-pop",60456),vscode:register$2("vscode",60457),vscodeInsiders:register$2("vscode-insiders",60458),codeOss:register$2("code-oss",60459),runCoverage:register$2("run-coverage",60460),runAllCoverage:register$2("run-all-coverage",60461),coverage:register$2("coverage",60462),githubProject:register$2("github-project",60463),mapVertical:register$2("map-vertical",60464),foldVertical:register$2("fold-vertical",60464),mapVerticalFilled:register$2("map-vertical-filled",60465),foldVerticalFilled:register$2("fold-vertical-filled",60465),goToSearch:register$2("go-to-search",60466),percentage:register$2("percentage",60467),sortPercentage:register$2("sort-percentage",60467),attach:register$2("attach",60468)},codiconsDerived={dialogError:register$2("dialog-error","error"),dialogWarning:register$2("dialog-warning","warning"),dialogInfo:register$2("dialog-info","info"),dialogClose:register$2("dialog-close","close"),treeItemExpanded:register$2("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:register$2("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:register$2("tree-filter-on-type-off","list-selection"),treeFilterClear:register$2("tree-filter-clear","close"),treeItemLoading:register$2("tree-item-loading","loading"),menuSelection:register$2("menu-selection","check"),menuSubmenu:register$2("menu-submenu","chevron-right"),menuBarMore:register$2("menubar-more","more"),scrollbarButtonLeft:register$2("scrollbar-button-left","triangle-left"),scrollbarButtonRight:register$2("scrollbar-button-right","triangle-right"),scrollbarButtonUp:register$2("scrollbar-button-up","triangle-up"),scrollbarButtonDown:register$2("scrollbar-button-down","triangle-down"),toolBarMore:register$2("toolbar-more","more"),quickInputBack:register$2("quick-input-back","arrow-left"),dropDownButton:register$2("drop-down-button",60084),symbolCustomColor:register$2("symbol-customcolor",60252),exportIcon:register$2("export",60332),workspaceUnspecified:register$2("workspace-unspecified",60355),newLine:register$2("newline",60394),thumbsDownFilled:register$2("thumbsdown-filled",60435),thumbsUpFilled:register$2("thumbsup-filled",60436),gitFetch:register$2("git-fetch",60445),lightbulbSparkleAutofix:register$2("lightbulb-sparkle-autofix",60447),debugBreakpointPending:register$2("debug-breakpoint-pending",60377)},Codicon={...codiconsLibrary,...codiconsDerived};var ThemeColor;(function(F){function w(D){return D&&typeof D=="object"&&typeof D.id=="string"}F.isThemeColor=w})(ThemeColor||(ThemeColor={}));var ThemeIcon;(function(F){F.iconNameSegment="[A-Za-z0-9]+",F.iconNameExpression="[A-Za-z0-9-]+",F.iconModifierExpression="~[A-Za-z]+",F.iconNameCharacter="[A-Za-z0-9~-]";const w=new RegExp(`^(${F.iconNameExpression})(${F.iconModifierExpression})?$`);function D(J){const te=w.exec(J.id);if(!te)return D(Codicon.error);const[,ie,se]=te,re=["codicon","codicon-"+ie];return se&&re.push("codicon-modifier-"+se.substring(1)),re}F.asClassNameArray=D;function O(J){return D(J).join(" ")}F.asClassName=O;function W(J){return"."+D(J).join(".")}F.asCSSSelector=W;function U(J){return J&&typeof J=="object"&&typeof J.id=="string"&&(typeof J.color>"u"||ThemeColor.isThemeColor(J.color))}F.isThemeIcon=U;const K=new RegExp(`^\\$\\((${F.iconNameExpression}(?:${F.iconModifierExpression})?)\\)$`);function q(J){const te=K.exec(J);if(!te)return;const[,ie]=te;return{id:ie}}F.fromString=q;function G(J){return{id:J}}F.fromId=G;function Q(J,te){let ie=J.id;const se=ie.lastIndexOf("~");return se!==-1&&(ie=ie.substring(0,se)),te&&(ie=`${ie}~${te}`),{id:ie}}F.modify=Q;function Y(J){const te=J.id.lastIndexOf("~");if(te!==-1)return J.id.substring(te+1)}F.getModifier=Y;function X(J,te){return J.id===te.id&&J.color?.id===te.color?.id}F.isEqual=X})(ThemeIcon||(ThemeIcon={}));const ICommandService=createDecorator("commandService"),CommandsRegistry=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new Emitter$1,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(F,w){if(!F)throw new Error("invalid command");if(typeof F=="string"){if(!w)throw new Error("invalid command");return this.registerCommand({id:F,handler:w})}if(F.metadata&&Array.isArray(F.metadata.args)){const K=[];for(const G of F.metadata.args)K.push(G.constraint);const q=F.handler;F.handler=function(G,...Q){return validateConstraints(Q,K),q(G,...Q)}}const{id:D}=F;let O=this._commands.get(D);O||(O=new LinkedList,this._commands.set(D,O));const W=O.unshift(F),U=toDisposable(()=>{W(),this._commands.get(D)?.isEmpty()&&this._commands.delete(D)});return this._onDidRegisterCommand.fire(D),U}registerCommandAlias(F,w){return CommandsRegistry.registerCommand(F,(D,...O)=>D.get(ICommandService).executeCommand(w,...O))}getCommand(F){const w=this._commands.get(F);if(!(!w||w.isEmpty()))return Iterable.first(w)}getCommands(){const F=new Map;for(const w of this._commands.keys()){const D=this.getCommand(w);D&&F.set(w,D)}return F}};CommandsRegistry.registerCommand("noop",()=>{});function hintDidYouMean(...F){switch(F.length){case 1:return localize("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",F[0]);case 2:return localize("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",F[0],F[1]);case 3:return localize("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",F[0],F[1],F[2]);default:return}}const hintDidYouForgetToOpenOrCloseQuote=localize("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),hintDidYouForgetToEscapeSlash=localize("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");let Scanner$1=class Ho{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(w){switch(w.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return w.isTripleEq?"===":"==";case 4:return w.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return w.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return w.lexeme;case 18:return w.lexeme;case 19:return w.lexeme;case 20:return"EOF";default:throw illegalState(`unhandled token type: ${JSON.stringify(w)}; have you forgotten to add a case?`)}}static{this._regexFlags=new Set(["i","g","s","m","y","u"].map(w=>w.charCodeAt(0)))}static{this._keywords=new Map([["not",14],["in",13],["false",12],["true",11]])}reset(w){return this._input=w,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const D=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:D})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const D=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:D})}else this._match(126)?this._addToken(9):this._error(hintDidYouMean("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(hintDidYouMean("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(hintDidYouMean("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(w){return this._isAtEnd()||this._input.charCodeAt(this._current)!==w?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(w){this._tokens.push({type:w,offset:this._start})}_error(w){const D=this._start,O=this._input.substring(this._start,this._current),W={type:19,offset:this._start,lexeme:O};this._errors.push({offset:D,lexeme:O,additionalInfo:w}),this._tokens.push(W)}_string(){this.stringRe.lastIndex=this._start;const w=this.stringRe.exec(this._input);if(w){this._current=this._start+w[0].length;const D=this._input.substring(this._start,this._current),O=Ho._keywords.get(D);O?this._addToken(O):this._tokens.push({type:17,lexeme:D,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(hintDidYouForgetToOpenOrCloseQuote);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let w=this._current,D=!1,O=!1;for(;;){if(w>=this._input.length){this._current=w,this._error(hintDidYouForgetToEscapeSlash);return}const U=this._input.charCodeAt(w);if(D)D=!1;else if(U===47&&!O){w++;break}else U===91?O=!0:U===92?D=!0:U===93&&(O=!1);w++}for(;w<this._input.length&&Ho._regexFlags.has(this._input.charCodeAt(w));)w++;this._current=w;const W=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:W,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};const CONSTANT_VALUES=new Map;CONSTANT_VALUES.set("false",!1);CONSTANT_VALUES.set("true",!0);CONSTANT_VALUES.set("isMac",isMacintosh);CONSTANT_VALUES.set("isLinux",isLinux);CONSTANT_VALUES.set("isWindows",isWindows);CONSTANT_VALUES.set("isWeb",isWeb);CONSTANT_VALUES.set("isMacNative",isMacintosh&&!isWeb);CONSTANT_VALUES.set("isEdge",isEdge);CONSTANT_VALUES.set("isFirefox",isFirefox);CONSTANT_VALUES.set("isChrome",isChrome);CONSTANT_VALUES.set("isSafari",isSafari);const hasOwnProperty$1=Object.prototype.hasOwnProperty,defaultConfig={regexParsingWithErrorRecovery:!0},errorEmptyString=localize("contextkey.parser.error.emptyString","Empty context key expression"),hintEmptyString=localize("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),errorNoInAfterNot=localize("contextkey.parser.error.noInAfterNot","'in' after 'not'."),errorClosingParenthesis=localize("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),errorUnexpectedToken=localize("contextkey.parser.error.unexpectedToken","Unexpected token"),hintUnexpectedToken=localize("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),errorUnexpectedEOF=localize("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),hintUnexpectedEOF=localize("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?");let Parser$1=class $s{static{this._parseError=new Error}constructor(w=defaultConfig){this._config=w,this._scanner=new Scanner$1,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(w){if(w===""){this._parsingErrors.push({message:errorEmptyString,offset:0,lexeme:"",additionalInfo:hintEmptyString});return}this._tokens=this._scanner.reset(w).scan(),this._current=0,this._parsingErrors=[];try{const D=this._expr();if(!this._isAtEnd()){const O=this._peek(),W=O.type===17?hintUnexpectedToken:void 0;throw this._parsingErrors.push({message:errorUnexpectedToken,offset:O.offset,lexeme:Scanner$1.getLexeme(O),additionalInfo:W}),$s._parseError}return D}catch(D){if(D!==$s._parseError)throw D;return}}_expr(){return this._or()}_or(){const w=[this._and()];for(;this._matchOne(16);){const D=this._and();w.push(D)}return w.length===1?w[0]:ContextKeyExpr.or(...w)}_and(){const w=[this._term()];for(;this._matchOne(15);){const D=this._term();w.push(D)}return w.length===1?w[0]:ContextKeyExpr.and(...w)}_term(){if(this._matchOne(2)){const w=this._peek();switch(w.type){case 11:return this._advance(),ContextKeyFalseExpr.INSTANCE;case 12:return this._advance(),ContextKeyTrueExpr.INSTANCE;case 0:{this._advance();const D=this._expr();return this._consume(1,errorClosingParenthesis),D?.negate()}case 17:return this._advance(),ContextKeyNotExpr.create(w.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",w)}}return this._primary()}_primary(){const w=this._peek();switch(w.type){case 11:return this._advance(),ContextKeyExpr.true();case 12:return this._advance(),ContextKeyExpr.false();case 0:{this._advance();const D=this._expr();return this._consume(1,errorClosingParenthesis),D}case 17:{const D=w.lexeme;if(this._advance(),this._matchOne(9)){const W=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),W.type!==10)throw this._errExpectedButGot("REGEX",W);const U=W.lexeme,K=U.lastIndexOf("/"),q=K===U.length-1?void 0:this._removeFlagsGY(U.substring(K+1));let G;try{G=new RegExp(U.substring(1,K),q)}catch{throw this._errExpectedButGot("REGEX",W)}return ContextKeyRegexExpr.create(D,G)}switch(W.type){case 10:case 19:{const U=[W.lexeme];this._advance();let K=this._peek(),q=0;for(let J=0;J<W.lexeme.length;J++)W.lexeme.charCodeAt(J)===40?q++:W.lexeme.charCodeAt(J)===41&&q--;for(;!this._isAtEnd()&&K.type!==15&&K.type!==16;){switch(K.type){case 0:q++;break;case 1:q--;break;case 10:case 18:for(let J=0;J<K.lexeme.length;J++)K.lexeme.charCodeAt(J)===40?q++:W.lexeme.charCodeAt(J)===41&&q--}if(q<0)break;U.push(Scanner$1.getLexeme(K)),this._advance(),K=this._peek()}const G=U.join(""),Q=G.lastIndexOf("/"),Y=Q===G.length-1?void 0:this._removeFlagsGY(G.substring(Q+1));let X;try{X=new RegExp(G.substring(1,Q),Y)}catch{throw this._errExpectedButGot("REGEX",W)}return ContextKeyExpr.regex(D,X)}case 18:{const U=W.lexeme;this._advance();let K=null;if(!isFalsyOrWhitespace(U)){const q=U.indexOf("/"),G=U.lastIndexOf("/");if(q!==G&&q>=0){const Q=U.slice(q+1,G),Y=U[G+1]==="i"?"i":"";try{K=new RegExp(Q,Y)}catch{throw this._errExpectedButGot("REGEX",W)}}}if(K===null)throw this._errExpectedButGot("REGEX",W);return ContextKeyRegexExpr.create(D,K)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,errorNoInAfterNot);const W=this._value();return ContextKeyExpr.notIn(D,W)}switch(this._peek().type){case 3:{this._advance();const W=this._value();if(this._previous().type===18)return ContextKeyExpr.equals(D,W);switch(W){case"true":return ContextKeyExpr.has(D);case"false":return ContextKeyExpr.not(D);default:return ContextKeyExpr.equals(D,W)}}case 4:{this._advance();const W=this._value();if(this._previous().type===18)return ContextKeyExpr.notEquals(D,W);switch(W){case"true":return ContextKeyExpr.not(D);case"false":return ContextKeyExpr.has(D);default:return ContextKeyExpr.notEquals(D,W)}}case 5:return this._advance(),ContextKeySmallerExpr.create(D,this._value());case 6:return this._advance(),ContextKeySmallerEqualsExpr.create(D,this._value());case 7:return this._advance(),ContextKeyGreaterExpr.create(D,this._value());case 8:return this._advance(),ContextKeyGreaterEqualsExpr.create(D,this._value());case 13:return this._advance(),ContextKeyExpr.in(D,this._value());default:return ContextKeyExpr.has(D)}}case 20:throw this._parsingErrors.push({message:errorUnexpectedEOF,offset:w.offset,lexeme:"",additionalInfo:hintUnexpectedEOF}),$s._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const w=this._peek();switch(w.type){case 17:case 18:return this._advance(),w.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(w){return w.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(w){return this._check(w)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(w,D){if(this._check(w))return this._advance();throw this._errExpectedButGot(D,this._peek())}_errExpectedButGot(w,D,O){const W=localize("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,w,Scanner$1.getLexeme(D)),U=D.offset,K=Scanner$1.getLexeme(D);return this._parsingErrors.push({message:W,offset:U,lexeme:K,additionalInfo:O}),$s._parseError}_check(w){return this._peek().type===w}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}};class ContextKeyExpr{static false(){return ContextKeyFalseExpr.INSTANCE}static true(){return ContextKeyTrueExpr.INSTANCE}static has(w){return ContextKeyDefinedExpr.create(w)}static equals(w,D){return ContextKeyEqualsExpr.create(w,D)}static notEquals(w,D){return ContextKeyNotEqualsExpr.create(w,D)}static regex(w,D){return ContextKeyRegexExpr.create(w,D)}static in(w,D){return ContextKeyInExpr.create(w,D)}static notIn(w,D){return ContextKeyNotInExpr.create(w,D)}static not(w){return ContextKeyNotExpr.create(w)}static and(...w){return ContextKeyAndExpr.create(w,null,!0)}static or(...w){return ContextKeyOrExpr.create(w,null,!0)}static{this._parser=new Parser$1({regexParsingWithErrorRecovery:!1})}static deserialize(w){return w==null?void 0:this._parser.parse(w)}}function expressionsAreEqualWithConstantSubstitution(F,w){const D=F?F.substituteConstants():void 0,O=w?w.substituteConstants():void 0;return!D&&!O?!0:!D||!O?!1:D.equals(O)}function cmp(F,w){return F.cmp(w)}class ContextKeyFalseExpr{static{this.INSTANCE=new ContextKeyFalseExpr}constructor(){this.type=0}cmp(w){return this.type-w.type}equals(w){return w.type===this.type}substituteConstants(){return this}evaluate(w){return!1}serialize(){return"false"}keys(){return[]}negate(){return ContextKeyTrueExpr.INSTANCE}}class ContextKeyTrueExpr{static{this.INSTANCE=new ContextKeyTrueExpr}constructor(){this.type=1}cmp(w){return this.type-w.type}equals(w){return w.type===this.type}substituteConstants(){return this}evaluate(w){return!0}serialize(){return"true"}keys(){return[]}negate(){return ContextKeyFalseExpr.INSTANCE}}class ContextKeyDefinedExpr{static create(w,D=null){const O=CONSTANT_VALUES.get(w);return typeof O=="boolean"?O?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE:new ContextKeyDefinedExpr(w,D)}constructor(w,D){this.key=w,this.negated=D,this.type=2}cmp(w){return w.type!==this.type?this.type-w.type:cmp1(this.key,w.key)}equals(w){return w.type===this.type?this.key===w.key:!1}substituteConstants(){const w=CONSTANT_VALUES.get(this.key);return typeof w=="boolean"?w?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE:this}evaluate(w){return!!w.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyNotExpr.create(this.key,this)),this.negated}}class ContextKeyEqualsExpr{static create(w,D,O=null){if(typeof D=="boolean")return D?ContextKeyDefinedExpr.create(w,O):ContextKeyNotExpr.create(w,O);const W=CONSTANT_VALUES.get(w);return typeof W=="boolean"?D===(W?"true":"false")?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE:new ContextKeyEqualsExpr(w,D,O)}constructor(w,D,O){this.key=w,this.value=D,this.negated=O,this.type=4}cmp(w){return w.type!==this.type?this.type-w.type:cmp2(this.key,this.value,w.key,w.value)}equals(w){return w.type===this.type?this.key===w.key&&this.value===w.value:!1}substituteConstants(){const w=CONSTANT_VALUES.get(this.key);if(typeof w=="boolean"){const D=w?"true":"false";return this.value===D?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE}return this}evaluate(w){return w.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyNotEqualsExpr.create(this.key,this.value,this)),this.negated}}class ContextKeyInExpr{static create(w,D){return new ContextKeyInExpr(w,D)}constructor(w,D){this.key=w,this.valueKey=D,this.type=10,this.negated=null}cmp(w){return w.type!==this.type?this.type-w.type:cmp2(this.key,this.valueKey,w.key,w.valueKey)}equals(w){return w.type===this.type?this.key===w.key&&this.valueKey===w.valueKey:!1}substituteConstants(){return this}evaluate(w){const D=w.getValue(this.valueKey),O=w.getValue(this.key);return Array.isArray(D)?D.includes(O):typeof O=="string"&&typeof D=="object"&&D!==null?hasOwnProperty$1.call(D,O):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=ContextKeyNotInExpr.create(this.key,this.valueKey)),this.negated}}class ContextKeyNotInExpr{static create(w,D){return new ContextKeyNotInExpr(w,D)}constructor(w,D){this.key=w,this.valueKey=D,this.type=11,this._negated=ContextKeyInExpr.create(w,D)}cmp(w){return w.type!==this.type?this.type-w.type:this._negated.cmp(w._negated)}equals(w){return w.type===this.type?this._negated.equals(w._negated):!1}substituteConstants(){return this}evaluate(w){return!this._negated.evaluate(w)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}negate(){return this._negated}}class ContextKeyNotEqualsExpr{static create(w,D,O=null){if(typeof D=="boolean")return D?ContextKeyNotExpr.create(w,O):ContextKeyDefinedExpr.create(w,O);const W=CONSTANT_VALUES.get(w);return typeof W=="boolean"?D===(W?"true":"false")?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE:new ContextKeyNotEqualsExpr(w,D,O)}constructor(w,D,O){this.key=w,this.value=D,this.negated=O,this.type=5}cmp(w){return w.type!==this.type?this.type-w.type:cmp2(this.key,this.value,w.key,w.value)}equals(w){return w.type===this.type?this.key===w.key&&this.value===w.value:!1}substituteConstants(){const w=CONSTANT_VALUES.get(this.key);if(typeof w=="boolean"){const D=w?"true":"false";return this.value===D?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE}return this}evaluate(w){return w.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyEqualsExpr.create(this.key,this.value,this)),this.negated}}class ContextKeyNotExpr{static create(w,D=null){const O=CONSTANT_VALUES.get(w);return typeof O=="boolean"?O?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE:new ContextKeyNotExpr(w,D)}constructor(w,D){this.key=w,this.negated=D,this.type=3}cmp(w){return w.type!==this.type?this.type-w.type:cmp1(this.key,w.key)}equals(w){return w.type===this.type?this.key===w.key:!1}substituteConstants(){const w=CONSTANT_VALUES.get(this.key);return typeof w=="boolean"?w?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE:this}evaluate(w){return!w.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyDefinedExpr.create(this.key,this)),this.negated}}function withFloatOrStr(F,w){if(typeof F=="string"){const D=parseFloat(F);isNaN(D)||(F=D)}return typeof F=="string"||typeof F=="number"?w(F):ContextKeyFalseExpr.INSTANCE}class ContextKeyGreaterExpr{static create(w,D,O=null){return withFloatOrStr(D,W=>new ContextKeyGreaterExpr(w,W,O))}constructor(w,D,O){this.key=w,this.value=D,this.negated=O,this.type=12}cmp(w){return w.type!==this.type?this.type-w.type:cmp2(this.key,this.value,w.key,w.value)}equals(w){return w.type===this.type?this.key===w.key&&this.value===w.value:!1}substituteConstants(){return this}evaluate(w){return typeof this.value=="string"?!1:parseFloat(w.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeySmallerEqualsExpr.create(this.key,this.value,this)),this.negated}}class ContextKeyGreaterEqualsExpr{static create(w,D,O=null){return withFloatOrStr(D,W=>new ContextKeyGreaterEqualsExpr(w,W,O))}constructor(w,D,O){this.key=w,this.value=D,this.negated=O,this.type=13}cmp(w){return w.type!==this.type?this.type-w.type:cmp2(this.key,this.value,w.key,w.value)}equals(w){return w.type===this.type?this.key===w.key&&this.value===w.value:!1}substituteConstants(){return this}evaluate(w){return typeof this.value=="string"?!1:parseFloat(w.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeySmallerExpr.create(this.key,this.value,this)),this.negated}}class ContextKeySmallerExpr{static create(w,D,O=null){return withFloatOrStr(D,W=>new ContextKeySmallerExpr(w,W,O))}constructor(w,D,O){this.key=w,this.value=D,this.negated=O,this.type=14}cmp(w){return w.type!==this.type?this.type-w.type:cmp2(this.key,this.value,w.key,w.value)}equals(w){return w.type===this.type?this.key===w.key&&this.value===w.value:!1}substituteConstants(){return this}evaluate(w){return typeof this.value=="string"?!1:parseFloat(w.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyGreaterEqualsExpr.create(this.key,this.value,this)),this.negated}}class ContextKeySmallerEqualsExpr{static create(w,D,O=null){return withFloatOrStr(D,W=>new ContextKeySmallerEqualsExpr(w,W,O))}constructor(w,D,O){this.key=w,this.value=D,this.negated=O,this.type=15}cmp(w){return w.type!==this.type?this.type-w.type:cmp2(this.key,this.value,w.key,w.value)}equals(w){return w.type===this.type?this.key===w.key&&this.value===w.value:!1}substituteConstants(){return this}evaluate(w){return typeof this.value=="string"?!1:parseFloat(w.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyGreaterExpr.create(this.key,this.value,this)),this.negated}}class ContextKeyRegexExpr{static create(w,D){return new ContextKeyRegexExpr(w,D)}constructor(w,D){this.key=w,this.regexp=D,this.type=7,this.negated=null}cmp(w){if(w.type!==this.type)return this.type-w.type;if(this.key<w.key)return-1;if(this.key>w.key)return 1;const D=this.regexp?this.regexp.source:"",O=w.regexp?w.regexp.source:"";return D<O?-1:D>O?1:0}equals(w){if(w.type===this.type){const D=this.regexp?this.regexp.source:"",O=w.regexp?w.regexp.source:"";return this.key===w.key&&D===O}return!1}substituteConstants(){return this}evaluate(w){const D=w.getValue(this.key);return this.regexp?this.regexp.test(D):!1}serialize(){const w=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${w}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyNotRegexExpr.create(this)),this.negated}}class ContextKeyNotRegexExpr{static create(w){return new ContextKeyNotRegexExpr(w)}constructor(w){this._actual=w,this.type=8}cmp(w){return w.type!==this.type?this.type-w.type:this._actual.cmp(w._actual)}equals(w){return w.type===this.type?this._actual.equals(w._actual):!1}substituteConstants(){return this}evaluate(w){return!this._actual.evaluate(w)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}negate(){return this._actual}}function eliminateConstantsInArray(F){let w=null;for(let D=0,O=F.length;D<O;D++){const W=F[D].substituteConstants();if(F[D]!==W&&w===null){w=[];for(let U=0;U<D;U++)w[U]=F[U]}w!==null&&(w[D]=W)}return w===null?F:w}class ContextKeyAndExpr{static create(w,D,O){return ContextKeyAndExpr._normalizeArr(w,D,O)}constructor(w,D){this.expr=w,this.negated=D,this.type=6}cmp(w){if(w.type!==this.type)return this.type-w.type;if(this.expr.length<w.expr.length)return-1;if(this.expr.length>w.expr.length)return 1;for(let D=0,O=this.expr.length;D<O;D++){const W=cmp(this.expr[D],w.expr[D]);if(W!==0)return W}return 0}equals(w){if(w.type===this.type){if(this.expr.length!==w.expr.length)return!1;for(let D=0,O=this.expr.length;D<O;D++)if(!this.expr[D].equals(w.expr[D]))return!1;return!0}return!1}substituteConstants(){const w=eliminateConstantsInArray(this.expr);return w===this.expr?this:ContextKeyAndExpr.create(w,this.negated,!1)}evaluate(w){for(let D=0,O=this.expr.length;D<O;D++)if(!this.expr[D].evaluate(w))return!1;return!0}static _normalizeArr(w,D,O){const W=[];let U=!1;for(const K of w)if(K){if(K.type===1){U=!0;continue}if(K.type===0)return ContextKeyFalseExpr.INSTANCE;if(K.type===6){W.push(...K.expr);continue}W.push(K)}if(W.length===0&&U)return ContextKeyTrueExpr.INSTANCE;if(W.length!==0){if(W.length===1)return W[0];W.sort(cmp);for(let K=1;K<W.length;K++)W[K-1].equals(W[K])&&(W.splice(K,1),K--);if(W.length===1)return W[0];for(;W.length>1;){const K=W[W.length-1];if(K.type!==9)break;W.pop();const q=W.pop(),G=W.length===0,Q=ContextKeyOrExpr.create(K.expr.map(Y=>ContextKeyAndExpr.create([Y,q],null,O)),null,G);Q&&(W.push(Q),W.sort(cmp))}if(W.length===1)return W[0];if(O){for(let K=0;K<W.length;K++)for(let q=K+1;q<W.length;q++)if(W[K].negate().equals(W[q]))return ContextKeyFalseExpr.INSTANCE;if(W.length===1)return W[0]}return new ContextKeyAndExpr(W,D)}}serialize(){return this.expr.map(w=>w.serialize()).join(" && ")}keys(){const w=[];for(const D of this.expr)w.push(...D.keys());return w}negate(){if(!this.negated){const w=[];for(const D of this.expr)w.push(D.negate());this.negated=ContextKeyOrExpr.create(w,this,!0)}return this.negated}}class ContextKeyOrExpr{static create(w,D,O){return ContextKeyOrExpr._normalizeArr(w,D,O)}constructor(w,D){this.expr=w,this.negated=D,this.type=9}cmp(w){if(w.type!==this.type)return this.type-w.type;if(this.expr.length<w.expr.length)return-1;if(this.expr.length>w.expr.length)return 1;for(let D=0,O=this.expr.length;D<O;D++){const W=cmp(this.expr[D],w.expr[D]);if(W!==0)return W}return 0}equals(w){if(w.type===this.type){if(this.expr.length!==w.expr.length)return!1;for(let D=0,O=this.expr.length;D<O;D++)if(!this.expr[D].equals(w.expr[D]))return!1;return!0}return!1}substituteConstants(){const w=eliminateConstantsInArray(this.expr);return w===this.expr?this:ContextKeyOrExpr.create(w,this.negated,!1)}evaluate(w){for(let D=0,O=this.expr.length;D<O;D++)if(this.expr[D].evaluate(w))return!0;return!1}static _normalizeArr(w,D,O){let W=[],U=!1;if(w){for(let K=0,q=w.length;K<q;K++){const G=w[K];if(G){if(G.type===0){U=!0;continue}if(G.type===1)return ContextKeyTrueExpr.INSTANCE;if(G.type===9){W=W.concat(G.expr);continue}W.push(G)}}if(W.length===0&&U)return ContextKeyFalseExpr.INSTANCE;W.sort(cmp)}if(W.length!==0){if(W.length===1)return W[0];for(let K=1;K<W.length;K++)W[K-1].equals(W[K])&&(W.splice(K,1),K--);if(W.length===1)return W[0];if(O){for(let K=0;K<W.length;K++)for(let q=K+1;q<W.length;q++)if(W[K].negate().equals(W[q]))return ContextKeyTrueExpr.INSTANCE;if(W.length===1)return W[0]}return new ContextKeyOrExpr(W,D)}}serialize(){return this.expr.map(w=>w.serialize()).join(" || ")}keys(){const w=[];for(const D of this.expr)w.push(...D.keys());return w}negate(){if(!this.negated){const w=[];for(const D of this.expr)w.push(D.negate());for(;w.length>1;){const D=w.shift(),O=w.shift(),W=[];for(const U of getTerminals(D))for(const K of getTerminals(O))W.push(ContextKeyAndExpr.create([U,K],null,!1));w.unshift(ContextKeyOrExpr.create(W,null,!1))}this.negated=ContextKeyOrExpr.create(w,this,!0)}return this.negated}}class RawContextKey extends ContextKeyDefinedExpr{static{this._info=[]}static all(){return RawContextKey._info.values()}constructor(w,D,O){super(w,null),this._defaultValue=D,typeof O=="object"?RawContextKey._info.push({...O,key:w}):O!==!0&&RawContextKey._info.push({key:w,description:O,type:D!=null?typeof D:void 0})}bindTo(w){return w.createKey(this.key,this._defaultValue)}getValue(w){return w.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(w){return ContextKeyEqualsExpr.create(this.key,w)}}const IContextKeyService=createDecorator("contextKeyService");function cmp1(F,w){return F<w?-1:F>w?1:0}function cmp2(F,w,D,O){return F<D?-1:F>D?1:w<O?-1:w>O?1:0}function implies(F,w){if(F.type===0||w.type===1)return!0;if(F.type===9)return w.type===9?allElementsIncluded(F.expr,w.expr):!1;if(w.type===9){for(const D of w.expr)if(implies(F,D))return!0;return!1}if(F.type===6){if(w.type===6)return allElementsIncluded(w.expr,F.expr);for(const D of F.expr)if(implies(D,w))return!0;return!1}return F.equals(w)}function allElementsIncluded(F,w){let D=0,O=0;for(;D<F.length&&O<w.length;){const W=F[D].cmp(w[O]);if(W<0)return!1;W===0&&D++,O++}return D===F.length}function getTerminals(F){return F.type===9?F.expr:[F]}function ok(F,w){if(!F)throw new Error(w?`Assertion failed (${w})`:"Assertion Failed")}function assertNever(F,w="Unreachable"){throw new Error(w)}function softAssert(F){F||onUnexpectedError(new BugIndicatingError("Soft Assertion Failed"))}function assertFn(F){if(!F()){debugger;F(),onUnexpectedError(new BugIndicatingError("Assertion Failed"))}}function checkAdjacentItems(F,w){let D=0;for(;D<F.length-1;){const O=F[D],W=F[D+1];if(!w(O,W))return!1;D++}return!0}class RegistryImpl{constructor(){this.data=new Map}add(w,D){ok(isString$1(w)),ok(isObject$1(D)),ok(!this.data.has(w),"There is already an extension with this id"),this.data.set(w,D)}as(w){return this.data.get(w)||null}}const Registry=new RegistryImpl;class KeybindingsRegistryImpl{constructor(){this._coreKeybindings=new LinkedList,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(w){if(OS===1){if(w&&w.win)return w.win}else if(OS===2){if(w&&w.mac)return w.mac}else if(w&&w.linux)return w.linux;return w}registerKeybindingRule(w){const D=KeybindingsRegistryImpl.bindToCurrentPlatform(w),O=new DisposableStore;if(D&&D.primary){const W=decodeKeybinding(D.primary,OS);W&&O.add(this._registerDefaultKeybinding(W,w.id,w.args,w.weight,0,w.when))}if(D&&Array.isArray(D.secondary))for(let W=0,U=D.secondary.length;W<U;W++){const K=D.secondary[W],q=decodeKeybinding(K,OS);q&&O.add(this._registerDefaultKeybinding(q,w.id,w.args,w.weight,-W-1,w.when))}return O}registerCommandAndKeybindingRule(w){return combinedDisposable(this.registerKeybindingRule(w),CommandsRegistry.registerCommand(w))}_registerDefaultKeybinding(w,D,O,W,U,K){const q=this._coreKeybindings.push({keybinding:w,command:D,commandArgs:O,when:K,weight1:W,weight2:U,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,toDisposable(()=>{q(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(sorter)),this._cachedMergedKeybindings.slice(0)}}const KeybindingsRegistry=new KeybindingsRegistryImpl,Extensions$8={EditorModes:"platform.keybindingsRegistry"};Registry.add(Extensions$8.EditorModes,KeybindingsRegistry);function sorter(F,w){if(F.weight1!==w.weight1)return F.weight1-w.weight1;if(F.command&&w.command){if(F.command<w.command)return-1;if(F.command>w.command)return 1}return F.weight2-w.weight2}var __decorate$1c=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$16=function(F,w){return function(D,O){w(D,O,F)}},MenuItemAction_1;function isIMenuItem(F){return F.command!==void 0}function isISubmenuItem(F){return F.submenu!==void 0}class MenuId{static{this._instances=new Map}static{this.CommandPalette=new MenuId("CommandPalette")}static{this.DebugBreakpointsContext=new MenuId("DebugBreakpointsContext")}static{this.DebugCallStackContext=new MenuId("DebugCallStackContext")}static{this.DebugConsoleContext=new MenuId("DebugConsoleContext")}static{this.DebugVariablesContext=new MenuId("DebugVariablesContext")}static{this.NotebookVariablesContext=new MenuId("NotebookVariablesContext")}static{this.DebugHoverContext=new MenuId("DebugHoverContext")}static{this.DebugWatchContext=new MenuId("DebugWatchContext")}static{this.DebugToolBar=new MenuId("DebugToolBar")}static{this.DebugToolBarStop=new MenuId("DebugToolBarStop")}static{this.DebugCallStackToolbar=new MenuId("DebugCallStackToolbar")}static{this.DebugCreateConfiguration=new MenuId("DebugCreateConfiguration")}static{this.EditorContext=new MenuId("EditorContext")}static{this.SimpleEditorContext=new MenuId("SimpleEditorContext")}static{this.EditorContent=new MenuId("EditorContent")}static{this.EditorLineNumberContext=new MenuId("EditorLineNumberContext")}static{this.EditorContextCopy=new MenuId("EditorContextCopy")}static{this.EditorContextPeek=new MenuId("EditorContextPeek")}static{this.EditorContextShare=new MenuId("EditorContextShare")}static{this.EditorTitle=new MenuId("EditorTitle")}static{this.EditorTitleRun=new MenuId("EditorTitleRun")}static{this.EditorTitleContext=new MenuId("EditorTitleContext")}static{this.EditorTitleContextShare=new MenuId("EditorTitleContextShare")}static{this.EmptyEditorGroup=new MenuId("EmptyEditorGroup")}static{this.EmptyEditorGroupContext=new MenuId("EmptyEditorGroupContext")}static{this.EditorTabsBarContext=new MenuId("EditorTabsBarContext")}static{this.EditorTabsBarShowTabsSubmenu=new MenuId("EditorTabsBarShowTabsSubmenu")}static{this.EditorTabsBarShowTabsZenModeSubmenu=new MenuId("EditorTabsBarShowTabsZenModeSubmenu")}static{this.EditorActionsPositionSubmenu=new MenuId("EditorActionsPositionSubmenu")}static{this.ExplorerContext=new MenuId("ExplorerContext")}static{this.ExplorerContextShare=new MenuId("ExplorerContextShare")}static{this.ExtensionContext=new MenuId("ExtensionContext")}static{this.GlobalActivity=new MenuId("GlobalActivity")}static{this.CommandCenter=new MenuId("CommandCenter")}static{this.CommandCenterCenter=new MenuId("CommandCenterCenter")}static{this.LayoutControlMenuSubmenu=new MenuId("LayoutControlMenuSubmenu")}static{this.LayoutControlMenu=new MenuId("LayoutControlMenu")}static{this.MenubarMainMenu=new MenuId("MenubarMainMenu")}static{this.MenubarAppearanceMenu=new MenuId("MenubarAppearanceMenu")}static{this.MenubarDebugMenu=new MenuId("MenubarDebugMenu")}static{this.MenubarEditMenu=new MenuId("MenubarEditMenu")}static{this.MenubarCopy=new MenuId("MenubarCopy")}static{this.MenubarFileMenu=new MenuId("MenubarFileMenu")}static{this.MenubarGoMenu=new MenuId("MenubarGoMenu")}static{this.MenubarHelpMenu=new MenuId("MenubarHelpMenu")}static{this.MenubarLayoutMenu=new MenuId("MenubarLayoutMenu")}static{this.MenubarNewBreakpointMenu=new MenuId("MenubarNewBreakpointMenu")}static{this.PanelAlignmentMenu=new MenuId("PanelAlignmentMenu")}static{this.PanelPositionMenu=new MenuId("PanelPositionMenu")}static{this.ActivityBarPositionMenu=new MenuId("ActivityBarPositionMenu")}static{this.MenubarPreferencesMenu=new MenuId("MenubarPreferencesMenu")}static{this.MenubarRecentMenu=new MenuId("MenubarRecentMenu")}static{this.MenubarSelectionMenu=new MenuId("MenubarSelectionMenu")}static{this.MenubarShare=new MenuId("MenubarShare")}static{this.MenubarSwitchEditorMenu=new MenuId("MenubarSwitchEditorMenu")}static{this.MenubarSwitchGroupMenu=new MenuId("MenubarSwitchGroupMenu")}static{this.MenubarTerminalMenu=new MenuId("MenubarTerminalMenu")}static{this.MenubarViewMenu=new MenuId("MenubarViewMenu")}static{this.MenubarHomeMenu=new MenuId("MenubarHomeMenu")}static{this.OpenEditorsContext=new MenuId("OpenEditorsContext")}static{this.OpenEditorsContextShare=new MenuId("OpenEditorsContextShare")}static{this.ProblemsPanelContext=new MenuId("ProblemsPanelContext")}static{this.SCMInputBox=new MenuId("SCMInputBox")}static{this.SCMChangesSeparator=new MenuId("SCMChangesSeparator")}static{this.SCMChangesContext=new MenuId("SCMChangesContext")}static{this.SCMIncomingChanges=new MenuId("SCMIncomingChanges")}static{this.SCMIncomingChangesContext=new MenuId("SCMIncomingChangesContext")}static{this.SCMIncomingChangesSetting=new MenuId("SCMIncomingChangesSetting")}static{this.SCMOutgoingChanges=new MenuId("SCMOutgoingChanges")}static{this.SCMOutgoingChangesContext=new MenuId("SCMOutgoingChangesContext")}static{this.SCMOutgoingChangesSetting=new MenuId("SCMOutgoingChangesSetting")}static{this.SCMIncomingChangesAllChangesContext=new MenuId("SCMIncomingChangesAllChangesContext")}static{this.SCMIncomingChangesHistoryItemContext=new MenuId("SCMIncomingChangesHistoryItemContext")}static{this.SCMOutgoingChangesAllChangesContext=new MenuId("SCMOutgoingChangesAllChangesContext")}static{this.SCMOutgoingChangesHistoryItemContext=new MenuId("SCMOutgoingChangesHistoryItemContext")}static{this.SCMChangeContext=new MenuId("SCMChangeContext")}static{this.SCMResourceContext=new MenuId("SCMResourceContext")}static{this.SCMResourceContextShare=new MenuId("SCMResourceContextShare")}static{this.SCMResourceFolderContext=new MenuId("SCMResourceFolderContext")}static{this.SCMResourceGroupContext=new MenuId("SCMResourceGroupContext")}static{this.SCMSourceControl=new MenuId("SCMSourceControl")}static{this.SCMSourceControlInline=new MenuId("SCMSourceControlInline")}static{this.SCMSourceControlTitle=new MenuId("SCMSourceControlTitle")}static{this.SCMHistoryTitle=new MenuId("SCMHistoryTitle")}static{this.SCMTitle=new MenuId("SCMTitle")}static{this.SearchContext=new MenuId("SearchContext")}static{this.SearchActionMenu=new MenuId("SearchActionContext")}static{this.StatusBarWindowIndicatorMenu=new MenuId("StatusBarWindowIndicatorMenu")}static{this.StatusBarRemoteIndicatorMenu=new MenuId("StatusBarRemoteIndicatorMenu")}static{this.StickyScrollContext=new MenuId("StickyScrollContext")}static{this.TestItem=new MenuId("TestItem")}static{this.TestItemGutter=new MenuId("TestItemGutter")}static{this.TestProfilesContext=new MenuId("TestProfilesContext")}static{this.TestMessageContext=new MenuId("TestMessageContext")}static{this.TestMessageContent=new MenuId("TestMessageContent")}static{this.TestPeekElement=new MenuId("TestPeekElement")}static{this.TestPeekTitle=new MenuId("TestPeekTitle")}static{this.TestCallStack=new MenuId("TestCallStack")}static{this.TouchBarContext=new MenuId("TouchBarContext")}static{this.TitleBarContext=new MenuId("TitleBarContext")}static{this.TitleBarTitleContext=new MenuId("TitleBarTitleContext")}static{this.TunnelContext=new MenuId("TunnelContext")}static{this.TunnelPrivacy=new MenuId("TunnelPrivacy")}static{this.TunnelProtocol=new MenuId("TunnelProtocol")}static{this.TunnelPortInline=new MenuId("TunnelInline")}static{this.TunnelTitle=new MenuId("TunnelTitle")}static{this.TunnelLocalAddressInline=new MenuId("TunnelLocalAddressInline")}static{this.TunnelOriginInline=new MenuId("TunnelOriginInline")}static{this.ViewItemContext=new MenuId("ViewItemContext")}static{this.ViewContainerTitle=new MenuId("ViewContainerTitle")}static{this.ViewContainerTitleContext=new MenuId("ViewContainerTitleContext")}static{this.ViewTitle=new MenuId("ViewTitle")}static{this.ViewTitleContext=new MenuId("ViewTitleContext")}static{this.CommentEditorActions=new MenuId("CommentEditorActions")}static{this.CommentThreadTitle=new MenuId("CommentThreadTitle")}static{this.CommentThreadActions=new MenuId("CommentThreadActions")}static{this.CommentThreadAdditionalActions=new MenuId("CommentThreadAdditionalActions")}static{this.CommentThreadTitleContext=new MenuId("CommentThreadTitleContext")}static{this.CommentThreadCommentContext=new MenuId("CommentThreadCommentContext")}static{this.CommentTitle=new MenuId("CommentTitle")}static{this.CommentActions=new MenuId("CommentActions")}static{this.CommentsViewThreadActions=new MenuId("CommentsViewThreadActions")}static{this.InteractiveToolbar=new MenuId("InteractiveToolbar")}static{this.InteractiveCellTitle=new MenuId("InteractiveCellTitle")}static{this.InteractiveCellDelete=new MenuId("InteractiveCellDelete")}static{this.InteractiveCellExecute=new MenuId("InteractiveCellExecute")}static{this.InteractiveInputExecute=new MenuId("InteractiveInputExecute")}static{this.InteractiveInputConfig=new MenuId("InteractiveInputConfig")}static{this.ReplInputExecute=new MenuId("ReplInputExecute")}static{this.IssueReporter=new MenuId("IssueReporter")}static{this.NotebookToolbar=new MenuId("NotebookToolbar")}static{this.NotebookStickyScrollContext=new MenuId("NotebookStickyScrollContext")}static{this.NotebookCellTitle=new MenuId("NotebookCellTitle")}static{this.NotebookCellDelete=new MenuId("NotebookCellDelete")}static{this.NotebookCellInsert=new MenuId("NotebookCellInsert")}static{this.NotebookCellBetween=new MenuId("NotebookCellBetween")}static{this.NotebookCellListTop=new MenuId("NotebookCellTop")}static{this.NotebookCellExecute=new MenuId("NotebookCellExecute")}static{this.NotebookCellExecuteGoTo=new MenuId("NotebookCellExecuteGoTo")}static{this.NotebookCellExecutePrimary=new MenuId("NotebookCellExecutePrimary")}static{this.NotebookDiffCellInputTitle=new MenuId("NotebookDiffCellInputTitle")}static{this.NotebookDiffCellMetadataTitle=new MenuId("NotebookDiffCellMetadataTitle")}static{this.NotebookDiffCellOutputsTitle=new MenuId("NotebookDiffCellOutputsTitle")}static{this.NotebookOutputToolbar=new MenuId("NotebookOutputToolbar")}static{this.NotebookOutlineFilter=new MenuId("NotebookOutlineFilter")}static{this.NotebookOutlineActionMenu=new MenuId("NotebookOutlineActionMenu")}static{this.NotebookEditorLayoutConfigure=new MenuId("NotebookEditorLayoutConfigure")}static{this.NotebookKernelSource=new MenuId("NotebookKernelSource")}static{this.BulkEditTitle=new MenuId("BulkEditTitle")}static{this.BulkEditContext=new MenuId("BulkEditContext")}static{this.TimelineItemContext=new MenuId("TimelineItemContext")}static{this.TimelineTitle=new MenuId("TimelineTitle")}static{this.TimelineTitleContext=new MenuId("TimelineTitleContext")}static{this.TimelineFilterSubMenu=new MenuId("TimelineFilterSubMenu")}static{this.AccountsContext=new MenuId("AccountsContext")}static{this.SidebarTitle=new MenuId("SidebarTitle")}static{this.PanelTitle=new MenuId("PanelTitle")}static{this.AuxiliaryBarTitle=new MenuId("AuxiliaryBarTitle")}static{this.AuxiliaryBarHeader=new MenuId("AuxiliaryBarHeader")}static{this.TerminalInstanceContext=new MenuId("TerminalInstanceContext")}static{this.TerminalEditorInstanceContext=new MenuId("TerminalEditorInstanceContext")}static{this.TerminalNewDropdownContext=new MenuId("TerminalNewDropdownContext")}static{this.TerminalTabContext=new MenuId("TerminalTabContext")}static{this.TerminalTabEmptyAreaContext=new MenuId("TerminalTabEmptyAreaContext")}static{this.TerminalStickyScrollContext=new MenuId("TerminalStickyScrollContext")}static{this.WebviewContext=new MenuId("WebviewContext")}static{this.InlineCompletionsActions=new MenuId("InlineCompletionsActions")}static{this.InlineEditsActions=new MenuId("InlineEditsActions")}static{this.InlineEditActions=new MenuId("InlineEditActions")}static{this.NewFile=new MenuId("NewFile")}static{this.MergeInput1Toolbar=new MenuId("MergeToolbar1Toolbar")}static{this.MergeInput2Toolbar=new MenuId("MergeToolbar2Toolbar")}static{this.MergeBaseToolbar=new MenuId("MergeBaseToolbar")}static{this.MergeInputResultToolbar=new MenuId("MergeToolbarResultToolbar")}static{this.InlineSuggestionToolbar=new MenuId("InlineSuggestionToolbar")}static{this.InlineEditToolbar=new MenuId("InlineEditToolbar")}static{this.ChatContext=new MenuId("ChatContext")}static{this.ChatCodeBlock=new MenuId("ChatCodeblock")}static{this.ChatCompareBlock=new MenuId("ChatCompareBlock")}static{this.ChatMessageTitle=new MenuId("ChatMessageTitle")}static{this.ChatExecute=new MenuId("ChatExecute")}static{this.ChatExecuteSecondary=new MenuId("ChatExecuteSecondary")}static{this.ChatInputSide=new MenuId("ChatInputSide")}static{this.AccessibleView=new MenuId("AccessibleView")}static{this.MultiDiffEditorFileToolbar=new MenuId("MultiDiffEditorFileToolbar")}static{this.DiffEditorHunkToolbar=new MenuId("DiffEditorHunkToolbar")}static{this.DiffEditorSelectionToolbar=new MenuId("DiffEditorSelectionToolbar")}constructor(w){if(MenuId._instances.has(w))throw new TypeError(`MenuId with identifier '${w}' already exists. Use MenuId.for(ident) or a unique identifier`);MenuId._instances.set(w,this),this.id=w}}const IMenuService=createDecorator("menuService");class MenuRegistryChangeEvent{static{this._all=new Map}static for(w){let D=this._all.get(w);return D||(D=new MenuRegistryChangeEvent(w),this._all.set(w,D)),D}static merge(w){const D=new Set;for(const O of w)O instanceof MenuRegistryChangeEvent&&D.add(O.id);return D}constructor(w){this.id=w,this.has=D=>D===w}}const MenuRegistry=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new MicrotaskEmitter({merge:MenuRegistryChangeEvent.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(F){return this._commands.set(F.id,F),this._onDidChangeMenu.fire(MenuRegistryChangeEvent.for(MenuId.CommandPalette)),toDisposable(()=>{this._commands.delete(F.id)&&this._onDidChangeMenu.fire(MenuRegistryChangeEvent.for(MenuId.CommandPalette))})}getCommand(F){return this._commands.get(F)}getCommands(){const F=new Map;return this._commands.forEach((w,D)=>F.set(D,w)),F}appendMenuItem(F,w){let D=this._menuItems.get(F);D||(D=new LinkedList,this._menuItems.set(F,D));const O=D.push(w);return this._onDidChangeMenu.fire(MenuRegistryChangeEvent.for(F)),toDisposable(()=>{O(),this._onDidChangeMenu.fire(MenuRegistryChangeEvent.for(F))})}appendMenuItems(F){const w=new DisposableStore;for(const{id:D,item:O}of F)w.add(this.appendMenuItem(D,O));return w}getMenuItems(F){let w;return this._menuItems.has(F)?w=[...this._menuItems.get(F)]:w=[],F===MenuId.CommandPalette&&this._appendImplicitItems(w),w}_appendImplicitItems(F){const w=new Set;for(const D of F)isIMenuItem(D)&&(w.add(D.command.id),D.alt&&w.add(D.alt.id));this._commands.forEach((D,O)=>{w.has(O)||F.push({command:D})})}};class SubmenuItemAction extends SubmenuAction{constructor(w,D,O){super(`submenuitem.${w.submenu.id}`,typeof w.title=="string"?w.title:w.title.value,O,"submenu"),this.item=w,this.hideActions=D}}let MenuItemAction=MenuItemAction_1=class{static label(w,D){return D?.renderShortTitle&&w.shortTitle?typeof w.shortTitle=="string"?w.shortTitle:w.shortTitle.value:typeof w.title=="string"?w.title:w.title.value}constructor(w,D,O,W,U,K,q){this.hideActions=W,this.menuKeybinding=U,this._commandService=q,this.id=w.id,this.label=MenuItemAction_1.label(w,O),this.tooltip=(typeof w.tooltip=="string"?w.tooltip:w.tooltip?.value)??"",this.enabled=!w.precondition||K.contextMatchesRules(w.precondition),this.checked=void 0;let G;if(w.toggled){const Q=w.toggled.condition?w.toggled:{condition:w.toggled};this.checked=K.contextMatchesRules(Q.condition),this.checked&&Q.tooltip&&(this.tooltip=typeof Q.tooltip=="string"?Q.tooltip:Q.tooltip.value),this.checked&&ThemeIcon.isThemeIcon(Q.icon)&&(G=Q.icon),this.checked&&Q.title&&(this.label=typeof Q.title=="string"?Q.title:Q.title.value)}G||(G=ThemeIcon.isThemeIcon(w.icon)?w.icon:void 0),this.item=w,this.alt=D?new MenuItemAction_1(D,void 0,O,W,void 0,K,q):void 0,this._options=O,this.class=G&&ThemeIcon.asClassName(G)}run(...w){let D=[];return this._options?.arg&&(D=[...D,this._options.arg]),this._options?.shouldForwardArgs&&(D=[...D,...w]),this._commandService.executeCommand(this.id,...D)}};MenuItemAction=MenuItemAction_1=__decorate$1c([__param$16(5,IContextKeyService),__param$16(6,ICommandService)],MenuItemAction);const ITelemetryService=createDecorator("telemetryService"),ILogService=createDecorator("logService");var LogLevel;(function(F){F[F.Off=0]="Off",F[F.Trace=1]="Trace",F[F.Debug=2]="Debug",F[F.Info=3]="Info",F[F.Warning=4]="Warning",F[F.Error=5]="Error"})(LogLevel||(LogLevel={}));const DEFAULT_LOG_LEVEL=LogLevel.Info;class AbstractLogger extends Disposable{constructor(){super(...arguments),this.level=DEFAULT_LOG_LEVEL,this._onDidChangeLogLevel=this._register(new Emitter$1),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(w){this.level!==w&&(this.level=w,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(w){return this.level!==LogLevel.Off&&this.level<=w}}class ConsoleLogger extends AbstractLogger{constructor(w=DEFAULT_LOG_LEVEL,D=!0){super(),this.useColors=D,this.setLevel(w)}trace(w,...D){this.checkLogLevel(LogLevel.Trace)&&(this.useColors?console.log("%cTRACE","color: #888",w,...D):console.log(w,...D))}debug(w,...D){this.checkLogLevel(LogLevel.Debug)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",w,...D):console.log(w,...D))}info(w,...D){this.checkLogLevel(LogLevel.Info)&&(this.useColors?console.log("%c INFO","color: #33f",w,...D):console.log(w,...D))}warn(w,...D){this.checkLogLevel(LogLevel.Warning)&&(this.useColors?console.log("%c WARN","color: #993",w,...D):console.log(w,...D))}error(w,...D){this.checkLogLevel(LogLevel.Error)&&(this.useColors?console.log("%c  ERR","color: #f33",w,...D):console.error(w,...D))}}class MultiplexLogger extends AbstractLogger{constructor(w){super(),this.loggers=w,w.length&&this.setLevel(w[0].getLevel())}setLevel(w){for(const D of this.loggers)D.setLevel(w);super.setLevel(w)}trace(w,...D){for(const O of this.loggers)O.trace(w,...D)}debug(w,...D){for(const O of this.loggers)O.debug(w,...D)}info(w,...D){for(const O of this.loggers)O.info(w,...D)}warn(w,...D){for(const O of this.loggers)O.warn(w,...D)}error(w,...D){for(const O of this.loggers)O.error(w,...D)}dispose(){for(const w of this.loggers)w.dispose();super.dispose()}}function LogLevelToString(F){switch(F){case LogLevel.Trace:return"trace";case LogLevel.Debug:return"debug";case LogLevel.Info:return"info";case LogLevel.Warning:return"warn";case LogLevel.Error:return"error";case LogLevel.Off:return"off"}}new RawContextKey("logLevel",LogLevelToString(LogLevel.Info));let Command$1=class{constructor(w){this.id=w.id,this.precondition=w.precondition,this._kbOpts=w.kbOpts,this._menuOpts=w.menuOpts,this.metadata=w.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const w=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const D of w){let O=D.kbExpr;this.precondition&&(O?O=ContextKeyExpr.and(O,this.precondition):O=this.precondition);const W={id:this.id,weight:D.weight,args:D.args,when:O,primary:D.primary,secondary:D.secondary,win:D.win,linux:D.linux,mac:D.mac};KeybindingsRegistry.registerKeybindingRule(W)}}CommandsRegistry.registerCommand({id:this.id,handler:(w,D)=>this.runCommand(w,D),metadata:this.metadata})}_registerMenuItem(w){MenuRegistry.appendMenuItem(w.menuId,{group:w.group,command:{id:this.id,title:w.title,icon:w.icon,precondition:this.precondition},when:w.when,order:w.order})}};class MultiCommand extends Command$1{constructor(){super(...arguments),this._implementations=[]}addImplementation(w,D,O,W){return this._implementations.push({priority:w,name:D,implementation:O,when:W}),this._implementations.sort((U,K)=>K.priority-U.priority),{dispose:()=>{for(let U=0;U<this._implementations.length;U++)if(this._implementations[U].implementation===O){this._implementations.splice(U,1);return}}}}runCommand(w,D){const O=w.get(ILogService),W=w.get(IContextKeyService);O.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const U of this._implementations){if(U.when){const q=W.getContext(getActiveElement());if(!U.when.evaluate(q))continue}const K=U.implementation(w,D);if(K)return O.trace(`Command '${this.id}' was handled by '${U.name}'.`),typeof K=="boolean"?void 0:K}O.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class ProxyCommand extends Command$1{constructor(w,D){super(D),this.command=w}runCommand(w,D){return this.command.runCommand(w,D)}}class EditorCommand extends Command$1{static bindToContribution(w){return class extends EditorCommand{constructor(O){super(O),this._callback=O.handler}runEditorCommand(O,W,U){const K=w(W);K&&this._callback(K,U)}}}static runEditorCommand(w,D,O,W){const U=w.get(ICodeEditorService),K=U.getFocusedCodeEditor()||U.getActiveCodeEditor();if(K)return K.invokeWithinContext(q=>{if(q.get(IContextKeyService).contextMatchesRules(O??void 0))return W(q,K,D)})}runCommand(w,D){return EditorCommand.runEditorCommand(w,D,this.precondition,(O,W,U)=>this.runEditorCommand(O,W,U))}}class EditorAction extends EditorCommand{static convertOptions(w){let D;Array.isArray(w.menuOpts)?D=w.menuOpts:w.menuOpts?D=[w.menuOpts]:D=[];function O(W){return W.menuId||(W.menuId=MenuId.EditorContext),W.title||(W.title=w.label),W.when=ContextKeyExpr.and(w.precondition,W.when),W}return Array.isArray(w.contextMenuOpts)?D.push(...w.contextMenuOpts.map(O)):w.contextMenuOpts&&D.push(O(w.contextMenuOpts)),w.menuOpts=D,w}constructor(w){super(EditorAction.convertOptions(w)),this.label=w.label,this.alias=w.alias}runEditorCommand(w,D,O){return this.reportTelemetry(w,D),this.run(w,D,O||{})}reportTelemetry(w,D){w.get(ITelemetryService).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}function registerEditorCommand(F){return EditorContributionRegistry.INSTANCE.registerEditorCommand(F),F}function registerEditorAction(F){const w=new F;return EditorContributionRegistry.INSTANCE.registerEditorAction(w),w}function registerEditorContribution(F,w,D){EditorContributionRegistry.INSTANCE.registerEditorContribution(F,w,D)}var EditorExtensionsRegistry;(function(F){function w(K){return EditorContributionRegistry.INSTANCE.getEditorCommand(K)}F.getEditorCommand=w;function D(){return EditorContributionRegistry.INSTANCE.getEditorActions()}F.getEditorActions=D;function O(){return EditorContributionRegistry.INSTANCE.getEditorContributions()}F.getEditorContributions=O;function W(K){return EditorContributionRegistry.INSTANCE.getEditorContributions().filter(q=>K.indexOf(q.id)>=0)}F.getSomeEditorContributions=W;function U(){return EditorContributionRegistry.INSTANCE.getDiffEditorContributions()}F.getDiffEditorContributions=U})(EditorExtensionsRegistry||(EditorExtensionsRegistry={}));const Extensions$7={EditorCommonContributions:"editor.contributions"};class EditorContributionRegistry{static{this.INSTANCE=new EditorContributionRegistry}constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(w,D,O){this.editorContributions.push({id:w,ctor:D,instantiation:O})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(w){w.register(),this.editorActions.push(w)}getEditorActions(){return this.editorActions}registerEditorCommand(w){w.register(),this.editorCommands[w.id]=w}getEditorCommand(w){return this.editorCommands[w]||null}}Registry.add(Extensions$7.EditorCommonContributions,EditorContributionRegistry.INSTANCE);function registerCommand$2(F){return F.register(),F}const UndoCommand=registerCommand$2(new MultiCommand({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:MenuId.MenubarEditMenu,group:"1_do",title:localize({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:MenuId.CommandPalette,group:"",title:localize("undo","Undo"),order:1}]}));registerCommand$2(new ProxyCommand(UndoCommand,{id:"default:undo",precondition:void 0}));const RedoCommand=registerCommand$2(new MultiCommand({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:MenuId.MenubarEditMenu,group:"1_do",title:localize({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:MenuId.CommandPalette,group:"",title:localize("redo","Redo"),order:1}]}));registerCommand$2(new ProxyCommand(RedoCommand,{id:"default:redo",precondition:void 0}));const SelectAllCommand=registerCommand$2(new MultiCommand({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:MenuId.MenubarSelectionMenu,group:"1_basic",title:localize({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:MenuId.CommandPalette,group:"",title:localize("selectAll","Select All"),order:1}]}));let Range$2=class xi{constructor(w,D,O,W){w>O||w===O&&D>W?(this.startLineNumber=O,this.startColumn=W,this.endLineNumber=w,this.endColumn=D):(this.startLineNumber=w,this.startColumn=D,this.endLineNumber=O,this.endColumn=W)}isEmpty(){return xi.isEmpty(this)}static isEmpty(w){return w.startLineNumber===w.endLineNumber&&w.startColumn===w.endColumn}containsPosition(w){return xi.containsPosition(this,w)}static containsPosition(w,D){return!(D.lineNumber<w.startLineNumber||D.lineNumber>w.endLineNumber||D.lineNumber===w.startLineNumber&&D.column<w.startColumn||D.lineNumber===w.endLineNumber&&D.column>w.endColumn)}static strictContainsPosition(w,D){return!(D.lineNumber<w.startLineNumber||D.lineNumber>w.endLineNumber||D.lineNumber===w.startLineNumber&&D.column<=w.startColumn||D.lineNumber===w.endLineNumber&&D.column>=w.endColumn)}containsRange(w){return xi.containsRange(this,w)}static containsRange(w,D){return!(D.startLineNumber<w.startLineNumber||D.endLineNumber<w.startLineNumber||D.startLineNumber>w.endLineNumber||D.endLineNumber>w.endLineNumber||D.startLineNumber===w.startLineNumber&&D.startColumn<w.startColumn||D.endLineNumber===w.endLineNumber&&D.endColumn>w.endColumn)}strictContainsRange(w){return xi.strictContainsRange(this,w)}static strictContainsRange(w,D){return!(D.startLineNumber<w.startLineNumber||D.endLineNumber<w.startLineNumber||D.startLineNumber>w.endLineNumber||D.endLineNumber>w.endLineNumber||D.startLineNumber===w.startLineNumber&&D.startColumn<=w.startColumn||D.endLineNumber===w.endLineNumber&&D.endColumn>=w.endColumn)}plusRange(w){return xi.plusRange(this,w)}static plusRange(w,D){let O,W,U,K;return D.startLineNumber<w.startLineNumber?(O=D.startLineNumber,W=D.startColumn):D.startLineNumber===w.startLineNumber?(O=D.startLineNumber,W=Math.min(D.startColumn,w.startColumn)):(O=w.startLineNumber,W=w.startColumn),D.endLineNumber>w.endLineNumber?(U=D.endLineNumber,K=D.endColumn):D.endLineNumber===w.endLineNumber?(U=D.endLineNumber,K=Math.max(D.endColumn,w.endColumn)):(U=w.endLineNumber,K=w.endColumn),new xi(O,W,U,K)}intersectRanges(w){return xi.intersectRanges(this,w)}static intersectRanges(w,D){let O=w.startLineNumber,W=w.startColumn,U=w.endLineNumber,K=w.endColumn;const q=D.startLineNumber,G=D.startColumn,Q=D.endLineNumber,Y=D.endColumn;return O<q?(O=q,W=G):O===q&&(W=Math.max(W,G)),U>Q?(U=Q,K=Y):U===Q&&(K=Math.min(K,Y)),O>U||O===U&&W>K?null:new xi(O,W,U,K)}equalsRange(w){return xi.equalsRange(this,w)}static equalsRange(w,D){return!w&&!D?!0:!!w&&!!D&&w.startLineNumber===D.startLineNumber&&w.startColumn===D.startColumn&&w.endLineNumber===D.endLineNumber&&w.endColumn===D.endColumn}getEndPosition(){return xi.getEndPosition(this)}static getEndPosition(w){return new Position$1(w.endLineNumber,w.endColumn)}getStartPosition(){return xi.getStartPosition(this)}static getStartPosition(w){return new Position$1(w.startLineNumber,w.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(w,D){return new xi(this.startLineNumber,this.startColumn,w,D)}setStartPosition(w,D){return new xi(w,D,this.endLineNumber,this.endColumn)}collapseToStart(){return xi.collapseToStart(this)}static collapseToStart(w){return new xi(w.startLineNumber,w.startColumn,w.startLineNumber,w.startColumn)}collapseToEnd(){return xi.collapseToEnd(this)}static collapseToEnd(w){return new xi(w.endLineNumber,w.endColumn,w.endLineNumber,w.endColumn)}delta(w){return new xi(this.startLineNumber+w,this.startColumn,this.endLineNumber+w,this.endColumn)}static fromPositions(w,D=w){return new xi(w.lineNumber,w.column,D.lineNumber,D.column)}static lift(w){return w?new xi(w.startLineNumber,w.startColumn,w.endLineNumber,w.endColumn):null}static isIRange(w){return w&&typeof w.startLineNumber=="number"&&typeof w.startColumn=="number"&&typeof w.endLineNumber=="number"&&typeof w.endColumn=="number"}static areIntersectingOrTouching(w,D){return!(w.endLineNumber<D.startLineNumber||w.endLineNumber===D.startLineNumber&&w.endColumn<D.startColumn||D.endLineNumber<w.startLineNumber||D.endLineNumber===w.startLineNumber&&D.endColumn<w.startColumn)}static areIntersecting(w,D){return!(w.endLineNumber<D.startLineNumber||w.endLineNumber===D.startLineNumber&&w.endColumn<=D.startColumn||D.endLineNumber<w.startLineNumber||D.endLineNumber===w.startLineNumber&&D.endColumn<=w.startColumn)}static compareRangesUsingStarts(w,D){if(w&&D){const U=w.startLineNumber|0,K=D.startLineNumber|0;if(U===K){const q=w.startColumn|0,G=D.startColumn|0;if(q===G){const Q=w.endLineNumber|0,Y=D.endLineNumber|0;if(Q===Y){const X=w.endColumn|0,J=D.endColumn|0;return X-J}return Q-Y}return q-G}return U-K}return(w?1:0)-(D?1:0)}static compareRangesUsingEnds(w,D){return w.endLineNumber===D.endLineNumber?w.endColumn===D.endColumn?w.startLineNumber===D.startLineNumber?w.startColumn-D.startColumn:w.startLineNumber-D.startLineNumber:w.endColumn-D.endColumn:w.endLineNumber-D.endLineNumber}static spansMultipleLines(w){return w.endLineNumber>w.startLineNumber}toJSON(){return this}};class EditOperation{static insert(w,D){return{range:new Range$2(w.lineNumber,w.column,w.lineNumber,w.column),text:D,forceMoveMarkers:!0}}static delete(w){return{range:w,text:null}}static replace(w,D){return{range:w,text:D}}static replaceMove(w,D){return{range:w,text:D,forceMoveMarkers:!0}}}var EditorContextKeys;(function(F){F.editorSimpleInput=new RawContextKey("editorSimpleInput",!1,!0),F.editorTextFocus=new RawContextKey("editorTextFocus",!1,localize("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),F.focus=new RawContextKey("editorFocus",!1,localize("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),F.textInputFocus=new RawContextKey("textInputFocus",!1,localize("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),F.readOnly=new RawContextKey("editorReadonly",!1,localize("editorReadonly","Whether the editor is read-only")),F.inDiffEditor=new RawContextKey("inDiffEditor",!1,localize("inDiffEditor","Whether the context is a diff editor")),F.isEmbeddedDiffEditor=new RawContextKey("isEmbeddedDiffEditor",!1,localize("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),F.inMultiDiffEditor=new RawContextKey("inMultiDiffEditor",!1,localize("inMultiDiffEditor","Whether the context is a multi diff editor")),F.multiDiffEditorAllCollapsed=new RawContextKey("multiDiffEditorAllCollapsed",void 0,localize("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),F.hasChanges=new RawContextKey("diffEditorHasChanges",!1,localize("diffEditorHasChanges","Whether the diff editor has changes")),F.comparingMovedCode=new RawContextKey("comparingMovedCode",!1,localize("comparingMovedCode","Whether a moved code block is selected for comparison")),F.accessibleDiffViewerVisible=new RawContextKey("accessibleDiffViewerVisible",!1,localize("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),F.diffEditorRenderSideBySideInlineBreakpointReached=new RawContextKey("diffEditorRenderSideBySideInlineBreakpointReached",!1,localize("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),F.diffEditorInlineMode=new RawContextKey("diffEditorInlineMode",!1,localize("diffEditorInlineMode","Whether inline mode is active")),F.diffEditorOriginalWritable=new RawContextKey("diffEditorOriginalWritable",!1,localize("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),F.diffEditorModifiedWritable=new RawContextKey("diffEditorModifiedWritable",!1,localize("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),F.diffEditorOriginalUri=new RawContextKey("diffEditorOriginalUri","",localize("diffEditorOriginalUri","The uri of the original document")),F.diffEditorModifiedUri=new RawContextKey("diffEditorModifiedUri","",localize("diffEditorModifiedUri","The uri of the modified document")),F.columnSelection=new RawContextKey("editorColumnSelection",!1,localize("editorColumnSelection","Whether `editor.columnSelection` is enabled")),F.writable=F.readOnly.toNegated(),F.hasNonEmptySelection=new RawContextKey("editorHasSelection",!1,localize("editorHasSelection","Whether the editor has text selected")),F.hasOnlyEmptySelection=F.hasNonEmptySelection.toNegated(),F.hasMultipleSelections=new RawContextKey("editorHasMultipleSelections",!1,localize("editorHasMultipleSelections","Whether the editor has multiple selections")),F.hasSingleSelection=F.hasMultipleSelections.toNegated(),F.tabMovesFocus=new RawContextKey("editorTabMovesFocus",!1,localize("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),F.tabDoesNotMoveFocus=F.tabMovesFocus.toNegated(),F.isInEmbeddedEditor=new RawContextKey("isInEmbeddedEditor",!1,!0),F.canUndo=new RawContextKey("canUndo",!1,!0),F.canRedo=new RawContextKey("canRedo",!1,!0),F.hoverVisible=new RawContextKey("editorHoverVisible",!1,localize("editorHoverVisible","Whether the editor hover is visible")),F.hoverFocused=new RawContextKey("editorHoverFocused",!1,localize("editorHoverFocused","Whether the editor hover is focused")),F.stickyScrollFocused=new RawContextKey("stickyScrollFocused",!1,localize("stickyScrollFocused","Whether the sticky scroll is focused")),F.stickyScrollVisible=new RawContextKey("stickyScrollVisible",!1,localize("stickyScrollVisible","Whether the sticky scroll is visible")),F.standaloneColorPickerVisible=new RawContextKey("standaloneColorPickerVisible",!1,localize("standaloneColorPickerVisible","Whether the standalone color picker is visible")),F.standaloneColorPickerFocused=new RawContextKey("standaloneColorPickerFocused",!1,localize("standaloneColorPickerFocused","Whether the standalone color picker is focused")),F.inCompositeEditor=new RawContextKey("inCompositeEditor",void 0,localize("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),F.notInCompositeEditor=F.inCompositeEditor.toNegated(),F.languageId=new RawContextKey("editorLangId","",localize("editorLangId","The language identifier of the editor")),F.hasCompletionItemProvider=new RawContextKey("editorHasCompletionItemProvider",!1,localize("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),F.hasCodeActionsProvider=new RawContextKey("editorHasCodeActionsProvider",!1,localize("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),F.hasCodeLensProvider=new RawContextKey("editorHasCodeLensProvider",!1,localize("editorHasCodeLensProvider","Whether the editor has a code lens provider")),F.hasDefinitionProvider=new RawContextKey("editorHasDefinitionProvider",!1,localize("editorHasDefinitionProvider","Whether the editor has a definition provider")),F.hasDeclarationProvider=new RawContextKey("editorHasDeclarationProvider",!1,localize("editorHasDeclarationProvider","Whether the editor has a declaration provider")),F.hasImplementationProvider=new RawContextKey("editorHasImplementationProvider",!1,localize("editorHasImplementationProvider","Whether the editor has an implementation provider")),F.hasTypeDefinitionProvider=new RawContextKey("editorHasTypeDefinitionProvider",!1,localize("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),F.hasHoverProvider=new RawContextKey("editorHasHoverProvider",!1,localize("editorHasHoverProvider","Whether the editor has a hover provider")),F.hasDocumentHighlightProvider=new RawContextKey("editorHasDocumentHighlightProvider",!1,localize("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),F.hasDocumentSymbolProvider=new RawContextKey("editorHasDocumentSymbolProvider",!1,localize("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),F.hasReferenceProvider=new RawContextKey("editorHasReferenceProvider",!1,localize("editorHasReferenceProvider","Whether the editor has a reference provider")),F.hasRenameProvider=new RawContextKey("editorHasRenameProvider",!1,localize("editorHasRenameProvider","Whether the editor has a rename provider")),F.hasSignatureHelpProvider=new RawContextKey("editorHasSignatureHelpProvider",!1,localize("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),F.hasInlayHintsProvider=new RawContextKey("editorHasInlayHintsProvider",!1,localize("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),F.hasDocumentFormattingProvider=new RawContextKey("editorHasDocumentFormattingProvider",!1,localize("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),F.hasDocumentSelectionFormattingProvider=new RawContextKey("editorHasDocumentSelectionFormattingProvider",!1,localize("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),F.hasMultipleDocumentFormattingProvider=new RawContextKey("editorHasMultipleDocumentFormattingProvider",!1,localize("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),F.hasMultipleDocumentSelectionFormattingProvider=new RawContextKey("editorHasMultipleDocumentSelectionFormattingProvider",!1,localize("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))})(EditorContextKeys||(EditorContextKeys={}));const USUAL_WORD_SEPARATORS="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function createWordRegExp(F=""){let w="(-?\\d*\\.\\d\\w*)|([^";for(const D of USUAL_WORD_SEPARATORS)F.indexOf(D)>=0||(w+="\\"+D);return w+="\\s]+)",new RegExp(w,"g")}const DEFAULT_WORD_REGEXP=createWordRegExp();function ensureValidWordDefinition(F){let w=DEFAULT_WORD_REGEXP;if(F&&F instanceof RegExp)if(F.global)w=F;else{let D="g";F.ignoreCase&&(D+="i"),F.multiline&&(D+="m"),F.unicode&&(D+="u"),w=new RegExp(F.source,D)}return w.lastIndex=0,w}const _defaultConfig=new LinkedList;_defaultConfig.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function getWordAtText(F,w,D,O,W){if(w=ensureValidWordDefinition(w),W||(W=Iterable.first(_defaultConfig)),D.length>W.maxLen){let Q=F-W.maxLen/2;return Q<0?Q=0:O+=Q,D=D.substring(Q,F+W.maxLen/2),getWordAtText(F,w,D,O,W)}const U=Date.now(),K=F-1-O;let q=-1,G=null;for(let Q=1;!(Date.now()-U>=W.timeBudget);Q++){const Y=K-W.windowSize*Q;w.lastIndex=Math.max(0,Y);const X=_findRegexMatchEnclosingPosition(w,D,K,q);if(!X&&G||(G=X,Y<=0))break;q=Y}if(G){const Q={word:G[0],startColumn:O+1+G.index,endColumn:O+1+G.index+G[0].length};return w.lastIndex=0,Q}return null}function _findRegexMatchEnclosingPosition(F,w,D,O){let W;for(;W=F.exec(w);){const U=W.index||0;if(U<=D&&F.lastIndex>=D)return W;if(O>0&&U>O)return null}return null}var IndentAction$1;(function(F){F[F.None=0]="None",F[F.Indent=1]="Indent",F[F.IndentOutdent=2]="IndentOutdent",F[F.Outdent=3]="Outdent"})(IndentAction$1||(IndentAction$1={}));class StandardAutoClosingPairConditional{constructor(w){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=w.open,this.close=w.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(w.notIn))for(let D=0,O=w.notIn.length;D<O;D++)switch(w.notIn[D]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(w){switch(w){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(w,D){if(w.getTokenCount()===0)return!0;const O=w.findTokenIndexAtOffset(D-2),W=w.getStandardTokenType(O);return this.isOK(W)}_findNeutralCharacterInRange(w,D){for(let O=w;O<=D;O++){const W=String.fromCharCode(O);if(!this.open.includes(W)&&!this.close.includes(W))return W}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}}class AutoClosingPairs{constructor(w){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const D of w)appendEntry(this.autoClosingPairsOpenByStart,D.open.charAt(0),D),appendEntry(this.autoClosingPairsOpenByEnd,D.open.charAt(D.open.length-1),D),appendEntry(this.autoClosingPairsCloseByStart,D.close.charAt(0),D),appendEntry(this.autoClosingPairsCloseByEnd,D.close.charAt(D.close.length-1),D),D.close.length===1&&D.open.length===1&&appendEntry(this.autoClosingPairsCloseSingleChar,D.close,D)}}function appendEntry(F,w,D){F.has(w)?F.get(w).push(D):F.set(w,[D])}class CharacterPairSupport{static{this.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`}static{this.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`}constructor(w){if(w.autoClosingPairs?this._autoClosingPairs=w.autoClosingPairs.map(D=>new StandardAutoClosingPairConditional(D)):w.brackets?this._autoClosingPairs=w.brackets.map(D=>new StandardAutoClosingPairConditional({open:D[0],close:D[1]})):this._autoClosingPairs=[],w.__electricCharacterSupport&&w.__electricCharacterSupport.docComment){const D=w.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new StandardAutoClosingPairConditional({open:D.open,close:D.close||""}))}this._autoCloseBeforeForQuotes=typeof w.autoCloseBefore=="string"?w.autoCloseBefore:CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof w.autoCloseBefore=="string"?w.autoCloseBefore:CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=w.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(w){return w?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}}function createScopedLineTokens(F,w){const D=F.getCount(),O=F.findTokenIndexAtOffset(w),W=F.getLanguageId(O);let U=O;for(;U+1<D&&F.getLanguageId(U+1)===W;)U++;let K=O;for(;K>0&&F.getLanguageId(K-1)===W;)K--;return new ScopedLineTokens(F,W,K,U+1,F.getStartOffset(K),F.getEndOffset(U))}class ScopedLineTokens{constructor(w,D,O,W,U,K){this._scopedLineTokensBrand=void 0,this._actual=w,this.languageId=D,this._firstTokenIndex=O,this._lastTokenIndex=W,this.firstCharOffset=U,this._lastCharOffset=K,this.languageIdCodec=w.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(w){return this._actual.getLineContent().substring(0,this.firstCharOffset+w)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(w){return this._actual.findTokenIndexAtOffset(w+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(w){return this._actual.getStandardTokenType(w+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}}function ignoreBracketsInToken(F){return(F&3)!==0}var buffer={},base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i$2=0,len=code.length;i$2<len;++i$2)lookup[i$2]=code[i$2],revLookup[code.charCodeAt(i$2)]=i$2;revLookup[45]=62;revLookup[95]=63;function getLens(F){var w=F.length;if(w%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var D=F.indexOf("=");D===-1&&(D=w);var O=D===w?0:4-D%4;return[D,O]}function byteLength(F){var w=getLens(F),D=w[0],O=w[1];return(D+O)*3/4-O}function _byteLength(F,w,D){return(w+D)*3/4-D}function toByteArray(F){var w,D=getLens(F),O=D[0],W=D[1],U=new Arr(_byteLength(F,O,W)),K=0,q=W>0?O-4:O,G;for(G=0;G<q;G+=4)w=revLookup[F.charCodeAt(G)]<<18|revLookup[F.charCodeAt(G+1)]<<12|revLookup[F.charCodeAt(G+2)]<<6|revLookup[F.charCodeAt(G+3)],U[K++]=w>>16&255,U[K++]=w>>8&255,U[K++]=w&255;return W===2&&(w=revLookup[F.charCodeAt(G)]<<2|revLookup[F.charCodeAt(G+1)]>>4,U[K++]=w&255),W===1&&(w=revLookup[F.charCodeAt(G)]<<10|revLookup[F.charCodeAt(G+1)]<<4|revLookup[F.charCodeAt(G+2)]>>2,U[K++]=w>>8&255,U[K++]=w&255),U}function tripletToBase64(F){return lookup[F>>18&63]+lookup[F>>12&63]+lookup[F>>6&63]+lookup[F&63]}function encodeChunk(F,w,D){for(var O,W=[],U=w;U<D;U+=3)O=(F[U]<<16&16711680)+(F[U+1]<<8&65280)+(F[U+2]&255),W.push(tripletToBase64(O));return W.join("")}function fromByteArray(F){for(var w,D=F.length,O=D%3,W=[],U=16383,K=0,q=D-O;K<q;K+=U)W.push(encodeChunk(F,K,K+U>q?q:K+U));return O===1?(w=F[D-1],W.push(lookup[w>>2]+lookup[w<<4&63]+"==")):O===2&&(w=(F[D-2]<<8)+F[D-1],W.push(lookup[w>>10]+lookup[w>>4&63]+lookup[w<<2&63]+"=")),W.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(F,w,D,O,W){var U,K,q=W*8-O-1,G=(1<<q)-1,Q=G>>1,Y=-7,X=D?W-1:0,J=D?-1:1,te=F[w+X];for(X+=J,U=te&(1<<-Y)-1,te>>=-Y,Y+=q;Y>0;U=U*256+F[w+X],X+=J,Y-=8);for(K=U&(1<<-Y)-1,U>>=-Y,Y+=O;Y>0;K=K*256+F[w+X],X+=J,Y-=8);if(U===0)U=1-Q;else{if(U===G)return K?NaN:(te?-1:1)*(1/0);K=K+Math.pow(2,O),U=U-Q}return(te?-1:1)*K*Math.pow(2,U-O)};ieee754.write=function(F,w,D,O,W,U){var K,q,G,Q=U*8-W-1,Y=(1<<Q)-1,X=Y>>1,J=W===23?Math.pow(2,-24)-Math.pow(2,-77):0,te=O?0:U-1,ie=O?1:-1,se=w<0||w===0&&1/w<0?1:0;for(w=Math.abs(w),isNaN(w)||w===1/0?(q=isNaN(w)?1:0,K=Y):(K=Math.floor(Math.log(w)/Math.LN2),w*(G=Math.pow(2,-K))<1&&(K--,G*=2),K+X>=1?w+=J/G:w+=J*Math.pow(2,1-X),w*G>=2&&(K++,G/=2),K+X>=Y?(q=0,K=Y):K+X>=1?(q=(w*G-1)*Math.pow(2,W),K=K+X):(q=w*Math.pow(2,X-1)*Math.pow(2,W),K=0));W>=8;F[D+te]=q&255,te+=ie,q/=256,W-=8);for(K=K<<W|q,Q+=W;Q>0;F[D+te]=K&255,te+=ie,K/=256,Q-=8);F[D+te-ie]|=se*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(F){const w=base64Js,D=ieee754,O=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;F.Buffer=Y,F.SlowBuffer=ue,F.INSPECT_MAX_BYTES=50;const W=2147483647;F.kMaxLength=W;const{Uint8Array:U,ArrayBuffer:K,SharedArrayBuffer:q}=globalThis;Y.TYPED_ARRAY_SUPPORT=G(),!Y.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function G(){try{const Se=new U(1),ge={foo:function(){return 42}};return Object.setPrototypeOf(ge,U.prototype),Object.setPrototypeOf(Se,ge),Se.foo()===42}catch{return!1}}Object.defineProperty(Y.prototype,"parent",{enumerable:!0,get:function(){if(Y.isBuffer(this))return this.buffer}}),Object.defineProperty(Y.prototype,"offset",{enumerable:!0,get:function(){if(Y.isBuffer(this))return this.byteOffset}});function Q(Se){if(Se>W)throw new RangeError('The value "'+Se+'" is invalid for option "size"');const ge=new U(Se);return Object.setPrototypeOf(ge,Y.prototype),ge}function Y(Se,ge,_e){if(typeof Se=="number"){if(typeof ge=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return ie(Se)}return X(Se,ge,_e)}Y.poolSize=8192;function X(Se,ge,_e){if(typeof Se=="string")return se(Se,ge);if(K.isView(Se))return ae(Se);if(Se==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Se);if(Jt(Se,K)||Se&&Jt(Se.buffer,K)||typeof q<"u"&&(Jt(Se,q)||Se&&Jt(Se.buffer,q)))return le(Se,ge,_e);if(typeof Se=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ke=Se.valueOf&&Se.valueOf();if(ke!=null&&ke!==Se)return Y.from(ke,ge,_e);const Fe=de(Se);if(Fe)return Fe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Se[Symbol.toPrimitive]=="function")return Y.from(Se[Symbol.toPrimitive]("string"),ge,_e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Se)}Y.from=function(Se,ge,_e){return X(Se,ge,_e)},Object.setPrototypeOf(Y.prototype,U.prototype),Object.setPrototypeOf(Y,U);function J(Se){if(typeof Se!="number")throw new TypeError('"size" argument must be of type number');if(Se<0)throw new RangeError('The value "'+Se+'" is invalid for option "size"')}function te(Se,ge,_e){return J(Se),Se<=0?Q(Se):ge!==void 0?typeof _e=="string"?Q(Se).fill(ge,_e):Q(Se).fill(ge):Q(Se)}Y.alloc=function(Se,ge,_e){return te(Se,ge,_e)};function ie(Se){return J(Se),Q(Se<0?0:oe(Se)|0)}Y.allocUnsafe=function(Se){return ie(Se)},Y.allocUnsafeSlow=function(Se){return ie(Se)};function se(Se,ge){if((typeof ge!="string"||ge==="")&&(ge="utf8"),!Y.isEncoding(ge))throw new TypeError("Unknown encoding: "+ge);const _e=pe(Se,ge)|0;let ke=Q(_e);const Fe=ke.write(Se,ge);return Fe!==_e&&(ke=ke.slice(0,Fe)),ke}function re(Se){const ge=Se.length<0?0:oe(Se.length)|0,_e=Q(ge);for(let ke=0;ke<ge;ke+=1)_e[ke]=Se[ke]&255;return _e}function ae(Se){if(Jt(Se,U)){const ge=new U(Se);return le(ge.buffer,ge.byteOffset,ge.byteLength)}return re(Se)}function le(Se,ge,_e){if(ge<0||Se.byteLength<ge)throw new RangeError('"offset" is outside of buffer bounds');if(Se.byteLength<ge+(_e||0))throw new RangeError('"length" is outside of buffer bounds');let ke;return ge===void 0&&_e===void 0?ke=new U(Se):_e===void 0?ke=new U(Se,ge):ke=new U(Se,ge,_e),Object.setPrototypeOf(ke,Y.prototype),ke}function de(Se){if(Y.isBuffer(Se)){const ge=oe(Se.length)|0,_e=Q(ge);return _e.length===0||Se.copy(_e,0,0,ge),_e}if(Se.length!==void 0)return typeof Se.length!="number"||_i(Se.length)?Q(0):re(Se);if(Se.type==="Buffer"&&Array.isArray(Se.data))return re(Se.data)}function oe(Se){if(Se>=W)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+W.toString(16)+" bytes");return Se|0}function ue(Se){return+Se!=Se&&(Se=0),Y.alloc(+Se)}Y.isBuffer=function(ge){return ge!=null&&ge._isBuffer===!0&&ge!==Y.prototype},Y.compare=function(ge,_e){if(Jt(ge,U)&&(ge=Y.from(ge,ge.offset,ge.byteLength)),Jt(_e,U)&&(_e=Y.from(_e,_e.offset,_e.byteLength)),!Y.isBuffer(ge)||!Y.isBuffer(_e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ge===_e)return 0;let ke=ge.length,Fe=_e.length;for(let qe=0,tt=Math.min(ke,Fe);qe<tt;++qe)if(ge[qe]!==_e[qe]){ke=ge[qe],Fe=_e[qe];break}return ke<Fe?-1:Fe<ke?1:0},Y.isEncoding=function(ge){switch(String(ge).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Y.concat=function(ge,_e){if(!Array.isArray(ge))throw new TypeError('"list" argument must be an Array of Buffers');if(ge.length===0)return Y.alloc(0);let ke;if(_e===void 0)for(_e=0,ke=0;ke<ge.length;++ke)_e+=ge[ke].length;const Fe=Y.allocUnsafe(_e);let qe=0;for(ke=0;ke<ge.length;++ke){let tt=ge[ke];if(Jt(tt,U))qe+tt.length>Fe.length?(Y.isBuffer(tt)||(tt=Y.from(tt)),tt.copy(Fe,qe)):U.prototype.set.call(Fe,tt,qe);else if(Y.isBuffer(tt))tt.copy(Fe,qe);else throw new TypeError('"list" argument must be an Array of Buffers');qe+=tt.length}return Fe};function pe(Se,ge){if(Y.isBuffer(Se))return Se.length;if(K.isView(Se)||Jt(Se,K))return Se.byteLength;if(typeof Se!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Se);const _e=Se.length,ke=arguments.length>2&&arguments[2]===!0;if(!ke&&_e===0)return 0;let Fe=!1;for(;;)switch(ge){case"ascii":case"latin1":case"binary":return _e;case"utf8":case"utf-8":return pi(Se).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _e*2;case"hex":return _e>>>1;case"base64":return ki(Se).length;default:if(Fe)return ke?-1:pi(Se).length;ge=(""+ge).toLowerCase(),Fe=!0}}Y.byteLength=pe;function fe(Se,ge,_e){let ke=!1;if((ge===void 0||ge<0)&&(ge=0),ge>this.length||((_e===void 0||_e>this.length)&&(_e=this.length),_e<=0)||(_e>>>=0,ge>>>=0,_e<=ge))return"";for(Se||(Se="utf8");;)switch(Se){case"hex":return Tt(this,ge,_e);case"utf8":case"utf-8":return Ye(this,ge,_e);case"ascii":return st(this,ge,_e);case"latin1":case"binary":return lt(this,ge,_e);case"base64":return Qe(this,ge,_e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ke(this,ge,_e);default:if(ke)throw new TypeError("Unknown encoding: "+Se);Se=(Se+"").toLowerCase(),ke=!0}}Y.prototype._isBuffer=!0;function Ce(Se,ge,_e){const ke=Se[ge];Se[ge]=Se[_e],Se[_e]=ke}Y.prototype.swap16=function(){const ge=this.length;if(ge%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let _e=0;_e<ge;_e+=2)Ce(this,_e,_e+1);return this},Y.prototype.swap32=function(){const ge=this.length;if(ge%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let _e=0;_e<ge;_e+=4)Ce(this,_e,_e+3),Ce(this,_e+1,_e+2);return this},Y.prototype.swap64=function(){const ge=this.length;if(ge%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let _e=0;_e<ge;_e+=8)Ce(this,_e,_e+7),Ce(this,_e+1,_e+6),Ce(this,_e+2,_e+5),Ce(this,_e+3,_e+4);return this},Y.prototype.toString=function(){const ge=this.length;return ge===0?"":arguments.length===0?Ye(this,0,ge):fe.apply(this,arguments)},Y.prototype.toLocaleString=Y.prototype.toString,Y.prototype.equals=function(ge){if(!Y.isBuffer(ge))throw new TypeError("Argument must be a Buffer");return this===ge?!0:Y.compare(this,ge)===0},Y.prototype.inspect=function(){let ge="";const _e=F.INSPECT_MAX_BYTES;return ge=this.toString("hex",0,_e).replace(/(.{2})/g,"$1 ").trim(),this.length>_e&&(ge+=" ... "),"<Buffer "+ge+">"},O&&(Y.prototype[O]=Y.prototype.inspect),Y.prototype.compare=function(ge,_e,ke,Fe,qe){if(Jt(ge,U)&&(ge=Y.from(ge,ge.offset,ge.byteLength)),!Y.isBuffer(ge))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ge);if(_e===void 0&&(_e=0),ke===void 0&&(ke=ge?ge.length:0),Fe===void 0&&(Fe=0),qe===void 0&&(qe=this.length),_e<0||ke>ge.length||Fe<0||qe>this.length)throw new RangeError("out of range index");if(Fe>=qe&&_e>=ke)return 0;if(Fe>=qe)return-1;if(_e>=ke)return 1;if(_e>>>=0,ke>>>=0,Fe>>>=0,qe>>>=0,this===ge)return 0;let tt=qe-Fe,It=ke-_e;const wt=Math.min(tt,It),Ht=this.slice(Fe,qe),ri=ge.slice(_e,ke);for(let qt=0;qt<wt;++qt)if(Ht[qt]!==ri[qt]){tt=Ht[qt],It=ri[qt];break}return tt<It?-1:It<tt?1:0};function we(Se,ge,_e,ke,Fe){if(Se.length===0)return-1;if(typeof _e=="string"?(ke=_e,_e=0):_e>2147483647?_e=2147483647:_e<-2147483648&&(_e=-2147483648),_e=+_e,_i(_e)&&(_e=Fe?0:Se.length-1),_e<0&&(_e=Se.length+_e),_e>=Se.length){if(Fe)return-1;_e=Se.length-1}else if(_e<0)if(Fe)_e=0;else return-1;if(typeof ge=="string"&&(ge=Y.from(ge,ke)),Y.isBuffer(ge))return ge.length===0?-1:Oe(Se,ge,_e,ke,Fe);if(typeof ge=="number")return ge=ge&255,typeof U.prototype.indexOf=="function"?Fe?U.prototype.indexOf.call(Se,ge,_e):U.prototype.lastIndexOf.call(Se,ge,_e):Oe(Se,[ge],_e,ke,Fe);throw new TypeError("val must be string, number or Buffer")}function Oe(Se,ge,_e,ke,Fe){let qe=1,tt=Se.length,It=ge.length;if(ke!==void 0&&(ke=String(ke).toLowerCase(),ke==="ucs2"||ke==="ucs-2"||ke==="utf16le"||ke==="utf-16le")){if(Se.length<2||ge.length<2)return-1;qe=2,tt/=2,It/=2,_e/=2}function wt(ri,qt){return qe===1?ri[qt]:ri.readUInt16BE(qt*qe)}let Ht;if(Fe){let ri=-1;for(Ht=_e;Ht<tt;Ht++)if(wt(Se,Ht)===wt(ge,ri===-1?0:Ht-ri)){if(ri===-1&&(ri=Ht),Ht-ri+1===It)return ri*qe}else ri!==-1&&(Ht-=Ht-ri),ri=-1}else for(_e+It>tt&&(_e=tt-It),Ht=_e;Ht>=0;Ht--){let ri=!0;for(let qt=0;qt<It;qt++)if(wt(Se,Ht+qt)!==wt(ge,qt)){ri=!1;break}if(ri)return Ht}return-1}Y.prototype.includes=function(ge,_e,ke){return this.indexOf(ge,_e,ke)!==-1},Y.prototype.indexOf=function(ge,_e,ke){return we(this,ge,_e,ke,!0)},Y.prototype.lastIndexOf=function(ge,_e,ke){return we(this,ge,_e,ke,!1)};function Te(Se,ge,_e,ke){_e=Number(_e)||0;const Fe=Se.length-_e;ke?(ke=Number(ke),ke>Fe&&(ke=Fe)):ke=Fe;const qe=ge.length;ke>qe/2&&(ke=qe/2);let tt;for(tt=0;tt<ke;++tt){const It=parseInt(ge.substr(tt*2,2),16);if(_i(It))return tt;Se[_e+tt]=It}return tt}function Re(Se,ge,_e,ke){return Ii(pi(ge,Se.length-_e),Se,_e,ke)}function Me(Se,ge,_e,ke){return Ii(mi(ge),Se,_e,ke)}function Ne(Se,ge,_e,ke){return Ii(ki(ge),Se,_e,ke)}function ze(Se,ge,_e,ke){return Ii(kt(ge,Se.length-_e),Se,_e,ke)}Y.prototype.write=function(ge,_e,ke,Fe){if(_e===void 0)Fe="utf8",ke=this.length,_e=0;else if(ke===void 0&&typeof _e=="string")Fe=_e,ke=this.length,_e=0;else if(isFinite(_e))_e=_e>>>0,isFinite(ke)?(ke=ke>>>0,Fe===void 0&&(Fe="utf8")):(Fe=ke,ke=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const qe=this.length-_e;if((ke===void 0||ke>qe)&&(ke=qe),ge.length>0&&(ke<0||_e<0)||_e>this.length)throw new RangeError("Attempt to write outside buffer bounds");Fe||(Fe="utf8");let tt=!1;for(;;)switch(Fe){case"hex":return Te(this,ge,_e,ke);case"utf8":case"utf-8":return Re(this,ge,_e,ke);case"ascii":case"latin1":case"binary":return Me(this,ge,_e,ke);case"base64":return Ne(this,ge,_e,ke);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ze(this,ge,_e,ke);default:if(tt)throw new TypeError("Unknown encoding: "+Fe);Fe=(""+Fe).toLowerCase(),tt=!0}},Y.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Qe(Se,ge,_e){return ge===0&&_e===Se.length?w.fromByteArray(Se):w.fromByteArray(Se.slice(ge,_e))}function Ye(Se,ge,_e){_e=Math.min(Se.length,_e);const ke=[];let Fe=ge;for(;Fe<_e;){const qe=Se[Fe];let tt=null,It=qe>239?4:qe>223?3:qe>191?2:1;if(Fe+It<=_e){let wt,Ht,ri,qt;switch(It){case 1:qe<128&&(tt=qe);break;case 2:wt=Se[Fe+1],(wt&192)===128&&(qt=(qe&31)<<6|wt&63,qt>127&&(tt=qt));break;case 3:wt=Se[Fe+1],Ht=Se[Fe+2],(wt&192)===128&&(Ht&192)===128&&(qt=(qe&15)<<12|(wt&63)<<6|Ht&63,qt>2047&&(qt<55296||qt>57343)&&(tt=qt));break;case 4:wt=Se[Fe+1],Ht=Se[Fe+2],ri=Se[Fe+3],(wt&192)===128&&(Ht&192)===128&&(ri&192)===128&&(qt=(qe&15)<<18|(wt&63)<<12|(Ht&63)<<6|ri&63,qt>65535&&qt<1114112&&(tt=qt))}}tt===null?(tt=65533,It=1):tt>65535&&(tt-=65536,ke.push(tt>>>10&1023|55296),tt=56320|tt&1023),ke.push(tt),Fe+=It}return at(ke)}const Je=4096;function at(Se){const ge=Se.length;if(ge<=Je)return String.fromCharCode.apply(String,Se);let _e="",ke=0;for(;ke<ge;)_e+=String.fromCharCode.apply(String,Se.slice(ke,ke+=Je));return _e}function st(Se,ge,_e){let ke="";_e=Math.min(Se.length,_e);for(let Fe=ge;Fe<_e;++Fe)ke+=String.fromCharCode(Se[Fe]&127);return ke}function lt(Se,ge,_e){let ke="";_e=Math.min(Se.length,_e);for(let Fe=ge;Fe<_e;++Fe)ke+=String.fromCharCode(Se[Fe]);return ke}function Tt(Se,ge,_e){const ke=Se.length;(!ge||ge<0)&&(ge=0),(!_e||_e<0||_e>ke)&&(_e=ke);let Fe="";for(let qe=ge;qe<_e;++qe)Fe+=Lt[Se[qe]];return Fe}function Ke(Se,ge,_e){const ke=Se.slice(ge,_e);let Fe="";for(let qe=0;qe<ke.length-1;qe+=2)Fe+=String.fromCharCode(ke[qe]+ke[qe+1]*256);return Fe}Y.prototype.slice=function(ge,_e){const ke=this.length;ge=~~ge,_e=_e===void 0?ke:~~_e,ge<0?(ge+=ke,ge<0&&(ge=0)):ge>ke&&(ge=ke),_e<0?(_e+=ke,_e<0&&(_e=0)):_e>ke&&(_e=ke),_e<ge&&(_e=ge);const Fe=this.subarray(ge,_e);return Object.setPrototypeOf(Fe,Y.prototype),Fe};function je(Se,ge,_e){if(Se%1!==0||Se<0)throw new RangeError("offset is not uint");if(Se+ge>_e)throw new RangeError("Trying to access beyond buffer length")}Y.prototype.readUintLE=Y.prototype.readUIntLE=function(ge,_e,ke){ge=ge>>>0,_e=_e>>>0,ke||je(ge,_e,this.length);let Fe=this[ge],qe=1,tt=0;for(;++tt<_e&&(qe*=256);)Fe+=this[ge+tt]*qe;return Fe},Y.prototype.readUintBE=Y.prototype.readUIntBE=function(ge,_e,ke){ge=ge>>>0,_e=_e>>>0,ke||je(ge,_e,this.length);let Fe=this[ge+--_e],qe=1;for(;_e>0&&(qe*=256);)Fe+=this[ge+--_e]*qe;return Fe},Y.prototype.readUint8=Y.prototype.readUInt8=function(ge,_e){return ge=ge>>>0,_e||je(ge,1,this.length),this[ge]},Y.prototype.readUint16LE=Y.prototype.readUInt16LE=function(ge,_e){return ge=ge>>>0,_e||je(ge,2,this.length),this[ge]|this[ge+1]<<8},Y.prototype.readUint16BE=Y.prototype.readUInt16BE=function(ge,_e){return ge=ge>>>0,_e||je(ge,2,this.length),this[ge]<<8|this[ge+1]},Y.prototype.readUint32LE=Y.prototype.readUInt32LE=function(ge,_e){return ge=ge>>>0,_e||je(ge,4,this.length),(this[ge]|this[ge+1]<<8|this[ge+2]<<16)+this[ge+3]*16777216},Y.prototype.readUint32BE=Y.prototype.readUInt32BE=function(ge,_e){return ge=ge>>>0,_e||je(ge,4,this.length),this[ge]*16777216+(this[ge+1]<<16|this[ge+2]<<8|this[ge+3])},Y.prototype.readBigUInt64LE=St(function(ge){ge=ge>>>0,hi(ge,"offset");const _e=this[ge],ke=this[ge+7];(_e===void 0||ke===void 0)&&jt(ge,this.length-8);const Fe=_e+this[++ge]*2**8+this[++ge]*2**16+this[++ge]*2**24,qe=this[++ge]+this[++ge]*2**8+this[++ge]*2**16+ke*2**24;return BigInt(Fe)+(BigInt(qe)<<BigInt(32))}),Y.prototype.readBigUInt64BE=St(function(ge){ge=ge>>>0,hi(ge,"offset");const _e=this[ge],ke=this[ge+7];(_e===void 0||ke===void 0)&&jt(ge,this.length-8);const Fe=_e*2**24+this[++ge]*2**16+this[++ge]*2**8+this[++ge],qe=this[++ge]*2**24+this[++ge]*2**16+this[++ge]*2**8+ke;return(BigInt(Fe)<<BigInt(32))+BigInt(qe)}),Y.prototype.readIntLE=function(ge,_e,ke){ge=ge>>>0,_e=_e>>>0,ke||je(ge,_e,this.length);let Fe=this[ge],qe=1,tt=0;for(;++tt<_e&&(qe*=256);)Fe+=this[ge+tt]*qe;return qe*=128,Fe>=qe&&(Fe-=Math.pow(2,8*_e)),Fe},Y.prototype.readIntBE=function(ge,_e,ke){ge=ge>>>0,_e=_e>>>0,ke||je(ge,_e,this.length);let Fe=_e,qe=1,tt=this[ge+--Fe];for(;Fe>0&&(qe*=256);)tt+=this[ge+--Fe]*qe;return qe*=128,tt>=qe&&(tt-=Math.pow(2,8*_e)),tt},Y.prototype.readInt8=function(ge,_e){return ge=ge>>>0,_e||je(ge,1,this.length),this[ge]&128?(255-this[ge]+1)*-1:this[ge]},Y.prototype.readInt16LE=function(ge,_e){ge=ge>>>0,_e||je(ge,2,this.length);const ke=this[ge]|this[ge+1]<<8;return ke&32768?ke|4294901760:ke},Y.prototype.readInt16BE=function(ge,_e){ge=ge>>>0,_e||je(ge,2,this.length);const ke=this[ge+1]|this[ge]<<8;return ke&32768?ke|4294901760:ke},Y.prototype.readInt32LE=function(ge,_e){return ge=ge>>>0,_e||je(ge,4,this.length),this[ge]|this[ge+1]<<8|this[ge+2]<<16|this[ge+3]<<24},Y.prototype.readInt32BE=function(ge,_e){return ge=ge>>>0,_e||je(ge,4,this.length),this[ge]<<24|this[ge+1]<<16|this[ge+2]<<8|this[ge+3]},Y.prototype.readBigInt64LE=St(function(ge){ge=ge>>>0,hi(ge,"offset");const _e=this[ge],ke=this[ge+7];(_e===void 0||ke===void 0)&&jt(ge,this.length-8);const Fe=this[ge+4]+this[ge+5]*2**8+this[ge+6]*2**16+(ke<<24);return(BigInt(Fe)<<BigInt(32))+BigInt(_e+this[++ge]*2**8+this[++ge]*2**16+this[++ge]*2**24)}),Y.prototype.readBigInt64BE=St(function(ge){ge=ge>>>0,hi(ge,"offset");const _e=this[ge],ke=this[ge+7];(_e===void 0||ke===void 0)&&jt(ge,this.length-8);const Fe=(_e<<24)+this[++ge]*2**16+this[++ge]*2**8+this[++ge];return(BigInt(Fe)<<BigInt(32))+BigInt(this[++ge]*2**24+this[++ge]*2**16+this[++ge]*2**8+ke)}),Y.prototype.readFloatLE=function(ge,_e){return ge=ge>>>0,_e||je(ge,4,this.length),D.read(this,ge,!0,23,4)},Y.prototype.readFloatBE=function(ge,_e){return ge=ge>>>0,_e||je(ge,4,this.length),D.read(this,ge,!1,23,4)},Y.prototype.readDoubleLE=function(ge,_e){return ge=ge>>>0,_e||je(ge,8,this.length),D.read(this,ge,!0,52,8)},Y.prototype.readDoubleBE=function(ge,_e){return ge=ge>>>0,_e||je(ge,8,this.length),D.read(this,ge,!1,52,8)};function et(Se,ge,_e,ke,Fe,qe){if(!Y.isBuffer(Se))throw new TypeError('"buffer" argument must be a Buffer instance');if(ge>Fe||ge<qe)throw new RangeError('"value" argument is out of bounds');if(_e+ke>Se.length)throw new RangeError("Index out of range")}Y.prototype.writeUintLE=Y.prototype.writeUIntLE=function(ge,_e,ke,Fe){if(ge=+ge,_e=_e>>>0,ke=ke>>>0,!Fe){const It=Math.pow(2,8*ke)-1;et(this,ge,_e,ke,It,0)}let qe=1,tt=0;for(this[_e]=ge&255;++tt<ke&&(qe*=256);)this[_e+tt]=ge/qe&255;return _e+ke},Y.prototype.writeUintBE=Y.prototype.writeUIntBE=function(ge,_e,ke,Fe){if(ge=+ge,_e=_e>>>0,ke=ke>>>0,!Fe){const It=Math.pow(2,8*ke)-1;et(this,ge,_e,ke,It,0)}let qe=ke-1,tt=1;for(this[_e+qe]=ge&255;--qe>=0&&(tt*=256);)this[_e+qe]=ge/tt&255;return _e+ke},Y.prototype.writeUint8=Y.prototype.writeUInt8=function(ge,_e,ke){return ge=+ge,_e=_e>>>0,ke||et(this,ge,_e,1,255,0),this[_e]=ge&255,_e+1},Y.prototype.writeUint16LE=Y.prototype.writeUInt16LE=function(ge,_e,ke){return ge=+ge,_e=_e>>>0,ke||et(this,ge,_e,2,65535,0),this[_e]=ge&255,this[_e+1]=ge>>>8,_e+2},Y.prototype.writeUint16BE=Y.prototype.writeUInt16BE=function(ge,_e,ke){return ge=+ge,_e=_e>>>0,ke||et(this,ge,_e,2,65535,0),this[_e]=ge>>>8,this[_e+1]=ge&255,_e+2},Y.prototype.writeUint32LE=Y.prototype.writeUInt32LE=function(ge,_e,ke){return ge=+ge,_e=_e>>>0,ke||et(this,ge,_e,4,4294967295,0),this[_e+3]=ge>>>24,this[_e+2]=ge>>>16,this[_e+1]=ge>>>8,this[_e]=ge&255,_e+4},Y.prototype.writeUint32BE=Y.prototype.writeUInt32BE=function(ge,_e,ke){return ge=+ge,_e=_e>>>0,ke||et(this,ge,_e,4,4294967295,0),this[_e]=ge>>>24,this[_e+1]=ge>>>16,this[_e+2]=ge>>>8,this[_e+3]=ge&255,_e+4};function mt(Se,ge,_e,ke,Fe){vi(ge,ke,Fe,Se,_e,7);let qe=Number(ge&BigInt(4294967295));Se[_e++]=qe,qe=qe>>8,Se[_e++]=qe,qe=qe>>8,Se[_e++]=qe,qe=qe>>8,Se[_e++]=qe;let tt=Number(ge>>BigInt(32)&BigInt(4294967295));return Se[_e++]=tt,tt=tt>>8,Se[_e++]=tt,tt=tt>>8,Se[_e++]=tt,tt=tt>>8,Se[_e++]=tt,_e}function Mt(Se,ge,_e,ke,Fe){vi(ge,ke,Fe,Se,_e,7);let qe=Number(ge&BigInt(4294967295));Se[_e+7]=qe,qe=qe>>8,Se[_e+6]=qe,qe=qe>>8,Se[_e+5]=qe,qe=qe>>8,Se[_e+4]=qe;let tt=Number(ge>>BigInt(32)&BigInt(4294967295));return Se[_e+3]=tt,tt=tt>>8,Se[_e+2]=tt,tt=tt>>8,Se[_e+1]=tt,tt=tt>>8,Se[_e]=tt,_e+8}Y.prototype.writeBigUInt64LE=St(function(ge,_e=0){return mt(this,ge,_e,BigInt(0),BigInt("0xffffffffffffffff"))}),Y.prototype.writeBigUInt64BE=St(function(ge,_e=0){return Mt(this,ge,_e,BigInt(0),BigInt("0xffffffffffffffff"))}),Y.prototype.writeIntLE=function(ge,_e,ke,Fe){if(ge=+ge,_e=_e>>>0,!Fe){const wt=Math.pow(2,8*ke-1);et(this,ge,_e,ke,wt-1,-wt)}let qe=0,tt=1,It=0;for(this[_e]=ge&255;++qe<ke&&(tt*=256);)ge<0&&It===0&&this[_e+qe-1]!==0&&(It=1),this[_e+qe]=(ge/tt>>0)-It&255;return _e+ke},Y.prototype.writeIntBE=function(ge,_e,ke,Fe){if(ge=+ge,_e=_e>>>0,!Fe){const wt=Math.pow(2,8*ke-1);et(this,ge,_e,ke,wt-1,-wt)}let qe=ke-1,tt=1,It=0;for(this[_e+qe]=ge&255;--qe>=0&&(tt*=256);)ge<0&&It===0&&this[_e+qe+1]!==0&&(It=1),this[_e+qe]=(ge/tt>>0)-It&255;return _e+ke},Y.prototype.writeInt8=function(ge,_e,ke){return ge=+ge,_e=_e>>>0,ke||et(this,ge,_e,1,127,-128),ge<0&&(ge=255+ge+1),this[_e]=ge&255,_e+1},Y.prototype.writeInt16LE=function(ge,_e,ke){return ge=+ge,_e=_e>>>0,ke||et(this,ge,_e,2,32767,-32768),this[_e]=ge&255,this[_e+1]=ge>>>8,_e+2},Y.prototype.writeInt16BE=function(ge,_e,ke){return ge=+ge,_e=_e>>>0,ke||et(this,ge,_e,2,32767,-32768),this[_e]=ge>>>8,this[_e+1]=ge&255,_e+2},Y.prototype.writeInt32LE=function(ge,_e,ke){return ge=+ge,_e=_e>>>0,ke||et(this,ge,_e,4,2147483647,-2147483648),this[_e]=ge&255,this[_e+1]=ge>>>8,this[_e+2]=ge>>>16,this[_e+3]=ge>>>24,_e+4},Y.prototype.writeInt32BE=function(ge,_e,ke){return ge=+ge,_e=_e>>>0,ke||et(this,ge,_e,4,2147483647,-2147483648),ge<0&&(ge=4294967295+ge+1),this[_e]=ge>>>24,this[_e+1]=ge>>>16,this[_e+2]=ge>>>8,this[_e+3]=ge&255,_e+4},Y.prototype.writeBigInt64LE=St(function(ge,_e=0){return mt(this,ge,_e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),Y.prototype.writeBigInt64BE=St(function(ge,_e=0){return Mt(this,ge,_e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Et(Se,ge,_e,ke,Fe,qe){if(_e+ke>Se.length)throw new RangeError("Index out of range");if(_e<0)throw new RangeError("Index out of range")}function Ct(Se,ge,_e,ke,Fe){return ge=+ge,_e=_e>>>0,Fe||Et(Se,ge,_e,4),D.write(Se,ge,_e,ke,23,4),_e+4}Y.prototype.writeFloatLE=function(ge,_e,ke){return Ct(this,ge,_e,!0,ke)},Y.prototype.writeFloatBE=function(ge,_e,ke){return Ct(this,ge,_e,!1,ke)};function Nt(Se,ge,_e,ke,Fe){return ge=+ge,_e=_e>>>0,Fe||Et(Se,ge,_e,8),D.write(Se,ge,_e,ke,52,8),_e+8}Y.prototype.writeDoubleLE=function(ge,_e,ke){return Nt(this,ge,_e,!0,ke)},Y.prototype.writeDoubleBE=function(ge,_e,ke){return Nt(this,ge,_e,!1,ke)},Y.prototype.copy=function(ge,_e,ke,Fe){if(!Y.isBuffer(ge))throw new TypeError("argument should be a Buffer");if(ke||(ke=0),!Fe&&Fe!==0&&(Fe=this.length),_e>=ge.length&&(_e=ge.length),_e||(_e=0),Fe>0&&Fe<ke&&(Fe=ke),Fe===ke||ge.length===0||this.length===0)return 0;if(_e<0)throw new RangeError("targetStart out of bounds");if(ke<0||ke>=this.length)throw new RangeError("Index out of range");if(Fe<0)throw new RangeError("sourceEnd out of bounds");Fe>this.length&&(Fe=this.length),ge.length-_e<Fe-ke&&(Fe=ge.length-_e+ke);const qe=Fe-ke;return this===ge&&typeof U.prototype.copyWithin=="function"?this.copyWithin(_e,ke,Fe):U.prototype.set.call(ge,this.subarray(ke,Fe),_e),qe},Y.prototype.fill=function(ge,_e,ke,Fe){if(typeof ge=="string"){if(typeof _e=="string"?(Fe=_e,_e=0,ke=this.length):typeof ke=="string"&&(Fe=ke,ke=this.length),Fe!==void 0&&typeof Fe!="string")throw new TypeError("encoding must be a string");if(typeof Fe=="string"&&!Y.isEncoding(Fe))throw new TypeError("Unknown encoding: "+Fe);if(ge.length===1){const tt=ge.charCodeAt(0);(Fe==="utf8"&&tt<128||Fe==="latin1")&&(ge=tt)}}else typeof ge=="number"?ge=ge&255:typeof ge=="boolean"&&(ge=Number(ge));if(_e<0||this.length<_e||this.length<ke)throw new RangeError("Out of range index");if(ke<=_e)return this;_e=_e>>>0,ke=ke===void 0?this.length:ke>>>0,ge||(ge=0);let qe;if(typeof ge=="number")for(qe=_e;qe<ke;++qe)this[qe]=ge;else{const tt=Y.isBuffer(ge)?ge:Y.from(ge,Fe),It=tt.length;if(It===0)throw new TypeError('The value "'+ge+'" is invalid for argument "value"');for(qe=0;qe<ke-_e;++qe)this[qe+_e]=tt[qe%It]}return this};const zt={};function ii(Se,ge,_e){zt[Se]=class extends _e{constructor(){super(),Object.defineProperty(this,"message",{value:ge.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Se}]`,this.stack,delete this.name}get code(){return Se}set code(Fe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Fe,writable:!0})}toString(){return`${this.name} [${Se}]: ${this.message}`}}}ii("ERR_BUFFER_OUT_OF_BOUNDS",function(Se){return Se?`${Se} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ii("ERR_INVALID_ARG_TYPE",function(Se,ge){return`The "${Se}" argument must be of type number. Received type ${typeof ge}`},TypeError),ii("ERR_OUT_OF_RANGE",function(Se,ge,_e){let ke=`The value of "${Se}" is out of range.`,Fe=_e;return Number.isInteger(_e)&&Math.abs(_e)>2**32?Fe=Ci(String(_e)):typeof _e=="bigint"&&(Fe=String(_e),(_e>BigInt(2)**BigInt(32)||_e<-(BigInt(2)**BigInt(32)))&&(Fe=Ci(Fe)),Fe+="n"),ke+=` It must be ${ge}. Received ${Fe}`,ke},RangeError);function Ci(Se){let ge="",_e=Se.length;const ke=Se[0]==="-"?1:0;for(;_e>=ke+4;_e-=3)ge=`_${Se.slice(_e-3,_e)}${ge}`;return`${Se.slice(0,_e)}${ge}`}function ni(Se,ge,_e){hi(ge,"offset"),(Se[ge]===void 0||Se[ge+_e]===void 0)&&jt(ge,Se.length-(_e+1))}function vi(Se,ge,_e,ke,Fe,qe){if(Se>_e||Se<ge){const tt=typeof ge=="bigint"?"n":"";let It;throw ge===0||ge===BigInt(0)?It=`>= 0${tt} and < 2${tt} ** ${(qe+1)*8}${tt}`:It=`>= -(2${tt} ** ${(qe+1)*8-1}${tt}) and < 2 ** ${(qe+1)*8-1}${tt}`,new zt.ERR_OUT_OF_RANGE("value",It,Se)}ni(ke,Fe,qe)}function hi(Se,ge){if(typeof Se!="number")throw new zt.ERR_INVALID_ARG_TYPE(ge,"number",Se)}function jt(Se,ge,_e){throw Math.floor(Se)!==Se?(hi(Se,_e),new zt.ERR_OUT_OF_RANGE("offset","an integer",Se)):ge<0?new zt.ERR_BUFFER_OUT_OF_BOUNDS:new zt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${ge}`,Se)}const zi=/[^+/0-9A-Za-z-_]/g;function Ki(Se){if(Se=Se.split("=")[0],Se=Se.trim().replace(zi,""),Se.length<2)return"";for(;Se.length%4!==0;)Se=Se+"=";return Se}function pi(Se,ge){ge=ge||1/0;let _e;const ke=Se.length;let Fe=null;const qe=[];for(let tt=0;tt<ke;++tt){if(_e=Se.charCodeAt(tt),_e>55295&&_e<57344){if(!Fe){if(_e>56319){(ge-=3)>-1&&qe.push(239,191,189);continue}else if(tt+1===ke){(ge-=3)>-1&&qe.push(239,191,189);continue}Fe=_e;continue}if(_e<56320){(ge-=3)>-1&&qe.push(239,191,189),Fe=_e;continue}_e=(Fe-55296<<10|_e-56320)+65536}else Fe&&(ge-=3)>-1&&qe.push(239,191,189);if(Fe=null,_e<128){if((ge-=1)<0)break;qe.push(_e)}else if(_e<2048){if((ge-=2)<0)break;qe.push(_e>>6|192,_e&63|128)}else if(_e<65536){if((ge-=3)<0)break;qe.push(_e>>12|224,_e>>6&63|128,_e&63|128)}else if(_e<1114112){if((ge-=4)<0)break;qe.push(_e>>18|240,_e>>12&63|128,_e>>6&63|128,_e&63|128)}else throw new Error("Invalid code point")}return qe}function mi(Se){const ge=[];for(let _e=0;_e<Se.length;++_e)ge.push(Se.charCodeAt(_e)&255);return ge}function kt(Se,ge){let _e,ke,Fe;const qe=[];for(let tt=0;tt<Se.length&&!((ge-=2)<0);++tt)_e=Se.charCodeAt(tt),ke=_e>>8,Fe=_e%256,qe.push(Fe),qe.push(ke);return qe}function ki(Se){return w.toByteArray(Ki(Se))}function Ii(Se,ge,_e,ke){let Fe;for(Fe=0;Fe<ke&&!(Fe+_e>=ge.length||Fe>=Se.length);++Fe)ge[Fe+_e]=Se[Fe];return Fe}function Jt(Se,ge){return Se instanceof ge||Se!=null&&Se.constructor!=null&&Se.constructor.name!=null&&Se.constructor.name===ge.name}function _i(Se){return Se!==Se}const Lt=function(){const Se="0123456789abcdef",ge=new Array(256);for(let _e=0;_e<16;++_e){const ke=_e*16;for(let Fe=0;Fe<16;++Fe)ge[ke+Fe]=Se[_e]+Se[Fe]}return ge}();function St(Se){return typeof BigInt>"u"?si:Se}function si(){throw new Error("BigInt not supported")}})(buffer);const Buffer=buffer.Buffer,hasBuffer=typeof Buffer<"u";let textDecoder;class VSBuffer{static wrap(w){return hasBuffer&&!Buffer.isBuffer(w)&&(w=Buffer.from(w.buffer,w.byteOffset,w.byteLength)),new VSBuffer(w)}constructor(w){this.buffer=w,this.byteLength=this.buffer.byteLength}toString(){return hasBuffer?this.buffer.toString():(textDecoder||(textDecoder=new TextDecoder),textDecoder.decode(this.buffer))}}function readUInt16LE(F,w){return F[w+0]<<0>>>0|F[w+1]<<8>>>0}function writeUInt16LE(F,w,D){F[D+0]=w&255,w=w>>>8,F[D+1]=w&255}function readUInt32BE(F,w){return F[w]*2**24+F[w+1]*2**16+F[w+2]*2**8+F[w+3]}function writeUInt32BE(F,w,D){F[D+3]=w,w=w>>>8,F[D+2]=w,w=w>>>8,F[D+1]=w,w=w>>>8,F[D]=w}function readUInt8(F,w){return F[w]}function writeUInt8(F,w,D){F[D]=w}let _utf16LE_TextDecoder;function getUTF16LE_TextDecoder(){return _utf16LE_TextDecoder||(_utf16LE_TextDecoder=new TextDecoder("UTF-16LE")),_utf16LE_TextDecoder}let _utf16BE_TextDecoder;function getUTF16BE_TextDecoder(){return _utf16BE_TextDecoder||(_utf16BE_TextDecoder=new TextDecoder("UTF-16BE")),_utf16BE_TextDecoder}let _platformTextDecoder;function getPlatformTextDecoder(){return _platformTextDecoder||(_platformTextDecoder=isLittleEndian()?getUTF16LE_TextDecoder():getUTF16BE_TextDecoder()),_platformTextDecoder}function decodeUTF16LE(F,w,D){const O=new Uint16Array(F.buffer,w,D);return D>0&&(O[0]===65279||O[0]===65534)?compatDecodeUTF16LE(F,w,D):getUTF16LE_TextDecoder().decode(O)}function compatDecodeUTF16LE(F,w,D){const O=[];let W=0;for(let U=0;U<D;U++){const K=readUInt16LE(F,w);w+=2,O[W++]=String.fromCharCode(K)}return O.join("")}class StringBuilder{constructor(w){this._capacity=w|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const w=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return getPlatformTextDecoder().decode(w)}_flushBuffer(){const w=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[w]:this._completedStrings[this._completedStrings.length]=w}appendCharCode(w){const D=this._capacity-this._bufferLength;D<=1&&(D===0||isHighSurrogate(w))&&this._flushBuffer(),this._buffer[this._bufferLength++]=w}appendASCIICharCode(w){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=w}appendString(w){const D=w.length;if(this._bufferLength+D>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=w;return}for(let O=0;O<D;O++)this._buffer[this._bufferLength++]=w.charCodeAt(O)}}class RichEditBracket{constructor(w,D,O,W,U,K){this._richEditBracketBrand=void 0,this.languageId=w,this.index=D,this.open=O,this.close=W,this.forwardRegex=U,this.reversedRegex=K,this._openSet=RichEditBracket._toSet(this.open),this._closeSet=RichEditBracket._toSet(this.close)}isOpen(w){return this._openSet.has(w)}isClose(w){return this._closeSet.has(w)}static _toSet(w){const D=new Set;for(const O of w)D.add(O);return D}}function groupFuzzyBrackets(F){const w=F.length;F=F.map(K=>[K[0].toLowerCase(),K[1].toLowerCase()]);const D=[];for(let K=0;K<w;K++)D[K]=K;const O=(K,q)=>{const[G,Q]=K,[Y,X]=q;return G===Y||G===X||Q===Y||Q===X},W=(K,q)=>{const G=Math.min(K,q),Q=Math.max(K,q);for(let Y=0;Y<w;Y++)D[Y]===Q&&(D[Y]=G)};for(let K=0;K<w;K++){const q=F[K];for(let G=K+1;G<w;G++){const Q=F[G];O(q,Q)&&W(D[K],D[G])}}const U=[];for(let K=0;K<w;K++){const q=[],G=[];for(let Q=0;Q<w;Q++)if(D[Q]===K){const[Y,X]=F[Q];q.push(Y),G.push(X)}q.length>0&&U.push({open:q,close:G})}return U}class RichEditBrackets{constructor(w,D){this._richEditBracketsBrand=void 0;const O=groupFuzzyBrackets(D);this.brackets=O.map((W,U)=>new RichEditBracket(w,U,W.open,W.close,getRegexForBracketPair(W.open,W.close,O,U),getReversedRegexForBracketPair(W.open,W.close,O,U))),this.forwardRegex=getRegexForBrackets(this.brackets),this.reversedRegex=getReversedRegexForBrackets(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const W of this.brackets){for(const U of W.open)this.textIsBracket[U]=W,this.textIsOpenBracket[U]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,U.length);for(const U of W.close)this.textIsBracket[U]=W,this.textIsOpenBracket[U]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,U.length)}}}function collectSuperstrings(F,w,D,O){for(let W=0,U=w.length;W<U;W++){if(W===D)continue;const K=w[W];for(const q of K.open)q.indexOf(F)>=0&&O.push(q);for(const q of K.close)q.indexOf(F)>=0&&O.push(q)}}function lengthcmp(F,w){return F.length-w.length}function unique(F){if(F.length<=1)return F;const w=[],D=new Set;for(const O of F)D.has(O)||(w.push(O),D.add(O));return w}function getRegexForBracketPair(F,w,D,O){let W=[];W=W.concat(F),W=W.concat(w);for(let U=0,K=W.length;U<K;U++)collectSuperstrings(W[U],D,O,W);return W=unique(W),W.sort(lengthcmp),W.reverse(),createBracketOrRegExp(W)}function getReversedRegexForBracketPair(F,w,D,O){let W=[];W=W.concat(F),W=W.concat(w);for(let U=0,K=W.length;U<K;U++)collectSuperstrings(W[U],D,O,W);return W=unique(W),W.sort(lengthcmp),W.reverse(),createBracketOrRegExp(W.map(toReversedString))}function getRegexForBrackets(F){let w=[];for(const D of F){for(const O of D.open)w.push(O);for(const O of D.close)w.push(O)}return w=unique(w),createBracketOrRegExp(w)}function getReversedRegexForBrackets(F){let w=[];for(const D of F){for(const O of D.open)w.push(O);for(const O of D.close)w.push(O)}return w=unique(w),createBracketOrRegExp(w.map(toReversedString))}function prepareBracketForRegExp$1(F){const w=/^[\w ]+$/.test(F);return F=escapeRegExpCharacters(F),w?`\\b${F}\\b`:F}function createBracketOrRegExp(F,w){const D=`(${F.map(prepareBracketForRegExp$1).join(")|(")})`;return createRegExp(D,!0,w)}const toReversedString=function(){function F(O){const W=new Uint16Array(O.length);let U=0;for(let K=O.length-1;K>=0;K--)W[U++]=O.charCodeAt(K);return getPlatformTextDecoder().decode(W)}let w=null,D=null;return function(W){return w!==W&&(w=W,D=F(w)),D}}();class BracketsUtils{static _findPrevBracketInText(w,D,O,W){const U=O.match(w);if(!U)return null;const K=O.length-(U.index||0),q=U[0].length,G=W+K;return new Range$2(D,G-q+1,D,G+1)}static findPrevBracketInRange(w,D,O,W,U){const q=toReversedString(O).substring(O.length-U,O.length-W);return this._findPrevBracketInText(w,D,q,W)}static findNextBracketInText(w,D,O,W){const U=O.match(w);if(!U)return null;const K=U.index||0,q=U[0].length;if(q===0)return null;const G=W+K;return new Range$2(D,G+1,D,G+1+q)}static findNextBracketInRange(w,D,O,W,U){const K=O.substring(W,U);return this.findNextBracketInText(w,D,K,W)}}class BracketElectricCharacterSupport{constructor(w){this._richEditBrackets=w}getElectricCharacters(){const w=[];if(this._richEditBrackets)for(const D of this._richEditBrackets.brackets)for(const O of D.close){const W=O.charAt(O.length-1);w.push(W)}return distinct(w)}onElectricCharacter(w,D,O){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;const W=D.findTokenIndexAtOffset(O-1);if(ignoreBracketsInToken(D.getStandardTokenType(W)))return null;const U=this._richEditBrackets.reversedRegex,K=D.getLineContent().substring(0,O-1)+w,q=BracketsUtils.findPrevBracketInRange(U,1,K,0,K.length);if(!q)return null;const G=K.substring(q.startColumn-1,q.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[G])return null;const Y=D.getActualLineContentBefore(q.startColumn-1);return/^\s*$/.test(Y)?{matchOpenBracket:G}:null}}function resetGlobalRegex(F){return F.global&&(F.lastIndex=0),!0}class IndentRulesSupport{constructor(w){this._indentationRules=w}shouldIncrease(w){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&resetGlobalRegex(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(w))}shouldDecrease(w){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&resetGlobalRegex(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(w))}shouldIndentNextLine(w){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&resetGlobalRegex(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(w))}shouldIgnore(w){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&resetGlobalRegex(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(w))}getIndentMetadata(w){let D=0;return this.shouldIncrease(w)&&(D+=1),this.shouldDecrease(w)&&(D+=2),this.shouldIndentNextLine(w)&&(D+=4),this.shouldIgnore(w)&&(D+=8),D}}class OnEnterSupport{constructor(w){w=w||{},w.brackets=w.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],w.brackets.forEach(D=>{const O=OnEnterSupport._createOpenBracketRegExp(D[0]),W=OnEnterSupport._createCloseBracketRegExp(D[1]);O&&W&&this._brackets.push({open:D[0],openRegExp:O,close:D[1],closeRegExp:W})}),this._regExpRules=w.onEnterRules||[]}onEnter(w,D,O,W){if(w>=3)for(let U=0,K=this._regExpRules.length;U<K;U++){const q=this._regExpRules[U];if([{reg:q.beforeText,text:O},{reg:q.afterText,text:W},{reg:q.previousLineText,text:D}].every(Q=>Q.reg?(Q.reg.lastIndex=0,Q.reg.test(Q.text)):!0))return q.action}if(w>=2&&O.length>0&&W.length>0)for(let U=0,K=this._brackets.length;U<K;U++){const q=this._brackets[U];if(q.openRegExp.test(O)&&q.closeRegExp.test(W))return{indentAction:IndentAction$1.IndentOutdent}}if(w>=2&&O.length>0){for(let U=0,K=this._brackets.length;U<K;U++)if(this._brackets[U].openRegExp.test(O))return{indentAction:IndentAction$1.Indent}}return null}static _createOpenBracketRegExp(w){let D=escapeRegExpCharacters(w);return/\B/.test(D.charAt(0))||(D="\\b"+D),D+="\\s*$",OnEnterSupport._safeRegExp(D)}static _createCloseBracketRegExp(w){let D=escapeRegExpCharacters(w);return/\B/.test(D.charAt(D.length-1))||(D=D+"\\b"),D="^\\s*"+D,OnEnterSupport._safeRegExp(D)}static _safeRegExp(w){try{return new RegExp(w)}catch(D){return onUnexpectedError(D),null}}}const IConfigurationService=createDecorator("configurationService");function toValuesTree(F,w){const D=Object.create(null);for(const O in F)addToValueTree(D,O,F[O],w);return D}function addToValueTree(F,w,D,O){const W=w.split("."),U=W.pop();let K=F;for(let q=0;q<W.length;q++){const G=W[q];let Q=K[G];switch(typeof Q){case"undefined":Q=K[G]=Object.create(null);break;case"object":if(Q===null){O(`Ignoring ${w} as ${W.slice(0,q+1).join(".")} is null`);return}break;default:O(`Ignoring ${w} as ${W.slice(0,q+1).join(".")} is ${JSON.stringify(Q)}`);return}K=Q}if(typeof K=="object"&&K!==null)try{K[U]=D}catch{O(`Ignoring ${w} as ${W.join(".")} is ${JSON.stringify(K)}`)}else O(`Ignoring ${w} as ${W.join(".")} is ${JSON.stringify(K)}`)}function removeFromValueTree(F,w){const D=w.split(".");doRemoveFromValueTree(F,D)}function doRemoveFromValueTree(F,w){const D=w.shift();if(w.length===0){delete F[D];return}if(Object.keys(F).indexOf(D)!==-1){const O=F[D];typeof O=="object"&&!Array.isArray(O)&&(doRemoveFromValueTree(O,w),Object.keys(O).length===0&&delete F[D])}}function getConfigurationValue(F,w,D){function O(K,q){let G=K;for(const Q of q){if(typeof G!="object"||G===null)return;G=G[Q]}return G}const W=w.split("."),U=O(F,W);return typeof U>"u"?D:U}function getLanguageTagSettingPlainKey(F){return F.replace(/[\[\]]/g,"")}const ILanguageService=createDecorator("languageService");class SyncDescriptor{constructor(w,D=[],O=!1){this.ctor=w,this.staticArguments=D,this.supportsDelayedInstantiation=O}}const _registry=[];function registerSingleton(F,w,D){w instanceof SyncDescriptor||(w=new SyncDescriptor(w,[],!!D)),_registry.push([F,w])}function getSingletonServiceDescriptors(){return _registry}const Mimes=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),Extensions$6={JSONContribution:"base.contributions.json"};function normalizeId(F){return F.length>0&&F.charAt(F.length-1)==="#"?F.substring(0,F.length-1):F}class JSONContributionRegistry{constructor(){this._onDidChangeSchema=new Emitter$1,this.schemasById={}}registerSchema(w,D){this.schemasById[normalizeId(w)]=D,this._onDidChangeSchema.fire(w)}notifySchemaChanged(w){this._onDidChangeSchema.fire(w)}}const jsonContributionRegistry=new JSONContributionRegistry;Registry.add(Extensions$6.JSONContribution,jsonContributionRegistry);const Extensions$5={Configuration:"base.contributions.configuration"},resourceLanguageSettingsSchemaId="vscode://schemas/settings/resourceLanguage",contributionRegistry=Registry.as(Extensions$6.JSONContribution);class ConfigurationRegistry{constructor(){this.registeredConfigurationDefaults=[],this.overrideIdentifiers=new Set,this._onDidSchemaChange=new Emitter$1,this._onDidUpdateConfiguration=new Emitter$1,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:localize("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},contributionRegistry.registerSchema(resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(w,D=!0){this.registerConfigurations([w],D)}registerConfigurations(w,D=!0){const O=new Set;this.doRegisterConfigurations(w,D,O),contributionRegistry.registerSchema(resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:O})}registerDefaultConfigurations(w){const D=new Set;this.doRegisterDefaultConfigurations(w,D),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:D,defaultsOverrides:!0})}doRegisterDefaultConfigurations(w,D){this.registeredConfigurationDefaults.push(...w);const O=[];for(const{overrides:W,source:U}of w)for(const K in W){D.add(K);const q=this.configurationDefaultsOverrides.get(K)??this.configurationDefaultsOverrides.set(K,{configurationDefaultOverrides:[]}).get(K),G=W[K];if(q.configurationDefaultOverrides.push({value:G,source:U}),OVERRIDE_PROPERTY_REGEX.test(K)){const Q=this.mergeDefaultConfigurationsForOverrideIdentifier(K,G,U,q.configurationDefaultOverrideValue);if(!Q)continue;q.configurationDefaultOverrideValue=Q,this.updateDefaultOverrideProperty(K,Q,U),O.push(...overrideIdentifiersFromKey(K))}else{const Q=this.mergeDefaultConfigurationsForConfigurationProperty(K,G,U,q.configurationDefaultOverrideValue);if(!Q)continue;q.configurationDefaultOverrideValue=Q;const Y=this.configurationProperties[K];Y&&(this.updatePropertyDefaultValue(K,Y),this.updateSchema(K,Y))}}this.doRegisterOverrideIdentifiers(O)}updateDefaultOverrideProperty(w,D,O){const W={type:"object",default:D.value,description:localize("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",getLanguageTagSettingPlainKey(w)),$ref:resourceLanguageSettingsSchemaId,defaultDefaultValue:D.value,source:O,defaultValueSource:O};this.configurationProperties[w]=W,this.defaultLanguageConfigurationOverridesNode.properties[w]=W}mergeDefaultConfigurationsForOverrideIdentifier(w,D,O,W){const U=W?.value||{},K=W?.source??new Map;if(!(K instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const q of Object.keys(D)){const G=D[q];if(isObject$1(G)&&(isUndefined(U[q])||isObject$1(U[q]))){if(U[q]={...U[q]??{},...G},O)for(const Y in G)K.set(`${q}.${Y}`,O)}else U[q]=G,O?K.set(q,O):K.delete(q)}return{value:U,source:K}}mergeDefaultConfigurationsForConfigurationProperty(w,D,O,W){const U=this.configurationProperties[w],K=W?.value??U?.defaultDefaultValue;let q=O;if(isObject$1(D)&&(U!==void 0&&U.type==="object"||U===void 0&&(isUndefined(K)||isObject$1(K)))){if(q=W?.source??new Map,!(q instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const Q in D)O&&q.set(`${w}.${Q}`,O);D={...isObject$1(K)?K:{},...D}}return{value:D,source:q}}registerOverrideIdentifiers(w){this.doRegisterOverrideIdentifiers(w),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(w){for(const D of w)this.overrideIdentifiers.add(D);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(w,D,O){w.forEach(W=>{this.validateAndRegisterProperties(W,D,W.extensionInfo,W.restrictedProperties,void 0,O),this.configurationContributors.push(W),this.registerJSONConfiguration(W)})}validateAndRegisterProperties(w,D=!0,O,W,U=3,K){U=isUndefinedOrNull(w.scope)?U:w.scope;const q=w.properties;if(q)for(const Q in q){const Y=q[Q];if(D&&validateProperty(Q,Y)){delete q[Q];continue}if(Y.source=O,Y.defaultDefaultValue=q[Q].default,this.updatePropertyDefaultValue(Q,Y),OVERRIDE_PROPERTY_REGEX.test(Q)?Y.scope=void 0:(Y.scope=isUndefinedOrNull(Y.scope)?U:Y.scope,Y.restricted=isUndefinedOrNull(Y.restricted)?!!W?.includes(Q):Y.restricted),q[Q].hasOwnProperty("included")&&!q[Q].included){this.excludedConfigurationProperties[Q]=q[Q],delete q[Q];continue}else this.configurationProperties[Q]=q[Q],q[Q].policy?.name&&this.policyConfigurations.set(q[Q].policy.name,Q);!q[Q].deprecationMessage&&q[Q].markdownDeprecationMessage&&(q[Q].deprecationMessage=q[Q].markdownDeprecationMessage),K.add(Q)}const G=w.allOf;if(G)for(const Q of G)this.validateAndRegisterProperties(Q,D,O,W,U,K)}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}registerJSONConfiguration(w){const D=O=>{const W=O.properties;if(W)for(const K in W)this.updateSchema(K,W[K]);O.allOf?.forEach(D)};D(w)}updateSchema(w,D){switch(D.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[w]=D;break}}updateOverridePropertyPatternKey(){for(const w of this.overrideIdentifiers.values()){const D=`[${w}]`,O={type:"object",description:localize("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:localize("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:resourceLanguageSettingsSchemaId};this.updatePropertyDefaultValue(D,O)}}registerOverridePropertyPatternKey(){localize("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),localize("overrideSettings.errorMessage","This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(w,D){const O=this.configurationDefaultsOverrides.get(w)?.configurationDefaultOverrideValue;let W,U;O&&(!D.disallowConfigurationDefault||!O.source)&&(W=O.value,U=O.source),isUndefined(W)&&(W=D.defaultDefaultValue,U=void 0),isUndefined(W)&&(W=getDefaultValue(D.type)),D.default=W,D.defaultValueSource=U}}const OVERRIDE_IDENTIFIER_PATTERN="\\[([^\\]]+)\\]",OVERRIDE_IDENTIFIER_REGEX=new RegExp(OVERRIDE_IDENTIFIER_PATTERN,"g"),OVERRIDE_PROPERTY_PATTERN=`^(${OVERRIDE_IDENTIFIER_PATTERN})+$`,OVERRIDE_PROPERTY_REGEX=new RegExp(OVERRIDE_PROPERTY_PATTERN);function overrideIdentifiersFromKey(F){const w=[];if(OVERRIDE_PROPERTY_REGEX.test(F)){let D=OVERRIDE_IDENTIFIER_REGEX.exec(F);for(;D?.length;){const O=D[1].trim();O&&w.push(O),D=OVERRIDE_IDENTIFIER_REGEX.exec(F)}}return distinct(w)}function getDefaultValue(F){switch(Array.isArray(F)?F[0]:F){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const configurationRegistry$2=new ConfigurationRegistry;Registry.add(Extensions$5.Configuration,configurationRegistry$2);function validateProperty(F,w){return F.trim()?OVERRIDE_PROPERTY_REGEX.test(F)?localize("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",F):configurationRegistry$2.getConfigurationProperties()[F]!==void 0?localize("config.property.duplicate","Cannot register '{0}'. This property is already registered.",F):w.policy?.name&&configurationRegistry$2.getPolicyConfigurations().get(w.policy?.name)!==void 0?localize("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",F,w.policy?.name,configurationRegistry$2.getPolicyConfigurations().get(w.policy?.name)):null:localize("config.property.empty","Cannot register an empty property")}const Extensions$4={ModesRegistry:"editor.modesRegistry"};class EditorModesRegistry{constructor(){this._onDidChangeLanguages=new Emitter$1,this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(w){return this._languages.push(w),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let D=0,O=this._languages.length;D<O;D++)if(this._languages[D]===w){this._languages.splice(D,1);return}}}}getLanguages(){return this._languages}}const ModesRegistry=new EditorModesRegistry;Registry.add(Extensions$4.ModesRegistry,ModesRegistry);const PLAINTEXT_LANGUAGE_ID="plaintext",PLAINTEXT_EXTENSION=".txt";ModesRegistry.registerLanguage({id:PLAINTEXT_LANGUAGE_ID,extensions:[PLAINTEXT_EXTENSION],aliases:[localize("plainText.alias","Plain Text"),"text"],mimetypes:[Mimes.text]});Registry.as(Extensions$5.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);class LanguageBracketsConfiguration{constructor(w,D){this.languageId=w;const O=D.brackets?filterValidBrackets(D.brackets):[],W=new CachedFunction(q=>{const G=new Set;return{info:new OpeningBracketKind(this,q,G),closing:G}}),U=new CachedFunction(q=>{const G=new Set,Q=new Set;return{info:new ClosingBracketKind(this,q,G,Q),opening:G,openingColorized:Q}});for(const[q,G]of O){const Q=W.get(q),Y=U.get(G);Q.closing.add(Y.info),Y.opening.add(Q.info)}const K=D.colorizedBracketPairs?filterValidBrackets(D.colorizedBracketPairs):O.filter(q=>!(q[0]==="<"&&q[1]===">"));for(const[q,G]of K){const Q=W.get(q),Y=U.get(G);Q.closing.add(Y.info),Y.openingColorized.add(Q.info),Y.opening.add(Q.info)}this._openingBrackets=new Map([...W.cachedValues].map(([q,G])=>[q,G.info])),this._closingBrackets=new Map([...U.cachedValues].map(([q,G])=>[q,G.info]))}get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(w){return this._openingBrackets.get(w)}getClosingBracketInfo(w){return this._closingBrackets.get(w)}getBracketInfo(w){return this.getOpeningBracketInfo(w)||this.getClosingBracketInfo(w)}getBracketRegExp(w){const D=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return createBracketOrRegExp(D,w)}}function filterValidBrackets(F){return F.filter(([w,D])=>w!==""&&D!=="")}class BracketKindBase{constructor(w,D){this.config=w,this.bracketText=D}get languageId(){return this.config.languageId}}class OpeningBracketKind extends BracketKindBase{constructor(w,D,O){super(w,D),this.openedBrackets=O,this.isOpeningBracket=!0}}class ClosingBracketKind extends BracketKindBase{constructor(w,D,O,W){super(w,D),this.openingBrackets=O,this.openingColorizedBrackets=W,this.isOpeningBracket=!1}closes(w){return w.config!==this.config?!1:this.openingBrackets.has(w)}closesColorized(w){return w.config!==this.config?!1:this.openingColorizedBrackets.has(w)}getOpeningBrackets(){return[...this.openingBrackets]}}var __decorate$1b=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$15=function(F,w){return function(D,O){w(D,O,F)}};class LanguageConfigurationServiceChangeEvent{constructor(w){this.languageId=w}affects(w){return this.languageId?this.languageId===w:!0}}const ILanguageConfigurationService=createDecorator("languageConfigurationService");let LanguageConfigurationService=class extends Disposable{constructor(w,D){super(),this.configurationService=w,this.languageService=D,this._registry=this._register(new LanguageConfigurationRegistry),this.onDidChangeEmitter=this._register(new Emitter$1),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const O=new Set(Object.values(customizedLanguageConfigKeys));this._register(this.configurationService.onDidChangeConfiguration(W=>{const U=W.change.keys.some(q=>O.has(q)),K=W.change.overrides.filter(([q,G])=>G.some(Q=>O.has(Q))).map(([q])=>q);if(U)this.configurations.clear(),this.onDidChangeEmitter.fire(new LanguageConfigurationServiceChangeEvent(void 0));else for(const q of K)this.languageService.isRegisteredLanguageId(q)&&(this.configurations.delete(q),this.onDidChangeEmitter.fire(new LanguageConfigurationServiceChangeEvent(q)))})),this._register(this._registry.onDidChange(W=>{this.configurations.delete(W.languageId),this.onDidChangeEmitter.fire(new LanguageConfigurationServiceChangeEvent(W.languageId))}))}register(w,D,O){return this._registry.register(w,D,O)}getLanguageConfiguration(w){let D=this.configurations.get(w);return D||(D=computeConfig(w,this._registry,this.configurationService,this.languageService),this.configurations.set(w,D)),D}};LanguageConfigurationService=__decorate$1b([__param$15(0,IConfigurationService),__param$15(1,ILanguageService)],LanguageConfigurationService);function computeConfig(F,w,D,O){let W=w.getLanguageConfiguration(F);if(!W){if(!O.isRegisteredLanguageId(F))return new ResolvedLanguageConfiguration(F,{});W=new ResolvedLanguageConfiguration(F,{})}const U=getCustomizedLanguageConfig(W.languageId,D),K=combineLanguageConfigurations([W.underlyingConfig,U]);return new ResolvedLanguageConfiguration(W.languageId,K)}const customizedLanguageConfigKeys={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function getCustomizedLanguageConfig(F,w){const D=w.getValue(customizedLanguageConfigKeys.brackets,{overrideIdentifier:F}),O=w.getValue(customizedLanguageConfigKeys.colorizedBracketPairs,{overrideIdentifier:F});return{brackets:validateBracketPairs(D),colorizedBracketPairs:validateBracketPairs(O)}}function validateBracketPairs(F){if(Array.isArray(F))return F.map(w=>{if(!(!Array.isArray(w)||w.length!==2))return[w[0],w[1]]}).filter(w=>!!w)}function getIndentationAtPosition(F,w,D){const O=F.getLineContent(w);let W=getLeadingWhitespace(O);return W.length>D-1&&(W=W.substring(0,D-1)),W}class ComposedLanguageConfiguration{constructor(w){this.languageId=w,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(w,D){const O=new LanguageConfigurationContribution(w,D,++this._order);return this._entries.push(O),this._resolved=null,toDisposable(()=>{for(let W=0;W<this._entries.length;W++)if(this._entries[W]===O){this._entries.splice(W,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){const w=this._resolve();w&&(this._resolved=new ResolvedLanguageConfiguration(this.languageId,w))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(LanguageConfigurationContribution.cmp),combineLanguageConfigurations(this._entries.map(w=>w.configuration)))}}function combineLanguageConfigurations(F){let w={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const D of F)w={comments:D.comments||w.comments,brackets:D.brackets||w.brackets,wordPattern:D.wordPattern||w.wordPattern,indentationRules:D.indentationRules||w.indentationRules,onEnterRules:D.onEnterRules||w.onEnterRules,autoClosingPairs:D.autoClosingPairs||w.autoClosingPairs,surroundingPairs:D.surroundingPairs||w.surroundingPairs,autoCloseBefore:D.autoCloseBefore||w.autoCloseBefore,folding:D.folding||w.folding,colorizedBracketPairs:D.colorizedBracketPairs||w.colorizedBracketPairs,__electricCharacterSupport:D.__electricCharacterSupport||w.__electricCharacterSupport};return w}class LanguageConfigurationContribution{constructor(w,D,O){this.configuration=w,this.priority=D,this.order=O}static cmp(w,D){return w.priority===D.priority?w.order-D.order:w.priority-D.priority}}class LanguageConfigurationChangeEvent{constructor(w){this.languageId=w}}class LanguageConfigurationRegistry extends Disposable{constructor(){super(),this._entries=new Map,this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._register(this.register(PLAINTEXT_LANGUAGE_ID,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(w,D,O=0){let W=this._entries.get(w);W||(W=new ComposedLanguageConfiguration(w),this._entries.set(w,W));const U=W.register(D,O);return this._onDidChange.fire(new LanguageConfigurationChangeEvent(w)),toDisposable(()=>{U.dispose(),this._onDidChange.fire(new LanguageConfigurationChangeEvent(w))})}getLanguageConfiguration(w){return this._entries.get(w)?.getResolvedConfiguration()||null}}class ResolvedLanguageConfiguration{constructor(w,D){this.languageId=w,this.underlyingConfig=D,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new OnEnterSupport(this.underlyingConfig):null,this.comments=ResolvedLanguageConfiguration._handleComments(this.underlyingConfig),this.characterPair=new CharacterPairSupport(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||DEFAULT_WORD_REGEXP,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new IndentRulesSupport(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new LanguageBracketsConfiguration(w,this.underlyingConfig)}getWordDefinition(){return ensureValidWordDefinition(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new RichEditBrackets(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new BracketElectricCharacterSupport(this.brackets)),this._electricCharacter}onEnter(w,D,O,W){return this._onEnterSupport?this._onEnterSupport.onEnter(w,D,O,W):null}getAutoClosingPairs(){return new AutoClosingPairs(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(w){return this.characterPair.getAutoCloseBeforeSet(w)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(w){const D=w.comments;if(!D)return null;const O={};if(D.lineComment&&(O.lineCommentToken=D.lineComment),D.blockComment){const[W,U]=D.blockComment;O.blockCommentStartToken=W,O.blockCommentEndToken=U}return O}}registerSingleton(ILanguageConfigurationService,LanguageConfigurationService,1);const ILanguageFeaturesService=createDecorator("ILanguageFeaturesService");var _a,_b;class ResourceMapEntry{constructor(w,D){this.uri=w,this.value=D}}function isEntries(F){return Array.isArray(F)}class ResourceMap{static{this.defaultToKey=w=>w.toString()}constructor(w,D){if(this[_a]="ResourceMap",w instanceof ResourceMap)this.map=new Map(w.map),this.toKey=D??ResourceMap.defaultToKey;else if(isEntries(w)){this.map=new Map,this.toKey=D??ResourceMap.defaultToKey;for(const[O,W]of w)this.set(O,W)}else this.map=new Map,this.toKey=w??ResourceMap.defaultToKey}set(w,D){return this.map.set(this.toKey(w),new ResourceMapEntry(w,D)),this}get(w){return this.map.get(this.toKey(w))?.value}has(w){return this.map.has(this.toKey(w))}get size(){return this.map.size}clear(){this.map.clear()}delete(w){return this.map.delete(this.toKey(w))}forEach(w,D){typeof D<"u"&&(w=w.bind(D));for(const[O,W]of this.map)w(W.value,W.uri,this)}*values(){for(const w of this.map.values())yield w.value}*keys(){for(const w of this.map.values())yield w.uri}*entries(){for(const w of this.map.values())yield[w.uri,w.value]}*[(_a=Symbol.toStringTag,Symbol.iterator)](){for(const[,w]of this.map)yield[w.uri,w.value]}}class LinkedMap{constructor(){this[_b]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(w){return this._map.has(w)}get(w,D=0){const O=this._map.get(w);if(O)return D!==0&&this.touch(O,D),O.value}set(w,D,O=0){let W=this._map.get(w);if(W)W.value=D,O!==0&&this.touch(W,O);else{switch(W={key:w,value:D,next:void 0,previous:void 0},O){case 0:this.addItemLast(W);break;case 1:this.addItemFirst(W);break;case 2:this.addItemLast(W);break;default:this.addItemLast(W);break}this._map.set(w,W),this._size++}return this}delete(w){return!!this.remove(w)}remove(w){const D=this._map.get(w);if(D)return this._map.delete(w),this.removeItem(D),this._size--,D.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const w=this._head;return this._map.delete(w.key),this.removeItem(w),this._size--,w.value}forEach(w,D){const O=this._state;let W=this._head;for(;W;){if(D?w.bind(D)(W.value,W.key,this):w(W.value,W.key,this),this._state!==O)throw new Error("LinkedMap got modified during iteration.");W=W.next}}keys(){const w=this,D=this._state;let O=this._head;const W={[Symbol.iterator](){return W},next(){if(w._state!==D)throw new Error("LinkedMap got modified during iteration.");if(O){const U={value:O.key,done:!1};return O=O.next,U}else return{value:void 0,done:!0}}};return W}values(){const w=this,D=this._state;let O=this._head;const W={[Symbol.iterator](){return W},next(){if(w._state!==D)throw new Error("LinkedMap got modified during iteration.");if(O){const U={value:O.value,done:!1};return O=O.next,U}else return{value:void 0,done:!0}}};return W}entries(){const w=this,D=this._state;let O=this._head;const W={[Symbol.iterator](){return W},next(){if(w._state!==D)throw new Error("LinkedMap got modified during iteration.");if(O){const U={value:[O.key,O.value],done:!1};return O=O.next,U}else return{value:void 0,done:!0}}};return W}[(_b=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(w){if(w>=this.size)return;if(w===0){this.clear();return}let D=this._head,O=this.size;for(;D&&O>w;)this._map.delete(D.key),D=D.next,O--;this._head=D,this._size=O,D&&(D.previous=void 0),this._state++}trimNew(w){if(w>=this.size)return;if(w===0){this.clear();return}let D=this._tail,O=this.size;for(;D&&O>w;)this._map.delete(D.key),D=D.previous,O--;this._tail=D,this._size=O,D&&(D.next=void 0),this._state++}addItemFirst(w){if(!this._head&&!this._tail)this._tail=w;else if(this._head)w.next=this._head,this._head.previous=w;else throw new Error("Invalid list");this._head=w,this._state++}addItemLast(w){if(!this._head&&!this._tail)this._head=w;else if(this._tail)w.previous=this._tail,this._tail.next=w;else throw new Error("Invalid list");this._tail=w,this._state++}removeItem(w){if(w===this._head&&w===this._tail)this._head=void 0,this._tail=void 0;else if(w===this._head){if(!w.next)throw new Error("Invalid list");w.next.previous=void 0,this._head=w.next}else if(w===this._tail){if(!w.previous)throw new Error("Invalid list");w.previous.next=void 0,this._tail=w.previous}else{const D=w.next,O=w.previous;if(!D||!O)throw new Error("Invalid list");D.previous=O,O.next=D}w.next=void 0,w.previous=void 0,this._state++}touch(w,D){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(D!==1&&D!==2)){if(D===1){if(w===this._head)return;const O=w.next,W=w.previous;w===this._tail?(W.next=void 0,this._tail=W):(O.previous=W,W.next=O),w.previous=void 0,w.next=this._head,this._head.previous=w,this._head=w,this._state++}else if(D===2){if(w===this._tail)return;const O=w.next,W=w.previous;w===this._head?(O.previous=void 0,this._head=O):(O.previous=W,W.next=O),w.next=void 0,w.previous=this._tail,this._tail.next=w,this._tail=w,this._state++}}}toJSON(){const w=[];return this.forEach((D,O)=>{w.push([O,D])}),w}fromJSON(w){this.clear();for(const[D,O]of w)this.set(D,O)}}class Cache extends LinkedMap{constructor(w,D=1){super(),this._limit=w,this._ratio=Math.min(Math.max(0,D),1)}get limit(){return this._limit}set limit(w){this._limit=w,this.checkTrim()}get(w,D=2){return super.get(w,D)}peek(w){return super.get(w,0)}set(w,D){return super.set(w,D,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}}class LRUCache extends Cache{constructor(w,D=1){super(w,D)}trim(w){this.trimOld(w)}set(w,D){return super.set(w,D),this.checkTrim(),this}}class BidirectionalMap{constructor(w){if(this._m1=new Map,this._m2=new Map,w)for(const[D,O]of w)this.set(D,O)}clear(){this._m1.clear(),this._m2.clear()}set(w,D){this._m1.set(w,D),this._m2.set(D,w)}get(w){return this._m1.get(w)}getKey(w){return this._m2.get(w)}delete(w){const D=this._m1.get(w);return D===void 0?!1:(this._m1.delete(w),this._m2.delete(D),!0)}keys(){return this._m1.keys()}values(){return this._m1.values()}}class SetMap{constructor(){this.map=new Map}add(w,D){let O=this.map.get(w);O||(O=new Set,this.map.set(w,O)),O.add(D)}delete(w,D){const O=this.map.get(w);O&&(O.delete(D),O.size===0&&this.map.delete(w))}forEach(w,D){const O=this.map.get(w);O&&O.forEach(D)}get(w){const D=this.map.get(w);return D||new Set}}function or(...F){return function(w,D){for(let O=0,W=F.length;O<W;O++){const U=F[O](w,D);if(U)return U}return null}}_matchesPrefix.bind(void 0,!1);const matchesPrefix=_matchesPrefix.bind(void 0,!0);function _matchesPrefix(F,w,D){if(!D||D.length<w.length)return null;let O;return F?O=startsWithIgnoreCase(D,w):O=D.indexOf(w)===0,O?w.length>0?[{start:0,end:w.length}]:[]:null}function matchesContiguousSubString(F,w){const D=w.toLowerCase().indexOf(F.toLowerCase());return D===-1?null:[{start:D,end:D+F.length}]}function matchesSubString(F,w){return _matchesSubString(F.toLowerCase(),w.toLowerCase(),0,0)}function _matchesSubString(F,w,D,O){if(D===F.length)return[];if(O===w.length)return null;if(F[D]===w[O]){let W=null;return(W=_matchesSubString(F,w,D+1,O+1))?join({start:O,end:O+1},W):null}return _matchesSubString(F,w,D,O+1)}function isLower(F){return 97<=F&&F<=122}function isUpper(F){return 65<=F&&F<=90}function isNumber(F){return 48<=F&&F<=57}function isWhitespace$1(F){return F===32||F===9||F===10||F===13}const wordSeparators=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(F=>wordSeparators.add(F.charCodeAt(0)));function isAlphanumeric(F){return isLower(F)||isUpper(F)||isNumber(F)}function join(F,w){return w.length===0?w=[F]:F.end===w[0].start?w[0].start=F.start:w.unshift(F),w}function nextAnchor(F,w){for(let D=w;D<F.length;D++){const O=F.charCodeAt(D);if(isUpper(O)||isNumber(O)||D>0&&!isAlphanumeric(F.charCodeAt(D-1)))return D}return F.length}function _matchesCamelCase(F,w,D,O){if(D===F.length)return[];if(O===w.length)return null;if(F[D]!==w[O].toLowerCase())return null;{let W=null,U=O+1;for(W=_matchesCamelCase(F,w,D+1,O+1);!W&&(U=nextAnchor(w,U))<w.length;)W=_matchesCamelCase(F,w,D+1,U),U++;return W===null?null:join({start:O,end:O+1},W)}}function analyzeCamelCaseWord(F){let w=0,D=0,O=0,W=0,U=0;for(let Y=0;Y<F.length;Y++)U=F.charCodeAt(Y),isUpper(U)&&w++,isLower(U)&&D++,isAlphanumeric(U)&&O++,isNumber(U)&&W++;const K=w/F.length,q=D/F.length,G=O/F.length,Q=W/F.length;return{upperPercent:K,lowerPercent:q,alphaPercent:G,numericPercent:Q}}function isUpperCaseWord(F){const{upperPercent:w,lowerPercent:D}=F;return D===0&&w>.6}function isCamelCaseWord(F){const{upperPercent:w,lowerPercent:D,alphaPercent:O,numericPercent:W}=F;return D>.2&&w<.8&&O>.6&&W<.2}function isCamelCasePattern(F){let w=0,D=0,O=0,W=0;for(let U=0;U<F.length;U++)O=F.charCodeAt(U),isUpper(O)&&w++,isLower(O)&&D++,isWhitespace$1(O)&&W++;return(w===0||D===0)&&W===0?F.length<=30:w<=5}function matchesCamelCase(F,w){if(!w||(w=w.trim(),w.length===0)||!isCamelCasePattern(F))return null;w.length>60&&(w=w.substring(0,60));const D=analyzeCamelCaseWord(w);if(!isCamelCaseWord(D)){if(!isUpperCaseWord(D))return null;w=w.toLowerCase()}let O=null,W=0;for(F=F.toLowerCase();W<w.length&&(O=_matchesCamelCase(F,w,0,W))===null;)W=nextAnchor(w,W+1);return O}const fuzzyContiguousFilter=or(matchesPrefix,matchesCamelCase,matchesContiguousSubString),fuzzySeparateFilter=or(matchesPrefix,matchesCamelCase,matchesSubString),fuzzyRegExpCache=new LRUCache(1e4);function matchesFuzzy(F,w,D=!1){if(typeof F!="string"||typeof w!="string")return null;let O=fuzzyRegExpCache.get(F);O||(O=new RegExp(convertSimple2RegExpPattern(F),"i"),fuzzyRegExpCache.set(F,O));const W=O.exec(w);return W?[{start:W.index,end:W.index+W[0].length}]:D?fuzzySeparateFilter(F,w):fuzzyContiguousFilter(F,w)}function matchesFuzzy2(F,w){const D=fuzzyScore(F,F.toLowerCase(),0,w,w.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return D?createMatches(D):null}function anyScore(F,w,D,O,W,U){const K=Math.min(13,F.length);for(;D<K;D++){const q=fuzzyScore(F,w,D,O,W,U,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(q)return q}return[0,U]}function createMatches(F){if(typeof F>"u")return[];const w=[],D=F[1];for(let O=F.length-1;O>1;O--){const W=F[O]+D,U=w[w.length-1];U&&U.end===W?U.end=W+1:w.push({start:W,end:W+1})}return w}const _maxLen=128;function initTable(){const F=[],w=[];for(let D=0;D<=_maxLen;D++)w[D]=0;for(let D=0;D<=_maxLen;D++)F.push(w.slice(0));return F}function initArr(F){const w=[];for(let D=0;D<=F;D++)w[D]=0;return w}const _minWordMatchPos=initArr(2*_maxLen),_maxWordMatchPos=initArr(2*_maxLen),_diag=initTable(),_table=initTable(),_arrows=initTable();function isSeparatorAtPos(F,w){if(w<0||w>=F.length)return!1;const D=F.codePointAt(w);switch(D){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!isEmojiImprecise(D)}}function isWhitespaceAtPos(F,w){if(w<0||w>=F.length)return!1;switch(F.charCodeAt(w)){case 32:case 9:return!0;default:return!1}}function isUpperCaseAtPos(F,w,D){return w[F]!==D[F]}function isPatternInWord(F,w,D,O,W,U,K=!1){for(;w<D&&W<U;)F[w]===O[W]&&(K&&(_minWordMatchPos[w]=W),w+=1),W+=1;return w===D}var FuzzyScore;(function(F){F.Default=[-100,0];function w(D){return!D||D.length===2&&D[0]===-100&&D[1]===0}F.isDefault=w})(FuzzyScore||(FuzzyScore={}));class FuzzyScoreOptions{static{this.default={boostFullMatch:!0,firstMatchCanBeWeak:!1}}constructor(w,D){this.firstMatchCanBeWeak=w,this.boostFullMatch=D}}function fuzzyScore(F,w,D,O,W,U,K=FuzzyScoreOptions.default){const q=F.length>_maxLen?_maxLen:F.length,G=O.length>_maxLen?_maxLen:O.length;if(D>=q||U>=G||q-D>G-U||!isPatternInWord(w,D,q,W,U,G,!0))return;_fillInMaxWordMatchPos(q,G,D,U,w,W);let Q=1,Y=1,X=D,J=U;const te=[!1];for(Q=1,X=D;X<q;Q++,X++){const le=_minWordMatchPos[X],de=_maxWordMatchPos[X],oe=X+1<q?_maxWordMatchPos[X+1]:G;for(Y=le-U+1,J=le;J<oe;Y++,J++){let ue=Number.MIN_SAFE_INTEGER,pe=!1;J<=de&&(ue=_doScore(F,w,X,D,O,W,J,G,U,_diag[Q-1][Y-1]===0,te));let fe=0;ue!==Number.MAX_SAFE_INTEGER&&(pe=!0,fe=ue+_table[Q-1][Y-1]);const Ce=J>le,we=Ce?_table[Q][Y-1]+(_diag[Q][Y-1]>0?-5:0):0,Oe=J>le+1&&_diag[Q][Y-1]>0,Te=Oe?_table[Q][Y-2]+(_diag[Q][Y-2]>0?-5:0):0;if(Oe&&(!Ce||Te>=we)&&(!pe||Te>=fe))_table[Q][Y]=Te,_arrows[Q][Y]=3,_diag[Q][Y]=0;else if(Ce&&(!pe||we>=fe))_table[Q][Y]=we,_arrows[Q][Y]=2,_diag[Q][Y]=0;else if(pe)_table[Q][Y]=fe,_arrows[Q][Y]=1,_diag[Q][Y]=_diag[Q-1][Y-1]+1;else throw new Error("not possible")}}if(!te[0]&&!K.firstMatchCanBeWeak)return;Q--,Y--;const ie=[_table[Q][Y],U];let se=0,re=0;for(;Q>=1;){let le=Y;do{const de=_arrows[Q][le];if(de===3)le=le-2;else if(de===2)le=le-1;else break}while(le>=1);se>1&&w[D+Q-1]===W[U+Y-1]&&!isUpperCaseAtPos(le+U-1,O,W)&&se+1>_diag[Q][le]&&(le=Y),le===Y?se++:se=1,re||(re=le),Q--,Y=le-1,ie.push(Y)}G-U===q&&K.boostFullMatch&&(ie[0]+=2);const ae=re-q;return ie[0]-=ae,ie}function _fillInMaxWordMatchPos(F,w,D,O,W,U){let K=F-1,q=w-1;for(;K>=D&&q>=O;)W[K]===U[q]&&(_maxWordMatchPos[K]=q,K--),q--}function _doScore(F,w,D,O,W,U,K,q,G,Q,Y){if(w[D]!==U[K])return Number.MIN_SAFE_INTEGER;let X=1,J=!1;return K===D-O?X=F[D]===W[K]?7:5:isUpperCaseAtPos(K,W,U)&&(K===0||!isUpperCaseAtPos(K-1,W,U))?(X=F[D]===W[K]?7:5,J=!0):isSeparatorAtPos(U,K)&&(K===0||!isSeparatorAtPos(U,K-1))?X=5:(isSeparatorAtPos(U,K-1)||isWhitespaceAtPos(U,K-1))&&(X=5,J=!0),X>1&&D===O&&(Y[0]=!0),J||(J=isUpperCaseAtPos(K,W,U)||isSeparatorAtPos(U,K-1)||isWhitespaceAtPos(U,K-1)),D===O?K>G&&(X-=J?3:5):Q?X+=J?2:0:X+=J?0:1,K+1===q&&(X-=J?3:5),X}function fuzzyScoreGracefulAggressive(F,w,D,O,W,U,K){return fuzzyScoreWithPermutations(F,w,D,O,W,U,!0,K)}function fuzzyScoreWithPermutations(F,w,D,O,W,U,K,q){let G=fuzzyScore(F,w,D,O,W,U,q);if(F.length>=3){const Q=Math.min(7,F.length-1);for(let Y=D+1;Y<Q;Y++){const X=nextTypoPermutation(F,Y);if(X){const J=fuzzyScore(X,X.toLowerCase(),D,O,W,U,q);J&&(J[0]-=3,(!G||J[0]>G[0])&&(G=J))}}}return G}function nextTypoPermutation(F,w){if(w+1>=F.length)return;const D=F[w],O=F[w+1];if(D!==O)return F.slice(0,w)+O+D+F.slice(w+2)}class Scanner{constructor(){this.value="",this.pos=0}static{this._table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13}}static isDigitCharacter(w){return w>=48&&w<=57}static isVariableCharacter(w){return w===95||w>=97&&w<=122||w>=65&&w<=90}text(w){this.value=w,this.pos=0}tokenText(w){return this.value.substr(w.pos,w.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};const w=this.pos;let D=0,O=this.value.charCodeAt(w),W;if(W=Scanner._table[O],typeof W=="number")return this.pos+=1,{type:W,pos:w,len:1};if(Scanner.isDigitCharacter(O)){W=8;do D+=1,O=this.value.charCodeAt(w+D);while(Scanner.isDigitCharacter(O));return this.pos+=D,{type:W,pos:w,len:D}}if(Scanner.isVariableCharacter(O)){W=9;do O=this.value.charCodeAt(w+ ++D);while(Scanner.isVariableCharacter(O)||Scanner.isDigitCharacter(O));return this.pos+=D,{type:W,pos:w,len:D}}W=10;do D+=1,O=this.value.charCodeAt(w+D);while(!isNaN(O)&&typeof Scanner._table[O]>"u"&&!Scanner.isDigitCharacter(O)&&!Scanner.isVariableCharacter(O));return this.pos+=D,{type:W,pos:w,len:D}}}class Marker{constructor(){this._children=[]}appendChild(w){return w instanceof Text&&this._children[this._children.length-1]instanceof Text?this._children[this._children.length-1].value+=w.value:(w.parent=this,this._children.push(w)),this}replace(w,D){const{parent:O}=w,W=O.children.indexOf(w),U=O.children.slice(0);U.splice(W,1,...D),O._children=U,function K(q,G){for(const Q of q)Q.parent=G,K(Q.children,Q)}(D,O)}get children(){return this._children}get rightMostDescendant(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}get snippet(){let w=this;for(;;){if(!w)return;if(w instanceof TextmateSnippet)return w;w=w.parent}}toString(){return this.children.reduce((w,D)=>w+D.toString(),"")}len(){return 0}}class Text extends Marker{constructor(w){super(),this.value=w}toString(){return this.value}len(){return this.value.length}clone(){return new Text(this.value)}}class TransformableMarker extends Marker{}class Placeholder extends TransformableMarker{static compareByIndex(w,D){return w.index===D.index?0:w.isFinalTabstop?1:D.isFinalTabstop||w.index<D.index?-1:w.index>D.index?1:0}constructor(w){super(),this.index=w}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof Choice?this._children[0]:void 0}clone(){const w=new Placeholder(this.index);return this.transform&&(w.transform=this.transform.clone()),w._children=this.children.map(D=>D.clone()),w}}class Choice extends Marker{constructor(){super(...arguments),this.options=[]}appendChild(w){return w instanceof Text&&(w.parent=this,this.options.push(w)),this}toString(){return this.options[0].value}len(){return this.options[0].len()}clone(){const w=new Choice;return this.options.forEach(w.appendChild,w),w}}class Transform extends Marker{constructor(){super(...arguments),this.regexp=new RegExp("")}resolve(w){const D=this;let O=!1,W=w.replace(this.regexp,function(){return O=!0,D._replace(Array.prototype.slice.call(arguments,0,-2))});return!O&&this._children.some(U=>U instanceof FormatString&&!!U.elseValue)&&(W=this._replace([])),W}_replace(w){let D="";for(const O of this._children)if(O instanceof FormatString){let W=w[O.index]||"";W=O.resolve(W),D+=W}else D+=O.toString();return D}toString(){return""}clone(){const w=new Transform;return w.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),w._children=this.children.map(D=>D.clone()),w}}class FormatString extends Marker{constructor(w,D,O,W){super(),this.index=w,this.shorthandName=D,this.ifValue=O,this.elseValue=W}resolve(w){return this.shorthandName==="upcase"?w?w.toLocaleUpperCase():"":this.shorthandName==="downcase"?w?w.toLocaleLowerCase():"":this.shorthandName==="capitalize"?w?w[0].toLocaleUpperCase()+w.substr(1):"":this.shorthandName==="pascalcase"?w?this._toPascalCase(w):"":this.shorthandName==="camelcase"?w?this._toCamelCase(w):"":w&&typeof this.ifValue=="string"?this.ifValue:!w&&typeof this.elseValue=="string"?this.elseValue:w||""}_toPascalCase(w){const D=w.match(/[a-z0-9]+/gi);return D?D.map(O=>O.charAt(0).toUpperCase()+O.substr(1)).join(""):w}_toCamelCase(w){const D=w.match(/[a-z0-9]+/gi);return D?D.map((O,W)=>W===0?O.charAt(0).toLowerCase()+O.substr(1):O.charAt(0).toUpperCase()+O.substr(1)).join(""):w}clone(){return new FormatString(this.index,this.shorthandName,this.ifValue,this.elseValue)}}class Variable extends TransformableMarker{constructor(w){super(),this.name=w}resolve(w){let D=w.resolve(this);return this.transform&&(D=this.transform.resolve(D||"")),D!==void 0?(this._children=[new Text(D)],!0):!1}clone(){const w=new Variable(this.name);return this.transform&&(w.transform=this.transform.clone()),w._children=this.children.map(D=>D.clone()),w}}function walk(F,w){const D=[...F];for(;D.length>0;){const O=D.shift();if(!w(O))break;D.unshift(...O.children)}}class TextmateSnippet extends Marker{get placeholderInfo(){if(!this._placeholders){const w=[];let D;this.walk(function(O){return O instanceof Placeholder&&(w.push(O),D=!D||D.index<O.index?O:D),!0}),this._placeholders={all:w,last:D}}return this._placeholders}get placeholders(){const{all:w}=this.placeholderInfo;return w}offset(w){let D=0,O=!1;return this.walk(W=>W===w?(O=!0,!1):(D+=W.len(),!0)),O?D:-1}fullLen(w){let D=0;return walk([w],O=>(D+=O.len(),!0)),D}enclosingPlaceholders(w){const D=[];let{parent:O}=w;for(;O;)O instanceof Placeholder&&D.push(O),O=O.parent;return D}resolveVariables(w){return this.walk(D=>(D instanceof Variable&&D.resolve(w)&&(this._placeholders=void 0),!0)),this}appendChild(w){return this._placeholders=void 0,super.appendChild(w)}replace(w,D){return this._placeholders=void 0,super.replace(w,D)}clone(){const w=new TextmateSnippet;return this._children=this.children.map(D=>D.clone()),w}walk(w){walk(this.children,w)}}class SnippetParser{constructor(){this._scanner=new Scanner,this._token={type:14,pos:0,len:0}}static escape(w){return w.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(w){return/\${?CLIPBOARD/.test(w)}parse(w,D,O){const W=new TextmateSnippet;return this.parseFragment(w,W),this.ensureFinalTabstop(W,O??!1,D??!1),W}parseFragment(w,D){const O=D.children.length;for(this._scanner.text(w),this._token=this._scanner.next();this._parse(D););const W=new Map,U=[];D.walk(G=>(G instanceof Placeholder&&(G.isFinalTabstop?W.set(0,void 0):!W.has(G.index)&&G.children.length>0?W.set(G.index,G.children):U.push(G)),!0));const K=(G,Q)=>{const Y=W.get(G.index);if(!Y)return;const X=new Placeholder(G.index);X.transform=G.transform;for(const J of Y){const te=J.clone();X.appendChild(te),te instanceof Placeholder&&W.has(te.index)&&!Q.has(te.index)&&(Q.add(te.index),K(te,Q),Q.delete(te.index))}D.replace(G,[X])},q=new Set;for(const G of U)K(G,q);return D.children.slice(O)}ensureFinalTabstop(w,D,O){(D||O&&w.placeholders.length>0)&&(w.placeholders.find(U=>U.index===0)||w.appendChild(new Placeholder(0)))}_accept(w,D){if(w===void 0||this._token.type===w){const O=D?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),O}return!1}_backTo(w){return this._scanner.pos=w.pos+w.len,this._token=w,!1}_until(w){const D=this._token;for(;this._token.type!==w;){if(this._token.type===14)return!1;if(this._token.type===5){const W=this._scanner.next();if(W.type!==0&&W.type!==4&&W.type!==5)return!1}this._token=this._scanner.next()}const O=this._scanner.value.substring(D.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),O}_parse(w){return this._parseEscaped(w)||this._parseTabstopOrVariableName(w)||this._parseComplexPlaceholder(w)||this._parseComplexVariable(w)||this._parseAnything(w)}_parseEscaped(w){let D;return(D=this._accept(5,!0))?(D=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||D,w.appendChild(new Text(D)),!0):!1}_parseTabstopOrVariableName(w){let D;const O=this._token;return this._accept(0)&&(D=this._accept(9,!0)||this._accept(8,!0))?(w.appendChild(/^\d+$/.test(D)?new Placeholder(Number(D)):new Variable(D)),!0):this._backTo(O)}_parseComplexPlaceholder(w){let D;const O=this._token;if(!(this._accept(0)&&this._accept(3)&&(D=this._accept(8,!0))))return this._backTo(O);const U=new Placeholder(Number(D));if(this._accept(1))for(;;){if(this._accept(4))return w.appendChild(U),!0;if(!this._parse(U))return w.appendChild(new Text("${"+D+":")),U.children.forEach(w.appendChild,w),!0}else if(U.index>0&&this._accept(7)){const K=new Choice;for(;;){if(this._parseChoiceElement(K)){if(this._accept(2))continue;if(this._accept(7)&&(U.appendChild(K),this._accept(4)))return w.appendChild(U),!0}return this._backTo(O),!1}}else return this._accept(6)?this._parseTransform(U)?(w.appendChild(U),!0):(this._backTo(O),!1):this._accept(4)?(w.appendChild(U),!0):this._backTo(O)}_parseChoiceElement(w){const D=this._token,O=[];for(;!(this._token.type===2||this._token.type===7);){let W;if((W=this._accept(5,!0))?W=this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||W:W=this._accept(void 0,!0),!W)return this._backTo(D),!1;O.push(W)}return O.length===0?(this._backTo(D),!1):(w.appendChild(new Text(O.join(""))),!0)}_parseComplexVariable(w){let D;const O=this._token;if(!(this._accept(0)&&this._accept(3)&&(D=this._accept(9,!0))))return this._backTo(O);const U=new Variable(D);if(this._accept(1))for(;;){if(this._accept(4))return w.appendChild(U),!0;if(!this._parse(U))return w.appendChild(new Text("${"+D+":")),U.children.forEach(w.appendChild,w),!0}else return this._accept(6)?this._parseTransform(U)?(w.appendChild(U),!0):(this._backTo(O),!1):this._accept(4)?(w.appendChild(U),!0):this._backTo(O)}_parseTransform(w){const D=new Transform;let O="",W="";for(;!this._accept(6);){let U;if(U=this._accept(5,!0)){U=this._accept(6,!0)||U,O+=U;continue}if(this._token.type!==14){O+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let U;if(U=this._accept(5,!0)){U=this._accept(5,!0)||this._accept(6,!0)||U,D.appendChild(new Text(U));continue}if(!(this._parseFormatString(D)||this._parseAnything(D)))return!1}for(;!this._accept(4);){if(this._token.type!==14){W+=this._accept(void 0,!0);continue}return!1}try{D.regexp=new RegExp(O,W)}catch{return!1}return w.transform=D,!0}_parseFormatString(w){const D=this._token;if(!this._accept(0))return!1;let O=!1;this._accept(3)&&(O=!0);const W=this._accept(8,!0);if(W)if(O){if(this._accept(4))return w.appendChild(new FormatString(Number(W))),!0;if(!this._accept(1))return this._backTo(D),!1}else return w.appendChild(new FormatString(Number(W))),!0;else return this._backTo(D),!1;if(this._accept(6)){const U=this._accept(9,!0);return!U||!this._accept(4)?(this._backTo(D),!1):(w.appendChild(new FormatString(Number(W),U)),!0)}else if(this._accept(11)){const U=this._until(4);if(U)return w.appendChild(new FormatString(Number(W),void 0,U,void 0)),!0}else if(this._accept(12)){const U=this._until(4);if(U)return w.appendChild(new FormatString(Number(W),void 0,void 0,U)),!0}else if(this._accept(13)){const U=this._until(1);if(U){const K=this._until(4);if(K)return w.appendChild(new FormatString(Number(W),void 0,U,K)),!0}}else{const U=this._until(4);if(U)return w.appendChild(new FormatString(Number(W),void 0,void 0,U)),!0}return this._backTo(D),!1}_parseAnything(w){return this._token.type!==14?(w.appendChild(new Text(this._scanner.tokenText(this._token))),this._accept(void 0),!0):!1}}const nullHoverDelegateFactory=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}});let hoverDelegateFactory=nullHoverDelegateFactory;const defaultHoverDelegateMouse=new Lazy(()=>hoverDelegateFactory("mouse",!1)),defaultHoverDelegateElement=new Lazy(()=>hoverDelegateFactory("element",!1));function setHoverDelegateFactory(F){hoverDelegateFactory=F}function getDefaultHoverDelegate(F){return F==="element"?defaultHoverDelegateElement.value:defaultHoverDelegateMouse.value}function createInstantHoverDelegate(){return hoverDelegateFactory("element",!0)}function memoize(F,w,D){let O=null,W=null;if(typeof D.value=="function"?(O="value",W=D.value,W.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof D.get=="function"&&(O="get",W=D.get),!W)throw new Error("not supported");const U=`$memoize$${w}`;D[O]=function(...K){return this.hasOwnProperty(U)||Object.defineProperty(this,U,{configurable:!1,enumerable:!1,writable:!1,value:W.apply(this,K)}),this[U]}}var __decorate$1a=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},EventType;(function(F){F.Tap="-monaco-gesturetap",F.Change="-monaco-gesturechange",F.Start="-monaco-gesturestart",F.End="-monaco-gesturesend",F.Contextmenu="-monaco-gesturecontextmenu"})(EventType||(EventType={}));class Gesture extends Disposable{static{this.SCROLL_FRICTION=-.005}static{this.HOLD_DELAY=700}static{this.CLEAR_TAP_COUNT_TIME=400}constructor(){super(),this.dispatched=!1,this.targets=new LinkedList,this.ignoreTargets=new LinkedList,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(Event$1.runAndSubscribe(onDidRegisterWindow,({window:w,disposables:D})=>{D.add(addDisposableListener(w.document,"touchstart",O=>this.onTouchStart(O),{passive:!1})),D.add(addDisposableListener(w.document,"touchend",O=>this.onTouchEnd(w,O))),D.add(addDisposableListener(w.document,"touchmove",O=>this.onTouchMove(O),{passive:!1}))},{window:mainWindow,disposables:this._store}))}static addTarget(w){if(!Gesture.isTouchDevice())return Disposable.None;Gesture.INSTANCE||(Gesture.INSTANCE=new Gesture);const D=Gesture.INSTANCE.targets.push(w);return toDisposable(D)}static ignoreTarget(w){if(!Gesture.isTouchDevice())return Disposable.None;Gesture.INSTANCE||(Gesture.INSTANCE=new Gesture);const D=Gesture.INSTANCE.ignoreTargets.push(w);return toDisposable(D)}static isTouchDevice(){return"ontouchstart"in mainWindow||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(w){const D=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let O=0,W=w.targetTouches.length;O<W;O++){const U=w.targetTouches.item(O);this.activeTouches[U.identifier]={id:U.identifier,initialTarget:U.target,initialTimeStamp:D,initialPageX:U.pageX,initialPageY:U.pageY,rollingTimestamps:[D],rollingPageX:[U.pageX],rollingPageY:[U.pageY]};const K=this.newGestureEvent(EventType.Start,U.target);K.pageX=U.pageX,K.pageY=U.pageY,this.dispatchEvent(K)}this.dispatched&&(w.preventDefault(),w.stopPropagation(),this.dispatched=!1)}onTouchEnd(w,D){const O=Date.now(),W=Object.keys(this.activeTouches).length;for(let U=0,K=D.changedTouches.length;U<K;U++){const q=D.changedTouches.item(U);if(!this.activeTouches.hasOwnProperty(String(q.identifier))){console.warn("move of an UNKNOWN touch",q);continue}const G=this.activeTouches[q.identifier],Q=Date.now()-G.initialTimeStamp;if(Q<Gesture.HOLD_DELAY&&Math.abs(G.initialPageX-tail(G.rollingPageX))<30&&Math.abs(G.initialPageY-tail(G.rollingPageY))<30){const Y=this.newGestureEvent(EventType.Tap,G.initialTarget);Y.pageX=tail(G.rollingPageX),Y.pageY=tail(G.rollingPageY),this.dispatchEvent(Y)}else if(Q>=Gesture.HOLD_DELAY&&Math.abs(G.initialPageX-tail(G.rollingPageX))<30&&Math.abs(G.initialPageY-tail(G.rollingPageY))<30){const Y=this.newGestureEvent(EventType.Contextmenu,G.initialTarget);Y.pageX=tail(G.rollingPageX),Y.pageY=tail(G.rollingPageY),this.dispatchEvent(Y)}else if(W===1){const Y=tail(G.rollingPageX),X=tail(G.rollingPageY),J=tail(G.rollingTimestamps)-G.rollingTimestamps[0],te=Y-G.rollingPageX[0],ie=X-G.rollingPageY[0],se=[...this.targets].filter(re=>G.initialTarget instanceof Node&&re.contains(G.initialTarget));this.inertia(w,se,O,Math.abs(te)/J,te>0?1:-1,Y,Math.abs(ie)/J,ie>0?1:-1,X)}this.dispatchEvent(this.newGestureEvent(EventType.End,G.initialTarget)),delete this.activeTouches[q.identifier]}this.dispatched&&(D.preventDefault(),D.stopPropagation(),this.dispatched=!1)}newGestureEvent(w,D){const O=document.createEvent("CustomEvent");return O.initEvent(w,!1,!0),O.initialTarget=D,O.tapCount=0,O}dispatchEvent(w){if(w.type===EventType.Tap){const D=new Date().getTime();let O=0;D-this._lastSetTapCountTime>Gesture.CLEAR_TAP_COUNT_TIME?O=1:O=2,this._lastSetTapCountTime=D,w.tapCount=O}else(w.type===EventType.Change||w.type===EventType.Contextmenu)&&(this._lastSetTapCountTime=0);if(w.initialTarget instanceof Node){for(const O of this.ignoreTargets)if(O.contains(w.initialTarget))return;const D=[];for(const O of this.targets)if(O.contains(w.initialTarget)){let W=0,U=w.initialTarget;for(;U&&U!==O;)W++,U=U.parentElement;D.push([W,O])}D.sort((O,W)=>O[0]-W[0]);for(const[O,W]of D)W.dispatchEvent(w),this.dispatched=!0}}inertia(w,D,O,W,U,K,q,G,Q){this.handle=scheduleAtNextAnimationFrame(w,()=>{const Y=Date.now(),X=Y-O;let J=0,te=0,ie=!0;W+=Gesture.SCROLL_FRICTION*X,q+=Gesture.SCROLL_FRICTION*X,W>0&&(ie=!1,J=U*W*X),q>0&&(ie=!1,te=G*q*X);const se=this.newGestureEvent(EventType.Change);se.translationX=J,se.translationY=te,D.forEach(re=>re.dispatchEvent(se)),ie||this.inertia(w,D,Y,W,U,K+J,q,G,Q+te)})}onTouchMove(w){const D=Date.now();for(let O=0,W=w.changedTouches.length;O<W;O++){const U=w.changedTouches.item(O);if(!this.activeTouches.hasOwnProperty(String(U.identifier))){console.warn("end of an UNKNOWN touch",U);continue}const K=this.activeTouches[U.identifier],q=this.newGestureEvent(EventType.Change,K.initialTarget);q.translationX=U.pageX-tail(K.rollingPageX),q.translationY=U.pageY-tail(K.rollingPageY),q.pageX=U.pageX,q.pageY=U.pageY,this.dispatchEvent(q),K.rollingPageX.length>3&&(K.rollingPageX.shift(),K.rollingPageY.shift(),K.rollingTimestamps.shift()),K.rollingPageX.push(U.pageX),K.rollingPageY.push(U.pageY),K.rollingTimestamps.push(D)}this.dispatched&&(w.preventDefault(),w.stopPropagation(),this.dispatched=!1)}}__decorate$1a([memoize],Gesture,"isTouchDevice",null);let Widget$1=class extends Disposable{onclick(w,D){this._register(addDisposableListener(w,EventType$1.CLICK,O=>D(new StandardMouseEvent(getWindow(w),O))))}onmousedown(w,D){this._register(addDisposableListener(w,EventType$1.MOUSE_DOWN,O=>D(new StandardMouseEvent(getWindow(w),O))))}onmouseover(w,D){this._register(addDisposableListener(w,EventType$1.MOUSE_OVER,O=>D(new StandardMouseEvent(getWindow(w),O))))}onmouseleave(w,D){this._register(addDisposableListener(w,EventType$1.MOUSE_LEAVE,O=>D(new StandardMouseEvent(getWindow(w),O))))}onkeydown(w,D){this._register(addDisposableListener(w,EventType$1.KEY_DOWN,O=>D(new StandardKeyboardEvent(O))))}onkeyup(w,D){this._register(addDisposableListener(w,EventType$1.KEY_UP,O=>D(new StandardKeyboardEvent(O))))}oninput(w,D){this._register(addDisposableListener(w,EventType$1.INPUT,D))}onblur(w,D){this._register(addDisposableListener(w,EventType$1.BLUR,D))}onfocus(w,D){this._register(addDisposableListener(w,EventType$1.FOCUS,D))}ignoreGesture(w){return Gesture.ignoreTarget(w)}},baseHoverDelegate={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function setBaseLayerHoverDelegate(F){baseHoverDelegate=F}function getBaseLayerHoverDelegate(){return baseHoverDelegate}class Toggle extends Widget$1{constructor(w){super(),this._onChange=this._register(new Emitter$1),this.onChange=this._onChange.event,this._onKeyDown=this._register(new Emitter$1),this.onKeyDown=this._onKeyDown.event,this._opts=w,this._checked=this._opts.isChecked;const D=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,D.push(...ThemeIcon.asClassNameArray(this._icon))),this._opts.actionClassName&&D.push(...this._opts.actionClassName.split(" ")),this._checked&&D.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(getBaseLayerHoverDelegate().setupManagedHover(w.hoverDelegate??getDefaultHoverDelegate("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...D),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,O=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),O.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,O=>{if(O.keyCode===10||O.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),O.preventDefault(),O.stopPropagation();return}this._onKeyDown.fire(O)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(w){this._checked=w,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}const NLS_CASE_SENSITIVE_TOGGLE_LABEL=localize("caseDescription","Match Case"),NLS_WHOLE_WORD_TOGGLE_LABEL=localize("wordsDescription","Match Whole Word"),NLS_REGEX_TOGGLE_LABEL=localize("regexDescription","Use Regular Expression");class CaseSensitiveToggle extends Toggle{constructor(w){super({icon:Codicon.caseSensitive,title:NLS_CASE_SENSITIVE_TOGGLE_LABEL+w.appendTitle,isChecked:w.isChecked,hoverDelegate:w.hoverDelegate??getDefaultHoverDelegate("element"),inputActiveOptionBorder:w.inputActiveOptionBorder,inputActiveOptionForeground:w.inputActiveOptionForeground,inputActiveOptionBackground:w.inputActiveOptionBackground})}}class WholeWordsToggle extends Toggle{constructor(w){super({icon:Codicon.wholeWord,title:NLS_WHOLE_WORD_TOGGLE_LABEL+w.appendTitle,isChecked:w.isChecked,hoverDelegate:w.hoverDelegate??getDefaultHoverDelegate("element"),inputActiveOptionBorder:w.inputActiveOptionBorder,inputActiveOptionForeground:w.inputActiveOptionForeground,inputActiveOptionBackground:w.inputActiveOptionBackground})}}class RegexToggle extends Toggle{constructor(w){super({icon:Codicon.regex,title:NLS_REGEX_TOGGLE_LABEL+w.appendTitle,isChecked:w.isChecked,hoverDelegate:w.hoverDelegate??getDefaultHoverDelegate("element"),inputActiveOptionBorder:w.inputActiveOptionBorder,inputActiveOptionForeground:w.inputActiveOptionForeground,inputActiveOptionBackground:w.inputActiveOptionBackground})}}class DomEmitter{get event(){return this.emitter.event}constructor(w,D,O){const W=U=>this.emitter.fire(U);this.emitter=new Emitter$1({onWillAddFirstListener:()=>w.addEventListener(D,W,O),onDidRemoveLastListener:()=>w.removeEventListener(D,W,O)})}dispose(){this.emitter.dispose()}}function renderText(F,w={}){const D=createElement(w);return D.textContent=F,D}function renderFormattedText(F,w={}){const D=createElement(w);return _renderFormattedText(D,parseFormattedText(F,!!w.renderCodeSegments),w.actionHandler,w.renderCodeSegments),D}function createElement(F){const w=F.inline?"span":"div",D=document.createElement(w);return F.className&&(D.className=F.className),D}class StringStream{constructor(w){this.source=w,this.index=0}eos(){return this.index>=this.source.length}next(){const w=this.peek();return this.advance(),w}peek(){return this.source[this.index]}advance(){this.index++}}function _renderFormattedText(F,w,D,O){let W;if(w.type===2)W=document.createTextNode(w.content||"");else if(w.type===3)W=document.createElement("b");else if(w.type===4)W=document.createElement("i");else if(w.type===7&&O)W=document.createElement("code");else if(w.type===5&&D){const U=document.createElement("a");D.disposables.add(addStandardDisposableListener(U,"click",K=>{D.callback(String(w.index),K)})),W=U}else w.type===8?W=document.createElement("br"):w.type===1&&(W=F);W&&F!==W&&F.appendChild(W),W&&Array.isArray(w.children)&&w.children.forEach(U=>{_renderFormattedText(W,U,D,O)})}function parseFormattedText(F,w){const D={type:1,children:[]};let O=0,W=D;const U=[],K=new StringStream(F);for(;!K.eos();){let q=K.next();const G=q==="\\"&&formatTagType(K.peek(),w)!==0;if(G&&(q=K.next()),!G&&isFormatTag(q,w)&&q===K.peek()){K.advance(),W.type===2&&(W=U.pop());const Q=formatTagType(q,w);if(W.type===Q||W.type===5&&Q===6)W=U.pop();else{const Y={type:Q,children:[]};Q===5&&(Y.index=O,O++),W.children.push(Y),U.push(W),W=Y}}else if(q===`
`)W.type===2&&(W=U.pop()),W.children.push({type:8});else if(W.type!==2){const Q={type:2,content:q};W.children.push(Q),U.push(W),W=Q}else W.content+=q}return W.type===2&&(W=U.pop()),D}function isFormatTag(F,w){return formatTagType(F,w)!==0}function formatTagType(F,w){switch(F){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return w?7:0;default:return 0}}const DataTransfers={TEXT:Mimes.text},labelWithIconsRegex=new RegExp(`(\\\\)?\\$\\((${ThemeIcon.iconNameExpression}(?:${ThemeIcon.iconModifierExpression})?)\\)`,"g");function renderLabelWithIcons(F){const w=new Array;let D,O=0,W=0;for(;(D=labelWithIconsRegex.exec(F))!==null;){W=D.index||0,O<W&&w.push(F.substring(O,W)),O=(D.index||0)+D[0].length;const[,U,K]=D;w.push(U?`$(${K})`:renderIcon({id:K}))}return O<F.length&&w.push(F.substring(O)),w}function renderIcon(F){const w=$$8("span");return w.classList.add(...ThemeIcon.asClassNameArray(F)),w}const iconStartMarker="$(",iconsRegex=new RegExp(`\\$\\(${ThemeIcon.iconNameExpression}(?:${ThemeIcon.iconModifierExpression})?\\)`,"g"),escapeIconsRegex=new RegExp(`(\\\\)?${iconsRegex.source}`,"g");function escapeIcons(F){return F.replace(escapeIconsRegex,(w,D)=>D?w:`\\${w}`)}const markdownEscapedIconsRegex=new RegExp(`\\\\${iconsRegex.source}`,"g");function markdownEscapeEscapedIcons(F){return F.replace(markdownEscapedIconsRegex,w=>`\\${w}`)}const stripIconsRegex=new RegExp(`(\\s)?(\\\\)?${iconsRegex.source}(\\s)?`,"g");function stripIcons(F){return F.indexOf(iconStartMarker)===-1?F:F.replace(stripIconsRegex,(w,D,O,W)=>O?w:D||W||"")}function getCodiconAriaLabel(F){return F?F.replace(/\$\((.*?)\)/g,(w,D)=>` ${D} `).trim():""}const _parseIconsRegex=new RegExp(`\\$\\(${ThemeIcon.iconNameCharacter}+\\)`,"g");function parseLabelWithIcons(F){_parseIconsRegex.lastIndex=0;let w="";const D=[];let O=0;for(;;){const W=_parseIconsRegex.lastIndex,U=_parseIconsRegex.exec(F),K=F.substring(W,U?.index);if(K.length>0){w+=K;for(let q=0;q<K.length;q++)D.push(O)}if(!U)break;O+=U[0].length}return{text:w,iconOffsets:D}}function matchesFuzzyIconAware(F,w,D=!1){const{text:O,iconOffsets:W}=w;if(!W||W.length===0)return matchesFuzzy(F,O,D);const U=ltrim(O," "),K=O.length-U.length,q=matchesFuzzy(F,U,D);if(q)for(const G of q){const Q=W[G.start+K]+K;G.start+=Q,G.end+=Q}return q}function isPathSeparator(F){return F===47||F===92}function toSlashes(F){return F.replace(/[\\/]/g,posix.sep)}function toPosixPath(F){return F.indexOf("/")===-1&&(F=toSlashes(F)),/^[a-zA-Z]:(\/|$)/.test(F)&&(F="/"+F),F}function getRoot(F,w=posix.sep){if(!F)return"";const D=F.length,O=F.charCodeAt(0);if(isPathSeparator(O)){if(isPathSeparator(F.charCodeAt(1))&&!isPathSeparator(F.charCodeAt(2))){let U=3;const K=U;for(;U<D&&!isPathSeparator(F.charCodeAt(U));U++);if(K!==U&&!isPathSeparator(F.charCodeAt(U+1))){for(U+=1;U<D;U++)if(isPathSeparator(F.charCodeAt(U)))return F.slice(0,U+1).replace(/[\\/]/g,w)}}return w}else if(isWindowsDriveLetter(O)&&F.charCodeAt(1)===58)return isPathSeparator(F.charCodeAt(2))?F.slice(0,2)+w:F.slice(0,2);let W=F.indexOf("://");if(W!==-1){for(W+=3;W<D;W++)if(isPathSeparator(F.charCodeAt(W)))return F.slice(0,W+1)}return""}function isEqualOrParent(F,w,D,O=sep){if(F===w)return!0;if(!F||!w||w.length>F.length)return!1;if(D){if(!startsWithIgnoreCase(F,w))return!1;if(w.length===F.length)return!0;let U=w.length;return w.charAt(w.length-1)===O&&U--,F.charAt(U)===O}return w.charAt(w.length-1)!==O&&(w+=O),F.indexOf(w)===0}function isWindowsDriveLetter(F){return F>=65&&F<=90||F>=97&&F<=122}function hasDriveLetter(F,w=isWindows){return w?isWindowsDriveLetter(F.charCodeAt(0))&&F.charCodeAt(1)===58:!1}function originalFSPath(F){return uriToFsPath(F,!0)}class ExtUri{constructor(w){this._ignorePathCasing=w}compare(w,D,O=!1){return w===D?0:compare(this.getComparisonKey(w,O),this.getComparisonKey(D,O))}isEqual(w,D,O=!1){return w===D?!0:!w||!D?!1:this.getComparisonKey(w,O)===this.getComparisonKey(D,O)}getComparisonKey(w,D=!1){return w.with({path:this._ignorePathCasing(w)?w.path.toLowerCase():void 0,fragment:D?null:void 0}).toString()}isEqualOrParent(w,D,O=!1){if(w.scheme===D.scheme){if(w.scheme===Schemas.file)return isEqualOrParent(originalFSPath(w),originalFSPath(D),this._ignorePathCasing(w))&&w.query===D.query&&(O||w.fragment===D.fragment);if(isEqualAuthority(w.authority,D.authority))return isEqualOrParent(w.path,D.path,this._ignorePathCasing(w),"/")&&w.query===D.query&&(O||w.fragment===D.fragment)}return!1}joinPath(w,...D){return URI.joinPath(w,...D)}basenameOrAuthority(w){return basename(w)||w.authority}basename(w){return posix.basename(w.path)}extname(w){return posix.extname(w.path)}dirname(w){if(w.path.length===0)return w;let D;return w.scheme===Schemas.file?D=URI.file(dirname$1(originalFSPath(w))).path:(D=posix.dirname(w.path),w.authority&&D.length&&D.charCodeAt(0)!==47&&(console.error(`dirname("${w.toString})) resulted in a relative path`),D="/")),w.with({path:D})}normalizePath(w){if(!w.path.length)return w;let D;return w.scheme===Schemas.file?D=URI.file(normalize(originalFSPath(w))).path:D=posix.normalize(w.path),w.with({path:D})}relativePath(w,D){if(w.scheme!==D.scheme||!isEqualAuthority(w.authority,D.authority))return;if(w.scheme===Schemas.file){const U=relative(originalFSPath(w),originalFSPath(D));return isWindows?toSlashes(U):U}let O=w.path||"/";const W=D.path||"/";if(this._ignorePathCasing(w)){let U=0;for(const K=Math.min(O.length,W.length);U<K&&!(O.charCodeAt(U)!==W.charCodeAt(U)&&O.charAt(U).toLowerCase()!==W.charAt(U).toLowerCase());U++);O=W.substr(0,U)+O.substr(U)}return posix.relative(O,W)}resolvePath(w,D){if(w.scheme===Schemas.file){const O=URI.file(resolve(originalFSPath(w),D));return w.with({authority:O.authority,path:O.path})}return D=toPosixPath(D),w.with({path:posix.resolve(w.path,D)})}isAbsolutePath(w){return!!w.path&&w.path[0]==="/"}isEqualAuthority(w,D){return w===D||w!==void 0&&D!==void 0&&equalsIgnoreCase(w,D)}hasTrailingPathSeparator(w,D=sep){if(w.scheme===Schemas.file){const O=originalFSPath(w);return O.length>getRoot(O).length&&O[O.length-1]===D}else{const O=w.path;return O.length>1&&O.charCodeAt(O.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(w.fsPath)}}removeTrailingPathSeparator(w,D=sep){return hasTrailingPathSeparator(w,D)?w.with({path:w.path.substr(0,w.path.length-1)}):w}addTrailingPathSeparator(w,D=sep){let O=!1;if(w.scheme===Schemas.file){const W=originalFSPath(w);O=W!==void 0&&W.length===getRoot(W).length&&W[W.length-1]===D}else{D="/";const W=w.path;O=W.length===1&&W.charCodeAt(W.length-1)===47}return!O&&!hasTrailingPathSeparator(w,D)?w.with({path:w.path+"/"}):w}}const extUri=new ExtUri(()=>!1),isEqual=extUri.isEqual.bind(extUri);extUri.isEqualOrParent.bind(extUri);extUri.getComparisonKey.bind(extUri);extUri.basenameOrAuthority.bind(extUri);const basename=extUri.basename.bind(extUri),extname=extUri.extname.bind(extUri),dirname=extUri.dirname.bind(extUri);extUri.joinPath.bind(extUri);const normalizePath=extUri.normalizePath.bind(extUri);extUri.relativePath.bind(extUri);const resolvePath=extUri.resolvePath.bind(extUri);extUri.isAbsolutePath.bind(extUri);const isEqualAuthority=extUri.isEqualAuthority.bind(extUri),hasTrailingPathSeparator=extUri.hasTrailingPathSeparator.bind(extUri);extUri.removeTrailingPathSeparator.bind(extUri);extUri.addTrailingPathSeparator.bind(extUri);var DataUri;(function(F){F.META_DATA_LABEL="label",F.META_DATA_DESCRIPTION="description",F.META_DATA_SIZE="size",F.META_DATA_MIME="mime";function w(D){const O=new Map;D.path.substring(D.path.indexOf(";")+1,D.path.lastIndexOf(";")).split(";").forEach(K=>{const[q,G]=K.split(":");q&&G&&O.set(q,G)});const U=D.path.substring(0,D.path.indexOf(";"));return U&&O.set(F.META_DATA_MIME,U),O}F.parseMetaData=w})(DataUri||(DataUri={}));class MarkdownString{constructor(w="",D=!1){if(this.value=w,typeof this.value!="string")throw illegalArgument("value");typeof D=="boolean"?(this.isTrusted=D,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=D.isTrusted??void 0,this.supportThemeIcons=D.supportThemeIcons??!1,this.supportHtml=D.supportHtml??!1)}appendText(w,D=0){return this.value+=escapeMarkdownSyntaxTokens(this.supportThemeIcons?escapeIcons(w):w).replace(/([ \t]+)/g,(O,W)=>"&nbsp;".repeat(W.length)).replace(/\>/gm,"\\>").replace(/\n/g,D===1?`\\
`:`

`),this}appendMarkdown(w){return this.value+=w,this}appendCodeblock(w,D){return this.value+=`
${appendEscapedMarkdownCodeBlockFence(D,w)}
`,this}appendLink(w,D,O){return this.value+="[",this.value+=this._escape(D,"]"),this.value+="](",this.value+=this._escape(String(w),")"),O&&(this.value+=` "${this._escape(this._escape(O,'"'),")")}"`),this.value+=")",this}_escape(w,D){const O=new RegExp(escapeRegExpCharacters(D),"g");return w.replace(O,(W,U)=>w.charAt(U-1)!=="\\"?`\\${W}`:W)}}function isMarkdownString(F){return F instanceof MarkdownString?!0:F&&typeof F=="object"?typeof F.value=="string"&&(typeof F.isTrusted=="boolean"||typeof F.isTrusted=="object"||F.isTrusted===void 0)&&(typeof F.supportThemeIcons=="boolean"||F.supportThemeIcons===void 0):!1}function markdownStringEqual(F,w){return F===w?!0:!F||!w?!1:F.value===w.value&&F.isTrusted===w.isTrusted&&F.supportThemeIcons===w.supportThemeIcons&&F.supportHtml===w.supportHtml&&(F.baseUri===w.baseUri||!!F.baseUri&&!!w.baseUri&&isEqual(URI.from(F.baseUri),URI.from(w.baseUri)))}function escapeMarkdownSyntaxTokens(F){return F.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function appendEscapedMarkdownCodeBlockFence(F,w){const D=F.match(/^`+/gm)?.reduce((W,U)=>W.length>U.length?W:U).length??0,O=D>=3?D+1:3;return[`${"`".repeat(O)}${w}`,F,`${"`".repeat(O)}`].join(`
`)}function escapeDoubleQuotes(F){return F.replace(/"/g,"&quot;")}function removeMarkdownEscapes(F){return F&&F.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function parseHrefAndDimensions(F){const w=[],D=F.split("|").map(W=>W.trim());F=D[0];const O=D[1];if(O){const W=/height=(\d+)/.exec(O),U=/width=(\d+)/.exec(O),K=W?W[1]:"",q=U?U[1]:"",G=isFinite(parseInt(q)),Q=isFinite(parseInt(K));G&&w.push(`width="${q}"`),Q&&w.push(`height="${K}"`)}return{href:F,dimensions:w}}class IdGenerator{constructor(w){this._prefix=w,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const defaultGenerator=new IdGenerator("id#");let __marked_exports={};(function(){function F(w,D){D(__marked_exports)}F.amd=!0,function(w,D){typeof F=="function"&&F.amd?F(["exports"],D):typeof exports=="object"&&typeof module<"u"?D(exports):(w=typeof globalThis<"u"?globalThis:w||self,D(w.marked={}))}(this,function(w){function D(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}w.defaults=D();function O(xt){w.defaults=xt}const W=/[&<>"']/,U=new RegExp(W.source,"g"),K=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,q=new RegExp(K.source,"g"),G={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Q=xt=>G[xt];function Y(xt,Ee){if(Ee){if(W.test(xt))return xt.replace(U,Q)}else if(K.test(xt))return xt.replace(q,Q);return xt}const X=/(^|[^\[])\^/g;function J(xt,Ee){let xe=typeof xt=="string"?xt:xt.source;Ee=Ee||"";const Ie={replace:(Pe,$e)=>{let Ge=typeof $e=="string"?$e:$e.source;return Ge=Ge.replace(X,"$1"),xe=xe.replace(Pe,Ge),Ie},getRegex:()=>new RegExp(xe,Ee)};return Ie}function te(xt){try{xt=encodeURI(xt).replace(/%25/g,"%")}catch{return null}return xt}const ie={exec:()=>null};function se(xt,Ee){const xe=xt.replace(/\|/g,($e,Ge,Xe)=>{let ut=!1,ht=Ge;for(;--ht>=0&&Xe[ht]==="\\";)ut=!ut;return ut?"|":" |"}),Ie=xe.split(/ \|/);let Pe=0;if(Ie[0].trim()||Ie.shift(),Ie.length>0&&!Ie[Ie.length-1].trim()&&Ie.pop(),Ee)if(Ie.length>Ee)Ie.splice(Ee);else for(;Ie.length<Ee;)Ie.push("");for(;Pe<Ie.length;Pe++)Ie[Pe]=Ie[Pe].trim().replace(/\\\|/g,"|");return Ie}function re(xt,Ee,xe){const Ie=xt.length;if(Ie===0)return"";let Pe=0;for(;Pe<Ie&&xt.charAt(Ie-Pe-1)===Ee;)Pe++;return xt.slice(0,Ie-Pe)}function ae(xt,Ee){if(xt.indexOf(Ee[1])===-1)return-1;let xe=0;for(let Ie=0;Ie<xt.length;Ie++)if(xt[Ie]==="\\")Ie++;else if(xt[Ie]===Ee[0])xe++;else if(xt[Ie]===Ee[1]&&(xe--,xe<0))return Ie;return-1}function le(xt,Ee,xe,Ie){const Pe=Ee.href,$e=Ee.title?Y(Ee.title):null,Ge=xt[1].replace(/\\([\[\]])/g,"$1");if(xt[0].charAt(0)!=="!"){Ie.state.inLink=!0;const Xe={type:"link",raw:xe,href:Pe,title:$e,text:Ge,tokens:Ie.inlineTokens(Ge)};return Ie.state.inLink=!1,Xe}return{type:"image",raw:xe,href:Pe,title:$e,text:Y(Ge)}}function de(xt,Ee){const xe=xt.match(/^(\s+)(?:```)/);if(xe===null)return Ee;const Ie=xe[1];return Ee.split(`
`).map(Pe=>{const $e=Pe.match(/^\s+/);if($e===null)return Pe;const[Ge]=$e;return Ge.length>=Ie.length?Pe.slice(Ie.length):Pe}).join(`
`)}class oe{options;rules;lexer;constructor(Ee){this.options=Ee||w.defaults}space(Ee){const xe=this.rules.block.newline.exec(Ee);if(xe&&xe[0].length>0)return{type:"space",raw:xe[0]}}code(Ee){const xe=this.rules.block.code.exec(Ee);if(xe){const Ie=xe[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:xe[0],codeBlockStyle:"indented",text:this.options.pedantic?Ie:re(Ie,`
`)}}}fences(Ee){const xe=this.rules.block.fences.exec(Ee);if(xe){const Ie=xe[0],Pe=de(Ie,xe[3]||"");return{type:"code",raw:Ie,lang:xe[2]?xe[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):xe[2],text:Pe}}}heading(Ee){const xe=this.rules.block.heading.exec(Ee);if(xe){let Ie=xe[2].trim();if(/#$/.test(Ie)){const Pe=re(Ie,"#");(this.options.pedantic||!Pe||/ $/.test(Pe))&&(Ie=Pe.trim())}return{type:"heading",raw:xe[0],depth:xe[1].length,text:Ie,tokens:this.lexer.inline(Ie)}}}hr(Ee){const xe=this.rules.block.hr.exec(Ee);if(xe)return{type:"hr",raw:re(xe[0],`
`)}}blockquote(Ee){const xe=this.rules.block.blockquote.exec(Ee);if(xe){let Ie=re(xe[0],`
`).split(`
`),Pe="",$e="";const Ge=[];for(;Ie.length>0;){let Xe=!1;const ut=[];let ht;for(ht=0;ht<Ie.length;ht++)if(/^ {0,3}>/.test(Ie[ht]))ut.push(Ie[ht]),Xe=!0;else if(!Xe)ut.push(Ie[ht]);else break;Ie=Ie.slice(ht);const pt=ut.join(`
`),$t=pt.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");Pe=Pe?`${Pe}
${pt}`:pt,$e=$e?`${$e}
${$t}`:$t;const Pt=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens($t,Ge,!0),this.lexer.state.top=Pt,Ie.length===0)break;const Yt=Ge[Ge.length-1];if(Yt?.type==="code")break;if(Yt?.type==="blockquote"){const Xt=Yt,Si=Xt.raw+`
`+Ie.join(`
`),Pi=this.blockquote(Si);Ge[Ge.length-1]=Pi,Pe=Pe.substring(0,Pe.length-Xt.raw.length)+Pi.raw,$e=$e.substring(0,$e.length-Xt.text.length)+Pi.text;break}else if(Yt?.type==="list"){const Xt=Yt,Si=Xt.raw+`
`+Ie.join(`
`),Pi=this.list(Si);Ge[Ge.length-1]=Pi,Pe=Pe.substring(0,Pe.length-Yt.raw.length)+Pi.raw,$e=$e.substring(0,$e.length-Xt.raw.length)+Pi.raw,Ie=Si.substring(Ge[Ge.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:Pe,tokens:Ge,text:$e}}}list(Ee){let xe=this.rules.block.list.exec(Ee);if(xe){let Ie=xe[1].trim();const Pe=Ie.length>1,$e={type:"list",raw:"",ordered:Pe,start:Pe?+Ie.slice(0,-1):"",loose:!1,items:[]};Ie=Pe?`\\d{1,9}\\${Ie.slice(-1)}`:`\\${Ie}`,this.options.pedantic&&(Ie=Pe?Ie:"[*+-]");const Ge=new RegExp(`^( {0,3}${Ie})((?:[	 ][^\\n]*)?(?:\\n|$))`);let Xe=!1;for(;Ee;){let ut=!1,ht="",pt="";if(!(xe=Ge.exec(Ee))||this.rules.block.hr.test(Ee))break;ht=xe[0],Ee=Ee.substring(ht.length);let $t=xe[2].split(`
`,1)[0].replace(/^\t+/,yn=>" ".repeat(3*yn.length)),Pt=Ee.split(`
`,1)[0],Yt=!$t.trim(),Xt=0;if(this.options.pedantic?(Xt=2,pt=$t.trimStart()):Yt?Xt=xe[1].length+1:(Xt=xe[2].search(/[^ ]/),Xt=Xt>4?1:Xt,pt=$t.slice(Xt),Xt+=xe[1].length),Yt&&/^ *$/.test(Pt)&&(ht+=Pt+`
`,Ee=Ee.substring(Pt.length+1),ut=!0),!ut){const yn=new RegExp(`^ {0,${Math.min(3,Xt-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),vt=new RegExp(`^ {0,${Math.min(3,Xt-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),We=new RegExp(`^ {0,${Math.min(3,Xt-1)}}(?:\`\`\`|~~~)`),dt=new RegExp(`^ {0,${Math.min(3,Xt-1)}}#`);for(;Ee;){const _t=Ee.split(`
`,1)[0];if(Pt=_t,this.options.pedantic&&(Pt=Pt.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),We.test(Pt)||dt.test(Pt)||yn.test(Pt)||vt.test(Ee))break;if(Pt.search(/[^ ]/)>=Xt||!Pt.trim())pt+=`
`+Pt.slice(Xt);else{if(Yt||$t.search(/[^ ]/)>=4||We.test($t)||dt.test($t)||vt.test($t))break;pt+=`
`+Pt}!Yt&&!Pt.trim()&&(Yt=!0),ht+=_t+`
`,Ee=Ee.substring(_t.length+1),$t=Pt.slice(Xt)}}$e.loose||(Xe?$e.loose=!0:/\n *\n *$/.test(ht)&&(Xe=!0));let Si=null,Pi;this.options.gfm&&(Si=/^\[[ xX]\] /.exec(pt),Si&&(Pi=Si[0]!=="[ ] ",pt=pt.replace(/^\[[ xX]\] +/,""))),$e.items.push({type:"list_item",raw:ht,task:!!Si,checked:Pi,loose:!1,text:pt,tokens:[]}),$e.raw+=ht}$e.items[$e.items.length-1].raw=$e.items[$e.items.length-1].raw.trimEnd(),$e.items[$e.items.length-1].text=$e.items[$e.items.length-1].text.trimEnd(),$e.raw=$e.raw.trimEnd();for(let ut=0;ut<$e.items.length;ut++)if(this.lexer.state.top=!1,$e.items[ut].tokens=this.lexer.blockTokens($e.items[ut].text,[]),!$e.loose){const ht=$e.items[ut].tokens.filter($t=>$t.type==="space"),pt=ht.length>0&&ht.some($t=>/\n.*\n/.test($t.raw));$e.loose=pt}if($e.loose)for(let ut=0;ut<$e.items.length;ut++)$e.items[ut].loose=!0;return $e}}html(Ee){const xe=this.rules.block.html.exec(Ee);if(xe)return{type:"html",block:!0,raw:xe[0],pre:xe[1]==="pre"||xe[1]==="script"||xe[1]==="style",text:xe[0]}}def(Ee){const xe=this.rules.block.def.exec(Ee);if(xe){const Ie=xe[1].toLowerCase().replace(/\s+/g," "),Pe=xe[2]?xe[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",$e=xe[3]?xe[3].substring(1,xe[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):xe[3];return{type:"def",tag:Ie,raw:xe[0],href:Pe,title:$e}}}table(Ee){const xe=this.rules.block.table.exec(Ee);if(!xe||!/[:|]/.test(xe[2]))return;const Ie=se(xe[1]),Pe=xe[2].replace(/^\||\| *$/g,"").split("|"),$e=xe[3]&&xe[3].trim()?xe[3].replace(/\n[ \t]*$/,"").split(`
`):[],Ge={type:"table",raw:xe[0],header:[],align:[],rows:[]};if(Ie.length===Pe.length){for(const Xe of Pe)/^ *-+: *$/.test(Xe)?Ge.align.push("right"):/^ *:-+: *$/.test(Xe)?Ge.align.push("center"):/^ *:-+ *$/.test(Xe)?Ge.align.push("left"):Ge.align.push(null);for(let Xe=0;Xe<Ie.length;Xe++)Ge.header.push({text:Ie[Xe],tokens:this.lexer.inline(Ie[Xe]),header:!0,align:Ge.align[Xe]});for(const Xe of $e)Ge.rows.push(se(Xe,Ge.header.length).map((ut,ht)=>({text:ut,tokens:this.lexer.inline(ut),header:!1,align:Ge.align[ht]})));return Ge}}lheading(Ee){const xe=this.rules.block.lheading.exec(Ee);if(xe)return{type:"heading",raw:xe[0],depth:xe[2].charAt(0)==="="?1:2,text:xe[1],tokens:this.lexer.inline(xe[1])}}paragraph(Ee){const xe=this.rules.block.paragraph.exec(Ee);if(xe){const Ie=xe[1].charAt(xe[1].length-1)===`
`?xe[1].slice(0,-1):xe[1];return{type:"paragraph",raw:xe[0],text:Ie,tokens:this.lexer.inline(Ie)}}}text(Ee){const xe=this.rules.block.text.exec(Ee);if(xe)return{type:"text",raw:xe[0],text:xe[0],tokens:this.lexer.inline(xe[0])}}escape(Ee){const xe=this.rules.inline.escape.exec(Ee);if(xe)return{type:"escape",raw:xe[0],text:Y(xe[1])}}tag(Ee){const xe=this.rules.inline.tag.exec(Ee);if(xe)return!this.lexer.state.inLink&&/^<a /i.test(xe[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(xe[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(xe[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(xe[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:xe[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:xe[0]}}link(Ee){const xe=this.rules.inline.link.exec(Ee);if(xe){const Ie=xe[2].trim();if(!this.options.pedantic&&/^</.test(Ie)){if(!/>$/.test(Ie))return;const Ge=re(Ie.slice(0,-1),"\\");if((Ie.length-Ge.length)%2===0)return}else{const Ge=ae(xe[2],"()");if(Ge>-1){const ut=(xe[0].indexOf("!")===0?5:4)+xe[1].length+Ge;xe[2]=xe[2].substring(0,Ge),xe[0]=xe[0].substring(0,ut).trim(),xe[3]=""}}let Pe=xe[2],$e="";if(this.options.pedantic){const Ge=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(Pe);Ge&&(Pe=Ge[1],$e=Ge[3])}else $e=xe[3]?xe[3].slice(1,-1):"";return Pe=Pe.trim(),/^</.test(Pe)&&(this.options.pedantic&&!/>$/.test(Ie)?Pe=Pe.slice(1):Pe=Pe.slice(1,-1)),le(xe,{href:Pe&&Pe.replace(this.rules.inline.anyPunctuation,"$1"),title:$e&&$e.replace(this.rules.inline.anyPunctuation,"$1")},xe[0],this.lexer)}}reflink(Ee,xe){let Ie;if((Ie=this.rules.inline.reflink.exec(Ee))||(Ie=this.rules.inline.nolink.exec(Ee))){const Pe=(Ie[2]||Ie[1]).replace(/\s+/g," "),$e=xe[Pe.toLowerCase()];if(!$e){const Ge=Ie[0].charAt(0);return{type:"text",raw:Ge,text:Ge}}return le(Ie,$e,Ie[0],this.lexer)}}emStrong(Ee,xe,Ie=""){let Pe=this.rules.inline.emStrongLDelim.exec(Ee);if(!Pe||Pe[3]&&Ie.match(/[\p{L}\p{N}]/u))return;if(!(Pe[1]||Pe[2]||"")||!Ie||this.rules.inline.punctuation.exec(Ie)){const Ge=[...Pe[0]].length-1;let Xe,ut,ht=Ge,pt=0;const $t=Pe[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for($t.lastIndex=0,xe=xe.slice(-1*Ee.length+Ge);(Pe=$t.exec(xe))!=null;){if(Xe=Pe[1]||Pe[2]||Pe[3]||Pe[4]||Pe[5]||Pe[6],!Xe)continue;if(ut=[...Xe].length,Pe[3]||Pe[4]){ht+=ut;continue}else if((Pe[5]||Pe[6])&&Ge%3&&!((Ge+ut)%3)){pt+=ut;continue}if(ht-=ut,ht>0)continue;ut=Math.min(ut,ut+ht+pt);const Pt=[...Pe[0]][0].length,Yt=Ee.slice(0,Ge+Pe.index+Pt+ut);if(Math.min(Ge,ut)%2){const Si=Yt.slice(1,-1);return{type:"em",raw:Yt,text:Si,tokens:this.lexer.inlineTokens(Si)}}const Xt=Yt.slice(2,-2);return{type:"strong",raw:Yt,text:Xt,tokens:this.lexer.inlineTokens(Xt)}}}}codespan(Ee){const xe=this.rules.inline.code.exec(Ee);if(xe){let Ie=xe[2].replace(/\n/g," ");const Pe=/[^ ]/.test(Ie),$e=/^ /.test(Ie)&&/ $/.test(Ie);return Pe&&$e&&(Ie=Ie.substring(1,Ie.length-1)),Ie=Y(Ie,!0),{type:"codespan",raw:xe[0],text:Ie}}}br(Ee){const xe=this.rules.inline.br.exec(Ee);if(xe)return{type:"br",raw:xe[0]}}del(Ee){const xe=this.rules.inline.del.exec(Ee);if(xe)return{type:"del",raw:xe[0],text:xe[2],tokens:this.lexer.inlineTokens(xe[2])}}autolink(Ee){const xe=this.rules.inline.autolink.exec(Ee);if(xe){let Ie,Pe;return xe[2]==="@"?(Ie=Y(xe[1]),Pe="mailto:"+Ie):(Ie=Y(xe[1]),Pe=Ie),{type:"link",raw:xe[0],text:Ie,href:Pe,tokens:[{type:"text",raw:Ie,text:Ie}]}}}url(Ee){let xe;if(xe=this.rules.inline.url.exec(Ee)){let Ie,Pe;if(xe[2]==="@")Ie=Y(xe[0]),Pe="mailto:"+Ie;else{let $e;do $e=xe[0],xe[0]=this.rules.inline._backpedal.exec(xe[0])?.[0]??"";while($e!==xe[0]);Ie=Y(xe[0]),xe[1]==="www."?Pe="http://"+xe[0]:Pe=xe[0]}return{type:"link",raw:xe[0],text:Ie,href:Pe,tokens:[{type:"text",raw:Ie,text:Ie}]}}}inlineText(Ee){const xe=this.rules.inline.text.exec(Ee);if(xe){let Ie;return this.lexer.state.inRawBlock?Ie=xe[0]:Ie=Y(xe[0]),{type:"text",raw:xe[0],text:Ie}}}}const ue=/^(?: *(?:\n|$))+/,pe=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fe=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Ce=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,we=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Oe=/(?:[*+-]|\d{1,9}[.)])/,Te=J(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Oe).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Re=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Me=/^[^\n]+/,Ne=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ze=J(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",Ne).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Qe=J(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Oe).getRegex(),Ye="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Je=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,at=J("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",Je).replace("tag",Ye).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),st=J(Re).replace("hr",Ce).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ye).getRegex(),Tt={blockquote:J(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",st).getRegex(),code:pe,def:ze,fences:fe,heading:we,hr:Ce,html:at,lheading:Te,list:Qe,newline:ue,paragraph:st,table:ie,text:Me},Ke=J("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Ce).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ye).getRegex(),je={...Tt,table:Ke,paragraph:J(Re).replace("hr",Ce).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ke).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ye).getRegex()},et={...Tt,html:J(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Je).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ie,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:J(Re).replace("hr",Ce).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Te).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},mt=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Mt=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Et=/^( {2,}|\\)\n(?!\s*$)/,Ct=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Nt="\\p{P}\\p{S}",zt=J(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Nt).getRegex(),ii=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Ci=J(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Nt).getRegex(),ni=J("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Nt).getRegex(),vi=J("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Nt).getRegex(),hi=J(/\\([punct])/,"gu").replace(/punct/g,Nt).getRegex(),jt=J(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),zi=J(Je).replace("(?:-->|$)","-->").getRegex(),Ki=J("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",zi).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),pi=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,mi=J(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",pi).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),kt=J(/^!?\[(label)\]\[(ref)\]/).replace("label",pi).replace("ref",Ne).getRegex(),ki=J(/^!?\[(ref)\](?:\[\])?/).replace("ref",Ne).getRegex(),Ii=J("reflink|nolink(?!\\()","g").replace("reflink",kt).replace("nolink",ki).getRegex(),Jt={_backpedal:ie,anyPunctuation:hi,autolink:jt,blockSkip:ii,br:Et,code:Mt,del:ie,emStrongLDelim:Ci,emStrongRDelimAst:ni,emStrongRDelimUnd:vi,escape:mt,link:mi,nolink:ki,punctuation:zt,reflink:kt,reflinkSearch:Ii,tag:Ki,text:Ct,url:ie},_i={...Jt,link:J(/^!?\[(label)\]\((.*?)\)/).replace("label",pi).getRegex(),reflink:J(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",pi).getRegex()},Lt={...Jt,escape:J(mt).replace("])","~|])").getRegex(),url:J(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},St={...Lt,br:J(Et).replace("{2,}","*").getRegex(),text:J(Lt.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},si={normal:Tt,gfm:je,pedantic:et},Se={normal:Jt,gfm:Lt,breaks:St,pedantic:_i};class ge{tokens;options;state;tokenizer;inlineQueue;constructor(Ee){this.tokens=[],this.tokens.links=Object.create(null),this.options=Ee||w.defaults,this.options.tokenizer=this.options.tokenizer||new oe,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const xe={block:si.normal,inline:Se.normal};this.options.pedantic?(xe.block=si.pedantic,xe.inline=Se.pedantic):this.options.gfm&&(xe.block=si.gfm,this.options.breaks?xe.inline=Se.breaks:xe.inline=Se.gfm),this.tokenizer.rules=xe}static get rules(){return{block:si,inline:Se}}static lex(Ee,xe){return new ge(xe).lex(Ee)}static lexInline(Ee,xe){return new ge(xe).inlineTokens(Ee)}lex(Ee){Ee=Ee.replace(/\r\n|\r/g,`
`),this.blockTokens(Ee,this.tokens);for(let xe=0;xe<this.inlineQueue.length;xe++){const Ie=this.inlineQueue[xe];this.inlineTokens(Ie.src,Ie.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(Ee,xe=[],Ie=!1){this.options.pedantic?Ee=Ee.replace(/\t/g,"    ").replace(/^ +$/gm,""):Ee=Ee.replace(/^( *)(\t+)/gm,(Xe,ut,ht)=>ut+"    ".repeat(ht.length));let Pe,$e,Ge;for(;Ee;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(Xe=>(Pe=Xe.call({lexer:this},Ee,xe))?(Ee=Ee.substring(Pe.raw.length),xe.push(Pe),!0):!1))){if(Pe=this.tokenizer.space(Ee)){Ee=Ee.substring(Pe.raw.length),Pe.raw.length===1&&xe.length>0?xe[xe.length-1].raw+=`
`:xe.push(Pe);continue}if(Pe=this.tokenizer.code(Ee)){Ee=Ee.substring(Pe.raw.length),$e=xe[xe.length-1],$e&&($e.type==="paragraph"||$e.type==="text")?($e.raw+=`
`+Pe.raw,$e.text+=`
`+Pe.text,this.inlineQueue[this.inlineQueue.length-1].src=$e.text):xe.push(Pe);continue}if(Pe=this.tokenizer.fences(Ee)){Ee=Ee.substring(Pe.raw.length),xe.push(Pe);continue}if(Pe=this.tokenizer.heading(Ee)){Ee=Ee.substring(Pe.raw.length),xe.push(Pe);continue}if(Pe=this.tokenizer.hr(Ee)){Ee=Ee.substring(Pe.raw.length),xe.push(Pe);continue}if(Pe=this.tokenizer.blockquote(Ee)){Ee=Ee.substring(Pe.raw.length),xe.push(Pe);continue}if(Pe=this.tokenizer.list(Ee)){Ee=Ee.substring(Pe.raw.length),xe.push(Pe);continue}if(Pe=this.tokenizer.html(Ee)){Ee=Ee.substring(Pe.raw.length),xe.push(Pe);continue}if(Pe=this.tokenizer.def(Ee)){Ee=Ee.substring(Pe.raw.length),$e=xe[xe.length-1],$e&&($e.type==="paragraph"||$e.type==="text")?($e.raw+=`
`+Pe.raw,$e.text+=`
`+Pe.raw,this.inlineQueue[this.inlineQueue.length-1].src=$e.text):this.tokens.links[Pe.tag]||(this.tokens.links[Pe.tag]={href:Pe.href,title:Pe.title});continue}if(Pe=this.tokenizer.table(Ee)){Ee=Ee.substring(Pe.raw.length),xe.push(Pe);continue}if(Pe=this.tokenizer.lheading(Ee)){Ee=Ee.substring(Pe.raw.length),xe.push(Pe);continue}if(Ge=Ee,this.options.extensions&&this.options.extensions.startBlock){let Xe=1/0;const ut=Ee.slice(1);let ht;this.options.extensions.startBlock.forEach(pt=>{ht=pt.call({lexer:this},ut),typeof ht=="number"&&ht>=0&&(Xe=Math.min(Xe,ht))}),Xe<1/0&&Xe>=0&&(Ge=Ee.substring(0,Xe+1))}if(this.state.top&&(Pe=this.tokenizer.paragraph(Ge))){$e=xe[xe.length-1],Ie&&$e?.type==="paragraph"?($e.raw+=`
`+Pe.raw,$e.text+=`
`+Pe.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=$e.text):xe.push(Pe),Ie=Ge.length!==Ee.length,Ee=Ee.substring(Pe.raw.length);continue}if(Pe=this.tokenizer.text(Ee)){Ee=Ee.substring(Pe.raw.length),$e=xe[xe.length-1],$e&&$e.type==="text"?($e.raw+=`
`+Pe.raw,$e.text+=`
`+Pe.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=$e.text):xe.push(Pe);continue}if(Ee){const Xe="Infinite loop on byte: "+Ee.charCodeAt(0);if(this.options.silent){console.error(Xe);break}else throw new Error(Xe)}}return this.state.top=!0,xe}inline(Ee,xe=[]){return this.inlineQueue.push({src:Ee,tokens:xe}),xe}inlineTokens(Ee,xe=[]){let Ie,Pe,$e,Ge=Ee,Xe,ut,ht;if(this.tokens.links){const pt=Object.keys(this.tokens.links);if(pt.length>0)for(;(Xe=this.tokenizer.rules.inline.reflinkSearch.exec(Ge))!=null;)pt.includes(Xe[0].slice(Xe[0].lastIndexOf("[")+1,-1))&&(Ge=Ge.slice(0,Xe.index)+"["+"a".repeat(Xe[0].length-2)+"]"+Ge.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(Xe=this.tokenizer.rules.inline.blockSkip.exec(Ge))!=null;)Ge=Ge.slice(0,Xe.index)+"["+"a".repeat(Xe[0].length-2)+"]"+Ge.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(Xe=this.tokenizer.rules.inline.anyPunctuation.exec(Ge))!=null;)Ge=Ge.slice(0,Xe.index)+"++"+Ge.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;Ee;)if(ut||(ht=""),ut=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(pt=>(Ie=pt.call({lexer:this},Ee,xe))?(Ee=Ee.substring(Ie.raw.length),xe.push(Ie),!0):!1))){if(Ie=this.tokenizer.escape(Ee)){Ee=Ee.substring(Ie.raw.length),xe.push(Ie);continue}if(Ie=this.tokenizer.tag(Ee)){Ee=Ee.substring(Ie.raw.length),Pe=xe[xe.length-1],Pe&&Ie.type==="text"&&Pe.type==="text"?(Pe.raw+=Ie.raw,Pe.text+=Ie.text):xe.push(Ie);continue}if(Ie=this.tokenizer.link(Ee)){Ee=Ee.substring(Ie.raw.length),xe.push(Ie);continue}if(Ie=this.tokenizer.reflink(Ee,this.tokens.links)){Ee=Ee.substring(Ie.raw.length),Pe=xe[xe.length-1],Pe&&Ie.type==="text"&&Pe.type==="text"?(Pe.raw+=Ie.raw,Pe.text+=Ie.text):xe.push(Ie);continue}if(Ie=this.tokenizer.emStrong(Ee,Ge,ht)){Ee=Ee.substring(Ie.raw.length),xe.push(Ie);continue}if(Ie=this.tokenizer.codespan(Ee)){Ee=Ee.substring(Ie.raw.length),xe.push(Ie);continue}if(Ie=this.tokenizer.br(Ee)){Ee=Ee.substring(Ie.raw.length),xe.push(Ie);continue}if(Ie=this.tokenizer.del(Ee)){Ee=Ee.substring(Ie.raw.length),xe.push(Ie);continue}if(Ie=this.tokenizer.autolink(Ee)){Ee=Ee.substring(Ie.raw.length),xe.push(Ie);continue}if(!this.state.inLink&&(Ie=this.tokenizer.url(Ee))){Ee=Ee.substring(Ie.raw.length),xe.push(Ie);continue}if($e=Ee,this.options.extensions&&this.options.extensions.startInline){let pt=1/0;const $t=Ee.slice(1);let Pt;this.options.extensions.startInline.forEach(Yt=>{Pt=Yt.call({lexer:this},$t),typeof Pt=="number"&&Pt>=0&&(pt=Math.min(pt,Pt))}),pt<1/0&&pt>=0&&($e=Ee.substring(0,pt+1))}if(Ie=this.tokenizer.inlineText($e)){Ee=Ee.substring(Ie.raw.length),Ie.raw.slice(-1)!=="_"&&(ht=Ie.raw.slice(-1)),ut=!0,Pe=xe[xe.length-1],Pe&&Pe.type==="text"?(Pe.raw+=Ie.raw,Pe.text+=Ie.text):xe.push(Ie);continue}if(Ee){const pt="Infinite loop on byte: "+Ee.charCodeAt(0);if(this.options.silent){console.error(pt);break}else throw new Error(pt)}}return xe}}class _e{options;parser;constructor(Ee){this.options=Ee||w.defaults}space(Ee){return""}code({text:Ee,lang:xe,escaped:Ie}){const Pe=(xe||"").match(/^\S*/)?.[0],$e=Ee.replace(/\n$/,"")+`
`;return Pe?'<pre><code class="language-'+Y(Pe)+'">'+(Ie?$e:Y($e,!0))+`</code></pre>
`:"<pre><code>"+(Ie?$e:Y($e,!0))+`</code></pre>
`}blockquote({tokens:Ee}){return`<blockquote>
${this.parser.parse(Ee)}</blockquote>
`}html({text:Ee}){return Ee}heading({tokens:Ee,depth:xe}){return`<h${xe}>${this.parser.parseInline(Ee)}</h${xe}>
`}hr(Ee){return`<hr>
`}list(Ee){const xe=Ee.ordered,Ie=Ee.start;let Pe="";for(let Xe=0;Xe<Ee.items.length;Xe++){const ut=Ee.items[Xe];Pe+=this.listitem(ut)}const $e=xe?"ol":"ul",Ge=xe&&Ie!==1?' start="'+Ie+'"':"";return"<"+$e+Ge+`>
`+Pe+"</"+$e+`>
`}listitem(Ee){let xe="";if(Ee.task){const Ie=this.checkbox({checked:!!Ee.checked});Ee.loose?Ee.tokens.length>0&&Ee.tokens[0].type==="paragraph"?(Ee.tokens[0].text=Ie+" "+Ee.tokens[0].text,Ee.tokens[0].tokens&&Ee.tokens[0].tokens.length>0&&Ee.tokens[0].tokens[0].type==="text"&&(Ee.tokens[0].tokens[0].text=Ie+" "+Ee.tokens[0].tokens[0].text)):Ee.tokens.unshift({type:"text",raw:Ie+" ",text:Ie+" "}):xe+=Ie+" "}return xe+=this.parser.parse(Ee.tokens,!!Ee.loose),`<li>${xe}</li>
`}checkbox({checked:Ee}){return"<input "+(Ee?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:Ee}){return`<p>${this.parser.parseInline(Ee)}</p>
`}table(Ee){let xe="",Ie="";for(let $e=0;$e<Ee.header.length;$e++)Ie+=this.tablecell(Ee.header[$e]);xe+=this.tablerow({text:Ie});let Pe="";for(let $e=0;$e<Ee.rows.length;$e++){const Ge=Ee.rows[$e];Ie="";for(let Xe=0;Xe<Ge.length;Xe++)Ie+=this.tablecell(Ge[Xe]);Pe+=this.tablerow({text:Ie})}return Pe&&(Pe=`<tbody>${Pe}</tbody>`),`<table>
<thead>
`+xe+`</thead>
`+Pe+`</table>
`}tablerow({text:Ee}){return`<tr>
${Ee}</tr>
`}tablecell(Ee){const xe=this.parser.parseInline(Ee.tokens),Ie=Ee.header?"th":"td";return(Ee.align?`<${Ie} align="${Ee.align}">`:`<${Ie}>`)+xe+`</${Ie}>
`}strong({tokens:Ee}){return`<strong>${this.parser.parseInline(Ee)}</strong>`}em({tokens:Ee}){return`<em>${this.parser.parseInline(Ee)}</em>`}codespan({text:Ee}){return`<code>${Ee}</code>`}br(Ee){return"<br>"}del({tokens:Ee}){return`<del>${this.parser.parseInline(Ee)}</del>`}link({href:Ee,title:xe,tokens:Ie}){const Pe=this.parser.parseInline(Ie),$e=te(Ee);if($e===null)return Pe;Ee=$e;let Ge='<a href="'+Ee+'"';return xe&&(Ge+=' title="'+xe+'"'),Ge+=">"+Pe+"</a>",Ge}image({href:Ee,title:xe,text:Ie}){const Pe=te(Ee);if(Pe===null)return Ie;Ee=Pe;let $e=`<img src="${Ee}" alt="${Ie}"`;return xe&&($e+=` title="${xe}"`),$e+=">",$e}text(Ee){return"tokens"in Ee&&Ee.tokens?this.parser.parseInline(Ee.tokens):Ee.text}}class ke{strong({text:Ee}){return Ee}em({text:Ee}){return Ee}codespan({text:Ee}){return Ee}del({text:Ee}){return Ee}html({text:Ee}){return Ee}text({text:Ee}){return Ee}link({text:Ee}){return""+Ee}image({text:Ee}){return""+Ee}br(){return""}}class Fe{options;renderer;textRenderer;constructor(Ee){this.options=Ee||w.defaults,this.options.renderer=this.options.renderer||new _e,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ke}static parse(Ee,xe){return new Fe(xe).parse(Ee)}static parseInline(Ee,xe){return new Fe(xe).parseInline(Ee)}parse(Ee,xe=!0){let Ie="";for(let Pe=0;Pe<Ee.length;Pe++){const $e=Ee[Pe];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[$e.type]){const Xe=$e,ut=this.options.extensions.renderers[Xe.type].call({parser:this},Xe);if(ut!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(Xe.type)){Ie+=ut||"";continue}}const Ge=$e;switch(Ge.type){case"space":{Ie+=this.renderer.space(Ge);continue}case"hr":{Ie+=this.renderer.hr(Ge);continue}case"heading":{Ie+=this.renderer.heading(Ge);continue}case"code":{Ie+=this.renderer.code(Ge);continue}case"table":{Ie+=this.renderer.table(Ge);continue}case"blockquote":{Ie+=this.renderer.blockquote(Ge);continue}case"list":{Ie+=this.renderer.list(Ge);continue}case"html":{Ie+=this.renderer.html(Ge);continue}case"paragraph":{Ie+=this.renderer.paragraph(Ge);continue}case"text":{let Xe=Ge,ut=this.renderer.text(Xe);for(;Pe+1<Ee.length&&Ee[Pe+1].type==="text";)Xe=Ee[++Pe],ut+=`
`+this.renderer.text(Xe);xe?Ie+=this.renderer.paragraph({type:"paragraph",raw:ut,text:ut,tokens:[{type:"text",raw:ut,text:ut}]}):Ie+=ut;continue}default:{const Xe='Token with "'+Ge.type+'" type was not found.';if(this.options.silent)return console.error(Xe),"";throw new Error(Xe)}}}return Ie}parseInline(Ee,xe){xe=xe||this.renderer;let Ie="";for(let Pe=0;Pe<Ee.length;Pe++){const $e=Ee[Pe];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[$e.type]){const Xe=this.options.extensions.renderers[$e.type].call({parser:this},$e);if(Xe!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes($e.type)){Ie+=Xe||"";continue}}const Ge=$e;switch(Ge.type){case"escape":{Ie+=xe.text(Ge);break}case"html":{Ie+=xe.html(Ge);break}case"link":{Ie+=xe.link(Ge);break}case"image":{Ie+=xe.image(Ge);break}case"strong":{Ie+=xe.strong(Ge);break}case"em":{Ie+=xe.em(Ge);break}case"codespan":{Ie+=xe.codespan(Ge);break}case"br":{Ie+=xe.br(Ge);break}case"del":{Ie+=xe.del(Ge);break}case"text":{Ie+=xe.text(Ge);break}default:{const Xe='Token with "'+Ge.type+'" type was not found.';if(this.options.silent)return console.error(Xe),"";throw new Error(Xe)}}}return Ie}}class qe{options;constructor(Ee){this.options=Ee||w.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(Ee){return Ee}postprocess(Ee){return Ee}processAllTokens(Ee){return Ee}}class tt{defaults=D();options=this.setOptions;parse=this.parseMarkdown(ge.lex,Fe.parse);parseInline=this.parseMarkdown(ge.lexInline,Fe.parseInline);Parser=Fe;Renderer=_e;TextRenderer=ke;Lexer=ge;Tokenizer=oe;Hooks=qe;constructor(...Ee){this.use(...Ee)}walkTokens(Ee,xe){let Ie=[];for(const Pe of Ee)switch(Ie=Ie.concat(xe.call(this,Pe)),Pe.type){case"table":{const $e=Pe;for(const Ge of $e.header)Ie=Ie.concat(this.walkTokens(Ge.tokens,xe));for(const Ge of $e.rows)for(const Xe of Ge)Ie=Ie.concat(this.walkTokens(Xe.tokens,xe));break}case"list":{const $e=Pe;Ie=Ie.concat(this.walkTokens($e.items,xe));break}default:{const $e=Pe;this.defaults.extensions?.childTokens?.[$e.type]?this.defaults.extensions.childTokens[$e.type].forEach(Ge=>{const Xe=$e[Ge].flat(1/0);Ie=Ie.concat(this.walkTokens(Xe,xe))}):$e.tokens&&(Ie=Ie.concat(this.walkTokens($e.tokens,xe)))}}return Ie}use(...Ee){const xe=this.defaults.extensions||{renderers:{},childTokens:{}};return Ee.forEach(Ie=>{const Pe={...Ie};if(Pe.async=this.defaults.async||Pe.async||!1,Ie.extensions&&(Ie.extensions.forEach($e=>{if(!$e.name)throw new Error("extension name required");if("renderer"in $e){const Ge=xe.renderers[$e.name];Ge?xe.renderers[$e.name]=function(...Xe){let ut=$e.renderer.apply(this,Xe);return ut===!1&&(ut=Ge.apply(this,Xe)),ut}:xe.renderers[$e.name]=$e.renderer}if("tokenizer"in $e){if(!$e.level||$e.level!=="block"&&$e.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const Ge=xe[$e.level];Ge?Ge.unshift($e.tokenizer):xe[$e.level]=[$e.tokenizer],$e.start&&($e.level==="block"?xe.startBlock?xe.startBlock.push($e.start):xe.startBlock=[$e.start]:$e.level==="inline"&&(xe.startInline?xe.startInline.push($e.start):xe.startInline=[$e.start]))}"childTokens"in $e&&$e.childTokens&&(xe.childTokens[$e.name]=$e.childTokens)}),Pe.extensions=xe),Ie.renderer){const $e=this.defaults.renderer||new _e(this.defaults);for(const Ge in Ie.renderer){if(!(Ge in $e))throw new Error(`renderer '${Ge}' does not exist`);if(["options","parser"].includes(Ge))continue;const Xe=Ge,ut=Ie.renderer[Xe],ht=$e[Xe];$e[Xe]=(...pt)=>{let $t=ut.apply($e,pt);return $t===!1&&($t=ht.apply($e,pt)),$t||""}}Pe.renderer=$e}if(Ie.tokenizer){const $e=this.defaults.tokenizer||new oe(this.defaults);for(const Ge in Ie.tokenizer){if(!(Ge in $e))throw new Error(`tokenizer '${Ge}' does not exist`);if(["options","rules","lexer"].includes(Ge))continue;const Xe=Ge,ut=Ie.tokenizer[Xe],ht=$e[Xe];$e[Xe]=(...pt)=>{let $t=ut.apply($e,pt);return $t===!1&&($t=ht.apply($e,pt)),$t}}Pe.tokenizer=$e}if(Ie.hooks){const $e=this.defaults.hooks||new qe;for(const Ge in Ie.hooks){if(!(Ge in $e))throw new Error(`hook '${Ge}' does not exist`);if(Ge==="options")continue;const Xe=Ge,ut=Ie.hooks[Xe],ht=$e[Xe];qe.passThroughHooks.has(Ge)?$e[Xe]=pt=>{if(this.defaults.async)return Promise.resolve(ut.call($e,pt)).then(Pt=>ht.call($e,Pt));const $t=ut.call($e,pt);return ht.call($e,$t)}:$e[Xe]=(...pt)=>{let $t=ut.apply($e,pt);return $t===!1&&($t=ht.apply($e,pt)),$t}}Pe.hooks=$e}if(Ie.walkTokens){const $e=this.defaults.walkTokens,Ge=Ie.walkTokens;Pe.walkTokens=function(Xe){let ut=[];return ut.push(Ge.call(this,Xe)),$e&&(ut=ut.concat($e.call(this,Xe))),ut}}this.defaults={...this.defaults,...Pe}}),this}setOptions(Ee){return this.defaults={...this.defaults,...Ee},this}lexer(Ee,xe){return ge.lex(Ee,xe??this.defaults)}parser(Ee,xe){return Fe.parse(Ee,xe??this.defaults)}parseMarkdown(Ee,xe){return(Pe,$e)=>{const Ge={...$e},Xe={...this.defaults,...Ge},ut=this.onError(!!Xe.silent,!!Xe.async);if(this.defaults.async===!0&&Ge.async===!1)return ut(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof Pe>"u"||Pe===null)return ut(new Error("marked(): input parameter is undefined or null"));if(typeof Pe!="string")return ut(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(Pe)+", string expected"));if(Xe.hooks&&(Xe.hooks.options=Xe),Xe.async)return Promise.resolve(Xe.hooks?Xe.hooks.preprocess(Pe):Pe).then(ht=>Ee(ht,Xe)).then(ht=>Xe.hooks?Xe.hooks.processAllTokens(ht):ht).then(ht=>Xe.walkTokens?Promise.all(this.walkTokens(ht,Xe.walkTokens)).then(()=>ht):ht).then(ht=>xe(ht,Xe)).then(ht=>Xe.hooks?Xe.hooks.postprocess(ht):ht).catch(ut);try{Xe.hooks&&(Pe=Xe.hooks.preprocess(Pe));let ht=Ee(Pe,Xe);Xe.hooks&&(ht=Xe.hooks.processAllTokens(ht)),Xe.walkTokens&&this.walkTokens(ht,Xe.walkTokens);let pt=xe(ht,Xe);return Xe.hooks&&(pt=Xe.hooks.postprocess(pt)),pt}catch(ht){return ut(ht)}}}onError(Ee,xe){return Ie=>{if(Ie.message+=`
Please report this to https://github.com/markedjs/marked.`,Ee){const Pe="<p>An error occurred:</p><pre>"+Y(Ie.message+"",!0)+"</pre>";return xe?Promise.resolve(Pe):Pe}if(xe)return Promise.reject(Ie);throw Ie}}}const It=new tt;function wt(xt,Ee){return It.parse(xt,Ee)}wt.options=wt.setOptions=function(xt){return It.setOptions(xt),wt.defaults=It.defaults,O(wt.defaults),wt},wt.getDefaults=D,wt.defaults=w.defaults,wt.use=function(...xt){return It.use(...xt),wt.defaults=It.defaults,O(wt.defaults),wt},wt.walkTokens=function(xt,Ee){return It.walkTokens(xt,Ee)},wt.parseInline=It.parseInline,wt.Parser=Fe,wt.parser=Fe.parse,wt.Renderer=_e,wt.TextRenderer=ke,wt.Lexer=ge,wt.lexer=ge.lex,wt.Tokenizer=oe,wt.Hooks=qe,wt.parse=wt;const Ht=wt.options,ri=wt.setOptions,qt=wt.use,di=wt.walkTokens,Zi=wt.parseInline,On=wt,Pn=Fe.parse,Cn=ge.lex;w.Hooks=qe,w.Lexer=ge,w.Marked=tt,w.Parser=Fe,w.Renderer=_e,w.TextRenderer=ke,w.Tokenizer=oe,w.getDefaults=D,w.lexer=Cn,w.marked=wt,w.options=Ht,w.parse=On,w.parseInline=Zi,w.parser=Pn,w.setOptions=ri,w.use=qt,w.walkTokens=di})})();__marked_exports.Hooks||exports.Hooks;__marked_exports.Lexer||exports.Lexer;__marked_exports.Marked||exports.Marked;__marked_exports.Parser||exports.Parser;var Renderer=__marked_exports.Renderer||exports.Renderer;__marked_exports.TextRenderer||exports.TextRenderer;__marked_exports.Tokenizer||exports.Tokenizer;var defaults=__marked_exports.defaults||exports.defaults;__marked_exports.getDefaults||exports.getDefaults;var lexer=__marked_exports.lexer||exports.lexer;__marked_exports.marked||exports.marked;__marked_exports.options||exports.options;var parse$2=__marked_exports.parse||exports.parse;__marked_exports.parseInline||exports.parseInline;var parser=__marked_exports.parser||exports.parser;__marked_exports.setOptions||exports.setOptions;__marked_exports.use||exports.use;__marked_exports.walkTokens||exports.walkTokens;function stringify(F){return JSON.stringify(F,replacer)}function parse$1(F){let w=JSON.parse(F);return w=revive(w),w}function replacer(F,w){return w instanceof RegExp?{$mid:2,source:w.source,flags:w.flags}:w}function revive(F,w=0){if(!F||w>200)return F;if(typeof F=="object"){switch(F.$mid){case 1:return URI.revive(F);case 2:return new RegExp(F.source,F.flags);case 17:return new Date(F.source)}if(F instanceof VSBuffer||F instanceof Uint8Array)return F;if(Array.isArray(F))for(let D=0;D<F.length;++D)F[D]=revive(F[D],w+1);else for(const D in F)Object.hasOwnProperty.call(F,D)&&(F[D]=revive(F[D],w+1))}return F}function deepClone(F){if(!F||typeof F!="object"||F instanceof RegExp)return F;const w=Array.isArray(F)?[]:{};return Object.entries(F).forEach(([D,O])=>{w[D]=O&&typeof O=="object"?deepClone(O):O}),w}function deepFreeze(F){if(!F||typeof F!="object")return F;const w=[F];for(;w.length>0;){const D=w.shift();Object.freeze(D);for(const O in D)if(_hasOwnProperty$4.call(D,O)){const W=D[O];typeof W=="object"&&!Object.isFrozen(W)&&!isTypedArray(W)&&w.push(W)}}return F}const _hasOwnProperty$4=Object.prototype.hasOwnProperty;function cloneAndChange(F,w){return _cloneAndChange(F,w,new Set)}function _cloneAndChange(F,w,D){if(isUndefinedOrNull(F))return F;const O=w(F);if(typeof O<"u")return O;if(Array.isArray(F)){const W=[];for(const U of F)W.push(_cloneAndChange(U,w,D));return W}if(isObject$1(F)){if(D.has(F))throw new Error("Cannot clone recursive data-structure");D.add(F);const W={};for(const U in F)_hasOwnProperty$4.call(F,U)&&(W[U]=_cloneAndChange(F[U],w,D));return D.delete(F),W}return F}function mixin(F,w,D=!0){return isObject$1(F)?(isObject$1(w)&&Object.keys(w).forEach(O=>{O in F?D&&(isObject$1(F[O])&&isObject$1(w[O])?mixin(F[O],w[O],D):F[O]=w[O]):F[O]=w[O]}),F):w}function equals(F,w){if(F===w)return!0;if(F==null||w===null||w===void 0||typeof F!=typeof w||typeof F!="object"||Array.isArray(F)!==Array.isArray(w))return!1;let D,O;if(Array.isArray(F)){if(F.length!==w.length)return!1;for(D=0;D<F.length;D++)if(!equals(F[D],w[D]))return!1}else{const W=[];for(O in F)W.push(O);W.sort();const U=[];for(O in w)U.push(O);if(U.sort(),!equals(W,U))return!1;for(D=0;D<W.length;D++)if(!equals(F[W[D]],w[W[D]]))return!1}return!0}function getAllPropertyNames(F){let w=[];for(;Object.prototype!==F;)w=w.concat(Object.getOwnPropertyNames(F)),F=Object.getPrototypeOf(F);return w}function getAllMethodNames(F){const w=[];for(const D of getAllPropertyNames(F))typeof F[D]=="function"&&w.push(D);return w}function createProxyObject(F,w){const D=W=>function(){const U=Array.prototype.slice.call(arguments,0);return w(W,U)},O={};for(const W of F)O[W]=D(W);return O}const defaultMarkedRenderers=Object.freeze({image:({href:F,title:w,text:D})=>{let O=[],W=[];return F&&({href:F,dimensions:O}=parseHrefAndDimensions(F),W.push(`src="${escapeDoubleQuotes(F)}"`)),D&&W.push(`alt="${escapeDoubleQuotes(D)}"`),w&&W.push(`title="${escapeDoubleQuotes(w)}"`),O.length&&(W=W.concat(O)),"<img "+W.join(" ")+">"},paragraph({tokens:F}){return`<p>${this.parser.parseInline(F)}</p>`},link({href:F,title:w,tokens:D}){let O=this.parser.parseInline(D);return typeof F!="string"?"":(F===O&&(O=removeMarkdownEscapes(O)),w=typeof w=="string"?escapeDoubleQuotes(removeMarkdownEscapes(w)):"",F=removeMarkdownEscapes(F),F=F.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${F}" title="${w||F}" draggable="false">${O}</a>`)}});function renderMarkdown(F,w={},D={}){const O=new DisposableStore;let W=!1;const U=createElement(w),K=function(se){let re;try{re=parse$1(decodeURIComponent(se))}catch{}return re?(re=cloneAndChange(re,ae=>{if(F.uris&&F.uris[ae])return URI.revive(F.uris[ae])}),encodeURIComponent(JSON.stringify(re))):se},q=function(se,re){const ae=F.uris&&F.uris[se];let le=URI.revive(ae);return re?se.startsWith(Schemas.data+":")?se:(le||(le=URI.parse(se)),FileAccess.uriToBrowserUri(le).toString(!0)):!le||URI.parse(se).toString()===le.toString()?se:(le.query&&(le=le.with({query:K(le.query)})),le.toString())},G=new Renderer;G.image=defaultMarkedRenderers.image,G.link=defaultMarkedRenderers.link,G.paragraph=defaultMarkedRenderers.paragraph;const Q=[],Y=[];if(w.codeBlockRendererSync?G.code=({text:se,lang:re})=>{const ae=defaultGenerator.nextId(),le=w.codeBlockRendererSync(postProcessCodeBlockLanguageId(re),se);return Y.push([ae,le]),`<div class="code" data-code="${ae}">${escape(se)}</div>`}:w.codeBlockRenderer&&(G.code=({text:se,lang:re})=>{const ae=defaultGenerator.nextId(),le=w.codeBlockRenderer(postProcessCodeBlockLanguageId(re),se);return Q.push(le.then(de=>[ae,de])),`<div class="code" data-code="${ae}">${escape(se)}</div>`}),w.actionHandler){const se=function(le){let de=le.target;if(!(de.tagName!=="A"&&(de=de.parentElement,!de||de.tagName!=="A")))try{let oe=de.dataset.href;oe&&(F.baseUri&&(oe=resolveWithBaseUri(URI.from(F.baseUri),oe)),w.actionHandler.callback(oe,le))}catch(oe){onUnexpectedError(oe)}finally{le.preventDefault()}},re=w.actionHandler.disposables.add(new DomEmitter(U,"click")),ae=w.actionHandler.disposables.add(new DomEmitter(U,"auxclick"));w.actionHandler.disposables.add(Event$1.any(re.event,ae.event)(le=>{const de=new StandardMouseEvent(getWindow(U),le);!de.leftButton&&!de.middleButton||se(de)})),w.actionHandler.disposables.add(addDisposableListener(U,"keydown",le=>{const de=new StandardKeyboardEvent(le);!de.equals(10)&&!de.equals(3)||se(de)}))}F.supportHtml||(G.html=({text:se})=>w.sanitizerOptions?.replaceWithPlaintext?escape(se):(F.isTrusted?se.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?se:""),D.renderer=G;let X=F.value??"";X.length>1e5&&(X=`${X.substr(0,1e5)}…`),F.supportThemeIcons&&(X=markdownEscapeEscapedIcons(X));let J;if(w.fillInIncompleteTokens){const se={...defaults,...D},re=lexer(X,se),ae=fillInIncompleteTokens(re);J=parser(ae,se)}else J=parse$2(X,{...D,async:!1});F.supportThemeIcons&&(J=renderLabelWithIcons(J).map(re=>typeof re=="string"?re:re.outerHTML).join(""));const ie=new DOMParser().parseFromString(sanitizeRenderedMarkdown({isTrusted:F.isTrusted,...w.sanitizerOptions},J),"text/html");if(ie.body.querySelectorAll("img, audio, video, source").forEach(se=>{const re=se.getAttribute("src");if(re){let ae=re;try{F.baseUri&&(ae=resolveWithBaseUri(URI.from(F.baseUri),ae))}catch{}if(se.setAttribute("src",q(ae,!0)),w.remoteImageIsAllowed){const le=URI.parse(ae);le.scheme!==Schemas.file&&le.scheme!==Schemas.data&&!w.remoteImageIsAllowed(le)&&se.replaceWith($$8("",void 0,se.outerHTML))}}}),ie.body.querySelectorAll("a").forEach(se=>{const re=se.getAttribute("href");if(se.setAttribute("href",""),!re||/^data:|javascript:/i.test(re)||/^command:/i.test(re)&&!F.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(re))se.replaceWith(...se.childNodes);else{let ae=q(re,!1);F.baseUri&&(ae=resolveWithBaseUri(URI.from(F.baseUri),re)),se.dataset.href=ae}}),U.innerHTML=sanitizeRenderedMarkdown({isTrusted:F.isTrusted,...w.sanitizerOptions},ie.body.innerHTML),Q.length>0)Promise.all(Q).then(se=>{if(W)return;const re=new Map(se),ae=U.querySelectorAll("div[data-code]");for(const le of ae){const de=re.get(le.dataset.code??"");de&&reset(le,de)}w.asyncRenderCallback?.()});else if(Y.length>0){const se=new Map(Y),re=U.querySelectorAll("div[data-code]");for(const ae of re){const le=se.get(ae.dataset.code??"");le&&reset(ae,le)}}if(w.asyncRenderCallback)for(const se of U.getElementsByTagName("img")){const re=O.add(addDisposableListener(se,"load",()=>{re.dispose(),w.asyncRenderCallback()}))}return{element:U,dispose:()=>{W=!0,O.dispose()}}}function postProcessCodeBlockLanguageId(F){if(!F)return"";const w=F.split(/[\s+|:|,|\{|\?]/,1);return w.length?w[0]:F}function resolveWithBaseUri(F,w){return/^\w[\w\d+.-]*:/.test(w)?w:F.path.endsWith("/")?resolvePath(F,w).toString():resolvePath(dirname(F),w).toString()}const selfClosingTags=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function sanitizeRenderedMarkdown(F,w){const{config:D,allowedSchemes:O}=getSanitizerOptions(F),W=new DisposableStore;W.add(addDompurifyHook("uponSanitizeAttribute",(U,K)=>{if(K.attrName==="style"||K.attrName==="class"){if(U.tagName==="SPAN"){if(K.attrName==="style"){K.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(border-radius:[0-9]+px;)?$/.test(K.attrValue);return}else if(K.attrName==="class"){K.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(K.attrValue);return}}K.keepAttr=!1;return}else if(U.tagName==="INPUT"&&U.attributes.getNamedItem("type")?.value==="checkbox"){if(K.attrName==="type"&&K.attrValue==="checkbox"||K.attrName==="disabled"||K.attrName==="checked"){K.keepAttr=!0;return}K.keepAttr=!1}})),W.add(addDompurifyHook("uponSanitizeElement",(U,K)=>{if(K.tagName==="input"&&(U.attributes.getNamedItem("type")?.value==="checkbox"?U.setAttribute("disabled",""):F.replaceWithPlaintext||U.remove()),F.replaceWithPlaintext&&!K.allowedTags[K.tagName]&&K.tagName!=="body"&&U.parentElement){let q,G;if(K.tagName==="#comment")q=`<!--${U.textContent}-->`;else{const J=selfClosingTags.includes(K.tagName),te=U.attributes.length?" "+Array.from(U.attributes).map(ie=>`${ie.name}="${ie.value}"`).join(" "):"";q=`<${K.tagName}${te}>`,J||(G=`</${K.tagName}>`)}const Q=document.createDocumentFragment(),Y=U.parentElement.ownerDocument.createTextNode(q);Q.appendChild(Y);const X=G?U.parentElement.ownerDocument.createTextNode(G):void 0;for(;U.firstChild;)Q.appendChild(U.firstChild);X&&Q.appendChild(X),U.nodeType===Node.COMMENT_NODE?U.parentElement.insertBefore(Q,U):U.parentElement.replaceChild(Q,U)}})),W.add(hookDomPurifyHrefAndSrcSanitizer(O));try{return sanitize$1(w,{...D,RETURN_TRUSTED_TYPE:!0})}finally{W.dispose()}}const allowedMarkdownAttr=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function getSanitizerOptions(F){const w=[Schemas.http,Schemas.https,Schemas.mailto,Schemas.data,Schemas.file,Schemas.vscodeFileResource,Schemas.vscodeRemote,Schemas.vscodeRemoteResource];return F.isTrusted&&w.push(Schemas.command),{config:{ALLOWED_TAGS:F.allowedTags??[...basicMarkupHtmlTags],ALLOWED_ATTR:allowedMarkdownAttr,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:w}}function renderStringAsPlaintext(F){return typeof F=="string"?F:renderMarkdownAsPlaintext(F)}function renderMarkdownAsPlaintext(F,w){let D=F.value??"";D.length>1e5&&(D=`${D.substr(0,1e5)}…`);const O=parse$2(D,{async:!1,renderer:plainTextRenderer.value}).replace(/&(#\d+|[a-zA-Z]+);/g,W=>unescapeInfo.get(W)??W);return sanitizeRenderedMarkdown({isTrusted:!1},O).toString()}const unescapeInfo=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]);function createRenderer(){const F=new Renderer;return F.code=({text:w})=>w,F.blockquote=({text:w})=>w+`
`,F.html=w=>"",F.heading=function({tokens:w}){return this.parser.parseInline(w)+`
`},F.hr=()=>"",F.list=function({items:w}){return w.map(D=>this.listitem(D)).join(`
`)+`
`},F.listitem=({text:w})=>w+`
`,F.paragraph=function({tokens:w}){return this.parser.parseInline(w)+`
`},F.table=function({header:w,rows:D}){return w.map(O=>this.tablecell(O)).join(" ")+`
`+D.map(O=>O.map(W=>this.tablecell(W)).join(" ")).join(`
`)+`
`},F.tablerow=({text:w})=>w,F.tablecell=function({tokens:w}){return this.parser.parseInline(w)},F.strong=({text:w})=>w,F.em=({text:w})=>w,F.codespan=({text:w})=>w,F.br=w=>`
`,F.del=({text:w})=>w,F.image=w=>"",F.text=({text:w})=>w,F.link=({text:w})=>w,F}const plainTextRenderer=new Lazy(F=>createRenderer());function mergeRawTokenText(F){let w="";return F.forEach(D=>{w+=D.raw}),w}function completeSingleLinePattern(F){if(F.tokens)for(let w=F.tokens.length-1;w>=0;w--){const D=F.tokens[w];if(D.type==="text"){const O=D.raw.split(`
`),W=O[O.length-1];if(W.includes("`"))return completeCodespan(F);if(W.includes("**"))return completeDoublestar(F);if(W.match(/\*\w/))return completeStar(F);if(W.match(/(^|\s)__\w/))return completeDoubleUnderscore(F);if(W.match(/(^|\s)_\w/))return completeUnderscore(F);if(hasLinkTextAndStartOfLinkTarget(W)||hasStartOfLinkTargetAndNoLinkText(W)&&F.tokens.slice(0,w).some(U=>U.type==="text"&&U.raw.match(/\[[^\]]*$/))){const U=F.tokens.slice(w+1);return U[0]?.type==="link"&&U[1]?.type==="text"&&U[1].raw.match(/^ *"[^"]*$/)||W.match(/^[^"]* +"[^"]*$/)?completeLinkTargetArg(F):completeLinkTarget(F)}else if(W.match(/(^|\s)\[\w*/))return completeLinkText(F)}}}function hasLinkTextAndStartOfLinkTarget(F){return!!F.match(/(^|\s)\[.*\]\(\w*/)}function hasStartOfLinkTargetAndNoLinkText(F){return!!F.match(/^[^\[]*\]\([^\)]*$/)}function completeListItemPattern(F){const w=F.items[F.items.length-1],D=w.tokens?w.tokens[w.tokens.length-1]:void 0;let O;if(D?.type==="text"&&!("inRawBlock"in w)&&(O=completeSingleLinePattern(D)),!O||O.type!=="paragraph")return;const W=mergeRawTokenText(F.items.slice(0,-1)),U=w.raw.match(/^(\s*(-|\d+\.|\*) +)/)?.[0];if(!U)return;const K=U+mergeRawTokenText(w.tokens.slice(0,-1))+O.raw,q=lexer(W+K)[0];if(q.type==="list")return q}const maxIncompleteTokensFixRounds=3;function fillInIncompleteTokens(F){for(let w=0;w<maxIncompleteTokensFixRounds;w++){const D=fillInIncompleteTokensOnce(F);if(D)F=D;else break}return F}function fillInIncompleteTokensOnce(F){let w,D;for(w=0;w<F.length;w++){const O=F[w];if(O.type==="paragraph"&&O.raw.match(/(\n|^)\|/)){D=completeTable(F.slice(w));break}if(w===F.length-1&&O.type==="list"){const W=completeListItemPattern(O);if(W){D=[W];break}}if(w===F.length-1&&O.type==="paragraph"){const W=completeSingleLinePattern(O);if(W){D=[W];break}}}if(D){const O=[...F.slice(0,w),...D];return O.links=F.links,O}return null}function completeCodespan(F){return completeWithString(F,"`")}function completeStar(F){return completeWithString(F,"*")}function completeUnderscore(F){return completeWithString(F,"_")}function completeLinkTarget(F){return completeWithString(F,")")}function completeLinkTargetArg(F){return completeWithString(F,'")')}function completeLinkText(F){return completeWithString(F,"](https://microsoft.com)")}function completeDoublestar(F){return completeWithString(F,"**")}function completeDoubleUnderscore(F){return completeWithString(F,"__")}function completeWithString(F,w){const D=mergeRawTokenText(Array.isArray(F)?F:[F]);return lexer(D+w)[0]}function completeTable(F){const w=mergeRawTokenText(F),D=w.split(`
`);let O,W=!1;for(let U=0;U<D.length;U++){const K=D[U].trim();if(typeof O>"u"&&K.match(/^\s*\|/)){const q=K.match(/(\|[^\|]+)(?=\||$)/g);q&&(O=q.length)}else if(typeof O=="number")if(K.match(/^\s*\|/)){if(U!==D.length-1)return;W=!0}else return}if(typeof O=="number"&&O>0){const U=W?D.slice(0,-1).join(`
`):w,K=!!U.match(/\|\s*$/),q=U+(K?"":"|")+`
|${" --- |".repeat(O)}`;return lexer(q)}}function addDompurifyHook(F,w){return addHook(F,w),toDisposable(()=>removeHook(F))}class CombinedSpliceable{constructor(w){this.spliceables=w}splice(w,D,O){this.spliceables.forEach(W=>W.splice(w,D,O))}}function roundFloat(F,w){const D=Math.pow(10,w);return Math.round(F*D)/D}class RGBA{constructor(w,D,O,W=1){this._rgbaBrand=void 0,this.r=Math.min(255,Math.max(0,w))|0,this.g=Math.min(255,Math.max(0,D))|0,this.b=Math.min(255,Math.max(0,O))|0,this.a=roundFloat(Math.max(Math.min(1,W),0),3)}static equals(w,D){return w.r===D.r&&w.g===D.g&&w.b===D.b&&w.a===D.a}}class HSLA{constructor(w,D,O,W){this._hslaBrand=void 0,this.h=Math.max(Math.min(360,w),0)|0,this.s=roundFloat(Math.max(Math.min(1,D),0),3),this.l=roundFloat(Math.max(Math.min(1,O),0),3),this.a=roundFloat(Math.max(Math.min(1,W),0),3)}static equals(w,D){return w.h===D.h&&w.s===D.s&&w.l===D.l&&w.a===D.a}static fromRGBA(w){const D=w.r/255,O=w.g/255,W=w.b/255,U=w.a,K=Math.max(D,O,W),q=Math.min(D,O,W);let G=0,Q=0;const Y=(q+K)/2,X=K-q;if(X>0){switch(Q=Math.min(Y<=.5?X/(2*Y):X/(2-2*Y),1),K){case D:G=(O-W)/X+(O<W?6:0);break;case O:G=(W-D)/X+2;break;case W:G=(D-O)/X+4;break}G*=60,G=Math.round(G)}return new HSLA(G,Q,Y,U)}static _hue2rgb(w,D,O){return O<0&&(O+=1),O>1&&(O-=1),O<1/6?w+(D-w)*6*O:O<1/2?D:O<2/3?w+(D-w)*(2/3-O)*6:w}static toRGBA(w){const D=w.h/360,{s:O,l:W,a:U}=w;let K,q,G;if(O===0)K=q=G=W;else{const Q=W<.5?W*(1+O):W+O-W*O,Y=2*W-Q;K=HSLA._hue2rgb(Y,Q,D+1/3),q=HSLA._hue2rgb(Y,Q,D),G=HSLA._hue2rgb(Y,Q,D-1/3)}return new RGBA(Math.round(K*255),Math.round(q*255),Math.round(G*255),U)}}class HSVA{constructor(w,D,O,W){this._hsvaBrand=void 0,this.h=Math.max(Math.min(360,w),0)|0,this.s=roundFloat(Math.max(Math.min(1,D),0),3),this.v=roundFloat(Math.max(Math.min(1,O),0),3),this.a=roundFloat(Math.max(Math.min(1,W),0),3)}static equals(w,D){return w.h===D.h&&w.s===D.s&&w.v===D.v&&w.a===D.a}static fromRGBA(w){const D=w.r/255,O=w.g/255,W=w.b/255,U=Math.max(D,O,W),K=Math.min(D,O,W),q=U-K,G=U===0?0:q/U;let Q;return q===0?Q=0:U===D?Q=((O-W)/q%6+6)%6:U===O?Q=(W-D)/q+2:Q=(D-O)/q+4,new HSVA(Math.round(Q*60),G,U,w.a)}static toRGBA(w){const{h:D,s:O,v:W,a:U}=w,K=W*O,q=K*(1-Math.abs(D/60%2-1)),G=W-K;let[Q,Y,X]=[0,0,0];return D<60?(Q=K,Y=q):D<120?(Q=q,Y=K):D<180?(Y=K,X=q):D<240?(Y=q,X=K):D<300?(Q=q,X=K):D<=360&&(Q=K,X=q),Q=Math.round((Q+G)*255),Y=Math.round((Y+G)*255),X=Math.round((X+G)*255),new RGBA(Q,Y,X,U)}}class Color{static fromHex(w){return Color.Format.CSS.parseHex(w)||Color.red}static equals(w,D){return!w&&!D?!0:!w||!D?!1:w.equals(D)}get hsla(){return this._hsla?this._hsla:HSLA.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:HSVA.fromRGBA(this.rgba)}constructor(w){if(w)if(w instanceof RGBA)this.rgba=w;else if(w instanceof HSLA)this._hsla=w,this.rgba=HSLA.toRGBA(w);else if(w instanceof HSVA)this._hsva=w,this.rgba=HSVA.toRGBA(w);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(w){return!!w&&RGBA.equals(this.rgba,w.rgba)&&HSLA.equals(this.hsla,w.hsla)&&HSVA.equals(this.hsva,w.hsva)}getRelativeLuminance(){const w=Color._relativeLuminanceForComponent(this.rgba.r),D=Color._relativeLuminanceForComponent(this.rgba.g),O=Color._relativeLuminanceForComponent(this.rgba.b),W=.2126*w+.7152*D+.0722*O;return roundFloat(W,4)}static _relativeLuminanceForComponent(w){const D=w/255;return D<=.03928?D/12.92:Math.pow((D+.055)/1.055,2.4)}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(w){const D=this.getRelativeLuminance(),O=w.getRelativeLuminance();return D>O}isDarkerThan(w){const D=this.getRelativeLuminance(),O=w.getRelativeLuminance();return D<O}lighten(w){return new Color(new HSLA(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*w,this.hsla.a))}darken(w){return new Color(new HSLA(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*w,this.hsla.a))}transparent(w){const{r:D,g:O,b:W,a:U}=this.rgba;return new Color(new RGBA(D,O,W,U*w))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new Color(new RGBA(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}makeOpaque(w){if(this.isOpaque()||w.rgba.a!==1)return this;const{r:D,g:O,b:W,a:U}=this.rgba;return new Color(new RGBA(w.rgba.r-U*(w.rgba.r-D),w.rgba.g-U*(w.rgba.g-O),w.rgba.b-U*(w.rgba.b-W),1))}toString(){return this._toString||(this._toString=Color.Format.CSS.format(this)),this._toString}static getLighterColor(w,D,O){if(w.isLighterThan(D))return w;O=O||.5;const W=w.getRelativeLuminance(),U=D.getRelativeLuminance();return O=O*(U-W)/U,w.lighten(O)}static getDarkerColor(w,D,O){if(w.isDarkerThan(D))return w;O=O||.5;const W=w.getRelativeLuminance(),U=D.getRelativeLuminance();return O=O*(W-U)/W,w.darken(O)}static{this.white=new Color(new RGBA(255,255,255,1))}static{this.black=new Color(new RGBA(0,0,0,1))}static{this.red=new Color(new RGBA(255,0,0,1))}static{this.blue=new Color(new RGBA(0,0,255,1))}static{this.green=new Color(new RGBA(0,255,0,1))}static{this.cyan=new Color(new RGBA(0,255,255,1))}static{this.lightgrey=new Color(new RGBA(211,211,211,1))}static{this.transparent=new Color(new RGBA(0,0,0,0))}}(function(F){(function(w){(function(D){function O(te){return te.rgba.a===1?`rgb(${te.rgba.r}, ${te.rgba.g}, ${te.rgba.b})`:F.Format.CSS.formatRGBA(te)}D.formatRGB=O;function W(te){return`rgba(${te.rgba.r}, ${te.rgba.g}, ${te.rgba.b}, ${+te.rgba.a.toFixed(2)})`}D.formatRGBA=W;function U(te){return te.hsla.a===1?`hsl(${te.hsla.h}, ${(te.hsla.s*100).toFixed(2)}%, ${(te.hsla.l*100).toFixed(2)}%)`:F.Format.CSS.formatHSLA(te)}D.formatHSL=U;function K(te){return`hsla(${te.hsla.h}, ${(te.hsla.s*100).toFixed(2)}%, ${(te.hsla.l*100).toFixed(2)}%, ${te.hsla.a.toFixed(2)})`}D.formatHSLA=K;function q(te){const ie=te.toString(16);return ie.length!==2?"0"+ie:ie}function G(te){return`#${q(te.rgba.r)}${q(te.rgba.g)}${q(te.rgba.b)}`}D.formatHex=G;function Q(te,ie=!1){return ie&&te.rgba.a===1?F.Format.CSS.formatHex(te):`#${q(te.rgba.r)}${q(te.rgba.g)}${q(te.rgba.b)}${q(Math.round(te.rgba.a*255))}`}D.formatHexA=Q;function Y(te){return te.isOpaque()?F.Format.CSS.formatHex(te):F.Format.CSS.formatRGBA(te)}D.format=Y;function X(te){const ie=te.length;if(ie===0||te.charCodeAt(0)!==35)return null;if(ie===7){const se=16*J(te.charCodeAt(1))+J(te.charCodeAt(2)),re=16*J(te.charCodeAt(3))+J(te.charCodeAt(4)),ae=16*J(te.charCodeAt(5))+J(te.charCodeAt(6));return new F(new RGBA(se,re,ae,1))}if(ie===9){const se=16*J(te.charCodeAt(1))+J(te.charCodeAt(2)),re=16*J(te.charCodeAt(3))+J(te.charCodeAt(4)),ae=16*J(te.charCodeAt(5))+J(te.charCodeAt(6)),le=16*J(te.charCodeAt(7))+J(te.charCodeAt(8));return new F(new RGBA(se,re,ae,le/255))}if(ie===4){const se=J(te.charCodeAt(1)),re=J(te.charCodeAt(2)),ae=J(te.charCodeAt(3));return new F(new RGBA(16*se+se,16*re+re,16*ae+ae))}if(ie===5){const se=J(te.charCodeAt(1)),re=J(te.charCodeAt(2)),ae=J(te.charCodeAt(3)),le=J(te.charCodeAt(4));return new F(new RGBA(16*se+se,16*re+re,16*ae+ae,(16*le+le)/255))}return null}D.parseHex=X;function J(te){switch(te){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(w.CSS||(w.CSS={}))})(F.Format||(F.Format={}))})(Color||(Color={}));function clamp(F,w,D){return Math.min(Math.max(F,w),D)}class MovingAverage{constructor(){this._n=1,this._val=0}update(w){return this._val=this._val+(w-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}}class SlidingWindowAverage{constructor(w){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(w),this._values.fill(0,0,w)}update(w){const D=this._values[this._index];return this._values[this._index]=w,this._index=(this._index+1)%this._values.length,this._sum-=D,this._sum+=w,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}class ListError extends Error{constructor(w,D){super(`ListError [${w}] ${D}`)}}class FastDomNode{constructor(w){this.domNode=w,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingLeft="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(w){const D=numberAsPixels(w);this._maxWidth!==D&&(this._maxWidth=D,this.domNode.style.maxWidth=this._maxWidth)}setWidth(w){const D=numberAsPixels(w);this._width!==D&&(this._width=D,this.domNode.style.width=this._width)}setHeight(w){const D=numberAsPixels(w);this._height!==D&&(this._height=D,this.domNode.style.height=this._height)}setTop(w){const D=numberAsPixels(w);this._top!==D&&(this._top=D,this.domNode.style.top=this._top)}setLeft(w){const D=numberAsPixels(w);this._left!==D&&(this._left=D,this.domNode.style.left=this._left)}setBottom(w){const D=numberAsPixels(w);this._bottom!==D&&(this._bottom=D,this.domNode.style.bottom=this._bottom)}setRight(w){const D=numberAsPixels(w);this._right!==D&&(this._right=D,this.domNode.style.right=this._right)}setPaddingLeft(w){const D=numberAsPixels(w);this._paddingLeft!==D&&(this._paddingLeft=D,this.domNode.style.paddingLeft=this._paddingLeft)}setFontFamily(w){this._fontFamily!==w&&(this._fontFamily=w,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(w){this._fontWeight!==w&&(this._fontWeight=w,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(w){const D=numberAsPixels(w);this._fontSize!==D&&(this._fontSize=D,this.domNode.style.fontSize=this._fontSize)}setFontStyle(w){this._fontStyle!==w&&(this._fontStyle=w,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(w){this._fontFeatureSettings!==w&&(this._fontFeatureSettings=w,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(w){this._fontVariationSettings!==w&&(this._fontVariationSettings=w,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(w){this._textDecoration!==w&&(this._textDecoration=w,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(w){const D=numberAsPixels(w);this._lineHeight!==D&&(this._lineHeight=D,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(w){const D=numberAsPixels(w);this._letterSpacing!==D&&(this._letterSpacing=D,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(w){this._className!==w&&(this._className=w,this.domNode.className=this._className)}toggleClassName(w,D){this.domNode.classList.toggle(w,D),this._className=this.domNode.className}setDisplay(w){this._display!==w&&(this._display=w,this.domNode.style.display=this._display)}setPosition(w){this._position!==w&&(this._position=w,this.domNode.style.position=this._position)}setVisibility(w){this._visibility!==w&&(this._visibility=w,this.domNode.style.visibility=this._visibility)}setColor(w){this._color!==w&&(this._color=w,this.domNode.style.color=this._color)}setBackgroundColor(w){this._backgroundColor!==w&&(this._backgroundColor=w,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(w){this._layerHint!==w&&(this._layerHint=w,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(w){this._boxShadow!==w&&(this._boxShadow=w,this.domNode.style.boxShadow=w)}setContain(w){this._contain!==w&&(this._contain=w,this.domNode.style.contain=this._contain)}setAttribute(w,D){this.domNode.setAttribute(w,D)}removeAttribute(w){this.domNode.removeAttribute(w)}appendChild(w){this.domNode.appendChild(w.domNode)}removeChild(w){this.domNode.removeChild(w.domNode)}}function numberAsPixels(F){return typeof F=="number"?`${F}px`:F}function createFastDomNode(F){return new FastDomNode(F)}class GlobalPointerMoveMonitor{constructor(){this._hooks=new DisposableStore,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(w,D){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const O=this._onStopCallback;this._onStopCallback=null,w&&O&&O(D)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(w,D,O,W,U){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=W,this._onStopCallback=U;let K=w;try{w.setPointerCapture(D),this._hooks.add(toDisposable(()=>{try{w.releasePointerCapture(D)}catch{}}))}catch{K=getWindow(w)}this._hooks.add(addDisposableListener(K,EventType$1.POINTER_MOVE,q=>{if(q.buttons!==O){this.stopMonitoring(!0);return}q.preventDefault(),this._pointerMoveCallback(q)})),this._hooks.add(addDisposableListener(K,EventType$1.POINTER_UP,q=>this.stopMonitoring(!0)))}}const ARROW_IMG_SIZE=11;class ScrollbarArrow extends Widget$1{constructor(w){super(),this._onActivate=w.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=w.bgWidth+"px",this.bgDomNode.style.height=w.bgHeight+"px",typeof w.top<"u"&&(this.bgDomNode.style.top="0px"),typeof w.left<"u"&&(this.bgDomNode.style.left="0px"),typeof w.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof w.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=w.className,this.domNode.classList.add(...ThemeIcon.asClassNameArray(w.icon)),this.domNode.style.position="absolute",this.domNode.style.width=ARROW_IMG_SIZE+"px",this.domNode.style.height=ARROW_IMG_SIZE+"px",typeof w.top<"u"&&(this.domNode.style.top=w.top+"px"),typeof w.left<"u"&&(this.domNode.style.left=w.left+"px"),typeof w.bottom<"u"&&(this.domNode.style.bottom=w.bottom+"px"),typeof w.right<"u"&&(this.domNode.style.right=w.right+"px"),this._pointerMoveMonitor=this._register(new GlobalPointerMoveMonitor),this._register(addStandardDisposableListener(this.bgDomNode,EventType$1.POINTER_DOWN,D=>this._arrowPointerDown(D))),this._register(addStandardDisposableListener(this.domNode,EventType$1.POINTER_DOWN,D=>this._arrowPointerDown(D))),this._pointerdownRepeatTimer=this._register(new WindowIntervalTimer),this._pointerdownScheduleRepeatTimer=this._register(new TimeoutTimer)}_arrowPointerDown(w){if(!w.target||!(w.target instanceof Element))return;const D=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,getWindow(w))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(D,200),this._pointerMoveMonitor.startMonitoring(w.target,w.pointerId,w.buttons,O=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),w.preventDefault()}}class ScrollbarVisibilityController extends Disposable{constructor(w,D,O){super(),this._visibility=w,this._visibleClassName=D,this._invisibleClassName=O,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new TimeoutTimer)}setVisibility(w){this._visibility!==w&&(this._visibility=w,this._updateShouldBeVisible())}setShouldBeVisible(w){this._rawShouldBeVisible=w,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){const w=this._applyVisibilitySetting();this._shouldBeVisible!==w&&(this._shouldBeVisible=w,this.ensureVisibility())}setIsNeeded(w){this._isNeeded!==w&&(this._isNeeded=w,this.ensureVisibility())}setDomNode(w){this._domNode=w,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(w){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(w?" fade":"")))}}const POINTER_DRAG_RESET_DISTANCE$1=140;class AbstractScrollbar extends Widget$1{constructor(w){super(),this._lazyRender=w.lazyRender,this._host=w.host,this._scrollable=w.scrollable,this._scrollByPage=w.scrollByPage,this._scrollbarState=w.scrollbarState,this._visibilityController=this._register(new ScrollbarVisibilityController(w.visibility,"visible scrollbar "+w.extraScrollbarClassName,"invisible scrollbar "+w.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new GlobalPointerMoveMonitor),this._shouldRender=!0,this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(addDisposableListener(this.domNode.domNode,EventType$1.POINTER_DOWN,D=>this._domNodePointerDown(D)))}_createArrow(w){const D=this._register(new ScrollbarArrow(w));this.domNode.domNode.appendChild(D.bgDomNode),this.domNode.domNode.appendChild(D.domNode)}_createSlider(w,D,O,W){this.slider=createFastDomNode(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(w),this.slider.setLeft(D),typeof O=="number"&&this.slider.setWidth(O),typeof W=="number"&&this.slider.setHeight(W),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(addDisposableListener(this.slider.domNode,EventType$1.POINTER_DOWN,U=>{U.button===0&&(U.preventDefault(),this._sliderPointerDown(U))})),this.onclick(this.slider.domNode,U=>{U.leftButton&&U.stopPropagation()})}_onElementSize(w){return this._scrollbarState.setVisibleSize(w)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(w){return this._scrollbarState.setScrollSize(w)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(w){return this._scrollbarState.setScrollPosition(w)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(w){w.target===this.domNode.domNode&&this._onPointerDown(w)}delegatePointerDown(w){const D=this.domNode.domNode.getClientRects()[0].top,O=D+this._scrollbarState.getSliderPosition(),W=D+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),U=this._sliderPointerPosition(w);O<=U&&U<=W?w.button===0&&(w.preventDefault(),this._sliderPointerDown(w)):this._onPointerDown(w)}_onPointerDown(w){let D,O;if(w.target===this.domNode.domNode&&typeof w.offsetX=="number"&&typeof w.offsetY=="number")D=w.offsetX,O=w.offsetY;else{const U=getDomNodePagePosition(this.domNode.domNode);D=w.pageX-U.left,O=w.pageY-U.top}const W=this._pointerDownRelativePosition(D,O);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(W):this._scrollbarState.getDesiredScrollPositionFromOffset(W)),w.button===0&&(w.preventDefault(),this._sliderPointerDown(w))}_sliderPointerDown(w){if(!w.target||!(w.target instanceof Element))return;const D=this._sliderPointerPosition(w),O=this._sliderOrthogonalPointerPosition(w),W=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(w.target,w.pointerId,w.buttons,U=>{const K=this._sliderOrthogonalPointerPosition(U),q=Math.abs(K-O);if(isWindows&&q>POINTER_DRAG_RESET_DISTANCE$1){this._setDesiredScrollPositionNow(W.getScrollPosition());return}const Q=this._sliderPointerPosition(U)-D;this._setDesiredScrollPositionNow(W.getDesiredScrollPositionFromDelta(Q))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(w){const D={};this.writeScrollPosition(D,w),this._scrollable.setScrollPositionNow(D)}updateScrollbarSize(w){this._updateScrollbarSize(w),this._scrollbarState.setScrollbarSize(w),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}const MINIMUM_SLIDER_SIZE=20;class ScrollbarState{constructor(w,D,O,W,U,K){this._scrollbarSize=Math.round(D),this._oppositeScrollbarSize=Math.round(O),this._arrowSize=Math.round(w),this._visibleSize=W,this._scrollSize=U,this._scrollPosition=K,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new ScrollbarState(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(w){const D=Math.round(w);return this._visibleSize!==D?(this._visibleSize=D,this._refreshComputedValues(),!0):!1}setScrollSize(w){const D=Math.round(w);return this._scrollSize!==D?(this._scrollSize=D,this._refreshComputedValues(),!0):!1}setScrollPosition(w){const D=Math.round(w);return this._scrollPosition!==D?(this._scrollPosition=D,this._refreshComputedValues(),!0):!1}setScrollbarSize(w){this._scrollbarSize=Math.round(w)}setOppositeScrollbarSize(w){this._oppositeScrollbarSize=Math.round(w)}static _computeValues(w,D,O,W,U){const K=Math.max(0,O-w),q=Math.max(0,K-2*D),G=W>0&&W>O;if(!G)return{computedAvailableSize:Math.round(K),computedIsNeeded:G,computedSliderSize:Math.round(q),computedSliderRatio:0,computedSliderPosition:0};const Q=Math.round(Math.max(MINIMUM_SLIDER_SIZE,Math.floor(O*q/W))),Y=(q-Q)/(W-O),X=U*Y;return{computedAvailableSize:Math.round(K),computedIsNeeded:G,computedSliderSize:Math.round(Q),computedSliderRatio:Y,computedSliderPosition:Math.round(X)}}_refreshComputedValues(){const w=ScrollbarState._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=w.computedAvailableSize,this._computedIsNeeded=w.computedIsNeeded,this._computedSliderSize=w.computedSliderSize,this._computedSliderRatio=w.computedSliderRatio,this._computedSliderPosition=w.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(w){if(!this._computedIsNeeded)return 0;const D=w-this._arrowSize-this._computedSliderSize/2;return Math.round(D/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(w){if(!this._computedIsNeeded)return 0;const D=w-this._arrowSize;let O=this._scrollPosition;return D<this._computedSliderPosition?O-=this._visibleSize:O+=this._visibleSize,O}getDesiredScrollPositionFromDelta(w){if(!this._computedIsNeeded)return 0;const D=this._computedSliderPosition+w;return Math.round(D/this._computedSliderRatio)}}class HorizontalScrollbar extends AbstractScrollbar{constructor(w,D,O){const W=w.getScrollDimensions(),U=w.getCurrentScrollPosition();if(super({lazyRender:D.lazyRender,host:O,scrollbarState:new ScrollbarState(D.horizontalHasArrows?D.arrowSize:0,D.horizontal===2?0:D.horizontalScrollbarSize,D.vertical===2?0:D.verticalScrollbarSize,W.width,W.scrollWidth,U.scrollLeft),visibility:D.horizontal,extraScrollbarClassName:"horizontal",scrollable:w,scrollByPage:D.scrollByPage}),D.horizontalHasArrows){const K=(D.arrowSize-ARROW_IMG_SIZE)/2,q=(D.horizontalScrollbarSize-ARROW_IMG_SIZE)/2;this._createArrow({className:"scra",icon:Codicon.scrollbarButtonLeft,top:q,left:K,bottom:void 0,right:void 0,bgWidth:D.arrowSize,bgHeight:D.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new StandardWheelEvent(null,1,0))}),this._createArrow({className:"scra",icon:Codicon.scrollbarButtonRight,top:q,left:void 0,bottom:void 0,right:K,bgWidth:D.arrowSize,bgHeight:D.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new StandardWheelEvent(null,-1,0))})}this._createSlider(Math.floor((D.horizontalScrollbarSize-D.horizontalSliderSize)/2),0,void 0,D.horizontalSliderSize)}_updateSlider(w,D){this.slider.setWidth(w),this.slider.setLeft(D)}_renderDomNode(w,D){this.domNode.setWidth(w),this.domNode.setHeight(D),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(w){return this._shouldRender=this._onElementScrollSize(w.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(w.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(w.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(w,D){return w}_sliderPointerPosition(w){return w.pageX}_sliderOrthogonalPointerPosition(w){return w.pageY}_updateScrollbarSize(w){this.slider.setHeight(w)}writeScrollPosition(w,D){w.scrollLeft=D}updateOptions(w){this.updateScrollbarSize(w.horizontal===2?0:w.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(w.vertical===2?0:w.verticalScrollbarSize),this._visibilityController.setVisibility(w.horizontal),this._scrollByPage=w.scrollByPage}}class VerticalScrollbar extends AbstractScrollbar{constructor(w,D,O){const W=w.getScrollDimensions(),U=w.getCurrentScrollPosition();if(super({lazyRender:D.lazyRender,host:O,scrollbarState:new ScrollbarState(D.verticalHasArrows?D.arrowSize:0,D.vertical===2?0:D.verticalScrollbarSize,0,W.height,W.scrollHeight,U.scrollTop),visibility:D.vertical,extraScrollbarClassName:"vertical",scrollable:w,scrollByPage:D.scrollByPage}),D.verticalHasArrows){const K=(D.arrowSize-ARROW_IMG_SIZE)/2,q=(D.verticalScrollbarSize-ARROW_IMG_SIZE)/2;this._createArrow({className:"scra",icon:Codicon.scrollbarButtonUp,top:K,left:q,bottom:void 0,right:void 0,bgWidth:D.verticalScrollbarSize,bgHeight:D.arrowSize,onActivate:()=>this._host.onMouseWheel(new StandardWheelEvent(null,0,1))}),this._createArrow({className:"scra",icon:Codicon.scrollbarButtonDown,top:void 0,left:q,bottom:K,right:void 0,bgWidth:D.verticalScrollbarSize,bgHeight:D.arrowSize,onActivate:()=>this._host.onMouseWheel(new StandardWheelEvent(null,0,-1))})}this._createSlider(0,Math.floor((D.verticalScrollbarSize-D.verticalSliderSize)/2),D.verticalSliderSize,void 0)}_updateSlider(w,D){this.slider.setHeight(w),this.slider.setTop(D)}_renderDomNode(w,D){this.domNode.setWidth(D),this.domNode.setHeight(w),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(w){return this._shouldRender=this._onElementScrollSize(w.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(w.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(w.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(w,D){return D}_sliderPointerPosition(w){return w.pageY}_sliderOrthogonalPointerPosition(w){return w.pageX}_updateScrollbarSize(w){this.slider.setWidth(w)}writeScrollPosition(w,D){w.scrollTop=D}updateOptions(w){this.updateScrollbarSize(w.vertical===2?0:w.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(w.vertical),this._scrollByPage=w.scrollByPage}}class ScrollState{constructor(w,D,O,W,U,K,q){this._forceIntegerValues=w,this._scrollStateBrand=void 0,this._forceIntegerValues&&(D=D|0,O=O|0,W=W|0,U=U|0,K=K|0,q=q|0),this.rawScrollLeft=W,this.rawScrollTop=q,D<0&&(D=0),W+D>O&&(W=O-D),W<0&&(W=0),U<0&&(U=0),q+U>K&&(q=K-U),q<0&&(q=0),this.width=D,this.scrollWidth=O,this.scrollLeft=W,this.height=U,this.scrollHeight=K,this.scrollTop=q}equals(w){return this.rawScrollLeft===w.rawScrollLeft&&this.rawScrollTop===w.rawScrollTop&&this.width===w.width&&this.scrollWidth===w.scrollWidth&&this.scrollLeft===w.scrollLeft&&this.height===w.height&&this.scrollHeight===w.scrollHeight&&this.scrollTop===w.scrollTop}withScrollDimensions(w,D){return new ScrollState(this._forceIntegerValues,typeof w.width<"u"?w.width:this.width,typeof w.scrollWidth<"u"?w.scrollWidth:this.scrollWidth,D?this.rawScrollLeft:this.scrollLeft,typeof w.height<"u"?w.height:this.height,typeof w.scrollHeight<"u"?w.scrollHeight:this.scrollHeight,D?this.rawScrollTop:this.scrollTop)}withScrollPosition(w){return new ScrollState(this._forceIntegerValues,this.width,this.scrollWidth,typeof w.scrollLeft<"u"?w.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof w.scrollTop<"u"?w.scrollTop:this.rawScrollTop)}createScrollEvent(w,D){const O=this.width!==w.width,W=this.scrollWidth!==w.scrollWidth,U=this.scrollLeft!==w.scrollLeft,K=this.height!==w.height,q=this.scrollHeight!==w.scrollHeight,G=this.scrollTop!==w.scrollTop;return{inSmoothScrolling:D,oldWidth:w.width,oldScrollWidth:w.scrollWidth,oldScrollLeft:w.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:w.height,oldScrollHeight:w.scrollHeight,oldScrollTop:w.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:O,scrollWidthChanged:W,scrollLeftChanged:U,heightChanged:K,scrollHeightChanged:q,scrollTopChanged:G}}}class Scrollable extends Disposable{constructor(w){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new Emitter$1),this.onScroll=this._onScroll.event,this._smoothScrollDuration=w.smoothScrollDuration,this._scheduleAtNextAnimationFrame=w.scheduleAtNextAnimationFrame,this._state=new ScrollState(w.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(w){this._smoothScrollDuration=w}validateScrollPosition(w){return this._state.withScrollPosition(w)}getScrollDimensions(){return this._state}setScrollDimensions(w,D){const O=this._state.withScrollDimensions(w,D);this._setState(O,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(w){const D=this._state.withScrollPosition(w);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(D,!1)}setScrollPositionSmooth(w,D){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(w);if(this._smoothScrolling){w={scrollLeft:typeof w.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:w.scrollLeft,scrollTop:typeof w.scrollTop>"u"?this._smoothScrolling.to.scrollTop:w.scrollTop};const O=this._state.withScrollPosition(w);if(this._smoothScrolling.to.scrollLeft===O.scrollLeft&&this._smoothScrolling.to.scrollTop===O.scrollTop)return;let W;D?W=new SmoothScrollingOperation(this._smoothScrolling.from,O,this._smoothScrolling.startTime,this._smoothScrolling.duration):W=this._smoothScrolling.combine(this._state,O,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=W}else{const O=this._state.withScrollPosition(w);this._smoothScrolling=SmoothScrollingOperation.start(this._state,O,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;const w=this._smoothScrolling.tick(),D=this._state.withScrollPosition(w);if(this._setState(D,!0),!!this._smoothScrolling){if(w.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(w,D){const O=this._state;O.equals(w)||(this._state=w,this._onScroll.fire(this._state.createScrollEvent(O,D)))}}class SmoothScrollingUpdate{constructor(w,D,O){this.scrollLeft=w,this.scrollTop=D,this.isDone=O}}function createEaseOutCubic(F,w){const D=w-F;return function(O){return F+D*easeOutCubic(O)}}function createComposed(F,w,D){return function(O){return O<D?F(O/D):w((O-D)/(1-D))}}class SmoothScrollingOperation{constructor(w,D,O,W){this.from=w,this.to=D,this.duration=W,this.startTime=O,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(w,D,O){if(Math.abs(w-D)>2.5*O){let U,K;return w<D?(U=w+.75*O,K=D-.75*O):(U=w-.75*O,K=D+.75*O),createComposed(createEaseOutCubic(w,U),createEaseOutCubic(K,D),.33)}return createEaseOutCubic(w,D)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(w){this.to=w.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(w){const D=(w-this.startTime)/this.duration;if(D<1){const O=this.scrollLeft(D),W=this.scrollTop(D);return new SmoothScrollingUpdate(O,W,!1)}return new SmoothScrollingUpdate(this.to.scrollLeft,this.to.scrollTop,!0)}combine(w,D,O){return SmoothScrollingOperation.start(w,D,O)}static start(w,D,O){O=O+10;const W=Date.now()-10;return new SmoothScrollingOperation(w,D,W,O)}}function easeInCubic(F){return Math.pow(F,3)}function easeOutCubic(F){return 1-easeInCubic(1-F)}const HIDE_TIMEOUT=500,SCROLL_WHEEL_SENSITIVITY=50;class MouseWheelClassifierItem{constructor(w,D,O){this.timestamp=w,this.deltaX=D,this.deltaY=O,this.score=0}}class MouseWheelClassifier{static{this.INSTANCE=new MouseWheelClassifier}constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let w=1,D=0,O=1,W=this._rear;do{const U=W===this._front?w:Math.pow(2,-O);if(w-=U,D+=this._memory[W].score*U,W===this._front)break;W=(this._capacity+W-1)%this._capacity,O++}while(!0);return D<=.5}acceptStandardWheelEvent(w){if(isChrome$1){const D=getWindow(w.browserEvent),O=getZoomFactor(D);this.accept(Date.now(),w.deltaX*O,w.deltaY*O)}else this.accept(Date.now(),w.deltaX,w.deltaY)}accept(w,D,O){let W=null;const U=new MouseWheelClassifierItem(w,D,O);this._front===-1&&this._rear===-1?(this._memory[0]=U,this._front=0,this._rear=0):(W=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=U),U.score=this._computeScore(U,W)}_computeScore(w,D){if(Math.abs(w.deltaX)>0&&Math.abs(w.deltaY)>0)return 1;let O=.5;if((!this._isAlmostInt(w.deltaX)||!this._isAlmostInt(w.deltaY))&&(O+=.25),D){const W=Math.abs(w.deltaX),U=Math.abs(w.deltaY),K=Math.abs(D.deltaX),q=Math.abs(D.deltaY),G=Math.max(Math.min(W,K),1),Q=Math.max(Math.min(U,q),1),Y=Math.max(W,K),X=Math.max(U,q);Y%G===0&&X%Q===0&&(O-=.5)}return Math.min(Math.max(O,0),1)}_isAlmostInt(w){return Math.abs(Math.round(w)-w)<.01}}class AbstractScrollableElement extends Widget$1{get options(){return this._options}constructor(w,D,O){super(),this._onScroll=this._register(new Emitter$1),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new Emitter$1),w.style.overflow="hidden",this._options=resolveOptions(D),this._scrollable=O,this._register(this._scrollable.onScroll(U=>{this._onWillScroll.fire(U),this._onDidScroll(U),this._onScroll.fire(U)}));const W={onMouseWheel:U=>this._onMouseWheel(U),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new VerticalScrollbar(this._scrollable,this._options,W)),this._horizontalScrollbar=this._register(new HorizontalScrollbar(this._scrollable,this._options,W)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(w),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=createFastDomNode(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=createFastDomNode(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=createFastDomNode(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,U=>this._onMouseOver(U)),this.onmouseleave(this._listenOnDomNode,U=>this._onMouseLeave(U)),this._hideTimeout=this._register(new TimeoutTimer),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=dispose(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(w){this._verticalScrollbar.delegatePointerDown(w)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(w){this._scrollable.setScrollDimensions(w,!1)}updateClassName(w){this._options.className=w,isMacintosh&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(w){typeof w.handleMouseWheel<"u"&&(this._options.handleMouseWheel=w.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof w.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=w.mouseWheelScrollSensitivity),typeof w.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=w.fastScrollSensitivity),typeof w.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=w.scrollPredominantAxis),typeof w.horizontal<"u"&&(this._options.horizontal=w.horizontal),typeof w.vertical<"u"&&(this._options.vertical=w.vertical),typeof w.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=w.horizontalScrollbarSize),typeof w.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=w.verticalScrollbarSize),typeof w.scrollByPage<"u"&&(this._options.scrollByPage=w.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}delegateScrollFromMouseWheelEvent(w){this._onMouseWheel(new StandardWheelEvent(w))}_setListeningToMouseWheel(w){if(this._mouseWheelToDispose.length>0!==w&&(this._mouseWheelToDispose=dispose(this._mouseWheelToDispose),w)){const O=W=>{this._onMouseWheel(new StandardWheelEvent(W))};this._mouseWheelToDispose.push(addDisposableListener(this._listenOnDomNode,EventType$1.MOUSE_WHEEL,O,{passive:!1}))}}_onMouseWheel(w){if(w.browserEvent?.defaultPrevented)return;const D=MouseWheelClassifier.INSTANCE;D.acceptStandardWheelEvent(w);let O=!1;if(w.deltaY||w.deltaX){let U=w.deltaY*this._options.mouseWheelScrollSensitivity,K=w.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&K+U===0?K=U=0:Math.abs(U)>=Math.abs(K)?K=0:U=0),this._options.flipAxes&&([U,K]=[K,U]);const q=!isMacintosh&&w.browserEvent&&w.browserEvent.shiftKey;(this._options.scrollYToX||q)&&!K&&(K=U,U=0),w.browserEvent&&w.browserEvent.altKey&&(K=K*this._options.fastScrollSensitivity,U=U*this._options.fastScrollSensitivity);const G=this._scrollable.getFutureScrollPosition();let Q={};if(U){const Y=SCROLL_WHEEL_SENSITIVITY*U,X=G.scrollTop-(Y<0?Math.floor(Y):Math.ceil(Y));this._verticalScrollbar.writeScrollPosition(Q,X)}if(K){const Y=SCROLL_WHEEL_SENSITIVITY*K,X=G.scrollLeft-(Y<0?Math.floor(Y):Math.ceil(Y));this._horizontalScrollbar.writeScrollPosition(Q,X)}Q=this._scrollable.validateScrollPosition(Q),(G.scrollLeft!==Q.scrollLeft||G.scrollTop!==Q.scrollTop)&&(this._options.mouseWheelSmoothScroll&&D.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(Q):this._scrollable.setScrollPositionNow(Q),O=!0)}let W=O;!W&&this._options.alwaysConsumeMouseWheel&&(W=!0),!W&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(W=!0),W&&(w.preventDefault(),w.stopPropagation())}_onDidScroll(w){this._shouldRender=this._horizontalScrollbar.onDidScroll(w)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(w)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const w=this._scrollable.getCurrentScrollPosition(),D=w.scrollTop>0,O=w.scrollLeft>0,W=O?" left":"",U=D?" top":"",K=O||D?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${W}`),this._topShadowDomNode.setClassName(`shadow${U}`),this._topLeftShadowDomNode.setClassName(`shadow${K}${U}${W}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(w){this._mouseIsOver=!1,this._hide()}_onMouseOver(w){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),HIDE_TIMEOUT)}}class ScrollableElement extends AbstractScrollableElement{constructor(w,D){D=D||{},D.mouseWheelSmoothScroll=!1;const O=new Scrollable({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:W=>scheduleAtNextAnimationFrame(getWindow(w),W)});super(w,D,O),this._register(O)}setScrollPosition(w){this._scrollable.setScrollPositionNow(w)}}class SmoothScrollableElement extends AbstractScrollableElement{constructor(w,D,O){super(w,D,O)}setScrollPosition(w){w.reuseAnimation?this._scrollable.setScrollPositionSmooth(w,w.reuseAnimation):this._scrollable.setScrollPositionNow(w)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class DomScrollableElement extends AbstractScrollableElement{constructor(w,D){D=D||{},D.mouseWheelSmoothScroll=!1;const O=new Scrollable({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:W=>scheduleAtNextAnimationFrame(getWindow(w),W)});super(w,D,O),this._register(O),this._element=w,this._register(this.onScroll(W=>{W.scrollTopChanged&&(this._element.scrollTop=W.scrollTop),W.scrollLeftChanged&&(this._element.scrollLeft=W.scrollLeft)})),this.scanDomNode()}setScrollPosition(w){this._scrollable.setScrollPositionNow(w)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function resolveOptions(F){const w={lazyRender:typeof F.lazyRender<"u"?F.lazyRender:!1,className:typeof F.className<"u"?F.className:"",useShadows:typeof F.useShadows<"u"?F.useShadows:!0,handleMouseWheel:typeof F.handleMouseWheel<"u"?F.handleMouseWheel:!0,flipAxes:typeof F.flipAxes<"u"?F.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof F.consumeMouseWheelIfScrollbarIsNeeded<"u"?F.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof F.alwaysConsumeMouseWheel<"u"?F.alwaysConsumeMouseWheel:!1,scrollYToX:typeof F.scrollYToX<"u"?F.scrollYToX:!1,mouseWheelScrollSensitivity:typeof F.mouseWheelScrollSensitivity<"u"?F.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof F.fastScrollSensitivity<"u"?F.fastScrollSensitivity:5,scrollPredominantAxis:typeof F.scrollPredominantAxis<"u"?F.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof F.mouseWheelSmoothScroll<"u"?F.mouseWheelSmoothScroll:!0,arrowSize:typeof F.arrowSize<"u"?F.arrowSize:11,listenOnDomNode:typeof F.listenOnDomNode<"u"?F.listenOnDomNode:null,horizontal:typeof F.horizontal<"u"?F.horizontal:1,horizontalScrollbarSize:typeof F.horizontalScrollbarSize<"u"?F.horizontalScrollbarSize:10,horizontalSliderSize:typeof F.horizontalSliderSize<"u"?F.horizontalSliderSize:0,horizontalHasArrows:typeof F.horizontalHasArrows<"u"?F.horizontalHasArrows:!1,vertical:typeof F.vertical<"u"?F.vertical:1,verticalScrollbarSize:typeof F.verticalScrollbarSize<"u"?F.verticalScrollbarSize:10,verticalHasArrows:typeof F.verticalHasArrows<"u"?F.verticalHasArrows:!1,verticalSliderSize:typeof F.verticalSliderSize<"u"?F.verticalSliderSize:0,scrollByPage:typeof F.scrollByPage<"u"?F.scrollByPage:!1};return w.horizontalSliderSize=typeof F.horizontalSliderSize<"u"?F.horizontalSliderSize:w.horizontalScrollbarSize,w.verticalSliderSize=typeof F.verticalSliderSize<"u"?F.verticalSliderSize:w.verticalScrollbarSize,isMacintosh&&(w.className+=" mac"),w}var Range$1;(function(F){function w(U,K){if(U.start>=K.end||K.start>=U.end)return{start:0,end:0};const q=Math.max(U.start,K.start),G=Math.min(U.end,K.end);return G-q<=0?{start:0,end:0}:{start:q,end:G}}F.intersect=w;function D(U){return U.end-U.start<=0}F.isEmpty=D;function O(U,K){return!D(w(U,K))}F.intersects=O;function W(U,K){const q=[],G={start:U.start,end:Math.min(K.start,U.end)},Q={start:Math.max(K.end,U.start),end:U.end};return D(G)||q.push(G),D(Q)||q.push(Q),q}F.relativeComplement=W})(Range$1||(Range$1={}));function groupIntersect(F,w){const D=[];for(const O of w){if(F.start>=O.range.end)continue;if(F.end<O.range.start)break;const W=Range$1.intersect(F,O.range);Range$1.isEmpty(W)||D.push({range:W,size:O.size})}return D}function shift({start:F,end:w},D){return{start:F+D,end:w+D}}function consolidate(F){const w=[];let D=null;for(const O of F){const W=O.range.start,U=O.range.end,K=O.size;if(D&&K===D.size){D.range.end=U;continue}D={range:{start:W,end:U},size:K},w.push(D)}return w}function concat$1(...F){return consolidate(F.reduce((w,D)=>w.concat(D),[]))}class RangeMap{get paddingTop(){return this._paddingTop}set paddingTop(w){this._size=this._size+w-this._paddingTop,this._paddingTop=w}constructor(w){this.groups=[],this._size=0,this._paddingTop=0,this._paddingTop=w??0,this._size=this._paddingTop}splice(w,D,O=[]){const W=O.length-D,U=groupIntersect({start:0,end:w},this.groups),K=groupIntersect({start:w+D,end:Number.POSITIVE_INFINITY},this.groups).map(G=>({range:shift(G.range,W),size:G.size})),q=O.map((G,Q)=>({range:{start:w+Q,end:w+Q+1},size:G.size}));this.groups=concat$1(U,q,K),this._size=this._paddingTop+this.groups.reduce((G,Q)=>G+Q.size*(Q.range.end-Q.range.start),0)}get count(){const w=this.groups.length;return w?this.groups[w-1].range.end:0}get size(){return this._size}indexAt(w){if(w<0)return-1;if(w<this._paddingTop)return 0;let D=0,O=this._paddingTop;for(const W of this.groups){const U=W.range.end-W.range.start,K=O+U*W.size;if(w<K)return D+Math.floor((w-O)/W.size);D+=U,O=K}return D}indexAfter(w){return Math.min(this.indexAt(w)+1,this.count)}positionAt(w){if(w<0)return-1;let D=0,O=0;for(const W of this.groups){const U=W.range.end-W.range.start,K=O+U;if(w<K)return this._paddingTop+D+(w-O)*W.size;D+=U*W.size,O=K}return-1}}class RowCache{constructor(w){this.renderers=w,this.cache=new Map,this.transactionNodesPendingRemoval=new Set,this.inTransaction=!1}alloc(w){let D=this.getTemplateCache(w).pop(),O=!1;if(D)O=this.transactionNodesPendingRemoval.has(D.domNode),O&&this.transactionNodesPendingRemoval.delete(D.domNode);else{const W=$$8(".monaco-list-row"),K=this.getRenderer(w).renderTemplate(W);D={domNode:W,templateId:w,templateData:K}}return{row:D,isReusingConnectedDomNode:O}}release(w){w&&this.releaseRow(w)}transact(w){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{w()}finally{for(const D of this.transactionNodesPendingRemoval)this.doRemoveNode(D);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(w){const{domNode:D,templateId:O}=w;D&&(this.inTransaction?this.transactionNodesPendingRemoval.add(D):this.doRemoveNode(D)),this.getTemplateCache(O).push(w)}doRemoveNode(w){w.classList.remove("scrolling"),w.remove()}getTemplateCache(w){let D=this.cache.get(w);return D||(D=[],this.cache.set(w,D)),D}dispose(){this.cache.forEach((w,D)=>{for(const O of w)this.getRenderer(D).disposeTemplate(O.templateData),O.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(w){const D=this.renderers.get(w);if(!D)throw new Error(`No renderer found for ${w}`);return D}}var __decorate$19=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U};const StaticDND={CurrentDragAndDropData:void 0},DefaultOptions$1={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(F){return[F]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class ElementsDragAndDropData{constructor(w){this.elements=w}update(){}getData(){return this.elements}}class ExternalElementsDragAndDropData{constructor(w){this.elements=w}update(){}getData(){return this.elements}}class NativeDragAndDropData{constructor(){this.types=[],this.files=[]}update(w){if(w.types&&this.types.splice(0,this.types.length,...w.types),w.files){this.files.splice(0,this.files.length);for(let D=0;D<w.files.length;D++){const O=w.files.item(D);O&&(O.size||O.type)&&this.files.push(O)}}}getData(){return{types:this.types,files:this.files}}}function equalsDragFeedback(F,w){return Array.isArray(F)&&Array.isArray(w)?equals$1(F,w):F===w}class ListViewAccessibilityProvider{constructor(w){w?.getSetSize?this.getSetSize=w.getSetSize.bind(w):this.getSetSize=(D,O,W)=>W,w?.getPosInSet?this.getPosInSet=w.getPosInSet.bind(w):this.getPosInSet=(D,O)=>O+1,w?.getRole?this.getRole=w.getRole.bind(w):this.getRole=D=>"listitem",w?.isChecked?this.isChecked=w.isChecked.bind(w):this.isChecked=D=>{}}}class ListView{static{this.InstanceCount=0}get contentHeight(){return this.rangeMap.size}get onDidScroll(){return this.scrollableElement.onScroll}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(w){if(w!==this._horizontalScrolling){if(w&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=w,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const D of this.items)this.measureItemWidth(D);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:getContentWidth(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}constructor(w,D,O,W=DefaultOptions$1){if(this.virtualDelegate=D,this.domId=`list_id_${++ListView.InstanceCount}`,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new Delayer(50),this.splicing=!1,this.dragOverAnimationStopDisposable=Disposable.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=Disposable.None,this.onDragLeaveTimeout=Disposable.None,this.disposables=new DisposableStore,this._onDidChangeContentHeight=new Emitter$1,this._onDidChangeContentWidth=new Emitter$1,this.onDidChangeContentHeight=Event$1.latch(this._onDidChangeContentHeight.event,void 0,this.disposables),this._horizontalScrolling=!1,W.horizontalScrolling&&W.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(W.paddingTop??0);for(const K of O)this.renderers.set(K.templateId,K);this.cache=this.disposables.add(new RowCache(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof W.mouseSupport=="boolean"?W.mouseSupport:!0),this._horizontalScrolling=W.horizontalScrolling??DefaultOptions$1.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof W.paddingBottom>"u"?0:W.paddingBottom,this.accessibilityProvider=new ListViewAccessibilityProvider(W.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(W.transformOptimization??DefaultOptions$1.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Gesture.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new Scrollable({forceIntegerValues:!0,smoothScrollDuration:W.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:K=>scheduleAtNextAnimationFrame(getWindow(this.domNode),K)})),this.scrollableElement=this.disposables.add(new SmoothScrollableElement(this.rowsContainer,{alwaysConsumeMouseWheel:W.alwaysConsumeMouseWheel??DefaultOptions$1.alwaysConsumeMouseWheel,horizontal:1,vertical:W.verticalScrollMode??DefaultOptions$1.verticalScrollMode,useShadows:W.useShadows??DefaultOptions$1.useShadows,mouseWheelScrollSensitivity:W.mouseWheelScrollSensitivity,fastScrollSensitivity:W.fastScrollSensitivity,scrollByPage:W.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),w.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(addDisposableListener(this.rowsContainer,EventType.Change,K=>this.onTouchChange(K))),this.disposables.add(addDisposableListener(this.scrollableElement.getDomNode(),"scroll",K=>K.target.scrollTop=0)),this.disposables.add(addDisposableListener(this.domNode,"dragover",K=>this.onDragOver(this.toDragEvent(K)))),this.disposables.add(addDisposableListener(this.domNode,"drop",K=>this.onDrop(this.toDragEvent(K)))),this.disposables.add(addDisposableListener(this.domNode,"dragleave",K=>this.onDragLeave(this.toDragEvent(K)))),this.disposables.add(addDisposableListener(this.domNode,"dragend",K=>this.onDragEnd(K))),this.setRowLineHeight=W.setRowLineHeight??DefaultOptions$1.setRowLineHeight,this.setRowHeight=W.setRowHeight??DefaultOptions$1.setRowHeight,this.supportDynamicHeights=W.supportDynamicHeights??DefaultOptions$1.supportDynamicHeights,this.dnd=W.dnd??this.disposables.add(DefaultOptions$1.dnd),this.layout(W.initialSize?.height,W.initialSize?.width)}updateOptions(w){w.paddingBottom!==void 0&&(this.paddingBottom=w.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),w.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(w.smoothScrolling?125:0),w.horizontalScrolling!==void 0&&(this.horizontalScrolling=w.horizontalScrolling);let D;if(w.scrollByPage!==void 0&&(D={...D??{},scrollByPage:w.scrollByPage}),w.mouseWheelScrollSensitivity!==void 0&&(D={...D??{},mouseWheelScrollSensitivity:w.mouseWheelScrollSensitivity}),w.fastScrollSensitivity!==void 0&&(D={...D??{},fastScrollSensitivity:w.fastScrollSensitivity}),D&&this.scrollableElement.updateOptions(D),w.paddingTop!==void 0&&w.paddingTop!==this.rangeMap.paddingTop){const O=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),W=w.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=w.paddingTop,this.render(O,Math.max(0,this.lastRenderTop+W),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}createRangeMap(w){return new RangeMap(w)}splice(w,D,O=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(w,D,O)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(w,D,O=[]){const W=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),U={start:w,end:w+D},K=Range$1.intersect(W,U),q=new Map;for(let ue=K.end-1;ue>=K.start;ue--){const pe=this.items[ue];if(pe.dragStartDisposable.dispose(),pe.checkedDisposable.dispose(),pe.row){let fe=q.get(pe.templateId);fe||(fe=[],q.set(pe.templateId,fe));const Ce=this.renderers.get(pe.templateId);Ce&&Ce.disposeElement&&Ce.disposeElement(pe.element,ue,pe.row.templateData,pe.size),fe.unshift(pe.row)}pe.row=null,pe.stale=!0}const G={start:w+D,end:this.items.length},Q=Range$1.intersect(G,W),Y=Range$1.relativeComplement(G,W),X=O.map(ue=>({id:String(this.itemId++),element:ue,templateId:this.virtualDelegate.getTemplateId(ue),size:this.virtualDelegate.getHeight(ue),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(ue),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:Disposable.None,checkedDisposable:Disposable.None,stale:!1}));let J;w===0&&D>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,X),J=this.items,this.items=X):(this.rangeMap.splice(w,D,X),J=this.items.splice(w,D,...X));const te=O.length-D,ie=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),se=shift(Q,te),re=Range$1.intersect(ie,se);for(let ue=re.start;ue<re.end;ue++)this.updateItemInDOM(this.items[ue],ue);const ae=Range$1.relativeComplement(se,ie);for(const ue of ae)for(let pe=ue.start;pe<ue.end;pe++)this.removeItemFromDOM(pe);const le=Y.map(ue=>shift(ue,te)),oe=[{start:w,end:w+O.length},...le].map(ue=>Range$1.intersect(ie,ue)).reverse();for(const ue of oe)for(let pe=ue.end-1;pe>=ue.start;pe--){const fe=this.items[pe],we=q.get(fe.templateId)?.pop();this.insertItemInDOM(pe,we)}for(const ue of q.values())for(const pe of ue)this.cache.release(pe);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),J.map(ue=>ue.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=scheduleAtNextAnimationFrame(getWindow(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let w=0;for(const D of this.items)typeof D.width<"u"&&(w=Math.max(w,D.width));this.scrollWidth=w,this.scrollableElement.setScrollDimensions({scrollWidth:w===0?0:w+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}rerender(){if(this.supportDynamicHeights){for(const w of this.items)w.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}element(w){return this.items[w].element}indexOf(w){return this.items.findIndex(D=>D.element===w)}domElement(w){const D=this.items[w].row;return D&&D.domNode}elementHeight(w){return this.items[w].size}elementTop(w){return this.rangeMap.positionAt(w)}indexAt(w){return this.rangeMap.indexAt(w)}indexAfter(w){return this.rangeMap.indexAfter(w)}layout(w,D){const O={height:typeof w=="number"?w:getContentHeight(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,O.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(O),typeof D<"u"&&(this.renderWidth=D,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof D=="number"?D:getContentWidth(this.domNode)})}render(w,D,O,W,U,K=!1){const q=this.getRenderRange(D,O),G=Range$1.relativeComplement(q,w).reverse(),Q=Range$1.relativeComplement(w,q);if(K){const Y=Range$1.intersect(w,q);for(let X=Y.start;X<Y.end;X++)this.updateItemInDOM(this.items[X],X)}this.cache.transact(()=>{for(const Y of Q)for(let X=Y.start;X<Y.end;X++)this.removeItemFromDOM(X);for(const Y of G)for(let X=Y.end-1;X>=Y.start;X--)this.insertItemInDOM(X)}),W!==void 0&&(this.rowsContainer.style.left=`-${W}px`),this.rowsContainer.style.top=`-${D}px`,this.horizontalScrolling&&U!==void 0&&(this.rowsContainer.style.width=`${Math.max(U,this.renderWidth)}px`),this.lastRenderTop=D,this.lastRenderHeight=O}insertItemInDOM(w,D){const O=this.items[w];if(!O.row)if(D)O.row=D,O.stale=!0;else{const G=this.cache.alloc(O.templateId);O.row=G.row,O.stale||=G.isReusingConnectedDomNode}const W=this.accessibilityProvider.getRole(O.element)||"listitem";O.row.domNode.setAttribute("role",W);const U=this.accessibilityProvider.isChecked(O.element);if(typeof U=="boolean")O.row.domNode.setAttribute("aria-checked",String(!!U));else if(U){const G=Q=>O.row.domNode.setAttribute("aria-checked",String(!!Q));G(U.value),O.checkedDisposable=U.onDidChange(()=>G(U.value))}if(O.stale||!O.row.domNode.parentElement){const G=this.items.at(w+1)?.row?.domNode??null;(O.row.domNode.parentElement!==this.rowsContainer||O.row.domNode.nextElementSibling!==G)&&this.rowsContainer.insertBefore(O.row.domNode,G),O.stale=!1}this.updateItemInDOM(O,w);const K=this.renderers.get(O.templateId);if(!K)throw new Error(`No renderer found for template id ${O.templateId}`);K?.renderElement(O.element,w,O.row.templateData,O.size);const q=this.dnd.getDragURI(O.element);O.dragStartDisposable.dispose(),O.row.domNode.draggable=!!q,q&&(O.dragStartDisposable=addDisposableListener(O.row.domNode,"dragstart",G=>this.onDragStart(O.element,q,G))),this.horizontalScrolling&&(this.measureItemWidth(O),this.eventuallyUpdateScrollWidth())}measureItemWidth(w){if(!w.row||!w.row.domNode)return;w.row.domNode.style.width="fit-content",w.width=getContentWidth(w.row.domNode);const D=getWindow(w.row.domNode).getComputedStyle(w.row.domNode);D.paddingLeft&&(w.width+=parseFloat(D.paddingLeft)),D.paddingRight&&(w.width+=parseFloat(D.paddingRight)),w.row.domNode.style.width=""}updateItemInDOM(w,D){w.row.domNode.style.top=`${this.elementTop(D)}px`,this.setRowHeight&&(w.row.domNode.style.height=`${w.size}px`),this.setRowLineHeight&&(w.row.domNode.style.lineHeight=`${w.size}px`),w.row.domNode.setAttribute("data-index",`${D}`),w.row.domNode.setAttribute("data-last-element",D===this.length-1?"true":"false"),w.row.domNode.setAttribute("data-parity",D%2===0?"even":"odd"),w.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(w.element,D,this.length))),w.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(w.element,D))),w.row.domNode.setAttribute("id",this.getElementDomId(D)),w.row.domNode.classList.toggle("drop-target",w.dropTarget)}removeItemFromDOM(w){const D=this.items[w];if(D.dragStartDisposable.dispose(),D.checkedDisposable.dispose(),D.row){const O=this.renderers.get(D.templateId);O&&O.disposeElement&&O.disposeElement(D.element,w,D.row.templateData,D.size),this.cache.release(D.row),D.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(w,D){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:w,reuseAnimation:D})}get scrollTop(){return this.getScrollTop()}set scrollTop(w){this.setScrollTop(w)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"click")).event,w=>this.toMouseEvent(w),this.disposables)}get onMouseDblClick(){return Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"dblclick")).event,w=>this.toMouseEvent(w),this.disposables)}get onMouseMiddleClick(){return Event$1.filter(Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"auxclick")).event,w=>this.toMouseEvent(w),this.disposables),w=>w.browserEvent.button===1,this.disposables)}get onMouseDown(){return Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"mousedown")).event,w=>this.toMouseEvent(w),this.disposables)}get onMouseOver(){return Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"mouseover")).event,w=>this.toMouseEvent(w),this.disposables)}get onMouseOut(){return Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"mouseout")).event,w=>this.toMouseEvent(w),this.disposables)}get onContextMenu(){return Event$1.any(Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"contextmenu")).event,w=>this.toMouseEvent(w),this.disposables),Event$1.map(this.disposables.add(new DomEmitter(this.domNode,EventType.Contextmenu)).event,w=>this.toGestureEvent(w),this.disposables))}get onTouchStart(){return Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"touchstart")).event,w=>this.toTouchEvent(w),this.disposables)}get onTap(){return Event$1.map(this.disposables.add(new DomEmitter(this.rowsContainer,EventType.Tap)).event,w=>this.toGestureEvent(w),this.disposables)}toMouseEvent(w){const D=this.getItemIndexFromEventTarget(w.target||null),O=typeof D>"u"?void 0:this.items[D],W=O&&O.element;return{browserEvent:w,index:D,element:W}}toTouchEvent(w){const D=this.getItemIndexFromEventTarget(w.target||null),O=typeof D>"u"?void 0:this.items[D],W=O&&O.element;return{browserEvent:w,index:D,element:W}}toGestureEvent(w){const D=this.getItemIndexFromEventTarget(w.initialTarget||null),O=typeof D>"u"?void 0:this.items[D],W=O&&O.element;return{browserEvent:w,index:D,element:W}}toDragEvent(w){const D=this.getItemIndexFromEventTarget(w.target||null),O=typeof D>"u"?void 0:this.items[D],W=O&&O.element,U=this.getTargetSector(w,D);return{browserEvent:w,index:D,element:W,sector:U}}onScroll(w){try{const D=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(D,w.scrollTop,w.height,w.scrollLeft,w.scrollWidth),this.supportDynamicHeights&&this._rerender(w.scrollTop,w.height,w.inSmoothScrolling)}catch(D){throw console.error("Got bad scroll event:",w),D}}onTouchChange(w){w.preventDefault(),w.stopPropagation(),this.scrollTop-=w.translationY}onDragStart(w,D,O){if(!O.dataTransfer)return;const W=this.dnd.getDragElements(w);if(O.dataTransfer.effectAllowed="copyMove",O.dataTransfer.setData(DataTransfers.TEXT,D),O.dataTransfer.setDragImage){let U;this.dnd.getDragLabel&&(U=this.dnd.getDragLabel(W,O)),typeof U>"u"&&(U=String(W.length));const K=$$8(".monaco-drag-image");K.textContent=U,(Q=>{for(;Q&&!Q.classList.contains("monaco-workbench");)Q=Q.parentElement;return Q||this.domNode.ownerDocument})(this.domNode).appendChild(K),O.dataTransfer.setDragImage(K,-10,-10),setTimeout(()=>K.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new ElementsDragAndDropData(W),StaticDND.CurrentDragAndDropData=new ExternalElementsDragAndDropData(W),this.dnd.onDragStart?.(this.currentDragData,O)}onDragOver(w){if(w.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),StaticDND.CurrentDragAndDropData&&StaticDND.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(w.browserEvent),!w.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(StaticDND.CurrentDragAndDropData)this.currentDragData=StaticDND.CurrentDragAndDropData;else{if(!w.browserEvent.dataTransfer.types)return!1;this.currentDragData=new NativeDragAndDropData}const D=this.dnd.onDragOver(this.currentDragData,w.element,w.index,w.sector,w.browserEvent);if(this.canDrop=typeof D=="boolean"?D:D.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;w.browserEvent.dataTransfer.dropEffect=typeof D!="boolean"&&D.effect?.type===0?"copy":"move";let O;typeof D!="boolean"&&D.feedback?O=D.feedback:typeof w.index>"u"?O=[-1]:O=[w.index],O=distinct(O).filter(U=>U>=-1&&U<this.length).sort((U,K)=>U-K),O=O[0]===-1?[-1]:O;let W=typeof D!="boolean"&&D.effect&&D.effect.position?D.effect.position:"drop-target";if(equalsDragFeedback(this.currentDragFeedback,O)&&this.currentDragFeedbackPosition===W)return!0;if(this.currentDragFeedback=O,this.currentDragFeedbackPosition=W,this.currentDragFeedbackDisposable.dispose(),O[0]===-1)this.domNode.classList.add(W),this.rowsContainer.classList.add(W),this.currentDragFeedbackDisposable=toDisposable(()=>{this.domNode.classList.remove(W),this.rowsContainer.classList.remove(W)});else{if(O.length>1&&W!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");W==="drop-target-after"&&O[0]<this.length-1&&(O[0]+=1,W="drop-target-before");for(const U of O){const K=this.items[U];K.dropTarget=!0,K.row?.domNode.classList.add(W)}this.currentDragFeedbackDisposable=toDisposable(()=>{for(const U of O){const K=this.items[U];K.dropTarget=!1,K.row?.domNode.classList.remove(W)}})}return!0}onDragLeave(w){this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=disposableTimeout(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&this.dnd.onDragLeave?.(this.currentDragData,w.element,w.index,w.browserEvent)}onDrop(w){if(!this.canDrop)return;const D=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,StaticDND.CurrentDragAndDropData=void 0,!(!D||!w.browserEvent.dataTransfer)&&(w.browserEvent.preventDefault(),D.update(w.browserEvent.dataTransfer),this.dnd.drop(D,w.element,w.index,w.sector,w.browserEvent))}onDragEnd(w){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,StaticDND.CurrentDragAndDropData=void 0,this.dnd.onDragEnd?.(w)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=Disposable.None}setupDragAndDropScrollTopAnimation(w){if(!this.dragOverAnimationDisposable){const D=getTopLeftOffset(this.domNode).top;this.dragOverAnimationDisposable=animate(getWindow(this.domNode),this.animateDragAndDropScrollTop.bind(this,D))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=disposableTimeout(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=w.pageY}animateDragAndDropScrollTop(w){if(this.dragOverMouseY===void 0)return;const D=this.dragOverMouseY-w,O=this.renderHeight-35;D<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(D-35))):D>O&&(this.scrollTop+=Math.min(14,Math.floor(.3*(D-O))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(w,D){if(D===void 0)return;const O=w.offsetY/this.items[D].size,W=Math.floor(O/.25);return clamp(W,0,3)}getItemIndexFromEventTarget(w){const D=this.scrollableElement.getDomNode();let O=w;for(;(isHTMLElement(O)||isSVGElement(O))&&O!==this.rowsContainer&&D.contains(O);){const W=O.getAttribute("data-index");if(W){const U=Number(W);if(!isNaN(U))return U}O=O.parentElement}}getRenderRange(w,D){return{start:this.rangeMap.indexAt(w),end:this.rangeMap.indexAfter(w+D-1)}}_rerender(w,D,O){const W=this.getRenderRange(w,D);let U,K;w===this.elementTop(W.start)?(U=W.start,K=0):W.end-W.start>1&&(U=W.start+1,K=this.elementTop(U)-w);let q=0;for(;;){const G=this.getRenderRange(w,D);let Q=!1;for(let Y=G.start;Y<G.end;Y++){const X=this.probeDynamicHeight(Y);X!==0&&this.rangeMap.splice(Y,1,[this.items[Y]]),q+=X,Q=Q||X!==0}if(!Q){q!==0&&this.eventuallyUpdateScrollDimensions();const Y=Range$1.relativeComplement(W,G);for(const J of Y)for(let te=J.start;te<J.end;te++)this.items[te].row&&this.removeItemFromDOM(te);const X=Range$1.relativeComplement(G,W).reverse();for(const J of X)for(let te=J.end-1;te>=J.start;te--)this.insertItemInDOM(te);for(let J=G.start;J<G.end;J++)this.items[J].row&&this.updateItemInDOM(this.items[J],J);if(typeof U=="number"){const J=this.scrollable.getFutureScrollPosition().scrollTop-w,te=this.elementTop(U)-K+J;this.setScrollTop(te,O)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(w){const D=this.items[w];if(this.virtualDelegate.getDynamicHeight){const K=this.virtualDelegate.getDynamicHeight(D.element);if(K!==null){const q=D.size;return D.size=K,D.lastDynamicHeightWidth=this.renderWidth,K-q}}if(!D.hasDynamicHeight||D.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(D.element))return 0;const O=D.size;if(D.row)return D.row.domNode.style.height="",D.size=D.row.domNode.offsetHeight,D.size===0&&!isAncestor$1(D.row.domNode,getWindow(D.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),D.lastDynamicHeightWidth=this.renderWidth,D.size-O;const{row:W}=this.cache.alloc(D.templateId);W.domNode.style.height="",this.rowsContainer.appendChild(W.domNode);const U=this.renderers.get(D.templateId);if(!U)throw new BugIndicatingError("Missing renderer for templateId: "+D.templateId);return U.renderElement(D.element,w,W.templateData,void 0),D.size=W.domNode.offsetHeight,U.disposeElement?.(D.element,w,W.templateData,void 0),this.virtualDelegate.setDynamicHeight?.(D.element,D.size),D.lastDynamicHeightWidth=this.renderWidth,W.domNode.remove(),this.cache.release(W),D.size-O}getElementDomId(w){return`${this.domId}_${w}`}dispose(){for(const w of this.items)if(w.dragStartDisposable.dispose(),w.checkedDisposable.dispose(),w.row){const D=this.renderers.get(w.row.templateId);D&&(D.disposeElement?.(w.element,-1,w.row.templateData,void 0),D.disposeTemplate(w.row.templateData))}this.items=[],this.domNode?.remove(),this.dragOverAnimationDisposable?.dispose(),this.disposables.dispose()}}__decorate$19([memoize],ListView.prototype,"onMouseClick",null);__decorate$19([memoize],ListView.prototype,"onMouseDblClick",null);__decorate$19([memoize],ListView.prototype,"onMouseMiddleClick",null);__decorate$19([memoize],ListView.prototype,"onMouseDown",null);__decorate$19([memoize],ListView.prototype,"onMouseOver",null);__decorate$19([memoize],ListView.prototype,"onMouseOut",null);__decorate$19([memoize],ListView.prototype,"onContextMenu",null);__decorate$19([memoize],ListView.prototype,"onTouchStart",null);__decorate$19([memoize],ListView.prototype,"onTap",null);const strictEquals=(F,w)=>F===w;function itemsEquals(F=strictEquals){return(w,D)=>equals$1(w,D,F)}function equalsIfDefined(F,w,D){{const O=F;return(W,U)=>W==null||U===void 0||U===null?U===W:O(W,U)}}class DebugNameData{constructor(w,D,O){this.owner=w,this.debugNameSource=D,this.referenceFn=O}getDebugName(w){return getDebugName(w,this)}}const countPerName=new Map,cachedDebugName=new WeakMap;function getDebugName(F,w){const D=cachedDebugName.get(F);if(D)return D;const O=computeDebugName(F,w);if(O){let W=countPerName.get(O)??0;W++,countPerName.set(O,W);const U=W===1?O:`${O}#${W}`;return cachedDebugName.set(F,U),U}}function computeDebugName(F,w){const D=cachedDebugName.get(F);if(D)return D;const O=w.owner?formatOwner(w.owner)+".":"";let W;const U=w.debugNameSource;if(U!==void 0)if(typeof U=="function"){if(W=U(),W!==void 0)return O+W}else return O+U;const K=w.referenceFn;if(K!==void 0&&(W=getFunctionName(K),W!==void 0))return O+W;if(w.owner!==void 0){const q=findKey(w.owner,F);if(q!==void 0)return O+q}}function findKey(F,w){for(const D in F)if(F[D]===w)return D}const countPerClassName=new Map,ownerId=new WeakMap;function formatOwner(F){const w=ownerId.get(F);if(w)return w;const D=getClassName(F);let O=countPerClassName.get(D)??0;O++,countPerClassName.set(D,O);const W=O===1?D:`${D}#${O}`;return ownerId.set(F,W),W}function getClassName(F){const w=F.constructor;return w?w.name:"Object"}function getFunctionName(F){const w=F.toString(),O=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(w);return(O?O[1]:void 0)?.trim()}let globalObservableLogger;function getLogger(){return globalObservableLogger}let _recomputeInitiallyAndOnChange;function _setRecomputeInitiallyAndOnChange(F){_recomputeInitiallyAndOnChange=F}let _keepObserved;function _setKeepObserved(F){_keepObserved=F}let _derived;function _setDerivedOpts(F){_derived=F}class ConvenientObservable{get TChange(){return null}reportChanges(){this.get()}read(w){return w?w.readObservable(this):this.get()}map(w,D){const O=D===void 0?void 0:w,W=D===void 0?w:D;return _derived({owner:O,debugName:()=>{const U=getFunctionName(W);if(U!==void 0)return U;const q=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(W.toString());if(q)return`${this.debugName}.${q[2]}`;if(!O)return`${this.debugName} (mapped)`},debugReferenceFn:W},U=>W(this.read(U),U))}flatten(){return _derived({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},w=>this.read(w).read(w))}recomputeInitiallyAndOnChange(w,D){return w.add(_recomputeInitiallyAndOnChange(this,D)),this}keepObserved(w){return w.add(_keepObserved(this)),this}}class BaseObservable extends ConvenientObservable{constructor(){super(...arguments),this.observers=new Set}addObserver(w){const D=this.observers.size;this.observers.add(w),D===0&&this.onFirstObserverAdded()}removeObserver(w){this.observers.delete(w)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}}function transaction(F,w){const D=new TransactionImpl(F,w);try{F(D)}finally{D.finish()}}let _globalTransaction;function globalTransaction(F){if(_globalTransaction)F(_globalTransaction);else{const w=new TransactionImpl(F,void 0);_globalTransaction=w;try{F(w)}finally{w.finish(),_globalTransaction=void 0}}}function subtransaction(F,w,D){F?w(F):transaction(w,D)}class TransactionImpl{constructor(w,D){this._fn=w,this._getDebugName=D,this.updatingObservers=[]}getDebugName(){return this._getDebugName?this._getDebugName():getFunctionName(this._fn)}updateObserver(w,D){this.updatingObservers.push({observer:w,observable:D}),w.beginUpdate(D)}finish(){const w=this.updatingObservers;for(let D=0;D<w.length;D++){const{observer:O,observable:W}=w[D];O.endUpdate(W)}this.updatingObservers=null}}function observableValue(F,w){let D;return typeof F=="string"?D=new DebugNameData(void 0,F,void 0):D=new DebugNameData(F,void 0,void 0),new ObservableValue(D,w,strictEquals)}class ObservableValue extends BaseObservable{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(w,D,O){super(),this._debugNameData=w,this._equalityComparator=O,this._value=D}get(){return this._value}set(w,D,O){if(O===void 0&&this._equalityComparator(this._value,w))return;let W;D||(D=W=new TransactionImpl(()=>{},()=>`Setting ${this.debugName}`));try{const U=this._value;this._setValue(w),getLogger()?.handleObservableChanged(this,{oldValue:U,newValue:w,change:O,didChange:!0,hadValue:!0});for(const K of this.observers)D.updateObserver(K,this),K.handleChange(this,O)}finally{W&&W.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(w){this._value=w}}function disposableObservableValue(F,w){let D;return typeof F=="string"?D=new DebugNameData(void 0,F,void 0):D=new DebugNameData(F,void 0,void 0),new DisposableObservableValue(D,w,strictEquals)}class DisposableObservableValue extends ObservableValue{_setValue(w){this._value!==w&&(this._value&&this._value.dispose(),this._value=w)}dispose(){this._value?.dispose()}}function derived(F,w){return w!==void 0?new Derived(new DebugNameData(F,void 0,w),w,void 0,void 0,void 0,strictEquals):new Derived(new DebugNameData(void 0,void 0,F),F,void 0,void 0,void 0,strictEquals)}function derivedWithSetter(F,w,D){return new DerivedWithSetter(new DebugNameData(F,void 0,w),w,void 0,void 0,void 0,strictEquals,D)}function derivedOpts(F,w){return new Derived(new DebugNameData(F.owner,F.debugName,F.debugReferenceFn),w,void 0,void 0,F.onLastObserverRemoved,F.equalsFn??strictEquals)}_setDerivedOpts(derivedOpts);function derivedWithStore(F,w){let D,O;w===void 0?(D=F,O=void 0):(O=F,D=w);const W=new DisposableStore;return new Derived(new DebugNameData(O,void 0,D),U=>(W.clear(),D(U,W)),void 0,void 0,()=>W.dispose(),strictEquals)}function derivedDisposable(F,w){let D,O;w===void 0?(D=F,O=void 0):(O=F,D=w);let W;return new Derived(new DebugNameData(O,void 0,D),U=>{W?W.clear():W=new DisposableStore;const K=D(U);return K&&W.add(K),K},void 0,void 0,()=>{W&&(W.dispose(),W=void 0)},strictEquals)}class Derived extends BaseObservable{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(w,D,O,W,U=void 0,K){super(),this._debugNameData=w,this._computeFn=D,this.createChangeSummary=O,this._handleChange=W,this._handleLastObserverRemoved=U,this._equalityComparator=K,this.state=0,this.value=void 0,this.updateCount=0,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=void 0,this.changeSummary=this.createChangeSummary?.()}onLastObserverRemoved(){this.state=0,this.value=void 0;for(const w of this.dependencies)w.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){const w=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),w}else{do{if(this.state===1){for(const w of this.dependencies)if(w.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;const w=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=w;const D=this.state!==0,O=this.value;this.state=3;const W=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,W)}finally{for(const K of this.dependenciesToBeRemoved)K.removeObserver(this);this.dependenciesToBeRemoved.clear()}if(D&&!this._equalityComparator(O,this.value))for(const K of this.observers)K.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(w){this.updateCount++;const D=this.updateCount===1;if(this.state===3&&(this.state=1,!D))for(const O of this.observers)O.handlePossibleChange(this);if(D)for(const O of this.observers)O.beginUpdate(this)}endUpdate(w){if(this.updateCount--,this.updateCount===0){const D=[...this.observers];for(const O of D)O.endUpdate(this)}assertFn(()=>this.updateCount>=0)}handlePossibleChange(w){if(this.state===3&&this.dependencies.has(w)&&!this.dependenciesToBeRemoved.has(w)){this.state=1;for(const D of this.observers)D.handlePossibleChange(this)}}handleChange(w,D){if(this.dependencies.has(w)&&!this.dependenciesToBeRemoved.has(w)){const O=this._handleChange?this._handleChange({changedObservable:w,change:D,didChange:U=>U===w},this.changeSummary):!0,W=this.state===3;if(O&&(this.state===1||W)&&(this.state=2,W))for(const U of this.observers)U.handlePossibleChange(this)}}readObservable(w){w.addObserver(this);const D=w.get();return this.dependencies.add(w),this.dependenciesToBeRemoved.delete(w),D}addObserver(w){const D=!this.observers.has(w)&&this.updateCount>0;super.addObserver(w),D&&w.beginUpdate(this)}removeObserver(w){const D=this.observers.has(w)&&this.updateCount>0;super.removeObserver(w),D&&w.endUpdate(this)}}class DerivedWithSetter extends Derived{constructor(w,D,O,W,U=void 0,K,q){super(w,D,O,W,U,K),this.set=q}}function autorun(F){return new AutorunObserver(new DebugNameData(void 0,void 0,F),F,void 0,void 0)}function autorunOpts(F,w){return new AutorunObserver(new DebugNameData(F.owner,F.debugName,F.debugReferenceFn??w),w,void 0,void 0)}function autorunHandleChanges(F,w){return new AutorunObserver(new DebugNameData(F.owner,F.debugName,F.debugReferenceFn??w),w,F.createEmptyChangeSummary,F.handleChange)}function autorunWithStore(F){const w=new DisposableStore,D=autorunOpts({owner:void 0,debugName:void 0,debugReferenceFn:F},O=>{w.clear(),F(O,w)});return toDisposable(()=>{D.dispose(),w.dispose()})}class AutorunObserver{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(w,D,O,W){this._debugNameData=w,this._runFn=D,this.createChangeSummary=O,this._handleChange=W,this.state=2,this.updateCount=0,this.disposed=!1,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=this.createChangeSummary?.(),this._runIfNeeded()}dispose(){this.disposed=!0;for(const w of this.dependencies)w.removeObserver(this);this.dependencies.clear()}_runIfNeeded(){if(this.state===3)return;const w=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=w,this.state=3;const D=this.disposed;try{if(!D){getLogger()?.handleAutorunTriggered(this);const O=this.changeSummary;this.changeSummary=this.createChangeSummary?.(),this._runFn(this,O)}}finally{for(const O of this.dependenciesToBeRemoved)O.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){if(this.updateCount===1)do{if(this.state===1){this.state=3;for(const w of this.dependencies)if(w.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3);this.updateCount--,assertFn(()=>this.updateCount>=0)}handlePossibleChange(w){this.state===3&&this.dependencies.has(w)&&!this.dependenciesToBeRemoved.has(w)&&(this.state=1)}handleChange(w,D){this.dependencies.has(w)&&!this.dependenciesToBeRemoved.has(w)&&(!this._handleChange||this._handleChange({changedObservable:w,change:D,didChange:W=>W===w},this.changeSummary))&&(this.state=2)}readObservable(w){if(this.disposed)return w.get();w.addObserver(this);const D=w.get();return this.dependencies.add(w),this.dependenciesToBeRemoved.delete(w),D}}(function(F){F.Observer=AutorunObserver})(autorun||(autorun={}));function constObservable(F){return new ConstObservable(F)}class ConstObservable extends ConvenientObservable{constructor(w){super(),this.value=w}get debugName(){return this.toString()}get(){return this.value}addObserver(w){}removeObserver(w){}toString(){return`Const: ${this.value}`}}function observableFromEvent(...F){let w,D,O;return F.length===3?[w,D,O]=F:[D,O]=F,new FromEventObservable(new DebugNameData(w,void 0,O),D,O,()=>FromEventObservable.globalTransaction,strictEquals)}class FromEventObservable extends BaseObservable{constructor(w,D,O,W,U){super(),this._debugNameData=w,this.event=D,this._getValue=O,this._getTransaction=W,this._equalityComparator=U,this.hasValue=!1,this.handleEvent=K=>{const q=this._getValue(K),G=this.value;(!this.hasValue||!this._equalityComparator(G,q))&&(this.value=q,this.hasValue&&subtransaction(this._getTransaction(),Y=>{for(const X of this.observers)Y.updateObserver(X,this),X.handleChange(this,void 0)},()=>{const Y=this.getDebugName();return"Event fired"+(Y?`: ${Y}`:"")}),this.hasValue=!0)}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){const w=this.getDebugName();return"From Event"+(w?`: ${w}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}}(function(F){F.Observer=FromEventObservable;function w(D,O){let W=!1;FromEventObservable.globalTransaction===void 0&&(FromEventObservable.globalTransaction=D,W=!0);try{O()}finally{W&&(FromEventObservable.globalTransaction=void 0)}}F.batchEventsGlobally=w})(observableFromEvent||(observableFromEvent={}));function observableSignalFromEvent(F,w){return new FromEventObservableSignal(F,w)}class FromEventObservableSignal extends BaseObservable{constructor(w,D){super(),this.debugName=w,this.event=D,this.handleEvent=()=>{transaction(O=>{for(const W of this.observers)O.updateObserver(W,this),W.handleChange(this,void 0)},()=>this.debugName)}}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}}function observableSignal(F){return typeof F=="string"?new ObservableSignal(F):new ObservableSignal(void 0,F)}class ObservableSignal extends BaseObservable{get debugName(){return new DebugNameData(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}constructor(w,D){super(),this._debugName=w,this._owner=D}trigger(w,D){if(!w){transaction(O=>{this.trigger(O,D)},()=>`Trigger signal ${this.debugName}`);return}for(const O of this.observers)w.updateObserver(O,this),O.handleChange(this,D)}get(){}}function keepObserved(F){const w=new KeepAliveObserver(!1,void 0);return F.addObserver(w),toDisposable(()=>{F.removeObserver(w)})}_setKeepObserved(keepObserved);function recomputeInitiallyAndOnChange(F,w){const D=new KeepAliveObserver(!0,w);return F.addObserver(D),w?w(F.get()):F.reportChanges(),toDisposable(()=>{F.removeObserver(D)})}_setRecomputeInitiallyAndOnChange(recomputeInitiallyAndOnChange);class KeepAliveObserver{constructor(w,D){this._forceRecompute=w,this._handleValue=D,this._counter=0}beginUpdate(w){this._counter++}endUpdate(w){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(w.get()):w.reportChanges())}handlePossibleChange(w){}handleChange(w,D){}}function derivedObservableWithCache(F,w){let D;return derivedOpts({owner:F,debugReferenceFn:w},W=>(D=w(W,D),D))}function derivedConstOnceDefined(F,w){return derivedObservableWithCache(F,(D,O)=>O??w(D))}function waitForState(F,w,D,O){return w||(w=W=>W!=null),new Promise((W,U)=>{let K=!0,q=!1;const G=F.map(Y=>({isFinished:w(Y),error:!1,state:Y})),Q=autorun(Y=>{const{isFinished:X,error:J,state:te}=G.read(Y);(X||J)&&(K?q=!0:Q.dispose(),J?U(J===!0?te:J):W(te))});K=!1,q&&Q.dispose()})}class LazyObservableValue extends BaseObservable{get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}constructor(w,D,O){super(),this._debugNameData=w,this._equalityComparator=O,this._isUpToDate=!0,this._deltas=[],this._updateCounter=0,this._value=D}get(){return this._update(),this._value}_update(){if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(const w of this.observers)for(const D of this._deltas)w.handleChange(this,D);this._deltas.length=0}else for(const w of this.observers)w.handleChange(this,void 0)}_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(const w of this.observers)w.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();const w=[...this.observers];for(const D of w)D.endUpdate(this)}}addObserver(w){const D=!this.observers.has(w)&&this._updateCounter>0;super.addObserver(w),D&&w.beginUpdate(this)}removeObserver(w){const D=this.observers.has(w)&&this._updateCounter>0;super.removeObserver(w),D&&w.endUpdate(this)}set(w,D,O){if(O===void 0&&this._equalityComparator(this._value,w))return;let W;D||(D=W=new TransactionImpl(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(w),O!==void 0&&this._deltas.push(O),D.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(U,K)=>{},handlePossibleChange:U=>{}},this),this._updateCounter>1)for(const U of this.observers)U.handlePossibleChange(this)}finally{W&&W.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(w){this._value=w}}function observableValueOpts(F,w){return F.lazy?new LazyObservableValue(new DebugNameData(F.owner,F.debugName,void 0),w,F.equalsFn??strictEquals):new ObservableValue(new DebugNameData(F.owner,F.debugName,void 0),w,F.equalsFn??strictEquals)}var __decorate$18=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U};class TraitRenderer{constructor(w){this.trait=w,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(w){return w}renderElement(w,D,O){const W=this.renderedElements.findIndex(U=>U.templateData===O);if(W>=0){const U=this.renderedElements[W];this.trait.unrender(O),U.index=D}else{const U={index:D,templateData:O};this.renderedElements.push(U)}this.trait.renderIndex(D,O)}splice(w,D,O){const W=[];for(const U of this.renderedElements)U.index<w?W.push(U):U.index>=w+D&&W.push({index:U.index+O-D,templateData:U.templateData});this.renderedElements=W}renderIndexes(w){for(const{index:D,templateData:O}of this.renderedElements)w.indexOf(D)>-1&&this.trait.renderIndex(D,O)}disposeTemplate(w){const D=this.renderedElements.findIndex(O=>O.templateData===w);D<0||this.renderedElements.splice(D,1)}}let Trait$1=class{get name(){return this._trait}get renderer(){return new TraitRenderer(this)}constructor(w){this._trait=w,this.indexes=[],this.sortedIndexes=[],this._onChange=new Emitter$1,this.onChange=this._onChange.event}splice(w,D,O){const W=O.length-D,U=w+D,K=[];let q=0;for(;q<this.sortedIndexes.length&&this.sortedIndexes[q]<w;)K.push(this.sortedIndexes[q++]);for(let G=0;G<O.length;G++)O[G]&&K.push(G+w);for(;q<this.sortedIndexes.length&&this.sortedIndexes[q]>=U;)K.push(this.sortedIndexes[q++]+W);this.renderer.splice(w,D,O.length),this._set(K,K)}renderIndex(w,D){D.classList.toggle(this._trait,this.contains(w))}unrender(w){w.classList.remove(this._trait)}set(w,D){return this._set(w,[...w].sort(numericSort),D)}_set(w,D,O){const W=this.indexes,U=this.sortedIndexes;this.indexes=w,this.sortedIndexes=D;const K=disjunction(U,w);return this.renderer.renderIndexes(K),this._onChange.fire({indexes:w,browserEvent:O}),W}get(){return this.indexes}contains(w){return binarySearch(this.sortedIndexes,w,numericSort)>=0}dispose(){dispose(this._onChange)}};__decorate$18([memoize],Trait$1.prototype,"renderer",null);class SelectionTrait extends Trait$1{constructor(w){super("selected"),this.setAriaSelected=w}renderIndex(w,D){super.renderIndex(w,D),this.setAriaSelected&&(this.contains(w)?D.setAttribute("aria-selected","true"):D.setAttribute("aria-selected","false"))}}class TraitSpliceable{constructor(w,D,O){this.trait=w,this.view=D,this.identityProvider=O}splice(w,D,O){if(!this.identityProvider)return this.trait.splice(w,D,new Array(O.length).fill(!1));const W=this.trait.get().map(q=>this.identityProvider.getId(this.view.element(q)).toString());if(W.length===0)return this.trait.splice(w,D,new Array(O.length).fill(!1));const U=new Set(W),K=O.map(q=>U.has(this.identityProvider.getId(q).toString()));this.trait.splice(w,D,K)}}function isInputElement(F){return F.tagName==="INPUT"||F.tagName==="TEXTAREA"}function isListElementDescendantOfClass(F,w){return F.classList.contains(w)?!0:F.classList.contains("monaco-list")||!F.parentElement?!1:isListElementDescendantOfClass(F.parentElement,w)}function isMonacoEditor(F){return isListElementDescendantOfClass(F,"monaco-editor")}function isMonacoCustomToggle(F){return isListElementDescendantOfClass(F,"monaco-custom-toggle")}function isActionItem(F){return isListElementDescendantOfClass(F,"action-item")}function isStickyScrollElement(F){return isListElementDescendantOfClass(F,"monaco-tree-sticky-row")}function isStickyScrollContainer(F){return F.classList.contains("monaco-tree-sticky-container")}function isButton(F){return F.tagName==="A"&&F.classList.contains("monaco-button")||F.tagName==="DIV"&&F.classList.contains("monaco-button-dropdown")?!0:F.classList.contains("monaco-list")||!F.parentElement?!1:isButton(F.parentElement)}class KeyboardController{get onKeyDown(){return Event$1.chain(this.disposables.add(new DomEmitter(this.view.domNode,"keydown")).event,w=>w.filter(D=>!isInputElement(D.target)).map(D=>new StandardKeyboardEvent(D)))}constructor(w,D,O){this.list=w,this.view=D,this.disposables=new DisposableStore,this.multipleSelectionDisposables=new DisposableStore,this.multipleSelectionSupport=O.multipleSelectionSupport,this.disposables.add(this.onKeyDown(W=>{switch(W.keyCode){case 3:return this.onEnter(W);case 16:return this.onUpArrow(W);case 18:return this.onDownArrow(W);case 11:return this.onPageUpArrow(W);case 12:return this.onPageDownArrow(W);case 9:return this.onEscape(W);case 31:this.multipleSelectionSupport&&(isMacintosh?W.metaKey:W.ctrlKey)&&this.onCtrlA(W)}}))}updateOptions(w){w.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=w.multipleSelectionSupport)}onEnter(w){w.preventDefault(),w.stopPropagation(),this.list.setSelection(this.list.getFocus(),w.browserEvent)}onUpArrow(w){w.preventDefault(),w.stopPropagation(),this.list.focusPrevious(1,!1,w.browserEvent);const D=this.list.getFocus()[0];this.list.setAnchor(D),this.list.reveal(D),this.view.domNode.focus()}onDownArrow(w){w.preventDefault(),w.stopPropagation(),this.list.focusNext(1,!1,w.browserEvent);const D=this.list.getFocus()[0];this.list.setAnchor(D),this.list.reveal(D),this.view.domNode.focus()}onPageUpArrow(w){w.preventDefault(),w.stopPropagation(),this.list.focusPreviousPage(w.browserEvent);const D=this.list.getFocus()[0];this.list.setAnchor(D),this.list.reveal(D),this.view.domNode.focus()}onPageDownArrow(w){w.preventDefault(),w.stopPropagation(),this.list.focusNextPage(w.browserEvent);const D=this.list.getFocus()[0];this.list.setAnchor(D),this.list.reveal(D),this.view.domNode.focus()}onCtrlA(w){w.preventDefault(),w.stopPropagation(),this.list.setSelection(range(this.list.length),w.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(w){this.list.getSelection().length&&(w.preventDefault(),w.stopPropagation(),this.list.setSelection([],w.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}__decorate$18([memoize],KeyboardController.prototype,"onKeyDown",null);var TypeNavigationMode;(function(F){F[F.Automatic=0]="Automatic",F[F.Trigger=1]="Trigger"})(TypeNavigationMode||(TypeNavigationMode={}));var TypeNavigationControllerState;(function(F){F[F.Idle=0]="Idle",F[F.Typing=1]="Typing"})(TypeNavigationControllerState||(TypeNavigationControllerState={}));const DefaultKeyboardNavigationDelegate=new class{mightProducePrintableCharacter(F){return F.ctrlKey||F.metaKey||F.altKey?!1:F.keyCode>=31&&F.keyCode<=56||F.keyCode>=21&&F.keyCode<=30||F.keyCode>=98&&F.keyCode<=107||F.keyCode>=85&&F.keyCode<=95}};class TypeNavigationController{constructor(w,D,O,W,U){this.list=w,this.view=D,this.keyboardNavigationLabelProvider=O,this.keyboardNavigationEventFilter=W,this.delegate=U,this.enabled=!1,this.state=TypeNavigationControllerState.Idle,this.mode=TypeNavigationMode.Automatic,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new DisposableStore,this.disposables=new DisposableStore,this.updateOptions(w.options)}updateOptions(w){w.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=w.typeNavigationMode??TypeNavigationMode.Automatic}enable(){if(this.enabled)return;let w=!1;const D=Event$1.chain(this.enabledDisposables.add(new DomEmitter(this.view.domNode,"keydown")).event,U=>U.filter(K=>!isInputElement(K.target)).filter(()=>this.mode===TypeNavigationMode.Automatic||this.triggered).map(K=>new StandardKeyboardEvent(K)).filter(K=>w||this.keyboardNavigationEventFilter(K)).filter(K=>this.delegate.mightProducePrintableCharacter(K)).forEach(K=>EventHelper.stop(K,!0)).map(K=>K.browserEvent.key)),O=Event$1.debounce(D,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);Event$1.reduce(Event$1.any(D,O),(U,K)=>K===null?null:(U||"")+K,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),O(this.onClear,this,this.enabledDisposables),D(()=>w=!0,void 0,this.enabledDisposables),O(()=>w=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){const w=this.list.getFocus();if(w.length>0&&w[0]===this.previouslyFocused){const D=this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(w[0]));typeof D=="string"?alert(D):D&&alert(D.get())}this.previouslyFocused=-1}onInput(w){if(!w){this.state=TypeNavigationControllerState.Idle,this.triggered=!1;return}const D=this.list.getFocus(),O=D.length>0?D[0]:0,W=this.state===TypeNavigationControllerState.Idle?1:0;this.state=TypeNavigationControllerState.Typing;for(let U=0;U<this.list.length;U++){const K=(O+U+W)%this.list.length,q=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(K)),G=q&&q.toString();if(this.list.options.typeNavigationEnabled){if(typeof G<"u"){if(matchesPrefix(w,G)){this.previouslyFocused=O,this.list.setFocus([K]),this.list.reveal(K);return}const Q=matchesFuzzy2(w,G);if(Q&&Q[0].end-Q[0].start>1&&Q.length===1){this.previouslyFocused=O,this.list.setFocus([K]),this.list.reveal(K);return}}}else if(typeof G>"u"||matchesPrefix(w,G)){this.previouslyFocused=O,this.list.setFocus([K]),this.list.reveal(K);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class DOMFocusController{constructor(w,D){this.list=w,this.view=D,this.disposables=new DisposableStore;const O=Event$1.chain(this.disposables.add(new DomEmitter(D.domNode,"keydown")).event,U=>U.filter(K=>!isInputElement(K.target)).map(K=>new StandardKeyboardEvent(K)));Event$1.chain(O,U=>U.filter(K=>K.keyCode===2&&!K.ctrlKey&&!K.metaKey&&!K.shiftKey&&!K.altKey))(this.onTab,this,this.disposables)}onTab(w){if(w.target!==this.view.domNode)return;const D=this.list.getFocus();if(D.length===0)return;const O=this.view.domElement(D[0]);if(!O)return;const W=O.querySelector("[tabIndex]");if(!W||!isHTMLElement(W)||W.tabIndex===-1)return;const U=getWindow(W).getComputedStyle(W);U.visibility==="hidden"||U.display==="none"||(w.preventDefault(),w.stopPropagation(),W.focus())}dispose(){this.disposables.dispose()}}function isSelectionSingleChangeEvent(F){return isMacintosh?F.browserEvent.metaKey:F.browserEvent.ctrlKey}function isSelectionRangeChangeEvent(F){return F.browserEvent.shiftKey}function isMouseRightClick(F){return isMouseEvent(F)&&F.button===2}const DefaultMultipleSelectionController={isSelectionSingleChangeEvent,isSelectionRangeChangeEvent};class MouseController{constructor(w){this.list=w,this.disposables=new DisposableStore,this._onPointer=new Emitter$1,this.onPointer=this._onPointer.event,w.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||DefaultMultipleSelectionController),this.mouseSupport=typeof w.options.mouseSupport>"u"||!!w.options.mouseSupport,this.mouseSupport&&(w.onMouseDown(this.onMouseDown,this,this.disposables),w.onContextMenu(this.onContextMenu,this,this.disposables),w.onMouseDblClick(this.onDoubleClick,this,this.disposables),w.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Gesture.addTarget(w.getHTMLElement()))),Event$1.any(w.onMouseClick,w.onMouseMiddleClick,w.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(w){w.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,w.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||DefaultMultipleSelectionController))}isSelectionSingleChangeEvent(w){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(w):!1}isSelectionRangeChangeEvent(w){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(w):!1}isSelectionChangeEvent(w){return this.isSelectionSingleChangeEvent(w)||this.isSelectionRangeChangeEvent(w)}onMouseDown(w){isMonacoEditor(w.browserEvent.target)||getActiveElement()!==w.browserEvent.target&&this.list.domFocus()}onContextMenu(w){if(isInputElement(w.browserEvent.target)||isMonacoEditor(w.browserEvent.target))return;const D=typeof w.index>"u"?[]:[w.index];this.list.setFocus(D,w.browserEvent)}onViewPointer(w){if(!this.mouseSupport||isInputElement(w.browserEvent.target)||isMonacoEditor(w.browserEvent.target)||w.browserEvent.isHandledByList)return;w.browserEvent.isHandledByList=!0;const D=w.index;if(typeof D>"u"){this.list.setFocus([],w.browserEvent),this.list.setSelection([],w.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(w))return this.changeSelection(w);this.list.setFocus([D],w.browserEvent),this.list.setAnchor(D),isMouseRightClick(w.browserEvent)||this.list.setSelection([D],w.browserEvent),this._onPointer.fire(w)}onDoubleClick(w){if(isInputElement(w.browserEvent.target)||isMonacoEditor(w.browserEvent.target)||this.isSelectionChangeEvent(w)||w.browserEvent.isHandledByList)return;w.browserEvent.isHandledByList=!0;const D=this.list.getFocus();this.list.setSelection(D,w.browserEvent)}changeSelection(w){const D=w.index;let O=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(w)){typeof O>"u"&&(O=this.list.getFocus()[0]??D,this.list.setAnchor(O));const W=Math.min(O,D),U=Math.max(O,D),K=range(W,U+1),q=this.list.getSelection(),G=getContiguousRangeContaining(disjunction(q,[O]),O);if(G.length===0)return;const Q=disjunction(K,relativeComplement(q,G));this.list.setSelection(Q,w.browserEvent),this.list.setFocus([D],w.browserEvent)}else if(this.isSelectionSingleChangeEvent(w)){const W=this.list.getSelection(),U=W.filter(K=>K!==D);this.list.setFocus([D]),this.list.setAnchor(D),W.length===U.length?this.list.setSelection([...U,D],w.browserEvent):this.list.setSelection(U,w.browserEvent)}}dispose(){this.disposables.dispose()}}class DefaultStyleController{constructor(w,D){this.styleElement=w,this.selectorSuffix=D}style(w){const D=this.selectorSuffix&&`.${this.selectorSuffix}`,O=[];w.listBackground&&O.push(`.monaco-list${D} .monaco-list-rows { background: ${w.listBackground}; }`),w.listFocusBackground&&(O.push(`.monaco-list${D}:focus .monaco-list-row.focused { background-color: ${w.listFocusBackground}; }`),O.push(`.monaco-list${D}:focus .monaco-list-row.focused:hover { background-color: ${w.listFocusBackground}; }`)),w.listFocusForeground&&O.push(`.monaco-list${D}:focus .monaco-list-row.focused { color: ${w.listFocusForeground}; }`),w.listActiveSelectionBackground&&(O.push(`.monaco-list${D}:focus .monaco-list-row.selected { background-color: ${w.listActiveSelectionBackground}; }`),O.push(`.monaco-list${D}:focus .monaco-list-row.selected:hover { background-color: ${w.listActiveSelectionBackground}; }`)),w.listActiveSelectionForeground&&O.push(`.monaco-list${D}:focus .monaco-list-row.selected { color: ${w.listActiveSelectionForeground}; }`),w.listActiveSelectionIconForeground&&O.push(`.monaco-list${D}:focus .monaco-list-row.selected .codicon { color: ${w.listActiveSelectionIconForeground}; }`),w.listFocusAndSelectionBackground&&O.push(`
				.monaco-drag-image,
				.monaco-list${D}:focus .monaco-list-row.selected.focused { background-color: ${w.listFocusAndSelectionBackground}; }
			`),w.listFocusAndSelectionForeground&&O.push(`
				.monaco-drag-image,
				.monaco-list${D}:focus .monaco-list-row.selected.focused { color: ${w.listFocusAndSelectionForeground}; }
			`),w.listInactiveFocusForeground&&(O.push(`.monaco-list${D} .monaco-list-row.focused { color:  ${w.listInactiveFocusForeground}; }`),O.push(`.monaco-list${D} .monaco-list-row.focused:hover { color:  ${w.listInactiveFocusForeground}; }`)),w.listInactiveSelectionIconForeground&&O.push(`.monaco-list${D} .monaco-list-row.focused .codicon { color:  ${w.listInactiveSelectionIconForeground}; }`),w.listInactiveFocusBackground&&(O.push(`.monaco-list${D} .monaco-list-row.focused { background-color:  ${w.listInactiveFocusBackground}; }`),O.push(`.monaco-list${D} .monaco-list-row.focused:hover { background-color:  ${w.listInactiveFocusBackground}; }`)),w.listInactiveSelectionBackground&&(O.push(`.monaco-list${D} .monaco-list-row.selected { background-color:  ${w.listInactiveSelectionBackground}; }`),O.push(`.monaco-list${D} .monaco-list-row.selected:hover { background-color:  ${w.listInactiveSelectionBackground}; }`)),w.listInactiveSelectionForeground&&O.push(`.monaco-list${D} .monaco-list-row.selected { color: ${w.listInactiveSelectionForeground}; }`),w.listHoverBackground&&O.push(`.monaco-list${D}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${w.listHoverBackground}; }`),w.listHoverForeground&&O.push(`.monaco-list${D}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${w.listHoverForeground}; }`);const W=asCssValueWithDefault(w.listFocusAndSelectionOutline,asCssValueWithDefault(w.listSelectionOutline,w.listFocusOutline??""));W&&O.push(`.monaco-list${D}:focus .monaco-list-row.focused.selected { outline: 1px solid ${W}; outline-offset: -1px;}`),w.listFocusOutline&&O.push(`
				.monaco-drag-image,
				.monaco-list${D}:focus .monaco-list-row.focused { outline: 1px solid ${w.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${D}.last-focused .monaco-list-row.focused { outline: 1px solid ${w.listFocusOutline}; outline-offset: -1px; }
			`);const U=asCssValueWithDefault(w.listSelectionOutline,w.listInactiveFocusOutline??"");U&&O.push(`.monaco-list${D} .monaco-list-row.focused.selected { outline: 1px dotted ${U}; outline-offset: -1px; }`),w.listSelectionOutline&&O.push(`.monaco-list${D} .monaco-list-row.selected { outline: 1px dotted ${w.listSelectionOutline}; outline-offset: -1px; }`),w.listInactiveFocusOutline&&O.push(`.monaco-list${D} .monaco-list-row.focused { outline: 1px dotted ${w.listInactiveFocusOutline}; outline-offset: -1px; }`),w.listHoverOutline&&O.push(`.monaco-list${D} .monaco-list-row:hover { outline: 1px dashed ${w.listHoverOutline}; outline-offset: -1px; }`),w.listDropOverBackground&&O.push(`
				.monaco-list${D}.drop-target,
				.monaco-list${D} .monaco-list-rows.drop-target,
				.monaco-list${D} .monaco-list-row.drop-target { background-color: ${w.listDropOverBackground} !important; color: inherit !important; }
			`),w.listDropBetweenBackground&&(O.push(`
			.monaco-list${D} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${D} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${w.listDropBetweenBackground};
			}`),O.push(`
			.monaco-list${D} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${D} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${w.listDropBetweenBackground};
			}`)),w.tableColumnsBorder&&O.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${w.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),w.tableOddRowsBackgroundColor&&O.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${w.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=O.join(`
`)}}const unthemedListStyles={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:Color.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:Color.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:Color.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},DefaultOptions={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function getContiguousRangeContaining(F,w){const D=F.indexOf(w);if(D===-1)return[];const O=[];let W=D-1;for(;W>=0&&F[W]===w-(D-W);)O.push(F[W--]);for(O.reverse(),W=D;W<F.length&&F[W]===w+(W-D);)O.push(F[W++]);return O}function disjunction(F,w){const D=[];let O=0,W=0;for(;O<F.length||W<w.length;)if(O>=F.length)D.push(w[W++]);else if(W>=w.length)D.push(F[O++]);else if(F[O]===w[W]){D.push(F[O]),O++,W++;continue}else F[O]<w[W]?D.push(F[O++]):D.push(w[W++]);return D}function relativeComplement(F,w){const D=[];let O=0,W=0;for(;O<F.length||W<w.length;)if(O>=F.length)D.push(w[W++]);else if(W>=w.length)D.push(F[O++]);else if(F[O]===w[W]){O++,W++;continue}else F[O]<w[W]?D.push(F[O++]):W++;return D}const numericSort=(F,w)=>F-w;class PipelineRenderer{constructor(w,D){this._templateId=w,this.renderers=D}get templateId(){return this._templateId}renderTemplate(w){return this.renderers.map(D=>D.renderTemplate(w))}renderElement(w,D,O,W){let U=0;for(const K of this.renderers)K.renderElement(w,D,O[U++],W)}disposeElement(w,D,O,W){let U=0;for(const K of this.renderers)K.disposeElement?.(w,D,O[U],W),U+=1}disposeTemplate(w){let D=0;for(const O of this.renderers)O.disposeTemplate(w[D++])}}class AccessibiltyRenderer{constructor(w){this.accessibilityProvider=w,this.templateId="a18n"}renderTemplate(w){return{container:w,disposables:new DisposableStore}}renderElement(w,D,O){const W=this.accessibilityProvider.getAriaLabel(w),U=W&&typeof W!="string"?W:constObservable(W);O.disposables.add(autorun(q=>{this.setAriaLabel(q.readObservable(U),O.container)}));const K=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(w);typeof K=="number"?O.container.setAttribute("aria-level",`${K}`):O.container.removeAttribute("aria-level")}setAriaLabel(w,D){w?D.setAttribute("aria-label",w):D.removeAttribute("aria-label")}disposeElement(w,D,O,W){O.disposables.clear()}disposeTemplate(w){w.disposables.dispose()}}class ListViewDragAndDrop{constructor(w,D){this.list=w,this.dnd=D}getDragElements(w){const D=this.list.getSelectedElements();return D.indexOf(w)>-1?D:[w]}getDragURI(w){return this.dnd.getDragURI(w)}getDragLabel(w,D){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(w,D)}onDragStart(w,D){this.dnd.onDragStart?.(w,D)}onDragOver(w,D,O,W,U){return this.dnd.onDragOver(w,D,O,W,U)}onDragLeave(w,D,O,W){this.dnd.onDragLeave?.(w,D,O,W)}onDragEnd(w){this.dnd.onDragEnd?.(w)}drop(w,D,O,W,U){this.dnd.drop(w,D,O,W,U)}dispose(){this.dnd.dispose()}}class List{get onDidChangeFocus(){return Event$1.map(this.eventBufferer.wrapEvent(this.focus.onChange),w=>this.toListEvent(w),this.disposables)}get onDidChangeSelection(){return Event$1.map(this.eventBufferer.wrapEvent(this.selection.onChange),w=>this.toListEvent(w),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let w=!1;const D=Event$1.chain(this.disposables.add(new DomEmitter(this.view.domNode,"keydown")).event,U=>U.map(K=>new StandardKeyboardEvent(K)).filter(K=>w=K.keyCode===58||K.shiftKey&&K.keyCode===68).map(K=>EventHelper.stop(K,!0)).filter(()=>!1)),O=Event$1.chain(this.disposables.add(new DomEmitter(this.view.domNode,"keyup")).event,U=>U.forEach(()=>w=!1).map(K=>new StandardKeyboardEvent(K)).filter(K=>K.keyCode===58||K.shiftKey&&K.keyCode===68).map(K=>EventHelper.stop(K,!0)).map(({browserEvent:K})=>{const q=this.getFocus(),G=q.length?q[0]:void 0,Q=typeof G<"u"?this.view.element(G):void 0,Y=typeof G<"u"?this.view.domElement(G):this.view.domNode;return{index:G,element:Q,anchor:Y,browserEvent:K}})),W=Event$1.chain(this.view.onContextMenu,U=>U.filter(K=>!w).map(({element:K,index:q,browserEvent:G})=>({element:K,index:q,anchor:new StandardMouseEvent(getWindow(this.view.domNode),G),browserEvent:G})));return Event$1.any(D,O,W)}get onKeyDown(){return this.disposables.add(new DomEmitter(this.view.domNode,"keydown")).event}get onDidFocus(){return Event$1.signal(this.disposables.add(new DomEmitter(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return Event$1.signal(this.disposables.add(new DomEmitter(this.view.domNode,"blur",!0)).event)}constructor(w,D,O,W,U=DefaultOptions){this.user=w,this._options=U,this.focus=new Trait$1("focused"),this.anchor=new Trait$1("anchor"),this.eventBufferer=new EventBufferer,this._ariaLabel="",this.disposables=new DisposableStore,this._onDidDispose=new Emitter$1,this.onDidDispose=this._onDidDispose.event;const K=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?this._options.accessibilityProvider?.getWidgetRole():"list";this.selection=new SelectionTrait(K!=="listbox");const q=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=U.accessibilityProvider,this.accessibilityProvider&&(q.push(new AccessibiltyRenderer(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant,this,this.disposables)),W=W.map(Q=>new PipelineRenderer(Q.templateId,[...q,Q]));const G={...U,dnd:U.dnd&&new ListViewDragAndDrop(this,U.dnd)};if(this.view=this.createListView(D,O,W,G),this.view.domNode.setAttribute("role",K),U.styleController)this.styleController=U.styleController(this.view.domId);else{const Q=createStyleSheet(this.view.domNode);this.styleController=new DefaultStyleController(Q,this.view.domId)}if(this.spliceable=new CombinedSpliceable([new TraitSpliceable(this.focus,this.view,U.identityProvider),new TraitSpliceable(this.selection,this.view,U.identityProvider),new TraitSpliceable(this.anchor,this.view,U.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new DOMFocusController(this,this.view)),(typeof U.keyboardSupport!="boolean"||U.keyboardSupport)&&(this.keyboardController=new KeyboardController(this,this.view,U),this.disposables.add(this.keyboardController)),U.keyboardNavigationLabelProvider){const Q=U.keyboardNavigationDelegate||DefaultKeyboardNavigationDelegate;this.typeNavigationController=new TypeNavigationController(this,this.view,U.keyboardNavigationLabelProvider,U.keyboardNavigationEventFilter??(()=>!0),Q),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(U),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}createListView(w,D,O,W){return new ListView(w,D,O,W)}createMouseController(w){return new MouseController(this)}updateOptions(w={}){this._options={...this._options,...w},this.typeNavigationController?.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(w),this.keyboardController?.updateOptions(w),this.view.updateOptions(w)}get options(){return this._options}splice(w,D,O=[]){if(w<0||w>this.view.length)throw new ListError(this.user,`Invalid start index: ${w}`);if(D<0)throw new ListError(this.user,`Invalid delete count: ${D}`);D===0&&O.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(w,D,O))}rerender(){this.view.rerender()}element(w){return this.view.element(w)}indexOf(w){return this.view.indexOf(w)}indexAt(w){return this.view.indexAt(w)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(w){this.view.setScrollTop(w)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(w){this._ariaLabel=w,this.view.domNode.setAttribute("aria-label",w)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(w,D){this.view.layout(w,D)}setSelection(w,D){for(const O of w)if(O<0||O>=this.length)throw new ListError(this.user,`Invalid index ${O}`);this.selection.set(w,D)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(w=>this.view.element(w))}setAnchor(w){if(typeof w>"u"){this.anchor.set([]);return}if(w<0||w>=this.length)throw new ListError(this.user,`Invalid index ${w}`);this.anchor.set([w])}getAnchor(){return firstOrDefault(this.anchor.get(),void 0)}getAnchorElement(){const w=this.getAnchor();return typeof w>"u"?void 0:this.element(w)}setFocus(w,D){for(const O of w)if(O<0||O>=this.length)throw new ListError(this.user,`Invalid index ${O}`);this.focus.set(w,D)}focusNext(w=1,D=!1,O,W){if(this.length===0)return;const U=this.focus.get(),K=this.findNextIndex(U.length>0?U[0]+w:0,D,W);K>-1&&this.setFocus([K],O)}focusPrevious(w=1,D=!1,O,W){if(this.length===0)return;const U=this.focus.get(),K=this.findPreviousIndex(U.length>0?U[0]-w:0,D,W);K>-1&&this.setFocus([K],O)}async focusNextPage(w,D){let O=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);O=O===0?0:O-1;const W=this.getFocus()[0];if(W!==O&&(W===void 0||O>W)){const U=this.findPreviousIndex(O,!1,D);U>-1&&W!==U?this.setFocus([U],w):this.setFocus([O],w)}else{const U=this.view.getScrollTop();let K=U+this.view.renderHeight;O>W&&(K-=this.view.elementHeight(O)),this.view.setScrollTop(K),this.view.getScrollTop()!==U&&(this.setFocus([]),await timeout(0),await this.focusNextPage(w,D))}}async focusPreviousPage(w,D,O=()=>0){let W;const U=O(),K=this.view.getScrollTop()+U;K===0?W=this.view.indexAt(K):W=this.view.indexAfter(K-1);const q=this.getFocus()[0];if(q!==W&&(q===void 0||q>=W)){const G=this.findNextIndex(W,!1,D);G>-1&&q!==G?this.setFocus([G],w):this.setFocus([W],w)}else{const G=K;this.view.setScrollTop(K-this.view.renderHeight-U),this.view.getScrollTop()+O()!==G&&(this.setFocus([]),await timeout(0),await this.focusPreviousPage(w,D,O))}}focusLast(w,D){if(this.length===0)return;const O=this.findPreviousIndex(this.length-1,!1,D);O>-1&&this.setFocus([O],w)}focusFirst(w,D){this.focusNth(0,w,D)}focusNth(w,D,O){if(this.length===0)return;const W=this.findNextIndex(w,!1,O);W>-1&&this.setFocus([W],D)}findNextIndex(w,D=!1,O){for(let W=0;W<this.length;W++){if(w>=this.length&&!D)return-1;if(w=w%this.length,!O||O(this.element(w)))return w;w++}return-1}findPreviousIndex(w,D=!1,O){for(let W=0;W<this.length;W++){if(w<0&&!D)return-1;if(w=(this.length+w%this.length)%this.length,!O||O(this.element(w)))return w;w--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(w=>this.view.element(w))}reveal(w,D,O=0){if(w<0||w>=this.length)throw new ListError(this.user,`Invalid index ${w}`);const W=this.view.getScrollTop(),U=this.view.elementTop(w),K=this.view.elementHeight(w);if(isNumber$1(D)){const q=K-this.view.renderHeight+O;this.view.setScrollTop(q*clamp(D,0,1)+U-O)}else{const q=U+K,G=W+this.view.renderHeight;U<W+O&&q>=G||(U<W+O||q>=G&&K>=this.view.renderHeight?this.view.setScrollTop(U-O):q>=G&&this.view.setScrollTop(q-this.view.renderHeight))}}getRelativeTop(w,D=0){if(w<0||w>=this.length)throw new ListError(this.user,`Invalid index ${w}`);const O=this.view.getScrollTop(),W=this.view.elementTop(w),U=this.view.elementHeight(w);if(W<O+D||W+U>O+this.view.renderHeight)return null;const K=U-this.view.renderHeight+D;return Math.abs((O+D-W)/K)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(w){return this.view.getElementDomId(w)}getElementTop(w){return this.view.elementTop(w)}style(w){this.styleController.style(w)}toListEvent({indexes:w,browserEvent:D}){return{indexes:w,elements:w.map(O=>this.view.element(O)),browserEvent:D}}_onFocusChange(){const w=this.focus.get();this.view.domNode.classList.toggle("element-focused",w.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){const w=this.focus.get();if(w.length>0){let D;this.accessibilityProvider?.getActiveDescendantId&&(D=this.accessibilityProvider.getActiveDescendantId(this.view.element(w[0]))),this.view.domNode.setAttribute("aria-activedescendant",D||this.view.getElementDomId(w[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const w=this.selection.get();this.view.domNode.classList.toggle("selection-none",w.length===0),this.view.domNode.classList.toggle("selection-single",w.length===1),this.view.domNode.classList.toggle("selection-multiple",w.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}__decorate$18([memoize],List.prototype,"onDidChangeFocus",null);__decorate$18([memoize],List.prototype,"onDidChangeSelection",null);__decorate$18([memoize],List.prototype,"onContextMenu",null);__decorate$18([memoize],List.prototype,"onKeyDown",null);__decorate$18([memoize],List.prototype,"onDidFocus",null);__decorate$18([memoize],List.prototype,"onDidBlur",null);const $$7=$$8,SELECT_OPTION_ENTRY_TEMPLATE_ID="selectOption.entry.template";class SelectListRenderer{get templateId(){return SELECT_OPTION_ENTRY_TEMPLATE_ID}renderTemplate(w){const D=Object.create(null);return D.root=w,D.text=append$1(w,$$7(".option-text")),D.detail=append$1(w,$$7(".option-detail")),D.decoratorRight=append$1(w,$$7(".option-decorator-right")),D}renderElement(w,D,O){const W=O,U=w.text,K=w.detail,q=w.decoratorRight,G=w.isDisabled;W.text.textContent=U,W.detail.textContent=K||"",W.decoratorRight.innerText=q||"",G?W.root.classList.add("option-disabled"):W.root.classList.remove("option-disabled")}disposeTemplate(w){}}class SelectBoxList extends Disposable{static{this.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32}static{this.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2}static{this.DEFAULT_MINIMUM_VISIBLE_OPTIONS=3}constructor(w,D,O,W,U){super(),this.options=[],this._currentSelection=0,this._hasDetails=!1,this._skipLayout=!1,this._sticky=!1,this._isVisible=!1,this.styles=W,this.selectBoxOptions=U||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=SelectBoxList.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new Emitter$1,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(O),this.selected=D||0,w&&this.setOptions(w,D),this.initStyleSheet()}setTitle(w){!this._hover&&w?this._hover=this._register(getBaseLayerHoverDelegate().setupManagedHover(getDefaultHoverDelegate("mouse"),this.selectElement,w)):this._hover&&this._hover.update(w)}getHeight(){return 22}getTemplateId(){return SELECT_OPTION_ENTRY_TEMPLATE_ID}constructSelectDropDown(w){this.contextViewProvider=w,this.selectDropDownContainer=$$8(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=append$1(this.selectDropDownContainer,$$7(".select-box-details-pane"));const D=append$1(this.selectDropDownContainer,$$7(".select-box-dropdown-container-width-control")),O=append$1(D,$$7(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",append$1(O,this.widthControlElement),this._dropDownPosition=0,this.styleElement=createStyleSheet(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(addDisposableListener(this.selectDropDownContainer,EventType$1.DRAG_START,W=>{EventHelper.stop(W,!0)}))}registerListeners(){this._register(addStandardDisposableListener(this.selectElement,"change",D=>{this.selected=D.target.selectedIndex,this._onDidSelect.fire({index:D.target.selectedIndex,selected:D.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(addDisposableListener(this.selectElement,EventType$1.CLICK,D=>{EventHelper.stop(D),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(addDisposableListener(this.selectElement,EventType$1.MOUSE_DOWN,D=>{EventHelper.stop(D)}));let w;this._register(addDisposableListener(this.selectElement,"touchstart",D=>{w=this._isVisible})),this._register(addDisposableListener(this.selectElement,"touchend",D=>{EventHelper.stop(D),w?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(addDisposableListener(this.selectElement,EventType$1.KEY_DOWN,D=>{const O=new StandardKeyboardEvent(D);let W=!1;isMacintosh?(O.keyCode===18||O.keyCode===16||O.keyCode===10||O.keyCode===3)&&(W=!0):(O.keyCode===18&&O.altKey||O.keyCode===16&&O.altKey||O.keyCode===10||O.keyCode===3)&&(W=!0),W&&(this.showSelectDropDown(),EventHelper.stop(D,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(w,D){equals$1(this.options,w)||(this.options=w,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((O,W)=>{this.selectElement.add(this.createOption(O.text,W,O.isDisabled)),typeof O.description=="string"&&(this._hasDetails=!0)})),D!==void 0&&(this.select(D),this._currentSelection=this.selected)}setOptionsList(){this.selectList?.splice(0,this.selectList.length,this.options)}select(w){w>=0&&w<this.options.length?this.selected=w:w>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(w){this.selectElement.tabIndex=w?0:-1}render(w){this.container=w,w.classList.add("select-container"),w.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){const w=[];this.styles.listFocusBackground&&w.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&w.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&w.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(w.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),w.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),w.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(w.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),w.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&w.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&w.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&w.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&w.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),w.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),w.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=w.join(`
`)}styleSelectElement(){const w=this.styles.selectBackground??"",D=this.styles.selectForeground??"",O=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=w,this.selectElement.style.color=D,this.selectElement.style.borderColor=O}styleList(){const w=this.styles.selectBackground??"",D=asCssValueWithDefault(this.styles.selectListBackground,w);this.selectDropDownListContainer.style.backgroundColor=D,this.selectionDetailsPane.style.backgroundColor=D;const O=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=O,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(w,D,O){const W=document.createElement("option");return W.value=w,W.text=w,W.disabled=!!O,W}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:w=>this.renderSelectDropDown(w,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:w=>this.renderSelectDropDown(w),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(w){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),w&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(w,D){return w.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(D),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let w=0;return this.options.forEach((D,O)=>{this.updateDetail(O),this.selectionDetailsPane.offsetHeight>w&&(w=this.selectionDetailsPane.offsetHeight)}),w}layoutSelectDropDown(w){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");const D=getWindow(this.selectElement),O=getDomNodePagePosition(this.selectElement),W=getWindow(this.selectElement).getComputedStyle(this.selectElement),U=parseFloat(W.getPropertyValue("--dropdown-padding-top"))+parseFloat(W.getPropertyValue("--dropdown-padding-bottom")),K=D.innerHeight-O.top-O.height-(this.selectBoxOptions.minBottomMargin||0),q=O.top-SelectBoxList.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,G=this.selectElement.offsetWidth,Q=this.setWidthControlElement(this.widthControlElement),Y=Math.max(Q,Math.round(G)).toString()+"px";this.selectDropDownContainer.style.width=Y,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let X=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());const J=this._hasDetails?this._cachedMaxDetailsHeight:0,te=X+U+J,ie=Math.floor((K-U-J)/this.getHeight()),se=Math.floor((q-U-J)/this.getHeight());if(w)return O.top+O.height>D.innerHeight-22||O.top<SelectBoxList.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||ie<1&&se<1?!1:(ie<SelectBoxList.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&se>ie&&this.options.length>ie?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(O.top+O.height>D.innerHeight-22||O.top<SelectBoxList.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&ie<1||this._dropDownPosition===1&&se<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&ie+se<1)return this.hideSelectDropDown(!0),!1;te>K&&(X=ie*this.getHeight())}else te>q&&(X=se*this.getHeight());return this.selectList.layout(X),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=X+U+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=X+U+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=Y,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(w){let D=0;if(w){let O=0,W=0;this.options.forEach((U,K)=>{const q=U.detail?U.detail.length:0,G=U.decoratorRight?U.decoratorRight.length:0,Q=U.text.length+q+G;Q>W&&(O=K,W=Q)}),w.textContent=this.options[O].text+(this.options[O].decoratorRight?this.options[O].decoratorRight+" ":""),D=getTotalWidth(w)}return D}createSelectList(w){if(this.selectList)return;this.selectDropDownListContainer=append$1(w,$$7(".select-box-dropdown-list-container")),this.listRenderer=new SelectListRenderer,this.selectList=this._register(new List("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:W=>{let U=W.text;return W.detail&&(U+=`. ${W.detail}`),W.decoratorRight&&(U+=`. ${W.decoratorRight}`),W.description&&(U+=`. ${W.description}`),U},getWidgetAriaLabel:()=>localize({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>isMacintosh?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);const D=this._register(new DomEmitter(this.selectDropDownListContainer,"keydown")),O=Event$1.chain(D.event,W=>W.filter(()=>this.selectList.length>0).map(U=>new StandardKeyboardEvent(U)));this._register(Event$1.chain(O,W=>W.filter(U=>U.keyCode===3))(this.onEnter,this)),this._register(Event$1.chain(O,W=>W.filter(U=>U.keyCode===2))(this.onEnter,this)),this._register(Event$1.chain(O,W=>W.filter(U=>U.keyCode===9))(this.onEscape,this)),this._register(Event$1.chain(O,W=>W.filter(U=>U.keyCode===16))(this.onUpArrow,this)),this._register(Event$1.chain(O,W=>W.filter(U=>U.keyCode===18))(this.onDownArrow,this)),this._register(Event$1.chain(O,W=>W.filter(U=>U.keyCode===12))(this.onPageDown,this)),this._register(Event$1.chain(O,W=>W.filter(U=>U.keyCode===11))(this.onPageUp,this)),this._register(Event$1.chain(O,W=>W.filter(U=>U.keyCode===14))(this.onHome,this)),this._register(Event$1.chain(O,W=>W.filter(U=>U.keyCode===13))(this.onEnd,this)),this._register(Event$1.chain(O,W=>W.filter(U=>U.keyCode>=21&&U.keyCode<=56||U.keyCode>=85&&U.keyCode<=113))(this.onCharacter,this)),this._register(addDisposableListener(this.selectList.getHTMLElement(),EventType$1.POINTER_UP,W=>this.onPointerUp(W))),this._register(this.selectList.onMouseOver(W=>typeof W.index<"u"&&this.selectList.setFocus([W.index]))),this._register(this.selectList.onDidChangeFocus(W=>this.onListFocus(W))),this._register(addDisposableListener(this.selectDropDownContainer,EventType$1.FOCUS_OUT,W=>{!this._isVisible||isAncestor$1(W.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(w){if(!this.selectList.length)return;EventHelper.stop(w);const D=w.target;if(!D||D.classList.contains("slider"))return;const O=D.closest(".monaco-list-row");if(!O)return;const W=Number(O.getAttribute("data-index")),U=O.classList.contains("option-disabled");W>=0&&W<this.options.length&&!U&&(this.selected=W,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(w,D){const O=U=>{for(let K=0;K<U.childNodes.length;K++){const q=U.childNodes.item(K);(q.tagName&&q.tagName.toLowerCase())==="img"?q.remove():O(q)}},W=renderMarkdown({value:w,supportThemeIcons:!0},{actionHandler:D});return W.element.classList.add("select-box-description-markdown"),O(W.element),W.element}onListFocus(w){!this._isVisible||!this._hasDetails||this.updateDetail(w.indexes[0])}updateDetail(w){this.selectionDetailsPane.innerText="";const D=this.options[w],O=D?.description??"",W=D?.descriptionIsMarkdown??!1;if(O){if(W){const U=D.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(O,U))}else this.selectionDetailsPane.innerText=O;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(w){EventHelper.stop(w),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(w){EventHelper.stop(w),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(w){if(this.selected<this.options.length-1){EventHelper.stop(w,!0);const D=this.options[this.selected+1].isDisabled;if(D&&this.options.length>this.selected+2)this.selected+=2;else{if(D)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(w){this.selected>0&&(EventHelper.stop(w,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(w){EventHelper.stop(w),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(w){EventHelper.stop(w),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(w){EventHelper.stop(w),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(w){EventHelper.stop(w),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(w){const D=KeyCodeUtils.toString(w.keyCode);let O=-1;for(let W=0;W<this.options.length-1;W++)if(O=(W+this.selected+1)%this.options.length,this.options[O].text.charAt(0).toUpperCase()===D&&!this.options[O].isDisabled){this.select(O),this.selectList.setFocus([O]),this.selectList.reveal(this.selectList.getFocus()[0]),EventHelper.stop(w);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}}class SelectBoxNative extends Disposable{constructor(w,D,O,W){super(),this.selected=0,this.selectBoxOptions=W||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new Emitter$1),this.styles=O,this.registerListeners(),this.setOptions(w,D)}registerListeners(){this._register(Gesture.addTarget(this.selectElement)),[EventType.Tap].forEach(w=>{this._register(addDisposableListener(this.selectElement,w,D=>{this.selectElement.focus()}))}),this._register(addStandardDisposableListener(this.selectElement,"click",w=>{EventHelper.stop(w,!0)})),this._register(addStandardDisposableListener(this.selectElement,"change",w=>{this.selectElement.title=w.target.value,this._onDidSelect.fire({index:w.target.selectedIndex,selected:w.target.value})})),this._register(addStandardDisposableListener(this.selectElement,"keydown",w=>{let D=!1;isMacintosh?(w.keyCode===18||w.keyCode===16||w.keyCode===10)&&(D=!0):(w.keyCode===18&&w.altKey||w.keyCode===10||w.keyCode===3)&&(D=!0),D&&w.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(w,D){(!this.options||!equals$1(this.options,w))&&(this.options=w,this.selectElement.options.length=0,this.options.forEach((O,W)=>{this.selectElement.add(this.createOption(O.text,W,O.isDisabled))})),D!==void 0&&this.select(D)}select(w){this.options.length===0?this.selected=0:w>=0&&w<this.options.length?this.selected=w:w>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(w){this.selectElement.tabIndex=w?0:-1}render(w){w.classList.add("select-container"),w.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(w,D,O){const W=document.createElement("option");return W.value=w,W.text=w,W.disabled=!!O,W}}class SelectBox extends Widget$1{constructor(w,D,O,W,U){super(),isMacintosh&&!U?.useCustomDrawn?this.selectBoxDelegate=new SelectBoxNative(w,D,W,U):this.selectBoxDelegate=new SelectBoxList(w,D,O,W,U),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(w,D){this.selectBoxDelegate.setOptions(w,D)}select(w){this.selectBoxDelegate.select(w)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(w){this.selectBoxDelegate.setFocusable(w)}render(w){this.selectBoxDelegate.render(w)}}class BaseActionViewItem extends Disposable{get action(){return this._action}constructor(w,D,O={}){super(),this.options=O,this._context=w||this,this._action=D,D instanceof Action&&this._register(D.onDidChange(W=>{this.element&&this.handleActionChangeEvent(W)}))}handleActionChangeEvent(w){w.enabled!==void 0&&this.updateEnabled(),w.checked!==void 0&&this.updateChecked(),w.class!==void 0&&this.updateClass(),w.label!==void 0&&(this.updateLabel(),this.updateTooltip()),w.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new ActionRunner)),this._actionRunner}set actionRunner(w){this._actionRunner=w}isEnabled(){return this._action.enabled}setActionContext(w){this._context=w}render(w){const D=this.element=w;this._register(Gesture.addTarget(w));const O=this.options&&this.options.draggable;O&&(w.draggable=!0,isFirefox$1&&this._register(addDisposableListener(w,EventType$1.DRAG_START,W=>W.dataTransfer?.setData(DataTransfers.TEXT,this._action.label)))),this._register(addDisposableListener(D,EventType.Tap,W=>this.onClick(W,!0))),this._register(addDisposableListener(D,EventType$1.MOUSE_DOWN,W=>{O||EventHelper.stop(W,!0),this._action.enabled&&W.button===0&&D.classList.add("active")})),isMacintosh&&this._register(addDisposableListener(D,EventType$1.CONTEXT_MENU,W=>{W.button===0&&W.ctrlKey===!0&&this.onClick(W)})),this._register(addDisposableListener(D,EventType$1.CLICK,W=>{EventHelper.stop(W,!0),this.options&&this.options.isMenu||this.onClick(W)})),this._register(addDisposableListener(D,EventType$1.DBLCLICK,W=>{EventHelper.stop(W,!0)})),[EventType$1.MOUSE_UP,EventType$1.MOUSE_OUT].forEach(W=>{this._register(addDisposableListener(D,W,U=>{EventHelper.stop(U),D.classList.remove("active")}))})}onClick(w,D=!1){EventHelper.stop(w,!0);const O=isUndefinedOrNull(this._context)?this.options?.useEventAsContext?w:{preserveFocus:D}:this._context;this.actionRunner.run(this._action,O)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(w){this.element&&(this.element.tabIndex=w?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){if(!this.element)return;const w=this.getTooltip()??"";if(this.updateAriaLabel(),this.options.hoverDelegate?.showNativeHover)this.element.title=w;else if(!this.customHover&&w!==""){const D=this.options.hoverDelegate??getDefaultHoverDelegate("element");this.customHover=this._store.add(getBaseLayerHoverDelegate().setupManagedHover(D,this.element,w))}else this.customHover&&this.customHover.update(w)}updateAriaLabel(){if(this.element){const w=this.getTooltip()??"";this.element.setAttribute("aria-label",w)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}}class ActionViewItem extends BaseActionViewItem{constructor(w,D,O){super(w,D,O),this.options=O,this.options.icon=O.icon!==void 0?O.icon:!1,this.options.label=O.label!==void 0?O.label:!0,this.cssClass=""}render(w){super.render(w),assertType(this.element);const D=document.createElement("a");if(D.classList.add("action-label"),D.setAttribute("role",this.getDefaultAriaRole()),this.label=D,this.element.appendChild(D),this.options.label&&this.options.keybinding){const O=document.createElement("span");O.classList.add("keybinding"),O.textContent=this.options.keybinding,this.element.appendChild(O)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===Separator.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(w){this.label&&(this.label.tabIndex=w?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let w=null;return this.action.tooltip?w=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(w=this.action.label,this.options.keybinding&&(w=localize({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",w,this.options.keybinding))),w??void 0}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label?.classList.remove("codicon")}updateEnabled(){this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element?.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element?.classList.add("disabled"))}updateAriaLabel(){if(this.label){const w=this.getTooltip()??"";this.label.setAttribute("aria-label",w)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}}class SelectActionViewItem extends BaseActionViewItem{constructor(w,D,O,W,U,K,q){super(w,D),this.selectBox=new SelectBox(O,W,U,K,q),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}select(w){this.selectBox.select(w)}registerListeners(){this._register(this.selectBox.onDidSelect(w=>this.runAction(w.selected,w.index)))}runAction(w,D){this.actionRunner.run(this._action,this.getActionContext(w,D))}getActionContext(w,D){return w}setFocusable(w){this.selectBox.setFocusable(w)}focus(){this.selectBox?.focus()}blur(){this.selectBox?.blur()}render(w){this.selectBox.render(w)}}class ActionBar extends Disposable{constructor(w,D={}){super(),this._actionRunnerDisposables=this._register(new DisposableStore),this.viewItemDisposables=this._register(new DisposableMap),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new Emitter$1),this.onDidBlur=this._onDidBlur.event,this._onDidCancel=this._register(new Emitter$1({onWillAddFirstListener:()=>this.cancelHasListener=!0})),this.onDidCancel=this._onDidCancel.event,this.cancelHasListener=!1,this._onDidRun=this._register(new Emitter$1),this.onDidRun=this._onDidRun.event,this._onWillRun=this._register(new Emitter$1),this.onWillRun=this._onWillRun.event,this.options=D,this._context=D.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:this.options.triggerKeys?.keyDown??!1,keys:this.options.triggerKeys?.keys??[3,10]},this._hoverDelegate=D.hoverDelegate??this._register(createInstantHoverDelegate()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new ActionRunner,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(U=>this._onDidRun.fire(U))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(U=>this._onWillRun.fire(U))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let O,W;switch(this._orientation){case 0:O=[15],W=[17];break;case 1:O=[16],W=[18],this.domNode.className+=" vertical";break}this._register(addDisposableListener(this.domNode,EventType$1.KEY_DOWN,U=>{const K=new StandardKeyboardEvent(U);let q=!0;const G=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;O&&(K.equals(O[0])||K.equals(O[1]))?q=this.focusPrevious():W&&(K.equals(W[0])||K.equals(W[1]))?q=this.focusNext():K.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():K.equals(14)?q=this.focusFirst():K.equals(13)?q=this.focusLast():K.equals(2)&&G instanceof BaseActionViewItem&&G.trapsArrowNavigation?q=this.focusNext(void 0,!0):this.isTriggerKeyEvent(K)?this._triggerKeys.keyDown?this.doTrigger(K):this.triggerKeyDown=!0:q=!1,q&&(K.preventDefault(),K.stopPropagation())})),this._register(addDisposableListener(this.domNode,EventType$1.KEY_UP,U=>{const K=new StandardKeyboardEvent(U);this.isTriggerKeyEvent(K)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(K)),K.preventDefault(),K.stopPropagation()):(K.equals(2)||K.equals(1026)||K.equals(16)||K.equals(18)||K.equals(15)||K.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(trackFocus(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(getActiveElement()===this.domNode||!isAncestor$1(getActiveElement(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),w.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(w){if(this.focusable=w,this.focusable){const D=this.viewItems.find(O=>O instanceof BaseActionViewItem&&O.isEnabled());D instanceof BaseActionViewItem&&D.setFocusable(!0)}else this.viewItems.forEach(D=>{D instanceof BaseActionViewItem&&D.setFocusable(!1)})}isTriggerKeyEvent(w){let D=!1;return this._triggerKeys.keys.forEach(O=>{D=D||w.equals(O)}),D}updateFocusedItem(){for(let w=0;w<this.actionsList.children.length;w++){const D=this.actionsList.children[w];if(isAncestor$1(getActiveElement(),D)){this.focusedItem=w,this.viewItems[this.focusedItem]?.showHover?.();break}}}get context(){return this._context}set context(w){this._context=w,this.viewItems.forEach(D=>D.setActionContext(w))}get actionRunner(){return this._actionRunner}set actionRunner(w){this._actionRunner=w,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(D=>this._onDidRun.fire(D))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(D=>this._onWillRun.fire(D))),this.viewItems.forEach(D=>D.actionRunner=w)}getContainer(){return this.domNode}getAction(w){if(typeof w=="number")return this.viewItems[w]?.action;if(isHTMLElement(w)){for(;w.parentElement!==this.actionsList;){if(!w.parentElement)return;w=w.parentElement}for(let D=0;D<this.actionsList.childNodes.length;D++)if(this.actionsList.childNodes[D]===w)return this.viewItems[D].action}}push(w,D={}){const O=Array.isArray(w)?w:[w];let W=isNumber$1(D.index)?D.index:null;O.forEach(U=>{const K=document.createElement("li");K.className="action-item",K.setAttribute("role","presentation");let q;const G={hoverDelegate:this._hoverDelegate,...D,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(q=this.options.actionViewItemProvider(U,G)),q||(q=new ActionViewItem(this.context,U,G)),this.options.allowContextMenu||this.viewItemDisposables.set(q,addDisposableListener(K,EventType$1.CONTEXT_MENU,Q=>{EventHelper.stop(Q,!0)})),q.actionRunner=this._actionRunner,q.setActionContext(this.context),q.render(K),this.focusable&&q instanceof BaseActionViewItem&&this.viewItems.length===0&&q.setFocusable(!0),W===null||W<0||W>=this.actionsList.children.length?(this.actionsList.appendChild(K),this.viewItems.push(q)):(this.actionsList.insertBefore(K,this.actionsList.children[W]),this.viewItems.splice(W,0,q),W++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}clear(){this.isEmpty()||(this.viewItems=dispose(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),clearNode(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(w){let D=!1,O;if(w===void 0?D=!0:typeof w=="number"?O=w:typeof w=="boolean"&&(D=w),D&&typeof this.focusedItem>"u"){const W=this.viewItems.findIndex(U=>U.isEnabled());this.focusedItem=W===-1?void 0:W,this.updateFocus(void 0,void 0,!0)}else O!==void 0&&(this.focusedItem=O),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(w,D){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const O=this.focusedItem;let W;do{if(!w&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=O,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,W=this.viewItems[this.focusedItem]}while(this.focusedItem!==O&&(this.options.focusOnlyEnabledItems&&!W.isEnabled()||W.action.id===Separator.ID));return this.updateFocus(void 0,void 0,D),!0}focusPrevious(w){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const D=this.focusedItem;let O;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!w&&this.options.preventLoopNavigation)return this.focusedItem=D,!1;this.focusedItem=this.viewItems.length-1}O=this.viewItems[this.focusedItem]}while(this.focusedItem!==D&&(this.options.focusOnlyEnabledItems&&!O.isEnabled()||O.action.id===Separator.ID));return this.updateFocus(!0),!0}updateFocus(w,D,O=!1){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:D}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&this.viewItems[this.previouslyFocusedItem]?.blur();const W=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(W){let U=!0;isFunction(W.focus)||(U=!1),this.options.focusOnlyEnabledItems&&isFunction(W.isEnabled)&&!W.isEnabled()&&(U=!1),W.action.id===Separator.ID&&(U=!1),U?(O||this.previouslyFocusedItem!==this.focusedItem)&&(W.focus(w),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:D}),this.previouslyFocusedItem=void 0),U&&W.showHover?.()}}doTrigger(w){if(typeof this.focusedItem>"u")return;const D=this.viewItems[this.focusedItem];if(D instanceof BaseActionViewItem){const O=D._context===null||D._context===void 0?w:D._context;this.run(D._action,O)}}async run(w,D){await this._actionRunner.run(w,D)}dispose(){this._context=void 0,this.viewItems=dispose(this.viewItems),this.getContainer().remove(),super.dispose()}}class ArrayNavigator{constructor(w,D=0,O=w.length,W=D-1){this.items=w,this.start=D,this.end=O,this.index=W}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class HistoryNavigator{constructor(w=[],D=10){this._initialize(w),this._limit=D,this._onChange()}getHistory(){return this._elements}add(w){this._history.delete(w),this._history.add(w),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(w){return this._history.has(w)}_onChange(){this._reduceToLimit();const w=this._elements;this._navigator=new ArrayNavigator(w,0,w.length,w.length)}_reduceToLimit(){const w=this._elements;w.length>this._limit&&this._initialize(w.slice(w.length-this._limit))}_currentPosition(){const w=this._navigator.current();return w?this._elements.indexOf(w):-1}_initialize(w){this._history=new Set;for(const D of w)this._history.add(D)}get _elements(){const w=[];return this._history.forEach(D=>w.push(D)),w}}const $$6=$$8;let InputBox$1=class extends Widget$1{constructor(w,D,O){super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new Emitter$1),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=D,this.options=O,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=append$1(w,$$6(".monaco-inputbox.idle"));const W=this.options.flexibleHeight?"textarea":"input",U=append$1(this.element,$$6(".ibwrapper"));if(this.input=append$1(U,$$6(W+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=append$1(U,$$6("div.mirror")),this.mirror.innerText=" ",this.scrollableElement=new ScrollableElement(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),append$1(w,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(G=>this.input.scrollTop=G.scrollTop));const K=this._register(new DomEmitter(w.ownerDocument,"selectionchange")),q=Event$1.filter(K.event,()=>w.ownerDocument.getSelection()?.anchorNode===U);this._register(q(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new ActionBar(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(w){this.placeholder=w,this.input.setAttribute("placeholder",w)}setTooltip(w){this.tooltip=w,this.hover?this.hover.update(w):this.hover=this._register(getBaseLayerHoverDelegate().setupManagedHover(getDefaultHoverDelegate("mouse"),this.input,w))}get inputElement(){return this.input}get value(){return this.input.value}set value(w){this.input.value!==w&&(this.input.value=w,this.onValueChange())}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:getTotalHeight(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return isActiveElement(this.input)}select(w=null){this.input.select(),w&&(this.input.setSelectionRange(w.start,w.end),w.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){const w=this.input.selectionStart;if(w===null)return null;const D=this.input.selectionEnd??w;return{start:w,end:D}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}set paddingRight(w){this.input.style.width=`calc(100% - ${w}px)`,this.mirror&&(this.mirror.style.paddingRight=w+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;const w=this.cachedContentHeight,D=this.cachedHeight,O=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:w,height:D}),this.scrollableElement.setScrollPosition({scrollTop:O})}showMessage(w,D){if(this.state==="open"&&equals(this.message,w))return;this.message=w,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(w.type));const O=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${asCssValueWithDefault(O.border,"transparent")}`,this.message.content&&(this.hasFocus()||D)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let w=null;return this.validation&&(w=this.validation(this.value),w?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(w)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),w?.type}stylesForType(w){const D=this.options.inputBoxStyles;switch(w){case 1:return{border:D.inputValidationInfoBorder,background:D.inputValidationInfoBackground,foreground:D.inputValidationInfoForeground};case 2:return{border:D.inputValidationWarningBorder,background:D.inputValidationWarningBackground,foreground:D.inputValidationWarningForeground};default:return{border:D.inputValidationErrorBorder,background:D.inputValidationErrorBackground,foreground:D.inputValidationErrorForeground}}}classForType(w){switch(w){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let w;const D=()=>w.style.width=getTotalWidth(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:W=>{if(!this.message)return null;w=append$1(W,$$6(".monaco-inputbox-container")),D();const U={inline:!0,className:"monaco-inputbox-message"},K=this.message.formatContent?renderFormattedText(this.message.content,U):renderText(this.message.content,U);K.classList.add(this.classForType(this.message.type));const q=this.stylesForType(this.message.type);return K.style.backgroundColor=q.background??"",K.style.color=q.foreground??"",K.style.border=q.border?`1px solid ${q.border}`:"",append$1(w,K),null},onHide:()=>{this.state="closed"},layout:D});let O;this.message.type===3?O=localize("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?O=localize("alertWarningMessage","Warning: {0}",this.message.content):O=localize("alertInfoMessage","Info: {0}",this.message.content),alert(O),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const w=this.value,O=w.charCodeAt(w.length-1)===10?" ":"";(w+O).replace(/\u000c/g,"")?this.mirror.textContent=w+O:this.mirror.innerText=" ",this.layout()}applyStyles(){const w=this.options.inputBoxStyles,D=w.inputBackground??"",O=w.inputForeground??"",W=w.inputBorder??"";this.element.style.backgroundColor=D,this.element.style.color=O,this.input.style.backgroundColor="inherit",this.input.style.color=O,this.element.style.border=`1px solid ${asCssValueWithDefault(W,"transparent")}`}layout(){if(!this.mirror)return;const w=this.cachedContentHeight;this.cachedContentHeight=getTotalHeight(this.mirror),w!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(w){const D=this.inputElement,O=D.selectionStart,W=D.selectionEnd,U=D.value;O!==null&&W!==null&&(this.value=U.substr(0,O)+w+U.substr(W),D.setSelectionRange(O+1,O+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar?.dispose(),super.dispose()}};class HistoryInputBox extends InputBox$1{constructor(w,D,O){const W=localize({key:"history.inputbox.hint.suffix.noparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field ends in a closing parenthesis ")", for example "Filter (e.g. text, !exclude)". The character inserted into the final string is ⇅ to represent the up and down arrow keys.']}," or {0} for history","⇅"),U=localize({key:"history.inputbox.hint.suffix.inparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field does NOT end in a closing parenthesis (eg. "Find"). The character inserted into the final string is ⇅ to represent the up and down arrow keys.']}," ({0} for history)","⇅");super(w,D,O),this._onDidFocus=this._register(new Emitter$1),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new Emitter$1),this.onDidBlur=this._onDidBlur.event,this.history=new HistoryNavigator(O.history,100);const K=()=>{if(O.showHistoryHint&&O.showHistoryHint()&&!this.placeholder.endsWith(W)&&!this.placeholder.endsWith(U)&&this.history.getHistory().length){const q=this.placeholder.endsWith(")")?W:U,G=this.placeholder+q;O.showPlaceholderOnFocus&&!isActiveElement(this.input)?this.placeholder=G:this.setPlaceHolder(G)}};this.observer=new MutationObserver((q,G)=>{q.forEach(Q=>{Q.target.textContent||K()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>K()),this.onblur(this.input,()=>{const q=G=>{if(this.placeholder.endsWith(G)){const Q=this.placeholder.slice(0,this.placeholder.length-G.length);return O.showPlaceholderOnFocus?this.placeholder=Q:this.setPlaceHolder(Q),!0}else return!1};q(U)||q(W)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(w){this.value&&(w||this.value!==this.getCurrentValue())&&this.history.add(this.value)}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let w=this.getNextValue();w&&(w=w===this.value?this.getNextValue():w),this.value=w??"",status(this.value?this.value:localize("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let w=this.getPreviousValue();w&&(w=w===this.value?this.getPreviousValue():w),w&&(this.value=w,status(this.value))}setPlaceHolder(w){super.setPlaceHolder(w),this.setTooltip(w)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let w=this.history.current();return w||(w=this.history.last(),this.history.next()),w}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}}const NLS_DEFAULT_LABEL$1=localize("defaultLabel","input");class FindInput extends Widget$1{constructor(w,D,O){super(),this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this.additionalTogglesDisposables=this._register(new MutableDisposable),this.additionalToggles=[],this._onDidOptionChange=this._register(new Emitter$1),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new Emitter$1),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new Emitter$1),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new Emitter$1),this._onKeyUp=this._register(new Emitter$1),this._onCaseSensitiveKeyDown=this._register(new Emitter$1),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new Emitter$1),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.placeholder=O.placeholder||"",this.validation=O.validation,this.label=O.label||NLS_DEFAULT_LABEL$1,this.showCommonFindToggles=!!O.showCommonFindToggles;const W=O.appendCaseSensitiveLabel||"",U=O.appendWholeWordsLabel||"",K=O.appendRegexLabel||"",q=O.history||[],G=!!O.flexibleHeight,Q=!!O.flexibleWidth,Y=O.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new HistoryInputBox(this.domNode,D,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:q,showHistoryHint:O.showHistoryHint,flexibleHeight:G,flexibleWidth:Q,flexibleMaxHeight:Y,inputBoxStyles:O.inputBoxStyles}));const X=this._register(createInstantHoverDelegate());if(this.showCommonFindToggles){this.regex=this._register(new RegexToggle({appendTitle:K,isChecked:!1,hoverDelegate:X,...O.toggleStyles})),this._register(this.regex.onChange(te=>{this._onDidOptionChange.fire(te),!te&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(te=>{this._onRegexKeyDown.fire(te)})),this.wholeWords=this._register(new WholeWordsToggle({appendTitle:U,isChecked:!1,hoverDelegate:X,...O.toggleStyles})),this._register(this.wholeWords.onChange(te=>{this._onDidOptionChange.fire(te),!te&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new CaseSensitiveToggle({appendTitle:W,isChecked:!1,hoverDelegate:X,...O.toggleStyles})),this._register(this.caseSensitive.onChange(te=>{this._onDidOptionChange.fire(te),!te&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(te=>{this._onCaseSensitiveKeyDown.fire(te)}));const J=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,te=>{if(te.equals(15)||te.equals(17)||te.equals(9)){const ie=J.indexOf(this.domNode.ownerDocument.activeElement);if(ie>=0){let se=-1;te.equals(17)?se=(ie+1)%J.length:te.equals(15)&&(ie===0?se=J.length-1:se=ie-1),te.equals(9)?(J[ie].blur(),this.inputBox.focus()):se>=0&&J[se].focus(),EventHelper.stop(te,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(O?.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),w?.appendChild(this.domNode),this._register(addDisposableListener(this.inputBox.inputElement,"compositionstart",J=>{this.imeSessionInProgress=!0})),this._register(addDisposableListener(this.inputBox.inputElement,"compositionend",J=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,J=>this._onKeyDown.fire(J)),this.onkeyup(this.inputBox.inputElement,J=>this._onKeyUp.fire(J)),this.oninput(this.inputBox.inputElement,J=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,J=>this._onMouseDown.fire(J))}get onDidChange(){return this.inputBox.onDidChange}layout(w){this.inputBox.layout(),this.updateInputBoxPadding(w.collapsedFindWidget)}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex?.enable(),this.wholeWords?.enable(),this.caseSensitive?.enable();for(const w of this.additionalToggles)w.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex?.disable(),this.wholeWords?.disable(),this.caseSensitive?.disable();for(const w of this.additionalToggles)w.disable()}setFocusInputOnOptionClick(w){this.fixFocusOnOptionClickEnabled=w}setEnabled(w){w?this.enable():this.disable()}setAdditionalToggles(w){for(const D of this.additionalToggles)D.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new DisposableStore;for(const D of w??[])this.additionalTogglesDisposables.value.add(D),this.controls.appendChild(D.domNode),this.additionalTogglesDisposables.value.add(D.onChange(O=>{this._onDidOptionChange.fire(O),!O&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(D);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(w=!1){w?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this.additionalToggles.reduce((D,O)=>D+O.width(),0)}getValue(){return this.inputBox.value}setValue(w){this.inputBox.value!==w&&(this.inputBox.value=w)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive?.checked??!1}setCaseSensitive(w){this.caseSensitive&&(this.caseSensitive.checked=w)}getWholeWords(){return this.wholeWords?.checked??!1}setWholeWords(w){this.wholeWords&&(this.wholeWords.checked=w)}getRegex(){return this.regex?.checked??!1}setRegex(w){this.regex&&(this.regex.checked=w,this.validate())}focusOnCaseSensitive(){this.caseSensitive?.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(w){this.inputBox.showMessage(w)}clearMessage(){this.inputBox.hideMessage()}}const NLS_DEFAULT_LABEL=localize("defaultLabel","input"),NLS_PRESERVE_CASE_LABEL=localize("label.preserveCaseToggle","Preserve Case");class PreserveCaseToggle extends Toggle{constructor(w){super({icon:Codicon.preserveCase,title:NLS_PRESERVE_CASE_LABEL+w.appendTitle,isChecked:w.isChecked,hoverDelegate:w.hoverDelegate??getDefaultHoverDelegate("element"),inputActiveOptionBorder:w.inputActiveOptionBorder,inputActiveOptionForeground:w.inputActiveOptionForeground,inputActiveOptionBackground:w.inputActiveOptionBackground})}}class ReplaceInput extends Widget$1{constructor(w,D,O,W){super(),this._showOptionButtons=O,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new Emitter$1),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new Emitter$1),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new Emitter$1),this._onInput=this._register(new Emitter$1),this._onKeyUp=this._register(new Emitter$1),this._onPreserveCaseKeyDown=this._register(new Emitter$1),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=D,this.placeholder=W.placeholder||"",this.validation=W.validation,this.label=W.label||NLS_DEFAULT_LABEL;const U=W.appendPreserveCaseLabel||"",K=W.history||[],q=!!W.flexibleHeight,G=!!W.flexibleWidth,Q=W.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new HistoryInputBox(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:K,showHistoryHint:W.showHistoryHint,flexibleHeight:q,flexibleWidth:G,flexibleMaxHeight:Q,inputBoxStyles:W.inputBoxStyles})),this.preserveCase=this._register(new PreserveCaseToggle({appendTitle:U,isChecked:!1,...W.toggleStyles})),this._register(this.preserveCase.onChange(J=>{this._onDidOptionChange.fire(J),!J&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(J=>{this._onPreserveCaseKeyDown.fire(J)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;const Y=[this.preserveCase.domNode];this.onkeydown(this.domNode,J=>{if(J.equals(15)||J.equals(17)||J.equals(9)){const te=Y.indexOf(this.domNode.ownerDocument.activeElement);if(te>=0){let ie=-1;J.equals(17)?ie=(te+1)%Y.length:J.equals(15)&&(te===0?ie=Y.length-1:ie=te-1),J.equals(9)?(Y[te].blur(),this.inputBox.focus()):ie>=0&&Y[ie].focus(),EventHelper.stop(J,!0)}}});const X=document.createElement("div");X.className="controls",X.style.display=this._showOptionButtons?"block":"none",X.appendChild(this.preserveCase.domNode),this.domNode.appendChild(X),w?.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,J=>this._onKeyDown.fire(J)),this.onkeyup(this.inputBox.inputElement,J=>this._onKeyUp.fire(J)),this.oninput(this.inputBox.inputElement,J=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,J=>this._onMouseDown.fire(J))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(w){w?this.enable():this.disable()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(w){this.preserveCase.checked=w}focusOnPreserve(){this.preserveCase.focus()}validate(){this.inputBox?.validate()}set width(w){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=w+"px"}dispose(){super.dispose()}}var __decorate$17=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$14=function(F,w){return function(D,O){w(D,O,F)}};const historyNavigationVisible=new RawContextKey("suggestWidgetVisible",!1,localize("suggestWidgetVisible","Whether suggestion are visible")),HistoryNavigationWidgetFocusContext="historyNavigationWidgetFocus",HistoryNavigationForwardsEnablementContext="historyNavigationForwardsEnabled",HistoryNavigationBackwardsEnablementContext="historyNavigationBackwardsEnabled";let lastFocusedWidget;const widgets=[];function registerAndCreateHistoryNavigationContext(F,w){if(widgets.includes(w))throw new Error("Cannot register the same widget multiple times");widgets.push(w);const D=new DisposableStore,O=new RawContextKey(HistoryNavigationWidgetFocusContext,!1).bindTo(F),W=new RawContextKey(HistoryNavigationForwardsEnablementContext,!0).bindTo(F),U=new RawContextKey(HistoryNavigationBackwardsEnablementContext,!0).bindTo(F),K=()=>{O.set(!0),lastFocusedWidget=w},q=()=>{O.set(!1),lastFocusedWidget===w&&(lastFocusedWidget=void 0)};return isActiveElement(w.element)&&K(),D.add(w.onDidFocus(()=>K())),D.add(w.onDidBlur(()=>q())),D.add(toDisposable(()=>{widgets.splice(widgets.indexOf(w),1),q()})),{historyNavigationForwardsEnablement:W,historyNavigationBackwardsEnablement:U,dispose(){D.dispose()}}}let ContextScopedFindInput=class extends FindInput{constructor(w,D,O,W){super(w,D,O);const U=this._register(W.createScoped(this.inputBox.element));this._register(registerAndCreateHistoryNavigationContext(U,this.inputBox))}};ContextScopedFindInput=__decorate$17([__param$14(3,IContextKeyService)],ContextScopedFindInput);let ContextScopedReplaceInput=class extends ReplaceInput{constructor(w,D,O,W,U=!1){super(w,D,U,O);const K=this._register(W.createScoped(this.inputBox.element));this._register(registerAndCreateHistoryNavigationContext(K,this.inputBox))}};ContextScopedReplaceInput=__decorate$17([__param$14(3,IContextKeyService)],ContextScopedReplaceInput);KeybindingsRegistry.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetFocusContext),ContextKeyExpr.equals(HistoryNavigationBackwardsEnablementContext,!0),ContextKeyExpr.not("isComposing"),historyNavigationVisible.isEqualTo(!1)),primary:16,secondary:[528],handler:F=>{lastFocusedWidget?.showPreviousValue()}});KeybindingsRegistry.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetFocusContext),ContextKeyExpr.equals(HistoryNavigationForwardsEnablementContext,!0),ContextKeyExpr.not("isComposing"),historyNavigationVisible.isEqualTo(!1)),primary:18,secondary:[530],handler:F=>{lastFocusedWidget?.showNextValue()}});const Context$1={Visible:historyNavigationVisible,HasFocusedSuggestion:new RawContextKey("suggestWidgetHasFocusedSuggestion",!1,localize("suggestWidgetHasSelection","Whether any suggestion is focused")),DetailsVisible:new RawContextKey("suggestWidgetDetailsVisible",!1,localize("suggestWidgetDetailsVisible","Whether suggestion details are visible")),MultipleSuggestions:new RawContextKey("suggestWidgetMultipleSuggestions",!1,localize("suggestWidgetMultipleSuggestions","Whether there are multiple suggestions to pick from")),MakesTextEdit:new RawContextKey("suggestionMakesTextEdit",!0,localize("suggestionMakesTextEdit","Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new RawContextKey("acceptSuggestionOnEnter",!0,localize("acceptSuggestionOnEnter","Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new RawContextKey("suggestionHasInsertAndReplaceRange",!1,localize("suggestionHasInsertAndReplaceRange","Whether the current suggestion has insert and replace behaviour")),InsertMode:new RawContextKey("suggestionInsertMode",void 0,{type:"string",description:localize("suggestionInsertMode","Whether the default behaviour is to insert or replace")}),CanResolve:new RawContextKey("suggestionCanResolve",!1,localize("suggestionCanResolve","Whether the current suggestion supports to resolve further details"))},suggestWidgetStatusbarMenu=new MenuId("suggestWidgetStatusBar");class CompletionItem{constructor(w,D,O,W){this.position=w,this.completion=D,this.container=O,this.provider=W,this.isInvalid=!1,this.score=FuzzyScore.Default,this.distance=0,this.textLabel=typeof D.label=="string"?D.label:D.label?.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=D.sortText&&D.sortText.toLowerCase(),this.filterTextLow=D.filterText&&D.filterText.toLowerCase(),this.extensionId=D.extensionId,Range$2.isIRange(D.range)?(this.editStart=new Position$1(D.range.startLineNumber,D.range.startColumn),this.editInsertEnd=new Position$1(D.range.endLineNumber,D.range.endColumn),this.editReplaceEnd=new Position$1(D.range.endLineNumber,D.range.endColumn),this.isInvalid=this.isInvalid||Range$2.spansMultipleLines(D.range)||D.range.startLineNumber!==w.lineNumber):(this.editStart=new Position$1(D.range.insert.startLineNumber,D.range.insert.startColumn),this.editInsertEnd=new Position$1(D.range.insert.endLineNumber,D.range.insert.endColumn),this.editReplaceEnd=new Position$1(D.range.replace.endLineNumber,D.range.replace.endColumn),this.isInvalid=this.isInvalid||Range$2.spansMultipleLines(D.range.insert)||Range$2.spansMultipleLines(D.range.replace)||D.range.insert.startLineNumber!==w.lineNumber||D.range.replace.startLineNumber!==w.lineNumber||D.range.insert.startColumn!==D.range.replace.startColumn),typeof W.resolveCompletionItem!="function"&&(this._resolveCache=Promise.resolve(),this._resolveDuration=0)}get isResolved(){return this._resolveDuration!==void 0}get resolveDuration(){return this._resolveDuration!==void 0?this._resolveDuration:-1}async resolve(w){if(!this._resolveCache){const D=w.onCancellationRequested(()=>{this._resolveCache=void 0,this._resolveDuration=void 0}),O=new StopWatch(!0);this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,w)).then(W=>{Object.assign(this.completion,W),this._resolveDuration=O.elapsed()},W=>{isCancellationError(W)&&(this._resolveCache=void 0,this._resolveDuration=void 0)}).finally(()=>{D.dispose()})}return this._resolveCache}}class CompletionOptions{static{this.default=new CompletionOptions}constructor(w=2,D=new Set,O=new Set,W=new Map,U=!0){this.snippetSortOrder=w,this.kindFilter=D,this.providerFilter=O,this.providerItemsToReuse=W,this.showDeprecated=U}}class CompletionItemModel{constructor(w,D,O,W){this.items=w,this.needsClipboard=D,this.durations=O,this.disposable=W}}async function provideSuggestionItems(F,w,D,O=CompletionOptions.default,W={triggerKind:0},U=CancellationToken.None){const K=new StopWatch;D=D.clone();const q=w.getWordAtPosition(D),G=q?new Range$2(D.lineNumber,q.startColumn,D.lineNumber,q.endColumn):Range$2.fromPositions(D),Q={replace:G,insert:G.setEndPosition(D.lineNumber,D.column)},Y=[],X=new DisposableStore,J=[];let te=!1;const ie=(re,ae,le)=>{let de=!1;if(!ae)return de;for(const oe of ae.suggestions)if(!O.kindFilter.has(oe.kind)){if(!O.showDeprecated&&oe?.tags?.includes(1))continue;oe.range||(oe.range=Q),oe.sortText||(oe.sortText=typeof oe.label=="string"?oe.label:oe.label.label),!te&&oe.insertTextRules&&oe.insertTextRules&4&&(te=SnippetParser.guessNeedsClipboard(oe.insertText)),Y.push(new CompletionItem(D,oe,ae,re)),de=!0}return isDisposable(ae)&&X.add(ae),J.push({providerName:re._debugDisplayName??"unknown_provider",elapsedProvider:ae.duration??-1,elapsedOverall:le.elapsed()}),de},se=(async()=>{})();for(const re of F.orderedGroups(w)){let ae=!1;if(await Promise.all(re.map(async le=>{if(O.providerItemsToReuse.has(le)){const de=O.providerItemsToReuse.get(le);de.forEach(oe=>Y.push(oe)),ae=ae||de.length>0;return}if(!(O.providerFilter.size>0&&!O.providerFilter.has(le)))try{const de=new StopWatch,oe=await le.provideCompletionItems(w,D,W,U);ae=ie(le,oe,de)||ae}catch(de){onUnexpectedExternalError(de)}})),ae||U.isCancellationRequested)break}return await se,U.isCancellationRequested?(X.dispose(),Promise.reject(new CancellationError)):new CompletionItemModel(Y.sort(getSuggestionComparator(O.snippetSortOrder)),te,{entries:J,elapsed:K.elapsed()},X)}function defaultComparator(F,w){if(F.sortTextLow&&w.sortTextLow){if(F.sortTextLow<w.sortTextLow)return-1;if(F.sortTextLow>w.sortTextLow)return 1}return F.textLabel<w.textLabel?-1:F.textLabel>w.textLabel?1:F.completion.kind-w.completion.kind}function snippetUpComparator(F,w){if(F.completion.kind!==w.completion.kind){if(F.completion.kind===27)return-1;if(w.completion.kind===27)return 1}return defaultComparator(F,w)}function snippetDownComparator(F,w){if(F.completion.kind!==w.completion.kind){if(F.completion.kind===27)return 1;if(w.completion.kind===27)return-1}return defaultComparator(F,w)}const _snippetComparators=new Map;_snippetComparators.set(0,snippetUpComparator);_snippetComparators.set(2,snippetDownComparator);_snippetComparators.set(1,defaultComparator);function getSuggestionComparator(F){return _snippetComparators.get(F)}CommandsRegistry.registerCommand("_executeCompletionItemProvider",async(F,...w)=>{const[D,O,W,U]=w;assertType(URI.isUri(D)),assertType(Position$1.isIPosition(O)),assertType(typeof W=="string"||!W),assertType(typeof U=="number"||!U);const{completionProvider:K}=F.get(ILanguageFeaturesService),q=await F.get(ITextModelService).createModelReference(D);try{const G={incomplete:!1,suggestions:[]},Q=[],Y=q.object.textEditorModel.validatePosition(O),X=await provideSuggestionItems(K,q.object.textEditorModel,Y,void 0,{triggerCharacter:W??void 0,triggerKind:W?1:0});for(const J of X.items)Q.length<(U??0)&&Q.push(J.resolve(CancellationToken.None)),G.incomplete=G.incomplete||J.container.incomplete,G.suggestions.push(J.completion);try{return await Promise.all(Q),G}finally{setTimeout(()=>X.disposable.dispose(),100)}}finally{q.dispose()}});function showSimpleSuggestions(F,w){F.getContribution("editor.contrib.suggestController")?.triggerSuggest(new Set().add(w),void 0,!0)}class QuickSuggestionsOptions{static isAllOff(w){return w.other==="off"&&w.comments==="off"&&w.strings==="off"}static isAllOn(w){return w.other==="on"&&w.comments==="on"&&w.strings==="on"}static valueFor(w,D){switch(D){case 1:return w.comments;case 2:return w.strings;default:return w.other}}}let Selection$1=class fn extends Range$2{constructor(w,D,O,W){super(w,D,O,W),this.selectionStartLineNumber=w,this.selectionStartColumn=D,this.positionLineNumber=O,this.positionColumn=W}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(w){return fn.selectionsEqual(this,w)}static selectionsEqual(w,D){return w.selectionStartLineNumber===D.selectionStartLineNumber&&w.selectionStartColumn===D.selectionStartColumn&&w.positionLineNumber===D.positionLineNumber&&w.positionColumn===D.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(w,D){return this.getDirection()===0?new fn(this.startLineNumber,this.startColumn,w,D):new fn(w,D,this.startLineNumber,this.startColumn)}getPosition(){return new Position$1(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new Position$1(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(w,D){return this.getDirection()===0?new fn(w,D,this.endLineNumber,this.endColumn):new fn(this.endLineNumber,this.endColumn,w,D)}static fromPositions(w,D=w){return new fn(w.lineNumber,w.column,D.lineNumber,D.column)}static fromRange(w,D){return D===0?new fn(w.startLineNumber,w.startColumn,w.endLineNumber,w.endColumn):new fn(w.endLineNumber,w.endColumn,w.startLineNumber,w.startColumn)}static liftSelection(w){return new fn(w.selectionStartLineNumber,w.selectionStartColumn,w.positionLineNumber,w.positionColumn)}static selectionsArrEqual(w,D){if(w&&!D||!w&&D)return!1;if(!w&&!D)return!0;if(w.length!==D.length)return!1;for(let O=0,W=w.length;O<W;O++)if(!this.selectionsEqual(w[O],D[O]))return!1;return!0}static isISelection(w){return w&&typeof w.selectionStartLineNumber=="number"&&typeof w.selectionStartColumn=="number"&&typeof w.positionLineNumber=="number"&&typeof w.positionColumn=="number"}static createWithDirection(w,D,O,W,U){return U===0?new fn(w,D,O,W):new fn(O,W,w,D)}};function countEOL(F){let w=0,D=0,O=0,W=0;for(let U=0,K=F.length;U<K;U++){const q=F.charCodeAt(U);q===13?(w===0&&(D=U),w++,U+1<K&&F.charCodeAt(U+1)===10?(W|=2,U++):W|=3,O=U+1):q===10&&(W|=1,w===0&&(D=U),w++,O=U+1)}return w===0&&(D=F.length),[w,D,F.length-O,W]}class CursorColumns{static _nextVisibleColumn(w,D,O){return w===9?CursorColumns.nextRenderTabStop(D,O):isFullWidthCharacter(w)||isEmojiImprecise(w)?D+2:D+1}static visibleColumnFromColumn(w,D,O){const W=Math.min(D-1,w.length),U=w.substring(0,W),K=new GraphemeIterator(U);let q=0;for(;!K.eol();){const G=getNextCodePoint(U,W,K.offset);K.nextGraphemeLength(),q=this._nextVisibleColumn(G,q,O)}return q}static columnFromVisibleColumn(w,D,O){if(D<=0)return 1;const W=w.length,U=new GraphemeIterator(w);let K=0,q=1;for(;!U.eol();){const G=getNextCodePoint(w,W,U.offset);U.nextGraphemeLength();const Q=this._nextVisibleColumn(G,K,O),Y=U.offset+1;if(Q>=D){const X=D-K;return Q-D<X?Y:q}K=Q,q=Y}return W+1}static nextRenderTabStop(w,D){return w+D-w%D}static nextIndentTabStop(w,D){return w+D-w%D}static prevRenderTabStop(w,D){return Math.max(0,w-1-(w-1)%D)}static prevIndentTabStop(w,D){return Math.max(0,w-1-(w-1)%D)}}function _normalizeIndentationFromWhitespace(F,w,D){let O=0;for(let U=0;U<F.length;U++)F.charAt(U)==="	"?O=CursorColumns.nextIndentTabStop(O,w):O++;let W="";if(!D){const U=Math.floor(O/w);O=O%w;for(let K=0;K<U;K++)W+="	"}for(let U=0;U<O;U++)W+=" ";return W}function normalizeIndentation(F,w,D){let O=firstNonWhitespaceIndex(F);return O===-1&&(O=F.length),_normalizeIndentationFromWhitespace(F.substring(0,O),w,D)+F.substring(O)}const EDITOR_MODEL_DEFAULTS={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var OverviewRulerLane$1;(function(F){F[F.Left=1]="Left",F[F.Center=2]="Center",F[F.Right=4]="Right",F[F.Full=7]="Full"})(OverviewRulerLane$1||(OverviewRulerLane$1={}));var GlyphMarginLane$1;(function(F){F[F.Left=1]="Left",F[F.Center=2]="Center",F[F.Right=3]="Right"})(GlyphMarginLane$1||(GlyphMarginLane$1={}));var InjectedTextCursorStops$1;(function(F){F[F.Both=0]="Both",F[F.Right=1]="Right",F[F.Left=2]="Left",F[F.None=3]="None"})(InjectedTextCursorStops$1||(InjectedTextCursorStops$1={}));class TextModelResolvedOptions{get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(w){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,w.tabSize|0),w.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,w.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!w.insertSpaces,this.defaultEOL=w.defaultEOL|0,this.trimAutoWhitespace=!!w.trimAutoWhitespace,this.bracketPairColorizationOptions=w.bracketPairColorizationOptions}equals(w){return this.tabSize===w.tabSize&&this._indentSizeIsTabSize===w._indentSizeIsTabSize&&this.indentSize===w.indentSize&&this.insertSpaces===w.insertSpaces&&this.defaultEOL===w.defaultEOL&&this.trimAutoWhitespace===w.trimAutoWhitespace&&equals(this.bracketPairColorizationOptions,w.bracketPairColorizationOptions)}createChangeEvent(w){return{tabSize:this.tabSize!==w.tabSize,indentSize:this.indentSize!==w.indentSize,insertSpaces:this.insertSpaces!==w.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==w.trimAutoWhitespace}}}class FindMatch{constructor(w,D){this._findMatchBrand=void 0,this.range=w,this.matches=D}}function isITextSnapshot(F){return F&&typeof F.read=="function"}class ValidAnnotatedEditOperation{constructor(w,D,O,W,U,K){this.identifier=w,this.range=D,this.text=O,this.forceMoveMarkers=W,this.isAutoWhitespaceEdit=U,this._isTracked=K}}class SearchData{constructor(w,D,O){this.regex=w,this.wordSeparators=D,this.simpleSearch=O}}class ApplyEditsResult{constructor(w,D,O){this.reverseEdits=w,this.changes=D,this.trimAutoWhitespaceLineNumbers=O}}function shouldSynchronizeModel(F){return!F.isTooLargeForSyncing()&&!F.isForSimpleWidget}class BracketInfo{constructor(w,D,O,W){this.range=w,this.nestingLevel=D,this.nestingLevelOfEqualBracketType=O,this.isInvalid=W}}class BracketPairInfo{constructor(w,D,O,W,U,K){this.range=w,this.openingBracketRange=D,this.closingBracketRange=O,this.nestingLevel=W,this.nestingLevelOfEqualBracketType=U,this.bracketPairNode=K}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}}class BracketPairWithMinIndentationInfo extends BracketPairInfo{constructor(w,D,O,W,U,K,q){super(w,D,O,W,U,K),this.minVisibleColumnIndentation=q}}class TextLength{static{this.zero=new TextLength(0,0)}static betweenPositions(w,D){return w.lineNumber===D.lineNumber?new TextLength(0,D.column-w.column):new TextLength(D.lineNumber-w.lineNumber,D.column-1)}static ofRange(w){return TextLength.betweenPositions(w.getStartPosition(),w.getEndPosition())}static ofText(w){let D=0,O=0;for(const W of w)W===`
`?(D++,O=0):O++;return new TextLength(D,O)}constructor(w,D){this.lineCount=w,this.columnCount=D}isGreaterThanOrEqualTo(w){return this.lineCount!==w.lineCount?this.lineCount>w.lineCount:this.columnCount>=w.columnCount}createRange(w){return this.lineCount===0?new Range$2(w.lineNumber,w.column,w.lineNumber,w.column+this.columnCount):new Range$2(w.lineNumber,w.column,w.lineNumber+this.lineCount,this.columnCount+1)}addToPosition(w){return this.lineCount===0?new Position$1(w.lineNumber,w.column+this.columnCount):new Position$1(w.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}}function lengthDiff(F,w,D,O){return F!==D?toLength(D-F,O):toLength(0,O-w)}const lengthZero=0;function lengthIsZero(F){return F===0}const factor=2**26;function toLength(F,w){return F*factor+w}function lengthToObj(F){const w=F,D=Math.floor(w/factor),O=w-D*factor;return new TextLength(D,O)}function lengthGetLineCount(F){return Math.floor(F/factor)}function lengthGetColumnCountIfZeroLineCount(F){return F}function lengthAdd(F,w){let D=F+w;return w>=factor&&(D=D-F%factor),D}function sumLengths(F,w){return F.reduce((D,O)=>lengthAdd(D,w(O)),lengthZero)}function lengthEquals(F,w){return F===w}function lengthDiffNonNegative(F,w){const D=F,O=w;if(O-D<=0)return lengthZero;const U=Math.floor(D/factor),K=Math.floor(O/factor),q=O-K*factor;if(U===K){const G=D-U*factor;return toLength(0,q-G)}else return toLength(K-U,q)}function lengthLessThan(F,w){return F<w}function lengthLessThanEqual(F,w){return F<=w}function lengthGreaterThanEqual(F,w){return F>=w}function positionToLength(F){return toLength(F.lineNumber-1,F.column-1)}function lengthsToRange(F,w){const D=F,O=Math.floor(D/factor),W=D-O*factor,U=w,K=Math.floor(U/factor),q=U-K*factor;return new Range$2(O+1,W+1,K+1,q+1)}function lengthOfString(F){const w=splitLines(F);return toLength(w.length-1,w[w.length-1].length)}class TextEditInfo{static fromModelContentChanges(w){return w.map(O=>{const W=Range$2.lift(O.range);return new TextEditInfo(positionToLength(W.getStartPosition()),positionToLength(W.getEndPosition()),lengthOfString(O.text))}).reverse()}constructor(w,D,O){this.startOffset=w,this.endOffset=D,this.newLength=O}toString(){return`[${lengthToObj(this.startOffset)}...${lengthToObj(this.endOffset)}) -> ${lengthToObj(this.newLength)}`}}class BeforeEditPositionMapper{constructor(w){this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=w.map(D=>TextEditInfoCache.from(D))}getOffsetBeforeChange(w){return this.adjustNextEdit(w),this.translateCurToOld(w)}getDistanceToNextChange(w){this.adjustNextEdit(w);const D=this.edits[this.nextEditIdx],O=D?this.translateOldToCur(D.offsetObj):null;return O===null?null:lengthDiffNonNegative(w,O)}translateOldToCur(w){return w.lineCount===this.deltaLineIdxInOld?toLength(w.lineCount+this.deltaOldToNewLineCount,w.columnCount+this.deltaOldToNewColumnCount):toLength(w.lineCount+this.deltaOldToNewLineCount,w.columnCount)}translateCurToOld(w){const D=lengthToObj(w);return D.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?toLength(D.lineCount-this.deltaOldToNewLineCount,D.columnCount-this.deltaOldToNewColumnCount):toLength(D.lineCount-this.deltaOldToNewLineCount,D.columnCount)}adjustNextEdit(w){for(;this.nextEditIdx<this.edits.length;){const D=this.edits[this.nextEditIdx],O=this.translateOldToCur(D.endOffsetAfterObj);if(lengthLessThanEqual(O,w)){this.nextEditIdx++;const W=lengthToObj(O),U=lengthToObj(this.translateOldToCur(D.endOffsetBeforeObj)),K=W.lineCount-U.lineCount;this.deltaOldToNewLineCount+=K;const q=this.deltaLineIdxInOld===D.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,G=W.columnCount-U.columnCount;this.deltaOldToNewColumnCount=q+G,this.deltaLineIdxInOld=D.endOffsetBeforeObj.lineCount}else break}}}class TextEditInfoCache{static from(w){return new TextEditInfoCache(w.startOffset,w.endOffset,w.newLength)}constructor(w,D,O){this.endOffsetBeforeObj=lengthToObj(D),this.endOffsetAfterObj=lengthToObj(lengthAdd(w,O)),this.offsetObj=lengthToObj(w)}}const emptyArr$2=[];class SmallImmutableSet{static{this.cache=new Array(129)}static create(w,D){if(w<=128&&D.length===0){let O=SmallImmutableSet.cache[w];return O||(O=new SmallImmutableSet(w,D),SmallImmutableSet.cache[w]=O),O}return new SmallImmutableSet(w,D)}static{this.empty=SmallImmutableSet.create(0,emptyArr$2)}static getEmpty(){return this.empty}constructor(w,D){this.items=w,this.additionalItems=D}add(w,D){const O=D.getKey(w);let W=O>>5;if(W===0){const K=1<<O|this.items;return K===this.items?this:SmallImmutableSet.create(K,this.additionalItems)}W--;const U=this.additionalItems.slice(0);for(;U.length<W;)U.push(0);return U[W]|=1<<(O&31),SmallImmutableSet.create(this.items,U)}merge(w){const D=this.items|w.items;if(this.additionalItems===emptyArr$2&&w.additionalItems===emptyArr$2)return D===this.items?this:D===w.items?w:SmallImmutableSet.create(D,emptyArr$2);const O=[];for(let W=0;W<Math.max(this.additionalItems.length,w.additionalItems.length);W++){const U=this.additionalItems[W]||0,K=w.additionalItems[W]||0;O.push(U|K)}return SmallImmutableSet.create(D,O)}intersects(w){if((this.items&w.items)!==0)return!0;for(let D=0;D<Math.min(this.additionalItems.length,w.additionalItems.length);D++)if((this.additionalItems[D]&w.additionalItems[D])!==0)return!0;return!1}}const identityKeyProvider={getKey(F){return F}};class DenseKeyProvider{constructor(){this.items=new Map}getKey(w){let D=this.items.get(w);return D===void 0&&(D=this.items.size,this.items.set(w,D)),D}}class BaseAstNode{get length(){return this._length}constructor(w){this._length=w}}class PairAstNode extends BaseAstNode{static create(w,D,O){let W=w.length;return D&&(W=lengthAdd(W,D.length)),O&&(W=lengthAdd(W,O.length)),new PairAstNode(W,w,D,O,D?D.missingOpeningBracketIds:SmallImmutableSet.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(w){switch(w){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const w=[];return w.push(this.openingBracket),this.child&&w.push(this.child),this.closingBracket&&w.push(this.closingBracket),w}constructor(w,D,O,W,U){super(w),this.openingBracket=D,this.child=O,this.closingBracket=W,this.missingOpeningBracketIds=U}canBeReused(w){return!(this.closingBracket===null||w.intersects(this.missingOpeningBracketIds))}deepClone(){return new PairAstNode(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(w,D){return this.child?this.child.computeMinIndentation(lengthAdd(w,this.openingBracket.length),D):Number.MAX_SAFE_INTEGER}}class ListAstNode extends BaseAstNode{static create23(w,D,O,W=!1){let U=w.length,K=w.missingOpeningBracketIds;if(w.listHeight!==D.listHeight)throw new Error("Invalid list heights");if(U=lengthAdd(U,D.length),K=K.merge(D.missingOpeningBracketIds),O){if(w.listHeight!==O.listHeight)throw new Error("Invalid list heights");U=lengthAdd(U,O.length),K=K.merge(O.missingOpeningBracketIds)}return W?new Immutable23ListAstNode(U,w.listHeight+1,w,D,O,K):new TwoThreeListAstNode(U,w.listHeight+1,w,D,O,K)}static getEmpty(){return new ImmutableArrayListAstNode(lengthZero,0,[],SmallImmutableSet.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}constructor(w,D,O){super(w),this.listHeight=D,this._missingOpeningBracketIds=O,this.cachedMinIndentation=-1}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const w=this.childrenLength;if(w===0)return;const D=this.getChild(w-1),O=D.kind===4?D.toMutable():D;return D!==O&&this.setChild(w-1,O),O}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;const D=this.getChild(0),O=D.kind===4?D.toMutable():D;return D!==O&&this.setChild(0,O),O}canBeReused(w){if(w.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let D=this;for(;D.kind===4;){const O=D.childrenLength;if(O===0)throw new BugIndicatingError;D=D.getChild(O-1)}return D.canBeReused(w)}handleChildrenChanged(){this.throwIfImmutable();const w=this.childrenLength;let D=this.getChild(0).length,O=this.getChild(0).missingOpeningBracketIds;for(let W=1;W<w;W++){const U=this.getChild(W);D=lengthAdd(D,U.length),O=O.merge(U.missingOpeningBracketIds)}this._length=D,this._missingOpeningBracketIds=O,this.cachedMinIndentation=-1}computeMinIndentation(w,D){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let O=Number.MAX_SAFE_INTEGER,W=w;for(let U=0;U<this.childrenLength;U++){const K=this.getChild(U);K&&(O=Math.min(O,K.computeMinIndentation(W,D)),W=lengthAdd(W,K.length))}return this.cachedMinIndentation=O,O}}class TwoThreeListAstNode extends ListAstNode{get childrenLength(){return this._item3!==null?3:2}getChild(w){switch(w){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(w,D){switch(w){case 0:this._item1=D;return;case 1:this._item2=D;return;case 2:this._item3=D;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}constructor(w,D,O,W,U,K){super(w,D,K),this._item1=O,this._item2=W,this._item3=U}deepClone(){return new TwoThreeListAstNode(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(w){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=w,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const w=this._item3;return this._item3=null,this.handleChildrenChanged(),w}prependChildOfSameHeight(w){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=w,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const w=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),w}toMutable(){return this}}class Immutable23ListAstNode extends TwoThreeListAstNode{toMutable(){return new TwoThreeListAstNode(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class ArrayListAstNode extends ListAstNode{get childrenLength(){return this._children.length}getChild(w){return this._children[w]}setChild(w,D){this._children[w]=D}get children(){return this._children}constructor(w,D,O,W){super(w,D,W),this._children=O}deepClone(){const w=new Array(this._children.length);for(let D=0;D<this._children.length;D++)w[D]=this._children[D].deepClone();return new ArrayListAstNode(this.length,this.listHeight,w,this.missingOpeningBracketIds)}appendChildOfSameHeight(w){this.throwIfImmutable(),this._children.push(w),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const w=this._children.pop();return this.handleChildrenChanged(),w}prependChildOfSameHeight(w){this.throwIfImmutable(),this._children.unshift(w),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const w=this._children.shift();return this.handleChildrenChanged(),w}toMutable(){return this}}class ImmutableArrayListAstNode extends ArrayListAstNode{toMutable(){return new ArrayListAstNode(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const emptyArray=[];class ImmutableLeafAstNode extends BaseAstNode{get listHeight(){return 0}get childrenLength(){return 0}getChild(w){return null}get children(){return emptyArray}deepClone(){return this}}class TextAstNode extends ImmutableLeafAstNode{get kind(){return 0}get missingOpeningBracketIds(){return SmallImmutableSet.getEmpty()}canBeReused(w){return!0}computeMinIndentation(w,D){const O=lengthToObj(w),W=(O.columnCount===0?O.lineCount:O.lineCount+1)+1,U=lengthGetLineCount(lengthAdd(w,this.length))+1;let K=Number.MAX_SAFE_INTEGER;for(let q=W;q<=U;q++){const G=D.getLineFirstNonWhitespaceColumn(q),Q=D.getLineContent(q);if(G===0)continue;const Y=CursorColumns.visibleColumnFromColumn(Q,G,D.getOptions().tabSize);K=Math.min(K,Y)}return K}}class BracketAstNode extends ImmutableLeafAstNode{static create(w,D,O){return new BracketAstNode(w,D,O)}get kind(){return 1}get missingOpeningBracketIds(){return SmallImmutableSet.getEmpty()}constructor(w,D,O){super(w),this.bracketInfo=D,this.bracketIds=O}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(w){return!1}computeMinIndentation(w,D){return Number.MAX_SAFE_INTEGER}}class InvalidBracketAstNode extends ImmutableLeafAstNode{get kind(){return 3}constructor(w,D){super(D),this.missingOpeningBracketIds=w}canBeReused(w){return!w.intersects(this.missingOpeningBracketIds)}computeMinIndentation(w,D){return Number.MAX_SAFE_INTEGER}}class TokenMetadata{static getLanguageId(w){return(w&255)>>>0}static getTokenType(w){return(w&768)>>>8}static containsBalancedBrackets(w){return(w&1024)!==0}static getFontStyle(w){return(w&30720)>>>11}static getForeground(w){return(w&16744448)>>>15}static getBackground(w){return(w&4278190080)>>>24}static getClassNameFromMetadata(w){let O="mtk"+this.getForeground(w);const W=this.getFontStyle(w);return W&1&&(O+=" mtki"),W&2&&(O+=" mtkb"),W&4&&(O+=" mtku"),W&8&&(O+=" mtks"),O}static getInlineStyleFromMetadata(w,D){const O=this.getForeground(w),W=this.getFontStyle(w);let U=`color: ${D[O]};`;W&1&&(U+="font-style: italic;"),W&2&&(U+="font-weight: bold;");let K="";return W&4&&(K+=" underline"),W&8&&(K+=" line-through"),K&&(U+=`text-decoration:${K};`),U}static getPresentationFromMetadata(w){const D=this.getForeground(w),O=this.getFontStyle(w);return{foreground:D,italic:!!(O&1),bold:!!(O&2),underline:!!(O&4),strikethrough:!!(O&8)}}}let Token$2=class{constructor(w,D,O,W,U){this.length=w,this.kind=D,this.bracketId=O,this.bracketIds=W,this.astNode=U}};class TextBufferTokenizer{constructor(w,D){this.textModel=w,this.bracketTokens=D,this.reader=new NonPeekableTextBufferTokenizer(this.textModel,this.bracketTokens),this._offset=lengthZero,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=w.getLineCount(),this.textBufferLastLineLength=w.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return toLength(this.textBufferLineCount-1,this.textBufferLastLineLength)}skip(w){this.didPeek=!1,this._offset=lengthAdd(this._offset,w);const D=lengthToObj(this._offset);this.reader.setPosition(D.lineCount,D.columnCount)}read(){let w;return this.peeked?(this.didPeek=!1,w=this.peeked):w=this.reader.read(),w&&(this._offset=lengthAdd(this._offset,w.length)),w}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class NonPeekableTextBufferTokenizer{constructor(w,D){this.textModel=w,this.bracketTokens=D,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=w.getLineCount(),this.textBufferLastLineLength=w.getLineLength(this.textBufferLineCount)}setPosition(w,D){w===this.lineIdx?(this.lineCharOffset=D,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=w,this.lineCharOffset=D,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const U=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=U.length,U}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const w=this.lineIdx,D=this.lineCharOffset;let O=0;for(;;){const U=this.lineTokens,K=U.getCount();let q=null;if(this.lineTokenOffset<K){const G=U.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<K&&G===U.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const Q=TokenMetadata.getTokenType(G)===0,Y=TokenMetadata.containsBalancedBrackets(G),X=U.getEndOffset(this.lineTokenOffset);if(Y&&Q&&this.lineCharOffset<X){const J=U.getLanguageId(this.lineTokenOffset),te=this.line.substring(this.lineCharOffset,X),ie=this.bracketTokens.getSingleLanguageBracketTokens(J),se=ie.regExpGlobal;if(se){se.lastIndex=0;const re=se.exec(te);re&&(q=ie.getToken(re[0]),q&&(this.lineCharOffset+=re.index))}}if(O+=X-this.lineCharOffset,q)if(w!==this.lineIdx||D!==this.lineCharOffset){this.peekedToken=q;break}else return this.lineCharOffset+=q.length,q;else this.lineTokenOffset++,this.lineCharOffset=X}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,O+=33,O>1e3))break;if(O>1500)break}const W=lengthDiff(w,D,this.lineIdx,this.lineCharOffset);return new Token$2(W,0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(W))}}class FastTokenizer{constructor(w,D){this.text=w,this._offset=lengthZero,this.idx=0;const O=D.getRegExpStr(),W=O?new RegExp(O+`|
`,"gi"):null,U=[];let K,q=0,G=0,Q=0,Y=0;const X=[];for(let ie=0;ie<60;ie++)X.push(new Token$2(toLength(0,ie),0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(toLength(0,ie))));const J=[];for(let ie=0;ie<60;ie++)J.push(new Token$2(toLength(1,ie),0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(toLength(1,ie))));if(W)for(W.lastIndex=0;(K=W.exec(w))!==null;){const ie=K.index,se=K[0];if(se===`
`)q++,G=ie+1;else{if(Q!==ie){let re;if(Y===q){const ae=ie-Q;if(ae<X.length)re=X[ae];else{const le=toLength(0,ae);re=new Token$2(le,0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(le))}}else{const ae=q-Y,le=ie-G;if(ae===1&&le<J.length)re=J[le];else{const de=toLength(ae,le);re=new Token$2(de,0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(de))}}U.push(re)}U.push(D.getToken(se)),Q=ie+se.length,Y=q}}const te=w.length;if(Q!==te){const ie=Y===q?toLength(0,te-Q):toLength(q-Y,te-G);U.push(new Token$2(ie,0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(ie)))}this.length=toLength(q,te-G),this.tokens=U}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(w){throw new NotSupportedError}}class BracketTokens{static createFromLanguage(w,D){function O(U){return D.getKey(`${U.languageId}:::${U.bracketText}`)}const W=new Map;for(const U of w.bracketsNew.openingBrackets){const K=toLength(0,U.bracketText.length),q=O(U),G=SmallImmutableSet.getEmpty().add(q,identityKeyProvider);W.set(U.bracketText,new Token$2(K,1,q,G,BracketAstNode.create(K,U,G)))}for(const U of w.bracketsNew.closingBrackets){const K=toLength(0,U.bracketText.length);let q=SmallImmutableSet.getEmpty();const G=U.getOpeningBrackets();for(const Q of G)q=q.add(O(Q),identityKeyProvider);W.set(U.bracketText,new Token$2(K,2,O(G[0]),q,BracketAstNode.create(K,U,q)))}return new BracketTokens(W)}constructor(w){this.map=w,this.hasRegExp=!1,this._regExpGlobal=null}getRegExpStr(){if(this.isEmpty)return null;{const w=[...this.map.keys()];return w.sort(),w.reverse(),w.map(D=>prepareBracketForRegExp(D)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const w=this.getRegExpStr();this._regExpGlobal=w?new RegExp(w,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(w){return this.map.get(w.toLowerCase())}findClosingTokenText(w){for(const[D,O]of this.map)if(O.kind===2&&O.bracketIds.intersects(w))return D}get isEmpty(){return this.map.size===0}}function prepareBracketForRegExp(F){let w=escapeRegExpCharacters(F);return/^[\w ]+/.test(F)&&(w=`\\b${w}`),/[\w ]+$/.test(F)&&(w=`${w}\\b`),w}class LanguageAgnosticBracketTokens{constructor(w,D){this.denseKeyProvider=w,this.getLanguageConfiguration=D,this.languageIdToBracketTokens=new Map}didLanguageChange(w){return this.languageIdToBracketTokens.has(w)}getSingleLanguageBracketTokens(w){let D=this.languageIdToBracketTokens.get(w);return D||(D=BracketTokens.createFromLanguage(this.getLanguageConfiguration(w),this.denseKeyProvider),this.languageIdToBracketTokens.set(w,D)),D}}function concat23Trees(F){if(F.length===0)return null;if(F.length===1)return F[0];let w=0;function D(){if(w>=F.length)return null;const K=w,q=F[K].listHeight;for(w++;w<F.length&&F[w].listHeight===q;)w++;return w-K>=2?concat23TreesOfSameHeight(K===0&&w===F.length?F:F.slice(K,w),!1):F[K]}let O=D(),W=D();if(!W)return O;for(let K=D();K;K=D())heightDiff(O,W)<=heightDiff(W,K)?(O=concat(O,W),W=K):W=concat(W,K);return concat(O,W)}function concat23TreesOfSameHeight(F,w=!1){if(F.length===0)return null;if(F.length===1)return F[0];let D=F.length;for(;D>3;){const O=D>>1;for(let W=0;W<O;W++){const U=W<<1;F[W]=ListAstNode.create23(F[U],F[U+1],U+3===D?F[U+2]:null,w)}D=O}return ListAstNode.create23(F[0],F[1],D>=3?F[2]:null,w)}function heightDiff(F,w){return Math.abs(F.listHeight-w.listHeight)}function concat(F,w){return F.listHeight===w.listHeight?ListAstNode.create23(F,w,null,!1):F.listHeight>w.listHeight?append(F,w):prepend(w,F)}function append(F,w){F=F.toMutable();let D=F;const O=[];let W;for(;;){if(w.listHeight===D.listHeight){W=w;break}if(D.kind!==4)throw new Error("unexpected");O.push(D),D=D.makeLastElementMutable()}for(let U=O.length-1;U>=0;U--){const K=O[U];W?K.childrenLength>=3?W=ListAstNode.create23(K.unappendChild(),W,null,!1):(K.appendChildOfSameHeight(W),W=void 0):K.handleChildrenChanged()}return W?ListAstNode.create23(F,W,null,!1):F}function prepend(F,w){F=F.toMutable();let D=F;const O=[];for(;w.listHeight!==D.listHeight;){if(D.kind!==4)throw new Error("unexpected");O.push(D),D=D.makeFirstElementMutable()}let W=w;for(let U=O.length-1;U>=0;U--){const K=O[U];W?K.childrenLength>=3?W=ListAstNode.create23(W,K.unprependChild(),null,!1):(K.prependChildOfSameHeight(W),W=void 0):K.handleChildrenChanged()}return W?ListAstNode.create23(W,F,null,!1):F}class NodeReader{constructor(w){this.lastOffset=lengthZero,this.nextNodes=[w],this.offsets=[lengthZero],this.idxs=[]}readLongestNodeAt(w,D){if(lengthLessThan(w,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=w;;){const O=lastOrUndefined(this.nextNodes);if(!O)return;const W=lastOrUndefined(this.offsets);if(lengthLessThan(w,W))return;if(lengthLessThan(W,w))if(lengthAdd(W,O.length)<=w)this.nextNodeAfterCurrent();else{const U=getNextChildIdx(O);U!==-1?(this.nextNodes.push(O.getChild(U)),this.offsets.push(W),this.idxs.push(U)):this.nextNodeAfterCurrent()}else{if(D(O))return this.nextNodeAfterCurrent(),O;{const U=getNextChildIdx(O);if(U===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(O.getChild(U)),this.offsets.push(W),this.idxs.push(U)}}}}nextNodeAfterCurrent(){for(;;){const w=lastOrUndefined(this.offsets),D=lastOrUndefined(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;const O=lastOrUndefined(this.nextNodes),W=getNextChildIdx(O,this.idxs[this.idxs.length-1]);if(W!==-1){this.nextNodes.push(O.getChild(W)),this.offsets.push(lengthAdd(w,D.length)),this.idxs[this.idxs.length-1]=W;break}else this.idxs.pop()}}}function getNextChildIdx(F,w=-1){for(;;){if(w++,w>=F.childrenLength)return-1;if(F.getChild(w))return w}}function lastOrUndefined(F){return F.length>0?F[F.length-1]:void 0}function parseDocument(F,w,D,O){return new Parser(F,w,D,O).parseDocument()}class Parser{constructor(w,D,O,W){if(this.tokenizer=w,this.createImmutableLists=W,this._itemsConstructed=0,this._itemsFromCache=0,O&&W)throw new Error("Not supported");this.oldNodeReader=O?new NodeReader(O):void 0,this.positionMapper=new BeforeEditPositionMapper(D)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let w=this.parseList(SmallImmutableSet.getEmpty(),0);return w||(w=ListAstNode.getEmpty()),w}parseList(w,D){const O=[];for(;;){let U=this.tryReadChildFromCache(w);if(!U){const K=this.tokenizer.peek();if(!K||K.kind===2&&K.bracketIds.intersects(w))break;U=this.parseChild(w,D+1)}U.kind===4&&U.childrenLength===0||O.push(U)}return this.oldNodeReader?concat23Trees(O):concat23TreesOfSameHeight(O,this.createImmutableLists)}tryReadChildFromCache(w){if(this.oldNodeReader){const D=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(D===null||!lengthIsZero(D)){const O=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),W=>D!==null&&!lengthLessThan(W.length,D)?!1:W.canBeReused(w));if(O)return this._itemsFromCache++,this.tokenizer.skip(O.length),O}}}parseChild(w,D){this._itemsConstructed++;const O=this.tokenizer.read();switch(O.kind){case 2:return new InvalidBracketAstNode(O.bracketIds,O.length);case 0:return O.astNode;case 1:{if(D>300)return new TextAstNode(O.length);const W=w.merge(O.bracketIds),U=this.parseList(W,D+1),K=this.tokenizer.peek();return K&&K.kind===2&&(K.bracketId===O.bracketId||K.bracketIds.intersects(O.bracketIds))?(this.tokenizer.read(),PairAstNode.create(O.astNode,U,K.astNode)):PairAstNode.create(O.astNode,U,null)}default:throw new Error("unexpected")}}}function combineTextEditInfos(F,w){if(F.length===0)return w;if(w.length===0)return F;const D=new ArrayQueue(toLengthMapping(F)),O=toLengthMapping(w);O.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let W=D.dequeue();function U(Q){if(Q===void 0){const X=D.takeWhile(J=>!0)||[];return W&&X.unshift(W),X}const Y=[];for(;W&&!lengthIsZero(Q);){const[X,J]=W.splitAt(Q);Y.push(X),Q=lengthDiffNonNegative(X.lengthAfter,Q),W=J??D.dequeue()}return lengthIsZero(Q)||Y.push(new LengthMapping(!1,Q,Q)),Y}const K=[];function q(Q,Y,X){if(K.length>0&&lengthEquals(K[K.length-1].endOffset,Q)){const J=K[K.length-1];K[K.length-1]=new TextEditInfo(J.startOffset,Y,lengthAdd(J.newLength,X))}else K.push({startOffset:Q,endOffset:Y,newLength:X})}let G=lengthZero;for(const Q of O){const Y=U(Q.lengthBefore);if(Q.modified){const X=sumLengths(Y,te=>te.lengthBefore),J=lengthAdd(G,X);q(G,J,Q.lengthAfter),G=J}else for(const X of Y){const J=G;G=lengthAdd(G,X.lengthBefore),X.modified&&q(J,G,X.lengthAfter)}}return K}class LengthMapping{constructor(w,D,O){this.modified=w,this.lengthBefore=D,this.lengthAfter=O}splitAt(w){const D=lengthDiffNonNegative(w,this.lengthAfter);return lengthEquals(D,lengthZero)?[this,void 0]:this.modified?[new LengthMapping(this.modified,this.lengthBefore,w),new LengthMapping(this.modified,lengthZero,D)]:[new LengthMapping(this.modified,w,w),new LengthMapping(this.modified,D,D)]}toString(){return`${this.modified?"M":"U"}:${lengthToObj(this.lengthBefore)} -> ${lengthToObj(this.lengthAfter)}`}}function toLengthMapping(F){const w=[];let D=lengthZero;for(const O of F){const W=lengthDiffNonNegative(D,O.startOffset);lengthIsZero(W)||w.push(new LengthMapping(!1,W,W));const U=lengthDiffNonNegative(O.startOffset,O.endOffset);w.push(new LengthMapping(!0,U,O.newLength)),D=O.endOffset}return w}class BracketPairsTree extends Disposable{didLanguageChange(w){return this.brackets.didLanguageChange(w)}constructor(w,D){if(super(),this.textModel=w,this.getLanguageConfiguration=D,this.didChangeEmitter=new Emitter$1,this.denseKeyProvider=new DenseKeyProvider,this.brackets=new LanguageAgnosticBracketTokens(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this.queuedTextEditsForInitialAstWithoutTokens=[],this.queuedTextEdits=[],w.tokenization.hasTokens)w.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{const O=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),W=new FastTokenizer(this.textModel.getValue(),O);this.initialAstWithoutTokens=parseDocument(W,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){const w=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,w||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:w}){const D=w.map(O=>new TextEditInfo(toLength(O.fromLineNumber-1,0),toLength(O.toLineNumber,0),toLength(O.toLineNumber-O.fromLineNumber+1,0)));this.handleEdits(D,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(w){const D=TextEditInfo.fromModelContentChanges(w.changes);this.handleEdits(D,!1)}handleEdits(w,D){const O=combineTextEditInfos(this.queuedTextEdits,w);this.queuedTextEdits=O,this.initialAstWithoutTokens&&!D&&(this.queuedTextEditsForInitialAstWithoutTokens=combineTextEditInfos(this.queuedTextEditsForInitialAstWithoutTokens,w))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(w,D,O){const W=D,U=new TextBufferTokenizer(this.textModel,this.brackets);return parseDocument(U,w,W,O)}getBracketsInRange(w,D){this.flushQueue();const O=toLength(w.startLineNumber-1,w.startColumn-1),W=toLength(w.endLineNumber-1,w.endColumn-1);return new CallbackIterable(U=>{const K=this.initialAstWithoutTokens||this.astWithTokens;collectBrackets(K,lengthZero,K.length,O,W,U,0,0,new Map,D)})}getBracketPairsInRange(w,D){this.flushQueue();const O=positionToLength(w.getStartPosition()),W=positionToLength(w.getEndPosition());return new CallbackIterable(U=>{const K=this.initialAstWithoutTokens||this.astWithTokens,q=new CollectBracketPairsContext(U,D,this.textModel);collectBracketPairs(K,lengthZero,K.length,O,W,q,0,new Map)})}getFirstBracketAfter(w){this.flushQueue();const D=this.initialAstWithoutTokens||this.astWithTokens;return getFirstBracketAfter(D,lengthZero,D.length,positionToLength(w))}getFirstBracketBefore(w){this.flushQueue();const D=this.initialAstWithoutTokens||this.astWithTokens;return getFirstBracketBefore(D,lengthZero,D.length,positionToLength(w))}}function getFirstBracketBefore(F,w,D,O){if(F.kind===4||F.kind===2){const W=[];for(const U of F.children)D=lengthAdd(w,U.length),W.push({nodeOffsetStart:w,nodeOffsetEnd:D}),w=D;for(let U=W.length-1;U>=0;U--){const{nodeOffsetStart:K,nodeOffsetEnd:q}=W[U];if(lengthLessThan(K,O)){const G=getFirstBracketBefore(F.children[U],K,q,O);if(G)return G}}return null}else{if(F.kind===3)return null;if(F.kind===1){const W=lengthsToRange(w,D);return{bracketInfo:F.bracketInfo,range:W}}}return null}function getFirstBracketAfter(F,w,D,O){if(F.kind===4||F.kind===2){for(const W of F.children){if(D=lengthAdd(w,W.length),lengthLessThan(O,D)){const U=getFirstBracketAfter(W,w,D,O);if(U)return U}w=D}return null}else{if(F.kind===3)return null;if(F.kind===1){const W=lengthsToRange(w,D);return{bracketInfo:F.bracketInfo,range:W}}}return null}function collectBrackets(F,w,D,O,W,U,K,q,G,Q,Y=!1){if(K>200)return!0;e:for(;;)switch(F.kind){case 4:{const X=F.childrenLength;for(let J=0;J<X;J++){const te=F.getChild(J);if(te){if(D=lengthAdd(w,te.length),lengthLessThanEqual(w,W)&&lengthGreaterThanEqual(D,O)){if(lengthGreaterThanEqual(D,W)){F=te;continue e}if(!collectBrackets(te,w,D,O,W,U,K,0,G,Q))return!1}w=D}}return!0}case 2:{const X=!Q||!F.closingBracket||F.closingBracket.bracketInfo.closesColorized(F.openingBracket.bracketInfo);let J=0;if(G){let ie=G.get(F.openingBracket.text);ie===void 0&&(ie=0),J=ie,X&&(ie++,G.set(F.openingBracket.text,ie))}const te=F.childrenLength;for(let ie=0;ie<te;ie++){const se=F.getChild(ie);if(se){if(D=lengthAdd(w,se.length),lengthLessThanEqual(w,W)&&lengthGreaterThanEqual(D,O)){if(lengthGreaterThanEqual(D,W)&&se.kind!==1){F=se,X?(K++,q=J+1):q=J;continue e}if((X||se.kind!==1||!F.closingBracket)&&!collectBrackets(se,w,D,O,W,U,X?K+1:K,X?J+1:J,G,Q,!F.closingBracket))return!1}w=D}}return G?.set(F.openingBracket.text,J),!0}case 3:{const X=lengthsToRange(w,D);return U(new BracketInfo(X,K-1,0,!0))}case 1:{const X=lengthsToRange(w,D);return U(new BracketInfo(X,K-1,q-1,Y))}case 0:return!0}}class CollectBracketPairsContext{constructor(w,D,O){this.push=w,this.includeMinIndentation=D,this.textModel=O}}function collectBracketPairs(F,w,D,O,W,U,K,q){if(K>200)return!0;let G=!0;if(F.kind===2){let Q=0;if(q){let J=q.get(F.openingBracket.text);J===void 0&&(J=0),Q=J,J++,q.set(F.openingBracket.text,J)}const Y=lengthAdd(w,F.openingBracket.length);let X=-1;if(U.includeMinIndentation&&(X=F.computeMinIndentation(w,U.textModel)),G=U.push(new BracketPairWithMinIndentationInfo(lengthsToRange(w,D),lengthsToRange(w,Y),F.closingBracket?lengthsToRange(lengthAdd(Y,F.child?.length||lengthZero),D):void 0,K,Q,F,X)),w=Y,G&&F.child){const J=F.child;if(D=lengthAdd(w,J.length),lengthLessThanEqual(w,W)&&lengthGreaterThanEqual(D,O)&&(G=collectBracketPairs(J,w,D,O,W,U,K+1,q),!G))return!1}q?.set(F.openingBracket.text,Q)}else{let Q=w;for(const Y of F.children){const X=Q;if(Q=lengthAdd(Q,Y.length),lengthLessThanEqual(X,W)&&lengthLessThanEqual(O,Q)&&(G=collectBracketPairs(Y,X,Q,O,W,U,K,q),!G))return!1}}return G}class BracketPairsTextModelPart extends Disposable{get canBuildAST(){return this.textModel.getValueLength()<=5e6}constructor(w,D){super(),this.textModel=w,this.languageConfigurationService=D,this.bracketPairsTree=this._register(new MutableDisposable),this.onDidChangeEmitter=new Emitter$1,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1}handleLanguageConfigurationServiceChange(w){(!w.languageId||this.bracketPairsTree.value?.object.didLanguageChange(w.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(w){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(w){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(w){this.bracketPairsTree.value?.object.handleContentChanged(w)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(w){this.bracketPairsTree.value?.object.handleDidChangeTokens(w)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){const w=new DisposableStore;this.bracketPairsTree.value=createDisposableRef(w.add(new BracketPairsTree(this.textModel,D=>this.languageConfigurationService.getLanguageConfiguration(D))),w),w.add(this.bracketPairsTree.value.object.onDidChange(D=>this.onDidChangeEmitter.fire(D))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(w){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(w,!1)||CallbackIterable.empty}getBracketPairsInRangeWithMinIndentation(w){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(w,!0)||CallbackIterable.empty}getBracketsInRange(w,D=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(w,D)||CallbackIterable.empty}findMatchingBracketUp(w,D,O){const W=this.textModel.validatePosition(D),U=this.textModel.getLanguageIdAtPosition(W.lineNumber,W.column);if(this.canBuildAST){const K=this.languageConfigurationService.getLanguageConfiguration(U).bracketsNew.getClosingBracketInfo(w);if(!K)return null;const q=this.getBracketPairsInRange(Range$2.fromPositions(D,D)).findLast(G=>K.closes(G.openingBracketInfo));return q?q.openingBracketRange:null}else{const K=w.toLowerCase(),q=this.languageConfigurationService.getLanguageConfiguration(U).brackets;if(!q)return null;const G=q.textIsBracket[K];return G?stripBracketSearchCanceled(this._findMatchingBracketUp(G,W,createTimeBasedContinueBracketSearchPredicate(O))):null}}matchBracket(w,D){if(this.canBuildAST){const O=this.getBracketPairsInRange(Range$2.fromPositions(w,w)).filter(W=>W.closingBracketRange!==void 0&&(W.openingBracketRange.containsPosition(w)||W.closingBracketRange.containsPosition(w))).findLastMaxBy(compareBy(W=>W.openingBracketRange.containsPosition(w)?W.openingBracketRange:W.closingBracketRange,Range$2.compareRangesUsingStarts));return O?[O.openingBracketRange,O.closingBracketRange]:null}else{const O=createTimeBasedContinueBracketSearchPredicate(D);return this._matchBracket(this.textModel.validatePosition(w),O)}}_establishBracketSearchOffsets(w,D,O,W){const U=D.getCount(),K=D.getLanguageId(W);let q=Math.max(0,w.column-1-O.maxBracketLength);for(let Q=W-1;Q>=0;Q--){const Y=D.getEndOffset(Q);if(Y<=q)break;if(ignoreBracketsInToken(D.getStandardTokenType(Q))||D.getLanguageId(Q)!==K){q=Y;break}}let G=Math.min(D.getLineContent().length,w.column-1+O.maxBracketLength);for(let Q=W+1;Q<U;Q++){const Y=D.getStartOffset(Q);if(Y>=G)break;if(ignoreBracketsInToken(D.getStandardTokenType(Q))||D.getLanguageId(Q)!==K){G=Y;break}}return{searchStartOffset:q,searchEndOffset:G}}_matchBracket(w,D){const O=w.lineNumber,W=this.textModel.tokenization.getLineTokens(O),U=this.textModel.getLineContent(O),K=W.findTokenIndexAtOffset(w.column-1);if(K<0)return null;const q=this.languageConfigurationService.getLanguageConfiguration(W.getLanguageId(K)).brackets;if(q&&!ignoreBracketsInToken(W.getStandardTokenType(K))){let{searchStartOffset:G,searchEndOffset:Q}=this._establishBracketSearchOffsets(w,W,q,K),Y=null;for(;;){const X=BracketsUtils.findNextBracketInRange(q.forwardRegex,O,U,G,Q);if(!X)break;if(X.startColumn<=w.column&&w.column<=X.endColumn){const J=U.substring(X.startColumn-1,X.endColumn-1).toLowerCase(),te=this._matchFoundBracket(X,q.textIsBracket[J],q.textIsOpenBracket[J],D);if(te){if(te instanceof BracketSearchCanceled)return null;Y=te}}G=X.endColumn-1}if(Y)return Y}if(K>0&&W.getStartOffset(K)===w.column-1){const G=K-1,Q=this.languageConfigurationService.getLanguageConfiguration(W.getLanguageId(G)).brackets;if(Q&&!ignoreBracketsInToken(W.getStandardTokenType(G))){const{searchStartOffset:Y,searchEndOffset:X}=this._establishBracketSearchOffsets(w,W,Q,G),J=BracketsUtils.findPrevBracketInRange(Q.reversedRegex,O,U,Y,X);if(J&&J.startColumn<=w.column&&w.column<=J.endColumn){const te=U.substring(J.startColumn-1,J.endColumn-1).toLowerCase(),ie=this._matchFoundBracket(J,Q.textIsBracket[te],Q.textIsOpenBracket[te],D);if(ie)return ie instanceof BracketSearchCanceled?null:ie}}}return null}_matchFoundBracket(w,D,O,W){if(!D)return null;const U=O?this._findMatchingBracketDown(D,w.getEndPosition(),W):this._findMatchingBracketUp(D,w.getStartPosition(),W);return U?U instanceof BracketSearchCanceled?U:[w,U]:null}_findMatchingBracketUp(w,D,O){const W=w.languageId,U=w.reversedRegex;let K=-1,q=0;const G=(Q,Y,X,J)=>{for(;;){if(O&&++q%100===0&&!O())return BracketSearchCanceled.INSTANCE;const te=BracketsUtils.findPrevBracketInRange(U,Q,Y,X,J);if(!te)break;const ie=Y.substring(te.startColumn-1,te.endColumn-1).toLowerCase();if(w.isOpen(ie)?K++:w.isClose(ie)&&K--,K===0)return te;J=te.startColumn-1}return null};for(let Q=D.lineNumber;Q>=1;Q--){const Y=this.textModel.tokenization.getLineTokens(Q),X=Y.getCount(),J=this.textModel.getLineContent(Q);let te=X-1,ie=J.length,se=J.length;Q===D.lineNumber&&(te=Y.findTokenIndexAtOffset(D.column-1),ie=D.column-1,se=D.column-1);let re=!0;for(;te>=0;te--){const ae=Y.getLanguageId(te)===W&&!ignoreBracketsInToken(Y.getStandardTokenType(te));if(ae)re?ie=Y.getStartOffset(te):(ie=Y.getStartOffset(te),se=Y.getEndOffset(te));else if(re&&ie!==se){const le=G(Q,J,ie,se);if(le)return le}re=ae}if(re&&ie!==se){const ae=G(Q,J,ie,se);if(ae)return ae}}return null}_findMatchingBracketDown(w,D,O){const W=w.languageId,U=w.forwardRegex;let K=1,q=0;const G=(Y,X,J,te)=>{for(;;){if(O&&++q%100===0&&!O())return BracketSearchCanceled.INSTANCE;const ie=BracketsUtils.findNextBracketInRange(U,Y,X,J,te);if(!ie)break;const se=X.substring(ie.startColumn-1,ie.endColumn-1).toLowerCase();if(w.isOpen(se)?K++:w.isClose(se)&&K--,K===0)return ie;J=ie.endColumn-1}return null},Q=this.textModel.getLineCount();for(let Y=D.lineNumber;Y<=Q;Y++){const X=this.textModel.tokenization.getLineTokens(Y),J=X.getCount(),te=this.textModel.getLineContent(Y);let ie=0,se=0,re=0;Y===D.lineNumber&&(ie=X.findTokenIndexAtOffset(D.column-1),se=D.column-1,re=D.column-1);let ae=!0;for(;ie<J;ie++){const le=X.getLanguageId(ie)===W&&!ignoreBracketsInToken(X.getStandardTokenType(ie));if(le)ae||(se=X.getStartOffset(ie)),re=X.getEndOffset(ie);else if(ae&&se!==re){const de=G(Y,te,se,re);if(de)return de}ae=le}if(ae&&se!==re){const le=G(Y,te,se,re);if(le)return le}}return null}findPrevBracket(w){const D=this.textModel.validatePosition(w);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(D)||null;let O=null,W=null,U=null;for(let K=D.lineNumber;K>=1;K--){const q=this.textModel.tokenization.getLineTokens(K),G=q.getCount(),Q=this.textModel.getLineContent(K);let Y=G-1,X=Q.length,J=Q.length;if(K===D.lineNumber){Y=q.findTokenIndexAtOffset(D.column-1),X=D.column-1,J=D.column-1;const ie=q.getLanguageId(Y);O!==ie&&(O=ie,W=this.languageConfigurationService.getLanguageConfiguration(O).brackets,U=this.languageConfigurationService.getLanguageConfiguration(O).bracketsNew)}let te=!0;for(;Y>=0;Y--){const ie=q.getLanguageId(Y);if(O!==ie){if(W&&U&&te&&X!==J){const re=BracketsUtils.findPrevBracketInRange(W.reversedRegex,K,Q,X,J);if(re)return this._toFoundBracket(U,re);te=!1}O=ie,W=this.languageConfigurationService.getLanguageConfiguration(O).brackets,U=this.languageConfigurationService.getLanguageConfiguration(O).bracketsNew}const se=!!W&&!ignoreBracketsInToken(q.getStandardTokenType(Y));if(se)te?X=q.getStartOffset(Y):(X=q.getStartOffset(Y),J=q.getEndOffset(Y));else if(U&&W&&te&&X!==J){const re=BracketsUtils.findPrevBracketInRange(W.reversedRegex,K,Q,X,J);if(re)return this._toFoundBracket(U,re)}te=se}if(U&&W&&te&&X!==J){const ie=BracketsUtils.findPrevBracketInRange(W.reversedRegex,K,Q,X,J);if(ie)return this._toFoundBracket(U,ie)}}return null}findNextBracket(w){const D=this.textModel.validatePosition(w);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(D)||null;const O=this.textModel.getLineCount();let W=null,U=null,K=null;for(let q=D.lineNumber;q<=O;q++){const G=this.textModel.tokenization.getLineTokens(q),Q=G.getCount(),Y=this.textModel.getLineContent(q);let X=0,J=0,te=0;if(q===D.lineNumber){X=G.findTokenIndexAtOffset(D.column-1),J=D.column-1,te=D.column-1;const se=G.getLanguageId(X);W!==se&&(W=se,U=this.languageConfigurationService.getLanguageConfiguration(W).brackets,K=this.languageConfigurationService.getLanguageConfiguration(W).bracketsNew)}let ie=!0;for(;X<Q;X++){const se=G.getLanguageId(X);if(W!==se){if(K&&U&&ie&&J!==te){const ae=BracketsUtils.findNextBracketInRange(U.forwardRegex,q,Y,J,te);if(ae)return this._toFoundBracket(K,ae);ie=!1}W=se,U=this.languageConfigurationService.getLanguageConfiguration(W).brackets,K=this.languageConfigurationService.getLanguageConfiguration(W).bracketsNew}const re=!!U&&!ignoreBracketsInToken(G.getStandardTokenType(X));if(re)ie||(J=G.getStartOffset(X)),te=G.getEndOffset(X);else if(K&&U&&ie&&J!==te){const ae=BracketsUtils.findNextBracketInRange(U.forwardRegex,q,Y,J,te);if(ae)return this._toFoundBracket(K,ae)}ie=re}if(K&&U&&ie&&J!==te){const se=BracketsUtils.findNextBracketInRange(U.forwardRegex,q,Y,J,te);if(se)return this._toFoundBracket(K,se)}}return null}findEnclosingBrackets(w,D){const O=this.textModel.validatePosition(w);if(this.canBuildAST){const te=Range$2.fromPositions(O),ie=this.getBracketPairsInRange(Range$2.fromPositions(O,O)).findLast(se=>se.closingBracketRange!==void 0&&se.range.strictContainsRange(te));return ie?[ie.openingBracketRange,ie.closingBracketRange]:null}const W=createTimeBasedContinueBracketSearchPredicate(D),U=this.textModel.getLineCount(),K=new Map;let q=[];const G=(te,ie)=>{if(!K.has(te)){const se=[];for(let re=0,ae=ie?ie.brackets.length:0;re<ae;re++)se[re]=0;K.set(te,se)}q=K.get(te)};let Q=0;const Y=(te,ie,se,re,ae)=>{for(;;){if(W&&++Q%100===0&&!W())return BracketSearchCanceled.INSTANCE;const le=BracketsUtils.findNextBracketInRange(te.forwardRegex,ie,se,re,ae);if(!le)break;const de=se.substring(le.startColumn-1,le.endColumn-1).toLowerCase(),oe=te.textIsBracket[de];if(oe&&(oe.isOpen(de)?q[oe.index]++:oe.isClose(de)&&q[oe.index]--,q[oe.index]===-1))return this._matchFoundBracket(le,oe,!1,W);re=le.endColumn-1}return null};let X=null,J=null;for(let te=O.lineNumber;te<=U;te++){const ie=this.textModel.tokenization.getLineTokens(te),se=ie.getCount(),re=this.textModel.getLineContent(te);let ae=0,le=0,de=0;if(te===O.lineNumber){ae=ie.findTokenIndexAtOffset(O.column-1),le=O.column-1,de=O.column-1;const ue=ie.getLanguageId(ae);X!==ue&&(X=ue,J=this.languageConfigurationService.getLanguageConfiguration(X).brackets,G(X,J))}let oe=!0;for(;ae<se;ae++){const ue=ie.getLanguageId(ae);if(X!==ue){if(J&&oe&&le!==de){const fe=Y(J,te,re,le,de);if(fe)return stripBracketSearchCanceled(fe);oe=!1}X=ue,J=this.languageConfigurationService.getLanguageConfiguration(X).brackets,G(X,J)}const pe=!!J&&!ignoreBracketsInToken(ie.getStandardTokenType(ae));if(pe)oe||(le=ie.getStartOffset(ae)),de=ie.getEndOffset(ae);else if(J&&oe&&le!==de){const fe=Y(J,te,re,le,de);if(fe)return stripBracketSearchCanceled(fe)}oe=pe}if(J&&oe&&le!==de){const ue=Y(J,te,re,le,de);if(ue)return stripBracketSearchCanceled(ue)}}return null}_toFoundBracket(w,D){if(!D)return null;let O=this.textModel.getValueInRange(D);O=O.toLowerCase();const W=w.getBracketInfo(O);return W?{range:D,bracketInfo:W}:null}}function createDisposableRef(F,w){return{object:F,dispose:()=>w?.dispose()}}function createTimeBasedContinueBracketSearchPredicate(F){if(typeof F>"u")return()=>!0;{const w=Date.now();return()=>Date.now()-w<=F}}class BracketSearchCanceled{static{this.INSTANCE=new BracketSearchCanceled}constructor(){this._searchCanceledBrand=void 0}}function stripBracketSearchCanceled(F){return F instanceof BracketSearchCanceled?null:F}function asCssVariableName(F){return`--vscode-${F.replace(/\./g,"-")}`}function asCssVariable(F){return`var(${asCssVariableName(F)})`}function asCssVariableWithDefault(F,w){return`var(${asCssVariableName(F)}, ${w})`}function isColorDefaults(F){return F!==null&&typeof F=="object"&&"light"in F&&"dark"in F}const Extensions$3={ColorContribution:"base.contributions.colors"},DEFAULT_COLOR_CONFIG_VALUE="default";class ColorRegistry{constructor(){this._onDidChangeSchema=new Emitter$1,this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(w,D,O,W=!1,U){const K={id:w,description:O,defaults:D,needsTransparency:W,deprecationMessage:U};this.colorsById[w]=K;const q={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return U&&(q.deprecationMessage=U),W&&(q.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",q.patternErrorMessage=localize("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[w]={description:O,oneOf:[q,{type:"string",const:DEFAULT_COLOR_CONFIG_VALUE,description:localize("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(w),this.colorReferenceSchema.enumDescriptions.push(O),this._onDidChangeSchema.fire(),w}getColors(){return Object.keys(this.colorsById).map(w=>this.colorsById[w])}resolveDefaultColor(w,D){const O=this.colorsById[w];if(O?.defaults){const W=isColorDefaults(O.defaults)?O.defaults[D.type]:O.defaults;return resolveColorValue(W,D)}}getColorSchema(){return this.colorSchema}toString(){const w=(D,O)=>{const W=D.indexOf(".")===-1?0:1,U=O.indexOf(".")===-1?0:1;return W!==U?W-U:D.localeCompare(O)};return Object.keys(this.colorsById).sort(w).map(D=>`- \`${D}\`: ${this.colorsById[D].description}`).join(`
`)}}const colorRegistry$1=new ColorRegistry;Registry.add(Extensions$3.ColorContribution,colorRegistry$1);function registerColor(F,w,D,O,W){return colorRegistry$1.registerColor(F,w,D,O,W)}function executeTransform(F,w){switch(F.op){case 0:return resolveColorValue(F.value,w)?.darken(F.factor);case 1:return resolveColorValue(F.value,w)?.lighten(F.factor);case 2:return resolveColorValue(F.value,w)?.transparent(F.factor);case 3:{const D=resolveColorValue(F.background,w);return D?resolveColorValue(F.value,w)?.makeOpaque(D):resolveColorValue(F.value,w)}case 4:for(const D of F.values){const O=resolveColorValue(D,w);if(O)return O}return;case 6:return resolveColorValue(w.defines(F.if)?F.then:F.else,w);case 5:{const D=resolveColorValue(F.value,w);if(!D)return;const O=resolveColorValue(F.background,w);return O?D.isDarkerThan(O)?Color.getLighterColor(D,O,F.factor).transparent(F.transparency):Color.getDarkerColor(D,O,F.factor).transparent(F.transparency):D.transparent(F.factor*F.transparency)}default:throw assertNever()}}function darken(F,w){return{op:0,value:F,factor:w}}function lighten(F,w){return{op:1,value:F,factor:w}}function transparent(F,w){return{op:2,value:F,factor:w}}function oneOf(...F){return{op:4,values:F}}function ifDefinedThenElse(F,w,D){return{op:6,if:F,then:w,else:D}}function lessProminent(F,w,D,O){return{op:5,value:F,background:w,factor:D,transparency:O}}function resolveColorValue(F,w){if(F!==null){if(typeof F=="string")return F[0]==="#"?Color.fromHex(F):w.getColor(F);if(F instanceof Color)return F;if(typeof F=="object")return executeTransform(F,w)}}const workbenchColorsSchemaId="vscode://schemas/workbench-colors",schemaRegistry$1=Registry.as(Extensions$6.JSONContribution);schemaRegistry$1.registerSchema(workbenchColorsSchemaId,colorRegistry$1.getColorSchema());const delayer$1=new RunOnceScheduler(()=>schemaRegistry$1.notifySchemaChanged(workbenchColorsSchemaId),200);colorRegistry$1.onDidChangeSchema(()=>{delayer$1.isScheduled()||delayer$1.schedule()});const foreground=registerColor("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},localize("foreground","Overall foreground color. This color is only used if not overridden by a component."));registerColor("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},localize("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component."));registerColor("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},localize("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component."));registerColor("descriptionForeground",{light:"#717171",dark:transparent(foreground,.7),hcDark:transparent(foreground,.7),hcLight:transparent(foreground,.7)},localize("descriptionForeground","Foreground color for description text providing additional information, for example for a label."));const iconForeground=registerColor("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},localize("iconForeground","The default color for icons in the workbench.")),focusBorder=registerColor("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},localize("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),contrastBorder=registerColor("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},localize("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),activeContrastBorder=registerColor("contrastActiveBorder",{light:null,dark:null,hcDark:focusBorder,hcLight:focusBorder},localize("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast."));registerColor("selection.background",null,localize("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor."));const textLinkForeground=registerColor("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},localize("textLinkForeground","Foreground color for links in text."));registerColor("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},localize("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover."));registerColor("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:Color.black,hcLight:"#292929"},localize("textSeparatorForeground","Color for text separators."));registerColor("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},localize("textPreformatForeground","Foreground color for preformatted text segments."));registerColor("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},localize("textPreformatBackground","Background color for preformatted text segments."));registerColor("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},localize("textBlockQuoteBackground","Background color for block quotes in text."));registerColor("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:Color.white,hcLight:"#292929"},localize("textBlockQuoteBorder","Border color for block quotes in text."));registerColor("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:Color.black,hcLight:"#F2F2F2"},localize("textCodeBlockBackground","Background color for code blocks in text."));registerColor("sash.hoverBorder",focusBorder,localize("sashActiveBorder","Border color of active sashes."));const badgeBackground=registerColor("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:Color.black,hcLight:"#0F4A85"},localize("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),badgeForeground=registerColor("badge.foreground",{dark:Color.white,light:"#333",hcDark:Color.white,hcLight:Color.white},localize("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),scrollbarShadow=registerColor("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},localize("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),scrollbarSliderBackground=registerColor("scrollbarSlider.background",{dark:Color.fromHex("#797979").transparent(.4),light:Color.fromHex("#646464").transparent(.4),hcDark:transparent(contrastBorder,.6),hcLight:transparent(contrastBorder,.4)},localize("scrollbarSliderBackground","Scrollbar slider background color.")),scrollbarSliderHoverBackground=registerColor("scrollbarSlider.hoverBackground",{dark:Color.fromHex("#646464").transparent(.7),light:Color.fromHex("#646464").transparent(.7),hcDark:transparent(contrastBorder,.8),hcLight:transparent(contrastBorder,.8)},localize("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),scrollbarSliderActiveBackground=registerColor("scrollbarSlider.activeBackground",{dark:Color.fromHex("#BFBFBF").transparent(.4),light:Color.fromHex("#000000").transparent(.6),hcDark:contrastBorder,hcLight:contrastBorder},localize("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),progressBarBackground=registerColor("progressBar.background",{dark:Color.fromHex("#0E70C0"),light:Color.fromHex("#0E70C0"),hcDark:contrastBorder,hcLight:contrastBorder},localize("progressBarBackground","Background color of the progress bar that can show for long running operations.")),editorBackground=registerColor("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:Color.black,hcLight:Color.white},localize("editorBackground","Editor background color.")),editorForeground=registerColor("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:Color.white,hcLight:foreground},localize("editorForeground","Editor default foreground color."));registerColor("editorStickyScroll.background",editorBackground,localize("editorStickyScrollBackground","Background color of sticky scroll in the editor"));registerColor("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:Color.fromHex("#0F4A85").transparent(.1)},localize("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor"));registerColor("editorStickyScroll.border",{dark:null,light:null,hcDark:contrastBorder,hcLight:contrastBorder},localize("editorStickyScrollBorder","Border color of sticky scroll in the editor"));registerColor("editorStickyScroll.shadow",scrollbarShadow,localize("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor"));const editorWidgetBackground=registerColor("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:Color.white},localize("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),editorWidgetForeground=registerColor("editorWidget.foreground",foreground,localize("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),editorWidgetBorder=registerColor("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:contrastBorder,hcLight:contrastBorder},localize("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget."));registerColor("editorWidget.resizeBorder",null,localize("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget."));registerColor("editorError.background",null,localize("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const editorErrorForeground=registerColor("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},localize("editorError.foreground","Foreground color of error squigglies in the editor."));registerColor("editorError.border",{dark:null,light:null,hcDark:Color.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},localize("errorBorder","If set, color of double underlines for errors in the editor."));const editorWarningBackground=registerColor("editorWarning.background",null,localize("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),editorWarningForeground=registerColor("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},localize("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),editorWarningBorder=registerColor("editorWarning.border",{dark:null,light:null,hcDark:Color.fromHex("#FFCC00").transparent(.8),hcLight:Color.fromHex("#FFCC00").transparent(.8)},localize("warningBorder","If set, color of double underlines for warnings in the editor."));registerColor("editorInfo.background",null,localize("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const editorInfoForeground=registerColor("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},localize("editorInfo.foreground","Foreground color of info squigglies in the editor.")),editorInfoBorder=registerColor("editorInfo.border",{dark:null,light:null,hcDark:Color.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},localize("infoBorder","If set, color of double underlines for infos in the editor.")),editorHintForeground=registerColor("editorHint.foreground",{dark:Color.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},localize("editorHint.foreground","Foreground color of hint squigglies in the editor."));registerColor("editorHint.border",{dark:null,light:null,hcDark:Color.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},localize("hintBorder","If set, color of double underlines for hints in the editor."));registerColor("editorLink.activeForeground",{dark:"#4E94CE",light:Color.blue,hcDark:Color.cyan,hcLight:"#292929"},localize("activeLinkForeground","Color of active links."));const editorSelectionBackground=registerColor("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},localize("editorSelectionBackground","Color of the editor selection.")),editorSelectionForeground=registerColor("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:Color.white},localize("editorSelectionForeground","Color of the selected text for high contrast.")),editorInactiveSelection=registerColor("editor.inactiveSelectionBackground",{light:transparent(editorSelectionBackground,.5),dark:transparent(editorSelectionBackground,.5),hcDark:transparent(editorSelectionBackground,.7),hcLight:transparent(editorSelectionBackground,.5)},localize("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),editorSelectionHighlight=registerColor("editor.selectionHighlightBackground",{light:lessProminent(editorSelectionBackground,editorBackground,.3,.6),dark:lessProminent(editorSelectionBackground,editorBackground,.3,.6),hcDark:null,hcLight:null},localize("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("editorSelectionHighlightBorder","Border color for regions with the same content as the selection."));registerColor("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},localize("editorFindMatch","Color of the current search match."));registerColor("editor.findMatchForeground",null,localize("editorFindMatchForeground","Text color of the current search match."));const editorFindMatchHighlight=registerColor("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},localize("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editor.findMatchHighlightForeground",null,localize("findMatchHighlightForeground","Foreground color of the other search matches."),!0);registerColor("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},localize("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editor.findMatchBorder",{light:null,dark:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("editorFindMatchBorder","Border color of the current search match."));const editorFindMatchHighlightBorder=registerColor("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("findMatchHighlightBorder","Border color of the other search matches."));registerColor("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:transparent(activeContrastBorder,.4),hcLight:transparent(activeContrastBorder,.4)},localize("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},localize("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0);const editorHoverBackground=registerColor("editorHoverWidget.background",editorWidgetBackground,localize("hoverBackground","Background color of the editor hover."));registerColor("editorHoverWidget.foreground",editorWidgetForeground,localize("hoverForeground","Foreground color of the editor hover."));const editorHoverBorder=registerColor("editorHoverWidget.border",editorWidgetBorder,localize("hoverBorder","Border color of the editor hover."));registerColor("editorHoverWidget.statusBarBackground",{dark:lighten(editorHoverBackground,.2),light:darken(editorHoverBackground,.05),hcDark:editorWidgetBackground,hcLight:editorWidgetBackground},localize("statusBarBackground","Background color of the editor hover status bar."));const editorInlayHintForeground=registerColor("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:Color.white,hcLight:Color.black},localize("editorInlayHintForeground","Foreground color of inline hints")),editorInlayHintBackground=registerColor("editorInlayHint.background",{dark:transparent(badgeBackground,.1),light:transparent(badgeBackground,.1),hcDark:transparent(Color.white,.1),hcLight:transparent(badgeBackground,.1)},localize("editorInlayHintBackground","Background color of inline hints"));registerColor("editorInlayHint.typeForeground",editorInlayHintForeground,localize("editorInlayHintForegroundTypes","Foreground color of inline hints for types"));registerColor("editorInlayHint.typeBackground",editorInlayHintBackground,localize("editorInlayHintBackgroundTypes","Background color of inline hints for types"));registerColor("editorInlayHint.parameterForeground",editorInlayHintForeground,localize("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters"));registerColor("editorInlayHint.parameterBackground",editorInlayHintBackground,localize("editorInlayHintBackgroundParameter","Background color of inline hints for parameters"));const editorLightBulbForeground=registerColor("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},localize("editorLightBulbForeground","The color used for the lightbulb actions icon."));registerColor("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},localize("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon."));registerColor("editorLightBulbAi.foreground",editorLightBulbForeground,localize("editorLightBulbAiForeground","The color used for the lightbulb AI icon."));registerColor("editor.snippetTabstopHighlightBackground",{dark:new Color(new RGBA(124,124,124,.3)),light:new Color(new RGBA(10,50,100,.2)),hcDark:new Color(new RGBA(124,124,124,.3)),hcLight:new Color(new RGBA(10,50,100,.2))},localize("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop."));registerColor("editor.snippetTabstopHighlightBorder",null,localize("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop."));registerColor("editor.snippetFinalTabstopHighlightBackground",null,localize("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet."));registerColor("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new Color(new RGBA(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},localize("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet."));const defaultInsertColor=new Color(new RGBA(155,185,85,.2)),defaultRemoveColor=new Color(new RGBA(255,0,0,.2)),diffInserted=registerColor("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},localize("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),diffRemoved=registerColor("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},localize("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("diffEditor.insertedLineBackground",{dark:defaultInsertColor,light:defaultInsertColor,hcDark:null,hcLight:null},localize("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("diffEditor.removedLineBackground",{dark:defaultRemoveColor,light:defaultRemoveColor,hcDark:null,hcLight:null},localize("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("diffEditorGutter.insertedLineBackground",null,localize("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted."));registerColor("diffEditorGutter.removedLineBackground",null,localize("diffEditorRemovedLineGutter","Background color for the margin where lines got removed."));const diffOverviewRulerInserted=registerColor("diffEditorOverview.insertedForeground",null,localize("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),diffOverviewRulerRemoved=registerColor("diffEditorOverview.removedForeground",null,localize("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content."));registerColor("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},localize("diffEditorInsertedOutline","Outline color for the text that got inserted."));registerColor("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},localize("diffEditorRemovedOutline","Outline color for text that got removed."));registerColor("diffEditor.border",{dark:null,light:null,hcDark:contrastBorder,hcLight:contrastBorder},localize("diffEditorBorder","Border color between the two text editors."));registerColor("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},localize("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views."));registerColor("diffEditor.unchangedRegionBackground","sideBar.background",localize("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor."));registerColor("diffEditor.unchangedRegionForeground","foreground",localize("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor."));registerColor("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},localize("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor."));const widgetShadow=registerColor("widget.shadow",{dark:transparent(Color.black,.36),light:transparent(Color.black,.16),hcDark:null,hcLight:null},localize("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),widgetBorder=registerColor("widget.border",{dark:null,light:null,hcDark:contrastBorder,hcLight:contrastBorder},localize("widgetBorder","Border color of widgets such as find/replace inside the editor.")),toolbarHoverBackground=registerColor("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},localize("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse"));registerColor("toolbar.hoverOutline",{dark:null,light:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse"));registerColor("toolbar.activeBackground",{dark:lighten(toolbarHoverBackground,.1),light:darken(toolbarHoverBackground,.1),hcDark:null,hcLight:null},localize("toolbarActiveBackground","Toolbar background when holding the mouse over actions"));const breadcrumbsForeground=registerColor("breadcrumb.foreground",transparent(foreground,.8),localize("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),breadcrumbsBackground=registerColor("breadcrumb.background",editorBackground,localize("breadcrumbsBackground","Background color of breadcrumb items.")),breadcrumbsFocusForeground=registerColor("breadcrumb.focusForeground",{light:darken(foreground,.2),dark:lighten(foreground,.1),hcDark:lighten(foreground,.1),hcLight:lighten(foreground,.1)},localize("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),breadcrumbsActiveSelectionForeground=registerColor("breadcrumb.activeSelectionForeground",{light:darken(foreground,.2),dark:lighten(foreground,.1),hcDark:lighten(foreground,.1),hcLight:lighten(foreground,.1)},localize("breadcrumbsSelectedForeground","Color of selected breadcrumb items."));registerColor("breadcrumbPicker.background",editorWidgetBackground,localize("breadcrumbsSelectedBackground","Background color of breadcrumb item picker."));const headerTransparency=.5,currentBaseColor=Color.fromHex("#40C8AE").transparent(headerTransparency),incomingBaseColor=Color.fromHex("#40A6FF").transparent(headerTransparency),commonBaseColor=Color.fromHex("#606060").transparent(.4),contentTransparency=.4,rulerTransparency=1,mergeCurrentHeaderBackground=registerColor("merge.currentHeaderBackground",{dark:currentBaseColor,light:currentBaseColor,hcDark:null,hcLight:null},localize("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("merge.currentContentBackground",transparent(mergeCurrentHeaderBackground,contentTransparency),localize("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const mergeIncomingHeaderBackground=registerColor("merge.incomingHeaderBackground",{dark:incomingBaseColor,light:incomingBaseColor,hcDark:null,hcLight:null},localize("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("merge.incomingContentBackground",transparent(mergeIncomingHeaderBackground,contentTransparency),localize("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const mergeCommonHeaderBackground=registerColor("merge.commonHeaderBackground",{dark:commonBaseColor,light:commonBaseColor,hcDark:null,hcLight:null},localize("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("merge.commonContentBackground",transparent(mergeCommonHeaderBackground,contentTransparency),localize("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const mergeBorder=registerColor("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},localize("mergeBorder","Border color on headers and the splitter in inline merge-conflicts."));registerColor("editorOverviewRuler.currentContentForeground",{dark:transparent(mergeCurrentHeaderBackground,rulerTransparency),light:transparent(mergeCurrentHeaderBackground,rulerTransparency),hcDark:mergeBorder,hcLight:mergeBorder},localize("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts."));registerColor("editorOverviewRuler.incomingContentForeground",{dark:transparent(mergeIncomingHeaderBackground,rulerTransparency),light:transparent(mergeIncomingHeaderBackground,rulerTransparency),hcDark:mergeBorder,hcLight:mergeBorder},localize("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts."));registerColor("editorOverviewRuler.commonContentForeground",{dark:transparent(mergeCommonHeaderBackground,rulerTransparency),light:transparent(mergeCommonHeaderBackground,rulerTransparency),hcDark:mergeBorder,hcLight:mergeBorder},localize("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts."));registerColor("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},localize("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",localize("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0);const problemsErrorIconForeground=registerColor("problemsErrorIcon.foreground",editorErrorForeground,localize("problemsErrorIconForeground","The color used for the problems error icon.")),problemsWarningIconForeground=registerColor("problemsWarningIcon.foreground",editorWarningForeground,localize("problemsWarningIconForeground","The color used for the problems warning icon.")),problemsInfoIconForeground=registerColor("problemsInfoIcon.foreground",editorInfoForeground,localize("problemsInfoIconForeground","The color used for the problems info icon.")),minimapFindMatch=registerColor("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},localize("minimapFindMatchHighlight","Minimap marker color for find matches."),!0);registerColor("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},localize("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0);const minimapSelection=registerColor("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},localize("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),minimapInfo=registerColor("minimap.infoHighlight",{dark:editorInfoForeground,light:editorInfoForeground,hcDark:editorInfoBorder,hcLight:editorInfoBorder},localize("minimapInfo","Minimap marker color for infos.")),minimapWarning=registerColor("minimap.warningHighlight",{dark:editorWarningForeground,light:editorWarningForeground,hcDark:editorWarningBorder,hcLight:editorWarningBorder},localize("overviewRuleWarning","Minimap marker color for warnings.")),minimapError=registerColor("minimap.errorHighlight",{dark:new Color(new RGBA(255,18,18,.7)),light:new Color(new RGBA(255,18,18,.7)),hcDark:new Color(new RGBA(255,50,50,1)),hcLight:"#B5200D"},localize("minimapError","Minimap marker color for errors.")),minimapBackground=registerColor("minimap.background",null,localize("minimapBackground","Minimap background color.")),minimapForegroundOpacity=registerColor("minimap.foregroundOpacity",Color.fromHex("#000f"),localize("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.'));registerColor("minimapSlider.background",transparent(scrollbarSliderBackground,.5),localize("minimapSliderBackground","Minimap slider background color."));registerColor("minimapSlider.hoverBackground",transparent(scrollbarSliderHoverBackground,.5),localize("minimapSliderHoverBackground","Minimap slider background color when hovering."));registerColor("minimapSlider.activeBackground",transparent(scrollbarSliderActiveBackground,.5),localize("minimapSliderActiveBackground","Minimap slider background color when clicked on."));registerColor("charts.foreground",foreground,localize("chartsForeground","The foreground color used in charts."));registerColor("charts.lines",transparent(foreground,.5),localize("chartsLines","The color used for horizontal lines in charts."));registerColor("charts.red",editorErrorForeground,localize("chartsRed","The red color used in chart visualizations."));registerColor("charts.blue",editorInfoForeground,localize("chartsBlue","The blue color used in chart visualizations."));registerColor("charts.yellow",editorWarningForeground,localize("chartsYellow","The yellow color used in chart visualizations."));registerColor("charts.orange",minimapFindMatch,localize("chartsOrange","The orange color used in chart visualizations."));registerColor("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},localize("chartsGreen","The green color used in chart visualizations."));registerColor("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},localize("chartsPurple","The purple color used in chart visualizations."));const inputBackground=registerColor("input.background",{dark:"#3C3C3C",light:Color.white,hcDark:Color.black,hcLight:Color.white},localize("inputBoxBackground","Input box background.")),inputForeground=registerColor("input.foreground",foreground,localize("inputBoxForeground","Input box foreground.")),inputBorder=registerColor("input.border",{dark:null,light:null,hcDark:contrastBorder,hcLight:contrastBorder},localize("inputBoxBorder","Input box border.")),inputActiveOptionBorder=registerColor("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:contrastBorder,hcLight:contrastBorder},localize("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),inputActiveOptionHoverBackground=registerColor("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},localize("inputOption.hoverBackground","Background color of activated options in input fields.")),inputActiveOptionBackground=registerColor("inputOption.activeBackground",{dark:transparent(focusBorder,.4),light:transparent(focusBorder,.2),hcDark:Color.transparent,hcLight:Color.transparent},localize("inputOption.activeBackground","Background hover color of options in input fields.")),inputActiveOptionForeground=registerColor("inputOption.activeForeground",{dark:Color.white,light:Color.black,hcDark:foreground,hcLight:foreground},localize("inputOption.activeForeground","Foreground color of activated options in input fields."));registerColor("input.placeholderForeground",{light:transparent(foreground,.5),dark:transparent(foreground,.5),hcDark:transparent(foreground,.7),hcLight:transparent(foreground,.7)},localize("inputPlaceholderForeground","Input box foreground color for placeholder text."));const inputValidationInfoBackground=registerColor("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:Color.black,hcLight:Color.white},localize("inputValidationInfoBackground","Input validation background color for information severity.")),inputValidationInfoForeground=registerColor("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:foreground},localize("inputValidationInfoForeground","Input validation foreground color for information severity.")),inputValidationInfoBorder=registerColor("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:contrastBorder,hcLight:contrastBorder},localize("inputValidationInfoBorder","Input validation border color for information severity.")),inputValidationWarningBackground=registerColor("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:Color.black,hcLight:Color.white},localize("inputValidationWarningBackground","Input validation background color for warning severity.")),inputValidationWarningForeground=registerColor("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:foreground},localize("inputValidationWarningForeground","Input validation foreground color for warning severity.")),inputValidationWarningBorder=registerColor("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:contrastBorder,hcLight:contrastBorder},localize("inputValidationWarningBorder","Input validation border color for warning severity.")),inputValidationErrorBackground=registerColor("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:Color.black,hcLight:Color.white},localize("inputValidationErrorBackground","Input validation background color for error severity.")),inputValidationErrorForeground=registerColor("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:foreground},localize("inputValidationErrorForeground","Input validation foreground color for error severity.")),inputValidationErrorBorder=registerColor("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:contrastBorder,hcLight:contrastBorder},localize("inputValidationErrorBorder","Input validation border color for error severity.")),selectBackground=registerColor("dropdown.background",{dark:"#3C3C3C",light:Color.white,hcDark:Color.black,hcLight:Color.white},localize("dropdownBackground","Dropdown background.")),selectListBackground=registerColor("dropdown.listBackground",{dark:null,light:null,hcDark:Color.black,hcLight:Color.white},localize("dropdownListBackground","Dropdown list background.")),selectForeground=registerColor("dropdown.foreground",{dark:"#F0F0F0",light:foreground,hcDark:Color.white,hcLight:foreground},localize("dropdownForeground","Dropdown foreground.")),selectBorder=registerColor("dropdown.border",{dark:selectBackground,light:"#CECECE",hcDark:contrastBorder,hcLight:contrastBorder},localize("dropdownBorder","Dropdown border.")),buttonForeground=registerColor("button.foreground",Color.white,localize("buttonForeground","Button foreground color.")),buttonSeparator=registerColor("button.separator",transparent(buttonForeground,.4),localize("buttonSeparator","Button separator color.")),buttonBackground=registerColor("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},localize("buttonBackground","Button background color.")),buttonHoverBackground=registerColor("button.hoverBackground",{dark:lighten(buttonBackground,.2),light:darken(buttonBackground,.2),hcDark:buttonBackground,hcLight:buttonBackground},localize("buttonHoverBackground","Button background color when hovering.")),buttonBorder=registerColor("button.border",contrastBorder,localize("buttonBorder","Button border color.")),buttonSecondaryForeground=registerColor("button.secondaryForeground",{dark:Color.white,light:Color.white,hcDark:Color.white,hcLight:foreground},localize("buttonSecondaryForeground","Secondary button foreground color.")),buttonSecondaryBackground=registerColor("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:Color.white},localize("buttonSecondaryBackground","Secondary button background color.")),buttonSecondaryHoverBackground=registerColor("button.secondaryHoverBackground",{dark:lighten(buttonSecondaryBackground,.2),light:darken(buttonSecondaryBackground,.2),hcDark:null,hcLight:null},localize("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),radioActiveForeground=registerColor("radio.activeForeground",inputActiveOptionForeground,localize("radioActiveForeground","Foreground color of active radio option.")),radioActiveBackground=registerColor("radio.activeBackground",inputActiveOptionBackground,localize("radioBackground","Background color of active radio option.")),radioActiveBorder=registerColor("radio.activeBorder",inputActiveOptionBorder,localize("radioActiveBorder","Border color of the active radio option.")),radioInactiveForeground=registerColor("radio.inactiveForeground",null,localize("radioInactiveForeground","Foreground color of inactive radio option.")),radioInactiveBackground=registerColor("radio.inactiveBackground",null,localize("radioInactiveBackground","Background color of inactive radio option.")),radioInactiveBorder=registerColor("radio.inactiveBorder",{light:transparent(radioActiveForeground,.2),dark:transparent(radioActiveForeground,.2),hcDark:transparent(radioActiveForeground,.4),hcLight:transparent(radioActiveForeground,.2)},localize("radioInactiveBorder","Border color of the inactive radio option.")),radioInactiveHoverBackground=registerColor("radio.inactiveHoverBackground",inputActiveOptionHoverBackground,localize("radioHoverBackground","Background color of inactive active radio option when hovering.")),checkboxBackground=registerColor("checkbox.background",selectBackground,localize("checkbox.background","Background color of checkbox widget."));registerColor("checkbox.selectBackground",editorWidgetBackground,localize("checkbox.select.background","Background color of checkbox widget when the element it's in is selected."));const checkboxForeground=registerColor("checkbox.foreground",selectForeground,localize("checkbox.foreground","Foreground color of checkbox widget.")),checkboxBorder=registerColor("checkbox.border",selectBorder,localize("checkbox.border","Border color of checkbox widget."));registerColor("checkbox.selectBorder",iconForeground,localize("checkbox.select.border","Border color of checkbox widget when the element it's in is selected."));const keybindingLabelBackground=registerColor("keybindingLabel.background",{dark:new Color(new RGBA(128,128,128,.17)),light:new Color(new RGBA(221,221,221,.4)),hcDark:Color.transparent,hcLight:Color.transparent},localize("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),keybindingLabelForeground=registerColor("keybindingLabel.foreground",{dark:Color.fromHex("#CCCCCC"),light:Color.fromHex("#555555"),hcDark:Color.white,hcLight:foreground},localize("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),keybindingLabelBorder=registerColor("keybindingLabel.border",{dark:new Color(new RGBA(51,51,51,.6)),light:new Color(new RGBA(204,204,204,.4)),hcDark:new Color(new RGBA(111,195,223)),hcLight:contrastBorder},localize("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),keybindingLabelBottomBorder=registerColor("keybindingLabel.bottomBorder",{dark:new Color(new RGBA(68,68,68,.6)),light:new Color(new RGBA(187,187,187,.4)),hcDark:new Color(new RGBA(111,195,223)),hcLight:foreground},localize("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),listFocusBackground=registerColor("list.focusBackground",null,localize("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listFocusForeground=registerColor("list.focusForeground",null,localize("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listFocusOutline=registerColor("list.focusOutline",{dark:focusBorder,light:focusBorder,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listFocusAndSelectionOutline=registerColor("list.focusAndSelectionOutline",null,localize("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),listActiveSelectionBackground=registerColor("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:Color.fromHex("#0F4A85").transparent(.1)},localize("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listActiveSelectionForeground=registerColor("list.activeSelectionForeground",{dark:Color.white,light:Color.white,hcDark:null,hcLight:null},localize("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listActiveSelectionIconForeground=registerColor("list.activeSelectionIconForeground",null,localize("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listInactiveSelectionBackground=registerColor("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:Color.fromHex("#0F4A85").transparent(.1)},localize("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listInactiveSelectionForeground=registerColor("list.inactiveSelectionForeground",null,localize("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listInactiveSelectionIconForeground=registerColor("list.inactiveSelectionIconForeground",null,localize("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listInactiveFocusBackground=registerColor("list.inactiveFocusBackground",null,localize("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listInactiveFocusOutline=registerColor("list.inactiveFocusOutline",null,localize("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listHoverBackground=registerColor("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:Color.white.transparent(.1),hcLight:Color.fromHex("#0F4A85").transparent(.1)},localize("listHoverBackground","List/Tree background when hovering over items using the mouse.")),listHoverForeground=registerColor("list.hoverForeground",null,localize("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),listDropOverBackground=registerColor("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},localize("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),listDropBetweenBackground=registerColor("list.dropBetweenBackground",{dark:iconForeground,light:iconForeground,hcDark:null,hcLight:null},localize("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),listHighlightForeground=registerColor("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:focusBorder,hcLight:focusBorder},localize("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),listFocusHighlightForeground=registerColor("list.focusHighlightForeground",{dark:listHighlightForeground,light:ifDefinedThenElse(listActiveSelectionBackground,listHighlightForeground,"#BBE7FF"),hcDark:listHighlightForeground,hcLight:listHighlightForeground},localize("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree."));registerColor("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},localize("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer."));registerColor("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},localize("listErrorForeground","Foreground color of list items containing errors."));registerColor("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},localize("listWarningForeground","Foreground color of list items containing warnings."));const listFilterWidgetBackground=registerColor("listFilterWidget.background",{light:darken(editorWidgetBackground,0),dark:lighten(editorWidgetBackground,0),hcDark:editorWidgetBackground,hcLight:editorWidgetBackground},localize("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),listFilterWidgetOutline=registerColor("listFilterWidget.outline",{dark:Color.transparent,light:Color.transparent,hcDark:"#f38518",hcLight:"#007ACC"},localize("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),listFilterWidgetNoMatchesOutline=registerColor("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:contrastBorder,hcLight:contrastBorder},localize("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),listFilterWidgetShadow=registerColor("listFilterWidget.shadow",widgetShadow,localize("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees."));registerColor("list.filterMatchBackground",{dark:editorFindMatchHighlight,light:editorFindMatchHighlight,hcDark:null,hcLight:null},localize("listFilterMatchHighlight","Background color of the filtered match."));registerColor("list.filterMatchBorder",{dark:editorFindMatchHighlightBorder,light:editorFindMatchHighlightBorder,hcDark:contrastBorder,hcLight:activeContrastBorder},localize("listFilterMatchHighlightBorder","Border color of the filtered match."));registerColor("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},localize("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized."));const treeIndentGuidesStroke=registerColor("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},localize("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),treeInactiveIndentGuidesStroke=registerColor("tree.inactiveIndentGuidesStroke",transparent(treeIndentGuidesStroke,.4),localize("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),tableColumnsBorder=registerColor("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},localize("tableColumnsBorder","Table border color between columns.")),tableOddRowsBackgroundColor=registerColor("tree.tableOddRowsBackground",{dark:transparent(foreground,.04),light:transparent(foreground,.04),hcDark:null,hcLight:null},localize("tableOddRowsBackgroundColor","Background color for odd table rows."));registerColor("editorActionList.background",editorWidgetBackground,localize("editorActionListBackground","Action List background color."));registerColor("editorActionList.foreground",editorWidgetForeground,localize("editorActionListForeground","Action List foreground color."));registerColor("editorActionList.focusForeground",listActiveSelectionForeground,localize("editorActionListFocusForeground","Action List foreground color for the focused item."));registerColor("editorActionList.focusBackground",listActiveSelectionBackground,localize("editorActionListFocusBackground","Action List background color for the focused item."));const menuBorder=registerColor("menu.border",{dark:null,light:null,hcDark:contrastBorder,hcLight:contrastBorder},localize("menuBorder","Border color of menus.")),menuForeground=registerColor("menu.foreground",selectForeground,localize("menuForeground","Foreground color of menu items.")),menuBackground=registerColor("menu.background",selectBackground,localize("menuBackground","Background color of menu items.")),menuSelectionForeground=registerColor("menu.selectionForeground",listActiveSelectionForeground,localize("menuSelectionForeground","Foreground color of the selected menu item in menus.")),menuSelectionBackground=registerColor("menu.selectionBackground",listActiveSelectionBackground,localize("menuSelectionBackground","Background color of the selected menu item in menus.")),menuSelectionBorder=registerColor("menu.selectionBorder",{dark:null,light:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("menuSelectionBorder","Border color of the selected menu item in menus.")),menuSeparatorBackground=registerColor("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:contrastBorder,hcLight:contrastBorder},localize("menuSeparatorBackground","Color of a separator menu item in menus.")),quickInputBackground=registerColor("quickInput.background",editorWidgetBackground,localize("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),quickInputForeground=registerColor("quickInput.foreground",editorWidgetForeground,localize("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),quickInputTitleBackground=registerColor("quickInputTitle.background",{dark:new Color(new RGBA(255,255,255,.105)),light:new Color(new RGBA(0,0,0,.06)),hcDark:"#000000",hcLight:Color.white},localize("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),pickerGroupForeground=registerColor("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:Color.white,hcLight:"#0F4A85"},localize("pickerGroupForeground","Quick picker color for grouping labels.")),pickerGroupBorder=registerColor("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:Color.white,hcLight:"#0F4A85"},localize("pickerGroupBorder","Quick picker color for grouping borders.")),_deprecatedQuickInputListFocusBackground=registerColor("quickInput.list.focusBackground",null,"",void 0,localize("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),quickInputListFocusForeground=registerColor("quickInputList.focusForeground",listActiveSelectionForeground,localize("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),quickInputListFocusIconForeground=registerColor("quickInputList.focusIconForeground",listActiveSelectionIconForeground,localize("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),quickInputListFocusBackground=registerColor("quickInputList.focusBackground",{dark:oneOf(_deprecatedQuickInputListFocusBackground,listActiveSelectionBackground),light:oneOf(_deprecatedQuickInputListFocusBackground,listActiveSelectionBackground),hcDark:null,hcLight:null},localize("quickInput.listFocusBackground","Quick picker background color for the focused item."));registerColor("search.resultsInfoForeground",{light:foreground,dark:transparent(foreground,.65),hcDark:foreground,hcLight:foreground},localize("search.resultsInfoForeground","Color of the text in the search viewlet's completion message."));registerColor("searchEditor.findMatchBackground",{light:transparent(editorFindMatchHighlight,.66),dark:transparent(editorFindMatchHighlight,.66),hcDark:editorFindMatchHighlight,hcLight:editorFindMatchHighlight},localize("searchEditor.queryMatch","Color of the Search Editor query matches."));registerColor("searchEditor.findMatchBorder",{light:transparent(editorFindMatchHighlightBorder,.66),dark:transparent(editorFindMatchHighlightBorder,.66),hcDark:editorFindMatchHighlightBorder,hcLight:editorFindMatchHighlightBorder},localize("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var ColorScheme;(function(F){F.DARK="dark",F.LIGHT="light",F.HIGH_CONTRAST_DARK="hcDark",F.HIGH_CONTRAST_LIGHT="hcLight"})(ColorScheme||(ColorScheme={}));function isHighContrast(F){return F===ColorScheme.HIGH_CONTRAST_DARK||F===ColorScheme.HIGH_CONTRAST_LIGHT}function isDark(F){return F===ColorScheme.DARK||F===ColorScheme.HIGH_CONTRAST_DARK}const IThemeService=createDecorator("themeService");function themeColorFromId(F){return{id:F}}function getThemeTypeSelector(F){switch(F){case ColorScheme.DARK:return"vs-dark";case ColorScheme.HIGH_CONTRAST_DARK:return"hc-black";case ColorScheme.HIGH_CONTRAST_LIGHT:return"hc-light";default:return"vs"}}const Extensions$2={ThemingContribution:"base.contributions.theming"};class ThemingRegistry{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new Emitter$1}onColorThemeChange(w){return this.themingParticipants.push(w),this.onThemingParticipantAddedEmitter.fire(w),toDisposable(()=>{const D=this.themingParticipants.indexOf(w);this.themingParticipants.splice(D,1)})}getThemingParticipants(){return this.themingParticipants}}const themingRegistry$1=new ThemingRegistry;Registry.add(Extensions$2.ThemingContribution,themingRegistry$1);function registerThemingParticipant(F){return themingRegistry$1.onColorThemeChange(F)}class Themable extends Disposable{constructor(w){super(),this.themeService=w,this.theme=w.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(D=>this.onThemeChange(D)))}onThemeChange(w){this.theme=w,this.updateStyles()}updateStyles(){}}const editorLineHighlight=registerColor("editor.lineHighlightBackground",null,localize("lineHighlight","Background color for the highlight of line at the cursor position.")),editorLineHighlightBorder=registerColor("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:contrastBorder},localize("lineHighlightBorderBox","Background color for the border around the line at the cursor position."));registerColor("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},localize("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("rangeHighlightBorder","Background color of the border around highlighted ranges."));registerColor("editor.symbolHighlightBackground",{dark:editorFindMatchHighlight,light:editorFindMatchHighlight,hcDark:null,hcLight:null},localize("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("symbolHighlightBorder","Background color of the border around highlighted symbols."));const editorCursorForeground=registerColor("editorCursor.foreground",{dark:"#AEAFAD",light:Color.black,hcDark:Color.white,hcLight:"#0F4A85"},localize("caret","Color of the editor cursor.")),editorCursorBackground=registerColor("editorCursor.background",null,localize("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),editorMultiCursorPrimaryForeground=registerColor("editorMultiCursor.primary.foreground",editorCursorForeground,localize("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),editorMultiCursorPrimaryBackground=registerColor("editorMultiCursor.primary.background",editorCursorBackground,localize("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),editorMultiCursorSecondaryForeground=registerColor("editorMultiCursor.secondary.foreground",editorCursorForeground,localize("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),editorMultiCursorSecondaryBackground=registerColor("editorMultiCursor.secondary.background",editorCursorBackground,localize("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),editorWhitespaces=registerColor("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},localize("editorWhitespaces","Color of whitespace characters in the editor.")),editorLineNumbers=registerColor("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:Color.white,hcLight:"#292929"},localize("editorLineNumbers","Color of editor line numbers.")),deprecatedEditorIndentGuides=registerColor("editorIndentGuide.background",editorWhitespaces,localize("editorIndentGuides","Color of the editor indentation guides."),!1,localize("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),deprecatedEditorActiveIndentGuides=registerColor("editorIndentGuide.activeBackground",editorWhitespaces,localize("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,localize("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),editorIndentGuide1=registerColor("editorIndentGuide.background1",deprecatedEditorIndentGuides,localize("editorIndentGuides1","Color of the editor indentation guides (1).")),editorIndentGuide2=registerColor("editorIndentGuide.background2","#00000000",localize("editorIndentGuides2","Color of the editor indentation guides (2).")),editorIndentGuide3=registerColor("editorIndentGuide.background3","#00000000",localize("editorIndentGuides3","Color of the editor indentation guides (3).")),editorIndentGuide4=registerColor("editorIndentGuide.background4","#00000000",localize("editorIndentGuides4","Color of the editor indentation guides (4).")),editorIndentGuide5=registerColor("editorIndentGuide.background5","#00000000",localize("editorIndentGuides5","Color of the editor indentation guides (5).")),editorIndentGuide6=registerColor("editorIndentGuide.background6","#00000000",localize("editorIndentGuides6","Color of the editor indentation guides (6).")),editorActiveIndentGuide1=registerColor("editorIndentGuide.activeBackground1",deprecatedEditorActiveIndentGuides,localize("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),editorActiveIndentGuide2=registerColor("editorIndentGuide.activeBackground2","#00000000",localize("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),editorActiveIndentGuide3=registerColor("editorIndentGuide.activeBackground3","#00000000",localize("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),editorActiveIndentGuide4=registerColor("editorIndentGuide.activeBackground4","#00000000",localize("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),editorActiveIndentGuide5=registerColor("editorIndentGuide.activeBackground5","#00000000",localize("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),editorActiveIndentGuide6=registerColor("editorIndentGuide.activeBackground6","#00000000",localize("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),deprecatedEditorActiveLineNumber=registerColor("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:activeContrastBorder,hcLight:activeContrastBorder},localize("editorActiveLineNumber","Color of editor active line number"),!1,localize("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead."));registerColor("editorLineNumber.activeForeground",deprecatedEditorActiveLineNumber,localize("editorActiveLineNumber","Color of editor active line number"));const editorDimmedLineNumber=registerColor("editorLineNumber.dimmedForeground",null,localize("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed."));registerColor("editorRuler.foreground",{dark:"#5A5A5A",light:Color.lightgrey,hcDark:Color.white,hcLight:"#292929"},localize("editorRuler","Color of the editor rulers."));registerColor("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},localize("editorCodeLensForeground","Foreground color of editor CodeLens"));registerColor("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},localize("editorBracketMatchBackground","Background color behind matching brackets"));registerColor("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:contrastBorder,hcLight:contrastBorder},localize("editorBracketMatchBorder","Color for matching brackets boxes"));const editorOverviewRulerBorder=registerColor("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},localize("editorOverviewRulerBorder","Color of the overview ruler border.")),editorOverviewRulerBackground=registerColor("editorOverviewRuler.background",null,localize("editorOverviewRulerBackground","Background color of the editor overview ruler."));registerColor("editorGutter.background",editorBackground,localize("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers."));registerColor("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:Color.fromHex("#fff").transparent(.8),hcLight:contrastBorder},localize("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor."));const editorUnnecessaryCodeOpacity=registerColor("editorUnnecessaryCode.opacity",{dark:Color.fromHex("#000a"),light:Color.fromHex("#0007"),hcDark:null,hcLight:null},localize("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`));registerColor("editorGhostText.border",{dark:null,light:null,hcDark:Color.fromHex("#fff").transparent(.8),hcLight:Color.fromHex("#292929").transparent(.8)},localize("editorGhostTextBorder","Border color of ghost text in the editor."));registerColor("editorGhostText.foreground",{dark:Color.fromHex("#ffffff56"),light:Color.fromHex("#0007"),hcDark:null,hcLight:null},localize("editorGhostTextForeground","Foreground color of the ghost text in the editor."));registerColor("editorGhostText.background",null,localize("editorGhostTextBackground","Background color of the ghost text in the editor."));const rulerRangeDefault=new Color(new RGBA(0,122,204,.6));registerColor("editorOverviewRuler.rangeHighlightForeground",rulerRangeDefault,localize("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0);const overviewRulerError=registerColor("editorOverviewRuler.errorForeground",{dark:new Color(new RGBA(255,18,18,.7)),light:new Color(new RGBA(255,18,18,.7)),hcDark:new Color(new RGBA(255,50,50,1)),hcLight:"#B5200D"},localize("overviewRuleError","Overview ruler marker color for errors.")),overviewRulerWarning=registerColor("editorOverviewRuler.warningForeground",{dark:editorWarningForeground,light:editorWarningForeground,hcDark:editorWarningBorder,hcLight:editorWarningBorder},localize("overviewRuleWarning","Overview ruler marker color for warnings.")),overviewRulerInfo=registerColor("editorOverviewRuler.infoForeground",{dark:editorInfoForeground,light:editorInfoForeground,hcDark:editorInfoBorder,hcLight:editorInfoBorder},localize("overviewRuleInfo","Overview ruler marker color for infos.")),editorBracketHighlightingForeground1=registerColor("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},localize("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground2=registerColor("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},localize("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground3=registerColor("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},localize("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground4=registerColor("editorBracketHighlight.foreground4","#00000000",localize("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground5=registerColor("editorBracketHighlight.foreground5","#00000000",localize("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground6=registerColor("editorBracketHighlight.foreground6","#00000000",localize("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),editorBracketHighlightingUnexpectedBracketForeground=registerColor("editorBracketHighlight.unexpectedBracket.foreground",{dark:new Color(new RGBA(255,18,18,.8)),light:new Color(new RGBA(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},localize("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),editorBracketPairGuideBackground1=registerColor("editorBracketPairGuide.background1","#00000000",localize("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground2=registerColor("editorBracketPairGuide.background2","#00000000",localize("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground3=registerColor("editorBracketPairGuide.background3","#00000000",localize("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground4=registerColor("editorBracketPairGuide.background4","#00000000",localize("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground5=registerColor("editorBracketPairGuide.background5","#00000000",localize("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground6=registerColor("editorBracketPairGuide.background6","#00000000",localize("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground1=registerColor("editorBracketPairGuide.activeBackground1","#00000000",localize("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground2=registerColor("editorBracketPairGuide.activeBackground2","#00000000",localize("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground3=registerColor("editorBracketPairGuide.activeBackground3","#00000000",localize("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground4=registerColor("editorBracketPairGuide.activeBackground4","#00000000",localize("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground5=registerColor("editorBracketPairGuide.activeBackground5","#00000000",localize("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground6=registerColor("editorBracketPairGuide.activeBackground6","#00000000",localize("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));registerColor("editorUnicodeHighlight.border",editorWarningForeground,localize("editorUnicodeHighlight.border","Border color used to highlight unicode characters."));registerColor("editorUnicodeHighlight.background",editorWarningBackground,localize("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));registerThemingParticipant((F,w)=>{const D=F.getColor(editorBackground),O=F.getColor(editorLineHighlight),W=O&&!O.isTransparent()?O:D;W&&w.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${W}; }`)});class ColorizedBracketPairsDecorationProvider extends Disposable{constructor(w){super(),this.textModel=w,this.colorProvider=new ColorProvider,this.onDidChangeEmitter=new Emitter$1,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=w.getOptions().bracketPairColorizationOptions,this._register(w.bracketPairs.onDidChange(D=>{this.onDidChangeEmitter.fire()}))}handleDidChangeOptions(w){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(w,D,O,W){return W?[]:D===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(w,!0).map(K=>({id:`bracket${K.range.toString()}-${K.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(K,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:K.range})).toArray():[]}getAllDecorations(w,D){return w===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new Range$2(1,1,this.textModel.getLineCount(),1),w,D):[]}}class ColorProvider{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(w,D){return w.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(D?w.nestingLevelOfEqualBracketType:w.nestingLevel)}getInlineClassNameOfLevel(w){return`bracket-highlighting-${w%30}`}}registerThemingParticipant((F,w)=>{const D=[editorBracketHighlightingForeground1,editorBracketHighlightingForeground2,editorBracketHighlightingForeground3,editorBracketHighlightingForeground4,editorBracketHighlightingForeground5,editorBracketHighlightingForeground6],O=new ColorProvider;w.addRule(`.monaco-editor .${O.unexpectedClosingBracketClassName} { color: ${F.getColor(editorBracketHighlightingUnexpectedBracketForeground)}; }`);const W=D.map(U=>F.getColor(U)).filter(U=>!!U).filter(U=>!U.isTransparent());for(let U=0;U<30;U++){const K=W[U%W.length];w.addRule(`.monaco-editor .${O.getInlineClassNameOfLevel(U)} { color: ${K}; }`)}});function escapeNewLine(F){return F.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class TextChange{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(w,D,O,W){this.oldPosition=w,this.oldText=D,this.newPosition=O,this.newText=W}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${escapeNewLine(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${escapeNewLine(this.oldText)}")`:`(replace@${this.oldPosition} "${escapeNewLine(this.oldText)}" with "${escapeNewLine(this.newText)}")`}static _writeStringSize(w){return 4+2*w.length}static _writeString(w,D,O){const W=D.length;writeUInt32BE(w,W,O),O+=4;for(let U=0;U<W;U++)writeUInt16LE(w,D.charCodeAt(U),O),O+=2;return O}static _readString(w,D){const O=readUInt32BE(w,D);return D+=4,decodeUTF16LE(w,D,O)}writeSize(){return 8+TextChange._writeStringSize(this.oldText)+TextChange._writeStringSize(this.newText)}write(w,D){return writeUInt32BE(w,this.oldPosition,D),D+=4,writeUInt32BE(w,this.newPosition,D),D+=4,D=TextChange._writeString(w,this.oldText,D),D=TextChange._writeString(w,this.newText,D),D}static read(w,D,O){const W=readUInt32BE(w,D);D+=4;const U=readUInt32BE(w,D);D+=4;const K=TextChange._readString(w,D);D+=TextChange._writeStringSize(K);const q=TextChange._readString(w,D);return D+=TextChange._writeStringSize(q),O.push(new TextChange(W,K,U,q)),D}}function compressConsecutiveTextChanges(F,w){return F===null||F.length===0?w:new TextChangeCompressor(F,w).compress()}class TextChangeCompressor{constructor(w,D){this._prevEdits=w,this._currEdits=D,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let w=0,D=0,O=this._getPrev(w),W=this._getCurr(D);for(;w<this._prevLen||D<this._currLen;){if(O===null){this._acceptCurr(W),W=this._getCurr(++D);continue}if(W===null){this._acceptPrev(O),O=this._getPrev(++w);continue}if(W.oldEnd<=O.newPosition){this._acceptCurr(W),W=this._getCurr(++D);continue}if(O.newEnd<=W.oldPosition){this._acceptPrev(O),O=this._getPrev(++w);continue}if(W.oldPosition<O.newPosition){const[Q,Y]=TextChangeCompressor._splitCurr(W,O.newPosition-W.oldPosition);this._acceptCurr(Q),W=Y;continue}if(O.newPosition<W.oldPosition){const[Q,Y]=TextChangeCompressor._splitPrev(O,W.oldPosition-O.newPosition);this._acceptPrev(Q),O=Y;continue}let q,G;if(W.oldEnd===O.newEnd)q=O,G=W,O=this._getPrev(++w),W=this._getCurr(++D);else if(W.oldEnd<O.newEnd){const[Q,Y]=TextChangeCompressor._splitPrev(O,W.oldLength);q=Q,G=W,O=Y,W=this._getCurr(++D)}else{const[Q,Y]=TextChangeCompressor._splitCurr(W,O.newLength);q=O,G=Q,O=this._getPrev(++w),W=Y}this._result[this._resultLen++]=new TextChange(q.oldPosition,q.oldText,G.newPosition,G.newText),this._prevDeltaOffset+=q.newLength-q.oldLength,this._currDeltaOffset+=G.newLength-G.oldLength}const U=TextChangeCompressor._merge(this._result);return TextChangeCompressor._removeNoOps(U)}_acceptCurr(w){this._result[this._resultLen++]=TextChangeCompressor._rebaseCurr(this._prevDeltaOffset,w),this._currDeltaOffset+=w.newLength-w.oldLength}_getCurr(w){return w<this._currLen?this._currEdits[w]:null}_acceptPrev(w){this._result[this._resultLen++]=TextChangeCompressor._rebasePrev(this._currDeltaOffset,w),this._prevDeltaOffset+=w.newLength-w.oldLength}_getPrev(w){return w<this._prevLen?this._prevEdits[w]:null}static _rebaseCurr(w,D){return new TextChange(D.oldPosition-w,D.oldText,D.newPosition,D.newText)}static _rebasePrev(w,D){return new TextChange(D.oldPosition,D.oldText,D.newPosition+w,D.newText)}static _splitPrev(w,D){const O=w.newText.substr(0,D),W=w.newText.substr(D);return[new TextChange(w.oldPosition,w.oldText,w.newPosition,O),new TextChange(w.oldEnd,"",w.newPosition+D,W)]}static _splitCurr(w,D){const O=w.oldText.substr(0,D),W=w.oldText.substr(D);return[new TextChange(w.oldPosition,O,w.newPosition,w.newText),new TextChange(w.oldPosition+D,W,w.newEnd,"")]}static _merge(w){if(w.length===0)return w;const D=[];let O=0,W=w[0];for(let U=1;U<w.length;U++){const K=w[U];W.oldEnd===K.oldPosition?W=new TextChange(W.oldPosition,W.oldText+K.oldText,W.newPosition,W.newText+K.newText):(D[O++]=W,W=K)}return D[O++]=W,D}static _removeNoOps(w){if(w.length===0)return w;const D=[];let O=0;for(let W=0;W<w.length;W++){const U=w[W];U.oldText!==U.newText&&(D[O++]=U)}return D}}function uriGetComparisonKey(F){return F.toString()}class SingleModelEditStackData{static create(w,D){const O=w.getAlternativeVersionId(),W=getModelEOL(w);return new SingleModelEditStackData(O,O,W,W,D,D,[])}constructor(w,D,O,W,U,K,q){this.beforeVersionId=w,this.afterVersionId=D,this.beforeEOL=O,this.afterEOL=W,this.beforeCursorState=U,this.afterCursorState=K,this.changes=q}append(w,D,O,W,U){D.length>0&&(this.changes=compressConsecutiveTextChanges(this.changes,D)),this.afterEOL=O,this.afterVersionId=W,this.afterCursorState=U}static _writeSelectionsSize(w){return 4+4*4*(w?w.length:0)}static _writeSelections(w,D,O){if(writeUInt32BE(w,D?D.length:0,O),O+=4,D)for(const W of D)writeUInt32BE(w,W.selectionStartLineNumber,O),O+=4,writeUInt32BE(w,W.selectionStartColumn,O),O+=4,writeUInt32BE(w,W.positionLineNumber,O),O+=4,writeUInt32BE(w,W.positionColumn,O),O+=4;return O}static _readSelections(w,D,O){const W=readUInt32BE(w,D);D+=4;for(let U=0;U<W;U++){const K=readUInt32BE(w,D);D+=4;const q=readUInt32BE(w,D);D+=4;const G=readUInt32BE(w,D);D+=4;const Q=readUInt32BE(w,D);D+=4,O.push(new Selection$1(K,q,G,Q))}return D}serialize(){let w=10+SingleModelEditStackData._writeSelectionsSize(this.beforeCursorState)+SingleModelEditStackData._writeSelectionsSize(this.afterCursorState)+4;for(const W of this.changes)w+=W.writeSize();const D=new Uint8Array(w);let O=0;writeUInt32BE(D,this.beforeVersionId,O),O+=4,writeUInt32BE(D,this.afterVersionId,O),O+=4,writeUInt8(D,this.beforeEOL,O),O+=1,writeUInt8(D,this.afterEOL,O),O+=1,O=SingleModelEditStackData._writeSelections(D,this.beforeCursorState,O),O=SingleModelEditStackData._writeSelections(D,this.afterCursorState,O),writeUInt32BE(D,this.changes.length,O),O+=4;for(const W of this.changes)O=W.write(D,O);return D.buffer}static deserialize(w){const D=new Uint8Array(w);let O=0;const W=readUInt32BE(D,O);O+=4;const U=readUInt32BE(D,O);O+=4;const K=readUInt8(D,O);O+=1;const q=readUInt8(D,O);O+=1;const G=[];O=SingleModelEditStackData._readSelections(D,O,G);const Q=[];O=SingleModelEditStackData._readSelections(D,O,Q);const Y=readUInt32BE(D,O);O+=4;const X=[];for(let J=0;J<Y;J++)O=TextChange.read(D,O,X);return new SingleModelEditStackData(W,U,K,q,G,Q,X)}}class SingleModelEditStackElement{get type(){return 0}get resource(){return URI.isUri(this.model)?this.model:this.model.uri}constructor(w,D,O,W){this.label=w,this.code=D,this.model=O,this._data=SingleModelEditStackData.create(O,W)}toString(){return(this._data instanceof SingleModelEditStackData?this._data:SingleModelEditStackData.deserialize(this._data)).changes.map(D=>D.toString()).join(", ")}matchesResource(w){return(URI.isUri(this.model)?this.model:this.model.uri).toString()===w.toString()}setModel(w){this.model=w}canAppend(w){return this.model===w&&this._data instanceof SingleModelEditStackData}append(w,D,O,W,U){this._data instanceof SingleModelEditStackData&&this._data.append(w,D,O,W,U)}close(){this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize())}open(){this._data instanceof SingleModelEditStackData||(this._data=SingleModelEditStackData.deserialize(this._data))}undo(){if(URI.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize());const w=SingleModelEditStackData.deserialize(this._data);this.model._applyUndo(w.changes,w.beforeEOL,w.beforeVersionId,w.beforeCursorState)}redo(){if(URI.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize());const w=SingleModelEditStackData.deserialize(this._data);this.model._applyRedo(w.changes,w.afterEOL,w.afterVersionId,w.afterCursorState)}heapSize(){return this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize()),this._data.byteLength+168}}class MultiModelEditStackElement{get resources(){return this._editStackElementsArr.map(w=>w.resource)}constructor(w,D,O){this.label=w,this.code=D,this.type=1,this._isOpen=!0,this._editStackElementsArr=O.slice(0),this._editStackElementsMap=new Map;for(const W of this._editStackElementsArr){const U=uriGetComparisonKey(W.resource);this._editStackElementsMap.set(U,W)}this._delegate=null}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(w){const D=uriGetComparisonKey(w);return this._editStackElementsMap.has(D)}setModel(w){const D=uriGetComparisonKey(URI.isUri(w)?w:w.uri);this._editStackElementsMap.has(D)&&this._editStackElementsMap.get(D).setModel(w)}canAppend(w){if(!this._isOpen)return!1;const D=uriGetComparisonKey(w.uri);return this._editStackElementsMap.has(D)?this._editStackElementsMap.get(D).canAppend(w):!1}append(w,D,O,W,U){const K=uriGetComparisonKey(w.uri);this._editStackElementsMap.get(K).append(w,D,O,W,U)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const w of this._editStackElementsArr)w.undo()}redo(){for(const w of this._editStackElementsArr)w.redo()}heapSize(w){const D=uriGetComparisonKey(w);return this._editStackElementsMap.has(D)?this._editStackElementsMap.get(D).heapSize():0}split(){return this._editStackElementsArr}toString(){const w=[];for(const D of this._editStackElementsArr)w.push(`${basename(D.resource)}: ${D}`);return`{${w.join(", ")}}`}}function getModelEOL(F){return F.getEOL()===`
`?0:1}function isEditStackElement(F){return F?F instanceof SingleModelEditStackElement||F instanceof MultiModelEditStackElement:!1}class EditStack{constructor(w,D){this._model=w,this._undoRedoService=D}pushStackElement(){const w=this._undoRedoService.getLastElement(this._model.uri);isEditStackElement(w)&&w.close()}popStackElement(){const w=this._undoRedoService.getLastElement(this._model.uri);isEditStackElement(w)&&w.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(w,D){const O=this._undoRedoService.getLastElement(this._model.uri);if(isEditStackElement(O)&&O.canAppend(this._model))return O;const W=new SingleModelEditStackElement(localize("edit","Typing"),"undoredo.textBufferEdit",this._model,w);return this._undoRedoService.pushElement(W,D),W}pushEOL(w){const D=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(w),D.append(this._model,[],getModelEOL(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(w,D,O,W){const U=this._getOrCreateEditStackElement(w,W),K=this._model.applyEdits(D,!0),q=EditStack._computeCursorState(O,K),G=K.map((Q,Y)=>({index:Y,textChange:Q.textChange}));return G.sort((Q,Y)=>Q.textChange.oldPosition===Y.textChange.oldPosition?Q.index-Y.index:Q.textChange.oldPosition-Y.textChange.oldPosition),U.append(this._model,G.map(Q=>Q.textChange),getModelEOL(this._model),this._model.getAlternativeVersionId(),q),q}static _computeCursorState(w,D){try{return w?w(D):null}catch(O){return onUnexpectedError(O),null}}}function findLast(F,w){const D=findLastIdx(F,w);if(D!==-1)return F[D]}function findLastIdx(F,w,D=F.length-1){for(let O=D;O>=0;O--){const W=F[O];if(w(W))return O}return-1}function findLastMonotonous(F,w){const D=findLastIdxMonotonous(F,w);return D===-1?void 0:F[D]}function findLastIdxMonotonous(F,w,D=0,O=F.length){let W=D,U=O;for(;W<U;){const K=Math.floor((W+U)/2);w(F[K])?W=K+1:U=K}return W-1}function findFirstMonotonous(F,w){const D=findFirstIdxMonotonousOrArrLen(F,w);return D===F.length?void 0:F[D]}function findFirstIdxMonotonousOrArrLen(F,w,D=0,O=F.length){let W=D,U=O;for(;W<U;){const K=Math.floor((W+U)/2);w(F[K])?U=K:W=K+1}return W}class MonotonousArray{static{this.assertInvariants=!1}constructor(w){this._array=w,this._findLastMonotonousLastIdx=0}findLastMonotonous(w){if(MonotonousArray.assertInvariants){if(this._prevFindLastPredicate){for(const O of this._array)if(this._prevFindLastPredicate(O)&&!w(O))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=w}const D=findLastIdxMonotonous(this._array,w,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=D+1,D===-1?void 0:this._array[D]}}function findFirstMax(F,w){if(F.length===0)return;let D=F[0];for(let O=1;O<F.length;O++){const W=F[O];w(W,D)>0&&(D=W)}return D}function findLastMax(F,w){if(F.length===0)return;let D=F[0];for(let O=1;O<F.length;O++){const W=F[O];w(W,D)>=0&&(D=W)}return D}function findFirstMin(F,w){return findFirstMax(F,(D,O)=>-w(D,O))}function findMaxIdx(F,w){if(F.length===0)return-1;let D=0;for(let O=1;O<F.length;O++){const W=F[O];w(W,F[D])>0&&(D=O)}return D}class TextModelPart extends Disposable{constructor(){super(...arguments),this._isDisposed=!1}dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}function computeIndentLevel(F,w){let D=0,O=0;const W=F.length;for(;O<W;){const U=F.charCodeAt(O);if(U===32)D++;else if(U===9)D=D-D%w+w;else break;O++}return O===W?-1:D}var HorizontalGuidesState;(function(F){F[F.Disabled=0]="Disabled",F[F.EnabledForActive=1]="EnabledForActive",F[F.Enabled=2]="Enabled"})(HorizontalGuidesState||(HorizontalGuidesState={}));class IndentGuide{constructor(w,D,O,W,U,K){if(this.visibleColumn=w,this.column=D,this.className=O,this.horizontalLine=W,this.forWrappedLinesAfterColumn=U,this.forWrappedLinesBeforeOrAtColumn=K,w!==-1==(D!==-1))throw new Error}}class IndentGuideHorizontalLine{constructor(w,D){this.top=w,this.endColumn=D}}class GuidesTextModelPart extends TextModelPart{constructor(w,D){super(),this.textModel=w,this.languageConfigurationService=D}getLanguageConfiguration(w){return this.languageConfigurationService.getLanguageConfiguration(w)}_computeIndentLevel(w){return computeIndentLevel(this.textModel.getLineContent(w+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(w,D,O){this.assertNotDisposed();const W=this.textModel.getLineCount();if(w<1||w>W)throw new BugIndicatingError("Illegal value for lineNumber");const U=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,K=!!(U&&U.offSide);let q=-2,G=-1,Q=-2,Y=-1;const X=fe=>{if(q!==-1&&(q===-2||q>fe-1)){q=-1,G=-1;for(let Ce=fe-2;Ce>=0;Ce--){const we=this._computeIndentLevel(Ce);if(we>=0){q=Ce,G=we;break}}}if(Q===-2){Q=-1,Y=-1;for(let Ce=fe;Ce<W;Ce++){const we=this._computeIndentLevel(Ce);if(we>=0){Q=Ce,Y=we;break}}}};let J=-2,te=-1,ie=-2,se=-1;const re=fe=>{if(J===-2){J=-1,te=-1;for(let Ce=fe-2;Ce>=0;Ce--){const we=this._computeIndentLevel(Ce);if(we>=0){J=Ce,te=we;break}}}if(ie!==-1&&(ie===-2||ie<fe-1)){ie=-1,se=-1;for(let Ce=fe;Ce<W;Ce++){const we=this._computeIndentLevel(Ce);if(we>=0){ie=Ce,se=we;break}}}};let ae=0,le=!0,de=0,oe=!0,ue=0,pe=0;for(let fe=0;le||oe;fe++){const Ce=w-fe,we=w+fe;fe>1&&(Ce<1||Ce<D)&&(le=!1),fe>1&&(we>W||we>O)&&(oe=!1),fe>5e4&&(le=!1,oe=!1);let Oe=-1;if(le&&Ce>=1){const Re=this._computeIndentLevel(Ce-1);Re>=0?(Q=Ce-1,Y=Re,Oe=Math.ceil(Re/this.textModel.getOptions().indentSize)):(X(Ce),Oe=this._getIndentLevelForWhitespaceLine(K,G,Y))}let Te=-1;if(oe&&we<=W){const Re=this._computeIndentLevel(we-1);Re>=0?(J=we-1,te=Re,Te=Math.ceil(Re/this.textModel.getOptions().indentSize)):(re(we),Te=this._getIndentLevelForWhitespaceLine(K,te,se))}if(fe===0){pe=Oe;continue}if(fe===1){if(we<=W&&Te>=0&&pe+1===Te){le=!1,ae=we,de=we,ue=Te;continue}if(Ce>=1&&Oe>=0&&Oe-1===pe){oe=!1,ae=Ce,de=Ce,ue=Oe;continue}if(ae=w,de=w,ue=pe,ue===0)return{startLineNumber:ae,endLineNumber:de,indent:ue}}le&&(Oe>=ue?ae=Ce:le=!1),oe&&(Te>=ue?de=we:oe=!1)}return{startLineNumber:ae,endLineNumber:de,indent:ue}}getLinesBracketGuides(w,D,O,W){const U=[];for(let X=w;X<=D;X++)U.push([]);const K=!0,q=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new Range$2(w,1,D,this.textModel.getLineMaxColumn(D))).toArray();let G;if(O&&q.length>0){const X=(w<=O.lineNumber&&O.lineNumber<=D?q:this.textModel.bracketPairs.getBracketPairsInRange(Range$2.fromPositions(O)).toArray()).filter(J=>Range$2.strictContainsPosition(J.range,O));G=findLast(X,J=>K)?.range}const Q=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,Y=new BracketPairGuidesClassNames;for(const X of q){if(!X.closingBracketRange)continue;const J=G&&X.range.equalsRange(G);if(!J&&!W.includeInactive)continue;const te=Y.getInlineClassName(X.nestingLevel,X.nestingLevelOfEqualBracketType,Q)+(W.highlightActive&&J?" "+Y.activeClassName:""),ie=X.openingBracketRange.getStartPosition(),se=X.closingBracketRange.getStartPosition(),re=W.horizontalGuides===HorizontalGuidesState.Enabled||W.horizontalGuides===HorizontalGuidesState.EnabledForActive&&J;if(X.range.startLineNumber===X.range.endLineNumber){re&&U[X.range.startLineNumber-w].push(new IndentGuide(-1,X.openingBracketRange.getEndPosition().column,te,new IndentGuideHorizontalLine(!1,se.column),-1,-1));continue}const ae=this.getVisibleColumnFromPosition(se),le=this.getVisibleColumnFromPosition(X.openingBracketRange.getStartPosition()),de=Math.min(le,ae,X.minVisibleColumnIndentation+1);let oe=!1;firstNonWhitespaceIndex(this.textModel.getLineContent(X.closingBracketRange.startLineNumber))<X.closingBracketRange.startColumn-1&&(oe=!0);const fe=Math.max(ie.lineNumber,w),Ce=Math.min(se.lineNumber,D),we=oe?1:0;for(let Oe=fe;Oe<Ce+we;Oe++)U[Oe-w].push(new IndentGuide(de,-1,te,null,Oe===ie.lineNumber?ie.column:-1,Oe===se.lineNumber?se.column:-1));re&&(ie.lineNumber>=w&&le>de&&U[ie.lineNumber-w].push(new IndentGuide(de,-1,te,new IndentGuideHorizontalLine(!1,ie.column),-1,-1)),se.lineNumber<=D&&ae>de&&U[se.lineNumber-w].push(new IndentGuide(de,-1,te,new IndentGuideHorizontalLine(!oe,se.column),-1,-1)))}for(const X of U)X.sort((J,te)=>J.visibleColumn-te.visibleColumn);return U}getVisibleColumnFromPosition(w){return CursorColumns.visibleColumnFromColumn(this.textModel.getLineContent(w.lineNumber),w.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(w,D){this.assertNotDisposed();const O=this.textModel.getLineCount();if(w<1||w>O)throw new Error("Illegal value for startLineNumber");if(D<1||D>O)throw new Error("Illegal value for endLineNumber");const W=this.textModel.getOptions(),U=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,K=!!(U&&U.offSide),q=new Array(D-w+1);let G=-2,Q=-1,Y=-2,X=-1;for(let J=w;J<=D;J++){const te=J-w,ie=this._computeIndentLevel(J-1);if(ie>=0){G=J-1,Q=ie,q[te]=Math.ceil(ie/W.indentSize);continue}if(G===-2){G=-1,Q=-1;for(let se=J-2;se>=0;se--){const re=this._computeIndentLevel(se);if(re>=0){G=se,Q=re;break}}}if(Y!==-1&&(Y===-2||Y<J-1)){Y=-1,X=-1;for(let se=J;se<O;se++){const re=this._computeIndentLevel(se);if(re>=0){Y=se,X=re;break}}}q[te]=this._getIndentLevelForWhitespaceLine(K,Q,X)}return q}_getIndentLevelForWhitespaceLine(w,D,O){const W=this.textModel.getOptions();return D===-1||O===-1?0:D<O?1+Math.floor(D/W.indentSize):D===O||w?Math.ceil(O/W.indentSize):1+Math.floor(O/W.indentSize)}}class BracketPairGuidesClassNames{constructor(){this.activeClassName="indent-active"}getInlineClassName(w,D,O){return this.getInlineClassNameOfLevel(O?D:w)}getInlineClassNameOfLevel(w){return`bracket-indent-guide lvl-${w%30}`}}class SpacesDiffResult{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function spacesDiff(F,w,D,O,W){W.spacesDiff=0,W.looksLikeAlignment=!1;let U;for(U=0;U<w&&U<O;U++){const J=F.charCodeAt(U),te=D.charCodeAt(U);if(J!==te)break}let K=0,q=0;for(let J=U;J<w;J++)F.charCodeAt(J)===32?K++:q++;let G=0,Q=0;for(let J=U;J<O;J++)D.charCodeAt(J)===32?G++:Q++;if(K>0&&q>0||G>0&&Q>0)return;const Y=Math.abs(q-Q),X=Math.abs(K-G);if(Y===0){W.spacesDiff=X,X>0&&0<=G-1&&G-1<F.length&&G<D.length&&D.charCodeAt(G)!==32&&F.charCodeAt(G-1)===32&&F.charCodeAt(F.length-1)===44&&(W.looksLikeAlignment=!0);return}if(X%Y===0){W.spacesDiff=X/Y;return}}function guessIndentation(F,w,D){const O=Math.min(F.getLineCount(),1e4);let W=0,U=0,K="",q=0;const G=[2,4,6,8,3,5,7],Q=8,Y=[0,0,0,0,0,0,0,0,0],X=new SpacesDiffResult;for(let ie=1;ie<=O;ie++){const se=F.getLineLength(ie),re=F.getLineContent(ie),ae=se<=65536;let le=!1,de=0,oe=0,ue=0;for(let fe=0,Ce=se;fe<Ce;fe++){const we=ae?re.charCodeAt(fe):F.getLineCharCode(ie,fe);if(we===9)ue++;else if(we===32)oe++;else{le=!0,de=fe;break}}if(!le||(ue>0?W++:oe>1&&U++,spacesDiff(K,q,re,de,X),X.looksLikeAlignment&&!(D&&w===X.spacesDiff)))continue;const pe=X.spacesDiff;pe<=Q&&Y[pe]++,K=re,q=de}let J=D;W!==U&&(J=W<U);let te=w;if(J){let ie=J?0:.1*O;G.forEach(se=>{const re=Y[se];re>ie&&(ie=re,te=se)}),te===4&&Y[4]>0&&Y[2]>0&&Y[2]>=Y[4]/2&&(te=2)}return{insertSpaces:J,tabSize:te}}function getNodeColor(F){return(F.metadata&1)>>>0}function setNodeColor(F,w){F.metadata=F.metadata&254|w<<0}function getNodeIsVisited(F){return(F.metadata&2)>>>1===1}function setNodeIsVisited(F,w){F.metadata=F.metadata&253|(w?1:0)<<1}function getNodeIsForValidation(F){return(F.metadata&4)>>>2===1}function setNodeIsForValidation(F,w){F.metadata=F.metadata&251|(w?1:0)<<2}function getNodeIsInGlyphMargin(F){return(F.metadata&64)>>>6===1}function setNodeIsInGlyphMargin(F,w){F.metadata=F.metadata&191|(w?1:0)<<6}function getNodeStickiness(F){return(F.metadata&24)>>>3}function _setNodeStickiness(F,w){F.metadata=F.metadata&231|w<<3}function getCollapseOnReplaceEdit(F){return(F.metadata&32)>>>5===1}function setCollapseOnReplaceEdit(F,w){F.metadata=F.metadata&223|(w?1:0)<<5}class IntervalNode{constructor(w,D,O){this.metadata=0,this.parent=this,this.left=this,this.right=this,setNodeColor(this,1),this.start=D,this.end=O,this.delta=0,this.maxEnd=O,this.id=w,this.ownerId=0,this.options=null,setNodeIsForValidation(this,!1),setNodeIsInGlyphMargin(this,!1),_setNodeStickiness(this,1),setCollapseOnReplaceEdit(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=D,this.cachedAbsoluteEnd=O,this.range=null,setNodeIsVisited(this,!1)}reset(w,D,O,W){this.start=D,this.end=O,this.maxEnd=O,this.cachedVersionId=w,this.cachedAbsoluteStart=D,this.cachedAbsoluteEnd=O,this.range=W}setOptions(w){this.options=w;const D=this.options.className;setNodeIsForValidation(this,D==="squiggly-error"||D==="squiggly-warning"||D==="squiggly-info"),setNodeIsInGlyphMargin(this,this.options.glyphMarginClassName!==null),_setNodeStickiness(this,this.options.stickiness),setCollapseOnReplaceEdit(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(w,D,O){this.cachedVersionId!==O&&(this.range=null),this.cachedVersionId=O,this.cachedAbsoluteStart=w,this.cachedAbsoluteEnd=D}detach(){this.parent=null,this.left=null,this.right=null}}const SENTINEL$1=new IntervalNode(null,0,0);SENTINEL$1.parent=SENTINEL$1;SENTINEL$1.left=SENTINEL$1;SENTINEL$1.right=SENTINEL$1;setNodeColor(SENTINEL$1,0);class IntervalTree{constructor(){this.root=SENTINEL$1,this.requestNormalizeDelta=!1}intervalSearch(w,D,O,W,U,K){return this.root===SENTINEL$1?[]:intervalSearch(this,w,D,O,W,U,K)}search(w,D,O,W){return this.root===SENTINEL$1?[]:search(this,w,D,O,W)}collectNodesFromOwner(w){return collectNodesFromOwner(this,w)}collectNodesPostOrder(){return collectNodesPostOrder(this)}insert(w){rbTreeInsert(this,w),this._normalizeDeltaIfNecessary()}delete(w){rbTreeDelete(this,w),this._normalizeDeltaIfNecessary()}resolveNode(w,D){const O=w;let W=0;for(;w!==this.root;)w===w.parent.right&&(W+=w.parent.delta),w=w.parent;const U=O.start+W,K=O.end+W;O.setCachedOffsets(U,K,D)}acceptReplace(w,D,O,W){const U=searchForEditing(this,w,w+D);for(let K=0,q=U.length;K<q;K++){const G=U[K];rbTreeDelete(this,G)}this._normalizeDeltaIfNecessary(),noOverlapReplace(this,w,w+D,O),this._normalizeDeltaIfNecessary();for(let K=0,q=U.length;K<q;K++){const G=U[K];G.start=G.cachedAbsoluteStart,G.end=G.cachedAbsoluteEnd,nodeAcceptEdit(G,w,w+D,O,W),G.maxEnd=G.end,rbTreeInsert(this,G)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,normalizeDelta(this))}}function normalizeDelta(F){let w=F.root,D=0;for(;w!==SENTINEL$1;){if(w.left!==SENTINEL$1&&!getNodeIsVisited(w.left)){w=w.left;continue}if(w.right!==SENTINEL$1&&!getNodeIsVisited(w.right)){D+=w.delta,w=w.right;continue}w.start=D+w.start,w.end=D+w.end,w.delta=0,recomputeMaxEnd(w),setNodeIsVisited(w,!0),setNodeIsVisited(w.left,!1),setNodeIsVisited(w.right,!1),w===w.parent.right&&(D-=w.parent.delta),w=w.parent}setNodeIsVisited(F.root,!1)}function adjustMarkerBeforeColumn(F,w,D,O){return F<D?!0:F>D||O===1?!1:O===2?!0:w}function nodeAcceptEdit(F,w,D,O,W){const U=getNodeStickiness(F),K=U===0||U===2,q=U===1||U===2,G=D-w,Q=O,Y=Math.min(G,Q),X=F.start;let J=!1;const te=F.end;let ie=!1;w<=X&&te<=D&&getCollapseOnReplaceEdit(F)&&(F.start=w,J=!0,F.end=w,ie=!0);{const re=W?1:G>0?2:0;!J&&adjustMarkerBeforeColumn(X,K,w,re)&&(J=!0),!ie&&adjustMarkerBeforeColumn(te,q,w,re)&&(ie=!0)}if(Y>0&&!W){const re=G>Q?2:0;!J&&adjustMarkerBeforeColumn(X,K,w+Y,re)&&(J=!0),!ie&&adjustMarkerBeforeColumn(te,q,w+Y,re)&&(ie=!0)}{const re=W?1:0;!J&&adjustMarkerBeforeColumn(X,K,D,re)&&(F.start=w+Q,J=!0),!ie&&adjustMarkerBeforeColumn(te,q,D,re)&&(F.end=w+Q,ie=!0)}const se=Q-G;J||(F.start=Math.max(0,X+se)),ie||(F.end=Math.max(0,te+se)),F.start>F.end&&(F.end=F.start)}function searchForEditing(F,w,D){let O=F.root,W=0,U=0,K=0,q=0;const G=[];let Q=0;for(;O!==SENTINEL$1;){if(getNodeIsVisited(O)){setNodeIsVisited(O.left,!1),setNodeIsVisited(O.right,!1),O===O.parent.right&&(W-=O.parent.delta),O=O.parent;continue}if(!getNodeIsVisited(O.left)){if(U=W+O.maxEnd,U<w){setNodeIsVisited(O,!0);continue}if(O.left!==SENTINEL$1){O=O.left;continue}}if(K=W+O.start,K>D){setNodeIsVisited(O,!0);continue}if(q=W+O.end,q>=w&&(O.setCachedOffsets(K,q,0),G[Q++]=O),setNodeIsVisited(O,!0),O.right!==SENTINEL$1&&!getNodeIsVisited(O.right)){W+=O.delta,O=O.right;continue}}return setNodeIsVisited(F.root,!1),G}function noOverlapReplace(F,w,D,O){let W=F.root,U=0,K=0,q=0;const G=O-(D-w);for(;W!==SENTINEL$1;){if(getNodeIsVisited(W)){setNodeIsVisited(W.left,!1),setNodeIsVisited(W.right,!1),W===W.parent.right&&(U-=W.parent.delta),recomputeMaxEnd(W),W=W.parent;continue}if(!getNodeIsVisited(W.left)){if(K=U+W.maxEnd,K<w){setNodeIsVisited(W,!0);continue}if(W.left!==SENTINEL$1){W=W.left;continue}}if(q=U+W.start,q>D){W.start+=G,W.end+=G,W.delta+=G,(W.delta<-1073741824||W.delta>1073741824)&&(F.requestNormalizeDelta=!0),setNodeIsVisited(W,!0);continue}if(setNodeIsVisited(W,!0),W.right!==SENTINEL$1&&!getNodeIsVisited(W.right)){U+=W.delta,W=W.right;continue}}setNodeIsVisited(F.root,!1)}function collectNodesFromOwner(F,w){let D=F.root;const O=[];let W=0;for(;D!==SENTINEL$1;){if(getNodeIsVisited(D)){setNodeIsVisited(D.left,!1),setNodeIsVisited(D.right,!1),D=D.parent;continue}if(D.left!==SENTINEL$1&&!getNodeIsVisited(D.left)){D=D.left;continue}if(D.ownerId===w&&(O[W++]=D),setNodeIsVisited(D,!0),D.right!==SENTINEL$1&&!getNodeIsVisited(D.right)){D=D.right;continue}}return setNodeIsVisited(F.root,!1),O}function collectNodesPostOrder(F){let w=F.root;const D=[];let O=0;for(;w!==SENTINEL$1;){if(getNodeIsVisited(w)){setNodeIsVisited(w.left,!1),setNodeIsVisited(w.right,!1),w=w.parent;continue}if(w.left!==SENTINEL$1&&!getNodeIsVisited(w.left)){w=w.left;continue}if(w.right!==SENTINEL$1&&!getNodeIsVisited(w.right)){w=w.right;continue}D[O++]=w,setNodeIsVisited(w,!0)}return setNodeIsVisited(F.root,!1),D}function search(F,w,D,O,W){let U=F.root,K=0,q=0,G=0;const Q=[];let Y=0;for(;U!==SENTINEL$1;){if(getNodeIsVisited(U)){setNodeIsVisited(U.left,!1),setNodeIsVisited(U.right,!1),U===U.parent.right&&(K-=U.parent.delta),U=U.parent;continue}if(U.left!==SENTINEL$1&&!getNodeIsVisited(U.left)){U=U.left;continue}q=K+U.start,G=K+U.end,U.setCachedOffsets(q,G,O);let X=!0;if(w&&U.ownerId&&U.ownerId!==w&&(X=!1),D&&getNodeIsForValidation(U)&&(X=!1),W&&!getNodeIsInGlyphMargin(U)&&(X=!1),X&&(Q[Y++]=U),setNodeIsVisited(U,!0),U.right!==SENTINEL$1&&!getNodeIsVisited(U.right)){K+=U.delta,U=U.right;continue}}return setNodeIsVisited(F.root,!1),Q}function intervalSearch(F,w,D,O,W,U,K){let q=F.root,G=0,Q=0,Y=0,X=0;const J=[];let te=0;for(;q!==SENTINEL$1;){if(getNodeIsVisited(q)){setNodeIsVisited(q.left,!1),setNodeIsVisited(q.right,!1),q===q.parent.right&&(G-=q.parent.delta),q=q.parent;continue}if(!getNodeIsVisited(q.left)){if(Q=G+q.maxEnd,Q<w){setNodeIsVisited(q,!0);continue}if(q.left!==SENTINEL$1){q=q.left;continue}}if(Y=G+q.start,Y>D){setNodeIsVisited(q,!0);continue}if(X=G+q.end,X>=w){q.setCachedOffsets(Y,X,U);let ie=!0;O&&q.ownerId&&q.ownerId!==O&&(ie=!1),W&&getNodeIsForValidation(q)&&(ie=!1),K&&!getNodeIsInGlyphMargin(q)&&(ie=!1),ie&&(J[te++]=q)}if(setNodeIsVisited(q,!0),q.right!==SENTINEL$1&&!getNodeIsVisited(q.right)){G+=q.delta,q=q.right;continue}}return setNodeIsVisited(F.root,!1),J}function rbTreeInsert(F,w){if(F.root===SENTINEL$1)return w.parent=SENTINEL$1,w.left=SENTINEL$1,w.right=SENTINEL$1,setNodeColor(w,0),F.root=w,F.root;treeInsert(F,w),recomputeMaxEndWalkToRoot(w.parent);let D=w;for(;D!==F.root&&getNodeColor(D.parent)===1;)if(D.parent===D.parent.parent.left){const O=D.parent.parent.right;getNodeColor(O)===1?(setNodeColor(D.parent,0),setNodeColor(O,0),setNodeColor(D.parent.parent,1),D=D.parent.parent):(D===D.parent.right&&(D=D.parent,leftRotate$1(F,D)),setNodeColor(D.parent,0),setNodeColor(D.parent.parent,1),rightRotate$1(F,D.parent.parent))}else{const O=D.parent.parent.left;getNodeColor(O)===1?(setNodeColor(D.parent,0),setNodeColor(O,0),setNodeColor(D.parent.parent,1),D=D.parent.parent):(D===D.parent.left&&(D=D.parent,rightRotate$1(F,D)),setNodeColor(D.parent,0),setNodeColor(D.parent.parent,1),leftRotate$1(F,D.parent.parent))}return setNodeColor(F.root,0),w}function treeInsert(F,w){let D=0,O=F.root;const W=w.start,U=w.end;for(;;)if(intervalCompare(W,U,O.start+D,O.end+D)<0)if(O.left===SENTINEL$1){w.start-=D,w.end-=D,w.maxEnd-=D,O.left=w;break}else O=O.left;else if(O.right===SENTINEL$1){w.start-=D+O.delta,w.end-=D+O.delta,w.maxEnd-=D+O.delta,O.right=w;break}else D+=O.delta,O=O.right;w.parent=O,w.left=SENTINEL$1,w.right=SENTINEL$1,setNodeColor(w,1)}function rbTreeDelete(F,w){let D,O;if(w.left===SENTINEL$1?(D=w.right,O=w,D.delta+=w.delta,(D.delta<-1073741824||D.delta>1073741824)&&(F.requestNormalizeDelta=!0),D.start+=w.delta,D.end+=w.delta):w.right===SENTINEL$1?(D=w.left,O=w):(O=leftest$1(w.right),D=O.right,D.start+=O.delta,D.end+=O.delta,D.delta+=O.delta,(D.delta<-1073741824||D.delta>1073741824)&&(F.requestNormalizeDelta=!0),O.start+=w.delta,O.end+=w.delta,O.delta=w.delta,(O.delta<-1073741824||O.delta>1073741824)&&(F.requestNormalizeDelta=!0)),O===F.root){F.root=D,setNodeColor(D,0),w.detach(),resetSentinel$1(),recomputeMaxEnd(D),F.root.parent=SENTINEL$1;return}const W=getNodeColor(O)===1;if(O===O.parent.left?O.parent.left=D:O.parent.right=D,O===w?D.parent=O.parent:(O.parent===w?D.parent=O:D.parent=O.parent,O.left=w.left,O.right=w.right,O.parent=w.parent,setNodeColor(O,getNodeColor(w)),w===F.root?F.root=O:w===w.parent.left?w.parent.left=O:w.parent.right=O,O.left!==SENTINEL$1&&(O.left.parent=O),O.right!==SENTINEL$1&&(O.right.parent=O)),w.detach(),W){recomputeMaxEndWalkToRoot(D.parent),O!==w&&(recomputeMaxEndWalkToRoot(O),recomputeMaxEndWalkToRoot(O.parent)),resetSentinel$1();return}recomputeMaxEndWalkToRoot(D),recomputeMaxEndWalkToRoot(D.parent),O!==w&&(recomputeMaxEndWalkToRoot(O),recomputeMaxEndWalkToRoot(O.parent));let U;for(;D!==F.root&&getNodeColor(D)===0;)D===D.parent.left?(U=D.parent.right,getNodeColor(U)===1&&(setNodeColor(U,0),setNodeColor(D.parent,1),leftRotate$1(F,D.parent),U=D.parent.right),getNodeColor(U.left)===0&&getNodeColor(U.right)===0?(setNodeColor(U,1),D=D.parent):(getNodeColor(U.right)===0&&(setNodeColor(U.left,0),setNodeColor(U,1),rightRotate$1(F,U),U=D.parent.right),setNodeColor(U,getNodeColor(D.parent)),setNodeColor(D.parent,0),setNodeColor(U.right,0),leftRotate$1(F,D.parent),D=F.root)):(U=D.parent.left,getNodeColor(U)===1&&(setNodeColor(U,0),setNodeColor(D.parent,1),rightRotate$1(F,D.parent),U=D.parent.left),getNodeColor(U.left)===0&&getNodeColor(U.right)===0?(setNodeColor(U,1),D=D.parent):(getNodeColor(U.left)===0&&(setNodeColor(U.right,0),setNodeColor(U,1),leftRotate$1(F,U),U=D.parent.left),setNodeColor(U,getNodeColor(D.parent)),setNodeColor(D.parent,0),setNodeColor(U.left,0),rightRotate$1(F,D.parent),D=F.root));setNodeColor(D,0),resetSentinel$1()}function leftest$1(F){for(;F.left!==SENTINEL$1;)F=F.left;return F}function resetSentinel$1(){SENTINEL$1.parent=SENTINEL$1,SENTINEL$1.delta=0,SENTINEL$1.start=0,SENTINEL$1.end=0}function leftRotate$1(F,w){const D=w.right;D.delta+=w.delta,(D.delta<-1073741824||D.delta>1073741824)&&(F.requestNormalizeDelta=!0),D.start+=w.delta,D.end+=w.delta,w.right=D.left,D.left!==SENTINEL$1&&(D.left.parent=w),D.parent=w.parent,w.parent===SENTINEL$1?F.root=D:w===w.parent.left?w.parent.left=D:w.parent.right=D,D.left=w,w.parent=D,recomputeMaxEnd(w),recomputeMaxEnd(D)}function rightRotate$1(F,w){const D=w.left;w.delta-=D.delta,(w.delta<-1073741824||w.delta>1073741824)&&(F.requestNormalizeDelta=!0),w.start-=D.delta,w.end-=D.delta,w.left=D.right,D.right!==SENTINEL$1&&(D.right.parent=w),D.parent=w.parent,w.parent===SENTINEL$1?F.root=D:w===w.parent.right?w.parent.right=D:w.parent.left=D,D.right=w,w.parent=D,recomputeMaxEnd(w),recomputeMaxEnd(D)}function computeMaxEnd(F){let w=F.end;if(F.left!==SENTINEL$1){const D=F.left.maxEnd;D>w&&(w=D)}if(F.right!==SENTINEL$1){const D=F.right.maxEnd+F.delta;D>w&&(w=D)}return w}function recomputeMaxEnd(F){F.maxEnd=computeMaxEnd(F)}function recomputeMaxEndWalkToRoot(F){for(;F!==SENTINEL$1;){const w=computeMaxEnd(F);if(F.maxEnd===w)return;F.maxEnd=w,F=F.parent}}function intervalCompare(F,w,D,O){return F===D?w-O:F-D}class TreeNode{constructor(w,D){this.piece=w,this.color=D,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==SENTINEL)return leftest(this.right);let w=this;for(;w.parent!==SENTINEL&&w.parent.left!==w;)w=w.parent;return w.parent===SENTINEL?SENTINEL:w.parent}prev(){if(this.left!==SENTINEL)return righttest(this.left);let w=this;for(;w.parent!==SENTINEL&&w.parent.right!==w;)w=w.parent;return w.parent===SENTINEL?SENTINEL:w.parent}detach(){this.parent=null,this.left=null,this.right=null}}const SENTINEL=new TreeNode(null,0);SENTINEL.parent=SENTINEL;SENTINEL.left=SENTINEL;SENTINEL.right=SENTINEL;SENTINEL.color=0;function leftest(F){for(;F.left!==SENTINEL;)F=F.left;return F}function righttest(F){for(;F.right!==SENTINEL;)F=F.right;return F}function calculateSize(F){return F===SENTINEL?0:F.size_left+F.piece.length+calculateSize(F.right)}function calculateLF(F){return F===SENTINEL?0:F.lf_left+F.piece.lineFeedCnt+calculateLF(F.right)}function resetSentinel(){SENTINEL.parent=SENTINEL}function leftRotate(F,w){const D=w.right;D.size_left+=w.size_left+(w.piece?w.piece.length:0),D.lf_left+=w.lf_left+(w.piece?w.piece.lineFeedCnt:0),w.right=D.left,D.left!==SENTINEL&&(D.left.parent=w),D.parent=w.parent,w.parent===SENTINEL?F.root=D:w.parent.left===w?w.parent.left=D:w.parent.right=D,D.left=w,w.parent=D}function rightRotate(F,w){const D=w.left;w.left=D.right,D.right!==SENTINEL&&(D.right.parent=w),D.parent=w.parent,w.size_left-=D.size_left+(D.piece?D.piece.length:0),w.lf_left-=D.lf_left+(D.piece?D.piece.lineFeedCnt:0),w.parent===SENTINEL?F.root=D:w===w.parent.right?w.parent.right=D:w.parent.left=D,D.right=w,w.parent=D}function rbDelete(F,w){let D,O;if(w.left===SENTINEL?(O=w,D=O.right):w.right===SENTINEL?(O=w,D=O.left):(O=leftest(w.right),D=O.right),O===F.root){F.root=D,D.color=0,w.detach(),resetSentinel(),F.root.parent=SENTINEL;return}const W=O.color===1;if(O===O.parent.left?O.parent.left=D:O.parent.right=D,O===w?(D.parent=O.parent,recomputeTreeMetadata(F,D)):(O.parent===w?D.parent=O:D.parent=O.parent,recomputeTreeMetadata(F,D),O.left=w.left,O.right=w.right,O.parent=w.parent,O.color=w.color,w===F.root?F.root=O:w===w.parent.left?w.parent.left=O:w.parent.right=O,O.left!==SENTINEL&&(O.left.parent=O),O.right!==SENTINEL&&(O.right.parent=O),O.size_left=w.size_left,O.lf_left=w.lf_left,recomputeTreeMetadata(F,O)),w.detach(),D.parent.left===D){const K=calculateSize(D),q=calculateLF(D);if(K!==D.parent.size_left||q!==D.parent.lf_left){const G=K-D.parent.size_left,Q=q-D.parent.lf_left;D.parent.size_left=K,D.parent.lf_left=q,updateTreeMetadata(F,D.parent,G,Q)}}if(recomputeTreeMetadata(F,D.parent),W){resetSentinel();return}let U;for(;D!==F.root&&D.color===0;)D===D.parent.left?(U=D.parent.right,U.color===1&&(U.color=0,D.parent.color=1,leftRotate(F,D.parent),U=D.parent.right),U.left.color===0&&U.right.color===0?(U.color=1,D=D.parent):(U.right.color===0&&(U.left.color=0,U.color=1,rightRotate(F,U),U=D.parent.right),U.color=D.parent.color,D.parent.color=0,U.right.color=0,leftRotate(F,D.parent),D=F.root)):(U=D.parent.left,U.color===1&&(U.color=0,D.parent.color=1,rightRotate(F,D.parent),U=D.parent.left),U.left.color===0&&U.right.color===0?(U.color=1,D=D.parent):(U.left.color===0&&(U.right.color=0,U.color=1,leftRotate(F,U),U=D.parent.left),U.color=D.parent.color,D.parent.color=0,U.left.color=0,rightRotate(F,D.parent),D=F.root));D.color=0,resetSentinel()}function fixInsert(F,w){for(recomputeTreeMetadata(F,w);w!==F.root&&w.parent.color===1;)if(w.parent===w.parent.parent.left){const D=w.parent.parent.right;D.color===1?(w.parent.color=0,D.color=0,w.parent.parent.color=1,w=w.parent.parent):(w===w.parent.right&&(w=w.parent,leftRotate(F,w)),w.parent.color=0,w.parent.parent.color=1,rightRotate(F,w.parent.parent))}else{const D=w.parent.parent.left;D.color===1?(w.parent.color=0,D.color=0,w.parent.parent.color=1,w=w.parent.parent):(w===w.parent.left&&(w=w.parent,rightRotate(F,w)),w.parent.color=0,w.parent.parent.color=1,leftRotate(F,w.parent.parent))}F.root.color=0}function updateTreeMetadata(F,w,D,O){for(;w!==F.root&&w!==SENTINEL;)w.parent.left===w&&(w.parent.size_left+=D,w.parent.lf_left+=O),w=w.parent}function recomputeTreeMetadata(F,w){let D=0,O=0;if(w!==F.root){for(;w!==F.root&&w===w.parent.right;)w=w.parent;if(w!==F.root)for(w=w.parent,D=calculateSize(w.left)-w.size_left,O=calculateLF(w.left)-w.lf_left,w.size_left+=D,w.lf_left+=O;w!==F.root&&(D!==0||O!==0);)w.parent.left===w&&(w.parent.size_left+=D,w.parent.lf_left+=O),w=w.parent}}function toUint8(F){return F<0?0:F>255?255:F|0}function toUint32(F){return F<0?0:F>4294967295?4294967295:F|0}class CharacterClassifier{constructor(w){const D=toUint8(w);this._defaultValue=D,this._asciiMap=CharacterClassifier._createAsciiMap(D),this._map=new Map}static _createAsciiMap(w){const D=new Uint8Array(256);return D.fill(w),D}set(w,D){const O=toUint8(D);w>=0&&w<256?this._asciiMap[w]=O:this._map.set(w,O)}get(w){return w>=0&&w<256?this._asciiMap[w]:this._map.get(w)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class CharacterSet{constructor(){this._actual=new CharacterClassifier(0)}add(w){this._actual.set(w,1)}has(w){return this._actual.get(w)===1}clear(){return this._actual.clear()}}class WordCharacterClassifier extends CharacterClassifier{constructor(w,D){super(0),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=D,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let O=0,W=w.length;O<W;O++)this.set(w.charCodeAt(O),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(w,D){let O=null;for(const W of this._getIntlSegmenterWordsOnLine(w)){if(W.index>D)break;O=W}return O}findNextIntlWordAtOrAfterOffset(w,D){for(const O of this._getIntlSegmenterWordsOnLine(w))if(!(O.index<D))return O;return null}_getIntlSegmenterWordsOnLine(w){return this._segmenter?this._cachedLine===w?this._cachedSegments:(this._cachedLine=w,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(w)),this._cachedSegments):[]}_filterWordSegments(w){const D=[];for(const O of w)this._isWordLike(O)&&D.push(O);return D}_isWordLike(w){return!!w.isWordLike}}const wordClassifierCache=new LRUCache(10);function getMapForWordSeparators(F,w){const D=`${F}/${w.join(",")}`;let O=wordClassifierCache.get(D);return O||(O=new WordCharacterClassifier(F,w),wordClassifierCache.set(D,O)),O}const LIMIT_FIND_COUNT$1=999;class SearchParams{constructor(w,D,O,W){this.searchString=w,this.isRegex=D,this.matchCase=O,this.wordSeparators=W}parseSearchRequest(){if(this.searchString==="")return null;let w;this.isRegex?w=isMultilineRegexSource(this.searchString):w=this.searchString.indexOf(`
`)>=0;let D=null;try{D=createRegExp(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:w,global:!0,unicode:!0})}catch{return null}if(!D)return null;let O=!this.isRegex&&!w;return O&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(O=this.matchCase),new SearchData(D,this.wordSeparators?getMapForWordSeparators(this.wordSeparators,[]):null,O?this.searchString:null)}}function isMultilineRegexSource(F){if(!F||F.length===0)return!1;for(let w=0,D=F.length;w<D;w++){const O=F.charCodeAt(w);if(O===10)return!0;if(O===92){if(w++,w>=D)break;const W=F.charCodeAt(w);if(W===110||W===114||W===87)return!0}}return!1}function createFindMatch(F,w,D){if(!D)return new FindMatch(F,null);const O=[];for(let W=0,U=w.length;W<U;W++)O[W]=w[W];return new FindMatch(F,O)}class LineFeedCounter{constructor(w){const D=[];let O=0;for(let W=0,U=w.length;W<U;W++)w.charCodeAt(W)===10&&(D[O++]=W);this._lineFeedsOffsets=D}findLineFeedCountBeforeOffset(w){const D=this._lineFeedsOffsets;let O=0,W=D.length-1;if(W===-1||w<=D[0])return 0;for(;O<W;){const U=O+((W-O)/2>>0);D[U]>=w?W=U-1:D[U+1]>=w?(O=U,W=U):O=U+1}return O+1}}class TextModelSearch{static findMatches(w,D,O,W,U){const K=D.parseSearchRequest();return K?K.regex.multiline?this._doFindMatchesMultiline(w,O,new Searcher(K.wordSeparators,K.regex),W,U):this._doFindMatchesLineByLine(w,O,K,W,U):[]}static _getMultilineMatchRange(w,D,O,W,U,K){let q,G=0;W?(G=W.findLineFeedCountBeforeOffset(U),q=D+U+G):q=D+U;let Q;if(W){const te=W.findLineFeedCountBeforeOffset(U+K.length)-G;Q=q+K.length+te}else Q=q+K.length;const Y=w.getPositionAt(q),X=w.getPositionAt(Q);return new Range$2(Y.lineNumber,Y.column,X.lineNumber,X.column)}static _doFindMatchesMultiline(w,D,O,W,U){const K=w.getOffsetAt(D.getStartPosition()),q=w.getValueInRange(D,1),G=w.getEOL()===`\r
`?new LineFeedCounter(q):null,Q=[];let Y=0,X;for(O.reset(0);X=O.next(q);)if(Q[Y++]=createFindMatch(this._getMultilineMatchRange(w,K,q,G,X.index,X[0]),X,W),Y>=U)return Q;return Q}static _doFindMatchesLineByLine(w,D,O,W,U){const K=[];let q=0;if(D.startLineNumber===D.endLineNumber){const Q=w.getLineContent(D.startLineNumber).substring(D.startColumn-1,D.endColumn-1);return q=this._findMatchesInLine(O,Q,D.startLineNumber,D.startColumn-1,q,K,W,U),K}const G=w.getLineContent(D.startLineNumber).substring(D.startColumn-1);q=this._findMatchesInLine(O,G,D.startLineNumber,D.startColumn-1,q,K,W,U);for(let Q=D.startLineNumber+1;Q<D.endLineNumber&&q<U;Q++)q=this._findMatchesInLine(O,w.getLineContent(Q),Q,0,q,K,W,U);if(q<U){const Q=w.getLineContent(D.endLineNumber).substring(0,D.endColumn-1);q=this._findMatchesInLine(O,Q,D.endLineNumber,0,q,K,W,U)}return K}static _findMatchesInLine(w,D,O,W,U,K,q,G){const Q=w.wordSeparators;if(!q&&w.simpleSearch){const J=w.simpleSearch,te=J.length,ie=D.length;let se=-te;for(;(se=D.indexOf(J,se+te))!==-1;)if((!Q||isValidMatch(Q,D,ie,se,te))&&(K[U++]=new FindMatch(new Range$2(O,se+1+W,O,se+1+te+W),null),U>=G))return U;return U}const Y=new Searcher(w.wordSeparators,w.regex);let X;Y.reset(0);do if(X=Y.next(D),X&&(K[U++]=createFindMatch(new Range$2(O,X.index+1+W,O,X.index+1+X[0].length+W),X,q),U>=G))return U;while(X);return U}static findNextMatch(w,D,O,W){const U=D.parseSearchRequest();if(!U)return null;const K=new Searcher(U.wordSeparators,U.regex);return U.regex.multiline?this._doFindNextMatchMultiline(w,O,K,W):this._doFindNextMatchLineByLine(w,O,K,W)}static _doFindNextMatchMultiline(w,D,O,W){const U=new Position$1(D.lineNumber,1),K=w.getOffsetAt(U),q=w.getLineCount(),G=w.getValueInRange(new Range$2(U.lineNumber,U.column,q,w.getLineMaxColumn(q)),1),Q=w.getEOL()===`\r
`?new LineFeedCounter(G):null;O.reset(D.column-1);const Y=O.next(G);return Y?createFindMatch(this._getMultilineMatchRange(w,K,G,Q,Y.index,Y[0]),Y,W):D.lineNumber!==1||D.column!==1?this._doFindNextMatchMultiline(w,new Position$1(1,1),O,W):null}static _doFindNextMatchLineByLine(w,D,O,W){const U=w.getLineCount(),K=D.lineNumber,q=w.getLineContent(K),G=this._findFirstMatchInLine(O,q,K,D.column,W);if(G)return G;for(let Q=1;Q<=U;Q++){const Y=(K+Q-1)%U,X=w.getLineContent(Y+1),J=this._findFirstMatchInLine(O,X,Y+1,1,W);if(J)return J}return null}static _findFirstMatchInLine(w,D,O,W,U){w.reset(W-1);const K=w.next(D);return K?createFindMatch(new Range$2(O,K.index+1,O,K.index+1+K[0].length),K,U):null}static findPreviousMatch(w,D,O,W){const U=D.parseSearchRequest();if(!U)return null;const K=new Searcher(U.wordSeparators,U.regex);return U.regex.multiline?this._doFindPreviousMatchMultiline(w,O,K,W):this._doFindPreviousMatchLineByLine(w,O,K,W)}static _doFindPreviousMatchMultiline(w,D,O,W){const U=this._doFindMatchesMultiline(w,new Range$2(1,1,D.lineNumber,D.column),O,W,10*LIMIT_FIND_COUNT$1);if(U.length>0)return U[U.length-1];const K=w.getLineCount();return D.lineNumber!==K||D.column!==w.getLineMaxColumn(K)?this._doFindPreviousMatchMultiline(w,new Position$1(K,w.getLineMaxColumn(K)),O,W):null}static _doFindPreviousMatchLineByLine(w,D,O,W){const U=w.getLineCount(),K=D.lineNumber,q=w.getLineContent(K).substring(0,D.column-1),G=this._findLastMatchInLine(O,q,K,W);if(G)return G;for(let Q=1;Q<=U;Q++){const Y=(U+K-Q-1)%U,X=w.getLineContent(Y+1),J=this._findLastMatchInLine(O,X,Y+1,W);if(J)return J}return null}static _findLastMatchInLine(w,D,O,W){let U=null,K;for(w.reset(0);K=w.next(D);)U=createFindMatch(new Range$2(O,K.index+1,O,K.index+1+K[0].length),K,W);return U}}function leftIsWordBounday(F,w,D,O,W){if(O===0)return!0;const U=w.charCodeAt(O-1);if(F.get(U)!==0||U===13||U===10)return!0;if(W>0){const K=w.charCodeAt(O);if(F.get(K)!==0)return!0}return!1}function rightIsWordBounday(F,w,D,O,W){if(O+W===D)return!0;const U=w.charCodeAt(O+W);if(F.get(U)!==0||U===13||U===10)return!0;if(W>0){const K=w.charCodeAt(O+W-1);if(F.get(K)!==0)return!0}return!1}function isValidMatch(F,w,D,O,W){return leftIsWordBounday(F,w,D,O,W)&&rightIsWordBounday(F,w,D,O,W)}class Searcher{constructor(w,D){this._wordSeparators=w,this._searchRegex=D,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(w){this._searchRegex.lastIndex=w,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(w){const D=w.length;let O;do{if(this._prevMatchStartIndex+this._prevMatchLength===D||(O=this._searchRegex.exec(w),!O))return null;const W=O.index,U=O[0].length;if(W===this._prevMatchStartIndex&&U===this._prevMatchLength){if(U===0){getNextCodePoint(w,D,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=W,this._prevMatchLength=U,!this._wordSeparators||isValidMatch(this._wordSeparators,w,D,W,U))return O}while(O);return null}}const AverageBufferSize=65535;function createUintArray(F){let w;return F[F.length-1]<65536?w=new Uint16Array(F.length):w=new Uint32Array(F.length),w.set(F,0),w}class LineStarts{constructor(w,D,O,W,U){this.lineStarts=w,this.cr=D,this.lf=O,this.crlf=W,this.isBasicASCII=U}}function createLineStartsFast(F,w=!0){const D=[0];let O=1;for(let W=0,U=F.length;W<U;W++){const K=F.charCodeAt(W);K===13?W+1<U&&F.charCodeAt(W+1)===10?(D[O++]=W+2,W++):D[O++]=W+1:K===10&&(D[O++]=W+1)}return w?createUintArray(D):D}function createLineStarts(F,w){F.length=0,F[0]=0;let D=1,O=0,W=0,U=0,K=!0;for(let G=0,Q=w.length;G<Q;G++){const Y=w.charCodeAt(G);Y===13?G+1<Q&&w.charCodeAt(G+1)===10?(U++,F[D++]=G+2,G++):(O++,F[D++]=G+1):Y===10?(W++,F[D++]=G+1):K&&Y!==9&&(Y<32||Y>126)&&(K=!1)}const q=new LineStarts(createUintArray(F),O,W,U,K);return F.length=0,q}class Piece{constructor(w,D,O,W,U){this.bufferIndex=w,this.start=D,this.end=O,this.lineFeedCnt=W,this.length=U}}class StringBuffer{constructor(w,D){this.buffer=w,this.lineStarts=D}}class PieceTreeSnapshot{constructor(w,D){this._pieces=[],this._tree=w,this._BOM=D,this._index=0,w.root!==SENTINEL&&w.iterate(w.root,O=>(O!==SENTINEL&&this._pieces.push(O.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class PieceTreeSearchCache{constructor(w){this._limit=w,this._cache=[]}get(w){for(let D=this._cache.length-1;D>=0;D--){const O=this._cache[D];if(O.nodeStartOffset<=w&&O.nodeStartOffset+O.node.piece.length>=w)return O}return null}get2(w){for(let D=this._cache.length-1;D>=0;D--){const O=this._cache[D];if(O.nodeStartLineNumber&&O.nodeStartLineNumber<w&&O.nodeStartLineNumber+O.node.piece.lineFeedCnt>=w)return O}return null}set(w){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(w)}validate(w){let D=!1;const O=this._cache;for(let W=0;W<O.length;W++){const U=O[W];if(U.node.parent===null||U.nodeStartOffset>=w){O[W]=null,D=!0;continue}}if(D){const W=[];for(const U of O)U!==null&&W.push(U);this._cache=W}}}class PieceTreeBase{constructor(w,D,O){this.create(w,D,O)}create(w,D,O){this._buffers=[new StringBuffer("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=SENTINEL,this._lineCnt=1,this._length=0,this._EOL=D,this._EOLLength=D.length,this._EOLNormalized=O;let W=null;for(let U=0,K=w.length;U<K;U++)if(w[U].buffer.length>0){w[U].lineStarts||(w[U].lineStarts=createLineStartsFast(w[U].buffer));const q=new Piece(U+1,{line:0,column:0},{line:w[U].lineStarts.length-1,column:w[U].buffer.length-w[U].lineStarts[w[U].lineStarts.length-1]},w[U].lineStarts.length-1,w[U].buffer.length);this._buffers.push(w[U]),W=this.rbInsertRight(W,q)}this._searchCache=new PieceTreeSearchCache(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(w){const D=AverageBufferSize,O=D-Math.floor(D/3),W=O*2;let U="",K=0;const q=[];if(this.iterate(this.root,G=>{const Q=this.getNodeContent(G),Y=Q.length;if(K<=O||K+Y<W)return U+=Q,K+=Y,!0;const X=U.replace(/\r\n|\r|\n/g,w);return q.push(new StringBuffer(X,createLineStartsFast(X))),U=Q,K=Y,!0}),K>0){const G=U.replace(/\r\n|\r|\n/g,w);q.push(new StringBuffer(G,createLineStartsFast(G)))}this.create(q,w,!0)}getEOL(){return this._EOL}setEOL(w){this._EOL=w,this._EOLLength=this._EOL.length,this.normalizeEOL(w)}createSnapshot(w){return new PieceTreeSnapshot(this,w)}getOffsetAt(w,D){let O=0,W=this.root;for(;W!==SENTINEL;)if(W.left!==SENTINEL&&W.lf_left+1>=w)W=W.left;else if(W.lf_left+W.piece.lineFeedCnt+1>=w){O+=W.size_left;const U=this.getAccumulatedValue(W,w-W.lf_left-2);return O+=U+D-1}else w-=W.lf_left+W.piece.lineFeedCnt,O+=W.size_left+W.piece.length,W=W.right;return O}getPositionAt(w){w=Math.floor(w),w=Math.max(0,w);let D=this.root,O=0;const W=w;for(;D!==SENTINEL;)if(D.size_left!==0&&D.size_left>=w)D=D.left;else if(D.size_left+D.piece.length>=w){const U=this.getIndexOf(D,w-D.size_left);if(O+=D.lf_left+U.index,U.index===0){const K=this.getOffsetAt(O+1,1),q=W-K;return new Position$1(O+1,q+1)}return new Position$1(O+1,U.remainder+1)}else if(w-=D.size_left+D.piece.length,O+=D.lf_left+D.piece.lineFeedCnt,D.right===SENTINEL){const U=this.getOffsetAt(O+1,1),K=W-w-U;return new Position$1(O+1,K+1)}else D=D.right;return new Position$1(1,1)}getValueInRange(w,D){if(w.startLineNumber===w.endLineNumber&&w.startColumn===w.endColumn)return"";const O=this.nodeAt2(w.startLineNumber,w.startColumn),W=this.nodeAt2(w.endLineNumber,w.endColumn),U=this.getValueInRange2(O,W);return D?D!==this._EOL||!this._EOLNormalized?U.replace(/\r\n|\r|\n/g,D):D===this.getEOL()&&this._EOLNormalized?U:U.replace(/\r\n|\r|\n/g,D):U}getValueInRange2(w,D){if(w.node===D.node){const q=w.node,G=this._buffers[q.piece.bufferIndex].buffer,Q=this.offsetInBuffer(q.piece.bufferIndex,q.piece.start);return G.substring(Q+w.remainder,Q+D.remainder)}let O=w.node;const W=this._buffers[O.piece.bufferIndex].buffer,U=this.offsetInBuffer(O.piece.bufferIndex,O.piece.start);let K=W.substring(U+w.remainder,U+O.piece.length);for(O=O.next();O!==SENTINEL;){const q=this._buffers[O.piece.bufferIndex].buffer,G=this.offsetInBuffer(O.piece.bufferIndex,O.piece.start);if(O===D.node){K+=q.substring(G,G+D.remainder);break}else K+=q.substr(G,O.piece.length);O=O.next()}return K}getLinesContent(){const w=[];let D=0,O="",W=!1;return this.iterate(this.root,U=>{if(U===SENTINEL)return!0;const K=U.piece;let q=K.length;if(q===0)return!0;const G=this._buffers[K.bufferIndex].buffer,Q=this._buffers[K.bufferIndex].lineStarts,Y=K.start.line,X=K.end.line;let J=Q[Y]+K.start.column;if(W&&(G.charCodeAt(J)===10&&(J++,q--),w[D++]=O,O="",W=!1,q===0))return!0;if(Y===X)return!this._EOLNormalized&&G.charCodeAt(J+q-1)===13?(W=!0,O+=G.substr(J,q-1)):O+=G.substr(J,q),!0;O+=this._EOLNormalized?G.substring(J,Math.max(J,Q[Y+1]-this._EOLLength)):G.substring(J,Q[Y+1]).replace(/(\r\n|\r|\n)$/,""),w[D++]=O;for(let te=Y+1;te<X;te++)O=this._EOLNormalized?G.substring(Q[te],Q[te+1]-this._EOLLength):G.substring(Q[te],Q[te+1]).replace(/(\r\n|\r|\n)$/,""),w[D++]=O;return!this._EOLNormalized&&G.charCodeAt(Q[X]+K.end.column-1)===13?(W=!0,K.end.column===0?D--:O=G.substr(Q[X],K.end.column-1)):O=G.substr(Q[X],K.end.column),!0}),W&&(w[D++]=O,O=""),w[D++]=O,w}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(w){return this._lastVisitedLine.lineNumber===w?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=w,w===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(w):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(w,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(w).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(w){if(w.remainder===w.node.piece.length){const D=w.node.next();if(!D)return 0;const O=this._buffers[D.piece.bufferIndex],W=this.offsetInBuffer(D.piece.bufferIndex,D.piece.start);return O.buffer.charCodeAt(W)}else{const D=this._buffers[w.node.piece.bufferIndex],W=this.offsetInBuffer(w.node.piece.bufferIndex,w.node.piece.start)+w.remainder;return D.buffer.charCodeAt(W)}}getLineCharCode(w,D){const O=this.nodeAt2(w,D+1);return this._getCharCode(O)}getLineLength(w){if(w===this.getLineCount()){const D=this.getOffsetAt(w,1);return this.getLength()-D}return this.getOffsetAt(w+1,1)-this.getOffsetAt(w,1)-this._EOLLength}findMatchesInNode(w,D,O,W,U,K,q,G,Q,Y,X){const J=this._buffers[w.piece.bufferIndex],te=this.offsetInBuffer(w.piece.bufferIndex,w.piece.start),ie=this.offsetInBuffer(w.piece.bufferIndex,U),se=this.offsetInBuffer(w.piece.bufferIndex,K);let re;const ae={line:0,column:0};let le,de;D._wordSeparators?(le=J.buffer.substring(ie,se),de=oe=>oe+ie,D.reset(0)):(le=J.buffer,de=oe=>oe,D.reset(ie));do if(re=D.next(le),re){if(de(re.index)>=se)return Y;this.positionInBuffer(w,de(re.index)-te,ae);const oe=this.getLineFeedCnt(w.piece.bufferIndex,U,ae),ue=ae.line===U.line?ae.column-U.column+W:ae.column+1,pe=ue+re[0].length;if(X[Y++]=createFindMatch(new Range$2(O+oe,ue,O+oe,pe),re,G),de(re.index)+re[0].length>=se||Y>=Q)return Y}while(re);return Y}findMatchesLineByLine(w,D,O,W){const U=[];let K=0;const q=new Searcher(D.wordSeparators,D.regex);let G=this.nodeAt2(w.startLineNumber,w.startColumn);if(G===null)return[];const Q=this.nodeAt2(w.endLineNumber,w.endColumn);if(Q===null)return[];let Y=this.positionInBuffer(G.node,G.remainder);const X=this.positionInBuffer(Q.node,Q.remainder);if(G.node===Q.node)return this.findMatchesInNode(G.node,q,w.startLineNumber,w.startColumn,Y,X,D,O,W,K,U),U;let J=w.startLineNumber,te=G.node;for(;te!==Q.node;){const se=this.getLineFeedCnt(te.piece.bufferIndex,Y,te.piece.end);if(se>=1){const ae=this._buffers[te.piece.bufferIndex].lineStarts,le=this.offsetInBuffer(te.piece.bufferIndex,te.piece.start),de=ae[Y.line+se],oe=J===w.startLineNumber?w.startColumn:1;if(K=this.findMatchesInNode(te,q,J,oe,Y,this.positionInBuffer(te,de-le),D,O,W,K,U),K>=W)return U;J+=se}const re=J===w.startLineNumber?w.startColumn-1:0;if(J===w.endLineNumber){const ae=this.getLineContent(J).substring(re,w.endColumn-1);return K=this._findMatchesInLine(D,q,ae,w.endLineNumber,re,K,U,O,W),U}if(K=this._findMatchesInLine(D,q,this.getLineContent(J).substr(re),J,re,K,U,O,W),K>=W)return U;J++,G=this.nodeAt2(J,1),te=G.node,Y=this.positionInBuffer(G.node,G.remainder)}if(J===w.endLineNumber){const se=J===w.startLineNumber?w.startColumn-1:0,re=this.getLineContent(J).substring(se,w.endColumn-1);return K=this._findMatchesInLine(D,q,re,w.endLineNumber,se,K,U,O,W),U}const ie=J===w.startLineNumber?w.startColumn:1;return K=this.findMatchesInNode(Q.node,q,J,ie,Y,X,D,O,W,K,U),U}_findMatchesInLine(w,D,O,W,U,K,q,G,Q){const Y=w.wordSeparators;if(!G&&w.simpleSearch){const J=w.simpleSearch,te=J.length,ie=O.length;let se=-te;for(;(se=O.indexOf(J,se+te))!==-1;)if((!Y||isValidMatch(Y,O,ie,se,te))&&(q[K++]=new FindMatch(new Range$2(W,se+1+U,W,se+1+te+U),null),K>=Q))return K;return K}let X;D.reset(0);do if(X=D.next(O),X&&(q[K++]=createFindMatch(new Range$2(W,X.index+1+U,W,X.index+1+X[0].length+U),X,G),K>=Q))return K;while(X);return K}insert(w,D,O=!1){if(this._EOLNormalized=this._EOLNormalized&&O,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==SENTINEL){const{node:W,remainder:U,nodeStartOffset:K}=this.nodeAt(w),q=W.piece,G=q.bufferIndex,Q=this.positionInBuffer(W,U);if(W.piece.bufferIndex===0&&q.end.line===this._lastChangeBufferPos.line&&q.end.column===this._lastChangeBufferPos.column&&K+q.length===w&&D.length<AverageBufferSize){this.appendToNode(W,D),this.computeBufferMetadata();return}if(K===w)this.insertContentToNodeLeft(D,W),this._searchCache.validate(w);else if(K+W.piece.length>w){const Y=[];let X=new Piece(q.bufferIndex,Q,q.end,this.getLineFeedCnt(q.bufferIndex,Q,q.end),this.offsetInBuffer(G,q.end)-this.offsetInBuffer(G,Q));if(this.shouldCheckCRLF()&&this.endWithCR(D)&&this.nodeCharCodeAt(W,U)===10){const se={line:X.start.line+1,column:0};X=new Piece(X.bufferIndex,se,X.end,this.getLineFeedCnt(X.bufferIndex,se,X.end),X.length-1),D+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(D))if(this.nodeCharCodeAt(W,U-1)===13){const se=this.positionInBuffer(W,U-1);this.deleteNodeTail(W,se),D="\r"+D,W.piece.length===0&&Y.push(W)}else this.deleteNodeTail(W,Q);else this.deleteNodeTail(W,Q);const J=this.createNewPieces(D);X.length>0&&this.rbInsertRight(W,X);let te=W;for(let ie=0;ie<J.length;ie++)te=this.rbInsertRight(te,J[ie]);this.deleteNodes(Y)}else this.insertContentToNodeRight(D,W)}else{const W=this.createNewPieces(D);let U=this.rbInsertLeft(null,W[0]);for(let K=1;K<W.length;K++)U=this.rbInsertRight(U,W[K])}this.computeBufferMetadata()}delete(w,D){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",D<=0||this.root===SENTINEL)return;const O=this.nodeAt(w),W=this.nodeAt(w+D),U=O.node,K=W.node;if(U===K){const J=this.positionInBuffer(U,O.remainder),te=this.positionInBuffer(U,W.remainder);if(O.nodeStartOffset===w){if(D===U.piece.length){const ie=U.next();rbDelete(this,U),this.validateCRLFWithPrevNode(ie),this.computeBufferMetadata();return}this.deleteNodeHead(U,te),this._searchCache.validate(w),this.validateCRLFWithPrevNode(U),this.computeBufferMetadata();return}if(O.nodeStartOffset+U.piece.length===w+D){this.deleteNodeTail(U,J),this.validateCRLFWithNextNode(U),this.computeBufferMetadata();return}this.shrinkNode(U,J,te),this.computeBufferMetadata();return}const q=[],G=this.positionInBuffer(U,O.remainder);this.deleteNodeTail(U,G),this._searchCache.validate(w),U.piece.length===0&&q.push(U);const Q=this.positionInBuffer(K,W.remainder);this.deleteNodeHead(K,Q),K.piece.length===0&&q.push(K);const Y=U.next();for(let J=Y;J!==SENTINEL&&J!==K;J=J.next())q.push(J);const X=U.piece.length===0?U.prev():U;this.deleteNodes(q),this.validateCRLFWithNextNode(X),this.computeBufferMetadata()}insertContentToNodeLeft(w,D){const O=[];if(this.shouldCheckCRLF()&&this.endWithCR(w)&&this.startWithLF(D)){const K=D.piece,q={line:K.start.line+1,column:0},G=new Piece(K.bufferIndex,q,K.end,this.getLineFeedCnt(K.bufferIndex,q,K.end),K.length-1);D.piece=G,w+=`
`,updateTreeMetadata(this,D,-1,-1),D.piece.length===0&&O.push(D)}const W=this.createNewPieces(w);let U=this.rbInsertLeft(D,W[W.length-1]);for(let K=W.length-2;K>=0;K--)U=this.rbInsertLeft(U,W[K]);this.validateCRLFWithPrevNode(U),this.deleteNodes(O)}insertContentToNodeRight(w,D){this.adjustCarriageReturnFromNext(w,D)&&(w+=`
`);const O=this.createNewPieces(w),W=this.rbInsertRight(D,O[0]);let U=W;for(let K=1;K<O.length;K++)U=this.rbInsertRight(U,O[K]);this.validateCRLFWithPrevNode(W)}positionInBuffer(w,D,O){const W=w.piece,U=w.piece.bufferIndex,K=this._buffers[U].lineStarts,G=K[W.start.line]+W.start.column+D;let Q=W.start.line,Y=W.end.line,X=0,J=0,te=0;for(;Q<=Y&&(X=Q+(Y-Q)/2|0,te=K[X],X!==Y);)if(J=K[X+1],G<te)Y=X-1;else if(G>=J)Q=X+1;else break;return O?(O.line=X,O.column=G-te,null):{line:X,column:G-te}}getLineFeedCnt(w,D,O){if(O.column===0)return O.line-D.line;const W=this._buffers[w].lineStarts;if(O.line===W.length-1)return O.line-D.line;const U=W[O.line+1],K=W[O.line]+O.column;if(U>K+1)return O.line-D.line;const q=K-1;return this._buffers[w].buffer.charCodeAt(q)===13?O.line-D.line+1:O.line-D.line}offsetInBuffer(w,D){return this._buffers[w].lineStarts[D.line]+D.column}deleteNodes(w){for(let D=0;D<w.length;D++)rbDelete(this,w[D])}createNewPieces(w){if(w.length>AverageBufferSize){const Y=[];for(;w.length>AverageBufferSize;){const J=w.charCodeAt(AverageBufferSize-1);let te;J===13||J>=55296&&J<=56319?(te=w.substring(0,AverageBufferSize-1),w=w.substring(AverageBufferSize-1)):(te=w.substring(0,AverageBufferSize),w=w.substring(AverageBufferSize));const ie=createLineStartsFast(te);Y.push(new Piece(this._buffers.length,{line:0,column:0},{line:ie.length-1,column:te.length-ie[ie.length-1]},ie.length-1,te.length)),this._buffers.push(new StringBuffer(te,ie))}const X=createLineStartsFast(w);return Y.push(new Piece(this._buffers.length,{line:0,column:0},{line:X.length-1,column:w.length-X[X.length-1]},X.length-1,w.length)),this._buffers.push(new StringBuffer(w,X)),Y}let D=this._buffers[0].buffer.length;const O=createLineStartsFast(w,!1);let W=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===D&&D!==0&&this.startWithLF(w)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},W=this._lastChangeBufferPos;for(let Y=0;Y<O.length;Y++)O[Y]+=D+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(O.slice(1)),this._buffers[0].buffer+="_"+w,D+=1}else{if(D!==0)for(let Y=0;Y<O.length;Y++)O[Y]+=D;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(O.slice(1)),this._buffers[0].buffer+=w}const U=this._buffers[0].buffer.length,K=this._buffers[0].lineStarts.length-1,q=U-this._buffers[0].lineStarts[K],G={line:K,column:q},Q=new Piece(0,W,G,this.getLineFeedCnt(0,W,G),U-D);return this._lastChangeBufferPos=G,[Q]}getLineRawContent(w,D=0){let O=this.root,W="";const U=this._searchCache.get2(w);if(U){O=U.node;const K=this.getAccumulatedValue(O,w-U.nodeStartLineNumber-1),q=this._buffers[O.piece.bufferIndex].buffer,G=this.offsetInBuffer(O.piece.bufferIndex,O.piece.start);if(U.nodeStartLineNumber+O.piece.lineFeedCnt===w)W=q.substring(G+K,G+O.piece.length);else{const Q=this.getAccumulatedValue(O,w-U.nodeStartLineNumber);return q.substring(G+K,G+Q-D)}}else{let K=0;const q=w;for(;O!==SENTINEL;)if(O.left!==SENTINEL&&O.lf_left>=w-1)O=O.left;else if(O.lf_left+O.piece.lineFeedCnt>w-1){const G=this.getAccumulatedValue(O,w-O.lf_left-2),Q=this.getAccumulatedValue(O,w-O.lf_left-1),Y=this._buffers[O.piece.bufferIndex].buffer,X=this.offsetInBuffer(O.piece.bufferIndex,O.piece.start);return K+=O.size_left,this._searchCache.set({node:O,nodeStartOffset:K,nodeStartLineNumber:q-(w-1-O.lf_left)}),Y.substring(X+G,X+Q-D)}else if(O.lf_left+O.piece.lineFeedCnt===w-1){const G=this.getAccumulatedValue(O,w-O.lf_left-2),Q=this._buffers[O.piece.bufferIndex].buffer,Y=this.offsetInBuffer(O.piece.bufferIndex,O.piece.start);W=Q.substring(Y+G,Y+O.piece.length);break}else w-=O.lf_left+O.piece.lineFeedCnt,K+=O.size_left+O.piece.length,O=O.right}for(O=O.next();O!==SENTINEL;){const K=this._buffers[O.piece.bufferIndex].buffer;if(O.piece.lineFeedCnt>0){const q=this.getAccumulatedValue(O,0),G=this.offsetInBuffer(O.piece.bufferIndex,O.piece.start);return W+=K.substring(G,G+q-D),W}else{const q=this.offsetInBuffer(O.piece.bufferIndex,O.piece.start);W+=K.substr(q,O.piece.length)}O=O.next()}return W}computeBufferMetadata(){let w=this.root,D=1,O=0;for(;w!==SENTINEL;)D+=w.lf_left+w.piece.lineFeedCnt,O+=w.size_left+w.piece.length,w=w.right;this._lineCnt=D,this._length=O,this._searchCache.validate(this._length)}getIndexOf(w,D){const O=w.piece,W=this.positionInBuffer(w,D),U=W.line-O.start.line;if(this.offsetInBuffer(O.bufferIndex,O.end)-this.offsetInBuffer(O.bufferIndex,O.start)===D){const K=this.getLineFeedCnt(w.piece.bufferIndex,O.start,W);if(K!==U)return{index:K,remainder:0}}return{index:U,remainder:W.column}}getAccumulatedValue(w,D){if(D<0)return 0;const O=w.piece,W=this._buffers[O.bufferIndex].lineStarts,U=O.start.line+D+1;return U>O.end.line?W[O.end.line]+O.end.column-W[O.start.line]-O.start.column:W[U]-W[O.start.line]-O.start.column}deleteNodeTail(w,D){const O=w.piece,W=O.lineFeedCnt,U=this.offsetInBuffer(O.bufferIndex,O.end),K=D,q=this.offsetInBuffer(O.bufferIndex,K),G=this.getLineFeedCnt(O.bufferIndex,O.start,K),Q=G-W,Y=q-U,X=O.length+Y;w.piece=new Piece(O.bufferIndex,O.start,K,G,X),updateTreeMetadata(this,w,Y,Q)}deleteNodeHead(w,D){const O=w.piece,W=O.lineFeedCnt,U=this.offsetInBuffer(O.bufferIndex,O.start),K=D,q=this.getLineFeedCnt(O.bufferIndex,K,O.end),G=this.offsetInBuffer(O.bufferIndex,K),Q=q-W,Y=U-G,X=O.length+Y;w.piece=new Piece(O.bufferIndex,K,O.end,q,X),updateTreeMetadata(this,w,Y,Q)}shrinkNode(w,D,O){const W=w.piece,U=W.start,K=W.end,q=W.length,G=W.lineFeedCnt,Q=D,Y=this.getLineFeedCnt(W.bufferIndex,W.start,Q),X=this.offsetInBuffer(W.bufferIndex,D)-this.offsetInBuffer(W.bufferIndex,U);w.piece=new Piece(W.bufferIndex,W.start,Q,Y,X),updateTreeMetadata(this,w,X-q,Y-G);const J=new Piece(W.bufferIndex,O,K,this.getLineFeedCnt(W.bufferIndex,O,K),this.offsetInBuffer(W.bufferIndex,K)-this.offsetInBuffer(W.bufferIndex,O)),te=this.rbInsertRight(w,J);this.validateCRLFWithPrevNode(te)}appendToNode(w,D){this.adjustCarriageReturnFromNext(D,w)&&(D+=`
`);const O=this.shouldCheckCRLF()&&this.startWithLF(D)&&this.endWithCR(w),W=this._buffers[0].buffer.length;this._buffers[0].buffer+=D;const U=createLineStartsFast(D,!1);for(let te=0;te<U.length;te++)U[te]+=W;if(O){const te=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:W-te}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(U.slice(1));const K=this._buffers[0].lineStarts.length-1,q=this._buffers[0].buffer.length-this._buffers[0].lineStarts[K],G={line:K,column:q},Q=w.piece.length+D.length,Y=w.piece.lineFeedCnt,X=this.getLineFeedCnt(0,w.piece.start,G),J=X-Y;w.piece=new Piece(w.piece.bufferIndex,w.piece.start,G,X,Q),this._lastChangeBufferPos=G,updateTreeMetadata(this,w,D.length,J)}nodeAt(w){let D=this.root;const O=this._searchCache.get(w);if(O)return{node:O.node,nodeStartOffset:O.nodeStartOffset,remainder:w-O.nodeStartOffset};let W=0;for(;D!==SENTINEL;)if(D.size_left>w)D=D.left;else if(D.size_left+D.piece.length>=w){W+=D.size_left;const U={node:D,remainder:w-D.size_left,nodeStartOffset:W};return this._searchCache.set(U),U}else w-=D.size_left+D.piece.length,W+=D.size_left+D.piece.length,D=D.right;return null}nodeAt2(w,D){let O=this.root,W=0;for(;O!==SENTINEL;)if(O.left!==SENTINEL&&O.lf_left>=w-1)O=O.left;else if(O.lf_left+O.piece.lineFeedCnt>w-1){const U=this.getAccumulatedValue(O,w-O.lf_left-2),K=this.getAccumulatedValue(O,w-O.lf_left-1);return W+=O.size_left,{node:O,remainder:Math.min(U+D-1,K),nodeStartOffset:W}}else if(O.lf_left+O.piece.lineFeedCnt===w-1){const U=this.getAccumulatedValue(O,w-O.lf_left-2);if(U+D-1<=O.piece.length)return{node:O,remainder:U+D-1,nodeStartOffset:W};D-=O.piece.length-U;break}else w-=O.lf_left+O.piece.lineFeedCnt,W+=O.size_left+O.piece.length,O=O.right;for(O=O.next();O!==SENTINEL;){if(O.piece.lineFeedCnt>0){const U=this.getAccumulatedValue(O,0),K=this.offsetOfNode(O);return{node:O,remainder:Math.min(D-1,U),nodeStartOffset:K}}else if(O.piece.length>=D-1){const U=this.offsetOfNode(O);return{node:O,remainder:D-1,nodeStartOffset:U}}else D-=O.piece.length;O=O.next()}return null}nodeCharCodeAt(w,D){if(w.piece.lineFeedCnt<1)return-1;const O=this._buffers[w.piece.bufferIndex],W=this.offsetInBuffer(w.piece.bufferIndex,w.piece.start)+D;return O.buffer.charCodeAt(W)}offsetOfNode(w){if(!w)return 0;let D=w.size_left;for(;w!==this.root;)w.parent.right===w&&(D+=w.parent.size_left+w.parent.piece.length),w=w.parent;return D}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(w){if(typeof w=="string")return w.charCodeAt(0)===10;if(w===SENTINEL||w.piece.lineFeedCnt===0)return!1;const D=w.piece,O=this._buffers[D.bufferIndex].lineStarts,W=D.start.line,U=O[W]+D.start.column;return W===O.length-1||O[W+1]>U+1?!1:this._buffers[D.bufferIndex].buffer.charCodeAt(U)===10}endWithCR(w){return typeof w=="string"?w.charCodeAt(w.length-1)===13:w===SENTINEL||w.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(w,w.piece.length-1)===13}validateCRLFWithPrevNode(w){if(this.shouldCheckCRLF()&&this.startWithLF(w)){const D=w.prev();this.endWithCR(D)&&this.fixCRLF(D,w)}}validateCRLFWithNextNode(w){if(this.shouldCheckCRLF()&&this.endWithCR(w)){const D=w.next();this.startWithLF(D)&&this.fixCRLF(w,D)}}fixCRLF(w,D){const O=[],W=this._buffers[w.piece.bufferIndex].lineStarts;let U;w.piece.end.column===0?U={line:w.piece.end.line-1,column:W[w.piece.end.line]-W[w.piece.end.line-1]-1}:U={line:w.piece.end.line,column:w.piece.end.column-1};const K=w.piece.length-1,q=w.piece.lineFeedCnt-1;w.piece=new Piece(w.piece.bufferIndex,w.piece.start,U,q,K),updateTreeMetadata(this,w,-1,-1),w.piece.length===0&&O.push(w);const G={line:D.piece.start.line+1,column:0},Q=D.piece.length-1,Y=this.getLineFeedCnt(D.piece.bufferIndex,G,D.piece.end);D.piece=new Piece(D.piece.bufferIndex,G,D.piece.end,Y,Q),updateTreeMetadata(this,D,-1,-1),D.piece.length===0&&O.push(D);const X=this.createNewPieces(`\r
`);this.rbInsertRight(w,X[0]);for(let J=0;J<O.length;J++)rbDelete(this,O[J])}adjustCarriageReturnFromNext(w,D){if(this.shouldCheckCRLF()&&this.endWithCR(w)){const O=D.next();if(this.startWithLF(O)){if(w+=`
`,O.piece.length===1)rbDelete(this,O);else{const W=O.piece,U={line:W.start.line+1,column:0},K=W.length-1,q=this.getLineFeedCnt(W.bufferIndex,U,W.end);O.piece=new Piece(W.bufferIndex,U,W.end,q,K),updateTreeMetadata(this,O,-1,-1)}return!0}}return!1}iterate(w,D){if(w===SENTINEL)return D(SENTINEL);const O=this.iterate(w.left,D);return O&&D(w)&&this.iterate(w.right,D)}getNodeContent(w){if(w===SENTINEL)return"";const D=this._buffers[w.piece.bufferIndex],O=w.piece,W=this.offsetInBuffer(O.bufferIndex,O.start),U=this.offsetInBuffer(O.bufferIndex,O.end);return D.buffer.substring(W,U)}getPieceContent(w){const D=this._buffers[w.bufferIndex],O=this.offsetInBuffer(w.bufferIndex,w.start),W=this.offsetInBuffer(w.bufferIndex,w.end);return D.buffer.substring(O,W)}rbInsertRight(w,D){const O=new TreeNode(D,1);if(O.left=SENTINEL,O.right=SENTINEL,O.parent=SENTINEL,O.size_left=0,O.lf_left=0,this.root===SENTINEL)this.root=O,O.color=0;else if(w.right===SENTINEL)w.right=O,O.parent=w;else{const U=leftest(w.right);U.left=O,O.parent=U}return fixInsert(this,O),O}rbInsertLeft(w,D){const O=new TreeNode(D,1);if(O.left=SENTINEL,O.right=SENTINEL,O.parent=SENTINEL,O.size_left=0,O.lf_left=0,this.root===SENTINEL)this.root=O,O.color=0;else if(w.left===SENTINEL)w.left=O,O.parent=w;else{const W=righttest(w.left);W.right=O,O.parent=W}return fixInsert(this,O),O}}class PieceTreeTextBuffer extends Disposable{constructor(w,D,O,W,U,K,q){super(),this._onDidChangeContent=this._register(new Emitter$1),this._BOM=D,this._mightContainNonBasicASCII=!K,this._mightContainRTL=W,this._mightContainUnusualLineTerminators=U,this._pieceTree=new PieceTreeBase(w,O,q)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(w){return this._pieceTree.createSnapshot(w?this._BOM:"")}getOffsetAt(w,D){return this._pieceTree.getOffsetAt(w,D)}getPositionAt(w){return this._pieceTree.getPositionAt(w)}getRangeAt(w,D){const O=w+D,W=this.getPositionAt(w),U=this.getPositionAt(O);return new Range$2(W.lineNumber,W.column,U.lineNumber,U.column)}getValueInRange(w,D=0){if(w.isEmpty())return"";const O=this._getEndOfLine(D);return this._pieceTree.getValueInRange(w,O)}getValueLengthInRange(w,D=0){if(w.isEmpty())return 0;if(w.startLineNumber===w.endLineNumber)return w.endColumn-w.startColumn;const O=this.getOffsetAt(w.startLineNumber,w.startColumn),W=this.getOffsetAt(w.endLineNumber,w.endColumn);let U=0;const K=this._getEndOfLine(D),q=this.getEOL();if(K.length!==q.length){const G=K.length-q.length,Q=w.endLineNumber-w.startLineNumber;U=G*Q}return W-O+U}getCharacterCountInRange(w,D=0){if(this._mightContainNonBasicASCII){let O=0;const W=w.startLineNumber,U=w.endLineNumber;for(let K=W;K<=U;K++){const q=this.getLineContent(K),G=K===W?w.startColumn-1:0,Q=K===U?w.endColumn-1:q.length;for(let Y=G;Y<Q;Y++)isHighSurrogate(q.charCodeAt(Y))?(O=O+1,Y=Y+1):O=O+1}return O+=this._getEndOfLine(D).length*(U-W),O}return this.getValueLengthInRange(w,D)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(w){return this._pieceTree.getLineContent(w)}getLineCharCode(w,D){return this._pieceTree.getLineCharCode(w,D)}getLineLength(w){return this._pieceTree.getLineLength(w)}getLineFirstNonWhitespaceColumn(w){const D=firstNonWhitespaceIndex(this.getLineContent(w));return D===-1?0:D+1}getLineLastNonWhitespaceColumn(w){const D=lastNonWhitespaceIndex(this.getLineContent(w));return D===-1?0:D+2}_getEndOfLine(w){switch(w){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(w){this._pieceTree.setEOL(w)}applyEdits(w,D,O){let W=this._mightContainRTL,U=this._mightContainUnusualLineTerminators,K=this._mightContainNonBasicASCII,q=!0,G=[];for(let se=0;se<w.length;se++){const re=w[se];q&&re._isTracked&&(q=!1);const ae=re.range;if(re.text){let pe=!0;K||(pe=!isBasicASCII(re.text),K=pe),!W&&pe&&(W=containsRTL(re.text)),!U&&pe&&(U=containsUnusualLineTerminators(re.text))}let le="",de=0,oe=0,ue=0;if(re.text){let pe;[de,oe,ue,pe]=countEOL(re.text);const fe=this.getEOL();pe===0||pe===(fe===`\r
`?2:1)?le=re.text:le=re.text.replace(/\r\n|\r|\n/g,fe)}G[se]={sortIndex:se,identifier:re.identifier||null,range:ae,rangeOffset:this.getOffsetAt(ae.startLineNumber,ae.startColumn),rangeLength:this.getValueLengthInRange(ae),text:le,eolCount:de,firstLineLength:oe,lastLineLength:ue,forceMoveMarkers:!!re.forceMoveMarkers,isAutoWhitespaceEdit:re.isAutoWhitespaceEdit||!1}}G.sort(PieceTreeTextBuffer._sortOpsAscending);let Q=!1;for(let se=0,re=G.length-1;se<re;se++){const ae=G[se].range.getEndPosition(),le=G[se+1].range.getStartPosition();if(le.isBeforeOrEqual(ae)){if(le.isBefore(ae))throw new Error("Overlapping ranges are not allowed!");Q=!0}}q&&(G=this._reduceOperations(G));const Y=O||D?PieceTreeTextBuffer._getInverseEditRanges(G):[],X=[];if(D)for(let se=0;se<G.length;se++){const re=G[se],ae=Y[se];if(re.isAutoWhitespaceEdit&&re.range.isEmpty())for(let le=ae.startLineNumber;le<=ae.endLineNumber;le++){let de="";le===ae.startLineNumber&&(de=this.getLineContent(re.range.startLineNumber),firstNonWhitespaceIndex(de)!==-1)||X.push({lineNumber:le,oldContent:de})}}let J=null;if(O){let se=0;J=[];for(let re=0;re<G.length;re++){const ae=G[re],le=Y[re],de=this.getValueInRange(ae.range),oe=ae.rangeOffset+se;se+=ae.text.length-de.length,J[re]={sortIndex:ae.sortIndex,identifier:ae.identifier,range:le,text:de,textChange:new TextChange(ae.rangeOffset,de,oe,ae.text)}}Q||J.sort((re,ae)=>re.sortIndex-ae.sortIndex)}this._mightContainRTL=W,this._mightContainUnusualLineTerminators=U,this._mightContainNonBasicASCII=K;const te=this._doApplyEdits(G);let ie=null;if(D&&X.length>0){X.sort((se,re)=>re.lineNumber-se.lineNumber),ie=[];for(let se=0,re=X.length;se<re;se++){const ae=X[se].lineNumber;if(se>0&&X[se-1].lineNumber===ae)continue;const le=X[se].oldContent,de=this.getLineContent(ae);de.length===0||de===le||firstNonWhitespaceIndex(de)!==-1||ie.push(ae)}}return this._onDidChangeContent.fire(),new ApplyEditsResult(J,te,ie)}_reduceOperations(w){return w.length<1e3?w:[this._toSingleEditOperation(w)]}_toSingleEditOperation(w){let D=!1;const O=w[0].range,W=w[w.length-1].range,U=new Range$2(O.startLineNumber,O.startColumn,W.endLineNumber,W.endColumn);let K=O.startLineNumber,q=O.startColumn;const G=[];for(let te=0,ie=w.length;te<ie;te++){const se=w[te],re=se.range;D=D||se.forceMoveMarkers,G.push(this.getValueInRange(new Range$2(K,q,re.startLineNumber,re.startColumn))),se.text.length>0&&G.push(se.text),K=re.endLineNumber,q=re.endColumn}const Q=G.join(""),[Y,X,J]=countEOL(Q);return{sortIndex:0,identifier:w[0].identifier,range:U,rangeOffset:this.getOffsetAt(U.startLineNumber,U.startColumn),rangeLength:this.getValueLengthInRange(U,0),text:Q,eolCount:Y,firstLineLength:X,lastLineLength:J,forceMoveMarkers:D,isAutoWhitespaceEdit:!1}}_doApplyEdits(w){w.sort(PieceTreeTextBuffer._sortOpsDescending);const D=[];for(let O=0;O<w.length;O++){const W=w[O],U=W.range.startLineNumber,K=W.range.startColumn,q=W.range.endLineNumber,G=W.range.endColumn;if(U===q&&K===G&&W.text.length===0)continue;W.text?(this._pieceTree.delete(W.rangeOffset,W.rangeLength),this._pieceTree.insert(W.rangeOffset,W.text,!0)):this._pieceTree.delete(W.rangeOffset,W.rangeLength);const Q=new Range$2(U,K,q,G);D.push({range:Q,rangeLength:W.rangeLength,text:W.text,rangeOffset:W.rangeOffset,forceMoveMarkers:W.forceMoveMarkers})}return D}findMatchesLineByLine(w,D,O,W){return this._pieceTree.findMatchesLineByLine(w,D,O,W)}static _getInverseEditRanges(w){const D=[];let O=0,W=0,U=null;for(let K=0,q=w.length;K<q;K++){const G=w[K];let Q,Y;U?U.range.endLineNumber===G.range.startLineNumber?(Q=O,Y=W+(G.range.startColumn-U.range.endColumn)):(Q=O+(G.range.startLineNumber-U.range.endLineNumber),Y=G.range.startColumn):(Q=G.range.startLineNumber,Y=G.range.startColumn);let X;if(G.text.length>0){const J=G.eolCount+1;J===1?X=new Range$2(Q,Y,Q,Y+G.firstLineLength):X=new Range$2(Q,Y,Q+J-1,G.lastLineLength+1)}else X=new Range$2(Q,Y,Q,Y);O=X.endLineNumber,W=X.endColumn,D.push(X),U=G}return D}static _sortOpsAscending(w,D){const O=Range$2.compareRangesUsingEnds(w.range,D.range);return O===0?w.sortIndex-D.sortIndex:O}static _sortOpsDescending(w,D){const O=Range$2.compareRangesUsingEnds(w.range,D.range);return O===0?D.sortIndex-w.sortIndex:-O}}class PieceTreeTextBufferFactory{constructor(w,D,O,W,U,K,q,G,Q){this._chunks=w,this._bom=D,this._cr=O,this._lf=W,this._crlf=U,this._containsRTL=K,this._containsUnusualLineTerminators=q,this._isBasicASCII=G,this._normalizeEOL=Q}_getEOL(w){const D=this._cr+this._lf+this._crlf,O=this._cr+this._crlf;return D===0?w===1?`
`:`\r
`:O>D/2?`\r
`:`
`}create(w){const D=this._getEOL(w),O=this._chunks;if(this._normalizeEOL&&(D===`\r
`&&(this._cr>0||this._lf>0)||D===`
`&&(this._cr>0||this._crlf>0)))for(let U=0,K=O.length;U<K;U++){const q=O[U].buffer.replace(/\r\n|\r|\n/g,D),G=createLineStartsFast(q);O[U]=new StringBuffer(q,G)}const W=new PieceTreeTextBuffer(O,this._bom,D,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:W,disposable:W}}}class PieceTreeTextBufferBuilder{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(w){if(w.length===0)return;this.chunks.length===0&&startsWithUTF8BOM(w)&&(this.BOM=UTF8_BOM_CHARACTER,w=w.substr(1));const D=w.charCodeAt(w.length-1);D===13||D>=55296&&D<=56319?(this._acceptChunk1(w.substr(0,w.length-1),!1),this._hasPreviousChar=!0,this._previousChar=D):(this._acceptChunk1(w,!1),this._hasPreviousChar=!1,this._previousChar=D)}_acceptChunk1(w,D){!D&&w.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+w):this._acceptChunk2(w))}_acceptChunk2(w){const D=createLineStarts(this._tmpLineStarts,w);this.chunks.push(new StringBuffer(w,D.lineStarts)),this.cr+=D.cr,this.lf+=D.lf,this.crlf+=D.crlf,D.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=containsRTL(w)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=containsUnusualLineTerminators(w)))}finish(w=!0){return this._finish(),new PieceTreeTextBufferFactory(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,w)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const w=this.chunks[this.chunks.length-1];w.buffer+=String.fromCharCode(this._previousChar);const D=createLineStartsFast(w.buffer);w.lineStarts=D,this._previousChar===13&&this.cr++}}}class OffsetRange{static addRange(w,D){let O=0;for(;O<D.length&&D[O].endExclusive<w.start;)O++;let W=O;for(;W<D.length&&D[W].start<=w.endExclusive;)W++;if(O===W)D.splice(O,0,w);else{const U=Math.min(w.start,D[O].start),K=Math.max(w.endExclusive,D[W-1].endExclusive);D.splice(O,W-O,new OffsetRange(U,K))}}static tryCreate(w,D){if(!(w>D))return new OffsetRange(w,D)}static ofLength(w){return new OffsetRange(0,w)}static ofStartAndLength(w,D){return new OffsetRange(w,w+D)}constructor(w,D){if(this.start=w,this.endExclusive=D,w>D)throw new BugIndicatingError(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(w){return new OffsetRange(this.start+w,this.endExclusive+w)}deltaStart(w){return new OffsetRange(this.start+w,this.endExclusive)}deltaEnd(w){return new OffsetRange(this.start,this.endExclusive+w)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}contains(w){return this.start<=w&&w<this.endExclusive}join(w){return new OffsetRange(Math.min(this.start,w.start),Math.max(this.endExclusive,w.endExclusive))}intersect(w){const D=Math.max(this.start,w.start),O=Math.min(this.endExclusive,w.endExclusive);if(D<=O)return new OffsetRange(D,O)}intersects(w){const D=Math.max(this.start,w.start),O=Math.min(this.endExclusive,w.endExclusive);return D<O}isBefore(w){return this.endExclusive<=w.start}isAfter(w){return this.start>=w.endExclusive}slice(w){return w.slice(this.start,this.endExclusive)}substring(w){return w.substring(this.start,this.endExclusive)}clip(w){if(this.isEmpty)throw new BugIndicatingError(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,w))}clipCyclic(w){if(this.isEmpty)throw new BugIndicatingError(`Invalid clipping range: ${this.toString()}`);return w<this.start?this.endExclusive-(this.start-w)%this.length:w>=this.endExclusive?this.start+(w-this.start)%this.length:w}forEach(w){for(let D=this.start;D<this.endExclusive;D++)w(D)}}class OffsetRangeSet{constructor(){this._sortedRanges=[]}addRange(w){let D=0;for(;D<this._sortedRanges.length&&this._sortedRanges[D].endExclusive<w.start;)D++;let O=D;for(;O<this._sortedRanges.length&&this._sortedRanges[O].start<=w.endExclusive;)O++;if(D===O)this._sortedRanges.splice(D,0,w);else{const W=Math.min(w.start,this._sortedRanges[D].start),U=Math.max(w.endExclusive,this._sortedRanges[O-1].endExclusive);this._sortedRanges.splice(D,O-D,new OffsetRange(W,U))}}toString(){return this._sortedRanges.map(w=>w.toString()).join(", ")}intersectsStrict(w){let D=0;for(;D<this._sortedRanges.length&&this._sortedRanges[D].endExclusive<=w.start;)D++;return D<this._sortedRanges.length&&this._sortedRanges[D].start<w.endExclusive}intersectWithRange(w){const D=new OffsetRangeSet;for(const O of this._sortedRanges){const W=O.intersect(w);W&&D.addRange(W)}return D}intersectWithRangeLength(w){return this.intersectWithRange(w).length}get length(){return this._sortedRanges.reduce((w,D)=>w+D.length,0)}}let LineRange$1=class Mn{static fromRangeInclusive(w){return new Mn(w.startLineNumber,w.endLineNumber+1)}static joinMany(w){if(w.length===0)return[];let D=new LineRangeSet(w[0].slice());for(let O=1;O<w.length;O++)D=D.getUnion(new LineRangeSet(w[O].slice()));return D.ranges}static join(w){if(w.length===0)throw new BugIndicatingError("lineRanges cannot be empty");let D=w[0].startLineNumber,O=w[0].endLineNumberExclusive;for(let W=1;W<w.length;W++)D=Math.min(D,w[W].startLineNumber),O=Math.max(O,w[W].endLineNumberExclusive);return new Mn(D,O)}static ofLength(w,D){return new Mn(w,w+D)}static deserialize(w){return new Mn(w[0],w[1])}constructor(w,D){if(w>D)throw new BugIndicatingError(`startLineNumber ${w} cannot be after endLineNumberExclusive ${D}`);this.startLineNumber=w,this.endLineNumberExclusive=D}contains(w){return this.startLineNumber<=w&&w<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(w){return new Mn(this.startLineNumber+w,this.endLineNumberExclusive+w)}deltaLength(w){return new Mn(this.startLineNumber,this.endLineNumberExclusive+w)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(w){return new Mn(Math.min(this.startLineNumber,w.startLineNumber),Math.max(this.endLineNumberExclusive,w.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(w){const D=Math.max(this.startLineNumber,w.startLineNumber),O=Math.min(this.endLineNumberExclusive,w.endLineNumberExclusive);if(D<=O)return new Mn(D,O)}intersectsStrict(w){return this.startLineNumber<w.endLineNumberExclusive&&w.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(w){return this.startLineNumber<=w.endLineNumberExclusive&&w.startLineNumber<=this.endLineNumberExclusive}equals(w){return this.startLineNumber===w.startLineNumber&&this.endLineNumberExclusive===w.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new Range$2(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new Range$2(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(w){const D=[];for(let O=this.startLineNumber;O<this.endLineNumberExclusive;O++)D.push(w(O));return D}forEach(w){for(let D=this.startLineNumber;D<this.endLineNumberExclusive;D++)w(D)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(w){return this.startLineNumber<=w&&w<this.endLineNumberExclusive}toOffsetRange(){return new OffsetRange(this.startLineNumber-1,this.endLineNumberExclusive-1)}};class LineRangeSet{constructor(w=[]){this._normalizedRanges=w}get ranges(){return this._normalizedRanges}addRange(w){if(w.length===0)return;const D=findFirstIdxMonotonousOrArrLen(this._normalizedRanges,W=>W.endLineNumberExclusive>=w.startLineNumber),O=findLastIdxMonotonous(this._normalizedRanges,W=>W.startLineNumber<=w.endLineNumberExclusive)+1;if(D===O)this._normalizedRanges.splice(D,0,w);else if(D===O-1){const W=this._normalizedRanges[D];this._normalizedRanges[D]=W.join(w)}else{const W=this._normalizedRanges[D].join(this._normalizedRanges[O-1]).join(w);this._normalizedRanges.splice(D,O-D,W)}}contains(w){const D=findLastMonotonous(this._normalizedRanges,O=>O.startLineNumber<=w);return!!D&&D.endLineNumberExclusive>w}intersects(w){const D=findLastMonotonous(this._normalizedRanges,O=>O.startLineNumber<w.endLineNumberExclusive);return!!D&&D.endLineNumberExclusive>w.startLineNumber}getUnion(w){if(this._normalizedRanges.length===0)return w;if(w._normalizedRanges.length===0)return this;const D=[];let O=0,W=0,U=null;for(;O<this._normalizedRanges.length||W<w._normalizedRanges.length;){let K=null;if(O<this._normalizedRanges.length&&W<w._normalizedRanges.length){const q=this._normalizedRanges[O],G=w._normalizedRanges[W];q.startLineNumber<G.startLineNumber?(K=q,O++):(K=G,W++)}else O<this._normalizedRanges.length?(K=this._normalizedRanges[O],O++):(K=w._normalizedRanges[W],W++);U===null?U=K:U.endLineNumberExclusive>=K.startLineNumber?U=new LineRange$1(U.startLineNumber,Math.max(U.endLineNumberExclusive,K.endLineNumberExclusive)):(D.push(U),U=K)}return U!==null&&D.push(U),new LineRangeSet(D)}subtractFrom(w){const D=findFirstIdxMonotonousOrArrLen(this._normalizedRanges,K=>K.endLineNumberExclusive>=w.startLineNumber),O=findLastIdxMonotonous(this._normalizedRanges,K=>K.startLineNumber<=w.endLineNumberExclusive)+1;if(D===O)return new LineRangeSet([w]);const W=[];let U=w.startLineNumber;for(let K=D;K<O;K++){const q=this._normalizedRanges[K];q.startLineNumber>U&&W.push(new LineRange$1(U,q.startLineNumber)),U=q.endLineNumberExclusive}return U<w.endLineNumberExclusive&&W.push(new LineRange$1(U,w.endLineNumberExclusive)),new LineRangeSet(W)}toString(){return this._normalizedRanges.map(w=>w.toString()).join(", ")}getIntersection(w){const D=[];let O=0,W=0;for(;O<this._normalizedRanges.length&&W<w._normalizedRanges.length;){const U=this._normalizedRanges[O],K=w._normalizedRanges[W],q=U.intersect(K);q&&!q.isEmpty&&D.push(q),U.endLineNumberExclusive<K.endLineNumberExclusive?O++:W++}return new LineRangeSet(D)}getWithDelta(w){return new LineRangeSet(this._normalizedRanges.map(D=>D.delta(w)))}}let TokenizationRegistry$1=class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(w){this._onDidChange.fire({changedLanguages:w,changedColorMap:!1})}register(w,D){return this._tokenizationSupports.set(w,D),this.handleChange([w]),toDisposable(()=>{this._tokenizationSupports.get(w)===D&&(this._tokenizationSupports.delete(w),this.handleChange([w]))})}get(w){return this._tokenizationSupports.get(w)||null}registerFactory(w,D){this._factories.get(w)?.dispose();const O=new TokenizationSupportFactoryData(this,w,D);return this._factories.set(w,O),toDisposable(()=>{const W=this._factories.get(w);!W||W!==O||(this._factories.delete(w),W.dispose())})}async getOrCreate(w){const D=this.get(w);if(D)return D;const O=this._factories.get(w);return!O||O.isResolved?null:(await O.resolve(),this.get(w))}isResolved(w){if(this.get(w))return!0;const O=this._factories.get(w);return!!(!O||O.isResolved)}setColorMap(w){this._colorMap=w,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};class TokenizationSupportFactoryData extends Disposable{get isResolved(){return this._isResolved}constructor(w,D,O){super(),this._registry=w,this._languageId=D,this._factory=O,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const w=await this._factory.tokenizationSupport;this._isResolved=!0,w&&!this._isDisposed&&this._register(this._registry.register(this._languageId,w))}}let Token$1=class{constructor(w,D,O){this.offset=w,this.type=D,this.language=O,this._tokenBrand=void 0}toString(){return"("+this.offset+", "+this.type+")"}};class TokenizationResult{constructor(w,D){this.tokens=w,this.endState=D,this._tokenizationResultBrand=void 0}}class EncodedTokenizationResult{constructor(w,D){this.tokens=w,this.endState=D,this._encodedTokenizationResultBrand=void 0}}var HoverVerbosityAction$1;(function(F){F[F.Increase=0]="Increase",F[F.Decrease=1]="Decrease"})(HoverVerbosityAction$1||(HoverVerbosityAction$1={}));var CompletionItemKinds;(function(F){const w=new Map;w.set(0,Codicon.symbolMethod),w.set(1,Codicon.symbolFunction),w.set(2,Codicon.symbolConstructor),w.set(3,Codicon.symbolField),w.set(4,Codicon.symbolVariable),w.set(5,Codicon.symbolClass),w.set(6,Codicon.symbolStruct),w.set(7,Codicon.symbolInterface),w.set(8,Codicon.symbolModule),w.set(9,Codicon.symbolProperty),w.set(10,Codicon.symbolEvent),w.set(11,Codicon.symbolOperator),w.set(12,Codicon.symbolUnit),w.set(13,Codicon.symbolValue),w.set(15,Codicon.symbolEnum),w.set(14,Codicon.symbolConstant),w.set(15,Codicon.symbolEnum),w.set(16,Codicon.symbolEnumMember),w.set(17,Codicon.symbolKeyword),w.set(27,Codicon.symbolSnippet),w.set(18,Codicon.symbolText),w.set(19,Codicon.symbolColor),w.set(20,Codicon.symbolFile),w.set(21,Codicon.symbolReference),w.set(22,Codicon.symbolCustomColor),w.set(23,Codicon.symbolFolder),w.set(24,Codicon.symbolTypeParameter),w.set(25,Codicon.account),w.set(26,Codicon.issues);function D(U){let K=w.get(U);return K||(console.info("No codicon found for CompletionItemKind "+U),K=Codicon.symbolProperty),K}F.toIcon=D;const O=new Map;O.set("method",0),O.set("function",1),O.set("constructor",2),O.set("field",3),O.set("variable",4),O.set("class",5),O.set("struct",6),O.set("interface",7),O.set("module",8),O.set("property",9),O.set("event",10),O.set("operator",11),O.set("unit",12),O.set("value",13),O.set("constant",14),O.set("enum",15),O.set("enum-member",16),O.set("enumMember",16),O.set("keyword",17),O.set("snippet",27),O.set("text",18),O.set("color",19),O.set("file",20),O.set("reference",21),O.set("customcolor",22),O.set("folder",23),O.set("type-parameter",24),O.set("typeParameter",24),O.set("account",25),O.set("issue",26);function W(U,K){let q=O.get(U);return typeof q>"u"&&!K&&(q=9),q}F.fromString=W})(CompletionItemKinds||(CompletionItemKinds={}));var InlineCompletionTriggerKind$1;(function(F){F[F.Automatic=0]="Automatic",F[F.Explicit=1]="Explicit"})(InlineCompletionTriggerKind$1||(InlineCompletionTriggerKind$1={}));class SelectedSuggestionInfo{constructor(w,D,O,W){this.range=w,this.text=D,this.completionKind=O,this.isSnippetText=W}equals(w){return Range$2.lift(this.range).equalsRange(w.range)&&this.text===w.text&&this.completionKind===w.completionKind&&this.isSnippetText===w.isSnippetText}}var DocumentPasteTriggerKind;(function(F){F[F.Automatic=0]="Automatic",F[F.PasteAs=1]="PasteAs"})(DocumentPasteTriggerKind||(DocumentPasteTriggerKind={}));var SignatureHelpTriggerKind$1;(function(F){F[F.Invoke=1]="Invoke",F[F.TriggerCharacter=2]="TriggerCharacter",F[F.ContentChange=3]="ContentChange"})(SignatureHelpTriggerKind$1||(SignatureHelpTriggerKind$1={}));var DocumentHighlightKind$1;(function(F){F[F.Text=0]="Text",F[F.Read=1]="Read",F[F.Write=2]="Write"})(DocumentHighlightKind$1||(DocumentHighlightKind$1={}));localize("Array","array"),localize("Boolean","boolean"),localize("Class","class"),localize("Constant","constant"),localize("Constructor","constructor"),localize("Enum","enumeration"),localize("EnumMember","enumeration member"),localize("Event","event"),localize("Field","field"),localize("File","file"),localize("Function","function"),localize("Interface","interface"),localize("Key","key"),localize("Method","method"),localize("Module","module"),localize("Namespace","namespace"),localize("Null","null"),localize("Number","number"),localize("Object","object"),localize("Operator","operator"),localize("Package","package"),localize("Property","property"),localize("String","string"),localize("Struct","struct"),localize("TypeParameter","type parameter"),localize("Variable","variable");var SymbolKinds;(function(F){const w=new Map;w.set(0,Codicon.symbolFile),w.set(1,Codicon.symbolModule),w.set(2,Codicon.symbolNamespace),w.set(3,Codicon.symbolPackage),w.set(4,Codicon.symbolClass),w.set(5,Codicon.symbolMethod),w.set(6,Codicon.symbolProperty),w.set(7,Codicon.symbolField),w.set(8,Codicon.symbolConstructor),w.set(9,Codicon.symbolEnum),w.set(10,Codicon.symbolInterface),w.set(11,Codicon.symbolFunction),w.set(12,Codicon.symbolVariable),w.set(13,Codicon.symbolConstant),w.set(14,Codicon.symbolString),w.set(15,Codicon.symbolNumber),w.set(16,Codicon.symbolBoolean),w.set(17,Codicon.symbolArray),w.set(18,Codicon.symbolObject),w.set(19,Codicon.symbolKey),w.set(20,Codicon.symbolNull),w.set(21,Codicon.symbolEnumMember),w.set(22,Codicon.symbolStruct),w.set(23,Codicon.symbolEvent),w.set(24,Codicon.symbolOperator),w.set(25,Codicon.symbolTypeParameter);function D(O){let W=w.get(O);return W||(console.info("No codicon found for SymbolKind "+O),W=Codicon.symbolProperty),W}F.toIcon=D})(SymbolKinds||(SymbolKinds={}));class FoldingRangeKind{static{this.Comment=new FoldingRangeKind("comment")}static{this.Imports=new FoldingRangeKind("imports")}static{this.Region=new FoldingRangeKind("region")}static fromValue(w){switch(w){case"comment":return FoldingRangeKind.Comment;case"imports":return FoldingRangeKind.Imports;case"region":return FoldingRangeKind.Region}return new FoldingRangeKind(w)}constructor(w){this.value=w}}var NewSymbolNameTag$1;(function(F){F[F.AIGenerated=1]="AIGenerated"})(NewSymbolNameTag$1||(NewSymbolNameTag$1={}));var NewSymbolNameTriggerKind$1;(function(F){F[F.Invoke=0]="Invoke",F[F.Automatic=1]="Automatic"})(NewSymbolNameTriggerKind$1||(NewSymbolNameTriggerKind$1={}));var Command;(function(F){function w(D){return!D||typeof D!="object"?!1:typeof D.id=="string"&&typeof D.title=="string"}F.is=w})(Command||(Command={}));var InlayHintKind$1;(function(F){F[F.Type=1]="Type",F[F.Parameter=2]="Parameter"})(InlayHintKind$1||(InlayHintKind$1={}));class LazyTokenizationSupport{constructor(w){this.createSupport=w,this._tokenizationSupport=null}dispose(){this._tokenizationSupport&&this._tokenizationSupport.then(w=>{w&&w.dispose()})}get tokenizationSupport(){return this._tokenizationSupport||(this._tokenizationSupport=this.createSupport()),this._tokenizationSupport}}const TokenizationRegistry=new TokenizationRegistry$1,TreeSitterTokenizationRegistry=new TokenizationRegistry$1;var InlineEditTriggerKind$1;(function(F){F[F.Invoke=0]="Invoke",F[F.Automatic=1]="Automatic"})(InlineEditTriggerKind$1||(InlineEditTriggerKind$1={}));const NullState=new class{clone(){return this}equals(F){return this===F}};function nullTokenize(F,w){return new TokenizationResult([new Token$1(0,"",F)],w)}function nullTokenizeEncoded(F,w){const D=new Uint32Array(2);return D[0]=0,D[1]=(F<<0|0|0|32768|2<<24)>>>0,new EncodedTokenizationResult(D,w===null?NullState:w)}class FixedArray{constructor(w){this._default=w,this._store=[]}get(w){return w<this._store.length?this._store[w]:this._default}set(w,D){for(;w>=this._store.length;)this._store[this._store.length]=this._default;this._store[w]=D}replace(w,D,O){if(w>=this._store.length)return;if(D===0){this.insert(w,O);return}else if(O===0){this.delete(w,D);return}const W=this._store.slice(0,w),U=this._store.slice(w+D),K=arrayFill(O,this._default);this._store=W.concat(K,U)}delete(w,D){D===0||w>=this._store.length||this._store.splice(w,D)}insert(w,D){if(D===0||w>=this._store.length)return;const O=[];for(let W=0;W<D;W++)O[W]=this._default;this._store=arrayInsert(this._store,w,O)}}function arrayFill(F,w){const D=[];for(let O=0;O<F;O++)D[O]=w;return D}class ContiguousMultilineTokens{get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(w,D){this._startLineNumber=w,this._tokens=D}getLineTokens(w){return this._tokens[w-this._startLineNumber]}appendLineTokens(w){this._tokens.push(w)}}class ContiguousMultilineTokensBuilder{constructor(){this._tokens=[]}add(w,D){if(this._tokens.length>0){const O=this._tokens[this._tokens.length-1];if(O.endLineNumber+1===w){O.appendLineTokens(D);return}}this._tokens.push(new ContiguousMultilineTokens(w,[D]))}finalize(){return this._tokens}}class LineTokens{static{this.defaultTokenMetadata=(32768|2<<24)>>>0}static createEmpty(w,D){const O=LineTokens.defaultTokenMetadata,W=new Uint32Array(2);return W[0]=w.length,W[1]=O,new LineTokens(W,w,D)}static createFromTextAndMetadata(w,D){let O=0,W="";const U=new Array;for(const{text:K,metadata:q}of w)U.push(O+K.length,q),O+=K.length,W+=K;return new LineTokens(new Uint32Array(U),W,D)}constructor(w,D,O){this._lineTokensBrand=void 0,this._tokens=w,this._tokensCount=this._tokens.length>>>1,this._text=D,this.languageIdCodec=O}equals(w){return w instanceof LineTokens?this.slicedEquals(w,0,this._tokensCount):!1}slicedEquals(w,D,O){if(this._text!==w._text||this._tokensCount!==w._tokensCount)return!1;const W=D<<1,U=W+(O<<1);for(let K=W;K<U;K++)if(this._tokens[K]!==w._tokens[K])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(w){return w>0?this._tokens[w-1<<1]:0}getMetadata(w){return this._tokens[(w<<1)+1]}getLanguageId(w){const D=this._tokens[(w<<1)+1],O=TokenMetadata.getLanguageId(D);return this.languageIdCodec.decodeLanguageId(O)}getStandardTokenType(w){const D=this._tokens[(w<<1)+1];return TokenMetadata.getTokenType(D)}getForeground(w){const D=this._tokens[(w<<1)+1];return TokenMetadata.getForeground(D)}getClassName(w){const D=this._tokens[(w<<1)+1];return TokenMetadata.getClassNameFromMetadata(D)}getInlineStyle(w,D){const O=this._tokens[(w<<1)+1];return TokenMetadata.getInlineStyleFromMetadata(O,D)}getPresentation(w){const D=this._tokens[(w<<1)+1];return TokenMetadata.getPresentationFromMetadata(D)}getEndOffset(w){return this._tokens[w<<1]}findTokenIndexAtOffset(w){return LineTokens.findIndexInTokensArray(this._tokens,w)}inflate(){return this}sliceAndInflate(w,D,O){return new SliceLineTokens(this,w,D,O)}static convertToEndOffset(w,D){const W=(w.length>>>1)-1;for(let U=0;U<W;U++)w[U<<1]=w[U+1<<1];w[W<<1]=D}static findIndexInTokensArray(w,D){if(w.length<=2)return 0;let O=0,W=(w.length>>>1)-1;for(;O<W;){const U=O+Math.floor((W-O)/2),K=w[U<<1];if(K===D)return U+1;K<D?O=U+1:K>D&&(W=U)}return O}withInserted(w){if(w.length===0)return this;let D=0,O=0,W="";const U=new Array;let K=0;for(;;){const q=D<this._tokensCount?this._tokens[D<<1]:-1,G=O<w.length?w[O]:null;if(q!==-1&&(G===null||q<=G.offset)){W+=this._text.substring(K,q);const Q=this._tokens[(D<<1)+1];U.push(W.length,Q),D++,K=q}else if(G){if(G.offset>K){W+=this._text.substring(K,G.offset);const Q=this._tokens[(D<<1)+1];U.push(W.length,Q),K=G.offset}W+=G.text,U.push(W.length,G.tokenMetadata),O++}else break}return new LineTokens(new Uint32Array(U),W,this.languageIdCodec)}getTokenText(w){const D=this.getStartOffset(w),O=this.getEndOffset(w);return this._text.substring(D,O)}forEach(w){const D=this.getCount();for(let O=0;O<D;O++)w(O)}}class SliceLineTokens{constructor(w,D,O,W){this._source=w,this._startOffset=D,this._endOffset=O,this._deltaOffset=W,this._firstTokenIndex=w.findTokenIndexAtOffset(D),this.languageIdCodec=w.languageIdCodec,this._tokensCount=0;for(let U=this._firstTokenIndex,K=w.getCount();U<K&&!(w.getStartOffset(U)>=O);U++)this._tokensCount++}getMetadata(w){return this._source.getMetadata(this._firstTokenIndex+w)}getLanguageId(w){return this._source.getLanguageId(this._firstTokenIndex+w)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(w){return w instanceof SliceLineTokens?this._startOffset===w._startOffset&&this._endOffset===w._endOffset&&this._deltaOffset===w._deltaOffset&&this._source.slicedEquals(w._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(w){return this._source.getStandardTokenType(this._firstTokenIndex+w)}getForeground(w){return this._source.getForeground(this._firstTokenIndex+w)}getEndOffset(w){const D=this._source.getEndOffset(this._firstTokenIndex+w);return Math.min(this._endOffset,D)-this._startOffset+this._deltaOffset}getClassName(w){return this._source.getClassName(this._firstTokenIndex+w)}getInlineStyle(w,D){return this._source.getInlineStyle(this._firstTokenIndex+w,D)}getPresentation(w){return this._source.getPresentation(this._firstTokenIndex+w)}findTokenIndexAtOffset(w){return this._source.findTokenIndexAtOffset(w+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(w){const D=this._firstTokenIndex+w,O=this._source.getStartOffset(D),W=this._source.getEndOffset(D);let U=this._source.getTokenText(D);return O<this._startOffset&&(U=U.substring(this._startOffset-O)),W>this._endOffset&&(U=U.substring(0,U.length-(W-this._endOffset))),U}forEach(w){for(let D=0;D<this.getCount();D++)w(D)}}class TokenizerWithStateStore{constructor(w,D){this.tokenizationSupport=D,this.initialState=this.tokenizationSupport.getInitialState(),this.store=new TrackingTokenizationStateStore(w)}getStartState(w){return this.store.getStartState(w,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}}class TokenizerWithStateStoreAndTextModel extends TokenizerWithStateStore{constructor(w,D,O,W){super(w,D),this._textModel=O,this._languageIdCodec=W}updateTokensUntilLine(w,D){const O=this._textModel.getLanguageId();for(;;){const W=this.getFirstInvalidLine();if(!W||W.lineNumber>D)break;const U=this._textModel.getLineContent(W.lineNumber),K=safeTokenize(this._languageIdCodec,O,this.tokenizationSupport,U,!0,W.startState);w.add(W.lineNumber,K.tokens),this.store.setEndState(W.lineNumber,K.endState)}}getTokenTypeIfInsertingCharacter(w,D){const O=this.getStartState(w.lineNumber);if(!O)return 0;const W=this._textModel.getLanguageId(),U=this._textModel.getLineContent(w.lineNumber),K=U.substring(0,w.column-1)+D+U.substring(w.column-1),q=safeTokenize(this._languageIdCodec,W,this.tokenizationSupport,K,!0,O),G=new LineTokens(q.tokens,K,this._languageIdCodec);if(G.getCount()===0)return 0;const Q=G.findTokenIndexAtOffset(w.column-1);return G.getStandardTokenType(Q)}tokenizeLineWithEdit(w,D,O){const W=w.lineNumber,U=w.column,K=this.getStartState(W);if(!K)return null;const q=this._textModel.getLineContent(W),G=q.substring(0,U-1)+O+q.substring(U-1+D),Q=this._textModel.getLanguageIdAtPosition(W,0),Y=safeTokenize(this._languageIdCodec,Q,this.tokenizationSupport,G,!0,K);return new LineTokens(Y.tokens,G,this._languageIdCodec)}hasAccurateTokensForLine(w){const D=this.store.getFirstInvalidEndStateLineNumberOrMax();return w<D}isCheapToTokenize(w){const D=this.store.getFirstInvalidEndStateLineNumberOrMax();return w<D||w===D&&this._textModel.getLineLength(w)<2048}tokenizeHeuristically(w,D,O){if(O<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(D<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(w,O),{heuristicTokens:!1};let W=this.guessStartState(D);const U=this._textModel.getLanguageId();for(let K=D;K<=O;K++){const q=this._textModel.getLineContent(K),G=safeTokenize(this._languageIdCodec,U,this.tokenizationSupport,q,!0,W);w.add(K,G.tokens),W=G.endState}return{heuristicTokens:!0}}guessStartState(w){let D=this._textModel.getLineFirstNonWhitespaceColumn(w);const O=[];let W=null;for(let q=w-1;D>1&&q>=1;q--){const G=this._textModel.getLineFirstNonWhitespaceColumn(q);if(G!==0&&G<D&&(O.push(this._textModel.getLineContent(q)),D=G,W=this.getStartState(q),W))break}W||(W=this.tokenizationSupport.getInitialState()),O.reverse();const U=this._textModel.getLanguageId();let K=W;for(const q of O)K=safeTokenize(this._languageIdCodec,U,this.tokenizationSupport,q,!1,K).endState;return K}}class TrackingTokenizationStateStore{constructor(w){this.lineCount=w,this._tokenizationStateStore=new TokenizationStateStore,this._invalidEndStatesLineNumbers=new RangePriorityQueueImpl,this._invalidEndStatesLineNumbers.addRange(new OffsetRange(1,w+1))}getEndState(w){return this._tokenizationStateStore.getEndState(w)}setEndState(w,D){if(!D)throw new BugIndicatingError("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(w);const O=this._tokenizationStateStore.setEndState(w,D);return O&&w<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new OffsetRange(w+1,w+2)),O}acceptChange(w,D){this.lineCount+=D-w.length,this._tokenizationStateStore.acceptChange(w,D),this._invalidEndStatesLineNumbers.addRangeAndResize(new OffsetRange(w.startLineNumber,w.endLineNumberExclusive),D)}acceptChanges(w){for(const D of w){const[O]=countEOL(D.text);this.acceptChange(new LineRange$1(D.range.startLineNumber,D.range.endLineNumber+1),O+1)}}invalidateEndStateRange(w){this._invalidEndStatesLineNumbers.addRange(new OffsetRange(w.startLineNumber,w.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(w,D){return w===1?D:this.getEndState(w-1)}getFirstInvalidLine(w){const D=this.getFirstInvalidEndStateLineNumber();if(D===null)return null;const O=this.getStartState(D,w);if(!O)throw new BugIndicatingError("Start state must be defined");return{lineNumber:D,startState:O}}}class TokenizationStateStore{constructor(){this._lineEndStates=new FixedArray(null)}getEndState(w){return this._lineEndStates.get(w)}setEndState(w,D){const O=this._lineEndStates.get(w);return O&&O.equals(D)?!1:(this._lineEndStates.set(w,D),!0)}acceptChange(w,D){let O=w.length;D>0&&O>0&&(O--,D--),this._lineEndStates.replace(w.startLineNumber,O,D)}}class RangePriorityQueueImpl{constructor(){this._ranges=[]}get min(){return this._ranges.length===0?null:this._ranges[0].start}delete(w){const D=this._ranges.findIndex(O=>O.contains(w));if(D!==-1){const O=this._ranges[D];O.start===w?O.endExclusive===w+1?this._ranges.splice(D,1):this._ranges[D]=new OffsetRange(w+1,O.endExclusive):O.endExclusive===w+1?this._ranges[D]=new OffsetRange(O.start,w):this._ranges.splice(D,1,new OffsetRange(O.start,w),new OffsetRange(w+1,O.endExclusive))}}addRange(w){OffsetRange.addRange(w,this._ranges)}addRangeAndResize(w,D){let O=0;for(;!(O>=this._ranges.length||w.start<=this._ranges[O].endExclusive);)O++;let W=O;for(;!(W>=this._ranges.length||w.endExclusive<this._ranges[W].start);)W++;const U=D-w.length;for(let K=W;K<this._ranges.length;K++)this._ranges[K]=this._ranges[K].delta(U);if(O===W){const K=new OffsetRange(w.start,w.start+D);K.isEmpty||this._ranges.splice(O,0,K)}else{const K=Math.min(w.start,this._ranges[O].start),q=Math.max(w.endExclusive,this._ranges[W-1].endExclusive),G=new OffsetRange(K,q+U);G.isEmpty?this._ranges.splice(O,W-O):this._ranges.splice(O,W-O,G)}}toString(){return this._ranges.map(w=>w.toString()).join(" + ")}}function safeTokenize(F,w,D,O,W,U){let K=null;if(D)try{K=D.tokenizeEncoded(O,W,U.clone())}catch(q){onUnexpectedError(q)}return K||(K=nullTokenizeEncoded(F.encodeLanguageId(w),U)),LineTokens.convertToEndOffset(K.tokens,O.length),K}class DefaultBackgroundTokenizer{constructor(w,D){this._tokenizerWithStateStore=w,this._backgroundTokenStore=D,this._isDisposed=!1,this._isScheduled=!1}dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,runWhenGlobalIdle(w=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(w)}))}_backgroundTokenizeWithDeadline(w){const D=Date.now()+w.timeRemaining(),O=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<D?setTimeout0(O):this._beginBackgroundTokenization())};O()}_backgroundTokenizeForAtLeast1ms(){const w=this._tokenizerWithStateStore._textModel.getLineCount(),D=new ContiguousMultilineTokensBuilder,O=StopWatch.create(!1);do if(O.elapsed()>1||this._tokenizeOneInvalidLine(D)>=w)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(D.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(w){const D=this._tokenizerWithStateStore?.getFirstInvalidLine();return D?(this._tokenizerWithStateStore.updateTokensUntilLine(w,D.lineNumber),D.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(w,D){this._tokenizerWithStateStore.store.invalidateEndStateRange(new LineRange$1(w,D))}}class AttachedViews{constructor(){this._onDidChangeVisibleRanges=new Emitter$1,this.onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event,this._views=new Set}attachView(){const w=new AttachedViewImpl(D=>{this._onDidChangeVisibleRanges.fire({view:w,state:D})});return this._views.add(w),w}detachView(w){this._views.delete(w),this._onDidChangeVisibleRanges.fire({view:w,state:void 0})}}class AttachedViewImpl{constructor(w){this.handleStateChange=w}setVisibleLines(w,D){const O=w.map(W=>new LineRange$1(W.startLineNumber,W.endLineNumber+1));this.handleStateChange({visibleLineRanges:O,stabilized:D})}}class AttachedViewHandler extends Disposable{get lineRanges(){return this._lineRanges}constructor(w){super(),this._refreshTokens=w,this.runner=this._register(new RunOnceScheduler(()=>this.update(),50)),this._computedLineRanges=[],this._lineRanges=[]}update(){equals$1(this._computedLineRanges,this._lineRanges,(w,D)=>w.equals(D))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(w){this._lineRanges=w.visibleLineRanges,w.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}}class AbstractTokens extends Disposable{get backgroundTokenizationState(){return this._backgroundTokenizationState}constructor(w,D,O){super(),this._languageIdCodec=w,this._textModel=D,this.getLanguageId=O,this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new Emitter$1),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event,this._onDidChangeTokens=this._register(new Emitter$1),this.onDidChangeTokens=this._onDidChangeTokens.event}tokenizeIfCheap(w){this.isCheapToTokenize(w)&&this.forceTokenization(w)}}class TreeSitterTokens extends AbstractTokens{constructor(w,D,O,W){super(D,O,W),this._treeSitterService=w,this._tokenizationSupport=null,this._initialize()}_initialize(){const w=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==w)&&(this._lastLanguageId=w,this._tokenizationSupport=TreeSitterTokenizationRegistry.get(w))}getLineTokens(w){const D=this._textModel.getLineContent(w);if(this._tokenizationSupport){const O=this._tokenizationSupport.tokenizeEncoded(w,this._textModel);if(O)return new LineTokens(O,D,this._languageIdCodec)}return LineTokens.createEmpty(D,this._languageIdCodec)}resetTokenization(w=!0){w&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(w){w.isFlush&&this.resetTokenization(!1)}forceTokenization(w){}hasAccurateTokensForLine(w){return!0}isCheapToTokenize(w){return!0}getTokenTypeIfInsertingCharacter(w,D,O){return 0}tokenizeLineWithEdit(w,D,O){return null}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}}const ITreeSitterParserService=createDecorator("treeSitterParserService"),EMPTY_LINE_TOKENS=new Uint32Array(0).buffer;class ContiguousTokensEditing{static deleteBeginning(w,D){return w===null||w===EMPTY_LINE_TOKENS?w:ContiguousTokensEditing.delete(w,0,D)}static deleteEnding(w,D){if(w===null||w===EMPTY_LINE_TOKENS)return w;const O=toUint32Array(w),W=O[O.length-2];return ContiguousTokensEditing.delete(w,D,W)}static delete(w,D,O){if(w===null||w===EMPTY_LINE_TOKENS||D===O)return w;const W=toUint32Array(w),U=W.length>>>1;if(D===0&&W[W.length-2]===O)return EMPTY_LINE_TOKENS;const K=LineTokens.findIndexInTokensArray(W,D),q=K>0?W[K-1<<1]:0,G=W[K<<1];if(O<G){const te=O-D;for(let ie=K;ie<U;ie++)W[ie<<1]-=te;return w}let Q,Y;q!==D?(W[K<<1]=D,Q=K+1<<1,Y=D):(Q=K<<1,Y=q);const X=O-D;for(let te=K+1;te<U;te++){const ie=W[te<<1]-X;ie>Y&&(W[Q++]=ie,W[Q++]=W[(te<<1)+1],Y=ie)}if(Q===W.length)return w;const J=new Uint32Array(Q);return J.set(W.subarray(0,Q),0),J.buffer}static append(w,D){if(D===EMPTY_LINE_TOKENS)return w;if(w===EMPTY_LINE_TOKENS)return D;if(w===null)return w;if(D===null)return null;const O=toUint32Array(w),W=toUint32Array(D),U=W.length>>>1,K=new Uint32Array(O.length+W.length);K.set(O,0);let q=O.length;const G=O[O.length-2];for(let Q=0;Q<U;Q++)K[q++]=W[Q<<1]+G,K[q++]=W[(Q<<1)+1];return K.buffer}static insert(w,D,O){if(w===null||w===EMPTY_LINE_TOKENS)return w;const W=toUint32Array(w),U=W.length>>>1;let K=LineTokens.findIndexInTokensArray(W,D);K>0&&W[K-1<<1]===D&&K--;for(let q=K;q<U;q++)W[q<<1]+=O;return w}}function toUint32Array(F){return F instanceof Uint32Array?F:new Uint32Array(F)}class ContiguousTokensStore{constructor(w){this._lineTokens=[],this._len=0,this._languageIdCodec=w}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(w,D,O){let W=null;if(D<this._len&&(W=this._lineTokens[D]),W!==null&&W!==EMPTY_LINE_TOKENS)return new LineTokens(toUint32Array(W),O,this._languageIdCodec);const U=new Uint32Array(2);return U[0]=O.length,U[1]=getDefaultMetadata(this._languageIdCodec.encodeLanguageId(w)),new LineTokens(U,O,this._languageIdCodec)}static _massageTokens(w,D,O){const W=O?toUint32Array(O):null;if(D===0){let U=!1;if(W&&W.length>1&&(U=TokenMetadata.getLanguageId(W[1])!==w),!U)return EMPTY_LINE_TOKENS}if(!W||W.length===0){const U=new Uint32Array(2);return U[0]=D,U[1]=getDefaultMetadata(w),U.buffer}return W[W.length-2]=D,W.byteOffset===0&&W.byteLength===W.buffer.byteLength?W.buffer:W}_ensureLine(w){for(;w>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(w,D){D!==0&&(w+D>this._len&&(D=this._len-w),this._lineTokens.splice(w,D),this._len-=D)}_insertLines(w,D){if(D===0)return;const O=[];for(let W=0;W<D;W++)O[W]=null;this._lineTokens=arrayInsert(this._lineTokens,w,O),this._len+=D}setTokens(w,D,O,W,U){const K=ContiguousTokensStore._massageTokens(this._languageIdCodec.encodeLanguageId(w),O,W);this._ensureLine(D);const q=this._lineTokens[D];return this._lineTokens[D]=K,U?!ContiguousTokensStore._equals(q,K):!1}static _equals(w,D){if(!w||!D)return!w&&!D;const O=toUint32Array(w),W=toUint32Array(D);if(O.length!==W.length)return!1;for(let U=0,K=O.length;U<K;U++)if(O[U]!==W[U])return!1;return!0}acceptEdit(w,D,O){this._acceptDeleteRange(w),this._acceptInsertText(new Position$1(w.startLineNumber,w.startColumn),D,O)}_acceptDeleteRange(w){const D=w.startLineNumber-1;if(D>=this._len)return;if(w.startLineNumber===w.endLineNumber){if(w.startColumn===w.endColumn)return;this._lineTokens[D]=ContiguousTokensEditing.delete(this._lineTokens[D],w.startColumn-1,w.endColumn-1);return}this._lineTokens[D]=ContiguousTokensEditing.deleteEnding(this._lineTokens[D],w.startColumn-1);const O=w.endLineNumber-1;let W=null;O<this._len&&(W=ContiguousTokensEditing.deleteBeginning(this._lineTokens[O],w.endColumn-1)),this._lineTokens[D]=ContiguousTokensEditing.append(this._lineTokens[D],W),this._deleteLines(w.startLineNumber,w.endLineNumber-w.startLineNumber)}_acceptInsertText(w,D,O){if(D===0&&O===0)return;const W=w.lineNumber-1;if(!(W>=this._len)){if(D===0){this._lineTokens[W]=ContiguousTokensEditing.insert(this._lineTokens[W],w.column-1,O);return}this._lineTokens[W]=ContiguousTokensEditing.deleteEnding(this._lineTokens[W],w.column-1),this._lineTokens[W]=ContiguousTokensEditing.insert(this._lineTokens[W],w.column-1,O),this._insertLines(w.lineNumber,D)}}setMultilineTokens(w,D){if(w.length===0)return{changes:[]};const O=[];for(let W=0,U=w.length;W<U;W++){const K=w[W];let q=0,G=0,Q=!1;for(let Y=K.startLineNumber;Y<=K.endLineNumber;Y++)Q?(this.setTokens(D.getLanguageId(),Y-1,D.getLineLength(Y),K.getLineTokens(Y),!1),G=Y):this.setTokens(D.getLanguageId(),Y-1,D.getLineLength(Y),K.getLineTokens(Y),!0)&&(Q=!0,q=Y,G=Y);Q&&O.push({fromLineNumber:q,toLineNumber:G})}return{changes:O}}}function getDefaultMetadata(F){return(F<<0|0|0|32768|2<<24|1024)>>>0}class SparseTokensStore{constructor(w){this._pieces=[],this._isComplete=!1,this._languageIdCodec=w}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(w,D){this._pieces=w||[],this._isComplete=D}setPartial(w,D){let O=w;if(D.length>0){const U=D[0].getRange(),K=D[D.length-1].getRange();if(!U||!K)return w;O=w.plusRange(U).plusRange(K)}let W=null;for(let U=0,K=this._pieces.length;U<K;U++){const q=this._pieces[U];if(q.endLineNumber<O.startLineNumber)continue;if(q.startLineNumber>O.endLineNumber){W=W||{index:U};break}if(q.removeTokens(O),q.isEmpty()){this._pieces.splice(U,1),U--,K--;continue}if(q.endLineNumber<O.startLineNumber)continue;if(q.startLineNumber>O.endLineNumber){W=W||{index:U};continue}const[G,Q]=q.split(O);if(G.isEmpty()){W=W||{index:U};continue}Q.isEmpty()||(this._pieces.splice(U,1,G,Q),U++,K++,W=W||{index:U})}return W=W||{index:this._pieces.length},D.length>0&&(this._pieces=arrayInsert(this._pieces,W.index,D)),O}isComplete(){return this._isComplete}addSparseTokens(w,D){if(D.getLineContent().length===0)return D;const O=this._pieces;if(O.length===0)return D;const W=SparseTokensStore._findFirstPieceWithLine(O,w),U=O[W].getLineTokens(w);if(!U)return D;const K=D.getCount(),q=U.getCount();let G=0;const Q=[];let Y=0,X=0;const J=(te,ie)=>{te!==X&&(X=te,Q[Y++]=te,Q[Y++]=ie)};for(let te=0;te<q;te++){const ie=U.getStartCharacter(te),se=U.getEndCharacter(te),re=U.getMetadata(te),ae=((re&1?2048:0)|(re&2?4096:0)|(re&4?8192:0)|(re&8?16384:0)|(re&16?16744448:0)|(re&32?4278190080:0))>>>0,le=~ae>>>0;for(;G<K&&D.getEndOffset(G)<=ie;)J(D.getEndOffset(G),D.getMetadata(G)),G++;for(G<K&&D.getStartOffset(G)<ie&&J(ie,D.getMetadata(G));G<K&&D.getEndOffset(G)<se;)J(D.getEndOffset(G),D.getMetadata(G)&le|re&ae),G++;if(G<K)J(se,D.getMetadata(G)&le|re&ae),D.getEndOffset(G)===se&&G++;else{const de=Math.min(Math.max(0,G-1),K-1);J(se,D.getMetadata(de)&le|re&ae)}}for(;G<K;)J(D.getEndOffset(G),D.getMetadata(G)),G++;return new LineTokens(new Uint32Array(Q),D.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(w,D){let O=0,W=w.length-1;for(;O<W;){let U=O+Math.floor((W-O)/2);if(w[U].endLineNumber<D)O=U+1;else if(w[U].startLineNumber>D)W=U-1;else{for(;U>O&&w[U-1].startLineNumber<=D&&D<=w[U-1].endLineNumber;)U--;return U}}return O}acceptEdit(w,D,O,W,U){for(const K of this._pieces)K.acceptEdit(w,D,O,W,U)}}var __decorate$16=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$13=function(F,w){return function(D,O){w(D,O,F)}},TokenizationTextModelPart_1;let TokenizationTextModelPart=TokenizationTextModelPart_1=class extends TextModelPart{constructor(w,D,O,W,U,K,q){super(),this._textModel=w,this._bracketPairsTextModelPart=D,this._languageId=O,this._attachedViews=W,this._languageService=U,this._languageConfigurationService=K,this._treeSitterService=q,this._semanticTokens=new SparseTokensStore(this._languageService.languageIdCodec),this._onDidChangeLanguage=this._register(new Emitter$1),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new Emitter$1),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new Emitter$1),this.onDidChangeTokens=this._onDidChangeTokens.event,this._tokensDisposables=this._register(new DisposableStore),this._register(this._languageConfigurationService.onDidChange(G=>{G.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(Event$1.filter(TreeSitterTokenizationRegistry.onDidChange,G=>G.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}createGrammarTokens(){return this._register(new GrammarTokens(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new TreeSitterTokens(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(w){const D=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=w?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(O=>{this._emitModelTokensChangedEvent(O)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(O=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),D&&this._tokens.resetTokenization()}createPreferredTokenProvider(){TreeSitterTokenizationRegistry.get(this._languageId)?this._tokens instanceof TreeSitterTokens||this.createTokens(!0):this._tokens instanceof GrammarTokens||this.createTokens(!1)}handleLanguageConfigurationServiceChange(w){w.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(w){if(w.isFlush)this._semanticTokens.flush();else if(!w.isEolChange)for(const D of w.changes){const[O,W,U]=countEOL(D.text);this._semanticTokens.acceptEdit(D.range,O,W,U,D.text.length>0?D.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(w)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(w){this.validateLineNumber(w);const D=this._tokens.getLineTokens(w);return this._semanticTokens.addSparseTokens(w,D)}_emitModelTokensChangedEvent(w){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(w),this._onDidChangeTokens.fire(w))}validateLineNumber(w){if(w<1||w>this._textModel.getLineCount())throw new BugIndicatingError("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(w){this.validateLineNumber(w),this._tokens.forceTokenization(w)}hasAccurateTokensForLine(w){return this.validateLineNumber(w),this._tokens.hasAccurateTokensForLine(w)}isCheapToTokenize(w){return this.validateLineNumber(w),this._tokens.isCheapToTokenize(w)}tokenizeIfCheap(w){this.validateLineNumber(w),this._tokens.tokenizeIfCheap(w)}getTokenTypeIfInsertingCharacter(w,D,O){return this._tokens.getTokenTypeIfInsertingCharacter(w,D,O)}tokenizeLineWithEdit(w,D,O){return this._tokens.tokenizeLineWithEdit(w,D,O)}setSemanticTokens(w,D){this._semanticTokens.set(w,D),this._emitModelTokensChangedEvent({semanticTokensApplied:w!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(w,D){if(this.hasCompleteSemanticTokens())return;const O=this._textModel.validateRange(this._semanticTokens.setPartial(w,D));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:O.startLineNumber,toLineNumber:O.endLineNumber}]})}getWordAtPosition(w){this.assertNotDisposed();const D=this._textModel.validatePosition(w),O=this._textModel.getLineContent(D.lineNumber),W=this.getLineTokens(D.lineNumber),U=W.findTokenIndexAtOffset(D.column-1),[K,q]=TokenizationTextModelPart_1._findLanguageBoundaries(W,U),G=getWordAtText(D.column,this.getLanguageConfiguration(W.getLanguageId(U)).getWordDefinition(),O.substring(K,q),K);if(G&&G.startColumn<=w.column&&w.column<=G.endColumn)return G;if(U>0&&K===D.column-1){const[Q,Y]=TokenizationTextModelPart_1._findLanguageBoundaries(W,U-1),X=getWordAtText(D.column,this.getLanguageConfiguration(W.getLanguageId(U-1)).getWordDefinition(),O.substring(Q,Y),Q);if(X&&X.startColumn<=w.column&&w.column<=X.endColumn)return X}return null}getLanguageConfiguration(w){return this._languageConfigurationService.getLanguageConfiguration(w)}static _findLanguageBoundaries(w,D){const O=w.getLanguageId(D);let W=0;for(let K=D;K>=0&&w.getLanguageId(K)===O;K--)W=w.getStartOffset(K);let U=w.getLineContent().length;for(let K=D,q=w.getCount();K<q&&w.getLanguageId(K)===O;K++)U=w.getEndOffset(K);return[W,U]}getWordUntilPosition(w){const D=this.getWordAtPosition(w);return D?{word:D.word.substr(0,w.column-D.startColumn),startColumn:D.startColumn,endColumn:w.column}:{word:"",startColumn:w.column,endColumn:w.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(w,D){const O=this._textModel.validatePosition(new Position$1(w,D)),W=this.getLineTokens(O.lineNumber);return W.getLanguageId(W.findTokenIndexAtOffset(O.column-1))}setLanguageId(w,D="api"){if(this._languageId===w)return;const O={oldLanguage:this._languageId,newLanguage:w,source:D};this._languageId=w,this._bracketPairsTextModelPart.handleDidChangeLanguage(O),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(O),this._onDidChangeLanguageConfiguration.fire({})}};TokenizationTextModelPart=TokenizationTextModelPart_1=__decorate$16([__param$13(4,ILanguageService),__param$13(5,ILanguageConfigurationService),__param$13(6,ITreeSitterParserService)],TokenizationTextModelPart);class GrammarTokens extends AbstractTokens{constructor(w,D,O,W){super(w,D,O),this._tokenizer=null,this._defaultBackgroundTokenizer=null,this._backgroundTokenizer=this._register(new MutableDisposable),this._tokens=new ContiguousTokensStore(this._languageIdCodec),this._debugBackgroundTokenizer=this._register(new MutableDisposable),this._attachedViewStates=this._register(new DisposableMap),this._register(TokenizationRegistry.onDidChange(U=>{const K=this.getLanguageId();U.changedLanguages.indexOf(K)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(W.onDidChangeVisibleRanges(({view:U,state:K})=>{if(K){let q=this._attachedViewStates.get(U);q||(q=new AttachedViewHandler(()=>this.refreshRanges(q.lineRanges)),this._attachedViewStates.set(U,q)),q.handleStateChange(K)}else this._attachedViewStates.deleteAndDispose(U)}))}resetTokenization(w=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new TrackingTokenizationStateStore(this._textModel.getLineCount())),w&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});const D=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];const U=TokenizationRegistry.get(this.getLanguageId());if(!U)return[null,null];let K;try{K=U.getInitialState()}catch(q){return onUnexpectedError(q),[null,null]}return[U,K]},[O,W]=D();if(O&&W?this._tokenizer=new TokenizerWithStateStoreAndTextModel(this._textModel.getLineCount(),O,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){const U={setTokens:K=>{this.setTokens(K)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;const K=2;this._backgroundTokenizationState=K,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(K,q)=>{if(!this._tokenizer)return;const G=this._tokenizer.store.getFirstInvalidEndStateLineNumber();G!==null&&K>=G&&this._tokenizer?.store.setEndState(K,q)}};O&&O.createBackgroundTokenizer&&!O.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=O.createBackgroundTokenizer(this._textModel,U)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new DefaultBackgroundTokenizer(this._tokenizer,U),this._defaultBackgroundTokenizer.handleChanges()),O?.backgroundTokenizerShouldOnlyVerifyTokens&&O.createBackgroundTokenizer?(this._debugBackgroundTokens=new ContiguousTokensStore(this._languageIdCodec),this._debugBackgroundStates=new TrackingTokenizationStateStore(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=O.createBackgroundTokenizer(this._textModel,{setTokens:K=>{this._debugBackgroundTokens?.setMultilineTokens(K,this._textModel)},backgroundTokenizationFinished(){},setEndState:(K,q)=>{this._debugBackgroundStates?.setEndState(K,q)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(w){if(w.isFlush)this.resetTokenization(!1);else if(!w.isEolChange){for(const D of w.changes){const[O,W]=countEOL(D.text);this._tokens.acceptEdit(D.range,O,W),this._debugBackgroundTokens?.acceptEdit(D.range,O,W)}this._debugBackgroundStates?.acceptChanges(w.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(w.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(w){const{changes:D}=this._tokens.setMultilineTokens(w,this._textModel);return D.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:D}),{changes:D}}refreshAllVisibleLineTokens(){const w=LineRange$1.joinMany([...this._attachedViewStates].map(([D,O])=>O.lineRanges));this.refreshRanges(w)}refreshRanges(w){for(const D of w)this.refreshRange(D.startLineNumber,D.endLineNumberExclusive-1)}refreshRange(w,D){if(!this._tokenizer)return;w=Math.max(1,Math.min(this._textModel.getLineCount(),w)),D=Math.min(this._textModel.getLineCount(),D);const O=new ContiguousMultilineTokensBuilder,{heuristicTokens:W}=this._tokenizer.tokenizeHeuristically(O,w,D),U=this.setTokens(O.finalize());if(W)for(const K of U.changes)this._backgroundTokenizer.value?.requestTokens(K.fromLineNumber,K.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(w){const D=new ContiguousMultilineTokensBuilder;this._tokenizer?.updateTokensUntilLine(D,w),this.setTokens(D.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(w){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(w):!0}isCheapToTokenize(w){return this._tokenizer?this._tokenizer.isCheapToTokenize(w):!0}getLineTokens(w){const D=this._textModel.getLineContent(w),O=this._tokens.getTokens(this._textModel.getLanguageId(),w-1,D);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>w&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>w){const W=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),w-1,D);!O.equals(W)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(w)}return O}getTokenTypeIfInsertingCharacter(w,D,O){if(!this._tokenizer)return 0;const W=this._textModel.validatePosition(new Position$1(w,D));return this.forceTokenization(W.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(W,O)}tokenizeLineWithEdit(w,D,O){if(!this._tokenizer)return null;const W=this._textModel.validatePosition(w);return this.forceTokenization(W.lineNumber),this._tokenizer.tokenizeLineWithEdit(W,D,O)}get hasTokens(){return this._tokens.hasTokens}}class ModelRawFlush{constructor(){this.changeType=1}}class LineInjectedText{static applyInjectedText(w,D){if(!D||D.length===0)return w;let O="",W=0;for(const U of D)O+=w.substring(W,U.column-1),W=U.column-1,O+=U.options.content;return O+=w.substring(W),O}static fromDecorations(w){const D=[];for(const O of w)O.options.before&&O.options.before.content.length>0&&D.push(new LineInjectedText(O.ownerId,O.range.startLineNumber,O.range.startColumn,O.options.before,0)),O.options.after&&O.options.after.content.length>0&&D.push(new LineInjectedText(O.ownerId,O.range.endLineNumber,O.range.endColumn,O.options.after,1));return D.sort((O,W)=>O.lineNumber===W.lineNumber?O.column===W.column?O.order-W.order:O.column-W.column:O.lineNumber-W.lineNumber),D}constructor(w,D,O,W,U){this.ownerId=w,this.lineNumber=D,this.column=O,this.options=W,this.order=U}}class ModelRawLineChanged{constructor(w,D,O){this.changeType=2,this.lineNumber=w,this.detail=D,this.injectedText=O}}class ModelRawLinesDeleted{constructor(w,D){this.changeType=3,this.fromLineNumber=w,this.toLineNumber=D}}class ModelRawLinesInserted{constructor(w,D,O,W){this.changeType=4,this.injectedTexts=W,this.fromLineNumber=w,this.toLineNumber=D,this.detail=O}}class ModelRawEOLChanged{constructor(){this.changeType=5}}class ModelRawContentChangedEvent{constructor(w,D,O,W){this.changes=w,this.versionId=D,this.isUndoing=O,this.isRedoing=W,this.resultingSelection=null}containsEvent(w){for(let D=0,O=this.changes.length;D<O;D++)if(this.changes[D].changeType===w)return!0;return!1}static merge(w,D){const O=[].concat(w.changes).concat(D.changes),W=D.versionId,U=w.isUndoing||D.isUndoing,K=w.isRedoing||D.isRedoing;return new ModelRawContentChangedEvent(O,W,U,K)}}class ModelInjectedTextChangedEvent{constructor(w){this.changes=w}}class InternalModelContentChangeEvent{constructor(w,D){this.rawContentChangedEvent=w,this.contentChangedEvent=D}merge(w){const D=ModelRawContentChangedEvent.merge(this.rawContentChangedEvent,w.rawContentChangedEvent),O=InternalModelContentChangeEvent._mergeChangeEvents(this.contentChangedEvent,w.contentChangedEvent);return new InternalModelContentChangeEvent(D,O)}static _mergeChangeEvents(w,D){const O=[].concat(w.changes).concat(D.changes),W=D.eol,U=D.versionId,K=w.isUndoing||D.isUndoing,q=w.isRedoing||D.isRedoing,G=w.isFlush||D.isFlush,Q=w.isEolChange&&D.isEolChange;return{changes:O,eol:W,isEolChange:Q,versionId:U,isUndoing:K,isRedoing:q,isFlush:G}}}const IUndoRedoService=createDecorator("undoRedoService");class ResourceEditStackSnapshot{constructor(w,D){this.resource=w,this.elements=D}}class UndoRedoGroup{static{this._ID=0}constructor(){this.id=UndoRedoGroup._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static{this.None=new UndoRedoGroup}}class UndoRedoSource{static{this._ID=0}constructor(){this.id=UndoRedoSource._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static{this.None=new UndoRedoSource}}var __decorate$15=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$12=function(F,w){return function(D,O){w(D,O,F)}},TextModel_1;function createTextBufferFactory(F){const w=new PieceTreeTextBufferBuilder;return w.acceptChunk(F),w.finish()}function createTextBufferFactoryFromSnapshot(F){const w=new PieceTreeTextBufferBuilder;let D;for(;typeof(D=F.read())=="string";)w.acceptChunk(D);return w.finish()}function createTextBuffer(F,w){let D;return typeof F=="string"?D=createTextBufferFactory(F):isITextSnapshot(F)?D=createTextBufferFactoryFromSnapshot(F):D=F,D.create(w)}let MODEL_ID$1=0;const LIMIT_FIND_COUNT=999,LONG_LINE_BOUNDARY=1e4;class TextModelSnapshot{constructor(w){this._source=w,this._eos=!1}read(){if(this._eos)return null;const w=[];let D=0,O=0;do{const W=this._source.read();if(W===null)return this._eos=!0,D===0?null:w.join("");if(W.length>0&&(w[D++]=W,O+=W.length),O>=64*1024)return w.join("")}while(!0)}}const invalidFunc$1=()=>{throw new Error("Invalid change accessor")};let TextModel=class extends Disposable{static{TextModel_1=this}static{this._MODEL_SYNC_LIMIT=50*1024*1024}static{this.LARGE_FILE_SIZE_THRESHOLD=20*1024*1024}static{this.LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3}static{this.LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024}static{this.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:EDITOR_MODEL_DEFAULTS.tabSize,indentSize:EDITOR_MODEL_DEFAULTS.indentSize,insertSpaces:EDITOR_MODEL_DEFAULTS.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:EDITOR_MODEL_DEFAULTS.trimAutoWhitespace,largeFileOptimizations:EDITOR_MODEL_DEFAULTS.largeFileOptimizations,bracketPairColorizationOptions:EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions}}static resolveOptions(w,D){if(D.detectIndentation){const O=guessIndentation(w,D.tabSize,D.insertSpaces);return new TextModelResolvedOptions({tabSize:O.tabSize,indentSize:"tabSize",insertSpaces:O.insertSpaces,trimAutoWhitespace:D.trimAutoWhitespace,defaultEOL:D.defaultEOL,bracketPairColorizationOptions:D.bracketPairColorizationOptions})}return new TextModelResolvedOptions(D)}get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}onDidChangeContent(w){return this._eventEmitter.slowEvent(D=>w(D.contentChangedEvent))}onDidChangeContentOrInjectedText(w){return combinedDisposable(this._eventEmitter.fastEvent(D=>w(D)),this._onDidChangeInjectedText.event(D=>w(D)))}_isDisposing(){return this.__isDisposing}get tokenization(){return this._tokenizationTextModelPart}get bracketPairs(){return this._bracketPairs}get guides(){return this._guidesTextModelPart}constructor(w,D,O,W=null,U,K,q,G){super(),this._undoRedoService=U,this._languageService=K,this._languageConfigurationService=q,this.instantiationService=G,this._onWillDispose=this._register(new Emitter$1),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new DidChangeDecorationsEmitter(ie=>this.handleBeforeFireDecorationsChangedEvent(ie))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeOptions=this._register(new Emitter$1),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new Emitter$1),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeInjectedText=this._register(new Emitter$1),this._eventEmitter=this._register(new DidChangeContentEmitter),this._languageSelectionListener=this._register(new MutableDisposable),this._deltaDecorationCallCnt=0,this._attachedViews=new AttachedViews,MODEL_ID$1++,this.id="$model"+MODEL_ID$1,this.isForSimpleWidget=O.isForSimpleWidget,typeof W>"u"||W===null?this._associatedResource=URI.parse("inmemory://model/"+MODEL_ID$1):this._associatedResource=W,this._attachedEditorCount=0;const{textBuffer:Q,disposable:Y}=createTextBuffer(w,O.defaultEOL);this._buffer=Q,this._bufferDisposable=Y,this._options=TextModel_1.resolveOptions(this._buffer,O);const X=typeof D=="string"?D:D.languageId;typeof D!="string"&&(this._languageSelectionListener.value=D.onDidChange(()=>this._setLanguage(D.languageId))),this._bracketPairs=this._register(new BracketPairsTextModelPart(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new GuidesTextModelPart(this,this._languageConfigurationService)),this._decorationProvider=this._register(new ColorizedBracketPairsDecorationProvider(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(TokenizationTextModelPart,this,this._bracketPairs,X,this._attachedViews);const J=this._buffer.getLineCount(),te=this._buffer.getValueLengthInRange(new Range$2(1,1,J,this._buffer.getLineLength(J)+1),0);O.largeFileOptimizations?(this._isTooLargeForTokenization=te>TextModel_1.LARGE_FILE_SIZE_THRESHOLD||J>TextModel_1.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=te>TextModel_1.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=te>TextModel_1._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=singleLetterHash(MODEL_ID$1),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new DecorationsTrees,this._commandManager=new EditStack(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(X),this._register(this._languageConfigurationService.onDidChange(ie=>{this._bracketPairs.handleLanguageConfigurationServiceChange(ie),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(ie)}))}dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;const w=new PieceTreeTextBuffer([],"",`
`,!1,!1,!0,!0);w.dispose(),this._buffer=w,this._bufferDisposable=Disposable.None}_assertNotDisposed(){if(this._isDisposed)throw new BugIndicatingError("Model is disposed!")}_emitContentChangedEvent(w,D){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(D),this._bracketPairs.handleDidChangeContent(D),this._eventEmitter.fire(new InternalModelContentChangeEvent(w,D)))}setValue(w){if(this._assertNotDisposed(),w==null)throw illegalArgument();const{textBuffer:D,disposable:O}=createTextBuffer(w,this._options.defaultEOL);this._setValueFromTextBuffer(D,O)}_createContentChanged2(w,D,O,W,U,K,q,G){return{changes:[{range:w,rangeOffset:D,rangeLength:O,text:W}],eol:this._buffer.getEOL(),isEolChange:G,versionId:this.getVersionId(),isUndoing:U,isRedoing:K,isFlush:q}}_setValueFromTextBuffer(w,D){this._assertNotDisposed();const O=this.getFullModelRange(),W=this.getValueLengthInRange(O),U=this.getLineCount(),K=this.getLineMaxColumn(U);this._buffer=w,this._bufferDisposable.dispose(),this._bufferDisposable=D,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new DecorationsTrees,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new ModelRawContentChangedEvent([new ModelRawFlush],this._versionId,!1,!1),this._createContentChanged2(new Range$2(1,1,U,K),0,W,this.getValue(),!1,!1,!0,!1))}setEOL(w){this._assertNotDisposed();const D=w===1?`\r
`:`
`;if(this._buffer.getEOL()===D)return;const O=this.getFullModelRange(),W=this.getValueLengthInRange(O),U=this.getLineCount(),K=this.getLineMaxColumn(U);this._onBeforeEOLChange(),this._buffer.setEOL(D),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new ModelRawContentChangedEvent([new ModelRawEOLChanged],this._versionId,!1,!1),this._createContentChanged2(new Range$2(1,1,U,K),0,W,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const w=this.getVersionId(),D=this._decorationsTree.collectNodesPostOrder();for(let O=0,W=D.length;O<W;O++){const U=D[O],K=U.range,q=U.cachedAbsoluteStart-U.start,G=this._buffer.getOffsetAt(K.startLineNumber,K.startColumn),Q=this._buffer.getOffsetAt(K.endLineNumber,K.endColumn);U.cachedAbsoluteStart=G,U.cachedAbsoluteEnd=Q,U.cachedVersionId=w,U.start=G-q,U.end=Q-q,recomputeMaxEnd(U)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(w){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(w)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let w=0,D=0;const O=this._buffer.getLineCount();for(let W=1;W<=O;W++){const U=this._buffer.getLineLength(W);U>=LONG_LINE_BOUNDARY?D+=U:w+=U}return D>w}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(w){this._assertNotDisposed();const D=typeof w.tabSize<"u"?w.tabSize:this._options.tabSize,O=typeof w.indentSize<"u"?w.indentSize:this._options.originalIndentSize,W=typeof w.insertSpaces<"u"?w.insertSpaces:this._options.insertSpaces,U=typeof w.trimAutoWhitespace<"u"?w.trimAutoWhitespace:this._options.trimAutoWhitespace,K=typeof w.bracketColorizationOptions<"u"?w.bracketColorizationOptions:this._options.bracketPairColorizationOptions,q=new TextModelResolvedOptions({tabSize:D,indentSize:O,insertSpaces:W,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:U,bracketPairColorizationOptions:K});if(this._options.equals(q))return;const G=this._options.createChangeEvent(q);this._options=q,this._bracketPairs.handleDidChangeOptions(G),this._decorationProvider.handleDidChangeOptions(G),this._onDidChangeOptions.fire(G)}detectIndentation(w,D){this._assertNotDisposed();const O=guessIndentation(this._buffer,D,w);this.updateOptions({insertSpaces:O.insertSpaces,tabSize:O.tabSize,indentSize:O.tabSize})}normalizeIndentation(w){return this._assertNotDisposed(),normalizeIndentation(w,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(w=null){const D=this.findMatches(UNUSUAL_LINE_TERMINATORS.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(w,D.map(O=>({range:O.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(w){this._assertNotDisposed();const D=this._validatePosition(w.lineNumber,w.column,0);return this._buffer.getOffsetAt(D.lineNumber,D.column)}getPositionAt(w){this._assertNotDisposed();const D=Math.min(this._buffer.getLength(),Math.max(0,w));return this._buffer.getPositionAt(D)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(w){this._versionId=w}_overwriteAlternativeVersionId(w){this._alternativeVersionId=w}_overwriteInitialUndoRedoSnapshot(w){this._initialUndoRedoSnapshot=w}getValue(w,D=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new BugIndicatingError("Operation would exceed heap memory limits");const O=this.getFullModelRange(),W=this.getValueInRange(O,w);return D?this._buffer.getBOM()+W:W}createSnapshot(w=!1){return new TextModelSnapshot(this._buffer.createSnapshot(w))}getValueLength(w,D=!1){this._assertNotDisposed();const O=this.getFullModelRange(),W=this.getValueLengthInRange(O,w);return D?this._buffer.getBOM().length+W:W}getValueInRange(w,D=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(w),D)}getValueLengthInRange(w,D=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(w),D)}getCharacterCountInRange(w,D=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(w),D)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(w){if(this._assertNotDisposed(),w<1||w>this.getLineCount())throw new BugIndicatingError("Illegal value for lineNumber");return this._buffer.getLineContent(w)}getLineLength(w){if(this._assertNotDisposed(),w<1||w>this.getLineCount())throw new BugIndicatingError("Illegal value for lineNumber");return this._buffer.getLineLength(w)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new BugIndicatingError("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(w){return this._assertNotDisposed(),1}getLineMaxColumn(w){if(this._assertNotDisposed(),w<1||w>this.getLineCount())throw new BugIndicatingError("Illegal value for lineNumber");return this._buffer.getLineLength(w)+1}getLineFirstNonWhitespaceColumn(w){if(this._assertNotDisposed(),w<1||w>this.getLineCount())throw new BugIndicatingError("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(w)}getLineLastNonWhitespaceColumn(w){if(this._assertNotDisposed(),w<1||w>this.getLineCount())throw new BugIndicatingError("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(w)}_validateRangeRelaxedNoAllocations(w){const D=this._buffer.getLineCount(),O=w.startLineNumber,W=w.startColumn;let U=Math.floor(typeof O=="number"&&!isNaN(O)?O:1),K=Math.floor(typeof W=="number"&&!isNaN(W)?W:1);if(U<1)U=1,K=1;else if(U>D)U=D,K=this.getLineMaxColumn(U);else if(K<=1)K=1;else{const X=this.getLineMaxColumn(U);K>=X&&(K=X)}const q=w.endLineNumber,G=w.endColumn;let Q=Math.floor(typeof q=="number"&&!isNaN(q)?q:1),Y=Math.floor(typeof G=="number"&&!isNaN(G)?G:1);if(Q<1)Q=1,Y=1;else if(Q>D)Q=D,Y=this.getLineMaxColumn(Q);else if(Y<=1)Y=1;else{const X=this.getLineMaxColumn(Q);Y>=X&&(Y=X)}return O===U&&W===K&&q===Q&&G===Y&&w instanceof Range$2&&!(w instanceof Selection$1)?w:new Range$2(U,K,Q,Y)}_isValidPosition(w,D,O){if(typeof w!="number"||typeof D!="number"||isNaN(w)||isNaN(D)||w<1||D<1||(w|0)!==w||(D|0)!==D)return!1;const W=this._buffer.getLineCount();if(w>W)return!1;if(D===1)return!0;const U=this.getLineMaxColumn(w);if(D>U)return!1;if(O===1){const K=this._buffer.getLineCharCode(w,D-2);if(isHighSurrogate(K))return!1}return!0}_validatePosition(w,D,O){const W=Math.floor(typeof w=="number"&&!isNaN(w)?w:1),U=Math.floor(typeof D=="number"&&!isNaN(D)?D:1),K=this._buffer.getLineCount();if(W<1)return new Position$1(1,1);if(W>K)return new Position$1(K,this.getLineMaxColumn(K));if(U<=1)return new Position$1(W,1);const q=this.getLineMaxColumn(W);if(U>=q)return new Position$1(W,q);if(O===1){const G=this._buffer.getLineCharCode(W,U-2);if(isHighSurrogate(G))return new Position$1(W,U-1)}return new Position$1(W,U)}validatePosition(w){return this._assertNotDisposed(),w instanceof Position$1&&this._isValidPosition(w.lineNumber,w.column,1)?w:this._validatePosition(w.lineNumber,w.column,1)}_isValidRange(w,D){const O=w.startLineNumber,W=w.startColumn,U=w.endLineNumber,K=w.endColumn;if(!this._isValidPosition(O,W,0)||!this._isValidPosition(U,K,0))return!1;if(D===1){const q=W>1?this._buffer.getLineCharCode(O,W-2):0,G=K>1&&K<=this._buffer.getLineLength(U)?this._buffer.getLineCharCode(U,K-2):0,Q=isHighSurrogate(q),Y=isHighSurrogate(G);return!Q&&!Y}return!0}validateRange(w){if(this._assertNotDisposed(),w instanceof Range$2&&!(w instanceof Selection$1)&&this._isValidRange(w,1))return w;const O=this._validatePosition(w.startLineNumber,w.startColumn,0),W=this._validatePosition(w.endLineNumber,w.endColumn,0),U=O.lineNumber,K=O.column,q=W.lineNumber,G=W.column;{const Q=K>1?this._buffer.getLineCharCode(U,K-2):0,Y=G>1&&G<=this._buffer.getLineLength(q)?this._buffer.getLineCharCode(q,G-2):0,X=isHighSurrogate(Q),J=isHighSurrogate(Y);return!X&&!J?new Range$2(U,K,q,G):U===q&&K===G?new Range$2(U,K-1,q,G-1):X&&J?new Range$2(U,K-1,q,G+1):X?new Range$2(U,K-1,q,G):new Range$2(U,K,q,G+1)}}modifyPosition(w,D){this._assertNotDisposed();const O=this.getOffsetAt(w)+D;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,O)))}getFullModelRange(){this._assertNotDisposed();const w=this.getLineCount();return new Range$2(1,1,w,this.getLineMaxColumn(w))}findMatchesLineByLine(w,D,O,W){return this._buffer.findMatchesLineByLine(w,D,O,W)}findMatches(w,D,O,W,U,K,q=LIMIT_FIND_COUNT){this._assertNotDisposed();let G=null;D!==null&&(Array.isArray(D)||(D=[D]),D.every(X=>Range$2.isIRange(X))&&(G=D.map(X=>this.validateRange(X)))),G===null&&(G=[this.getFullModelRange()]),G=G.sort((X,J)=>X.startLineNumber-J.startLineNumber||X.startColumn-J.startColumn);const Q=[];Q.push(G.reduce((X,J)=>Range$2.areIntersecting(X,J)?X.plusRange(J):(Q.push(X),J)));let Y;if(!O&&w.indexOf(`
`)<0){const J=new SearchParams(w,O,W,U).parseSearchRequest();if(!J)return[];Y=te=>this.findMatchesLineByLine(te,J,K,q)}else Y=X=>TextModelSearch.findMatches(this,new SearchParams(w,O,W,U),X,K,q);return Q.map(Y).reduce((X,J)=>X.concat(J),[])}findNextMatch(w,D,O,W,U,K){this._assertNotDisposed();const q=this.validatePosition(D);if(!O&&w.indexOf(`
`)<0){const Q=new SearchParams(w,O,W,U).parseSearchRequest();if(!Q)return null;const Y=this.getLineCount();let X=new Range$2(q.lineNumber,q.column,Y,this.getLineMaxColumn(Y)),J=this.findMatchesLineByLine(X,Q,K,1);return TextModelSearch.findNextMatch(this,new SearchParams(w,O,W,U),q,K),J.length>0||(X=new Range$2(1,1,q.lineNumber,this.getLineMaxColumn(q.lineNumber)),J=this.findMatchesLineByLine(X,Q,K,1),J.length>0)?J[0]:null}return TextModelSearch.findNextMatch(this,new SearchParams(w,O,W,U),q,K)}findPreviousMatch(w,D,O,W,U,K){this._assertNotDisposed();const q=this.validatePosition(D);return TextModelSearch.findPreviousMatch(this,new SearchParams(w,O,W,U),q,K)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(w){if((this.getEOL()===`
`?0:1)!==w)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(w)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(w){return w instanceof ValidAnnotatedEditOperation?w:new ValidAnnotatedEditOperation(w.identifier||null,this.validateRange(w.range),w.text,w.forceMoveMarkers||!1,w.isAutoWhitespaceEdit||!1,w._isTracked||!1)}_validateEditOperations(w){const D=[];for(let O=0,W=w.length;O<W;O++)D[O]=this._validateEditOperation(w[O]);return D}pushEditOperations(w,D,O,W){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(w,this._validateEditOperations(D),O,W)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(w,D,O,W){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const U=D.map(q=>({range:this.validateRange(q.range),text:q.text}));let K=!0;if(w)for(let q=0,G=w.length;q<G;q++){const Q=w[q];let Y=!1;for(let X=0,J=U.length;X<J;X++){const te=U[X].range,ie=te.startLineNumber>Q.endLineNumber,se=Q.startLineNumber>te.endLineNumber;if(!ie&&!se){Y=!0;break}}if(!Y){K=!1;break}}if(K)for(let q=0,G=this._trimAutoWhitespaceLines.length;q<G;q++){const Q=this._trimAutoWhitespaceLines[q],Y=this.getLineMaxColumn(Q);let X=!0;for(let J=0,te=U.length;J<te;J++){const ie=U[J].range,se=U[J].text;if(!(Q<ie.startLineNumber||Q>ie.endLineNumber)&&!(Q===ie.startLineNumber&&ie.startColumn===Y&&ie.isEmpty()&&se&&se.length>0&&se.charAt(0)===`
`)&&!(Q===ie.startLineNumber&&ie.startColumn===1&&ie.isEmpty()&&se&&se.length>0&&se.charAt(se.length-1)===`
`)){X=!1;break}}if(X){const J=new Range$2(Q,1,Q,Y);D.push(new ValidAnnotatedEditOperation(null,J,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(w,D,O,W)}_applyUndo(w,D,O,W){const U=w.map(K=>{const q=this.getPositionAt(K.newPosition),G=this.getPositionAt(K.newEnd);return{range:new Range$2(q.lineNumber,q.column,G.lineNumber,G.column),text:K.oldText}});this._applyUndoRedoEdits(U,D,!0,!1,O,W)}_applyRedo(w,D,O,W){const U=w.map(K=>{const q=this.getPositionAt(K.oldPosition),G=this.getPositionAt(K.oldEnd);return{range:new Range$2(q.lineNumber,q.column,G.lineNumber,G.column),text:K.newText}});this._applyUndoRedoEdits(U,D,!1,!0,O,W)}_applyUndoRedoEdits(w,D,O,W,U,K){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=O,this._isRedoing=W,this.applyEdits(w,!1),this.setEOL(D),this._overwriteAlternativeVersionId(U)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(K),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(w,D=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const O=this._validateEditOperations(w);return this._doApplyEdits(O,D)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(w,D){const O=this._buffer.getLineCount(),W=this._buffer.applyEdits(w,this._options.trimAutoWhitespace,D),U=this._buffer.getLineCount(),K=W.changes;if(this._trimAutoWhitespaceLines=W.trimAutoWhitespaceLineNumbers,K.length!==0){for(let Q=0,Y=K.length;Q<Y;Q++){const X=K[Q];this._decorationsTree.acceptReplace(X.rangeOffset,X.rangeLength,X.text.length,X.forceMoveMarkers)}const q=[];this._increaseVersionId();let G=O;for(let Q=0,Y=K.length;Q<Y;Q++){const X=K[Q],[J]=countEOL(X.text);this._onDidChangeDecorations.fire();const te=X.range.startLineNumber,ie=X.range.endLineNumber,se=ie-te,re=J,ae=Math.min(se,re),le=re-se,de=U-G-le+te,oe=de,ue=de+re,pe=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new Position$1(oe,1)),this.getOffsetAt(new Position$1(ue,this.getLineMaxColumn(ue))),0),fe=LineInjectedText.fromDecorations(pe),Ce=new ArrayQueue(fe);for(let we=ae;we>=0;we--){const Oe=te+we,Te=de+we;Ce.takeFromEndWhile(Me=>Me.lineNumber>Te);const Re=Ce.takeFromEndWhile(Me=>Me.lineNumber===Te);q.push(new ModelRawLineChanged(Oe,this.getLineContent(Te),Re))}if(ae<se){const we=te+ae;q.push(new ModelRawLinesDeleted(we+1,ie))}if(ae<re){const we=new ArrayQueue(fe),Oe=te+ae,Te=re-ae,Re=U-G-Te+Oe+1,Me=[],Ne=[];for(let ze=0;ze<Te;ze++){const Qe=Re+ze;Ne[ze]=this.getLineContent(Qe),we.takeWhile(Ye=>Ye.lineNumber<Qe),Me[ze]=we.takeWhile(Ye=>Ye.lineNumber===Qe)}q.push(new ModelRawLinesInserted(Oe+1,te+re,Ne,Me))}G+=le}this._emitContentChangedEvent(new ModelRawContentChangedEvent(q,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:K,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return W.reverseEdits===null?void 0:W.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(w){if(w===null||w.size===0)return;const O=Array.from(w).map(W=>new ModelRawLineChanged(W,this.getLineContent(W),this._getInjectedTextInLine(W)));this._onDidChangeInjectedText.fire(new ModelInjectedTextChangedEvent(O))}changeDecorations(w,D=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(D,w)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(w,D){const O={addDecoration:(U,K)=>this._deltaDecorationsImpl(w,[],[{range:U,options:K}])[0],changeDecoration:(U,K)=>{this._changeDecorationImpl(U,K)},changeDecorationOptions:(U,K)=>{this._changeDecorationOptionsImpl(U,_normalizeOptions(K))},removeDecoration:U=>{this._deltaDecorationsImpl(w,[U],[])},deltaDecorations:(U,K)=>U.length===0&&K.length===0?[]:this._deltaDecorationsImpl(w,U,K)};let W=null;try{W=D(O)}catch(U){onUnexpectedError(U)}return O.addDecoration=invalidFunc$1,O.changeDecoration=invalidFunc$1,O.changeDecorationOptions=invalidFunc$1,O.removeDecoration=invalidFunc$1,O.deltaDecorations=invalidFunc$1,W}deltaDecorations(w,D,O=0){if(this._assertNotDisposed(),w||(w=[]),w.length===0&&D.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),onUnexpectedError(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(O,w,D)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(w){return this.getDecorationRange(w)}_setTrackedRange(w,D,O){const W=w?this._decorations[w]:null;if(!W)return D?this._deltaDecorationsImpl(0,[],[{range:D,options:TRACKED_RANGE_OPTIONS[O]}],!0)[0]:null;if(!D)return this._decorationsTree.delete(W),delete this._decorations[W.id],null;const U=this._validateRangeRelaxedNoAllocations(D),K=this._buffer.getOffsetAt(U.startLineNumber,U.startColumn),q=this._buffer.getOffsetAt(U.endLineNumber,U.endColumn);return this._decorationsTree.delete(W),W.reset(this.getVersionId(),K,q,U),W.setOptions(TRACKED_RANGE_OPTIONS[O]),this._decorationsTree.insert(W),W.id}removeAllDecorationsWithOwnerId(w){if(this._isDisposed)return;const D=this._decorationsTree.collectNodesFromOwner(w);for(let O=0,W=D.length;O<W;O++){const U=D[O];this._decorationsTree.delete(U),delete this._decorations[U.id]}}getDecorationOptions(w){const D=this._decorations[w];return D?D.options:null}getDecorationRange(w){const D=this._decorations[w];return D?this._decorationsTree.getNodeRange(this,D):null}getLineDecorations(w,D=0,O=!1){return w<1||w>this.getLineCount()?[]:this.getLinesDecorations(w,w,D,O)}getLinesDecorations(w,D,O=0,W=!1,U=!1){const K=this.getLineCount(),q=Math.min(K,Math.max(1,w)),G=Math.min(K,Math.max(1,D)),Q=this.getLineMaxColumn(G),Y=new Range$2(q,1,G,Q),X=this._getDecorationsInRange(Y,O,W,U);return pushMany(X,this._decorationProvider.getDecorationsInRange(Y,O,W)),X}getDecorationsInRange(w,D=0,O=!1,W=!1,U=!1){const K=this.validateRange(w),q=this._getDecorationsInRange(K,D,O,U);return pushMany(q,this._decorationProvider.getDecorationsInRange(K,D,O,W)),q}getOverviewRulerDecorations(w=0,D=!1){return this._decorationsTree.getAll(this,w,D,!0,!1)}getInjectedTextDecorations(w=0){return this._decorationsTree.getAllInjectedText(this,w)}_getInjectedTextInLine(w){const D=this._buffer.getOffsetAt(w,1),O=D+this._buffer.getLineLength(w),W=this._decorationsTree.getInjectedTextInInterval(this,D,O,0);return LineInjectedText.fromDecorations(W).filter(U=>U.lineNumber===w)}getAllDecorations(w=0,D=!1){let O=this._decorationsTree.getAll(this,w,D,!1,!1);return O=O.concat(this._decorationProvider.getAllDecorations(w,D)),O}getAllMarginDecorations(w=0){return this._decorationsTree.getAll(this,w,!1,!1,!0)}_getDecorationsInRange(w,D,O,W){const U=this._buffer.getOffsetAt(w.startLineNumber,w.startColumn),K=this._buffer.getOffsetAt(w.endLineNumber,w.endColumn);return this._decorationsTree.getAllInInterval(this,U,K,D,O,W)}getRangeAt(w,D){return this._buffer.getRangeAt(w,D-w)}_changeDecorationImpl(w,D){const O=this._decorations[w];if(!O)return;if(O.options.after){const q=this.getDecorationRange(w);this._onDidChangeDecorations.recordLineAffectedByInjectedText(q.endLineNumber)}if(O.options.before){const q=this.getDecorationRange(w);this._onDidChangeDecorations.recordLineAffectedByInjectedText(q.startLineNumber)}const W=this._validateRangeRelaxedNoAllocations(D),U=this._buffer.getOffsetAt(W.startLineNumber,W.startColumn),K=this._buffer.getOffsetAt(W.endLineNumber,W.endColumn);this._decorationsTree.delete(O),O.reset(this.getVersionId(),U,K,W),this._decorationsTree.insert(O),this._onDidChangeDecorations.checkAffectedAndFire(O.options),O.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(W.endLineNumber),O.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(W.startLineNumber)}_changeDecorationOptionsImpl(w,D){const O=this._decorations[w];if(!O)return;const W=!!(O.options.overviewRuler&&O.options.overviewRuler.color),U=!!(D.overviewRuler&&D.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(O.options),this._onDidChangeDecorations.checkAffectedAndFire(D),O.options.after||D.after){const G=this._decorationsTree.getNodeRange(this,O);this._onDidChangeDecorations.recordLineAffectedByInjectedText(G.endLineNumber)}if(O.options.before||D.before){const G=this._decorationsTree.getNodeRange(this,O);this._onDidChangeDecorations.recordLineAffectedByInjectedText(G.startLineNumber)}const K=W!==U,q=isOptionsInjectedText(D)!==isNodeInjectedText(O);K||q?(this._decorationsTree.delete(O),O.setOptions(D),this._decorationsTree.insert(O)):O.setOptions(D)}_deltaDecorationsImpl(w,D,O,W=!1){const U=this.getVersionId(),K=D.length;let q=0;const G=O.length;let Q=0;this._onDidChangeDecorations.beginDeferredEmit();try{const Y=new Array(G);for(;q<K||Q<G;){let X=null;if(q<K){do X=this._decorations[D[q++]];while(!X&&q<K);if(X){if(X.options.after){const J=this._decorationsTree.getNodeRange(this,X);this._onDidChangeDecorations.recordLineAffectedByInjectedText(J.endLineNumber)}if(X.options.before){const J=this._decorationsTree.getNodeRange(this,X);this._onDidChangeDecorations.recordLineAffectedByInjectedText(J.startLineNumber)}this._decorationsTree.delete(X),W||this._onDidChangeDecorations.checkAffectedAndFire(X.options)}}if(Q<G){if(!X){const ae=++this._lastDecorationId,le=`${this._instanceId};${ae}`;X=new IntervalNode(le,0,0),this._decorations[le]=X}const J=O[Q],te=this._validateRangeRelaxedNoAllocations(J.range),ie=_normalizeOptions(J.options),se=this._buffer.getOffsetAt(te.startLineNumber,te.startColumn),re=this._buffer.getOffsetAt(te.endLineNumber,te.endColumn);X.ownerId=w,X.reset(U,se,re,te),X.setOptions(ie),X.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(te.endLineNumber),X.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(te.startLineNumber),W||this._onDidChangeDecorations.checkAffectedAndFire(ie),this._decorationsTree.insert(X),Y[Q]=X.id,Q++}else X&&delete this._decorations[X.id]}return Y}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(w,D){typeof w=="string"?(this._languageSelectionListener.clear(),this._setLanguage(w,D)):(this._languageSelectionListener.value=w.onDidChange(()=>this._setLanguage(w.languageId,D)),this._setLanguage(w.languageId,D))}_setLanguage(w,D){this.tokenization.setLanguageId(w,D),this._languageService.requestRichLanguageFeatures(w)}getLanguageIdAtPosition(w,D){return this.tokenization.getLanguageIdAtPosition(w,D)}getWordAtPosition(w){return this._tokenizationTextModelPart.getWordAtPosition(w)}getWordUntilPosition(w){return this._tokenizationTextModelPart.getWordUntilPosition(w)}normalizePosition(w,D){return w}getLineIndentColumn(w){return indentOfLine(this.getLineContent(w))+1}};TextModel=TextModel_1=__decorate$15([__param$12(4,IUndoRedoService),__param$12(5,ILanguageService),__param$12(6,ILanguageConfigurationService),__param$12(7,IInstantiationService)],TextModel);function indentOfLine(F){let w=0;for(const D of F)if(D===" "||D==="	")w++;else break;return w}function isNodeInOverviewRuler(F){return!!(F.options.overviewRuler&&F.options.overviewRuler.color)}function isOptionsInjectedText(F){return!!F.after||!!F.before}function isNodeInjectedText(F){return!!F.options.after||!!F.options.before}class DecorationsTrees{constructor(){this._decorationsTree0=new IntervalTree,this._decorationsTree1=new IntervalTree,this._injectedTextDecorationsTree=new IntervalTree}ensureAllNodesHaveRanges(w){this.getAll(w,0,!1,!1,!1)}_ensureNodesHaveRanges(w,D){for(const O of D)O.range===null&&(O.range=w.getRangeAt(O.cachedAbsoluteStart,O.cachedAbsoluteEnd));return D}getAllInInterval(w,D,O,W,U,K){const q=w.getVersionId(),G=this._intervalSearch(D,O,W,U,q,K);return this._ensureNodesHaveRanges(w,G)}_intervalSearch(w,D,O,W,U,K){const q=this._decorationsTree0.intervalSearch(w,D,O,W,U,K),G=this._decorationsTree1.intervalSearch(w,D,O,W,U,K),Q=this._injectedTextDecorationsTree.intervalSearch(w,D,O,W,U,K);return q.concat(G).concat(Q)}getInjectedTextInInterval(w,D,O,W){const U=w.getVersionId(),K=this._injectedTextDecorationsTree.intervalSearch(D,O,W,!1,U,!1);return this._ensureNodesHaveRanges(w,K).filter(q=>q.options.showIfCollapsed||!q.range.isEmpty())}getAllInjectedText(w,D){const O=w.getVersionId(),W=this._injectedTextDecorationsTree.search(D,!1,O,!1);return this._ensureNodesHaveRanges(w,W).filter(U=>U.options.showIfCollapsed||!U.range.isEmpty())}getAll(w,D,O,W,U){const K=w.getVersionId(),q=this._search(D,O,W,K,U);return this._ensureNodesHaveRanges(w,q)}_search(w,D,O,W,U){if(O)return this._decorationsTree1.search(w,D,W,U);{const K=this._decorationsTree0.search(w,D,W,U),q=this._decorationsTree1.search(w,D,W,U),G=this._injectedTextDecorationsTree.search(w,D,W,U);return K.concat(q).concat(G)}}collectNodesFromOwner(w){const D=this._decorationsTree0.collectNodesFromOwner(w),O=this._decorationsTree1.collectNodesFromOwner(w),W=this._injectedTextDecorationsTree.collectNodesFromOwner(w);return D.concat(O).concat(W)}collectNodesPostOrder(){const w=this._decorationsTree0.collectNodesPostOrder(),D=this._decorationsTree1.collectNodesPostOrder(),O=this._injectedTextDecorationsTree.collectNodesPostOrder();return w.concat(D).concat(O)}insert(w){isNodeInjectedText(w)?this._injectedTextDecorationsTree.insert(w):isNodeInOverviewRuler(w)?this._decorationsTree1.insert(w):this._decorationsTree0.insert(w)}delete(w){isNodeInjectedText(w)?this._injectedTextDecorationsTree.delete(w):isNodeInOverviewRuler(w)?this._decorationsTree1.delete(w):this._decorationsTree0.delete(w)}getNodeRange(w,D){const O=w.getVersionId();return D.cachedVersionId!==O&&this._resolveNode(D,O),D.range===null&&(D.range=w.getRangeAt(D.cachedAbsoluteStart,D.cachedAbsoluteEnd)),D.range}_resolveNode(w,D){isNodeInjectedText(w)?this._injectedTextDecorationsTree.resolveNode(w,D):isNodeInOverviewRuler(w)?this._decorationsTree1.resolveNode(w,D):this._decorationsTree0.resolveNode(w,D)}acceptReplace(w,D,O,W){this._decorationsTree0.acceptReplace(w,D,O,W),this._decorationsTree1.acceptReplace(w,D,O,W),this._injectedTextDecorationsTree.acceptReplace(w,D,O,W)}}function cleanClassName(F){return F.replace(/[^a-z0-9\-_]/gi," ")}class DecorationOptions{constructor(w){this.color=w.color||"",this.darkColor=w.darkColor||""}}class ModelDecorationOverviewRulerOptions extends DecorationOptions{constructor(w){super(w),this._resolvedColor=null,this.position=typeof w.position=="number"?w.position:OverviewRulerLane$1.Center}getColor(w){return this._resolvedColor||(w.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,w):this._resolvedColor=this._resolveColor(this.color,w)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(w,D){if(typeof w=="string")return w;const O=w?D.getColor(w.id):null;return O?O.toString():""}}class ModelDecorationGlyphMarginOptions{constructor(w){this.position=w?.position??GlyphMarginLane$1.Center,this.persistLane=w?.persistLane}}class ModelDecorationMinimapOptions extends DecorationOptions{constructor(w){super(w),this.position=w.position,this.sectionHeaderStyle=w.sectionHeaderStyle??null,this.sectionHeaderText=w.sectionHeaderText??null}getColor(w){return this._resolvedColor||(w.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,w):this._resolvedColor=this._resolveColor(this.color,w)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(w,D){return typeof w=="string"?Color.fromHex(w):D.getColor(w.id)}}class ModelDecorationInjectedTextOptions{static from(w){return w instanceof ModelDecorationInjectedTextOptions?w:new ModelDecorationInjectedTextOptions(w)}constructor(w){this.content=w.content||"",this.inlineClassName=w.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=w.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=w.attachedData||null,this.cursorStops=w.cursorStops||null}}class ModelDecorationOptions{static register(w){return new ModelDecorationOptions(w)}static createDynamic(w){return new ModelDecorationOptions(w)}constructor(w){this.description=w.description,this.blockClassName=w.blockClassName?cleanClassName(w.blockClassName):null,this.blockDoesNotCollapse=w.blockDoesNotCollapse??null,this.blockIsAfterEnd=w.blockIsAfterEnd??null,this.blockPadding=w.blockPadding??null,this.stickiness=w.stickiness||0,this.zIndex=w.zIndex||0,this.className=w.className?cleanClassName(w.className):null,this.shouldFillLineOnLineBreak=w.shouldFillLineOnLineBreak??null,this.hoverMessage=w.hoverMessage||null,this.glyphMarginHoverMessage=w.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=w.lineNumberHoverMessage||null,this.isWholeLine=w.isWholeLine||!1,this.showIfCollapsed=w.showIfCollapsed||!1,this.collapseOnReplaceEdit=w.collapseOnReplaceEdit||!1,this.overviewRuler=w.overviewRuler?new ModelDecorationOverviewRulerOptions(w.overviewRuler):null,this.minimap=w.minimap?new ModelDecorationMinimapOptions(w.minimap):null,this.glyphMargin=w.glyphMarginClassName?new ModelDecorationGlyphMarginOptions(w.glyphMargin):null,this.glyphMarginClassName=w.glyphMarginClassName?cleanClassName(w.glyphMarginClassName):null,this.linesDecorationsClassName=w.linesDecorationsClassName?cleanClassName(w.linesDecorationsClassName):null,this.lineNumberClassName=w.lineNumberClassName?cleanClassName(w.lineNumberClassName):null,this.linesDecorationsTooltip=w.linesDecorationsTooltip?htmlAttributeEncodeValue(w.linesDecorationsTooltip):null,this.firstLineDecorationClassName=w.firstLineDecorationClassName?cleanClassName(w.firstLineDecorationClassName):null,this.marginClassName=w.marginClassName?cleanClassName(w.marginClassName):null,this.inlineClassName=w.inlineClassName?cleanClassName(w.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=w.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=w.beforeContentClassName?cleanClassName(w.beforeContentClassName):null,this.afterContentClassName=w.afterContentClassName?cleanClassName(w.afterContentClassName):null,this.after=w.after?ModelDecorationInjectedTextOptions.from(w.after):null,this.before=w.before?ModelDecorationInjectedTextOptions.from(w.before):null,this.hideInCommentTokens=w.hideInCommentTokens??!1,this.hideInStringTokens=w.hideInStringTokens??!1}}ModelDecorationOptions.EMPTY=ModelDecorationOptions.register({description:"empty"});const TRACKED_RANGE_OPTIONS=[ModelDecorationOptions.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),ModelDecorationOptions.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),ModelDecorationOptions.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),ModelDecorationOptions.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function _normalizeOptions(F){return F instanceof ModelDecorationOptions?F:ModelDecorationOptions.createDynamic(F)}class DidChangeDecorationsEmitter extends Disposable{constructor(w){super(),this.handleBeforeFire=w,this._actual=this._register(new Emitter$1),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(w){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(w)}checkAffectedAndFire(w){this._affectsMinimap||=!!w.minimap?.position,this._affectsOverviewRuler||=!!w.overviewRuler?.color,this._affectsGlyphMargin||=!!w.glyphMarginClassName,this._affectsLineNumber||=!!w.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);const w={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(w)}}class DidChangeContentEmitter extends Disposable{constructor(){super(),this._fastEmitter=this._register(new Emitter$1),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new Emitter$1),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(w=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=w;const D=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(D),this._slowEmitter.fire(D)}}fire(w){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(w):this._deferredEvent=w;return}this._fastEmitter.fire(w),this._slowEmitter.fire(w)}}const ILabelService=createDecorator("labelService");class StringIterator{constructor(){this._value="",this._pos=0}reset(w){return this._value=w,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(w){const D=w.charCodeAt(0),O=this._value.charCodeAt(this._pos);return D-O}value(){return this._value[this._pos]}}class ConfigKeysIterator{constructor(w=!0){this._caseSensitive=w}reset(w){return this._value=w,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let w=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(w)this._from++;else break;else w=!1;return this}cmp(w){return this._caseSensitive?compareSubstring(w,this._value,0,w.length,this._from,this._to):compareSubstringIgnoreCase(w,this._value,0,w.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class PathIterator{constructor(w=!0,D=!0){this._splitOnBackslash=w,this._caseSensitive=D}reset(w){this._from=0,this._to=0,this._value=w,this._valueLen=w.length;for(let D=w.length-1;D>=0;D--,this._valueLen--){const O=this._value.charCodeAt(D);if(!(O===47||this._splitOnBackslash&&O===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let w=!0;for(;this._to<this._valueLen;this._to++){const D=this._value.charCodeAt(this._to);if(D===47||this._splitOnBackslash&&D===92)if(w)this._from++;else break;else w=!1}return this}cmp(w){return this._caseSensitive?compareSubstring(w,this._value,0,w.length,this._from,this._to):compareSubstringIgnoreCase(w,this._value,0,w.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class UriIterator{constructor(w,D){this._ignorePathCasing=w,this._ignoreQueryAndFragment=D,this._states=[],this._stateIdx=0}reset(w){return this._value=w,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new PathIterator(!1,!this._ignorePathCasing(w)),this._pathIterator.reset(w.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(w)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(w){if(this._states[this._stateIdx]===1)return compareIgnoreCase(w,this._value.scheme);if(this._states[this._stateIdx]===2)return compareIgnoreCase(w,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(w);if(this._states[this._stateIdx]===4)return compare(w,this._value.query);if(this._states[this._stateIdx]===5)return compare(w,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}class TernarySearchTreeNode{constructor(){this.height=1}rotateLeft(){const w=this.right;return this.right=w.left,w.left=this,this.updateHeight(),w.updateHeight(),w}rotateRight(){const w=this.left;return this.left=w.right,w.right=this,this.updateHeight(),w.updateHeight(),w}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}}class TernarySearchTree{static forUris(w=()=>!1,D=()=>!1){return new TernarySearchTree(new UriIterator(w,D))}static forStrings(){return new TernarySearchTree(new StringIterator)}static forConfigKeys(){return new TernarySearchTree(new ConfigKeysIterator)}constructor(w){this._iter=w}clear(){this._root=void 0}set(w,D){const O=this._iter.reset(w);let W;this._root||(this._root=new TernarySearchTreeNode,this._root.segment=O.value());const U=[];for(W=this._root;;){const q=O.cmp(W.segment);if(q>0)W.left||(W.left=new TernarySearchTreeNode,W.left.segment=O.value()),U.push([-1,W]),W=W.left;else if(q<0)W.right||(W.right=new TernarySearchTreeNode,W.right.segment=O.value()),U.push([1,W]),W=W.right;else if(O.hasNext())O.next(),W.mid||(W.mid=new TernarySearchTreeNode,W.mid.segment=O.value()),U.push([0,W]),W=W.mid;else break}const K=W.value;W.value=D,W.key=w;for(let q=U.length-1;q>=0;q--){const G=U[q][1];G.updateHeight();const Q=G.balanceFactor();if(Q<-1||Q>1){const Y=U[q][0],X=U[q+1][0];if(Y===1&&X===1)U[q][1]=G.rotateLeft();else if(Y===-1&&X===-1)U[q][1]=G.rotateRight();else if(Y===1&&X===-1)G.right=U[q+1][1]=U[q+1][1].rotateRight(),U[q][1]=G.rotateLeft();else if(Y===-1&&X===1)G.left=U[q+1][1]=U[q+1][1].rotateLeft(),U[q][1]=G.rotateRight();else throw new Error;if(q>0)switch(U[q-1][0]){case-1:U[q-1][1].left=U[q][1];break;case 1:U[q-1][1].right=U[q][1];break;case 0:U[q-1][1].mid=U[q][1];break}else this._root=U[0][1]}}return K}get(w){return this._getNode(w)?.value}_getNode(w){const D=this._iter.reset(w);let O=this._root;for(;O;){const W=D.cmp(O.segment);if(W>0)O=O.left;else if(W<0)O=O.right;else if(D.hasNext())D.next(),O=O.mid;else break}return O}has(w){const D=this._getNode(w);return!(D?.value===void 0&&D?.mid===void 0)}delete(w){return this._delete(w,!1)}deleteSuperstr(w){return this._delete(w,!0)}_delete(w,D){const O=this._iter.reset(w),W=[];let U=this._root;for(;U;){const K=O.cmp(U.segment);if(K>0)W.push([-1,U]),U=U.left;else if(K<0)W.push([1,U]),U=U.right;else if(O.hasNext())O.next(),W.push([0,U]),U=U.mid;else break}if(U){if(D?(U.left=void 0,U.mid=void 0,U.right=void 0,U.height=1):(U.key=void 0,U.value=void 0),!U.mid&&!U.value)if(U.left&&U.right){const K=this._min(U.right);if(K.key){const{key:q,value:G,segment:Q}=K;this._delete(K.key,!1),U.key=q,U.value=G,U.segment=Q}}else{const K=U.left??U.right;if(W.length>0){const[q,G]=W[W.length-1];switch(q){case-1:G.left=K;break;case 0:G.mid=K;break;case 1:G.right=K;break}}else this._root=K}for(let K=W.length-1;K>=0;K--){const q=W[K][1];q.updateHeight();const G=q.balanceFactor();if(G>1?(q.right.balanceFactor()>=0||(q.right=q.right.rotateRight()),W[K][1]=q.rotateLeft()):G<-1&&(q.left.balanceFactor()<=0||(q.left=q.left.rotateLeft()),W[K][1]=q.rotateRight()),K>0)switch(W[K-1][0]){case-1:W[K-1][1].left=W[K][1];break;case 1:W[K-1][1].right=W[K][1];break;case 0:W[K-1][1].mid=W[K][1];break}else this._root=W[0][1]}}}_min(w){for(;w.left;)w=w.left;return w}findSubstr(w){const D=this._iter.reset(w);let O=this._root,W;for(;O;){const U=D.cmp(O.segment);if(U>0)O=O.left;else if(U<0)O=O.right;else if(D.hasNext())D.next(),W=O.value||W,O=O.mid;else break}return O&&O.value||W}findSuperstr(w){return this._findSuperstrOrElement(w,!1)}_findSuperstrOrElement(w,D){const O=this._iter.reset(w);let W=this._root;for(;W;){const U=O.cmp(W.segment);if(U>0)W=W.left;else if(U<0)W=W.right;else if(O.hasNext())O.next(),W=W.mid;else return W.mid?this._entries(W.mid):D?W.value:void 0}}forEach(w){for(const[D,O]of this)w(O,D)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(w){const D=[];return this._dfsEntries(w,D),D[Symbol.iterator]()}_dfsEntries(w,D){w&&(w.left&&this._dfsEntries(w.left,D),w.value&&D.push([w.key,w.value]),w.mid&&this._dfsEntries(w.mid,D),w.right&&this._dfsEntries(w.right,D))}}const IWorkspaceContextService=createDecorator("contextService");function isSingleFolderWorkspaceIdentifier(F){const w=F;return typeof w?.id=="string"&&URI.isUri(w.uri)}function isEmptyWorkspaceIdentifier(F){return typeof F?.id=="string"&&!isSingleFolderWorkspaceIdentifier(F)&&!isWorkspaceIdentifier(F)}const UNKNOWN_EMPTY_WINDOW_WORKSPACE={id:"empty-window"};function toWorkspaceIdentifier(F,w){if(typeof F=="string"||typeof F>"u")return typeof F=="string"?{id:basename$1(F)}:UNKNOWN_EMPTY_WINDOW_WORKSPACE;const D=F;return D.configuration?{id:D.id,configPath:D.configuration}:D.folders.length===1?{id:D.id,uri:D.folders[0].uri}:{id:D.id}}function isWorkspaceIdentifier(F){const w=F;return typeof w?.id=="string"&&URI.isUri(w.configPath)}class WorkspaceFolder{constructor(w,D){this.raw=D,this.uri=w.uri,this.index=w.index,this.name=w.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const WORKSPACE_EXTENSION="code-workspace";localize("codeWorkspace","Code Workspace");const STANDALONE_EDITOR_WORKSPACE_ID="4064f6ec-cb38-4ad0-af64-ee6467e63c82";function normalizeDriveLetter(F,w=isWindows){return hasDriveLetter(F,w)?F.charAt(0).toUpperCase()+F.slice(1):F}const generateUuid=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let F;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?F=crypto.getRandomValues.bind(crypto):F=function(O){for(let W=0;W<O.length;W++)O[W]=Math.floor(Math.random()*256);return O};const w=new Uint8Array(16),D=[];for(let O=0;O<256;O++)D.push(O.toString(16).padStart(2,"0"));return function(){F(w),w[6]=w[6]&15|64,w[8]=w[8]&63|128;let W=0,U="";return U+=D[w[W++]],U+=D[w[W++]],U+=D[w[W++]],U+=D[w[W++]],U+="-",U+=D[w[W++]],U+=D[w[W++]],U+="-",U+=D[w[W++]],U+=D[w[W++]],U+="-",U+=D[w[W++]],U+=D[w[W++]],U+="-",U+=D[w[W++]],U+=D[w[W++]],U+=D[w[W++]],U+=D[w[W++]],U+=D[w[W++]],U+=D[w[W++]],U}}();var __decorate$14=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$11=function(F,w){return function(D,O){w(D,O,F)}};class CompositeSnippetVariableResolver{constructor(w){this._delegates=w}resolve(w){for(const D of this._delegates){const O=D.resolve(w);if(O!==void 0)return O}}}class SelectionBasedVariableResolver{constructor(w,D,O,W){this._model=w,this._selection=D,this._selectionIdx=O,this._overtypingCapturer=W}resolve(w){const{name:D}=w;if(D==="SELECTION"||D==="TM_SELECTED_TEXT"){let O=this._model.getValueInRange(this._selection)||void 0,W=this._selection.startLineNumber!==this._selection.endLineNumber;if(!O&&this._overtypingCapturer){const U=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);U&&(O=U.value,W=U.multiline)}if(O&&W&&w.snippet){const U=this._model.getLineContent(this._selection.startLineNumber),K=getLeadingWhitespace(U,0,this._selection.startColumn-1);let q=K;w.snippet.walk(Q=>Q===w?!1:(Q instanceof Text&&(q=getLeadingWhitespace(splitLines(Q.value).pop())),!0));const G=commonPrefixLength(q,K);O=O.replace(/(\r\n|\r|\n)(.*)/g,(Q,Y,X)=>`${Y}${q.substr(G)}${X}`)}return O}else{if(D==="TM_CURRENT_LINE")return this._model.getLineContent(this._selection.positionLineNumber);if(D==="TM_CURRENT_WORD"){const O=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return O&&O.word||void 0}else{if(D==="TM_LINE_INDEX")return String(this._selection.positionLineNumber-1);if(D==="TM_LINE_NUMBER")return String(this._selection.positionLineNumber);if(D==="CURSOR_INDEX")return String(this._selectionIdx);if(D==="CURSOR_NUMBER")return String(this._selectionIdx+1)}}}}class ModelBasedVariableResolver{constructor(w,D){this._labelService=w,this._model=D}resolve(w){const{name:D}=w;if(D==="TM_FILENAME")return basename$1(this._model.uri.fsPath);if(D==="TM_FILENAME_BASE"){const O=basename$1(this._model.uri.fsPath),W=O.lastIndexOf(".");return W<=0?O:O.slice(0,W)}else{if(D==="TM_DIRECTORY")return dirname$1(this._model.uri.fsPath)==="."?"":this._labelService.getUriLabel(dirname(this._model.uri));if(D==="TM_FILEPATH")return this._labelService.getUriLabel(this._model.uri);if(D==="RELATIVE_FILEPATH")return this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0})}}}class ClipboardBasedVariableResolver{constructor(w,D,O,W){this._readClipboardText=w,this._selectionIdx=D,this._selectionCount=O,this._spread=W}resolve(w){if(w.name!=="CLIPBOARD")return;const D=this._readClipboardText();if(D){if(this._spread){const O=D.split(/\r\n|\n|\r/).filter(W=>!isFalsyOrWhitespace(W));if(O.length===this._selectionCount)return O[this._selectionIdx]}return D}}}let CommentBasedVariableResolver=class{constructor(w,D,O){this._model=w,this._selection=D,this._languageConfigurationService=O}resolve(w){const{name:D}=w,O=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),W=this._languageConfigurationService.getLanguageConfiguration(O).comments;if(W){if(D==="LINE_COMMENT")return W.lineCommentToken||void 0;if(D==="BLOCK_COMMENT_START")return W.blockCommentStartToken||void 0;if(D==="BLOCK_COMMENT_END")return W.blockCommentEndToken||void 0}}};CommentBasedVariableResolver=__decorate$14([__param$11(2,ILanguageConfigurationService)],CommentBasedVariableResolver);class TimeBasedVariableResolver{constructor(){this._date=new Date}static{this.dayNames=[localize("Sunday","Sunday"),localize("Monday","Monday"),localize("Tuesday","Tuesday"),localize("Wednesday","Wednesday"),localize("Thursday","Thursday"),localize("Friday","Friday"),localize("Saturday","Saturday")]}static{this.dayNamesShort=[localize("SundayShort","Sun"),localize("MondayShort","Mon"),localize("TuesdayShort","Tue"),localize("WednesdayShort","Wed"),localize("ThursdayShort","Thu"),localize("FridayShort","Fri"),localize("SaturdayShort","Sat")]}static{this.monthNames=[localize("January","January"),localize("February","February"),localize("March","March"),localize("April","April"),localize("May","May"),localize("June","June"),localize("July","July"),localize("August","August"),localize("September","September"),localize("October","October"),localize("November","November"),localize("December","December")]}static{this.monthNamesShort=[localize("JanuaryShort","Jan"),localize("FebruaryShort","Feb"),localize("MarchShort","Mar"),localize("AprilShort","Apr"),localize("MayShort","May"),localize("JuneShort","Jun"),localize("JulyShort","Jul"),localize("AugustShort","Aug"),localize("SeptemberShort","Sep"),localize("OctoberShort","Oct"),localize("NovemberShort","Nov"),localize("DecemberShort","Dec")]}resolve(w){const{name:D}=w;if(D==="CURRENT_YEAR")return String(this._date.getFullYear());if(D==="CURRENT_YEAR_SHORT")return String(this._date.getFullYear()).slice(-2);if(D==="CURRENT_MONTH")return String(this._date.getMonth().valueOf()+1).padStart(2,"0");if(D==="CURRENT_DATE")return String(this._date.getDate().valueOf()).padStart(2,"0");if(D==="CURRENT_HOUR")return String(this._date.getHours().valueOf()).padStart(2,"0");if(D==="CURRENT_MINUTE")return String(this._date.getMinutes().valueOf()).padStart(2,"0");if(D==="CURRENT_SECOND")return String(this._date.getSeconds().valueOf()).padStart(2,"0");if(D==="CURRENT_DAY_NAME")return TimeBasedVariableResolver.dayNames[this._date.getDay()];if(D==="CURRENT_DAY_NAME_SHORT")return TimeBasedVariableResolver.dayNamesShort[this._date.getDay()];if(D==="CURRENT_MONTH_NAME")return TimeBasedVariableResolver.monthNames[this._date.getMonth()];if(D==="CURRENT_MONTH_NAME_SHORT")return TimeBasedVariableResolver.monthNamesShort[this._date.getMonth()];if(D==="CURRENT_SECONDS_UNIX")return String(Math.floor(this._date.getTime()/1e3));if(D==="CURRENT_TIMEZONE_OFFSET"){const O=this._date.getTimezoneOffset(),W=O>0?"-":"+",U=Math.trunc(Math.abs(O/60)),K=U<10?"0"+U:U,q=Math.abs(O)-U*60,G=q<10?"0"+q:q;return W+K+":"+G}}}class WorkspaceBasedVariableResolver{constructor(w){this._workspaceService=w}resolve(w){if(!this._workspaceService)return;const D=toWorkspaceIdentifier(this._workspaceService.getWorkspace());if(!isEmptyWorkspaceIdentifier(D)){if(w.name==="WORKSPACE_NAME")return this._resolveWorkspaceName(D);if(w.name==="WORKSPACE_FOLDER")return this._resoveWorkspacePath(D)}}_resolveWorkspaceName(w){if(isSingleFolderWorkspaceIdentifier(w))return basename$1(w.uri.path);let D=basename$1(w.configPath.path);return D.endsWith(WORKSPACE_EXTENSION)&&(D=D.substr(0,D.length-WORKSPACE_EXTENSION.length-1)),D}_resoveWorkspacePath(w){if(isSingleFolderWorkspaceIdentifier(w))return normalizeDriveLetter(w.uri.fsPath);const D=basename$1(w.configPath.path);let O=w.configPath.fsPath;return O.endsWith(D)&&(O=O.substr(0,O.length-D.length-1)),O?normalizeDriveLetter(O):"/"}}class RandomBasedVariableResolver{resolve(w){const{name:D}=w;if(D==="RANDOM")return Math.random().toString().slice(-6);if(D==="RANDOM_HEX")return Math.random().toString(16).slice(-6);if(D==="UUID")return generateUuid()}}var __decorate$13=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$10=function(F,w){return function(D,O){w(D,O,F)}},SnippetSession_1;class OneSnippet{static{this._decor={active:ModelDecorationOptions.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:ModelDecorationOptions.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:ModelDecorationOptions.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:ModelDecorationOptions.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})}}constructor(w,D,O){this._editor=w,this._snippet=D,this._snippetLineLeadingWhitespace=O,this._offset=-1,this._nestingLevel=1,this._placeholderGroups=groupBy(D.placeholders,Placeholder.compareByIndex),this._placeholderGroupsIdx=-1}initialize(w){this._offset=w.newPosition}dispose(){this._placeholderDecorations&&this._editor.removeDecorations([...this._placeholderDecorations.values()]),this._placeholderGroups.length=0}_initDecorations(){if(this._offset===-1)throw new Error("Snippet not initialized!");if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;const w=this._editor.getModel();this._editor.changeDecorations(D=>{for(const O of this._snippet.placeholders){const W=this._snippet.offset(O),U=this._snippet.fullLen(O),K=Range$2.fromPositions(w.getPositionAt(this._offset+W),w.getPositionAt(this._offset+W+U)),q=O.isFinalTabstop?OneSnippet._decor.inactiveFinal:OneSnippet._decor.inactive,G=D.addDecoration(K,q);this._placeholderDecorations.set(O,G)}})}move(w){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){const W=[];for(const U of this._placeholderGroups[this._placeholderGroupsIdx])if(U.transform){const K=this._placeholderDecorations.get(U),q=this._editor.getModel().getDecorationRange(K),G=this._editor.getModel().getValueInRange(q),Q=U.transform.resolve(G).split(/\r\n|\r|\n/);for(let Y=1;Y<Q.length;Y++)Q[Y]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+Q[Y]);W.push(EditOperation.replace(q,Q.join(this._editor.getModel().getEOL())))}W.length>0&&this._editor.executeEdits("snippet.placeholderTransform",W)}let D=!1;w===!0&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,D=!0):w===!1&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,D=!0);const O=this._editor.getModel().changeDecorations(W=>{const U=new Set,K=[];for(const q of this._placeholderGroups[this._placeholderGroupsIdx]){const G=this._placeholderDecorations.get(q),Q=this._editor.getModel().getDecorationRange(G);K.push(new Selection$1(Q.startLineNumber,Q.startColumn,Q.endLineNumber,Q.endColumn)),D=D&&this._hasPlaceholderBeenCollapsed(q),W.changeDecorationOptions(G,q.isFinalTabstop?OneSnippet._decor.activeFinal:OneSnippet._decor.active),U.add(q);for(const Y of this._snippet.enclosingPlaceholders(q)){const X=this._placeholderDecorations.get(Y);W.changeDecorationOptions(X,Y.isFinalTabstop?OneSnippet._decor.activeFinal:OneSnippet._decor.active),U.add(Y)}}for(const[q,G]of this._placeholderDecorations)U.has(q)||W.changeDecorationOptions(G,q.isFinalTabstop?OneSnippet._decor.inactiveFinal:OneSnippet._decor.inactive);return K});return D?this.move(w):O??[]}_hasPlaceholderBeenCollapsed(w){let D=w;for(;D;){if(D instanceof Placeholder){const O=this._placeholderDecorations.get(D);if(this._editor.getModel().getDecorationRange(O).isEmpty()&&D.toString().length>0)return!0}D=D.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||this._placeholderGroups.length===0}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}get isTrivialSnippet(){if(this._snippet.placeholders.length===0)return!0;if(this._snippet.placeholders.length===1){const[w]=this._snippet.placeholders;if(w.isFinalTabstop&&this._snippet.rightMostDescendant===w)return!0}return!1}computePossibleSelections(){const w=new Map;for(const D of this._placeholderGroups){let O;for(const W of D){if(W.isFinalTabstop)break;O||(O=[],w.set(W.index,O));const U=this._placeholderDecorations.get(W),K=this._editor.getModel().getDecorationRange(U);if(!K){w.delete(W.index);break}O.push(K)}}return w}get activeChoice(){if(!this._placeholderDecorations)return;const w=this._placeholderGroups[this._placeholderGroupsIdx][0];if(!w?.choice)return;const D=this._placeholderDecorations.get(w);if(!D)return;const O=this._editor.getModel().getDecorationRange(D);if(O)return{range:O,choice:w.choice}}get hasChoice(){let w=!1;return this._snippet.walk(D=>(w=D instanceof Choice,!w)),w}merge(w){const D=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations(O=>{for(const W of this._placeholderGroups[this._placeholderGroupsIdx]){const U=w.shift();console.assert(U._offset!==-1),console.assert(!U._placeholderDecorations);const K=U._snippet.placeholderInfo.last.index;for(const G of U._snippet.placeholderInfo.all)G.isFinalTabstop?G.index=W.index+(K+1)/this._nestingLevel:G.index=W.index+G.index/this._nestingLevel;this._snippet.replace(W,U._snippet.children);const q=this._placeholderDecorations.get(W);O.removeDecoration(q),this._placeholderDecorations.delete(W);for(const G of U._snippet.placeholders){const Q=U._snippet.offset(G),Y=U._snippet.fullLen(G),X=Range$2.fromPositions(D.getPositionAt(U._offset+Q),D.getPositionAt(U._offset+Q+Y)),J=O.addDecoration(X,OneSnippet._decor.inactive);this._placeholderDecorations.set(G,J)}}this._placeholderGroups=groupBy(this._snippet.placeholders,Placeholder.compareByIndex)})}}const _defaultOptions$1={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let SnippetSession=SnippetSession_1=class{static adjustWhitespace(w,D,O,W,U){const K=w.getLineContent(D.lineNumber),q=getLeadingWhitespace(K,0,D.column-1);let G;return W.walk(Q=>{if(!(Q instanceof Text)||Q.parent instanceof Choice||U&&!U.has(Q))return!0;const Y=Q.value.split(/\r\n|\r|\n/);if(O){const J=W.offset(Q);if(J===0)Y[0]=w.normalizeIndentation(Y[0]);else{G=G??W.toString();const te=G.charCodeAt(J-1);(te===10||te===13)&&(Y[0]=w.normalizeIndentation(q+Y[0]))}for(let te=1;te<Y.length;te++)Y[te]=w.normalizeIndentation(q+Y[te])}const X=Y.join(w.getEOL());return X!==Q.value&&(Q.parent.replace(Q,[new Text(X)]),G=void 0),!0}),q}static adjustSelection(w,D,O,W){if(O!==0||W!==0){const{positionLineNumber:U,positionColumn:K}=D,q=K-O,G=K+W,Q=w.validateRange({startLineNumber:U,startColumn:q,endLineNumber:U,endColumn:G});D=Selection$1.createWithDirection(Q.startLineNumber,Q.startColumn,Q.endLineNumber,Q.endColumn,D.getDirection())}return D}static createEditsAndSnippetsFromSelections(w,D,O,W,U,K,q,G,Q){const Y=[],X=[];if(!w.hasModel())return{edits:Y,snippets:X};const J=w.getModel(),te=w.invokeWithinContext(oe=>oe.get(IWorkspaceContextService)),ie=w.invokeWithinContext(oe=>new ModelBasedVariableResolver(oe.get(ILabelService),J)),se=()=>q,re=J.getValueInRange(SnippetSession_1.adjustSelection(J,w.getSelection(),O,0)),ae=J.getValueInRange(SnippetSession_1.adjustSelection(J,w.getSelection(),0,W)),le=J.getLineFirstNonWhitespaceColumn(w.getSelection().positionLineNumber),de=w.getSelections().map((oe,ue)=>({selection:oe,idx:ue})).sort((oe,ue)=>Range$2.compareRangesUsingStarts(oe.selection,ue.selection));for(const{selection:oe,idx:ue}of de){let pe=SnippetSession_1.adjustSelection(J,oe,O,0),fe=SnippetSession_1.adjustSelection(J,oe,0,W);re!==J.getValueInRange(pe)&&(pe=oe),ae!==J.getValueInRange(fe)&&(fe=oe);const Ce=oe.setStartPosition(pe.startLineNumber,pe.startColumn).setEndPosition(fe.endLineNumber,fe.endColumn),we=new SnippetParser().parse(D,!0,U),Oe=Ce.getStartPosition(),Te=SnippetSession_1.adjustWhitespace(J,Oe,K||ue>0&&le!==J.getLineFirstNonWhitespaceColumn(oe.positionLineNumber),we);we.resolveVariables(new CompositeSnippetVariableResolver([ie,new ClipboardBasedVariableResolver(se,ue,de.length,w.getOption(79)==="spread"),new SelectionBasedVariableResolver(J,oe,ue,G),new CommentBasedVariableResolver(J,oe,Q),new TimeBasedVariableResolver,new WorkspaceBasedVariableResolver(te),new RandomBasedVariableResolver])),Y[ue]=EditOperation.replace(Ce,we.toString()),Y[ue].identifier={major:ue,minor:0},Y[ue]._isTracked=!0,X[ue]=new OneSnippet(w,we,Te)}return{edits:Y,snippets:X}}static createEditsAndSnippetsFromEdits(w,D,O,W,U,K,q){if(!w.hasModel()||D.length===0)return{edits:[],snippets:[]};const G=[],Q=w.getModel(),Y=new SnippetParser,X=new TextmateSnippet,J=new CompositeSnippetVariableResolver([w.invokeWithinContext(ie=>new ModelBasedVariableResolver(ie.get(ILabelService),Q)),new ClipboardBasedVariableResolver(()=>U,0,w.getSelections().length,w.getOption(79)==="spread"),new SelectionBasedVariableResolver(Q,w.getSelection(),0,K),new CommentBasedVariableResolver(Q,w.getSelection(),q),new TimeBasedVariableResolver,new WorkspaceBasedVariableResolver(w.invokeWithinContext(ie=>ie.get(IWorkspaceContextService))),new RandomBasedVariableResolver]);D=D.sort((ie,se)=>Range$2.compareRangesUsingStarts(ie.range,se.range));let te=0;for(let ie=0;ie<D.length;ie++){const{range:se,template:re}=D[ie];if(ie>0){const ue=D[ie-1].range,pe=Range$2.fromPositions(ue.getEndPosition(),se.getStartPosition()),fe=new Text(Q.getValueInRange(pe));X.appendChild(fe),te+=fe.value.length}const ae=Y.parseFragment(re,X);SnippetSession_1.adjustWhitespace(Q,se.getStartPosition(),!0,X,new Set(ae)),X.resolveVariables(J);const le=X.toString(),de=le.slice(te);te=le.length;const oe=EditOperation.replace(se,de);oe.identifier={major:ie,minor:0},oe._isTracked=!0,G.push(oe)}return Y.ensureFinalTabstop(X,O,!0),{edits:G,snippets:[new OneSnippet(w,X,"")]}}constructor(w,D,O=_defaultOptions$1,W){this._editor=w,this._template=D,this._options=O,this._languageConfigurationService=W,this._templateMerges=[],this._snippets=[]}dispose(){dispose(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;const{edits:w,snippets:D}=typeof this._template=="string"?SnippetSession_1.createEditsAndSnippetsFromSelections(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService):SnippetSession_1.createEditsAndSnippetsFromEdits(this._editor,this._template,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService);this._snippets=D,this._editor.executeEdits("snippet",w,O=>{const W=O.filter(U=>!!U.identifier);for(let U=0;U<D.length;U++)D[U].initialize(W[U].textChange);return this._snippets[0].hasPlaceholder?this._move(!0):W.map(U=>Selection$1.fromPositions(U.range.getEndPosition()))}),this._editor.revealRange(this._editor.getSelections()[0])}merge(w,D=_defaultOptions$1){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,w]);const{edits:O,snippets:W}=SnippetSession_1.createEditsAndSnippetsFromSelections(this._editor,w,D.overwriteBefore,D.overwriteAfter,!0,D.adjustWhitespace,D.clipboardText,D.overtypingCapturer,this._languageConfigurationService);this._editor.executeEdits("snippet",O,U=>{const K=U.filter(G=>!!G.identifier);for(let G=0;G<W.length;G++)W[G].initialize(K[G].textChange);const q=W[0].isTrivialSnippet;if(!q){for(const G of this._snippets)G.merge(W);console.assert(W.length===0)}return this._snippets[0].hasPlaceholder&&!q?this._move(void 0):K.map(G=>Selection$1.fromPositions(G.range.getEndPosition()))})}next(){const w=this._move(!0);this._editor.setSelections(w),this._editor.revealPositionInCenterIfOutsideViewport(w[0].getPosition())}prev(){const w=this._move(!1);this._editor.setSelections(w),this._editor.revealPositionInCenterIfOutsideViewport(w[0].getPosition())}_move(w){const D=[];for(const O of this._snippets){const W=O.move(w);D.push(...W)}return D}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get hasChoice(){return this._snippets[0].hasChoice}get activeChoice(){return this._snippets[0].activeChoice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;const w=this._editor.getSelections();if(w.length<this._snippets.length)return!1;const D=new Map;for(const O of this._snippets){const W=O.computePossibleSelections();if(D.size===0)for(const[U,K]of W){K.sort(Range$2.compareRangesUsingStarts);for(const q of w)if(K[0].containsRange(q)){D.set(U,[]);break}}if(D.size===0)return!1;D.forEach((U,K)=>{U.push(...W.get(K))})}w.sort(Range$2.compareRangesUsingStarts);for(const[O,W]of D){if(W.length!==w.length){D.delete(O);continue}W.sort(Range$2.compareRangesUsingStarts);for(let U=0;U<W.length;U++)if(!W[U].containsRange(w[U])){D.delete(O);continue}}return D.size>0}};SnippetSession=SnippetSession_1=__decorate$13([__param$10(3,ILanguageConfigurationService)],SnippetSession);var __decorate$12=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$$=function(F,w){return function(D,O){w(D,O,F)}},SnippetController2_1;const _defaultOptions={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let SnippetController2=class{static{SnippetController2_1=this}static{this.ID="snippetController2"}static get(w){return w.getContribution(SnippetController2_1.ID)}static{this.InSnippetMode=new RawContextKey("inSnippetMode",!1,localize("inSnippetMode","Whether the editor in current in snippet mode"))}static{this.HasNextTabstop=new RawContextKey("hasNextTabstop",!1,localize("hasNextTabstop","Whether there is a next tab stop when in snippet mode"))}static{this.HasPrevTabstop=new RawContextKey("hasPrevTabstop",!1,localize("hasPrevTabstop","Whether there is a previous tab stop when in snippet mode"))}constructor(w,D,O,W,U){this._editor=w,this._logService=D,this._languageFeaturesService=O,this._languageConfigurationService=U,this._snippetListener=new DisposableStore,this._modelVersionId=-1,this._inSnippet=SnippetController2_1.InSnippetMode.bindTo(W),this._hasNextTabstop=SnippetController2_1.HasNextTabstop.bindTo(W),this._hasPrevTabstop=SnippetController2_1.HasPrevTabstop.bindTo(W)}dispose(){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._session?.dispose(),this._snippetListener.dispose()}insert(w,D){try{this._doInsert(w,typeof D>"u"?_defaultOptions:{..._defaultOptions,...D})}catch(O){this.cancel(),this._logService.error(O),this._logService.error("snippet_error"),this._logService.error("insert_template=",w),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(w,D){if(this._editor.hasModel()){if(this._snippetListener.clear(),D.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session&&typeof w!="string"&&this.cancel(),this._session?(assertType(typeof w=="string"),this._session.merge(w,D)):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new SnippetSession(this._editor,w,D,this._languageConfigurationService),this._session.insert()),D.undoStopAfter&&this._editor.getModel().pushStackElement(),this._session?.hasChoice){const O={_debugDisplayName:"snippetChoiceCompletions",provideCompletionItems:(Q,Y)=>{if(!this._session||Q!==this._editor.getModel()||!Position$1.equals(this._editor.getPosition(),Y))return;const{activeChoice:X}=this._session;if(!X||X.choice.options.length===0)return;const J=Q.getValueInRange(X.range),te=!!X.choice.options.find(se=>se.value===J),ie=[];for(let se=0;se<X.choice.options.length;se++){const re=X.choice.options[se];ie.push({kind:13,label:re.value,insertText:re.value,sortText:"a".repeat(se+1),range:X.range,filterText:te?`${J}_${re.value}`:void 0,command:{id:"jumpToNextSnippetPlaceholder",title:localize("next","Go to next placeholder...")}})}return{suggestions:ie}}},W=this._editor.getModel();let U,K=!1;const q=()=>{U?.dispose(),K=!1},G=()=>{K||(U=this._languageFeaturesService.completionProvider.register({language:W.getLanguageId(),pattern:W.uri.fsPath,scheme:W.uri.scheme,exclusive:!0},O),this._snippetListener.add(U),K=!0)};this._choiceCompletions={provider:O,enable:G,disable:q}}this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent(O=>O.isFlush&&this.cancel())),this._snippetListener.add(this._editor.onDidChangeModel(()=>this.cancel())),this._snippetListener.add(this._editor.onDidChangeCursorSelection(()=>this._updateState()))}}_updateState(){if(!(!this._session||!this._editor.hasModel())){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this._editor.getModel().pushStackElement(),this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){if(!this._session||!this._editor.hasModel()){this._currentChoice=void 0;return}const{activeChoice:w}=this._session;if(!w||!this._choiceCompletions){this._choiceCompletions?.disable(),this._currentChoice=void 0;return}this._currentChoice!==w.choice&&(this._currentChoice=w.choice,this._choiceCompletions.enable(),queueMicrotask(()=>{showSimpleSuggestions(this._editor,this._choiceCompletions.provider)}))}finish(){for(;this._inSnippet.get();)this.next()}cancel(w=!1){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),this._currentChoice=void 0,this._session?.dispose(),this._session=void 0,this._modelVersionId=-1,w&&this._editor.setSelections([this._editor.getSelection()])}prev(){this._session?.prev(),this._updateState()}next(){this._session?.next(),this._updateState()}isInSnippet(){return!!this._inSnippet.get()}};SnippetController2=SnippetController2_1=__decorate$12([__param$$(1,ILogService),__param$$(2,ILanguageFeaturesService),__param$$(3,IContextKeyService),__param$$(4,ILanguageConfigurationService)],SnippetController2);registerEditorContribution(SnippetController2.ID,SnippetController2,4);const CommandCtor=EditorCommand.bindToContribution(SnippetController2.get);registerEditorCommand(new CommandCtor({id:"jumpToNextSnippetPlaceholder",precondition:ContextKeyExpr.and(SnippetController2.InSnippetMode,SnippetController2.HasNextTabstop),handler:F=>F.next(),kbOpts:{weight:130,kbExpr:EditorContextKeys.textInputFocus,primary:2}}));registerEditorCommand(new CommandCtor({id:"jumpToPrevSnippetPlaceholder",precondition:ContextKeyExpr.and(SnippetController2.InSnippetMode,SnippetController2.HasPrevTabstop),handler:F=>F.prev(),kbOpts:{weight:130,kbExpr:EditorContextKeys.textInputFocus,primary:1026}}));registerEditorCommand(new CommandCtor({id:"leaveSnippet",precondition:SnippetController2.InSnippetMode,handler:F=>F.cancel(!0),kbOpts:{weight:130,kbExpr:EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}}));registerEditorCommand(new CommandCtor({id:"acceptSnippet",precondition:SnippetController2.InSnippetMode,handler:F=>F.finish()}));var StorageHint;(function(F){F[F.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",F[F.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(StorageHint||(StorageHint={}));var StorageState;(function(F){F[F.None=0]="None",F[F.Initialized=1]="Initialized",F[F.Closed=2]="Closed"})(StorageState||(StorageState={}));class Storage extends Disposable{static{this.DEFAULT_FLUSH_DELAY=100}constructor(w,D=Object.create(null)){super(),this.database=w,this.options=D,this._onDidChangeStorage=this._register(new PauseableEmitter),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=StorageState.None,this.cache=new Map,this.flushDelayer=this._register(new ThrottledDelayer(Storage.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(w=>this.onDidChangeItemsExternal(w)))}onDidChangeItemsExternal(w){this._onDidChangeStorage.pause();try{w.changed?.forEach((D,O)=>this.acceptExternal(O,D)),w.deleted?.forEach(D=>this.acceptExternal(D,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(w,D){if(this.state===StorageState.Closed)return;let O=!1;isUndefinedOrNull(D)?O=this.cache.delete(w):this.cache.get(w)!==D&&(this.cache.set(w,D),O=!0),O&&this._onDidChangeStorage.fire({key:w,external:!0})}get(w,D){const O=this.cache.get(w);return isUndefinedOrNull(O)?D:O}getBoolean(w,D){const O=this.get(w);return isUndefinedOrNull(O)?D:O==="true"}getNumber(w,D){const O=this.get(w);return isUndefinedOrNull(O)?D:parseInt(O,10)}async set(w,D,O=!1){if(this.state===StorageState.Closed)return;if(isUndefinedOrNull(D))return this.delete(w,O);const W=isObject$1(D)||Array.isArray(D)?stringify(D):String(D);if(this.cache.get(w)!==W)return this.cache.set(w,W),this.pendingInserts.set(w,W),this.pendingDeletes.delete(w),this._onDidChangeStorage.fire({key:w,external:O}),this.doFlush()}async delete(w,D=!1){if(!(this.state===StorageState.Closed||!this.cache.delete(w)))return this.pendingDeletes.has(w)||this.pendingDeletes.add(w),this.pendingInserts.delete(w),this._onDidChangeStorage.fire({key:w,external:D}),this.doFlush()}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const w={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(w).finally(()=>{if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)this.whenFlushedCallbacks.pop()?.()})}async doFlush(w){return this.options.hint===StorageHint.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),w)}}class InMemoryStorageDatabase{constructor(){this.onDidChangeItemsExternal=Event$1.None,this.items=new Map}async updateItems(w){w.insert?.forEach((D,O)=>this.items.set(O,D)),w.delete?.forEach(D=>this.items.delete(D))}}const TARGET_KEY="__$__targetStorageMarker",IStorageService=createDecorator("storageService");var WillSaveStateReason;(function(F){F[F.NONE=0]="NONE",F[F.SHUTDOWN=1]="SHUTDOWN"})(WillSaveStateReason||(WillSaveStateReason={}));function loadKeyTargets(F){const w=F.get(TARGET_KEY);if(w)try{return JSON.parse(w)}catch{}return Object.create(null)}class AbstractStorageService extends Disposable{static{this.DEFAULT_FLUSH_INTERVAL=60*1e3}constructor(w={flushInterval:AbstractStorageService.DEFAULT_FLUSH_INTERVAL}){super(),this.options=w,this._onDidChangeValue=this._register(new PauseableEmitter),this._onDidChangeTarget=this._register(new PauseableEmitter),this._onWillSaveState=this._register(new Emitter$1),this.onWillSaveState=this._onWillSaveState.event,this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0}onDidChangeValue(w,D,O){return Event$1.filter(this._onDidChangeValue.event,W=>W.scope===w&&(D===void 0||W.key===D),O)}emitDidChangeValue(w,D){const{key:O,external:W}=D;if(O===TARGET_KEY){switch(w){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:w})}else this._onDidChangeValue.fire({scope:w,key:O,target:this.getKeyTargets(w)[O],external:W})}get(w,D,O){return this.getStorage(D)?.get(w,O)}getBoolean(w,D,O){return this.getStorage(D)?.getBoolean(w,O)}getNumber(w,D,O){return this.getStorage(D)?.getNumber(w,O)}store(w,D,O,W,U=!1){if(isUndefinedOrNull(D)){this.remove(w,O,U);return}this.withPausedEmitters(()=>{this.updateKeyTarget(w,O,W),this.getStorage(O)?.set(w,D,U)})}remove(w,D,O=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(w,D,void 0),this.getStorage(D)?.delete(w,O)})}withPausedEmitters(w){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{w()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(w,D,O,W=!1){const U=this.getKeyTargets(D);typeof O=="number"?U[w]!==O&&(U[w]=O,this.getStorage(D)?.set(TARGET_KEY,JSON.stringify(U),W)):typeof U[w]=="number"&&(delete U[w],this.getStorage(D)?.set(TARGET_KEY,JSON.stringify(U),W))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(w){switch(w){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(w){const D=this.getStorage(w);return D?loadKeyTargets(D):Object.create(null)}}class InMemoryStorageService extends AbstractStorageService{constructor(){super(),this.applicationStorage=this._register(new Storage(new InMemoryStorageDatabase,{hint:StorageHint.STORAGE_IN_MEMORY})),this.profileStorage=this._register(new Storage(new InMemoryStorageDatabase,{hint:StorageHint.STORAGE_IN_MEMORY})),this.workspaceStorage=this._register(new Storage(new InMemoryStorageDatabase,{hint:StorageHint.STORAGE_IN_MEMORY})),this._register(this.workspaceStorage.onDidChangeStorage(w=>this.emitDidChangeValue(1,w))),this._register(this.profileStorage.onDidChangeStorage(w=>this.emitDidChangeValue(0,w))),this._register(this.applicationStorage.onDidChangeStorage(w=>this.emitDidChangeValue(-1,w)))}getStorage(w){switch(w){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}}var __decorate$11=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$_=function(F,w){return function(D,O){w(D,O,F)}},SuggestMemoryService_1;class Memory{constructor(w){this.name=w}select(w,D,O){if(O.length===0)return 0;const W=O[0].score[0];for(let U=0;U<O.length;U++){const{score:K,completion:q}=O[U];if(K[0]!==W)break;if(q.preselect)return U}return 0}}class NoMemory extends Memory{constructor(){super("first")}memorize(w,D,O){}toJSON(){}fromJSON(){}}class LRUMemory extends Memory{constructor(){super("recentlyUsed"),this._cache=new LRUCache(300,.66),this._seq=0}memorize(w,D,O){const W=`${w.getLanguageId()}/${O.textLabel}`;this._cache.set(W,{touch:this._seq++,type:O.completion.kind,insertText:O.completion.insertText})}select(w,D,O){if(O.length===0)return 0;const W=w.getLineContent(D.lineNumber).substr(D.column-10,D.column-1);if(/\s$/.test(W))return super.select(w,D,O);const U=O[0].score[0];let K=-1,q=-1,G=-1;for(let Q=0;Q<O.length&&O[Q].score[0]===U;Q++){const Y=`${w.getLanguageId()}/${O[Q].textLabel}`,X=this._cache.peek(Y);if(X&&X.touch>G&&X.type===O[Q].completion.kind&&X.insertText===O[Q].completion.insertText&&(G=X.touch,q=Q),O[Q].completion.preselect&&K===-1)return K=Q}return q!==-1?q:K!==-1?K:0}toJSON(){return this._cache.toJSON()}fromJSON(w){this._cache.clear();const D=0;for(const[O,W]of w)W.touch=D,W.type=typeof W.type=="number"?W.type:CompletionItemKinds.fromString(W.type),this._cache.set(O,W);this._seq=this._cache.size}}class PrefixMemory extends Memory{constructor(){super("recentlyUsedByPrefix"),this._trie=TernarySearchTree.forStrings(),this._seq=0}memorize(w,D,O){const{word:W}=w.getWordUntilPosition(D),U=`${w.getLanguageId()}/${W}`;this._trie.set(U,{type:O.completion.kind,insertText:O.completion.insertText,touch:this._seq++})}select(w,D,O){const{word:W}=w.getWordUntilPosition(D);if(!W)return super.select(w,D,O);const U=`${w.getLanguageId()}/${W}`;let K=this._trie.get(U);if(K||(K=this._trie.findSubstr(U)),K)for(let q=0;q<O.length;q++){const{kind:G,insertText:Q}=O[q].completion;if(G===K.type&&Q===K.insertText)return q}return super.select(w,D,O)}toJSON(){const w=[];return this._trie.forEach((D,O)=>w.push([O,D])),w.sort((D,O)=>-(D[1].touch-O[1].touch)).forEach((D,O)=>D[1].touch=O),w.slice(0,200)}fromJSON(w){if(this._trie.clear(),w.length>0){this._seq=w[0][1].touch+1;for(const[D,O]of w)O.type=typeof O.type=="number"?O.type:CompletionItemKinds.fromString(O.type),this._trie.set(D,O)}}}let SuggestMemoryService=class{static{SuggestMemoryService_1=this}static{this._strategyCtors=new Map([["recentlyUsedByPrefix",PrefixMemory],["recentlyUsed",LRUMemory],["first",NoMemory]])}static{this._storagePrefix="suggest/memories"}constructor(w,D){this._storageService=w,this._configService=D,this._disposables=new DisposableStore,this._persistSoon=new RunOnceScheduler(()=>this._saveState(),500),this._disposables.add(w.onWillSaveState(O=>{O.reason===WillSaveStateReason.SHUTDOWN&&this._saveState()}))}dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(w,D,O){this._withStrategy(w,D).memorize(w,D,O),this._persistSoon.schedule()}select(w,D,O){return this._withStrategy(w,D).select(w,D,O)}_withStrategy(w,D){const O=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:w.getLanguageIdAtPosition(D.lineNumber,D.column),resource:w.uri});if(this._strategy?.name!==O){this._saveState();const W=SuggestMemoryService_1._strategyCtors.get(O)||NoMemory;this._strategy=new W;try{const K=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,q=this._storageService.get(`${SuggestMemoryService_1._storagePrefix}/${O}`,K);q&&this._strategy.fromJSON(JSON.parse(q))}catch{}}return this._strategy}_saveState(){if(this._strategy){const D=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,O=JSON.stringify(this._strategy);this._storageService.store(`${SuggestMemoryService_1._storagePrefix}/${this._strategy.name}`,O,D,1)}}};SuggestMemoryService=SuggestMemoryService_1=__decorate$11([__param$_(0,IStorageService),__param$_(1,IConfigurationService)],SuggestMemoryService);const ISuggestMemoryService=createDecorator("ISuggestMemories");registerSingleton(ISuggestMemoryService,SuggestMemoryService,1);var __decorate$10=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$Z=function(F,w){return function(D,O){w(D,O,F)}},WordContextKey_1;let WordContextKey=class{static{WordContextKey_1=this}static{this.AtEnd=new RawContextKey("atEndOfWord",!1)}constructor(w,D){this._editor=w,this._enabled=!1,this._ckAtEnd=WordContextKey_1.AtEnd.bindTo(D),this._configListener=this._editor.onDidChangeConfiguration(O=>O.hasChanged(124)&&this._update()),this._update()}dispose(){this._configListener.dispose(),this._selectionListener?.dispose(),this._ckAtEnd.reset()}_update(){const w=this._editor.getOption(124)==="on";if(this._enabled!==w)if(this._enabled=w,this._enabled){const D=()=>{if(!this._editor.hasModel()){this._ckAtEnd.set(!1);return}const O=this._editor.getModel(),W=this._editor.getSelection(),U=O.getWordAtPosition(W.getStartPosition());if(!U){this._ckAtEnd.set(!1);return}this._ckAtEnd.set(U.endColumn===W.getStartPosition().column)};this._selectionListener=this._editor.onDidChangeCursorSelection(D),D()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}};WordContextKey=WordContextKey_1=__decorate$10([__param$Z(1,IContextKeyService)],WordContextKey);var __decorate$$=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$Y=function(F,w){return function(D,O){w(D,O,F)}},SuggestAlternatives_1;let SuggestAlternatives=class{static{SuggestAlternatives_1=this}static{this.OtherSuggestions=new RawContextKey("hasOtherSuggestions",!1)}constructor(w,D){this._editor=w,this._index=0,this._ckOtherSuggestions=SuggestAlternatives_1.OtherSuggestions.bindTo(D)}dispose(){this.reset()}reset(){this._ckOtherSuggestions.reset(),this._listener?.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:w,index:D},O){if(w.items.length===0){this.reset();return}if(SuggestAlternatives_1._moveIndex(!0,w,D)===D){this.reset();return}this._acceptNext=O,this._model=w,this._index=D,this._listener=this._editor.onDidChangeCursorPosition(()=>{this._ignore||this.reset()}),this._ckOtherSuggestions.set(!0)}static _moveIndex(w,D,O){let W=O;for(let U=D.items.length;U>0&&(W=(W+D.items.length+(w?1:-1))%D.items.length,!(W===O||!D.items[W].completion.additionalTextEdits));U--);return W}next(){this._move(!0)}prev(){this._move(!1)}_move(w){if(this._model)try{this._ignore=!0,this._index=SuggestAlternatives_1._moveIndex(w,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}};SuggestAlternatives=SuggestAlternatives_1=__decorate$$([__param$Y(1,IContextKeyService)],SuggestAlternatives);class CommitCharacterController{constructor(w,D,O,W){this._disposables=new DisposableStore,this._disposables.add(O.onDidSuggest(U=>{U.completionModel.items.length===0&&this.reset()})),this._disposables.add(O.onDidCancel(U=>{this.reset()})),this._disposables.add(D.onDidShow(()=>this._onItem(D.getFocusedItem()))),this._disposables.add(D.onDidFocus(this._onItem,this)),this._disposables.add(D.onDidHide(this.reset,this)),this._disposables.add(w.onWillType(U=>{if(this._active&&!D.isFrozen()&&O.state!==0){const K=U.charCodeAt(U.length-1);this._active.acceptCharacters.has(K)&&w.getOption(0)&&W(this._active.item)}}))}_onItem(w){if(!w||!isNonEmptyArray(w.item.completion.commitCharacters)){this.reset();return}if(this._active&&this._active.item.item===w.item)return;const D=new CharacterSet;for(const O of w.item.completion.commitCharacters)O.length>0&&D.add(O.charCodeAt(0));this._active={acceptCharacters:D,item:w}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}}const IEditorWorkerService=createDecorator("editorWorkerService");class BracketSelectionRangeProvider{async provideSelectionRanges(w,D){const O=[];for(const W of D){const U=[];O.push(U);const K=new Map;await new Promise(q=>BracketSelectionRangeProvider._bracketsRightYield(q,0,w,W,K)),await new Promise(q=>BracketSelectionRangeProvider._bracketsLeftYield(q,0,w,W,K,U))}return O}static{this._maxDuration=30}static{this._maxRounds=2}static _bracketsRightYield(w,D,O,W,U){const K=new Map,q=Date.now();for(;;){if(D>=BracketSelectionRangeProvider._maxRounds){w();break}if(!W){w();break}const G=O.bracketPairs.findNextBracket(W);if(!G){w();break}if(Date.now()-q>BracketSelectionRangeProvider._maxDuration){setTimeout(()=>BracketSelectionRangeProvider._bracketsRightYield(w,D+1,O,W,U));break}if(G.bracketInfo.isOpeningBracket){const Y=G.bracketInfo.bracketText,X=K.has(Y)?K.get(Y):0;K.set(Y,X+1)}else{const Y=G.bracketInfo.getOpeningBrackets()[0].bracketText;let X=K.has(Y)?K.get(Y):0;if(X-=1,K.set(Y,Math.max(0,X)),X<0){let J=U.get(Y);J||(J=new LinkedList,U.set(Y,J)),J.push(G.range)}}W=G.range.getEndPosition()}}static _bracketsLeftYield(w,D,O,W,U,K){const q=new Map,G=Date.now();for(;;){if(D>=BracketSelectionRangeProvider._maxRounds&&U.size===0){w();break}if(!W){w();break}const Q=O.bracketPairs.findPrevBracket(W);if(!Q){w();break}if(Date.now()-G>BracketSelectionRangeProvider._maxDuration){setTimeout(()=>BracketSelectionRangeProvider._bracketsLeftYield(w,D+1,O,W,U,K));break}if(Q.bracketInfo.isOpeningBracket){const X=Q.bracketInfo.bracketText;let J=q.has(X)?q.get(X):0;if(J-=1,q.set(X,Math.max(0,J)),J<0){const te=U.get(X);if(te){const ie=te.shift();te.size===0&&U.delete(X);const se=Range$2.fromPositions(Q.range.getEndPosition(),ie.getStartPosition()),re=Range$2.fromPositions(Q.range.getStartPosition(),ie.getEndPosition());K.push({range:se}),K.push({range:re}),BracketSelectionRangeProvider._addBracketLeading(O,re,K)}}}else{const X=Q.bracketInfo.getOpeningBrackets()[0].bracketText,J=q.has(X)?q.get(X):0;q.set(X,J+1)}W=Q.range.getStartPosition()}}static _addBracketLeading(w,D,O){if(D.startLineNumber===D.endLineNumber)return;const W=D.startLineNumber,U=w.getLineFirstNonWhitespaceColumn(W);U!==0&&U!==D.startColumn&&(O.push({range:Range$2.fromPositions(new Position$1(W,U),D.getEndPosition())}),O.push({range:Range$2.fromPositions(new Position$1(W,1),D.getEndPosition())}));const K=W-1;if(K>0){const q=w.getLineFirstNonWhitespaceColumn(K);q===D.startColumn&&q!==w.getLineLastNonWhitespaceColumn(K)&&(O.push({range:Range$2.fromPositions(new Position$1(K,q),D.getEndPosition())}),O.push({range:Range$2.fromPositions(new Position$1(K,1),D.getEndPosition())}))}}}class WordDistance{static{this.None=new class extends WordDistance{distance(){return 0}}}static async create(w,D){if(!D.getOption(119).localityBonus||!D.hasModel())return WordDistance.None;const O=D.getModel(),W=D.getPosition();if(!w.canComputeWordRanges(O.uri))return WordDistance.None;const[U]=await new BracketSelectionRangeProvider().provideSelectionRanges(O,[W]);if(U.length===0)return WordDistance.None;const K=await w.computeWordRanges(O.uri,U[0].range);if(!K)return WordDistance.None;const q=O.getWordUntilPosition(W);return delete K[q.word],new class extends WordDistance{distance(G,Q){if(!W.equals(D.getPosition()))return 0;if(Q.kind===17)return 2<<20;const Y=typeof Q.label=="string"?Q.label:Q.label.label,X=K[Y];if(isFalsyOrEmpty(X))return 2<<20;const J=binarySearch(X,Range$2.fromPositions(G),Range$2.compareRangesUsingStarts),te=J>=0?X[J]:X[Math.max(0,~J-1)];let ie=U.length;for(const se of U){if(!Range$2.containsRange(se.range,te))break;ie-=1}return ie}}}}const IClipboardService=createDecorator("clipboardService");class CompletionModel{constructor(w,D,O,W,U,K,q=FuzzyScoreOptions.default,G=void 0){this.clipboardText=G,this._snippetCompareFn=CompletionModel._compareCompletionItems,this._items=w,this._column=D,this._wordDistance=W,this._options=U,this._refilterKind=1,this._lineContext=O,this._fuzzyScoreOptions=q,K==="top"?this._snippetCompareFn=CompletionModel._compareCompletionItemsSnippetsUp:K==="bottom"&&(this._snippetCompareFn=CompletionModel._compareCompletionItemsSnippetsDown)}get lineContext(){return this._lineContext}set lineContext(w){(this._lineContext.leadingLineContent!==w.leadingLineContent||this._lineContext.characterCountDelta!==w.characterCountDelta)&&(this._refilterKind=this._lineContext.characterCountDelta<w.characterCountDelta&&this._filteredItems?2:1,this._lineContext=w)}get items(){return this._ensureCachedState(),this._filteredItems}getItemsByProvider(){return this._ensureCachedState(),this._itemsByProvider}getIncompleteProvider(){this._ensureCachedState();const w=new Set;for(const[D,O]of this.getItemsByProvider())O.length>0&&O[0].container.incomplete&&w.add(D);return w}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._refilterKind!==0&&this._createCachedState()}_createCachedState(){this._itemsByProvider=new Map;const w=[],{leadingLineContent:D,characterCountDelta:O}=this._lineContext;let W="",U="";const K=this._refilterKind===1?this._items:this._filteredItems,q=[],G=!this._options.filterGraceful||K.length>2e3?fuzzyScore:fuzzyScoreGracefulAggressive;for(let Q=0;Q<K.length;Q++){const Y=K[Q];if(Y.isInvalid)continue;const X=this._itemsByProvider.get(Y.provider);X?X.push(Y):this._itemsByProvider.set(Y.provider,[Y]);const J=Y.position.column-Y.editStart.column,te=J+O-(Y.position.column-this._column);if(W.length!==te&&(W=te===0?"":D.slice(-te),U=W.toLowerCase()),Y.word=W,te===0)Y.score=FuzzyScore.Default;else{let ie=0;for(;ie<J;){const se=W.charCodeAt(ie);if(se===32||se===9)ie+=1;else break}if(ie>=te)Y.score=FuzzyScore.Default;else if(typeof Y.completion.filterText=="string"){const se=G(W,U,ie,Y.completion.filterText,Y.filterTextLow,0,this._fuzzyScoreOptions);if(!se)continue;compareIgnoreCase(Y.completion.filterText,Y.textLabel)===0?Y.score=se:(Y.score=anyScore(W,U,ie,Y.textLabel,Y.labelLow,0),Y.score[0]=se[0])}else{const se=G(W,U,ie,Y.textLabel,Y.labelLow,0,this._fuzzyScoreOptions);if(!se)continue;Y.score=se}}Y.idx=Q,Y.distance=this._wordDistance.distance(Y.position,Y.completion),q.push(Y),w.push(Y.textLabel.length)}this._filteredItems=q.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:w.length?quickSelect(w.length-.85,w,(Q,Y)=>Q-Y):0}}static _compareCompletionItems(w,D){return w.score[0]>D.score[0]?-1:w.score[0]<D.score[0]?1:w.distance<D.distance?-1:w.distance>D.distance?1:w.idx<D.idx?-1:w.idx>D.idx?1:0}static _compareCompletionItemsSnippetsDown(w,D){if(w.completion.kind!==D.completion.kind){if(w.completion.kind===27)return 1;if(D.completion.kind===27)return-1}return CompletionModel._compareCompletionItems(w,D)}static _compareCompletionItemsSnippetsUp(w,D){if(w.completion.kind!==D.completion.kind){if(w.completion.kind===27)return-1;if(D.completion.kind===27)return 1}return CompletionModel._compareCompletionItems(w,D)}}class InlineCompletionContextKeys extends Disposable{static{this.inlineSuggestionVisible=new RawContextKey("inlineSuggestionVisible",!1,localize("inlineSuggestionVisible","Whether an inline suggestion is visible"))}static{this.inlineSuggestionHasIndentation=new RawContextKey("inlineSuggestionHasIndentation",!1,localize("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace"))}static{this.inlineSuggestionHasIndentationLessThanTabSize=new RawContextKey("inlineSuggestionHasIndentationLessThanTabSize",!0,localize("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab"))}static{this.suppressSuggestions=new RawContextKey("inlineSuggestionSuppressSuggestions",void 0,localize("suppressSuggestions","Whether suggestions should be suppressed for the current suggestion"))}constructor(w,D){super(),this.contextKeyService=w,this.model=D,this.inlineCompletionVisible=InlineCompletionContextKeys.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=InlineCompletionContextKeys.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=InlineCompletionContextKeys.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService),this.suppressSuggestions=InlineCompletionContextKeys.suppressSuggestions.bindTo(this.contextKeyService),this._register(autorun(O=>{const U=this.model.read(O)?.state.read(O),K=!!U?.inlineCompletion&&U?.primaryGhostText!==void 0&&!U?.primaryGhostText.isEmpty();this.inlineCompletionVisible.set(K),U?.primaryGhostText&&U?.inlineCompletion&&this.suppressSuggestions.set(U.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions)})),this._register(autorun(O=>{const W=this.model.read(O);let U=!1,K=!0;const q=W?.primaryGhostText.read(O);if(W?.selectedSuggestItem&&q&&q.parts.length>0){const{column:G,lines:Q}=q.parts[0],Y=Q[0],X=W.textModel.getLineIndentColumn(q.lineNumber);if(G<=X){let te=firstNonWhitespaceIndex(Y);te===-1&&(te=Y.length-1),U=te>0;const ie=W.textModel.getOptions().tabSize;K=CursorColumns.visibleColumnFromColumn(Y,te+1,ie)<ie}}this.inlineCompletionSuggestsIndentation.set(U),this.inlineCompletionSuggestsIndentationLessThanTabSize.set(K)}))}}const IEnvironmentService=createDecorator("environmentService");var __decorate$_=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$X=function(F,w){return function(D,O){w(D,O,F)}},SuggestModel_1;class LineContext{static shouldAutoTrigger(w){if(!w.hasModel())return!1;const D=w.getModel(),O=w.getPosition();D.tokenization.tokenizeIfCheap(O.lineNumber);const W=D.getWordAtPosition(O);return!(!W||W.endColumn!==O.column&&W.startColumn+1!==O.column||!isNaN(Number(W.word)))}constructor(w,D,O){this.leadingLineContent=w.getLineContent(D.lineNumber).substr(0,D.column-1),this.leadingWord=w.getWordUntilPosition(D),this.lineNumber=D.lineNumber,this.column=D.column,this.triggerOptions=O}}function canShowQuickSuggest(F,w,D){if(!w.getContextKeyValue(InlineCompletionContextKeys.inlineSuggestionVisible.key))return!0;const O=w.getContextKeyValue(InlineCompletionContextKeys.suppressSuggestions.key);return O!==void 0?!O:!F.getOption(62).suppressSuggestions}function canShowSuggestOnTriggerCharacters(F,w,D){if(!w.getContextKeyValue("inlineSuggestionVisible"))return!0;const O=w.getContextKeyValue(InlineCompletionContextKeys.suppressSuggestions.key);return O!==void 0?!O:!F.getOption(62).suppressSuggestions}let SuggestModel=SuggestModel_1=class{constructor(w,D,O,W,U,K,q,G,Q){this._editor=w,this._editorWorkerService=D,this._clipboardService=O,this._telemetryService=W,this._logService=U,this._contextKeyService=K,this._configurationService=q,this._languageFeaturesService=G,this._envService=Q,this._toDispose=new DisposableStore,this._triggerCharacterListener=new DisposableStore,this._triggerQuickSuggest=new TimeoutTimer,this._triggerState=void 0,this._completionDisposables=new DisposableStore,this._onDidCancel=new Emitter$1,this._onDidTrigger=new Emitter$1,this._onDidSuggest=new Emitter$1,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._telemetryGate=0,this._currentSelection=this._editor.getSelection()||new Selection$1(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeModelLanguage(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeConfiguration(()=>{this._updateTriggerCharacters()})),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()}));let Y=!1;this._toDispose.add(this._editor.onDidCompositionStart(()=>{Y=!0})),this._toDispose.add(this._editor.onDidCompositionEnd(()=>{Y=!1,this._onCompositionEnd()})),this._toDispose.add(this._editor.onDidChangeCursorSelection(X=>{Y||this._onCursorChange(X)})),this._toDispose.add(this._editor.onDidChangeModelContent(()=>{!Y&&this._triggerState!==void 0&&this._refilterCompletionItems()})),this._updateTriggerCharacters()}dispose(){dispose(this._triggerCharacterListener),dispose([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(92)||!this._editor.hasModel()||!this._editor.getOption(122))return;const w=new Map;for(const O of this._languageFeaturesService.completionProvider.all(this._editor.getModel()))for(const W of O.triggerCharacters||[]){let U=w.get(W);U||(U=new Set,w.set(W,U)),U.add(O)}const D=O=>{if(!canShowSuggestOnTriggerCharacters(this._editor,this._contextKeyService,this._configurationService)||LineContext.shouldAutoTrigger(this._editor))return;if(!O){const K=this._editor.getPosition();O=this._editor.getModel().getLineContent(K.lineNumber).substr(0,K.column-1)}let W="";isLowSurrogate(O.charCodeAt(O.length-1))?isHighSurrogate(O.charCodeAt(O.length-2))&&(W=O.substr(O.length-2)):W=O.charAt(O.length-1);const U=w.get(W);if(U){const K=new Map;if(this._completionModel)for(const[q,G]of this._completionModel.getItemsByProvider())U.has(q)||K.set(q,G);this.trigger({auto:!0,triggerKind:1,triggerCharacter:W,retrigger:!!this._completionModel,clipboardText:this._completionModel?.clipboardText,completionOptions:{providerFilter:U,providerItemsToReuse:K}})}};this._triggerCharacterListener.add(this._editor.onDidType(D)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(()=>D()))}get state(){return this._triggerState?this._triggerState.auto?2:1:0}cancel(w=!1){this._triggerState!==void 0&&(this._triggerQuickSuggest.cancel(),this._requestToken?.cancel(),this._requestToken=void 0,this._triggerState=void 0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:w}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){this._triggerState!==void 0&&(!this._editor.hasModel()||!this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.cancel():this.trigger({auto:this._triggerState.auto,retrigger:!0}))}_onCursorChange(w){if(!this._editor.hasModel())return;const D=this._currentSelection;if(this._currentSelection=this._editor.getSelection(),!w.selection.isEmpty()||w.reason!==0&&w.reason!==3||w.source!=="keyboard"&&w.source!=="deleteLeft"){this.cancel();return}this._triggerState===void 0&&w.reason===0?(D.containsRange(this._currentSelection)||D.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():this._triggerState!==void 0&&w.reason===3&&this._refilterCompletionItems()}_onCompositionEnd(){this._triggerState===void 0?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){QuickSuggestionsOptions.isAllOff(this._editor.getOption(90))||this._editor.getOption(119).snippetsPreventQuickSuggestions&&SnippetController2.get(this._editor)?.isInSnippet()||(this.cancel(),this._triggerQuickSuggest.cancelAndSet(()=>{if(this._triggerState!==void 0||!LineContext.shouldAutoTrigger(this._editor)||!this._editor.hasModel()||!this._editor.hasWidgetFocus())return;const w=this._editor.getModel(),D=this._editor.getPosition(),O=this._editor.getOption(90);if(!QuickSuggestionsOptions.isAllOff(O)){if(!QuickSuggestionsOptions.isAllOn(O)){w.tokenization.tokenizeIfCheap(D.lineNumber);const W=w.tokenization.getLineTokens(D.lineNumber),U=W.getStandardTokenType(W.findTokenIndexAtOffset(Math.max(D.column-1-1,0)));if(QuickSuggestionsOptions.valueFor(O,U)!=="on")return}canShowQuickSuggest(this._editor,this._contextKeyService,this._configurationService)&&this._languageFeaturesService.completionProvider.has(w)&&this.trigger({auto:!0})}},this._editor.getOption(91)))}_refilterCompletionItems(){assertType(this._editor.hasModel()),assertType(this._triggerState!==void 0);const w=this._editor.getModel(),D=this._editor.getPosition(),O=new LineContext(w,D,{...this._triggerState,refilter:!0});this._onNewContext(O)}trigger(w){if(!this._editor.hasModel())return;const D=this._editor.getModel(),O=new LineContext(D,this._editor.getPosition(),w);this.cancel(w.retrigger),this._triggerState=w,this._onDidTrigger.fire({auto:w.auto,shy:w.shy??!1,position:this._editor.getPosition()}),this._context=O;let W={triggerKind:w.triggerKind??0};w.triggerCharacter&&(W={triggerKind:1,triggerCharacter:w.triggerCharacter}),this._requestToken=new CancellationTokenSource$1;const U=this._editor.getOption(113);let K=1;switch(U){case"top":K=0;break;case"bottom":K=2;break}const{itemKind:q,showDeprecated:G}=SuggestModel_1.createSuggestFilter(this._editor),Q=new CompletionOptions(K,w.completionOptions?.kindFilter??q,w.completionOptions?.providerFilter,w.completionOptions?.providerItemsToReuse,G),Y=WordDistance.create(this._editorWorkerService,this._editor),X=provideSuggestionItems(this._languageFeaturesService.completionProvider,D,this._editor.getPosition(),Q,W,this._requestToken.token);Promise.all([X,Y]).then(async([J,te])=>{if(this._requestToken?.dispose(),!this._editor.hasModel())return;let ie=w?.clipboardText;if(!ie&&J.needsClipboard&&(ie=await this._clipboardService.readText()),this._triggerState===void 0)return;const se=this._editor.getModel(),re=new LineContext(se,this._editor.getPosition(),w),ae={...FuzzyScoreOptions.default,firstMatchCanBeWeak:!this._editor.getOption(119).matchOnWordStartOnly};if(this._completionModel=new CompletionModel(J.items,this._context.column,{leadingLineContent:re.leadingLineContent,characterCountDelta:re.column-this._context.column},te,this._editor.getOption(119),this._editor.getOption(113),ae,ie),this._completionDisposables.add(J.disposable),this._onNewContext(re),this._reportDurationsTelemetry(J.durations),!this._envService.isBuilt||this._envService.isExtensionDevelopment)for(const le of J.items)le.isInvalid&&this._logService.warn(`[suggest] did IGNORE invalid completion item from ${le.provider._debugDisplayName}`,le.completion)}).catch(onUnexpectedError)}_reportDurationsTelemetry(w){this._telemetryGate++%230===0&&setTimeout(()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(w)}),this._logService.debug("suggest.durations.json",w)})}static createSuggestFilter(w){const D=new Set;w.getOption(113)==="none"&&D.add(27);const W=w.getOption(119);return W.showMethods||D.add(0),W.showFunctions||D.add(1),W.showConstructors||D.add(2),W.showFields||D.add(3),W.showVariables||D.add(4),W.showClasses||D.add(5),W.showStructs||D.add(6),W.showInterfaces||D.add(7),W.showModules||D.add(8),W.showProperties||D.add(9),W.showEvents||D.add(10),W.showOperators||D.add(11),W.showUnits||D.add(12),W.showValues||D.add(13),W.showConstants||D.add(14),W.showEnums||D.add(15),W.showEnumMembers||D.add(16),W.showKeywords||D.add(17),W.showWords||D.add(18),W.showColors||D.add(19),W.showFiles||D.add(20),W.showReferences||D.add(21),W.showColors||D.add(22),W.showFolders||D.add(23),W.showTypeParameters||D.add(24),W.showSnippets||D.add(27),W.showUsers||D.add(25),W.showIssues||D.add(26),{itemKind:D,showDeprecated:W.showDeprecated}}_onNewContext(w){if(this._context){if(w.lineNumber!==this._context.lineNumber){this.cancel();return}if(getLeadingWhitespace(w.leadingLineContent)!==getLeadingWhitespace(this._context.leadingLineContent)){this.cancel();return}if(w.column<this._context.column){w.leadingWord.word?this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0}):this.cancel();return}if(this._completionModel){if(w.leadingWord.word.length!==0&&w.leadingWord.startColumn>this._context.leadingWord.startColumn){if(LineContext.shouldAutoTrigger(this._editor)&&this._context){const O=this._completionModel.getItemsByProvider();this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerItemsToReuse:O}})}return}if(w.column>this._context.column&&this._completionModel.getIncompleteProvider().size>0&&w.leadingWord.word.length!==0){const D=new Map,O=new Set;for(const[W,U]of this._completionModel.getItemsByProvider())U.length>0&&U[0].container.incomplete?O.add(W):D.set(W,U);this.trigger({auto:this._context.triggerOptions.auto,triggerKind:2,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerFilter:O,providerItemsToReuse:D}})}else{const D=this._completionModel.lineContext;let O=!1;if(this._completionModel.lineContext={leadingLineContent:w.leadingLineContent,characterCountDelta:w.column-this._context.column},this._completionModel.items.length===0){const W=LineContext.shouldAutoTrigger(this._editor);if(!this._context){this.cancel();return}if(W&&this._context.leadingWord.endColumn<w.leadingWord.startColumn){this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0});return}if(this._context.triggerOptions.auto){this.cancel();return}else if(this._completionModel.lineContext=D,O=this._completionModel.items.length>0,O&&w.leadingWord.word.length===0){this.cancel();return}}this._onDidSuggest.fire({completionModel:this._completionModel,triggerOptions:w.triggerOptions,isFrozen:O})}}}}};SuggestModel=SuggestModel_1=__decorate$_([__param$X(1,IEditorWorkerService),__param$X(2,IClipboardService),__param$X(3,ITelemetryService),__param$X(4,ILogService),__param$X(5,IContextKeyService),__param$X(6,IConfigurationService),__param$X(7,ILanguageFeaturesService),__param$X(8,IEnvironmentService)],SuggestModel);class OvertypingCapturer{static{this._maxSelectionLength=51200}constructor(w,D){this._disposables=new DisposableStore,this._lastOvertyped=[],this._locked=!1,this._disposables.add(w.onWillType(()=>{if(this._locked||!w.hasModel())return;const O=w.getSelections(),W=O.length;let U=!1;for(let q=0;q<W;q++)if(!O[q].isEmpty()){U=!0;break}if(!U){this._lastOvertyped.length!==0&&(this._lastOvertyped.length=0);return}this._lastOvertyped=[];const K=w.getModel();for(let q=0;q<W;q++){const G=O[q];if(K.getValueLengthInRange(G)>OvertypingCapturer._maxSelectionLength)return;this._lastOvertyped[q]={value:K.getValueInRange(G),multiline:G.startLineNumber!==G.endLineNumber}}})),this._disposables.add(D.onDidTrigger(O=>{this._locked=!0})),this._disposables.add(D.onDidCancel(O=>{this._locked=!1}))}getLastOvertypedInfo(w){if(w>=0&&w<this._lastOvertyped.length)return this._lastOvertyped[w]}dispose(){this._disposables.dispose()}}const IMarkerDecorationsService=createDecorator("markerDecorationsService");var __decorate$Z=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$W=function(F,w){return function(D,O){w(D,O,F)}};let MarkerDecorationsContribution=class{static{this.ID="editor.contrib.markerDecorations"}constructor(w,D){}dispose(){}};MarkerDecorationsContribution=__decorate$Z([__param$W(1,IMarkerDecorationsService)],MarkerDecorationsContribution);registerEditorContribution(MarkerDecorationsContribution.ID,MarkerDecorationsContribution,0);function applyFontInfo(F,w){F instanceof FastDomNode?(F.setFontFamily(w.getMassagedFontFamily()),F.setFontWeight(w.fontWeight),F.setFontSize(w.fontSize),F.setFontFeatureSettings(w.fontFeatureSettings),F.setFontVariationSettings(w.fontVariationSettings),F.setLineHeight(w.lineHeight),F.setLetterSpacing(w.letterSpacing)):(F.style.fontFamily=w.getMassagedFontFamily(),F.style.fontWeight=w.fontWeight,F.style.fontSize=w.fontSize+"px",F.style.fontFeatureSettings=w.fontFeatureSettings,F.style.fontVariationSettings=w.fontVariationSettings,F.style.lineHeight=w.lineHeight+"px",F.style.letterSpacing=w.letterSpacing+"px")}class ElementSizeObserver extends Disposable{constructor(w,D){super(),this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._referenceDomElement=w,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,D)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let w=null;const D=()=>{w?this.observe({width:w.width,height:w.height}):this.observe()};let O=!1,W=!1;const U=()=>{if(O&&!W)try{O=!1,W=!0,D()}finally{scheduleAtNextAnimationFrame(getWindow(this._referenceDomElement),()=>{W=!1,U()})}};this._resizeObserver=new ResizeObserver(K=>{K&&K[0]&&K[0].contentRect?w={width:K[0].contentRect.width,height:K[0].contentRect.height}:w=null,O=!0,U()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(w){this.measureReferenceDomElement(!0,w)}measureReferenceDomElement(w,D){let O=0,W=0;D?(O=D.width,W=D.height):this._referenceDomElement&&(O=this._referenceDomElement.clientWidth,W=this._referenceDomElement.clientHeight),O=Math.max(5,O),W=Math.max(5,W),(this._width!==O||this._height!==W)&&(this._width=O,this._height=W,w&&this._onDidChange.fire())}}class DevicePixelRatioMonitor extends Disposable{constructor(w){super(),this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(w,!0),this._mediaQueryList=null,this._handleChange(w,!1)}_handleChange(w,D){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=w.matchMedia(`(resolution: ${w.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),D&&this._onDidChange.fire()}}class PixelRatioMonitorImpl extends Disposable{get value(){return this._value}constructor(w){super(),this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio(w);const D=this._register(new DevicePixelRatioMonitor(w));this._register(D.onDidChange(()=>{this._value=this._getPixelRatio(w),this._onDidChange.fire(this._value)}))}_getPixelRatio(w){const D=document.createElement("canvas").getContext("2d"),O=w.devicePixelRatio||1,W=D.webkitBackingStorePixelRatio||D.mozBackingStorePixelRatio||D.msBackingStorePixelRatio||D.oBackingStorePixelRatio||D.backingStorePixelRatio||1;return O/W}}class PixelRatioMonitorFacade{constructor(){this.mapWindowIdToPixelRatioMonitor=new Map}_getOrCreatePixelRatioMonitor(w){const D=getWindowId(w);let O=this.mapWindowIdToPixelRatioMonitor.get(D);return O||(O=new PixelRatioMonitorImpl(w),this.mapWindowIdToPixelRatioMonitor.set(D,O),Event$1.once(onDidUnregisterWindow)(({vscodeWindowId:W})=>{W===D&&(O?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(D))})),O}getInstance(w){return this._getOrCreatePixelRatioMonitor(w)}}const PixelRatio=new PixelRatioMonitorFacade;class CharWidthRequest{constructor(w,D){this.chr=w,this.type=D,this.width=0}fulfill(w){this.width=w}}class DomCharWidthReader{constructor(w,D){this._bareFontInfo=w,this._requests=D,this._container=null,this._testElements=null}read(w){this._createDomElements(),w.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){const w=document.createElement("div");w.style.position="absolute",w.style.top="-50000px",w.style.width="50000px";const D=document.createElement("div");applyFontInfo(D,this._bareFontInfo),w.appendChild(D);const O=document.createElement("div");applyFontInfo(O,this._bareFontInfo),O.style.fontWeight="bold",w.appendChild(O);const W=document.createElement("div");applyFontInfo(W,this._bareFontInfo),W.style.fontStyle="italic",w.appendChild(W);const U=[];for(const K of this._requests){let q;K.type===0&&(q=D),K.type===2&&(q=O),K.type===1&&(q=W),q.appendChild(document.createElement("br"));const G=document.createElement("span");DomCharWidthReader._render(G,K),q.appendChild(G),U.push(G)}this._container=w,this._testElements=U}static _render(w,D){if(D.chr===" "){let O=" ";for(let W=0;W<8;W++)O+=O;w.innerText=O}else{let O=D.chr;for(let W=0;W<8;W++)O+=O;w.textContent=O}}_readFromDomElements(){for(let w=0,D=this._requests.length;w<D;w++){const O=this._requests[w],W=this._testElements[w];O.fulfill(W.offsetWidth/256)}}}function readCharWidths(F,w,D){new DomCharWidthReader(w,D).read(F)}const MINIMAP_GUTTER_WIDTH=8;class ConfigurationChangedEvent{constructor(w){this._values=w}hasChanged(w){return this._values[w]}}class ComputeOptionsMemory{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class BaseEditorOption{constructor(w,D,O,W){this.id=w,this.name=D,this.defaultValue=O,this.schema=W}applyUpdate(w,D){return applyUpdate(w,D)}compute(w,D,O){return O}}class ApplyUpdateResult{constructor(w,D){this.newValue=w,this.didChange=D}}function applyUpdate(F,w){if(typeof F!="object"||typeof w!="object"||!F||!w)return new ApplyUpdateResult(w,F!==w);if(Array.isArray(F)||Array.isArray(w)){const O=Array.isArray(F)&&Array.isArray(w)&&equals$1(F,w);return new ApplyUpdateResult(w,!O)}let D=!1;for(const O in w)if(w.hasOwnProperty(O)){const W=applyUpdate(F[O],w[O]);W.didChange&&(F[O]=W.newValue,D=!0)}return new ApplyUpdateResult(F,D)}class ComputedEditorOption{constructor(w){this.schema=void 0,this.id=w,this.name="_never_",this.defaultValue=void 0}applyUpdate(w,D){return applyUpdate(w,D)}validate(w){return this.defaultValue}}class SimpleEditorOption{constructor(w,D,O,W){this.id=w,this.name=D,this.defaultValue=O,this.schema=W}applyUpdate(w,D){return applyUpdate(w,D)}validate(w){return typeof w>"u"?this.defaultValue:w}compute(w,D,O){return O}}function boolean(F,w){return typeof F>"u"?w:F==="false"?!1:!!F}class EditorBooleanOption extends SimpleEditorOption{constructor(w,D,O,W=void 0){typeof W<"u"&&(W.type="boolean",W.default=O),super(w,D,O,W)}validate(w){return boolean(w,this.defaultValue)}}function clampedInt(F,w,D,O){if(typeof F>"u")return w;let W=parseInt(F,10);return isNaN(W)?w:(W=Math.max(D,W),W=Math.min(O,W),W|0)}class EditorIntOption extends SimpleEditorOption{static clampedInt(w,D,O,W){return clampedInt(w,D,O,W)}constructor(w,D,O,W,U,K=void 0){typeof K<"u"&&(K.type="integer",K.default=O,K.minimum=W,K.maximum=U),super(w,D,O,K),this.minimum=W,this.maximum=U}validate(w){return EditorIntOption.clampedInt(w,this.defaultValue,this.minimum,this.maximum)}}function clampedFloat(F,w,D,O){if(typeof F>"u")return w;const W=EditorFloatOption.float(F,w);return EditorFloatOption.clamp(W,D,O)}class EditorFloatOption extends SimpleEditorOption{static clamp(w,D,O){return w<D?D:w>O?O:w}static float(w,D){if(typeof w=="number")return w;if(typeof w>"u")return D;const O=parseFloat(w);return isNaN(O)?D:O}constructor(w,D,O,W,U){typeof U<"u"&&(U.type="number",U.default=O),super(w,D,O,U),this.validationFn=W}validate(w){return this.validationFn(EditorFloatOption.float(w,this.defaultValue))}}class EditorStringOption extends SimpleEditorOption{static string(w,D){return typeof w!="string"?D:w}constructor(w,D,O,W=void 0){typeof W<"u"&&(W.type="string",W.default=O),super(w,D,O,W)}validate(w){return EditorStringOption.string(w,this.defaultValue)}}function stringSet(F,w,D,O){return typeof F!="string"?w:O&&F in O?O[F]:D.indexOf(F)===-1?w:F}class EditorStringEnumOption extends SimpleEditorOption{constructor(w,D,O,W,U=void 0){typeof U<"u"&&(U.type="string",U.enum=W,U.default=O),super(w,D,O,U),this._allowedValues=W}validate(w){return stringSet(w,this.defaultValue,this._allowedValues)}}class EditorEnumOption extends BaseEditorOption{constructor(w,D,O,W,U,K,q=void 0){typeof q<"u"&&(q.type="string",q.enum=U,q.default=W),super(w,D,O,q),this._allowedValues=U,this._convert=K}validate(w){return typeof w!="string"?this.defaultValue:this._allowedValues.indexOf(w)===-1?this.defaultValue:this._convert(w)}}function _autoIndentFromString(F){switch(F){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class EditorAccessibilitySupport extends BaseEditorOption{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[localize("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),localize("accessibilitySupport.on","Optimize for usage with a Screen Reader."),localize("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:localize("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(w){switch(w){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(w,D,O){return O===0?w.accessibilitySupport:O}}class EditorComments extends BaseEditorOption{constructor(){const w={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",w,{"editor.comments.insertSpace":{type:"boolean",default:w.insertSpace,description:localize("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:w.ignoreEmptyLines,description:localize("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{insertSpace:boolean(D.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:boolean(D.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function _cursorBlinkingStyleFromString(F){switch(F){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var TextEditorCursorStyle$1;(function(F){F[F.Line=1]="Line",F[F.Block=2]="Block",F[F.Underline=3]="Underline",F[F.LineThin=4]="LineThin",F[F.BlockOutline=5]="BlockOutline",F[F.UnderlineThin=6]="UnderlineThin"})(TextEditorCursorStyle$1||(TextEditorCursorStyle$1={}));function _cursorStyleFromString(F){switch(F){case"line":return TextEditorCursorStyle$1.Line;case"block":return TextEditorCursorStyle$1.Block;case"underline":return TextEditorCursorStyle$1.Underline;case"line-thin":return TextEditorCursorStyle$1.LineThin;case"block-outline":return TextEditorCursorStyle$1.BlockOutline;case"underline-thin":return TextEditorCursorStyle$1.UnderlineThin}}class EditorClassName extends ComputedEditorOption{constructor(){super(143)}compute(w,D,O){const W=["monaco-editor"];return D.get(39)&&W.push(D.get(39)),w.extraEditorClassName&&W.push(w.extraEditorClassName),D.get(74)==="default"?W.push("mouse-default"):D.get(74)==="copy"&&W.push("mouse-copy"),D.get(112)&&W.push("showUnused"),D.get(141)&&W.push("showDeprecated"),W.join(" ")}}class EditorEmptySelectionClipboard extends EditorBooleanOption{constructor(){super(37,"emptySelectionClipboard",!0,{description:localize("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(w,D,O){return O&&w.emptySelectionClipboard}}class EditorFind extends BaseEditorOption{constructor(){const w={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(41,"find",w,{"editor.find.cursorMoveOnType":{type:"boolean",default:w.cursorMoveOnType,description:localize("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:w.seedSearchStringFromSelection,enumDescriptions:[localize("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),localize("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),localize("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:localize("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:w.autoFindInSelection,enumDescriptions:[localize("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),localize("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),localize("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:localize("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:w.globalFindClipboard,description:localize("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:isMacintosh},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:w.addExtraSpaceOnTop,description:localize("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:w.loop,description:localize("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{cursorMoveOnType:boolean(D.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof w.seedSearchStringFromSelection=="boolean"?w.seedSearchStringFromSelection?"always":"never":stringSet(D.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof w.autoFindInSelection=="boolean"?w.autoFindInSelection?"always":"never":stringSet(D.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:boolean(D.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:boolean(D.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:boolean(D.loop,this.defaultValue.loop)}}}class EditorFontLigatures extends BaseEditorOption{static{this.OFF='"liga" off, "calt" off'}static{this.ON='"liga" on, "calt" on'}constructor(){super(51,"fontLigatures",EditorFontLigatures.OFF,{anyOf:[{type:"boolean",description:localize("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:localize("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:localize("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(w){return typeof w>"u"?this.defaultValue:typeof w=="string"?w==="false"||w.length===0?EditorFontLigatures.OFF:w==="true"?EditorFontLigatures.ON:w:w?EditorFontLigatures.ON:EditorFontLigatures.OFF}}class EditorFontVariations extends BaseEditorOption{static{this.OFF="normal"}static{this.TRANSLATE="translate"}constructor(){super(54,"fontVariations",EditorFontVariations.OFF,{anyOf:[{type:"boolean",description:localize("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:localize("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:localize("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(w){return typeof w>"u"?this.defaultValue:typeof w=="string"?w==="false"?EditorFontVariations.OFF:w==="true"?EditorFontVariations.TRANSLATE:w:w?EditorFontVariations.TRANSLATE:EditorFontVariations.OFF}compute(w,D,O){return w.fontInfo.fontVariationSettings}}class EditorFontInfo extends ComputedEditorOption{constructor(){super(50)}compute(w,D,O){return w.fontInfo}}class EditorFontSize extends SimpleEditorOption{constructor(){super(52,"fontSize",EDITOR_FONT_DEFAULTS.fontSize,{type:"number",minimum:6,maximum:100,default:EDITOR_FONT_DEFAULTS.fontSize,description:localize("fontSize","Controls the font size in pixels.")})}validate(w){const D=EditorFloatOption.float(w,this.defaultValue);return D===0?EDITOR_FONT_DEFAULTS.fontSize:EditorFloatOption.clamp(D,6,100)}compute(w,D,O){return w.fontInfo.fontSize}}class EditorFontWeight extends BaseEditorOption{static{this.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"]}static{this.MINIMUM_VALUE=1}static{this.MAXIMUM_VALUE=1e3}constructor(){super(53,"fontWeight",EDITOR_FONT_DEFAULTS.fontWeight,{anyOf:[{type:"number",minimum:EditorFontWeight.MINIMUM_VALUE,maximum:EditorFontWeight.MAXIMUM_VALUE,errorMessage:localize("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:EditorFontWeight.SUGGESTION_VALUES}],default:EDITOR_FONT_DEFAULTS.fontWeight,description:localize("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(w){return w==="normal"||w==="bold"?w:String(EditorIntOption.clampedInt(w,EDITOR_FONT_DEFAULTS.fontWeight,EditorFontWeight.MINIMUM_VALUE,EditorFontWeight.MAXIMUM_VALUE))}}class EditorGoToLocation extends BaseEditorOption{constructor(){const w={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},D={type:"string",enum:["peek","gotoAndPeek","goto"],default:w.multiple,enumDescriptions:[localize("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),localize("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),localize("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},O=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(58,"gotoLocation",w,{"editor.gotoLocation.multiple":{deprecationMessage:localize("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:localize("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...D},"editor.gotoLocation.multipleTypeDefinitions":{description:localize("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...D},"editor.gotoLocation.multipleDeclarations":{description:localize("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...D},"editor.gotoLocation.multipleImplementations":{description:localize("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...D},"editor.gotoLocation.multipleReferences":{description:localize("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...D},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:w.alternativeDefinitionCommand,enum:O,description:localize("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:w.alternativeTypeDefinitionCommand,enum:O,description:localize("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:w.alternativeDeclarationCommand,enum:O,description:localize("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:w.alternativeImplementationCommand,enum:O,description:localize("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:w.alternativeReferenceCommand,enum:O,description:localize("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{multiple:stringSet(D.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:D.multipleDefinitions??stringSet(D.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:D.multipleTypeDefinitions??stringSet(D.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:D.multipleDeclarations??stringSet(D.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:D.multipleImplementations??stringSet(D.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:D.multipleReferences??stringSet(D.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:D.multipleTests??stringSet(D.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:EditorStringOption.string(D.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:EditorStringOption.string(D.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:EditorStringOption.string(D.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:EditorStringOption.string(D.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:EditorStringOption.string(D.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:EditorStringOption.string(D.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}}class EditorHover extends BaseEditorOption{constructor(){const w={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(60,"hover",w,{"editor.hover.enabled":{type:"boolean",default:w.enabled,description:localize("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:w.delay,minimum:0,maximum:1e4,description:localize("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:w.sticky,description:localize("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:w.hidingDelay,description:localize("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:w.above,description:localize("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{enabled:boolean(D.enabled,this.defaultValue.enabled),delay:EditorIntOption.clampedInt(D.delay,this.defaultValue.delay,0,1e4),sticky:boolean(D.sticky,this.defaultValue.sticky),hidingDelay:EditorIntOption.clampedInt(D.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:boolean(D.above,this.defaultValue.above)}}}class EditorLayoutInfoComputer extends ComputedEditorOption{constructor(){super(146)}compute(w,D,O){return EditorLayoutInfoComputer.computeLayout(D,{memory:w.memory,outerWidth:w.outerWidth,outerHeight:w.outerHeight,isDominatedByLongLines:w.isDominatedByLongLines,lineHeight:w.fontInfo.lineHeight,viewLineCount:w.viewLineCount,lineNumbersDigitCount:w.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:w.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:w.fontInfo.maxDigitWidth,pixelRatio:w.pixelRatio,glyphMarginDecorationLaneCount:w.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(w){const D=w.height/w.lineHeight,O=Math.floor(w.paddingTop/w.lineHeight);let W=Math.floor(w.paddingBottom/w.lineHeight);w.scrollBeyondLastLine&&(W=Math.max(W,D-1));const U=(O+w.viewLineCount+W)/(w.pixelRatio*w.height),K=Math.floor(w.viewLineCount/U);return{typicalViewportLineCount:D,extraLinesBeforeFirstLine:O,extraLinesBeyondLastLine:W,desiredRatio:U,minimapLineCount:K}}static _computeMinimapLayout(w,D){const O=w.outerWidth,W=w.outerHeight,U=w.pixelRatio;if(!w.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(U*W),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:W};const K=D.stableMinimapLayoutInput,q=K&&w.outerHeight===K.outerHeight&&w.lineHeight===K.lineHeight&&w.typicalHalfwidthCharacterWidth===K.typicalHalfwidthCharacterWidth&&w.pixelRatio===K.pixelRatio&&w.scrollBeyondLastLine===K.scrollBeyondLastLine&&w.paddingTop===K.paddingTop&&w.paddingBottom===K.paddingBottom&&w.minimap.enabled===K.minimap.enabled&&w.minimap.side===K.minimap.side&&w.minimap.size===K.minimap.size&&w.minimap.showSlider===K.minimap.showSlider&&w.minimap.renderCharacters===K.minimap.renderCharacters&&w.minimap.maxColumn===K.minimap.maxColumn&&w.minimap.scale===K.minimap.scale&&w.verticalScrollbarWidth===K.verticalScrollbarWidth&&w.isViewportWrapping===K.isViewportWrapping,G=w.lineHeight,Q=w.typicalHalfwidthCharacterWidth,Y=w.scrollBeyondLastLine,X=w.minimap.renderCharacters;let J=U>=2?Math.round(w.minimap.scale*2):w.minimap.scale;const te=w.minimap.maxColumn,ie=w.minimap.size,se=w.minimap.side,re=w.verticalScrollbarWidth,ae=w.viewLineCount,le=w.remainingWidth,de=w.isViewportWrapping,oe=X?2:3;let ue=Math.floor(U*W);const pe=ue/U;let fe=!1,Ce=!1,we=oe*J,Oe=J/U,Te=1;if(ie==="fill"||ie==="fit"){const{typicalViewportLineCount:Je,extraLinesBeforeFirstLine:at,extraLinesBeyondLastLine:st,desiredRatio:lt,minimapLineCount:Tt}=EditorLayoutInfoComputer.computeContainedMinimapLineCount({viewLineCount:ae,scrollBeyondLastLine:Y,paddingTop:w.paddingTop,paddingBottom:w.paddingBottom,height:W,lineHeight:G,pixelRatio:U});if(ae/Tt>1)fe=!0,Ce=!0,J=1,we=1,Oe=J/U;else{let je=!1,et=J+1;if(ie==="fit"){const mt=Math.ceil((at+ae+st)*we);de&&q&&le<=D.stableFitRemainingWidth?(je=!0,et=D.stableFitMaxMinimapScale):je=mt>ue}if(ie==="fill"||je){fe=!0;const mt=J;we=Math.min(G*U,Math.max(1,Math.floor(1/lt))),de&&q&&le<=D.stableFitRemainingWidth&&(et=D.stableFitMaxMinimapScale),J=Math.min(et,Math.max(1,Math.floor(we/oe))),J>mt&&(Te=Math.min(2,J/mt)),Oe=J/U/Te,ue=Math.ceil(Math.max(Je,at+ae+st)*we),de?(D.stableMinimapLayoutInput=w,D.stableFitRemainingWidth=le,D.stableFitMaxMinimapScale=J):(D.stableMinimapLayoutInput=null,D.stableFitRemainingWidth=0)}}}const Re=Math.floor(te*Oe),Me=Math.min(Re,Math.max(0,Math.floor((le-re-2)*Oe/(Q+Oe)))+MINIMAP_GUTTER_WIDTH);let Ne=Math.floor(U*Me);const ze=Ne/U;Ne=Math.floor(Ne*Te);const Qe=X?1:2,Ye=se==="left"?0:O-Me-re;return{renderMinimap:Qe,minimapLeft:Ye,minimapWidth:Me,minimapHeightIsEditorHeight:fe,minimapIsSampling:Ce,minimapScale:J,minimapLineHeight:we,minimapCanvasInnerWidth:Ne,minimapCanvasInnerHeight:ue,minimapCanvasOuterWidth:ze,minimapCanvasOuterHeight:pe}}static computeLayout(w,D){const O=D.outerWidth|0,W=D.outerHeight|0,U=D.lineHeight|0,K=D.lineNumbersDigitCount|0,q=D.typicalHalfwidthCharacterWidth,G=D.maxDigitWidth,Q=D.pixelRatio,Y=D.viewLineCount,X=w.get(138),J=X==="inherit"?w.get(137):X,te=J==="inherit"?w.get(133):J,ie=w.get(136),se=D.isDominatedByLongLines,re=w.get(57),ae=w.get(68).renderType!==0,le=w.get(69),de=w.get(106),oe=w.get(84),ue=w.get(73),pe=w.get(104),fe=pe.verticalScrollbarSize,Ce=pe.verticalHasArrows,we=pe.arrowSize,Oe=pe.horizontalScrollbarSize,Te=w.get(43),Re=w.get(111)!=="never";let Me=w.get(66);Te&&Re&&(Me+=16);let Ne=0;if(ae){const Et=Math.max(K,le);Ne=Math.round(Et*G)}let ze=0;re&&(ze=U*D.glyphMarginDecorationLaneCount);let Qe=0,Ye=Qe+ze,Je=Ye+Ne,at=Je+Me;const st=O-ze-Ne-Me;let lt=!1,Tt=!1,Ke=-1;J==="inherit"&&se?(lt=!0,Tt=!0):te==="on"||te==="bounded"?Tt=!0:te==="wordWrapColumn"&&(Ke=ie);const je=EditorLayoutInfoComputer._computeMinimapLayout({outerWidth:O,outerHeight:W,lineHeight:U,typicalHalfwidthCharacterWidth:q,pixelRatio:Q,scrollBeyondLastLine:de,paddingTop:oe.top,paddingBottom:oe.bottom,minimap:ue,verticalScrollbarWidth:fe,viewLineCount:Y,remainingWidth:st,isViewportWrapping:Tt},D.memory||new ComputeOptionsMemory);je.renderMinimap!==0&&je.minimapLeft===0&&(Qe+=je.minimapWidth,Ye+=je.minimapWidth,Je+=je.minimapWidth,at+=je.minimapWidth);const et=st-je.minimapWidth,mt=Math.max(1,Math.floor((et-fe-2)/q)),Mt=Ce?we:0;return Tt&&(Ke=Math.max(1,mt),te==="bounded"&&(Ke=Math.min(Ke,ie))),{width:O,height:W,glyphMarginLeft:Qe,glyphMarginWidth:ze,glyphMarginDecorationLaneCount:D.glyphMarginDecorationLaneCount,lineNumbersLeft:Ye,lineNumbersWidth:Ne,decorationsLeft:Je,decorationsWidth:Me,contentLeft:at,contentWidth:et,minimap:je,viewportColumn:mt,isWordWrapMinified:lt,isViewportWrapping:Tt,wrappingColumn:Ke,verticalScrollbarWidth:fe,horizontalScrollbarHeight:Oe,overviewRuler:{top:Mt,width:fe,height:W-2*Mt,right:0}}}}class WrappingStrategy extends BaseEditorOption{constructor(){super(140,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[localize("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),localize("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:localize("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(w){return stringSet(w,"simple",["simple","advanced"])}compute(w,D,O){return D.get(2)===2?"advanced":O}}var ShowLightbulbIconMode$1;(function(F){F.Off="off",F.OnCode="onCode",F.On="on"})(ShowLightbulbIconMode$1||(ShowLightbulbIconMode$1={}));class EditorLightbulb extends BaseEditorOption{constructor(){const w={enabled:ShowLightbulbIconMode$1.OnCode};super(65,"lightbulb",w,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:[ShowLightbulbIconMode$1.Off,ShowLightbulbIconMode$1.OnCode,ShowLightbulbIconMode$1.On],default:w.enabled,enumDescriptions:[localize("editor.lightbulb.enabled.off","Disable the code action menu."),localize("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),localize("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:localize("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(w){return!w||typeof w!="object"?this.defaultValue:{enabled:stringSet(w.enabled,this.defaultValue.enabled,[ShowLightbulbIconMode$1.Off,ShowLightbulbIconMode$1.OnCode,ShowLightbulbIconMode$1.On])}}}class EditorStickyScroll extends BaseEditorOption{constructor(){const w={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(116,"stickyScroll",w,{"editor.stickyScroll.enabled":{type:"boolean",default:w.enabled,description:localize("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:w.maxLineCount,minimum:1,maximum:20,description:localize("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:w.defaultModel,description:localize("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:w.scrollWithEditor,description:localize("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{enabled:boolean(D.enabled,this.defaultValue.enabled),maxLineCount:EditorIntOption.clampedInt(D.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:stringSet(D.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:boolean(D.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class EditorInlayHints extends BaseEditorOption{constructor(){const w={enabled:"on",fontSize:0,fontFamily:"",padding:!1};super(142,"inlayHints",w,{"editor.inlayHints.enabled":{type:"string",default:w.enabled,description:localize("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[localize("editor.inlayHints.on","Inlay hints are enabled"),localize("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",isMacintosh?"Ctrl+Option":"Ctrl+Alt"),localize("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",isMacintosh?"Ctrl+Option":"Ctrl+Alt"),localize("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:w.fontSize,markdownDescription:localize("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:w.fontFamily,markdownDescription:localize("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:w.padding,description:localize("inlayHints.padding","Enables the padding around the inlay hints in the editor.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return typeof D.enabled=="boolean"&&(D.enabled=D.enabled?"on":"off"),{enabled:stringSet(D.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:EditorIntOption.clampedInt(D.fontSize,this.defaultValue.fontSize,0,100),fontFamily:EditorStringOption.string(D.fontFamily,this.defaultValue.fontFamily),padding:boolean(D.padding,this.defaultValue.padding)}}}class EditorLineDecorationsWidth extends BaseEditorOption{constructor(){super(66,"lineDecorationsWidth",10)}validate(w){return typeof w=="string"&&/^\d+(\.\d+)?ch$/.test(w)?-parseFloat(w.substring(0,w.length-2)):EditorIntOption.clampedInt(w,this.defaultValue,0,1e3)}compute(w,D,O){return O<0?EditorIntOption.clampedInt(-O*w.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):O}}class EditorLineHeight extends EditorFloatOption{constructor(){super(67,"lineHeight",EDITOR_FONT_DEFAULTS.lineHeight,w=>EditorFloatOption.clamp(w,0,150),{markdownDescription:localize("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(w,D,O){return w.fontInfo.lineHeight}}class EditorMinimap extends BaseEditorOption{constructor(){const w={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(73,"minimap",w,{"editor.minimap.enabled":{type:"boolean",default:w.enabled,description:localize("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:w.autohide,description:localize("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[localize("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),localize("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),localize("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:w.size,description:localize("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:w.side,description:localize("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:w.showSlider,description:localize("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:w.scale,minimum:1,maximum:3,enum:[1,2,3],description:localize("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:w.renderCharacters,description:localize("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:w.maxColumn,description:localize("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:w.showRegionSectionHeaders,description:localize("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:w.showMarkSectionHeaders,description:localize("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:w.sectionHeaderFontSize,description:localize("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:w.sectionHeaderLetterSpacing,description:localize("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{enabled:boolean(D.enabled,this.defaultValue.enabled),autohide:boolean(D.autohide,this.defaultValue.autohide),size:stringSet(D.size,this.defaultValue.size,["proportional","fill","fit"]),side:stringSet(D.side,this.defaultValue.side,["right","left"]),showSlider:stringSet(D.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:boolean(D.renderCharacters,this.defaultValue.renderCharacters),scale:EditorIntOption.clampedInt(D.scale,1,1,3),maxColumn:EditorIntOption.clampedInt(D.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:boolean(D.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:boolean(D.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:EditorFloatOption.clamp(D.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:EditorFloatOption.clamp(D.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}}function _multiCursorModifierFromString(F){return F==="ctrlCmd"?isMacintosh?"metaKey":"ctrlKey":"altKey"}class EditorPadding extends BaseEditorOption{constructor(){super(84,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:localize("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:localize("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{top:EditorIntOption.clampedInt(D.top,0,0,1e3),bottom:EditorIntOption.clampedInt(D.bottom,0,0,1e3)}}}class EditorParameterHints extends BaseEditorOption{constructor(){const w={enabled:!0,cycle:!0};super(86,"parameterHints",w,{"editor.parameterHints.enabled":{type:"boolean",default:w.enabled,description:localize("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:w.cycle,description:localize("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{enabled:boolean(D.enabled,this.defaultValue.enabled),cycle:boolean(D.cycle,this.defaultValue.cycle)}}}class EditorPixelRatio extends ComputedEditorOption{constructor(){super(144)}compute(w,D,O){return w.pixelRatio}}class PlaceholderOption extends BaseEditorOption{constructor(){super(88,"placeholder",void 0)}validate(w){return typeof w>"u"?this.defaultValue:typeof w=="string"?w:this.defaultValue}}class EditorQuickSuggestions extends BaseEditorOption{constructor(){const w={other:"on",comments:"off",strings:"off"},D=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[localize("on","Quick suggestions show inside the suggest widget"),localize("inline","Quick suggestions show as ghost text"),localize("off","Quick suggestions are disabled")]}];super(90,"quickSuggestions",w,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:D,default:w.strings,description:localize("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:D,default:w.comments,description:localize("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:D,default:w.other,description:localize("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:w,markdownDescription:localize("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=w}validate(w){if(typeof w=="boolean"){const Q=w?"on":"off";return{comments:Q,strings:Q,other:Q}}if(!w||typeof w!="object")return this.defaultValue;const{other:D,comments:O,strings:W}=w,U=["on","inline","off"];let K,q,G;return typeof D=="boolean"?K=D?"on":"off":K=stringSet(D,this.defaultValue.other,U),typeof O=="boolean"?q=O?"on":"off":q=stringSet(O,this.defaultValue.comments,U),typeof W=="boolean"?G=W?"on":"off":G=stringSet(W,this.defaultValue.strings,U),{other:K,comments:q,strings:G}}}class EditorRenderLineNumbersOption extends BaseEditorOption{constructor(){super(68,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[localize("lineNumbers.off","Line numbers are not rendered."),localize("lineNumbers.on","Line numbers are rendered as absolute number."),localize("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),localize("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:localize("lineNumbers","Controls the display of line numbers.")})}validate(w){let D=this.defaultValue.renderType,O=this.defaultValue.renderFn;return typeof w<"u"&&(typeof w=="function"?(D=4,O=w):w==="interval"?D=3:w==="relative"?D=2:w==="on"?D=1:D=0),{renderType:D,renderFn:O}}}function filterValidationDecorations(F){const w=F.get(99);return w==="editable"?F.get(92):w!=="on"}class EditorRulers extends BaseEditorOption{constructor(){const w=[],D={type:"number",description:localize("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(103,"rulers",w,{type:"array",items:{anyOf:[D,{type:["object"],properties:{column:D,color:{type:"string",description:localize("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:w,description:localize("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(w){if(Array.isArray(w)){const D=[];for(const O of w)if(typeof O=="number")D.push({column:EditorIntOption.clampedInt(O,0,0,1e4),color:null});else if(O&&typeof O=="object"){const W=O;D.push({column:EditorIntOption.clampedInt(W.column,0,0,1e4),color:W.color})}return D.sort((O,W)=>O.column-W.column),D}return this.defaultValue}}class ReadonlyMessage extends BaseEditorOption{constructor(){super(93,"readOnlyMessage",void 0)}validate(w){return!w||typeof w!="object"?this.defaultValue:w}}function _scrollbarVisibilityFromString(F,w){if(typeof F!="string")return w;switch(F){case"hidden":return 2;case"visible":return 3;default:return 1}}let EditorScrollbar$1=class extends BaseEditorOption{constructor(){const w={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(104,"scrollbar",w,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[localize("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),localize("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),localize("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:localize("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[localize("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),localize("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),localize("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:localize("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:w.verticalScrollbarSize,description:localize("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:w.horizontalScrollbarSize,description:localize("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:w.scrollByPage,description:localize("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:w.ignoreHorizontalScrollbarInContentHeight,description:localize("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w,O=EditorIntOption.clampedInt(D.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),W=EditorIntOption.clampedInt(D.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:EditorIntOption.clampedInt(D.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:_scrollbarVisibilityFromString(D.vertical,this.defaultValue.vertical),horizontal:_scrollbarVisibilityFromString(D.horizontal,this.defaultValue.horizontal),useShadows:boolean(D.useShadows,this.defaultValue.useShadows),verticalHasArrows:boolean(D.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:boolean(D.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:boolean(D.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:boolean(D.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:O,horizontalSliderSize:EditorIntOption.clampedInt(D.horizontalSliderSize,O,0,1e3),verticalScrollbarSize:W,verticalSliderSize:EditorIntOption.clampedInt(D.verticalSliderSize,W,0,1e3),scrollByPage:boolean(D.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:boolean(D.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}};const inUntrustedWorkspace="inUntrustedWorkspace",unicodeHighlightConfigKeys={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class UnicodeHighlight extends BaseEditorOption{constructor(){const w={nonBasicASCII:inUntrustedWorkspace,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:inUntrustedWorkspace,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(126,"unicodeHighlight",w,{[unicodeHighlightConfigKeys.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,inUntrustedWorkspace],default:w.nonBasicASCII,description:localize("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[unicodeHighlightConfigKeys.invisibleCharacters]:{restricted:!0,type:"boolean",default:w.invisibleCharacters,description:localize("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[unicodeHighlightConfigKeys.ambiguousCharacters]:{restricted:!0,type:"boolean",default:w.ambiguousCharacters,description:localize("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[unicodeHighlightConfigKeys.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,inUntrustedWorkspace],default:w.includeComments,description:localize("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[unicodeHighlightConfigKeys.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,inUntrustedWorkspace],default:w.includeStrings,description:localize("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[unicodeHighlightConfigKeys.allowedCharacters]:{restricted:!0,type:"object",default:w.allowedCharacters,description:localize("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[unicodeHighlightConfigKeys.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:w.allowedLocales,description:localize("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(w,D){let O=!1;D.allowedCharacters&&w&&(equals(w.allowedCharacters,D.allowedCharacters)||(w={...w,allowedCharacters:D.allowedCharacters},O=!0)),D.allowedLocales&&w&&(equals(w.allowedLocales,D.allowedLocales)||(w={...w,allowedLocales:D.allowedLocales},O=!0));const W=super.applyUpdate(w,D);return O?new ApplyUpdateResult(W.newValue,!0):W}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{nonBasicASCII:primitiveSet(D.nonBasicASCII,inUntrustedWorkspace,[!0,!1,inUntrustedWorkspace]),invisibleCharacters:boolean(D.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:boolean(D.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:primitiveSet(D.includeComments,inUntrustedWorkspace,[!0,!1,inUntrustedWorkspace]),includeStrings:primitiveSet(D.includeStrings,inUntrustedWorkspace,[!0,!1,inUntrustedWorkspace]),allowedCharacters:this.validateBooleanMap(w.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(w.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(w,D){if(typeof w!="object"||!w)return D;const O={};for(const[W,U]of Object.entries(w))U===!0&&(O[W]=!0);return O}}class InlineEditorSuggest extends BaseEditorOption{constructor(){const w={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default"};super(62,"inlineSuggest",w,{"editor.inlineSuggest.enabled":{type:"boolean",default:w.enabled,description:localize("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:w.showToolbar,enum:["always","onHover","never"],enumDescriptions:[localize("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),localize("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),localize("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:localize("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:w.suppressSuggestions,description:localize("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:w.fontFamily,description:localize("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{enabled:boolean(D.enabled,this.defaultValue.enabled),mode:stringSet(D.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:stringSet(D.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:boolean(D.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:boolean(D.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:EditorStringOption.string(D.fontFamily,this.defaultValue.fontFamily)}}}class InlineEditorEdit extends BaseEditorOption{constructor(){const w={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(63,"experimentalInlineEdit",w,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:w.enabled,description:localize("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:w.showToolbar,enum:["always","onHover","never"],enumDescriptions:[localize("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),localize("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),localize("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:localize("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:w.fontFamily,description:localize("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{enabled:boolean(D.enabled,this.defaultValue.enabled),showToolbar:stringSet(D.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:EditorStringOption.string(D.fontFamily,this.defaultValue.fontFamily),keepOnBlur:boolean(D.keepOnBlur,this.defaultValue.keepOnBlur)}}}class BracketPairColorization extends BaseEditorOption{constructor(){const w={enabled:EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",w,{"editor.bracketPairColorization.enabled":{type:"boolean",default:w.enabled,markdownDescription:localize("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:w.independentColorPoolPerBracketType,description:localize("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{enabled:boolean(D.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:boolean(D.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class GuideOptions extends BaseEditorOption{constructor(){const w={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",w,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[localize("editor.guides.bracketPairs.true","Enables bracket pair guides."),localize("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),localize("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:w.bracketPairs,description:localize("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[localize("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),localize("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),localize("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:w.bracketPairsHorizontal,description:localize("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:w.highlightActiveBracketPair,description:localize("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:w.indentation,description:localize("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[localize("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),localize("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),localize("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:w.highlightActiveIndentation,description:localize("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{bracketPairs:primitiveSet(D.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:primitiveSet(D.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:boolean(D.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:boolean(D.indentation,this.defaultValue.indentation),highlightActiveIndentation:primitiveSet(D.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function primitiveSet(F,w,D){const O=D.indexOf(F);return O===-1?w:D[O]}class EditorSuggest extends BaseEditorOption{constructor(){const w={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(119,"suggest",w,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[localize("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),localize("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:w.insertMode,description:localize("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:w.filterGraceful,description:localize("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:w.localityBonus,description:localize("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:w.shareSuggestSelections,markdownDescription:localize("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[localize("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),localize("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),localize("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),localize("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:w.selectionMode,markdownDescription:localize("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:w.snippetsPreventQuickSuggestions,description:localize("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:w.showIcons,description:localize("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:w.showStatusBar,description:localize("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:w.preview,description:localize("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:w.showInlineDetails,description:localize("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:localize("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:localize("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{insertMode:stringSet(D.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:boolean(D.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:boolean(D.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:boolean(D.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:boolean(D.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:stringSet(D.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:boolean(D.showIcons,this.defaultValue.showIcons),showStatusBar:boolean(D.showStatusBar,this.defaultValue.showStatusBar),preview:boolean(D.preview,this.defaultValue.preview),previewMode:stringSet(D.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:boolean(D.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:boolean(D.showMethods,this.defaultValue.showMethods),showFunctions:boolean(D.showFunctions,this.defaultValue.showFunctions),showConstructors:boolean(D.showConstructors,this.defaultValue.showConstructors),showDeprecated:boolean(D.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:boolean(D.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:boolean(D.showFields,this.defaultValue.showFields),showVariables:boolean(D.showVariables,this.defaultValue.showVariables),showClasses:boolean(D.showClasses,this.defaultValue.showClasses),showStructs:boolean(D.showStructs,this.defaultValue.showStructs),showInterfaces:boolean(D.showInterfaces,this.defaultValue.showInterfaces),showModules:boolean(D.showModules,this.defaultValue.showModules),showProperties:boolean(D.showProperties,this.defaultValue.showProperties),showEvents:boolean(D.showEvents,this.defaultValue.showEvents),showOperators:boolean(D.showOperators,this.defaultValue.showOperators),showUnits:boolean(D.showUnits,this.defaultValue.showUnits),showValues:boolean(D.showValues,this.defaultValue.showValues),showConstants:boolean(D.showConstants,this.defaultValue.showConstants),showEnums:boolean(D.showEnums,this.defaultValue.showEnums),showEnumMembers:boolean(D.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:boolean(D.showKeywords,this.defaultValue.showKeywords),showWords:boolean(D.showWords,this.defaultValue.showWords),showColors:boolean(D.showColors,this.defaultValue.showColors),showFiles:boolean(D.showFiles,this.defaultValue.showFiles),showReferences:boolean(D.showReferences,this.defaultValue.showReferences),showFolders:boolean(D.showFolders,this.defaultValue.showFolders),showTypeParameters:boolean(D.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:boolean(D.showSnippets,this.defaultValue.showSnippets),showUsers:boolean(D.showUsers,this.defaultValue.showUsers),showIssues:boolean(D.showIssues,this.defaultValue.showIssues)}}}class SmartSelect extends BaseEditorOption{constructor(){super(114,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:localize("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:localize("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(w){return!w||typeof w!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:boolean(w.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:boolean(w.selectSubwords,this.defaultValue.selectSubwords)}}}class WordSegmenterLocales extends BaseEditorOption{constructor(){const w=[];super(131,"wordSegmenterLocales",w,{anyOf:[{description:localize("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:localize("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(w){if(typeof w=="string"&&(w=[w]),Array.isArray(w)){const D=[];for(const O of w)if(typeof O=="string")try{Intl.Segmenter.supportedLocalesOf(O).length>0&&D.push(O)}catch{}return D}return this.defaultValue}}class WrappingIndentOption extends BaseEditorOption{constructor(){super(139,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[localize("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),localize("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),localize("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),localize("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:localize("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(w){switch(w){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(w,D,O){return D.get(2)===2?0:O}}class EditorWrappingInfoComputer extends ComputedEditorOption{constructor(){super(147)}compute(w,D,O){const W=D.get(146);return{isDominatedByLongLines:w.isDominatedByLongLines,isWordWrapMinified:W.isWordWrapMinified,isViewportWrapping:W.isViewportWrapping,wrappingColumn:W.wrappingColumn}}}class EditorDropIntoEditor extends BaseEditorOption{constructor(){const w={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",w,{"editor.dropIntoEditor.enabled":{type:"boolean",default:w.enabled,markdownDescription:localize("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:localize("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[localize("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),localize("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{enabled:boolean(D.enabled,this.defaultValue.enabled),showDropSelector:stringSet(D.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class EditorPasteAs extends BaseEditorOption{constructor(){const w={enabled:!0,showPasteSelector:"afterPaste"};super(85,"pasteAs",w,{"editor.pasteAs.enabled":{type:"boolean",default:w.enabled,markdownDescription:localize("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:localize("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[localize("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),localize("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(w){if(!w||typeof w!="object")return this.defaultValue;const D=w;return{enabled:boolean(D.enabled,this.defaultValue.enabled),showPasteSelector:stringSet(D.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const DEFAULT_WINDOWS_FONT_FAMILY="Consolas, 'Courier New', monospace",DEFAULT_MAC_FONT_FAMILY="Menlo, Monaco, 'Courier New', monospace",DEFAULT_LINUX_FONT_FAMILY="'Droid Sans Mono', 'monospace', monospace",EDITOR_FONT_DEFAULTS={fontFamily:isMacintosh?DEFAULT_MAC_FONT_FAMILY:isLinux?DEFAULT_LINUX_FONT_FAMILY:DEFAULT_WINDOWS_FONT_FAMILY,fontWeight:"normal",fontSize:isMacintosh?12:14,lineHeight:0,letterSpacing:0},editorOptionsRegistry=[];function register$1(F){return editorOptionsRegistry[F.id]=F,F}const EditorOptions={acceptSuggestionOnCommitCharacter:register$1(new EditorBooleanOption(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:localize("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:register$1(new EditorStringEnumOption(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",localize("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:localize("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:register$1(new EditorAccessibilitySupport),accessibilityPageSize:register$1(new EditorIntOption(3,"accessibilityPageSize",10,1,1073741824,{description:localize("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:register$1(new EditorStringOption(4,"ariaLabel",localize("editorViewAccessibleLabel","Editor content"))),ariaRequired:register$1(new EditorBooleanOption(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:register$1(new EditorBooleanOption(8,"screenReaderAnnounceInlineSuggestion",!0,{description:localize("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:register$1(new EditorStringEnumOption(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",localize("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),localize("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:localize("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:register$1(new EditorStringEnumOption(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",localize("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),localize("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:localize("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:register$1(new EditorStringEnumOption(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",localize("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:localize("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:register$1(new EditorStringEnumOption(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",localize("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:localize("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:register$1(new EditorStringEnumOption(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",localize("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),localize("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:localize("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:register$1(new EditorEnumOption(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],_autoIndentFromString,{enumDescriptions:[localize("editor.autoIndent.none","The editor will not insert indentation automatically."),localize("editor.autoIndent.keep","The editor will keep the current line's indentation."),localize("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),localize("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),localize("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:localize("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:register$1(new EditorBooleanOption(13,"automaticLayout",!1)),autoSurround:register$1(new EditorStringEnumOption(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[localize("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),localize("editor.autoSurround.quotes","Surround with quotes but not brackets."),localize("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:localize("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:register$1(new BracketPairColorization),bracketPairGuides:register$1(new GuideOptions),stickyTabStops:register$1(new EditorBooleanOption(117,"stickyTabStops",!1,{description:localize("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:register$1(new EditorBooleanOption(17,"codeLens",!0,{description:localize("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:register$1(new EditorStringOption(18,"codeLensFontFamily","",{description:localize("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:register$1(new EditorIntOption(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:localize("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:register$1(new EditorBooleanOption(20,"colorDecorators",!0,{description:localize("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:register$1(new EditorStringEnumOption(149,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[localize("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),localize("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),localize("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:localize("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:register$1(new EditorIntOption(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:localize("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:register$1(new EditorBooleanOption(22,"columnSelection",!1,{description:localize("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:register$1(new EditorComments),contextmenu:register$1(new EditorBooleanOption(24,"contextmenu",!0)),copyWithSyntaxHighlighting:register$1(new EditorBooleanOption(25,"copyWithSyntaxHighlighting",!0,{description:localize("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:register$1(new EditorEnumOption(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],_cursorBlinkingStyleFromString,{description:localize("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:register$1(new EditorStringEnumOption(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[localize("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),localize("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),localize("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:localize("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:register$1(new EditorEnumOption(28,"cursorStyle",TextEditorCursorStyle$1.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],_cursorStyleFromString,{description:localize("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:register$1(new EditorIntOption(29,"cursorSurroundingLines",0,0,1073741824,{description:localize("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:register$1(new EditorStringEnumOption(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[localize("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),localize("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:localize("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:register$1(new EditorIntOption(31,"cursorWidth",0,0,1073741824,{markdownDescription:localize("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:register$1(new EditorBooleanOption(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:register$1(new EditorBooleanOption(33,"disableMonospaceOptimizations",!1)),domReadOnly:register$1(new EditorBooleanOption(34,"domReadOnly",!1)),dragAndDrop:register$1(new EditorBooleanOption(35,"dragAndDrop",!0,{description:localize("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:register$1(new EditorEmptySelectionClipboard),dropIntoEditor:register$1(new EditorDropIntoEditor),stickyScroll:register$1(new EditorStickyScroll),experimentalWhitespaceRendering:register$1(new EditorStringEnumOption(38,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[localize("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),localize("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),localize("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:localize("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:register$1(new EditorStringOption(39,"extraEditorClassName","")),fastScrollSensitivity:register$1(new EditorFloatOption(40,"fastScrollSensitivity",5,F=>F<=0?5:F,{markdownDescription:localize("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:register$1(new EditorFind),fixedOverflowWidgets:register$1(new EditorBooleanOption(42,"fixedOverflowWidgets",!1)),folding:register$1(new EditorBooleanOption(43,"folding",!0,{description:localize("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:register$1(new EditorStringEnumOption(44,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[localize("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),localize("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:localize("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:register$1(new EditorBooleanOption(45,"foldingHighlight",!0,{description:localize("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:register$1(new EditorBooleanOption(46,"foldingImportsByDefault",!1,{description:localize("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:register$1(new EditorIntOption(47,"foldingMaximumRegions",5e3,10,65e3,{description:localize("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:register$1(new EditorBooleanOption(48,"unfoldOnClickAfterEndOfLine",!1,{description:localize("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:register$1(new EditorStringOption(49,"fontFamily",EDITOR_FONT_DEFAULTS.fontFamily,{description:localize("fontFamily","Controls the font family.")})),fontInfo:register$1(new EditorFontInfo),fontLigatures2:register$1(new EditorFontLigatures),fontSize:register$1(new EditorFontSize),fontWeight:register$1(new EditorFontWeight),fontVariations:register$1(new EditorFontVariations),formatOnPaste:register$1(new EditorBooleanOption(55,"formatOnPaste",!1,{description:localize("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:register$1(new EditorBooleanOption(56,"formatOnType",!1,{description:localize("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:register$1(new EditorBooleanOption(57,"glyphMargin",!0,{description:localize("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:register$1(new EditorGoToLocation),hideCursorInOverviewRuler:register$1(new EditorBooleanOption(59,"hideCursorInOverviewRuler",!1,{description:localize("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:register$1(new EditorHover),inDiffEditor:register$1(new EditorBooleanOption(61,"inDiffEditor",!1)),letterSpacing:register$1(new EditorFloatOption(64,"letterSpacing",EDITOR_FONT_DEFAULTS.letterSpacing,F=>EditorFloatOption.clamp(F,-5,20),{description:localize("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:register$1(new EditorLightbulb),lineDecorationsWidth:register$1(new EditorLineDecorationsWidth),lineHeight:register$1(new EditorLineHeight),lineNumbers:register$1(new EditorRenderLineNumbersOption),lineNumbersMinChars:register$1(new EditorIntOption(69,"lineNumbersMinChars",5,1,300)),linkedEditing:register$1(new EditorBooleanOption(70,"linkedEditing",!1,{description:localize("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:register$1(new EditorBooleanOption(71,"links",!0,{description:localize("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:register$1(new EditorStringEnumOption(72,"matchBrackets","always",["always","near","never"],{description:localize("matchBrackets","Highlight matching brackets.")})),minimap:register$1(new EditorMinimap),mouseStyle:register$1(new EditorStringEnumOption(74,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:register$1(new EditorFloatOption(75,"mouseWheelScrollSensitivity",1,F=>F===0?1:F,{markdownDescription:localize("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:register$1(new EditorBooleanOption(76,"mouseWheelZoom",!1,{markdownDescription:isMacintosh?localize("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):localize("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:register$1(new EditorBooleanOption(77,"multiCursorMergeOverlapping",!0,{description:localize("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:register$1(new EditorEnumOption(78,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],_multiCursorModifierFromString,{markdownEnumDescriptions:[localize("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),localize("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:localize({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:register$1(new EditorStringEnumOption(79,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[localize("multiCursorPaste.spread","Each cursor pastes a single line of the text."),localize("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:localize("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:register$1(new EditorIntOption(80,"multiCursorLimit",1e4,1,1e5,{markdownDescription:localize("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:register$1(new EditorStringEnumOption(81,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[localize("occurrencesHighlight.off","Does not highlight occurrences."),localize("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),localize("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:localize("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:register$1(new EditorBooleanOption(82,"overviewRulerBorder",!0,{description:localize("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:register$1(new EditorIntOption(83,"overviewRulerLanes",3,0,3)),padding:register$1(new EditorPadding),pasteAs:register$1(new EditorPasteAs),parameterHints:register$1(new EditorParameterHints),peekWidgetDefaultFocus:register$1(new EditorStringEnumOption(87,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[localize("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),localize("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:localize("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:register$1(new PlaceholderOption),definitionLinkOpensInPeek:register$1(new EditorBooleanOption(89,"definitionLinkOpensInPeek",!1,{description:localize("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:register$1(new EditorQuickSuggestions),quickSuggestionsDelay:register$1(new EditorIntOption(91,"quickSuggestionsDelay",10,0,1073741824,{description:localize("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:register$1(new EditorBooleanOption(92,"readOnly",!1)),readOnlyMessage:register$1(new ReadonlyMessage),renameOnType:register$1(new EditorBooleanOption(94,"renameOnType",!1,{description:localize("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:localize("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:register$1(new EditorBooleanOption(95,"renderControlCharacters",!0,{description:localize("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:register$1(new EditorStringEnumOption(96,"renderFinalNewline",isLinux?"dimmed":"on",["off","on","dimmed"],{description:localize("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:register$1(new EditorStringEnumOption(97,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",localize("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:localize("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:register$1(new EditorBooleanOption(98,"renderLineHighlightOnlyWhenFocus",!1,{description:localize("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:register$1(new EditorStringEnumOption(99,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:register$1(new EditorStringEnumOption(100,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",localize("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),localize("renderWhitespace.selection","Render whitespace characters only on selected text."),localize("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:localize("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:register$1(new EditorIntOption(101,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:register$1(new EditorBooleanOption(102,"roundedSelection",!0,{description:localize("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:register$1(new EditorRulers),scrollbar:register$1(new EditorScrollbar$1),scrollBeyondLastColumn:register$1(new EditorIntOption(105,"scrollBeyondLastColumn",4,0,1073741824,{description:localize("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:register$1(new EditorBooleanOption(106,"scrollBeyondLastLine",!0,{description:localize("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:register$1(new EditorBooleanOption(107,"scrollPredominantAxis",!0,{description:localize("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:register$1(new EditorBooleanOption(108,"selectionClipboard",!0,{description:localize("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:isLinux})),selectionHighlight:register$1(new EditorBooleanOption(109,"selectionHighlight",!0,{description:localize("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:register$1(new EditorBooleanOption(110,"selectOnLineNumbers",!0)),showFoldingControls:register$1(new EditorStringEnumOption(111,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[localize("showFoldingControls.always","Always show the folding controls."),localize("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),localize("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:localize("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:register$1(new EditorBooleanOption(112,"showUnused",!0,{description:localize("showUnused","Controls fading out of unused code.")})),showDeprecated:register$1(new EditorBooleanOption(141,"showDeprecated",!0,{description:localize("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:register$1(new EditorInlayHints),snippetSuggestions:register$1(new EditorStringEnumOption(113,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[localize("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),localize("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),localize("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),localize("snippetSuggestions.none","Do not show snippet suggestions.")],description:localize("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:register$1(new SmartSelect),smoothScrolling:register$1(new EditorBooleanOption(115,"smoothScrolling",!1,{description:localize("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:register$1(new EditorIntOption(118,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:register$1(new EditorSuggest),inlineSuggest:register$1(new InlineEditorSuggest),inlineEdit:register$1(new InlineEditorEdit),inlineCompletionsAccessibilityVerbose:register$1(new EditorBooleanOption(150,"inlineCompletionsAccessibilityVerbose",!1,{description:localize("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:register$1(new EditorIntOption(120,"suggestFontSize",0,0,1e3,{markdownDescription:localize("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:register$1(new EditorIntOption(121,"suggestLineHeight",0,0,1e3,{markdownDescription:localize("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:register$1(new EditorBooleanOption(122,"suggestOnTriggerCharacters",!0,{description:localize("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:register$1(new EditorStringEnumOption(123,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[localize("suggestSelection.first","Always select the first suggestion."),localize("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),localize("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:localize("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:register$1(new EditorStringEnumOption(124,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[localize("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),localize("tabCompletion.off","Disable tab completions."),localize("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:localize("tabCompletion","Enables tab completions.")})),tabIndex:register$1(new EditorIntOption(125,"tabIndex",0,-1,1073741824)),unicodeHighlight:register$1(new UnicodeHighlight),unusualLineTerminators:register$1(new EditorStringEnumOption(127,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[localize("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),localize("unusualLineTerminators.off","Unusual line terminators are ignored."),localize("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:localize("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:register$1(new EditorBooleanOption(128,"useShadowDOM",!0)),useTabStops:register$1(new EditorBooleanOption(129,"useTabStops",!0,{description:localize("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:register$1(new EditorStringEnumOption(130,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[localize("wordBreak.normal","Use the default line break rule."),localize("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:localize("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:register$1(new WordSegmenterLocales),wordSeparators:register$1(new EditorStringOption(132,"wordSeparators",USUAL_WORD_SEPARATORS,{description:localize("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:register$1(new EditorStringEnumOption(133,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[localize("wordWrap.off","Lines will never wrap."),localize("wordWrap.on","Lines will wrap at the viewport width."),localize({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),localize({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:localize({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:register$1(new EditorStringOption(134,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣")),wordWrapBreakBeforeCharacters:register$1(new EditorStringOption(135,"wordWrapBreakBeforeCharacters","([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋")),wordWrapColumn:register$1(new EditorIntOption(136,"wordWrapColumn",80,1,1073741824,{markdownDescription:localize({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:register$1(new EditorStringEnumOption(137,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:register$1(new EditorStringEnumOption(138,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:register$1(new EditorClassName),defaultColorDecorators:register$1(new EditorBooleanOption(148,"defaultColorDecorators",!1,{markdownDescription:localize("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:register$1(new EditorPixelRatio),tabFocusMode:register$1(new EditorBooleanOption(145,"tabFocusMode",!1,{markdownDescription:localize("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:register$1(new EditorLayoutInfoComputer),wrappingInfo:register$1(new EditorWrappingInfoComputer),wrappingIndent:register$1(new WrappingIndentOption),wrappingStrategy:register$1(new WrappingStrategy)},EditorZoom=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new Emitter$1,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(F){F=Math.min(Math.max(-5,F),20),this._zoomLevel!==F&&(this._zoomLevel=F,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},GOLDEN_LINE_HEIGHT_RATIO=isMacintosh?1.5:1.35,MINIMUM_LINE_HEIGHT=8;class BareFontInfo{static createFromValidatedSettings(w,D,O){const W=w.get(49),U=w.get(53),K=w.get(52),q=w.get(51),G=w.get(54),Q=w.get(67),Y=w.get(64);return BareFontInfo._create(W,U,K,q,G,Q,Y,D,O)}static _create(w,D,O,W,U,K,q,G,Q){K===0?K=GOLDEN_LINE_HEIGHT_RATIO*O:K<MINIMUM_LINE_HEIGHT&&(K=K*O),K=Math.round(K),K<MINIMUM_LINE_HEIGHT&&(K=MINIMUM_LINE_HEIGHT);const Y=1+(Q?0:EditorZoom.getZoomLevel()*.1);return O*=Y,K*=Y,U===EditorFontVariations.TRANSLATE&&(D==="normal"||D==="bold"?U=EditorFontVariations.OFF:(U=`'wght' ${parseInt(D,10)}`,D="normal")),new BareFontInfo({pixelRatio:G,fontFamily:w,fontWeight:D,fontSize:O,fontFeatureSettings:W,fontVariationSettings:U,lineHeight:K,letterSpacing:q})}constructor(w){this._bareFontInfoBrand=void 0,this.pixelRatio=w.pixelRatio,this.fontFamily=String(w.fontFamily),this.fontWeight=String(w.fontWeight),this.fontSize=w.fontSize,this.fontFeatureSettings=w.fontFeatureSettings,this.fontVariationSettings=w.fontVariationSettings,this.lineHeight=w.lineHeight|0,this.letterSpacing=w.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const w=EDITOR_FONT_DEFAULTS.fontFamily,D=BareFontInfo._wrapInQuotes(this.fontFamily);return w&&this.fontFamily!==w?`${D}, ${w}`:D}static _wrapInQuotes(w){return/[,"']/.test(w)?w:/[+ ]/.test(w)?`"${w}"`:w}}const SERIALIZED_FONT_INFO_VERSION=2;class FontInfo extends BareFontInfo{constructor(w,D){super(w),this._editorStylingBrand=void 0,this.version=SERIALIZED_FONT_INFO_VERSION,this.isTrusted=D,this.isMonospace=w.isMonospace,this.typicalHalfwidthCharacterWidth=w.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=w.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=w.canUseHalfwidthRightwardsArrow,this.spaceWidth=w.spaceWidth,this.middotWidth=w.middotWidth,this.wsmiddotWidth=w.wsmiddotWidth,this.maxDigitWidth=w.maxDigitWidth}equals(w){return this.fontFamily===w.fontFamily&&this.fontWeight===w.fontWeight&&this.fontSize===w.fontSize&&this.fontFeatureSettings===w.fontFeatureSettings&&this.fontVariationSettings===w.fontVariationSettings&&this.lineHeight===w.lineHeight&&this.letterSpacing===w.letterSpacing&&this.typicalHalfwidthCharacterWidth===w.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===w.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===w.canUseHalfwidthRightwardsArrow&&this.spaceWidth===w.spaceWidth&&this.middotWidth===w.middotWidth&&this.wsmiddotWidth===w.wsmiddotWidth&&this.maxDigitWidth===w.maxDigitWidth}}class FontMeasurementsImpl extends Disposable{constructor(){super(...arguments),this._cache=new Map,this._evictUntrustedReadingsTimeout=-1,this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event}dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(w){const D=getWindowId(w);let O=this._cache.get(D);return O||(O=new FontMeasurementsCache,this._cache.set(D,O)),O}_writeToCache(w,D,O){this._ensureCache(w).put(D,O),!O.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=w.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(w)},5e3))}_evictUntrustedReadings(w){const D=this._ensureCache(w),O=D.getValues();let W=!1;for(const U of O)U.isTrusted||(W=!0,D.remove(U));W&&this._onDidChange.fire()}readFontInfo(w,D){const O=this._ensureCache(w);if(!O.has(D)){let W=this._actualReadFontInfo(w,D);(W.typicalHalfwidthCharacterWidth<=2||W.typicalFullwidthCharacterWidth<=2||W.spaceWidth<=2||W.maxDigitWidth<=2)&&(W=new FontInfo({pixelRatio:PixelRatio.getInstance(w).value,fontFamily:W.fontFamily,fontWeight:W.fontWeight,fontSize:W.fontSize,fontFeatureSettings:W.fontFeatureSettings,fontVariationSettings:W.fontVariationSettings,lineHeight:W.lineHeight,letterSpacing:W.letterSpacing,isMonospace:W.isMonospace,typicalHalfwidthCharacterWidth:Math.max(W.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(W.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:W.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(W.spaceWidth,5),middotWidth:Math.max(W.middotWidth,5),wsmiddotWidth:Math.max(W.wsmiddotWidth,5),maxDigitWidth:Math.max(W.maxDigitWidth,5)},!1)),this._writeToCache(w,D,W)}return O.get(D)}_createRequest(w,D,O,W){const U=new CharWidthRequest(w,D);return O.push(U),W?.push(U),U}_actualReadFontInfo(w,D){const O=[],W=[],U=this._createRequest("n",0,O,W),K=this._createRequest("ｍ",0,O,null),q=this._createRequest(" ",0,O,W),G=this._createRequest("0",0,O,W),Q=this._createRequest("1",0,O,W),Y=this._createRequest("2",0,O,W),X=this._createRequest("3",0,O,W),J=this._createRequest("4",0,O,W),te=this._createRequest("5",0,O,W),ie=this._createRequest("6",0,O,W),se=this._createRequest("7",0,O,W),re=this._createRequest("8",0,O,W),ae=this._createRequest("9",0,O,W),le=this._createRequest("→",0,O,W),de=this._createRequest("￫",0,O,null),oe=this._createRequest("·",0,O,W),ue=this._createRequest("⸱",0,O,null),pe="|/-_ilm%";for(let Te=0,Re=pe.length;Te<Re;Te++)this._createRequest(pe.charAt(Te),0,O,W),this._createRequest(pe.charAt(Te),1,O,W),this._createRequest(pe.charAt(Te),2,O,W);readCharWidths(w,D,O);const fe=Math.max(G.width,Q.width,Y.width,X.width,J.width,te.width,ie.width,se.width,re.width,ae.width);let Ce=D.fontFeatureSettings===EditorFontLigatures.OFF;const we=W[0].width;for(let Te=1,Re=W.length;Ce&&Te<Re;Te++){const Me=we-W[Te].width;if(Me<-.001||Me>.001){Ce=!1;break}}let Oe=!0;return Ce&&de.width!==we&&(Oe=!1),de.width>le.width&&(Oe=!1),new FontInfo({pixelRatio:PixelRatio.getInstance(w).value,fontFamily:D.fontFamily,fontWeight:D.fontWeight,fontSize:D.fontSize,fontFeatureSettings:D.fontFeatureSettings,fontVariationSettings:D.fontVariationSettings,lineHeight:D.lineHeight,letterSpacing:D.letterSpacing,isMonospace:Ce,typicalHalfwidthCharacterWidth:U.width,typicalFullwidthCharacterWidth:K.width,canUseHalfwidthRightwardsArrow:Oe,spaceWidth:q.width,middotWidth:oe.width,wsmiddotWidth:ue.width,maxDigitWidth:fe},!0)}}class FontMeasurementsCache{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(w){const D=w.getId();return!!this._values[D]}get(w){const D=w.getId();return this._values[D]}put(w,D){const O=w.getId();this._keys[O]=w,this._values[O]=D}remove(w){const D=w.getId();delete this._keys[D],delete this._values[D]}getValues(){return Object.keys(this._keys).map(w=>this._values[w])}}const FontMeasurements=new FontMeasurementsImpl;class EditorSettingMigration{static{this.items=[]}constructor(w,D){this.key=w,this.migrate=D}apply(w){const D=EditorSettingMigration._read(w,this.key),O=U=>EditorSettingMigration._read(w,U),W=(U,K)=>EditorSettingMigration._write(w,U,K);this.migrate(D,O,W)}static _read(w,D){if(typeof w>"u")return;const O=D.indexOf(".");if(O>=0){const W=D.substring(0,O);return this._read(w[W],D.substring(O+1))}return w[D]}static _write(w,D,O){const W=D.indexOf(".");if(W>=0){const U=D.substring(0,W);w[U]=w[U]||{},this._write(w[U],D.substring(W+1),O);return}w[D]=O}}function registerEditorSettingMigration(F,w){EditorSettingMigration.items.push(new EditorSettingMigration(F,w))}function registerSimpleEditorSettingMigration(F,w){registerEditorSettingMigration(F,(D,O,W)=>{if(typeof D<"u"){for(const[U,K]of w)if(D===U){W(F,K);return}}})}function migrateOptions(F){EditorSettingMigration.items.forEach(w=>w.apply(F))}registerSimpleEditorSettingMigration("wordWrap",[[!0,"on"],[!1,"off"]]);registerSimpleEditorSettingMigration("lineNumbers",[[!0,"on"],[!1,"off"]]);registerSimpleEditorSettingMigration("cursorBlinking",[["visible","solid"]]);registerSimpleEditorSettingMigration("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);registerSimpleEditorSettingMigration("renderLineHighlight",[[!0,"line"],[!1,"none"]]);registerSimpleEditorSettingMigration("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);registerSimpleEditorSettingMigration("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);registerSimpleEditorSettingMigration("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);registerSimpleEditorSettingMigration("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);registerSimpleEditorSettingMigration("autoIndent",[[!1,"advanced"],[!0,"full"]]);registerSimpleEditorSettingMigration("matchBrackets",[[!0,"always"],[!1,"never"]]);registerSimpleEditorSettingMigration("renderFinalNewline",[[!0,"on"],[!1,"off"]]);registerSimpleEditorSettingMigration("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);registerSimpleEditorSettingMigration("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);registerSimpleEditorSettingMigration("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);registerEditorSettingMigration("autoClosingBrackets",(F,w,D)=>{F===!1&&(D("autoClosingBrackets","never"),typeof w("autoClosingQuotes")>"u"&&D("autoClosingQuotes","never"),typeof w("autoSurround")>"u"&&D("autoSurround","never"))});registerEditorSettingMigration("renderIndentGuides",(F,w,D)=>{typeof F<"u"&&(D("renderIndentGuides",void 0),typeof w("guides.indentation")>"u"&&D("guides.indentation",!!F))});registerEditorSettingMigration("highlightActiveIndentGuide",(F,w,D)=>{typeof F<"u"&&(D("highlightActiveIndentGuide",void 0),typeof w("guides.highlightActiveIndentation")>"u"&&D("guides.highlightActiveIndentation",!!F))});const suggestFilteredTypesMapping={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};registerEditorSettingMigration("suggest.filteredTypes",(F,w,D)=>{if(F&&typeof F=="object"){for(const O of Object.entries(suggestFilteredTypesMapping))F[O[0]]===!1&&typeof w(`suggest.${O[1]}`)>"u"&&D(`suggest.${O[1]}`,!1);D("suggest.filteredTypes",void 0)}});registerEditorSettingMigration("quickSuggestions",(F,w,D)=>{if(typeof F=="boolean"){const O=F?"on":"off";D("quickSuggestions",{comments:O,strings:O,other:O})}});registerEditorSettingMigration("experimental.stickyScroll.enabled",(F,w,D)=>{typeof F=="boolean"&&(D("experimental.stickyScroll.enabled",void 0),typeof w("stickyScroll.enabled")>"u"&&D("stickyScroll.enabled",F))});registerEditorSettingMigration("experimental.stickyScroll.maxLineCount",(F,w,D)=>{typeof F=="number"&&(D("experimental.stickyScroll.maxLineCount",void 0),typeof w("stickyScroll.maxLineCount")>"u"&&D("stickyScroll.maxLineCount",F))});registerEditorSettingMigration("codeActionsOnSave",(F,w,D)=>{if(F&&typeof F=="object"){let O=!1;const W={};for(const U of Object.entries(F))typeof U[1]=="boolean"?(O=!0,W[U[0]]=U[1]?"explicit":"never"):W[U[0]]=U[1];O&&D("codeActionsOnSave",W)}});registerEditorSettingMigration("codeActionWidget.includeNearbyQuickfixes",(F,w,D)=>{typeof F=="boolean"&&(D("codeActionWidget.includeNearbyQuickfixes",void 0),typeof w("codeActionWidget.includeNearbyQuickFixes")>"u"&&D("codeActionWidget.includeNearbyQuickFixes",F))});registerEditorSettingMigration("lightbulb.enabled",(F,w,D)=>{typeof F=="boolean"&&D("lightbulb.enabled",F?void 0:"off")});class TabFocusImpl{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new Emitter$1,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(w){this._tabFocus=w,this._onDidChangeTabFocus.fire(this._tabFocus)}}const TabFocus=new TabFocusImpl,IAccessibilityService=createDecorator("accessibilityService"),CONTEXT_ACCESSIBILITY_MODE_ENABLED=new RawContextKey("accessibilityModeEnabled",!1);var __decorate$Y=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$V=function(F,w){return function(D,O){w(D,O,F)}};let EditorConfiguration=class extends Disposable{constructor(w,D,O,W,U){super(),this._accessibilityService=U,this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new Emitter$1),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._glyphMarginDecorationLaneCount=1,this._computeOptionsMemory=new ComputeOptionsMemory,this.isSimpleWidget=w,this.contextMenuId=D,this._containerObserver=this._register(new ElementSizeObserver(W,O.dimension)),this._targetWindowId=getWindow(W).vscodeWindowId,this._rawOptions=deepCloneAndMigrateOptions(O),this._validatedOptions=EditorOptionsUtil.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(EditorZoom.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(TabFocus.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(FontMeasurements.onDidChange(()=>this._recomputeOptions())),this._register(PixelRatio.getInstance(getWindow(W)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_recomputeOptions(){const w=this._computeOptions(),D=EditorOptionsUtil.checkEquals(this.options,w);D!==null&&(this.options=w,this._onDidChangeFast.fire(D),this._onDidChange.fire(D))}_computeOptions(){const w=this._readEnvConfiguration(),D=BareFontInfo.createFromValidatedSettings(this._validatedOptions,w.pixelRatio,this.isSimpleWidget),O=this._readFontInfo(D),W={memory:this._computeOptionsMemory,outerWidth:w.outerWidth,outerHeight:w.outerHeight-this._reservedHeight,fontInfo:O,extraEditorClassName:w.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:w.emptySelectionClipboard,pixelRatio:w.pixelRatio,tabFocusMode:TabFocus.getTabFocusMode(),accessibilitySupport:w.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return EditorOptionsUtil.computeOptions(this._validatedOptions,W)}_readEnvConfiguration(){return{extraEditorClassName:getExtraEditorClassName(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:isWebKit||isFirefox$1,pixelRatio:PixelRatio.getInstance(getWindowById(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(w){return FontMeasurements.readFontInfo(getWindowById(this._targetWindowId,!0).window,w)}getRawOptions(){return this._rawOptions}updateOptions(w){const D=deepCloneAndMigrateOptions(w);EditorOptionsUtil.applyUpdate(this._rawOptions,D)&&(this._validatedOptions=EditorOptionsUtil.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(w){this._containerObserver.observe(w)}setIsDominatedByLongLines(w){this._isDominatedByLongLines!==w&&(this._isDominatedByLongLines=w,this._recomputeOptions())}setModelLineCount(w){const D=digitCount(w);this._lineNumbersDigitCount!==D&&(this._lineNumbersDigitCount=D,this._recomputeOptions())}setViewLineCount(w){this._viewLineCount!==w&&(this._viewLineCount=w,this._recomputeOptions())}setReservedHeight(w){this._reservedHeight!==w&&(this._reservedHeight=w,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(w){this._glyphMarginDecorationLaneCount!==w&&(this._glyphMarginDecorationLaneCount=w,this._recomputeOptions())}};EditorConfiguration=__decorate$Y([__param$V(4,IAccessibilityService)],EditorConfiguration);function digitCount(F){let w=0;for(;F;)F=Math.floor(F/10),w++;return w||1}function getExtraEditorClassName(){let F="";return!isSafari$1&&!isWebkitWebView&&(F+="no-user-select "),isSafari$1&&(F+="no-minimap-shadow ",F+="enable-user-select "),isMacintosh&&(F+="mac "),F}class ValidatedEditorOptions{constructor(){this._values=[]}_read(w){return this._values[w]}get(w){return this._values[w]}_write(w,D){this._values[w]=D}}class ComputedEditorOptions{constructor(){this._values=[]}_read(w){if(w>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[w]}get(w){return this._read(w)}_write(w,D){this._values[w]=D}}class EditorOptionsUtil{static validateOptions(w){const D=new ValidatedEditorOptions;for(const O of editorOptionsRegistry){const W=O.name==="_never_"?void 0:w[O.name];D._write(O.id,O.validate(W))}return D}static computeOptions(w,D){const O=new ComputedEditorOptions;for(const W of editorOptionsRegistry)O._write(W.id,W.compute(D,O,w._read(W.id)));return O}static _deepEquals(w,D){if(typeof w!="object"||typeof D!="object"||!w||!D)return w===D;if(Array.isArray(w)||Array.isArray(D))return Array.isArray(w)&&Array.isArray(D)?equals$1(w,D):!1;if(Object.keys(w).length!==Object.keys(D).length)return!1;for(const O in w)if(!EditorOptionsUtil._deepEquals(w[O],D[O]))return!1;return!0}static checkEquals(w,D){const O=[];let W=!1;for(const U of editorOptionsRegistry){const K=!EditorOptionsUtil._deepEquals(w._read(U.id),D._read(U.id));O[U.id]=K,K&&(W=!0)}return W?new ConfigurationChangedEvent(O):null}static applyUpdate(w,D){let O=!1;for(const W of editorOptionsRegistry)if(D.hasOwnProperty(W.name)){const U=W.applyUpdate(w[W.name],D[W.name]);w[W.name]=U.newValue,O=O||U.didChange}return O}}function deepCloneAndMigrateOptions(F){const w=deepClone(F);return migrateOptions(w),w}var inputLatency;(function(F){const w={total:0,min:Number.MAX_VALUE,max:0},D={...w},O={...w},W={...w};let U=0;const K={keydown:0,input:0,render:0};function q(){ae(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),K.keydown=1,queueMicrotask(G)}F.onKeyDown=q;function G(){K.keydown===1&&(performance.mark("keydown/end"),K.keydown=2)}function Q(){performance.mark("input/start"),K.input=1,re()}F.onBeforeInput=Q;function Y(){K.input===0&&Q(),queueMicrotask(X)}F.onInput=Y;function X(){K.input===1&&(performance.mark("input/end"),K.input=2)}function J(){ae()}F.onKeyUp=J;function te(){ae()}F.onSelectionChange=te;function ie(){K.keydown===2&&K.input===2&&K.render===0&&(performance.mark("render/start"),K.render=1,queueMicrotask(se),re())}F.onRenderStart=ie;function se(){K.render===1&&(performance.mark("render/end"),K.render=2)}function re(){setTimeout(ae)}function ae(){K.keydown===2&&K.input===2&&K.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),le("keydown",w),le("input",D),le("render",O),le("inputlatency",W),U++,de())}function le(fe,Ce){const we=performance.getEntriesByName(fe)[0].duration;Ce.total+=we,Ce.min=Math.min(Ce.min,we),Ce.max=Math.max(Ce.max,we)}function de(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),K.keydown=0,K.input=0,K.render=0}function oe(){if(U===0)return;const fe={keydown:ue(w),input:ue(D),render:ue(O),total:ue(W),sampleCount:U};return pe(w),pe(D),pe(O),pe(W),U=0,fe}F.getAndClearMeasurements=oe;function ue(fe){return{average:fe.total/U,max:fe.max,min:fe.min}}function pe(fe){fe.total=0,fe.min=Number.MAX_VALUE,fe.max=0}})(inputLatency||(inputLatency={}));class PageCoordinates{constructor(w,D){this.x=w,this.y=D,this._pageCoordinatesBrand=void 0}toClientCoordinates(w){return new ClientCoordinates(this.x-w.scrollX,this.y-w.scrollY)}}class ClientCoordinates{constructor(w,D){this.clientX=w,this.clientY=D,this._clientCoordinatesBrand=void 0}toPageCoordinates(w){return new PageCoordinates(this.clientX+w.scrollX,this.clientY+w.scrollY)}}class EditorPagePosition{constructor(w,D,O,W){this.x=w,this.y=D,this.width=O,this.height=W,this._editorPagePositionBrand=void 0}}class CoordinatesRelativeToEditor{constructor(w,D){this.x=w,this.y=D,this._positionRelativeToEditorBrand=void 0}}function createEditorPagePosition(F){const w=getDomNodePagePosition(F);return new EditorPagePosition(w.left,w.top,w.width,w.height)}function createCoordinatesRelativeToEditor(F,w,D){const O=w.width/F.offsetWidth,W=w.height/F.offsetHeight,U=(D.x-w.x)/O,K=(D.y-w.y)/W;return new CoordinatesRelativeToEditor(U,K)}class EditorMouseEvent extends StandardMouseEvent{constructor(w,D,O){super(getWindow(O),w),this._editorMouseEventBrand=void 0,this.isFromPointerCapture=D,this.pos=new PageCoordinates(this.posx,this.posy),this.editorPos=createEditorPagePosition(O),this.relativePos=createCoordinatesRelativeToEditor(O,this.editorPos,this.pos)}}class EditorMouseEventFactory{constructor(w){this._editorViewDomNode=w}_create(w){return new EditorMouseEvent(w,!1,this._editorViewDomNode)}onContextMenu(w,D){return addDisposableListener(w,"contextmenu",O=>{D(this._create(O))})}onMouseUp(w,D){return addDisposableListener(w,"mouseup",O=>{D(this._create(O))})}onMouseDown(w,D){return addDisposableListener(w,EventType$1.MOUSE_DOWN,O=>{D(this._create(O))})}onPointerDown(w,D){return addDisposableListener(w,EventType$1.POINTER_DOWN,O=>{D(this._create(O),O.pointerId)})}onMouseLeave(w,D){return addDisposableListener(w,EventType$1.MOUSE_LEAVE,O=>{D(this._create(O))})}onMouseMove(w,D){return addDisposableListener(w,"mousemove",O=>D(this._create(O)))}}class EditorPointerEventFactory{constructor(w){this._editorViewDomNode=w}_create(w){return new EditorMouseEvent(w,!1,this._editorViewDomNode)}onPointerUp(w,D){return addDisposableListener(w,"pointerup",O=>{D(this._create(O))})}onPointerDown(w,D){return addDisposableListener(w,EventType$1.POINTER_DOWN,O=>{D(this._create(O),O.pointerId)})}onPointerLeave(w,D){return addDisposableListener(w,EventType$1.POINTER_LEAVE,O=>{D(this._create(O))})}onPointerMove(w,D){return addDisposableListener(w,"pointermove",O=>D(this._create(O)))}}class GlobalEditorPointerMoveMonitor extends Disposable{constructor(w){super(),this._editorViewDomNode=w,this._globalPointerMoveMonitor=this._register(new GlobalPointerMoveMonitor),this._keydownListener=null}startMonitoring(w,D,O,W,U){this._keydownListener=addStandardDisposableListener(w.ownerDocument,"keydown",K=>{K.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,K.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(w,D,O,K=>{W(new EditorMouseEvent(K,!0,this._editorViewDomNode))},K=>{this._keydownListener.dispose(),U(K)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}}class DynamicCssRules{static{this._idPool=0}constructor(w){this._editor=w,this._instanceId=++DynamicCssRules._idPool,this._counter=0,this._rules=new Map,this._garbageCollectionScheduler=new RunOnceScheduler(()=>this.garbageCollect(),1e3)}createClassNameRef(w){const D=this.getOrCreateRule(w);return D.increaseRefCount(),{className:D.className,dispose:()=>{D.decreaseRefCount(),this._garbageCollectionScheduler.schedule()}}}getOrCreateRule(w){const D=this.computeUniqueKey(w);let O=this._rules.get(D);if(!O){const W=this._counter++;O=new RefCountedCssRule(D,`dyn-rule-${this._instanceId}-${W}`,isInShadowDOM(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,w),this._rules.set(D,O)}return O}computeUniqueKey(w){return JSON.stringify(w)}garbageCollect(){for(const w of this._rules.values())w.hasReferences()||(this._rules.delete(w.key),w.dispose())}}class RefCountedCssRule{constructor(w,D,O,W){this.key=w,this.className=D,this.properties=W,this._referenceCount=0,this._styleElementDisposables=new DisposableStore,this._styleElement=createStyleSheet(O,void 0,this._styleElementDisposables),this._styleElement.textContent=this.getCssText(this.className,this.properties)}getCssText(w,D){let O=`.${w} {`;for(const W in D){const U=D[W];let K;typeof U=="object"?K=asCssVariable(U.id):K=U;const q=camelToDashes(W);O+=`
	${q}: ${K};`}return O+=`
}`,O}dispose(){this._styleElementDisposables.dispose(),this._styleElement=void 0}increaseRefCount(){this._referenceCount++}decreaseRefCount(){this._referenceCount--}hasReferences(){return this._referenceCount>0}}function camelToDashes(F){return F.replace(/(^[A-Z])/,([w])=>w.toLowerCase()).replace(/([A-Z])/g,([w])=>`-${w.toLowerCase()}`)}class ViewEventHandler extends Disposable{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(w){return!1}onCompositionEnd(w){return!1}onConfigurationChanged(w){return!1}onCursorStateChanged(w){return!1}onDecorationsChanged(w){return!1}onFlushed(w){return!1}onFocusChanged(w){return!1}onLanguageConfigurationChanged(w){return!1}onLineMappingChanged(w){return!1}onLinesChanged(w){return!1}onLinesDeleted(w){return!1}onLinesInserted(w){return!1}onRevealRangeRequest(w){return!1}onScrollChanged(w){return!1}onThemeChanged(w){return!1}onTokensChanged(w){return!1}onTokensColorsChanged(w){return!1}onZonesChanged(w){return!1}handleEvents(w){let D=!1;for(let O=0,W=w.length;O<W;O++){const U=w[O];switch(U.type){case 0:this.onCompositionStart(U)&&(D=!0);break;case 1:this.onCompositionEnd(U)&&(D=!0);break;case 2:this.onConfigurationChanged(U)&&(D=!0);break;case 3:this.onCursorStateChanged(U)&&(D=!0);break;case 4:this.onDecorationsChanged(U)&&(D=!0);break;case 5:this.onFlushed(U)&&(D=!0);break;case 6:this.onFocusChanged(U)&&(D=!0);break;case 7:this.onLanguageConfigurationChanged(U)&&(D=!0);break;case 8:this.onLineMappingChanged(U)&&(D=!0);break;case 9:this.onLinesChanged(U)&&(D=!0);break;case 10:this.onLinesDeleted(U)&&(D=!0);break;case 11:this.onLinesInserted(U)&&(D=!0);break;case 12:this.onRevealRangeRequest(U)&&(D=!0);break;case 13:this.onScrollChanged(U)&&(D=!0);break;case 15:this.onTokensChanged(U)&&(D=!0);break;case 14:this.onThemeChanged(U)&&(D=!0);break;case 16:this.onTokensColorsChanged(U)&&(D=!0);break;case 17:this.onZonesChanged(U)&&(D=!0);break;default:console.info("View received unknown event: "),console.info(U)}}D&&(this._shouldRender=!0)}}class ViewPart extends ViewEventHandler{constructor(w){super(),this._context=w,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class PartFingerprints{static write(w,D){w.setAttribute("data-mprt",String(D))}static read(w){const D=w.getAttribute("data-mprt");return D===null?0:parseInt(D,10)}static collect(w,D){const O=[];let W=0;for(;w&&w!==w.ownerDocument.body&&w!==D;)w.nodeType===w.ELEMENT_NODE&&(O[W++]=this.read(w)),w=w.parentElement;const U=new Uint8Array(W);for(let K=0;K<W;K++)U[K]=O[W-K-1];return U}}class RestrictedRenderingContext{constructor(w,D){this._restrictedRenderingContextBrand=void 0,this._viewLayout=w,this.viewportData=D,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const O=this._viewLayout.getCurrentViewport();this.scrollTop=O.top,this.scrollLeft=O.left,this.viewportWidth=O.width,this.viewportHeight=O.height}getScrolledTopFromAbsoluteTop(w){return w-this.scrollTop}getVerticalOffsetForLineNumber(w,D){return this._viewLayout.getVerticalOffsetForLineNumber(w,D)}getVerticalOffsetAfterLineNumber(w,D){return this._viewLayout.getVerticalOffsetAfterLineNumber(w,D)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class RenderingContext extends RestrictedRenderingContext{constructor(w,D,O){super(w,D),this._renderingContextBrand=void 0,this._viewLines=O}linesVisibleRangesForRange(w,D){return this._viewLines.linesVisibleRangesForRange(w,D)}visibleRangeForPosition(w){return this._viewLines.visibleRangeForPosition(w)}}class LineVisibleRanges{constructor(w,D,O,W){this.outsideRenderedLine=w,this.lineNumber=D,this.ranges=O,this.continuesOnNextLine=W}}class HorizontalRange{static from(w){const D=new Array(w.length);for(let O=0,W=w.length;O<W;O++){const U=w[O];D[O]=new HorizontalRange(U.left,U.width)}return D}constructor(w,D){this._horizontalRangeBrand=void 0,this.left=Math.round(w),this.width=Math.round(D)}toString(){return`[${this.left},${this.width}]`}}class FloatHorizontalRange{constructor(w,D){this._floatHorizontalRangeBrand=void 0,this.left=w,this.width=D}toString(){return`[${this.left},${this.width}]`}static compare(w,D){return w.left-D.left}}class HorizontalPosition{constructor(w,D){this.outsideRenderedLine=w,this.originalLeft=D,this.left=Math.round(this.originalLeft)}}class VisibleRanges{constructor(w,D){this.outsideRenderedLine=w,this.ranges=D}}class RangeUtil{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(w,D){w.selectNodeContents(D)}static _readClientRects(w,D,O,W,U){const K=this._createRange();try{return K.setStart(w,D),K.setEnd(O,W),K.getClientRects()}catch{return null}finally{this._detachRange(K,U)}}static _mergeAdjacentRanges(w){if(w.length===1)return w;w.sort(FloatHorizontalRange.compare);const D=[];let O=0,W=w[0];for(let U=1,K=w.length;U<K;U++){const q=w[U];W.left+W.width+.9>=q.left?W.width=Math.max(W.width,q.left+q.width-W.left):(D[O++]=W,W=q)}return D[O++]=W,D}static _createHorizontalRangesFromClientRects(w,D,O){if(!w||w.length===0)return null;const W=[];for(let U=0,K=w.length;U<K;U++){const q=w[U];W[U]=new FloatHorizontalRange(Math.max(0,(q.left-D)/O),q.width/O)}return this._mergeAdjacentRanges(W)}static readHorizontalRanges(w,D,O,W,U,K){const G=w.children.length-1;if(0>G)return null;if(D=Math.min(G,Math.max(0,D)),W=Math.min(G,Math.max(0,W)),D===W&&O===U&&O===0&&!w.children[D].firstChild){const J=w.children[D].getClientRects();return K.markDidDomLayout(),this._createHorizontalRangesFromClientRects(J,K.clientRectDeltaLeft,K.clientRectScale)}D!==W&&W>0&&U===0&&(W--,U=1073741824);let Q=w.children[D].firstChild,Y=w.children[W].firstChild;if((!Q||!Y)&&(!Q&&O===0&&D>0&&(Q=w.children[D-1].firstChild,O=1073741824),!Y&&U===0&&W>0&&(Y=w.children[W-1].firstChild,U=1073741824)),!Q||!Y)return null;O=Math.min(Q.textContent.length,Math.max(0,O)),U=Math.min(Y.textContent.length,Math.max(0,U));const X=this._readClientRects(Q,O,Y,U,K.endNode);return K.markDidDomLayout(),this._createHorizontalRangesFromClientRects(X,K.clientRectDeltaLeft,K.clientRectScale)}}class LineDecoration{constructor(w,D,O,W){this.startColumn=w,this.endColumn=D,this.className=O,this.type=W,this._lineDecorationBrand=void 0}static _equals(w,D){return w.startColumn===D.startColumn&&w.endColumn===D.endColumn&&w.className===D.className&&w.type===D.type}static equalsArr(w,D){const O=w.length,W=D.length;if(O!==W)return!1;for(let U=0;U<O;U++)if(!LineDecoration._equals(w[U],D[U]))return!1;return!0}static extractWrapped(w,D,O){if(w.length===0)return w;const W=D+1,U=O+1,K=O-D,q=[];let G=0;for(const Q of w)Q.endColumn<=W||Q.startColumn>=U||(q[G++]=new LineDecoration(Math.max(1,Q.startColumn-W+1),Math.min(K+1,Q.endColumn-W+1),Q.className,Q.type));return q}static filter(w,D,O,W){if(w.length===0)return[];const U=[];let K=0;for(let q=0,G=w.length;q<G;q++){const Q=w[q],Y=Q.range;if(Y.endLineNumber<D||Y.startLineNumber>D||Y.isEmpty()&&(Q.type===0||Q.type===3))continue;const X=Y.startLineNumber===D?Y.startColumn:O,J=Y.endLineNumber===D?Y.endColumn:W;U[K++]=new LineDecoration(X,J,Q.inlineClassName,Q.type)}return U}static _typeCompare(w,D){const O=[2,0,1,3];return O[w]-O[D]}static compare(w,D){if(w.startColumn!==D.startColumn)return w.startColumn-D.startColumn;if(w.endColumn!==D.endColumn)return w.endColumn-D.endColumn;const O=LineDecoration._typeCompare(w.type,D.type);return O!==0?O:w.className!==D.className?w.className<D.className?-1:1:0}}class DecorationSegment{constructor(w,D,O,W){this.startOffset=w,this.endOffset=D,this.className=O,this.metadata=W}}class Stack{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(w){let D=0;for(let O=0,W=w.length;O<W;O++)D|=w[O];return D}consumeLowerThan(w,D,O){for(;this.count>0&&this.stopOffsets[0]<w;){let W=0;for(;W+1<this.count&&this.stopOffsets[W]===this.stopOffsets[W+1];)W++;O.push(new DecorationSegment(D,this.stopOffsets[W],this.classNames.join(" "),Stack._metadata(this.metadata))),D=this.stopOffsets[W]+1,this.stopOffsets.splice(0,W+1),this.classNames.splice(0,W+1),this.metadata.splice(0,W+1),this.count-=W+1}return this.count>0&&D<w&&(O.push(new DecorationSegment(D,w-1,this.classNames.join(" "),Stack._metadata(this.metadata))),D=w),D}insert(w,D,O){if(this.count===0||this.stopOffsets[this.count-1]<=w)this.stopOffsets.push(w),this.classNames.push(D),this.metadata.push(O);else for(let W=0;W<this.count;W++)if(this.stopOffsets[W]>=w){this.stopOffsets.splice(W,0,w),this.classNames.splice(W,0,D),this.metadata.splice(W,0,O);break}this.count++}}class LineDecorationsNormalizer{static normalize(w,D){if(D.length===0)return[];const O=[],W=new Stack;let U=0;for(let K=0,q=D.length;K<q;K++){const G=D[K];let Q=G.startColumn,Y=G.endColumn;const X=G.className,J=G.type===1?2:G.type===2?4:0;if(Q>1){const se=w.charCodeAt(Q-2);isHighSurrogate(se)&&Q--}if(Y>1){const se=w.charCodeAt(Y-2);isHighSurrogate(se)&&Y--}const te=Q-1,ie=Y-2;U=W.consumeLowerThan(te,U,O),W.count===0&&(U=te),W.insert(ie,X,J)}return W.consumeLowerThan(1073741824,U,O),O}}class LinePart{constructor(w,D,O,W){this.endIndex=w,this.type=D,this.metadata=O,this.containsRTL=W,this._linePartBrand=void 0}isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}}class LineRange{constructor(w,D){this.startOffset=w,this.endOffset=D}equals(w){return this.startOffset===w.startOffset&&this.endOffset===w.endOffset}}class RenderLineInput{constructor(w,D,O,W,U,K,q,G,Q,Y,X,J,te,ie,se,re,ae,le,de){this.useMonospaceOptimizations=w,this.canUseHalfwidthRightwardsArrow=D,this.lineContent=O,this.continuesWithWrappedLine=W,this.isBasicASCII=U,this.containsRTL=K,this.fauxIndentLength=q,this.lineTokens=G,this.lineDecorations=Q.sort(LineDecoration.compare),this.tabSize=Y,this.startVisibleColumn=X,this.spaceWidth=J,this.stopRenderingLineAfter=se,this.renderWhitespace=re==="all"?4:re==="boundary"?1:re==="selection"?2:re==="trailing"?3:0,this.renderControlCharacters=ae,this.fontLigatures=le,this.selectionsOnLine=de&&de.sort((pe,fe)=>pe.startOffset<fe.startOffset?-1:1);const oe=Math.abs(ie-J),ue=Math.abs(te-J);oe<ue?(this.renderSpaceWidth=ie,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=te,this.renderSpaceCharCode=183)}sameSelection(w){if(this.selectionsOnLine===null)return w===null;if(w===null||w.length!==this.selectionsOnLine.length)return!1;for(let D=0;D<this.selectionsOnLine.length;D++)if(!this.selectionsOnLine[D].equals(w[D]))return!1;return!0}equals(w){return this.useMonospaceOptimizations===w.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===w.canUseHalfwidthRightwardsArrow&&this.lineContent===w.lineContent&&this.continuesWithWrappedLine===w.continuesWithWrappedLine&&this.isBasicASCII===w.isBasicASCII&&this.containsRTL===w.containsRTL&&this.fauxIndentLength===w.fauxIndentLength&&this.tabSize===w.tabSize&&this.startVisibleColumn===w.startVisibleColumn&&this.spaceWidth===w.spaceWidth&&this.renderSpaceWidth===w.renderSpaceWidth&&this.renderSpaceCharCode===w.renderSpaceCharCode&&this.stopRenderingLineAfter===w.stopRenderingLineAfter&&this.renderWhitespace===w.renderWhitespace&&this.renderControlCharacters===w.renderControlCharacters&&this.fontLigatures===w.fontLigatures&&LineDecoration.equalsArr(this.lineDecorations,w.lineDecorations)&&this.lineTokens.equals(w.lineTokens)&&this.sameSelection(w.selectionsOnLine)}}class DomPosition{constructor(w,D){this.partIndex=w,this.charIndex=D}}class CharacterMapping{static getPartIndex(w){return(w&4294901760)>>>16}static getCharIndex(w){return(w&65535)>>>0}constructor(w,D){this.length=w,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(w,D,O,W){const U=(D<<16|O<<0)>>>0;this._data[w-1]=U,this._horizontalOffset[w-1]=W}getHorizontalOffset(w){return this._horizontalOffset.length===0?0:this._horizontalOffset[w-1]}charOffsetToPartData(w){return this.length===0?0:w<0?this._data[0]:w>=this.length?this._data[this.length-1]:this._data[w]}getDomPosition(w){const D=this.charOffsetToPartData(w-1),O=CharacterMapping.getPartIndex(D),W=CharacterMapping.getCharIndex(D);return new DomPosition(O,W)}getColumn(w,D){return this.partDataToCharOffset(w.partIndex,D,w.charIndex)+1}partDataToCharOffset(w,D,O){if(this.length===0)return 0;const W=(w<<16|O<<0)>>>0;let U=0,K=this.length-1;for(;U+1<K;){const se=U+K>>>1,re=this._data[se];if(re===W)return se;re>W?K=se:U=se}if(U===K)return U;const q=this._data[U],G=this._data[K];if(q===W)return U;if(G===W)return K;const Q=CharacterMapping.getPartIndex(q),Y=CharacterMapping.getCharIndex(q),X=CharacterMapping.getPartIndex(G);let J;Q!==X?J=D:J=CharacterMapping.getCharIndex(G);const te=O-Y,ie=J-O;return te<=ie?U:K}}class RenderLineOutput{constructor(w,D,O){this._renderLineOutputBrand=void 0,this.characterMapping=w,this.containsRTL=D,this.containsForeignElements=O}}function renderViewLine(F,w){if(F.lineContent.length===0){if(F.lineDecorations.length>0){w.appendString("<span>");let D=0,O=0,W=0;for(const K of F.lineDecorations)(K.type===1||K.type===2)&&(w.appendString('<span class="'),w.appendString(K.className),w.appendString('"></span>'),K.type===1&&(W|=1,D++),K.type===2&&(W|=2,O++));w.appendString("</span>");const U=new CharacterMapping(1,D+O);return U.setColumnInfo(1,D,0,0),new RenderLineOutput(U,!1,W)}return w.appendString("<span><span></span></span>"),new RenderLineOutput(new CharacterMapping(0,0),!1,0)}return _renderLine(resolveRenderLineInput(F),w)}class RenderLineOutput2{constructor(w,D,O,W){this.characterMapping=w,this.html=D,this.containsRTL=O,this.containsForeignElements=W}}function renderViewLine2(F){const w=new StringBuilder(1e4),D=renderViewLine(F,w);return new RenderLineOutput2(D.characterMapping,w.build(),D.containsRTL,D.containsForeignElements)}class ResolvedRenderLineInput{constructor(w,D,O,W,U,K,q,G,Q,Y,X,J,te,ie,se,re){this.fontIsMonospace=w,this.canUseHalfwidthRightwardsArrow=D,this.lineContent=O,this.len=W,this.isOverflowing=U,this.overflowingCharCount=K,this.parts=q,this.containsForeignElements=G,this.fauxIndentLength=Q,this.tabSize=Y,this.startVisibleColumn=X,this.containsRTL=J,this.spaceWidth=te,this.renderSpaceCharCode=ie,this.renderWhitespace=se,this.renderControlCharacters=re}}function resolveRenderLineInput(F){const w=F.lineContent;let D,O,W;F.stopRenderingLineAfter!==-1&&F.stopRenderingLineAfter<w.length?(D=!0,O=w.length-F.stopRenderingLineAfter,W=F.stopRenderingLineAfter):(D=!1,O=0,W=w.length);let U=transformAndRemoveOverflowing(w,F.containsRTL,F.lineTokens,F.fauxIndentLength,W);F.renderControlCharacters&&!F.isBasicASCII&&(U=extractControlCharacters(w,U)),(F.renderWhitespace===4||F.renderWhitespace===1||F.renderWhitespace===2&&F.selectionsOnLine||F.renderWhitespace===3&&!F.continuesWithWrappedLine)&&(U=_applyRenderWhitespace(F,w,W,U));let K=0;if(F.lineDecorations.length>0){for(let q=0,G=F.lineDecorations.length;q<G;q++){const Q=F.lineDecorations[q];Q.type===3||Q.type===1?K|=1:Q.type===2&&(K|=2)}U=_applyInlineDecorations(w,W,U,F.lineDecorations)}return F.containsRTL||(U=splitLargeTokens(w,U,!F.isBasicASCII||F.fontLigatures)),new ResolvedRenderLineInput(F.useMonospaceOptimizations,F.canUseHalfwidthRightwardsArrow,w,W,D,O,U,K,F.fauxIndentLength,F.tabSize,F.startVisibleColumn,F.containsRTL,F.spaceWidth,F.renderSpaceCharCode,F.renderWhitespace,F.renderControlCharacters)}function transformAndRemoveOverflowing(F,w,D,O,W){const U=[];let K=0;O>0&&(U[K++]=new LinePart(O,"",0,!1));let q=O;for(let G=0,Q=D.getCount();G<Q;G++){const Y=D.getEndOffset(G);if(Y<=O)continue;const X=D.getClassName(G);if(Y>=W){const te=w?containsRTL(F.substring(q,W)):!1;U[K++]=new LinePart(W,X,0,te);break}const J=w?containsRTL(F.substring(q,Y)):!1;U[K++]=new LinePart(Y,X,0,J),q=Y}return U}function splitLargeTokens(F,w,D){let O=0;const W=[];let U=0;if(D)for(let K=0,q=w.length;K<q;K++){const G=w[K],Q=G.endIndex;if(O+50<Q){const Y=G.type,X=G.metadata,J=G.containsRTL;let te=-1,ie=O;for(let se=O;se<Q;se++)F.charCodeAt(se)===32&&(te=se),te!==-1&&se-ie>=50&&(W[U++]=new LinePart(te+1,Y,X,J),ie=te+1,te=-1);ie!==Q&&(W[U++]=new LinePart(Q,Y,X,J))}else W[U++]=G;O=Q}else for(let K=0,q=w.length;K<q;K++){const G=w[K],Q=G.endIndex,Y=Q-O;if(Y>50){const X=G.type,J=G.metadata,te=G.containsRTL,ie=Math.ceil(Y/50);for(let se=1;se<ie;se++){const re=O+se*50;W[U++]=new LinePart(re,X,J,te)}W[U++]=new LinePart(Q,X,J,te)}else W[U++]=G;O=Q}return W}function isControlCharacter(F){return F<32?F!==9:F===127||F>=8234&&F<=8238||F>=8294&&F<=8297||F>=8206&&F<=8207||F===1564}function extractControlCharacters(F,w){const D=[];let O=new LinePart(0,"",0,!1),W=0;for(const U of w){const K=U.endIndex;for(;W<K;W++){const q=F.charCodeAt(W);isControlCharacter(q)&&(W>O.endIndex&&(O=new LinePart(W,U.type,U.metadata,U.containsRTL),D.push(O)),O=new LinePart(W+1,"mtkcontrol",U.metadata,!1),D.push(O))}W>O.endIndex&&(O=new LinePart(K,U.type,U.metadata,U.containsRTL),D.push(O))}return D}function _applyRenderWhitespace(F,w,D,O){const W=F.continuesWithWrappedLine,U=F.fauxIndentLength,K=F.tabSize,q=F.startVisibleColumn,G=F.useMonospaceOptimizations,Q=F.selectionsOnLine,Y=F.renderWhitespace===1,X=F.renderWhitespace===3,J=F.renderSpaceWidth!==F.spaceWidth,te=[];let ie=0,se=0,re=O[se].type,ae=O[se].containsRTL,le=O[se].endIndex;const de=O.length;let oe=!1,ue=firstNonWhitespaceIndex(w),pe;ue===-1?(oe=!0,ue=D,pe=D):pe=lastNonWhitespaceIndex(w);let fe=!1,Ce=0,we=Q&&Q[Ce],Oe=q%K;for(let Re=U;Re<D;Re++){const Me=w.charCodeAt(Re);we&&Re>=we.endOffset&&(Ce++,we=Q&&Q[Ce]);let Ne;if(Re<ue||Re>pe)Ne=!0;else if(Me===9)Ne=!0;else if(Me===32)if(Y)if(fe)Ne=!0;else{const ze=Re+1<D?w.charCodeAt(Re+1):0;Ne=ze===32||ze===9}else Ne=!0;else Ne=!1;if(Ne&&Q&&(Ne=!!we&&we.startOffset<=Re&&we.endOffset>Re),Ne&&X&&(Ne=oe||Re>pe),Ne&&ae&&Re>=ue&&Re<=pe&&(Ne=!1),fe){if(!Ne||!G&&Oe>=K){if(J){const ze=ie>0?te[ie-1].endIndex:U;for(let Qe=ze+1;Qe<=Re;Qe++)te[ie++]=new LinePart(Qe,"mtkw",1,!1)}else te[ie++]=new LinePart(Re,"mtkw",1,!1);Oe=Oe%K}}else(Re===le||Ne&&Re>U)&&(te[ie++]=new LinePart(Re,re,0,ae),Oe=Oe%K);for(Me===9?Oe=K:isFullWidthCharacter(Me)?Oe+=2:Oe++,fe=Ne;Re===le&&(se++,se<de);)re=O[se].type,ae=O[se].containsRTL,le=O[se].endIndex}let Te=!1;if(fe)if(W&&Y){const Re=D>0?w.charCodeAt(D-1):0,Me=D>1?w.charCodeAt(D-2):0;Re===32&&Me!==32&&Me!==9||(Te=!0)}else Te=!0;if(Te)if(J){const Re=ie>0?te[ie-1].endIndex:U;for(let Me=Re+1;Me<=D;Me++)te[ie++]=new LinePart(Me,"mtkw",1,!1)}else te[ie++]=new LinePart(D,"mtkw",1,!1);else te[ie++]=new LinePart(D,re,0,ae);return te}function _applyInlineDecorations(F,w,D,O){O.sort(LineDecoration.compare);const W=LineDecorationsNormalizer.normalize(F,O),U=W.length;let K=0;const q=[];let G=0,Q=0;for(let X=0,J=D.length;X<J;X++){const te=D[X],ie=te.endIndex,se=te.type,re=te.metadata,ae=te.containsRTL;for(;K<U&&W[K].startOffset<ie;){const le=W[K];if(le.startOffset>Q&&(Q=le.startOffset,q[G++]=new LinePart(Q,se,re,ae)),le.endOffset+1<=ie)Q=le.endOffset+1,q[G++]=new LinePart(Q,se+" "+le.className,re|le.metadata,ae),K++;else{Q=ie,q[G++]=new LinePart(Q,se+" "+le.className,re|le.metadata,ae);break}}ie>Q&&(Q=ie,q[G++]=new LinePart(Q,se,re,ae))}const Y=D[D.length-1].endIndex;if(K<U&&W[K].startOffset===Y)for(;K<U&&W[K].startOffset===Y;){const X=W[K];q[G++]=new LinePart(Q,X.className,X.metadata,!1),K++}return q}function _renderLine(F,w){const D=F.fontIsMonospace,O=F.canUseHalfwidthRightwardsArrow,W=F.containsForeignElements,U=F.lineContent,K=F.len,q=F.isOverflowing,G=F.overflowingCharCount,Q=F.parts,Y=F.fauxIndentLength,X=F.tabSize,J=F.startVisibleColumn,te=F.containsRTL,ie=F.spaceWidth,se=F.renderSpaceCharCode,re=F.renderWhitespace,ae=F.renderControlCharacters,le=new CharacterMapping(K+1,Q.length);let de=!1,oe=0,ue=J,pe=0,fe=0,Ce=0;te?w.appendString('<span dir="ltr">'):w.appendString("<span>");for(let we=0,Oe=Q.length;we<Oe;we++){const Te=Q[we],Re=Te.endIndex,Me=Te.type,Ne=Te.containsRTL,ze=re!==0&&Te.isWhitespace(),Qe=ze&&!D&&(Me==="mtkw"||!W),Ye=oe===Re&&Te.isPseudoAfter();if(pe=0,w.appendString("<span "),Ne&&w.appendString('style="unicode-bidi:isolate" '),w.appendString('class="'),w.appendString(Qe?"mtkz":Me),w.appendASCIICharCode(34),ze){let Je=0;{let at=oe,st=ue;for(;at<Re;at++){const Tt=(U.charCodeAt(at)===9?X-st%X:1)|0;Je+=Tt,at>=Y&&(st+=Tt)}}for(Qe&&(w.appendString(' style="width:'),w.appendString(String(ie*Je)),w.appendString('px"')),w.appendASCIICharCode(62);oe<Re;oe++){le.setColumnInfo(oe+1,we-Ce,pe,fe),Ce=0;const at=U.charCodeAt(oe);let st,lt;if(at===9){st=X-ue%X|0,lt=st,!O||lt>1?w.appendCharCode(8594):w.appendCharCode(65515);for(let Tt=2;Tt<=lt;Tt++)w.appendCharCode(160)}else st=2,lt=1,w.appendCharCode(se),w.appendCharCode(8204);pe+=st,fe+=lt,oe>=Y&&(ue+=lt)}}else for(w.appendASCIICharCode(62);oe<Re;oe++){le.setColumnInfo(oe+1,we-Ce,pe,fe),Ce=0;const Je=U.charCodeAt(oe);let at=1,st=1;switch(Je){case 9:at=X-ue%X,st=at;for(let lt=1;lt<=at;lt++)w.appendCharCode(160);break;case 32:w.appendCharCode(160);break;case 60:w.appendString("&lt;");break;case 62:w.appendString("&gt;");break;case 38:w.appendString("&amp;");break;case 0:ae?w.appendCharCode(9216):w.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:w.appendCharCode(65533);break;default:isFullWidthCharacter(Je)&&st++,ae&&Je<32?w.appendCharCode(9216+Je):ae&&Je===127?w.appendCharCode(9249):ae&&isControlCharacter(Je)?(w.appendString("[U+"),w.appendString(to4CharHex(Je)),w.appendString("]"),at=8,st=at):w.appendCharCode(Je)}pe+=at,fe+=st,oe>=Y&&(ue+=st)}Ye?Ce++:Ce=0,oe>=K&&!de&&Te.isPseudoAfter()&&(de=!0,le.setColumnInfo(oe+1,we,pe,fe)),w.appendString("</span>")}return de||le.setColumnInfo(K+1,Q.length-1,pe,fe),q&&(w.appendString('<span class="mtkoverflow">'),w.appendString(localize("showMore","Show more ({0})",renderOverflowingCharCount(G))),w.appendString("</span>")),w.appendString("</span>"),new RenderLineOutput(le,te,W)}function to4CharHex(F){return F.toString(16).toUpperCase().padStart(4,"0")}function renderOverflowingCharCount(F){return F<1024?localize("overflow.chars","{0} chars",F):F<1024*1024?`${(F/1024).toFixed(1)} KB`:`${(F/1024/1024).toFixed(1)} MB`}const canUseFastRenderedViewLine=function(){return isNative?!0:!(isLinux||isFirefox$1||isSafari$1)}();let monospaceAssumptionsAreValid=!0;class ViewLineOptions{constructor(w,D){this.themeType=D;const O=w.options,W=O.get(50);O.get(38)==="off"?this.renderWhitespace=O.get(100):this.renderWhitespace="none",this.renderControlCharacters=O.get(95),this.spaceWidth=W.spaceWidth,this.middotWidth=W.middotWidth,this.wsmiddotWidth=W.wsmiddotWidth,this.useMonospaceOptimizations=W.isMonospace&&!O.get(33),this.canUseHalfwidthRightwardsArrow=W.canUseHalfwidthRightwardsArrow,this.lineHeight=O.get(67),this.stopRenderingLineAfter=O.get(118),this.fontLigatures=O.get(51)}equals(w){return this.themeType===w.themeType&&this.renderWhitespace===w.renderWhitespace&&this.renderControlCharacters===w.renderControlCharacters&&this.spaceWidth===w.spaceWidth&&this.middotWidth===w.middotWidth&&this.wsmiddotWidth===w.wsmiddotWidth&&this.useMonospaceOptimizations===w.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===w.canUseHalfwidthRightwardsArrow&&this.lineHeight===w.lineHeight&&this.stopRenderingLineAfter===w.stopRenderingLineAfter&&this.fontLigatures===w.fontLigatures}}class ViewLine{static{this.CLASS_NAME="view-line"}constructor(w){this._options=w,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(w){if(this._renderedViewLine)this._renderedViewLine.domNode=createFastDomNode(w);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(w){this._isMaybeInvalid=!0,this._options=w}onSelectionChanged(){return isHighContrast(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(w,D,O,W,U){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;const K=W.getViewLineRenderingData(w),q=this._options,G=LineDecoration.filter(K.inlineDecorations,w,K.minColumn,K.maxColumn);let Q=null;if(isHighContrast(q.themeType)||this._options.renderWhitespace==="selection"){const te=W.selections;for(const ie of te){if(ie.endLineNumber<w||ie.startLineNumber>w)continue;const se=ie.startLineNumber===w?ie.startColumn:K.minColumn,re=ie.endLineNumber===w?ie.endColumn:K.maxColumn;se<re&&(isHighContrast(q.themeType)&&G.push(new LineDecoration(se,re,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(Q||(Q=[]),Q.push(new LineRange(se-1,re-1))))}}const Y=new RenderLineInput(q.useMonospaceOptimizations,q.canUseHalfwidthRightwardsArrow,K.content,K.continuesWithWrappedLine,K.isBasicASCII,K.containsRTL,K.minColumn-1,K.tokens,G,K.tabSize,K.startVisibleColumn,q.spaceWidth,q.middotWidth,q.wsmiddotWidth,q.stopRenderingLineAfter,q.renderWhitespace,q.renderControlCharacters,q.fontLigatures!==EditorFontLigatures.OFF,Q);if(this._renderedViewLine&&this._renderedViewLine.input.equals(Y))return!1;U.appendString('<div style="top:'),U.appendString(String(D)),U.appendString("px;height:"),U.appendString(String(O)),U.appendString('px;" class="'),U.appendString(ViewLine.CLASS_NAME),U.appendString('">');const X=renderViewLine(Y,U);U.appendString("</div>");let J=null;return monospaceAssumptionsAreValid&&canUseFastRenderedViewLine&&K.isBasicASCII&&q.useMonospaceOptimizations&&X.containsForeignElements===0&&(J=new FastRenderedViewLine(this._renderedViewLine?this._renderedViewLine.domNode:null,Y,X.characterMapping)),J||(J=createRenderedLine(this._renderedViewLine?this._renderedViewLine.domNode:null,Y,X.characterMapping,X.containsRTL,X.containsForeignElements)),this._renderedViewLine=J,!0}layoutLine(w,D,O){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(D),this._renderedViewLine.domNode.setHeight(O))}getWidth(w){return this._renderedViewLine?this._renderedViewLine.getWidth(w):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof FastRenderedViewLine:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof FastRenderedViewLine?this._renderedViewLine.monospaceAssumptionsAreValid():monospaceAssumptionsAreValid}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof FastRenderedViewLine&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(w,D,O,W){if(!this._renderedViewLine)return null;D=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,D)),O=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,O));const U=this._renderedViewLine.input.stopRenderingLineAfter;if(U!==-1&&D>U+1&&O>U+1)return new VisibleRanges(!0,[new FloatHorizontalRange(this.getWidth(W),0)]);U!==-1&&D>U+1&&(D=U+1),U!==-1&&O>U+1&&(O=U+1);const K=this._renderedViewLine.getVisibleRangesForRange(w,D,O,W);return K&&K.length>0?new VisibleRanges(!1,K):null}getColumnOfNodeOffset(w,D){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(w,D):1}}class FastRenderedViewLine{constructor(w,D,O){this._cachedWidth=-1,this.domNode=w,this.input=D;const W=Math.floor(D.lineContent.length/300);if(W>0){this._keyColumnPixelOffsetCache=new Float32Array(W);for(let U=0;U<W;U++)this._keyColumnPixelOffsetCache[U]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=O,this._charWidth=D.spaceWidth}getWidth(w){if(!this.domNode||this.input.lineContent.length<300){const D=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*D)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,w?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return monospaceAssumptionsAreValid;if(this.input.lineContent.length<300){const w=this.getWidth(null),D=this.domNode.domNode.firstChild.offsetWidth;Math.abs(w-D)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),monospaceAssumptionsAreValid=!1)}return monospaceAssumptionsAreValid}toSlowRenderedLine(){return createRenderedLine(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(w,D,O,W){const U=this._getColumnPixelOffset(w,D,W),K=this._getColumnPixelOffset(w,O,W);return[new FloatHorizontalRange(U,K-U)]}_getColumnPixelOffset(w,D,O){if(D<=300){const Q=this._characterMapping.getHorizontalOffset(D);return this._charWidth*Q}const W=Math.floor((D-1)/300)-1,U=(W+1)*300+1;let K=-1;if(this._keyColumnPixelOffsetCache&&(K=this._keyColumnPixelOffsetCache[W],K===-1&&(K=this._actualReadPixelOffset(w,U,O),this._keyColumnPixelOffsetCache[W]=K)),K===-1){const Q=this._characterMapping.getHorizontalOffset(D);return this._charWidth*Q}const q=this._characterMapping.getHorizontalOffset(U),G=this._characterMapping.getHorizontalOffset(D);return K+this._charWidth*(G-q)}_getReadingTarget(w){return w.domNode.firstChild}_actualReadPixelOffset(w,D,O){if(!this.domNode)return-1;const W=this._characterMapping.getDomPosition(D),U=RangeUtil.readHorizontalRanges(this._getReadingTarget(this.domNode),W.partIndex,W.charIndex,W.partIndex,W.charIndex,O);return!U||U.length===0?-1:U[0].left}getColumnOfNodeOffset(w,D){return getColumnOfNodeOffset(this._characterMapping,w,D)}}class RenderedViewLine{constructor(w,D,O,W,U){if(this.domNode=w,this.input=D,this._characterMapping=O,this._isWhitespaceOnly=/^\s*$/.test(D.lineContent),this._containsForeignElements=U,this._cachedWidth=-1,this._pixelOffsetCache=null,!W||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let K=0,q=this._characterMapping.length;K<=q;K++)this._pixelOffsetCache[K]=-1}}_getReadingTarget(w){return w.domNode.firstChild}getWidth(w){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,w?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(w,D,O,W){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){const U=this._readPixelOffset(this.domNode,w,D,W);if(U===-1)return null;const K=this._readPixelOffset(this.domNode,w,O,W);return K===-1?null:[new FloatHorizontalRange(U,K-U)]}return this._readVisibleRangesForRange(this.domNode,w,D,O,W)}_readVisibleRangesForRange(w,D,O,W,U){if(O===W){const K=this._readPixelOffset(w,D,O,U);return K===-1?null:[new FloatHorizontalRange(K,0)]}else return this._readRawVisibleRangesForRange(w,O,W,U)}_readPixelOffset(w,D,O,W){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(W);const U=this._getReadingTarget(w);return U.firstChild?(W.markDidDomLayout(),U.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){const U=this._pixelOffsetCache[O];if(U!==-1)return U;const K=this._actualReadPixelOffset(w,D,O,W);return this._pixelOffsetCache[O]=K,K}return this._actualReadPixelOffset(w,D,O,W)}_actualReadPixelOffset(w,D,O,W){if(this._characterMapping.length===0){const G=RangeUtil.readHorizontalRanges(this._getReadingTarget(w),0,0,0,0,W);return!G||G.length===0?-1:G[0].left}if(O===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(W);const U=this._characterMapping.getDomPosition(O),K=RangeUtil.readHorizontalRanges(this._getReadingTarget(w),U.partIndex,U.charIndex,U.partIndex,U.charIndex,W);if(!K||K.length===0)return-1;const q=K[0].left;if(this.input.isBasicASCII){const G=this._characterMapping.getHorizontalOffset(O),Q=Math.round(this.input.spaceWidth*G);if(Math.abs(Q-q)<=1)return Q}return q}_readRawVisibleRangesForRange(w,D,O,W){if(D===1&&O===this._characterMapping.length)return[new FloatHorizontalRange(0,this.getWidth(W))];const U=this._characterMapping.getDomPosition(D),K=this._characterMapping.getDomPosition(O);return RangeUtil.readHorizontalRanges(this._getReadingTarget(w),U.partIndex,U.charIndex,K.partIndex,K.charIndex,W)}getColumnOfNodeOffset(w,D){return getColumnOfNodeOffset(this._characterMapping,w,D)}}class WebKitRenderedViewLine extends RenderedViewLine{_readVisibleRangesForRange(w,D,O,W,U){const K=super._readVisibleRangesForRange(w,D,O,W,U);if(!K||K.length===0||O===W||O===1&&W===this._characterMapping.length)return K;if(!this.input.containsRTL){const q=this._readPixelOffset(w,D,W,U);if(q!==-1){const G=K[K.length-1];G.left<q&&(G.width=q-G.left)}}return K}}const createRenderedLine=function(){return isWebKit?createWebKitRenderedLine:createNormalRenderedLine}();function createWebKitRenderedLine(F,w,D,O,W){return new WebKitRenderedViewLine(F,w,D,O,W)}function createNormalRenderedLine(F,w,D,O,W){return new RenderedViewLine(F,w,D,O,W)}function getColumnOfNodeOffset(F,w,D){const O=w.textContent.length;let W=-1;for(;w;)w=w.previousSibling,W++;return F.getColumn(new DomPosition(W,D),O)}class AtomicTabMoveOperations{static whitespaceVisibleColumn(w,D,O){const W=w.length;let U=0,K=-1,q=-1;for(let G=0;G<W;G++){if(G===D)return[K,q,U];switch(U%O===0&&(K=G,q=U),w.charCodeAt(G)){case 32:U+=1;break;case 9:U=CursorColumns.nextRenderTabStop(U,O);break;default:return[-1,-1,-1]}}return D===W?[K,q,U]:[-1,-1,-1]}static atomicPosition(w,D,O,W){const U=w.length,[K,q,G]=AtomicTabMoveOperations.whitespaceVisibleColumn(w,D,O);if(G===-1)return-1;let Q;switch(W){case 0:Q=!0;break;case 1:Q=!1;break;case 2:if(G%O===0)return D;Q=G%O<=O/2;break}if(Q){if(K===-1)return-1;let J=q;for(let te=K;te<U;++te){if(J===q+O)return K;switch(w.charCodeAt(te)){case 32:J+=1;break;case 9:J=CursorColumns.nextRenderTabStop(J,O);break;default:return-1}}return J===q+O?K:-1}const Y=CursorColumns.nextRenderTabStop(G,O);let X=G;for(let J=D;J<U;J++){if(X===Y)return J;switch(w.charCodeAt(J)){case 32:X+=1;break;case 9:X=CursorColumns.nextRenderTabStop(X,O);break;default:return-1}}return X===Y?U:-1}}class UnknownHitTestResult{constructor(w=null){this.hitTarget=w,this.type=0}}class ContentHitTestResult{get hitTarget(){return this.spanNode}constructor(w,D,O){this.position=w,this.spanNode=D,this.injectedText=O,this.type=1}}var HitTestResult;(function(F){function w(D,O,W){const U=D.getPositionFromDOMInfo(O,W);return U?new ContentHitTestResult(U,O,null):new UnknownHitTestResult(O)}F.createFromDOMInfo=w})(HitTestResult||(HitTestResult={}));class PointerHandlerLastRenderData{constructor(w,D){this.lastViewCursorsRenderData=w,this.lastTextareaPosition=D}}class MouseTarget{static _deduceRage(w,D=null){return!D&&w?new Range$2(w.lineNumber,w.column,w.lineNumber,w.column):D??null}static createUnknown(w,D,O){return{type:0,element:w,mouseColumn:D,position:O,range:this._deduceRage(O)}}static createTextarea(w,D){return{type:1,element:w,mouseColumn:D,position:null,range:null}}static createMargin(w,D,O,W,U,K){return{type:w,element:D,mouseColumn:O,position:W,range:U,detail:K}}static createViewZone(w,D,O,W,U){return{type:w,element:D,mouseColumn:O,position:W,range:this._deduceRage(W),detail:U}}static createContentText(w,D,O,W,U){return{type:6,element:w,mouseColumn:D,position:O,range:this._deduceRage(O,W),detail:U}}static createContentEmpty(w,D,O,W){return{type:7,element:w,mouseColumn:D,position:O,range:this._deduceRage(O),detail:W}}static createContentWidget(w,D,O){return{type:9,element:w,mouseColumn:D,position:null,range:null,detail:O}}static createScrollbar(w,D,O){return{type:11,element:w,mouseColumn:D,position:O,range:this._deduceRage(O)}}static createOverlayWidget(w,D,O){return{type:12,element:w,mouseColumn:D,position:null,range:null,detail:O}}static createOutsideEditor(w,D,O,W){return{type:13,element:null,mouseColumn:w,position:D,range:this._deduceRage(D),outsidePosition:O,outsideDistance:W}}static _typeToString(w){return w===1?"TEXTAREA":w===2?"GUTTER_GLYPH_MARGIN":w===3?"GUTTER_LINE_NUMBERS":w===4?"GUTTER_LINE_DECORATIONS":w===5?"GUTTER_VIEW_ZONE":w===6?"CONTENT_TEXT":w===7?"CONTENT_EMPTY":w===8?"CONTENT_VIEW_ZONE":w===9?"CONTENT_WIDGET":w===10?"OVERVIEW_RULER":w===11?"SCROLLBAR":w===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(w){return this._typeToString(w.type)+": "+w.position+" - "+w.range+" - "+JSON.stringify(w.detail)}}class ElementPath{static isTextArea(w){return w.length===2&&w[0]===3&&w[1]===7}static isChildOfViewLines(w){return w.length>=4&&w[0]===3&&w[3]===8}static isStrictChildOfViewLines(w){return w.length>4&&w[0]===3&&w[3]===8}static isChildOfScrollableElement(w){return w.length>=2&&w[0]===3&&w[1]===6}static isChildOfMinimap(w){return w.length>=2&&w[0]===3&&w[1]===9}static isChildOfContentWidgets(w){return w.length>=4&&w[0]===3&&w[3]===1}static isChildOfOverflowGuard(w){return w.length>=1&&w[0]===3}static isChildOfOverflowingContentWidgets(w){return w.length>=1&&w[0]===2}static isChildOfOverlayWidgets(w){return w.length>=2&&w[0]===3&&w[1]===4}static isChildOfOverflowingOverlayWidgets(w){return w.length>=1&&w[0]===5}}class HitTestContext{constructor(w,D,O){this.viewModel=w.viewModel;const W=w.configuration.options;this.layoutInfo=W.get(146),this.viewDomNode=D.viewDomNode,this.lineHeight=W.get(67),this.stickyTabStops=W.get(117),this.typicalHalfwidthCharacterWidth=W.get(50).typicalHalfwidthCharacterWidth,this.lastRenderData=O,this._context=w,this._viewHelper=D}getZoneAtCoord(w){return HitTestContext.getZoneAtCoord(this._context,w)}static getZoneAtCoord(w,D){const O=w.viewLayout.getWhitespaceAtVerticalOffset(D);if(O){const W=O.verticalOffset+O.height/2,U=w.viewModel.getLineCount();let K=null,q,G=null;return O.afterLineNumber!==U&&(G=new Position$1(O.afterLineNumber+1,1)),O.afterLineNumber>0&&(K=new Position$1(O.afterLineNumber,w.viewModel.getLineMaxColumn(O.afterLineNumber))),G===null?q=K:K===null?q=G:D<W?q=K:q=G,{viewZoneId:O.id,afterLineNumber:O.afterLineNumber,positionBefore:K,positionAfter:G,position:q}}return null}getFullLineRangeAtCoord(w){if(this._context.viewLayout.isAfterLines(w)){const W=this._context.viewModel.getLineCount(),U=this._context.viewModel.getLineMaxColumn(W);return{range:new Range$2(W,U,W,U),isAfterLines:!0}}const D=this._context.viewLayout.getLineNumberAtVerticalOffset(w),O=this._context.viewModel.getLineMaxColumn(D);return{range:new Range$2(D,1,D,O),isAfterLines:!1}}getLineNumberAtVerticalOffset(w){return this._context.viewLayout.getLineNumberAtVerticalOffset(w)}isAfterLines(w){return this._context.viewLayout.isAfterLines(w)}isInTopPadding(w){return this._context.viewLayout.isInTopPadding(w)}isInBottomPadding(w){return this._context.viewLayout.isInBottomPadding(w)}getVerticalOffsetForLineNumber(w){return this._context.viewLayout.getVerticalOffsetForLineNumber(w)}findAttribute(w,D){return HitTestContext._findAttribute(w,D,this._viewHelper.viewDomNode)}static _findAttribute(w,D,O){for(;w&&w!==w.ownerDocument.body;){if(w.hasAttribute&&w.hasAttribute(D))return w.getAttribute(D);if(w===O)return null;w=w.parentNode}return null}getLineWidth(w){return this._viewHelper.getLineWidth(w)}visibleRangeForPosition(w,D){return this._viewHelper.visibleRangeForPosition(w,D)}getPositionFromDOMInfo(w,D){return this._viewHelper.getPositionFromDOMInfo(w,D)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class BareHitTestRequest{constructor(w,D,O,W){this.editorPos=D,this.pos=O,this.relativePos=W,this.mouseVerticalOffset=Math.max(0,w.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=w.getCurrentScrollLeft()+this.relativePos.x-w.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<w.layoutInfo.contentLeft&&this.relativePos.x>=w.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,MouseTargetFactory._getMouseColumn(this.mouseContentHorizontalOffset,w.typicalHalfwidthCharacterWidth))}}class HitTestRequest extends BareHitTestRequest{get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=PartFingerprints.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(w,D,O,W,U){super(w,D,O,W),this.hitTestResult=new Lazy(()=>MouseTargetFactory.doHitTest(this._ctx,this)),this._targetPathCacheElement=null,this._targetPathCacheValue=new Uint8Array(0),this._ctx=w,this._eventTarget=U;const K=!!this._eventTarget;this._useHitTestTarget=!K}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(w=null){return w&&w.column<this._ctx.viewModel.getLineMaxColumn(w.lineNumber)?CursorColumns.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(w.lineNumber),w.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(w=null){return MouseTarget.createUnknown(this.target,this._getMouseColumn(w),w)}fulfillTextarea(){return MouseTarget.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(w,D,O,W){return MouseTarget.createMargin(w,this.target,this._getMouseColumn(D),D,O,W)}fulfillViewZone(w,D,O){return MouseTarget.createViewZone(w,this.target,this._getMouseColumn(D),D,O)}fulfillContentText(w,D,O){return MouseTarget.createContentText(this.target,this._getMouseColumn(w),w,D,O)}fulfillContentEmpty(w,D){return MouseTarget.createContentEmpty(this.target,this._getMouseColumn(w),w,D)}fulfillContentWidget(w){return MouseTarget.createContentWidget(this.target,this._getMouseColumn(),w)}fulfillScrollbar(w){return MouseTarget.createScrollbar(this.target,this._getMouseColumn(w),w)}fulfillOverlayWidget(w){return MouseTarget.createOverlayWidget(this.target,this._getMouseColumn(),w)}}const EMPTY_CONTENT_AFTER_LINES={isAfterLines:!0};function createEmptyContentDataInLines(F){return{isAfterLines:!1,horizontalDistanceToText:F}}class MouseTargetFactory{constructor(w,D){this._context=w,this._viewHelper=D}mouseTargetIsWidget(w){const D=w.target,O=PartFingerprints.collect(D,this._viewHelper.viewDomNode);return!!(ElementPath.isChildOfContentWidgets(O)||ElementPath.isChildOfOverflowingContentWidgets(O)||ElementPath.isChildOfOverlayWidgets(O)||ElementPath.isChildOfOverflowingOverlayWidgets(O))}createMouseTarget(w,D,O,W,U){const K=new HitTestContext(this._context,this._viewHelper,w),q=new HitTestRequest(K,D,O,W,U);try{const G=MouseTargetFactory._createMouseTarget(K,q);if(G.type===6&&K.stickyTabStops&&G.position!==null){const Q=MouseTargetFactory._snapToSoftTabBoundary(G.position,K.viewModel),Y=Range$2.fromPositions(Q,Q).plusRange(G.range);return q.fulfillContentText(Q,Y,G.detail)}return G}catch{return q.fulfillUnknown()}}static _createMouseTarget(w,D){if(D.target===null)return D.fulfillUnknown();const O=D;let W=null;return!ElementPath.isChildOfOverflowGuard(D.targetPath)&&!ElementPath.isChildOfOverflowingContentWidgets(D.targetPath)&&!ElementPath.isChildOfOverflowingOverlayWidgets(D.targetPath)&&(W=W||D.fulfillUnknown()),W=W||MouseTargetFactory._hitTestContentWidget(w,O),W=W||MouseTargetFactory._hitTestOverlayWidget(w,O),W=W||MouseTargetFactory._hitTestMinimap(w,O),W=W||MouseTargetFactory._hitTestScrollbarSlider(w,O),W=W||MouseTargetFactory._hitTestViewZone(w,O),W=W||MouseTargetFactory._hitTestMargin(w,O),W=W||MouseTargetFactory._hitTestViewCursor(w,O),W=W||MouseTargetFactory._hitTestTextArea(w,O),W=W||MouseTargetFactory._hitTestViewLines(w,O),W=W||MouseTargetFactory._hitTestScrollbar(w,O),W||D.fulfillUnknown()}static _hitTestContentWidget(w,D){if(ElementPath.isChildOfContentWidgets(D.targetPath)||ElementPath.isChildOfOverflowingContentWidgets(D.targetPath)){const O=w.findAttribute(D.target,"widgetId");return O?D.fulfillContentWidget(O):D.fulfillUnknown()}return null}static _hitTestOverlayWidget(w,D){if(ElementPath.isChildOfOverlayWidgets(D.targetPath)||ElementPath.isChildOfOverflowingOverlayWidgets(D.targetPath)){const O=w.findAttribute(D.target,"widgetId");return O?D.fulfillOverlayWidget(O):D.fulfillUnknown()}return null}static _hitTestViewCursor(w,D){if(D.target){const O=w.lastRenderData.lastViewCursorsRenderData;for(const W of O)if(D.target===W.domNode)return D.fulfillContentText(W.position,null,{mightBeForeignElement:!1,injectedText:null})}if(D.isInContentArea){const O=w.lastRenderData.lastViewCursorsRenderData,W=D.mouseContentHorizontalOffset,U=D.mouseVerticalOffset;for(const K of O){if(W<K.contentLeft||W>K.contentLeft+K.width)continue;const q=w.getVerticalOffsetForLineNumber(K.position.lineNumber);if(q<=U&&U<=q+K.height)return D.fulfillContentText(K.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(w,D){const O=w.getZoneAtCoord(D.mouseVerticalOffset);if(O){const W=D.isInContentArea?8:5;return D.fulfillViewZone(W,O.position,O)}return null}static _hitTestTextArea(w,D){return ElementPath.isTextArea(D.targetPath)?w.lastRenderData.lastTextareaPosition?D.fulfillContentText(w.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):D.fulfillTextarea():null}static _hitTestMargin(w,D){if(D.isInMarginArea){const O=w.getFullLineRangeAtCoord(D.mouseVerticalOffset),W=O.range.getStartPosition();let U=Math.abs(D.relativePos.x);const K={isAfterLines:O.isAfterLines,glyphMarginLeft:w.layoutInfo.glyphMarginLeft,glyphMarginWidth:w.layoutInfo.glyphMarginWidth,lineNumbersWidth:w.layoutInfo.lineNumbersWidth,offsetX:U};if(U-=w.layoutInfo.glyphMarginLeft,U<=w.layoutInfo.glyphMarginWidth){const q=w.viewModel.coordinatesConverter.convertViewPositionToModelPosition(O.range.getStartPosition()),G=w.viewModel.glyphLanes.getLanesAtLine(q.lineNumber);return K.glyphMarginLane=G[Math.floor(U/w.lineHeight)],D.fulfillMargin(2,W,O.range,K)}return U-=w.layoutInfo.glyphMarginWidth,U<=w.layoutInfo.lineNumbersWidth?D.fulfillMargin(3,W,O.range,K):(U-=w.layoutInfo.lineNumbersWidth,D.fulfillMargin(4,W,O.range,K))}return null}static _hitTestViewLines(w,D){if(!ElementPath.isChildOfViewLines(D.targetPath))return null;if(w.isInTopPadding(D.mouseVerticalOffset))return D.fulfillContentEmpty(new Position$1(1,1),EMPTY_CONTENT_AFTER_LINES);if(w.isAfterLines(D.mouseVerticalOffset)||w.isInBottomPadding(D.mouseVerticalOffset)){const W=w.viewModel.getLineCount(),U=w.viewModel.getLineMaxColumn(W);return D.fulfillContentEmpty(new Position$1(W,U),EMPTY_CONTENT_AFTER_LINES)}if(ElementPath.isStrictChildOfViewLines(D.targetPath)){const W=w.getLineNumberAtVerticalOffset(D.mouseVerticalOffset);if(w.viewModel.getLineLength(W)===0){const K=w.getLineWidth(W),q=createEmptyContentDataInLines(D.mouseContentHorizontalOffset-K);return D.fulfillContentEmpty(new Position$1(W,1),q)}const U=w.getLineWidth(W);if(D.mouseContentHorizontalOffset>=U){const K=createEmptyContentDataInLines(D.mouseContentHorizontalOffset-U),q=new Position$1(W,w.viewModel.getLineMaxColumn(W));return D.fulfillContentEmpty(q,K)}}const O=D.hitTestResult.value;return O.type===1?MouseTargetFactory.createMouseTargetFromHitTestPosition(w,D,O.spanNode,O.position,O.injectedText):D.wouldBenefitFromHitTestTargetSwitch?(D.switchToHitTestTarget(),this._createMouseTarget(w,D)):D.fulfillUnknown()}static _hitTestMinimap(w,D){if(ElementPath.isChildOfMinimap(D.targetPath)){const O=w.getLineNumberAtVerticalOffset(D.mouseVerticalOffset),W=w.viewModel.getLineMaxColumn(O);return D.fulfillScrollbar(new Position$1(O,W))}return null}static _hitTestScrollbarSlider(w,D){if(ElementPath.isChildOfScrollableElement(D.targetPath)&&D.target&&D.target.nodeType===1){const O=D.target.className;if(O&&/\b(slider|scrollbar)\b/.test(O)){const W=w.getLineNumberAtVerticalOffset(D.mouseVerticalOffset),U=w.viewModel.getLineMaxColumn(W);return D.fulfillScrollbar(new Position$1(W,U))}}return null}static _hitTestScrollbar(w,D){if(ElementPath.isChildOfScrollableElement(D.targetPath)){const O=w.getLineNumberAtVerticalOffset(D.mouseVerticalOffset),W=w.viewModel.getLineMaxColumn(O);return D.fulfillScrollbar(new Position$1(O,W))}return null}getMouseColumn(w){const D=this._context.configuration.options,O=D.get(146),W=this._context.viewLayout.getCurrentScrollLeft()+w.x-O.contentLeft;return MouseTargetFactory._getMouseColumn(W,D.get(50).typicalHalfwidthCharacterWidth)}static _getMouseColumn(w,D){return w<0?1:Math.round(w/D)+1}static createMouseTargetFromHitTestPosition(w,D,O,W,U){const K=W.lineNumber,q=W.column,G=w.getLineWidth(K);if(D.mouseContentHorizontalOffset>G){const ae=createEmptyContentDataInLines(D.mouseContentHorizontalOffset-G);return D.fulfillContentEmpty(W,ae)}const Q=w.visibleRangeForPosition(K,q);if(!Q)return D.fulfillUnknown(W);const Y=Q.left;if(Math.abs(D.mouseContentHorizontalOffset-Y)<1)return D.fulfillContentText(W,null,{mightBeForeignElement:!!U,injectedText:U});const X=[];if(X.push({offset:Q.left,column:q}),q>1){const ae=w.visibleRangeForPosition(K,q-1);ae&&X.push({offset:ae.left,column:q-1})}const J=w.viewModel.getLineMaxColumn(K);if(q<J){const ae=w.visibleRangeForPosition(K,q+1);ae&&X.push({offset:ae.left,column:q+1})}X.sort((ae,le)=>ae.offset-le.offset);const te=D.pos.toClientCoordinates(getWindow(w.viewDomNode)),ie=O.getBoundingClientRect(),se=ie.left<=te.clientX&&te.clientX<=ie.right;let re=null;for(let ae=1;ae<X.length;ae++){const le=X[ae-1],de=X[ae];if(le.offset<=D.mouseContentHorizontalOffset&&D.mouseContentHorizontalOffset<=de.offset){re=new Range$2(K,le.column,K,de.column);const oe=Math.abs(le.offset-D.mouseContentHorizontalOffset),ue=Math.abs(de.offset-D.mouseContentHorizontalOffset);W=oe<ue?new Position$1(K,le.column):new Position$1(K,de.column);break}}return D.fulfillContentText(W,re,{mightBeForeignElement:!se||!!U,injectedText:U})}static _doHitTestWithCaretRangeFromPoint(w,D){const O=w.getLineNumberAtVerticalOffset(D.mouseVerticalOffset),W=w.getVerticalOffsetForLineNumber(O),U=W+w.lineHeight;if(!(O===w.viewModel.getLineCount()&&D.mouseVerticalOffset>U)){const q=Math.floor((W+U)/2);let G=D.pos.y+(q-D.mouseVerticalOffset);G<=D.editorPos.y&&(G=D.editorPos.y+1),G>=D.editorPos.y+D.editorPos.height&&(G=D.editorPos.y+D.editorPos.height-1);const Q=new PageCoordinates(D.pos.x,G),Y=this._actualDoHitTestWithCaretRangeFromPoint(w,Q.toClientCoordinates(getWindow(w.viewDomNode)));if(Y.type===1)return Y}return this._actualDoHitTestWithCaretRangeFromPoint(w,D.pos.toClientCoordinates(getWindow(w.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(w,D){const O=getShadowRoot(w.viewDomNode);let W;if(O?typeof O.caretRangeFromPoint>"u"?W=shadowCaretRangeFromPoint(O,D.clientX,D.clientY):W=O.caretRangeFromPoint(D.clientX,D.clientY):W=w.viewDomNode.ownerDocument.caretRangeFromPoint(D.clientX,D.clientY),!W||!W.startContainer)return new UnknownHitTestResult;const U=W.startContainer;if(U.nodeType===U.TEXT_NODE){const K=U.parentNode,q=K?K.parentNode:null,G=q?q.parentNode:null;return(G&&G.nodeType===G.ELEMENT_NODE?G.className:null)===ViewLine.CLASS_NAME?HitTestResult.createFromDOMInfo(w,K,W.startOffset):new UnknownHitTestResult(U.parentNode)}else if(U.nodeType===U.ELEMENT_NODE){const K=U.parentNode,q=K?K.parentNode:null;return(q&&q.nodeType===q.ELEMENT_NODE?q.className:null)===ViewLine.CLASS_NAME?HitTestResult.createFromDOMInfo(w,U,U.textContent.length):new UnknownHitTestResult(U)}return new UnknownHitTestResult}static _doHitTestWithCaretPositionFromPoint(w,D){const O=w.viewDomNode.ownerDocument.caretPositionFromPoint(D.clientX,D.clientY);if(O.offsetNode.nodeType===O.offsetNode.TEXT_NODE){const W=O.offsetNode.parentNode,U=W?W.parentNode:null,K=U?U.parentNode:null;return(K&&K.nodeType===K.ELEMENT_NODE?K.className:null)===ViewLine.CLASS_NAME?HitTestResult.createFromDOMInfo(w,O.offsetNode.parentNode,O.offset):new UnknownHitTestResult(O.offsetNode.parentNode)}if(O.offsetNode.nodeType===O.offsetNode.ELEMENT_NODE){const W=O.offsetNode.parentNode,U=W&&W.nodeType===W.ELEMENT_NODE?W.className:null,K=W?W.parentNode:null,q=K&&K.nodeType===K.ELEMENT_NODE?K.className:null;if(U===ViewLine.CLASS_NAME){const G=O.offsetNode.childNodes[Math.min(O.offset,O.offsetNode.childNodes.length-1)];if(G)return HitTestResult.createFromDOMInfo(w,G,0)}else if(q===ViewLine.CLASS_NAME)return HitTestResult.createFromDOMInfo(w,O.offsetNode,0)}return new UnknownHitTestResult(O.offsetNode)}static _snapToSoftTabBoundary(w,D){const O=D.getLineContent(w.lineNumber),{tabSize:W}=D.model.getOptions(),U=AtomicTabMoveOperations.atomicPosition(O,w.column-1,W,2);return U!==-1?new Position$1(w.lineNumber,U+1):w}static doHitTest(w,D){let O=new UnknownHitTestResult;if(typeof w.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?O=this._doHitTestWithCaretRangeFromPoint(w,D):w.viewDomNode.ownerDocument.caretPositionFromPoint&&(O=this._doHitTestWithCaretPositionFromPoint(w,D.pos.toClientCoordinates(getWindow(w.viewDomNode)))),O.type===1){const W=w.viewModel.getInjectedTextAt(O.position),U=w.viewModel.normalizePosition(O.position,2);(W||!U.equals(O.position))&&(O=new ContentHitTestResult(U,O.spanNode,W))}return O}}function shadowCaretRangeFromPoint(F,w,D){const O=document.createRange();let W=F.elementFromPoint(w,D);if(W!==null){for(;W&&W.firstChild&&W.firstChild.nodeType!==W.firstChild.TEXT_NODE&&W.lastChild&&W.lastChild.firstChild;)W=W.lastChild;const U=W.getBoundingClientRect(),K=getWindow(W),q=K.getComputedStyle(W,null).getPropertyValue("font-style"),G=K.getComputedStyle(W,null).getPropertyValue("font-variant"),Q=K.getComputedStyle(W,null).getPropertyValue("font-weight"),Y=K.getComputedStyle(W,null).getPropertyValue("font-size"),X=K.getComputedStyle(W,null).getPropertyValue("line-height"),J=K.getComputedStyle(W,null).getPropertyValue("font-family"),te=`${q} ${G} ${Q} ${Y}/${X} ${J}`,ie=W.innerText;let se=U.left,re=0,ae;if(w>U.left+U.width)re=ie.length;else{const le=CharWidthReader.getInstance();for(let de=0;de<ie.length+1;de++){if(ae=le.getCharWidth(ie.charAt(de),te)/2,se+=ae,w<se){re=de;break}se+=ae}}O.setStart(W.firstChild,re),O.setEnd(W.firstChild,re)}return O}class CharWidthReader{static{this._INSTANCE=null}static getInstance(){return CharWidthReader._INSTANCE||(CharWidthReader._INSTANCE=new CharWidthReader),CharWidthReader._INSTANCE}constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(w,D){const O=w+D;if(this._cache[O])return this._cache[O];const W=this._canvas.getContext("2d");W.font=D;const K=W.measureText(w).width;return this._cache[O]=K,K}}class MouseHandler extends ViewEventHandler{constructor(w,D,O){super(),this._mouseLeaveMonitor=null,this._context=w,this.viewController=D,this.viewHelper=O,this.mouseTargetFactory=new MouseTargetFactory(this._context,O),this._mouseDownOperation=this._register(new MouseDownOperation(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(K,q)=>this._createMouseTarget(K,q),K=>this._getMouseColumn(K))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(146).height;const W=new EditorMouseEventFactory(this.viewHelper.viewDomNode);this._register(W.onContextMenu(this.viewHelper.viewDomNode,K=>this._onContextMenu(K,!0))),this._register(W.onMouseMove(this.viewHelper.viewDomNode,K=>{this._onMouseMove(K),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=addDisposableListener(this.viewHelper.viewDomNode.ownerDocument,"mousemove",q=>{this.viewHelper.viewDomNode.contains(q.target)||this._onMouseLeave(new EditorMouseEvent(q,!1,this.viewHelper.viewDomNode))}))})),this._register(W.onMouseUp(this.viewHelper.viewDomNode,K=>this._onMouseUp(K))),this._register(W.onMouseLeave(this.viewHelper.viewDomNode,K=>this._onMouseLeave(K)));let U=0;this._register(W.onPointerDown(this.viewHelper.viewDomNode,(K,q)=>{U=q})),this._register(addDisposableListener(this.viewHelper.viewDomNode,EventType$1.POINTER_UP,K=>{this._mouseDownOperation.onPointerUp()})),this._register(W.onMouseDown(this.viewHelper.viewDomNode,K=>this._onMouseDown(K,U))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){const w=MouseWheelClassifier.INSTANCE;let D=0,O=EditorZoom.getZoomLevel(),W=!1,U=0;const K=G=>{if(this.viewController.emitMouseWheel(G),!this._context.configuration.options.get(76))return;const Q=new StandardWheelEvent(G);if(w.acceptStandardWheelEvent(Q),w.isPhysicalMouseWheel()){if(q(G)){const Y=EditorZoom.getZoomLevel(),X=Q.deltaY>0?1:-1;EditorZoom.setZoomLevel(Y+X),Q.preventDefault(),Q.stopPropagation()}}else Date.now()-D>50&&(O=EditorZoom.getZoomLevel(),W=q(G),U=0),D=Date.now(),U+=Q.deltaY,W&&(EditorZoom.setZoomLevel(O+U/5),Q.preventDefault(),Q.stopPropagation())};this._register(addDisposableListener(this.viewHelper.viewDomNode,EventType$1.MOUSE_WHEEL,K,{capture:!0,passive:!1}));function q(G){return isMacintosh?(G.metaKey||G.ctrlKey)&&!G.shiftKey&&!G.altKey:G.ctrlKey&&!G.metaKey&&!G.shiftKey&&!G.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(w){if(w.hasChanged(146)){const D=this._context.configuration.options.get(146).height;this._height!==D&&(this._height=D,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(w){return this._mouseDownOperation.onCursorStateChanged(w),!1}onFocusChanged(w){return!1}getTargetAtClientPoint(w,D){const W=new ClientCoordinates(w,D).toPageCoordinates(getWindow(this.viewHelper.viewDomNode)),U=createEditorPagePosition(this.viewHelper.viewDomNode);if(W.y<U.y||W.y>U.y+U.height||W.x<U.x||W.x>U.x+U.width)return null;const K=createCoordinatesRelativeToEditor(this.viewHelper.viewDomNode,U,W);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),U,W,K,null)}_createMouseTarget(w,D){let O=w.target;if(!this.viewHelper.viewDomNode.contains(O)){const W=getShadowRoot(this.viewHelper.viewDomNode);W&&(O=W.elementsFromPoint(w.posx,w.posy).find(U=>this.viewHelper.viewDomNode.contains(U)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),w.editorPos,w.pos,w.relativePos,D?O:null)}_getMouseColumn(w){return this.mouseTargetFactory.getMouseColumn(w.relativePos)}_onContextMenu(w,D){this.viewController.emitContextMenu({event:w,target:this._createMouseTarget(w,D)})}_onMouseMove(w){this.mouseTargetFactory.mouseTargetIsWidget(w)||w.preventDefault(),!(this._mouseDownOperation.isActive()||w.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:w,target:this._createMouseTarget(w,!0)})}_onMouseLeave(w){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:w,target:null})}_onMouseUp(w){this.viewController.emitMouseUp({event:w,target:this._createMouseTarget(w,!0)})}_onMouseDown(w,D){const O=this._createMouseTarget(w,!0),W=O.type===6||O.type===7,U=O.type===2||O.type===3||O.type===4,K=O.type===3,q=this._context.configuration.options.get(110),G=O.type===8||O.type===5,Q=O.type===9;let Y=w.leftButton||w.middleButton;isMacintosh&&w.leftButton&&w.ctrlKey&&(Y=!1);const X=()=>{w.preventDefault(),this.viewHelper.focusTextArea()};if(Y&&(W||K&&q))X(),this._mouseDownOperation.start(O.type,w,D);else if(U)w.preventDefault();else if(G){const J=O.detail;Y&&this.viewHelper.shouldSuppressMouseDownOnViewZone(J.viewZoneId)&&(X(),this._mouseDownOperation.start(O.type,w,D),w.preventDefault())}else Q&&this.viewHelper.shouldSuppressMouseDownOnWidget(O.detail)&&(X(),w.preventDefault());this.viewController.emitMouseDown({event:w,target:O})}}class MouseDownOperation extends Disposable{constructor(w,D,O,W,U,K){super(),this._context=w,this._viewController=D,this._viewHelper=O,this._mouseTargetFactory=W,this._createMouseTarget=U,this._getMouseColumn=K,this._mouseMoveMonitor=this._register(new GlobalEditorPointerMoveMonitor(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new TopBottomDragScrolling(this._context,this._viewHelper,this._mouseTargetFactory,(q,G,Q)=>this._dispatchMouse(q,G,Q))),this._mouseState=new MouseDownState,this._currentSelection=new Selection$1(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(w){this._lastMouseEvent=w,this._mouseState.setModifiers(w);const D=this._findMousePosition(w,!1);D&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:w,target:D}):D.type===13&&(D.outsidePosition==="above"||D.outsidePosition==="below")?this._topBottomDragScrolling.start(D,w):(this._topBottomDragScrolling.stop(),this._dispatchMouse(D,!0,1)))}start(w,D,O){this._lastMouseEvent=D,this._mouseState.setStartedOnLineNumbers(w===3),this._mouseState.setStartButtons(D),this._mouseState.setModifiers(D);const W=this._findMousePosition(D,!0);if(!W||!W.position)return;this._mouseState.trySetCount(D.detail,W.position),D.detail=this._mouseState.count;const U=this._context.configuration.options;if(!U.get(92)&&U.get(35)&&!U.get(22)&&!this._mouseState.altKey&&D.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&W.type===6&&W.position&&this._currentSelection.containsPosition(W.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,O,D.buttons,K=>this._onMouseDownThenMove(K),K=>{const q=this._findMousePosition(this._lastMouseEvent,!1);isKeyboardEvent(K)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:q?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(W,D.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,O,D.buttons,K=>this._onMouseDownThenMove(K),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(w){this._currentSelection=w.selections[0]}_getPositionOutsideEditor(w){const D=w.editorPos,O=this._context.viewModel,W=this._context.viewLayout,U=this._getMouseColumn(w);if(w.posy<D.y){const q=D.y-w.posy,G=Math.max(W.getCurrentScrollTop()-q,0),Q=HitTestContext.getZoneAtCoord(this._context,G);if(Q){const X=this._helpPositionJumpOverViewZone(Q);if(X)return MouseTarget.createOutsideEditor(U,X,"above",q)}const Y=W.getLineNumberAtVerticalOffset(G);return MouseTarget.createOutsideEditor(U,new Position$1(Y,1),"above",q)}if(w.posy>D.y+D.height){const q=w.posy-D.y-D.height,G=W.getCurrentScrollTop()+w.relativePos.y,Q=HitTestContext.getZoneAtCoord(this._context,G);if(Q){const X=this._helpPositionJumpOverViewZone(Q);if(X)return MouseTarget.createOutsideEditor(U,X,"below",q)}const Y=W.getLineNumberAtVerticalOffset(G);return MouseTarget.createOutsideEditor(U,new Position$1(Y,O.getLineMaxColumn(Y)),"below",q)}const K=W.getLineNumberAtVerticalOffset(W.getCurrentScrollTop()+w.relativePos.y);if(w.posx<D.x){const q=D.x-w.posx;return MouseTarget.createOutsideEditor(U,new Position$1(K,1),"left",q)}if(w.posx>D.x+D.width){const q=w.posx-D.x-D.width;return MouseTarget.createOutsideEditor(U,new Position$1(K,O.getLineMaxColumn(K)),"right",q)}return null}_findMousePosition(w,D){const O=this._getPositionOutsideEditor(w);if(O)return O;const W=this._createMouseTarget(w,D);if(!W.position)return null;if(W.type===8||W.type===5){const K=this._helpPositionJumpOverViewZone(W.detail);if(K)return MouseTarget.createViewZone(W.type,W.element,W.mouseColumn,K,W.detail)}return W}_helpPositionJumpOverViewZone(w){const D=new Position$1(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),O=w.positionBefore,W=w.positionAfter;return O&&W?O.isBefore(D)?O:W:null}_dispatchMouse(w,D,O){w.position&&this._viewController.dispatchMouse({position:w.position,mouseColumn:w.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:O,inSelectionMode:D,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:w.type===6&&w.detail.injectedText!==null})}}class TopBottomDragScrolling extends Disposable{constructor(w,D,O,W){super(),this._context=w,this._viewHelper=D,this._mouseTargetFactory=O,this._dispatchMouse=W,this._operation=null}dispose(){super.dispose(),this.stop()}start(w,D){this._operation?this._operation.setPosition(w,D):this._operation=new TopBottomDragScrollingOperation(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,w,D)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}}class TopBottomDragScrollingOperation extends Disposable{constructor(w,D,O,W,U,K){super(),this._context=w,this._viewHelper=D,this._mouseTargetFactory=O,this._dispatchMouse=W,this._position=U,this._mouseEvent=K,this._lastTime=Date.now(),this._animationFrameDisposable=scheduleAtNextAnimationFrame(getWindow(K.browserEvent),()=>this._execute())}dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(w,D){this._position=w,this._mouseEvent=D}_tick(){const w=Date.now(),D=w-this._lastTime;return this._lastTime=w,D}_getScrollSpeed(){const w=this._context.configuration.options.get(67),D=this._context.configuration.options.get(146).height/w,O=this._position.outsideDistance/w;return O<=1.5?Math.max(30,D*(1+O)):O<=3?Math.max(60,D*(2+O)):Math.max(200,D*(7+O))}_execute(){const w=this._context.configuration.options.get(67),D=this._getScrollSpeed(),O=this._tick(),W=D*(O/1e3)*w,U=this._position.outsidePosition==="above"?-W:W;this._context.viewModel.viewLayout.deltaScrollNow(0,U),this._viewHelper.renderNow();const K=this._context.viewLayout.getLinesViewportData(),q=this._position.outsidePosition==="above"?K.startLineNumber:K.endLineNumber;let G;{const Q=createEditorPagePosition(this._viewHelper.viewDomNode),Y=this._context.configuration.options.get(146).horizontalScrollbarHeight,X=new PageCoordinates(this._mouseEvent.pos.x,Q.y+Q.height-Y-.1),J=createCoordinatesRelativeToEditor(this._viewHelper.viewDomNode,Q,X);G=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),Q,X,J,null)}(!G.position||G.position.lineNumber!==q)&&(this._position.outsidePosition==="above"?G=MouseTarget.createOutsideEditor(this._position.mouseColumn,new Position$1(q,1),"above",this._position.outsideDistance):G=MouseTarget.createOutsideEditor(this._position.mouseColumn,new Position$1(q,this._context.viewModel.getLineMaxColumn(q)),"below",this._position.outsideDistance)),this._dispatchMouse(G,!0,2),this._animationFrameDisposable=scheduleAtNextAnimationFrame(getWindow(G.element),()=>this._execute())}}class MouseDownState{static{this.CLEAR_MOUSE_DOWN_COUNT_TIME=400}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(w){this._altKey=w.altKey,this._ctrlKey=w.ctrlKey,this._metaKey=w.metaKey,this._shiftKey=w.shiftKey}setStartButtons(w){this._leftButton=w.leftButton,this._middleButton=w.middleButton}setStartedOnLineNumbers(w){this._startedOnLineNumbers=w}trySetCount(w,D){const O=new Date().getTime();O-this._lastSetMouseDownCountTime>MouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME&&(w=1),this._lastSetMouseDownCountTime=O,w>this._lastMouseDownCount+1&&(w=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(D)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=D,this._lastMouseDownCount=Math.min(w,this._lastMouseDownPositionEqualCount)}}class TextAreaState{static{this.EMPTY=new TextAreaState("",0,0,null,void 0)}constructor(w,D,O,W,U){this.value=w,this.selectionStart=D,this.selectionEnd=O,this.selection=W,this.newlineCountBeforeSelection=U}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(w,D){const O=w.getValue(),W=w.getSelectionStart(),U=w.getSelectionEnd();let K;if(D){const q=O.substring(0,W),G=D.value.substring(0,D.selectionStart);q===G&&(K=D.newlineCountBeforeSelection)}return new TextAreaState(O,W,U,null,K)}collapseSelection(){return this.selectionStart===this.value.length?this:new TextAreaState(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(w,D,O){D.setValue(w,this.value),O&&D.setSelectionRange(w,this.selectionStart,this.selectionEnd)}deduceEditorPosition(w){if(w<=this.selectionStart){const W=this.value.substring(w,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,W,-1)}if(w>=this.selectionEnd){const W=this.value.substring(this.selectionEnd,w);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,W,1)}const D=this.value.substring(this.selectionStart,w);if(D.indexOf("…")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,D,1);const O=this.value.substring(w,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,O,-1)}_finishDeduceEditorPosition(w,D,O){let W=0,U=-1;for(;(U=D.indexOf(`
`,U+1))!==-1;)W++;return[w,O*D.length,W]}static deduceInput(w,D,O){if(!w)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const W=Math.min(commonPrefixLength(w.value,D.value),w.selectionStart,D.selectionStart),U=Math.min(commonSuffixLength(w.value,D.value),w.value.length-w.selectionEnd,D.value.length-D.selectionEnd);w.value.substring(W,w.value.length-U);const K=D.value.substring(W,D.value.length-U),q=w.selectionStart-W,G=w.selectionEnd-W,Q=D.selectionStart-W,Y=D.selectionEnd-W;if(Q===Y){const J=w.selectionStart-W;return{text:K,replacePrevCharCnt:J,replaceNextCharCnt:0,positionDelta:0}}const X=G-q;return{text:K,replacePrevCharCnt:X,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(w,D){if(!w)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(w.value===D.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:D.selectionEnd-w.selectionEnd};const O=Math.min(commonPrefixLength(w.value,D.value),w.selectionEnd),W=Math.min(commonSuffixLength(w.value,D.value),w.value.length-w.selectionEnd),U=w.value.substring(O,w.value.length-W),K=D.value.substring(O,D.value.length-W);w.selectionStart-O;const q=w.selectionEnd-O;D.selectionStart-O;const G=D.selectionEnd-O;return{text:K,replacePrevCharCnt:q,replaceNextCharCnt:U.length-q,positionDelta:G-K.length}}}class PagedScreenReaderStrategy{static _getPageOfLine(w,D){return Math.floor((w-1)/D)}static _getRangeForPage(w,D){const O=w*D,W=O+1,U=O+D;return new Range$2(W,1,U+1,1)}static fromEditorSelection(w,D,O,W){const K=PagedScreenReaderStrategy._getPageOfLine(D.startLineNumber,O),q=PagedScreenReaderStrategy._getRangeForPage(K,O),G=PagedScreenReaderStrategy._getPageOfLine(D.endLineNumber,O),Q=PagedScreenReaderStrategy._getRangeForPage(G,O);let Y=q.intersectRanges(new Range$2(1,1,D.startLineNumber,D.startColumn));if(W&&w.getValueLengthInRange(Y,1)>500){const ae=w.modifyPosition(Y.getEndPosition(),-500);Y=Range$2.fromPositions(ae,Y.getEndPosition())}const X=w.getValueInRange(Y,1),J=w.getLineCount(),te=w.getLineMaxColumn(J);let ie=Q.intersectRanges(new Range$2(D.endLineNumber,D.endColumn,J,te));if(W&&w.getValueLengthInRange(ie,1)>500){const ae=w.modifyPosition(ie.getStartPosition(),500);ie=Range$2.fromPositions(ie.getStartPosition(),ae)}const se=w.getValueInRange(ie,1);let re;if(K===G||K+1===G)re=w.getValueInRange(D,1);else{const ae=q.intersectRanges(D),le=Q.intersectRanges(D);re=w.getValueInRange(ae,1)+"…"+w.getValueInRange(le,1)}return W&&re.length>2*500&&(re=re.substring(0,500)+"…"+re.substring(re.length-500,re.length)),new TextAreaState(X+re+se,X.length,X.length+re.length,D,Y.endLineNumber-Y.startLineNumber)}}var __decorate$X=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$U=function(F,w){return function(D,O){w(D,O,F)}},TextAreaSyntethicEvents;(function(F){F.Tap="-monaco-textarea-synthetic-tap"})(TextAreaSyntethicEvents||(TextAreaSyntethicEvents={}));class InMemoryClipboardMetadataManager{static{this.INSTANCE=new InMemoryClipboardMetadataManager}constructor(){this._lastState=null}set(w,D){this._lastState={lastCopiedValue:w,data:D}}get(w){return this._lastState&&this._lastState.lastCopiedValue===w?this._lastState.data:(this._lastState=null,null)}}class CompositionContext{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(w){w=w||"";const D={text:w,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=w.length,D}}let TextAreaInput=class extends Disposable{get textAreaState(){return this._textAreaState}constructor(w,D,O,W,U,K){super(),this._host=w,this._textArea=D,this._OS=O,this._browser=W,this._accessibilityService=U,this._logService=K,this._onFocus=this._register(new Emitter$1),this.onFocus=this._onFocus.event,this._onBlur=this._register(new Emitter$1),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new Emitter$1),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new Emitter$1),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new Emitter$1),this.onCut=this._onCut.event,this._onPaste=this._register(new Emitter$1),this.onPaste=this._onPaste.event,this._onType=this._register(new Emitter$1),this.onType=this._onType.event,this._onCompositionStart=this._register(new Emitter$1),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new Emitter$1),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new Emitter$1),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new Emitter$1),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncFocusGainWriteScreenReaderContent=this._register(new MutableDisposable),this._asyncTriggerCut=this._register(new RunOnceScheduler(()=>this._onCut.fire(),0)),this._textAreaState=TextAreaState.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(Event$1.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new RunOnceScheduler(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let q=null;this._register(this._textArea.onKeyDown(G=>{const Q=new StandardKeyboardEvent(G);(Q.keyCode===114||this._currentComposition&&Q.keyCode===1)&&Q.stopPropagation(),Q.equals(9)&&Q.preventDefault(),q=Q,this._onKeyDown.fire(Q)})),this._register(this._textArea.onKeyUp(G=>{const Q=new StandardKeyboardEvent(G);this._onKeyUp.fire(Q)})),this._register(this._textArea.onCompositionStart(G=>{const Q=new CompositionContext;if(this._currentComposition){this._currentComposition=Q;return}if(this._currentComposition=Q,this._OS===2&&q&&q.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===G.data&&(q.code==="ArrowRight"||q.code==="ArrowLeft")){Q.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:G.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:G.data});return}this._onCompositionStart.fire({data:G.data})})),this._register(this._textArea.onCompositionUpdate(G=>{const Q=this._currentComposition;if(!Q)return;if(this._browser.isAndroid){const X=TextAreaState.readFromTextArea(this._textArea,this._textAreaState),J=TextAreaState.deduceAndroidCompositionInput(this._textAreaState,X);this._textAreaState=X,this._onType.fire(J),this._onCompositionUpdate.fire(G);return}const Y=Q.handleCompositionUpdate(G.data);this._textAreaState=TextAreaState.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(Y),this._onCompositionUpdate.fire(G)})),this._register(this._textArea.onCompositionEnd(G=>{const Q=this._currentComposition;if(!Q)return;if(this._currentComposition=null,this._browser.isAndroid){const X=TextAreaState.readFromTextArea(this._textArea,this._textAreaState),J=TextAreaState.deduceAndroidCompositionInput(this._textAreaState,X);this._textAreaState=X,this._onType.fire(J),this._onCompositionEnd.fire();return}const Y=Q.handleCompositionUpdate(G.data);this._textAreaState=TextAreaState.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(Y),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(G=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const Q=TextAreaState.readFromTextArea(this._textArea,this._textAreaState),Y=TextAreaState.deduceInput(this._textAreaState,Q,this._OS===2);Y.replacePrevCharCnt===0&&Y.text.length===1&&(isHighSurrogate(Y.text.charCodeAt(0))||Y.text.charCodeAt(0)===127)||(this._textAreaState=Q,(Y.text!==""||Y.replacePrevCharCnt!==0||Y.replaceNextCharCnt!==0||Y.positionDelta!==0)&&this._onType.fire(Y))})),this._register(this._textArea.onCut(G=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(G),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(G=>{this._ensureClipboardGetsEditorSelection(G)})),this._register(this._textArea.onPaste(G=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),G.preventDefault(),!G.clipboardData)return;let[Q,Y]=ClipboardEventUtils.getTextData(G.clipboardData);Q&&(Y=Y||InMemoryClipboardMetadataManager.INSTANCE.get(Q),this._onPaste.fire({text:Q,metadata:Y}))})),this._register(this._textArea.onFocus(()=>{const G=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!G&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new RunOnceScheduler(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_installSelectionChangeListener(){let w=0;return addDisposableListener(this._textArea.ownerDocument,"selectionchange",D=>{if(inputLatency.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;const O=Date.now(),W=O-w;if(w=O,W<5)return;const U=O-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),U<100||!this._textAreaState.selection)return;const K=this._textArea.getValue();if(this._textAreaState.value!==K)return;const q=this._textArea.getSelectionStart(),G=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===q&&this._textAreaState.selectionEnd===G)return;const Q=this._textAreaState.deduceEditorPosition(q),Y=this._host.deduceModelPosition(Q[0],Q[1],Q[2]),X=this._textAreaState.deduceEditorPosition(G),J=this._host.deduceModelPosition(X[0],X[1],X[2]),te=new Selection$1(Y.lineNumber,Y.column,J.lineNumber,J.column);this._onSelectionChangeRequest.fire(te)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(w){this._hasFocus!==w&&(this._hasFocus=w,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(w,D){this._hasFocus||(D=D.collapseSelection()),D.writeToTextArea(w,this._textArea,this._hasFocus),this._textAreaState=D}writeNativeTextAreaContent(w){!this._accessibilityService.isScreenReaderOptimized()&&w==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${w})`),this._setAndWriteTextAreaState(w,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(w){const D=this._host.getDataToCopy(),O={version:1,isFromEmptySelection:D.isFromEmptySelection,multicursorText:D.multicursorText,mode:D.mode};InMemoryClipboardMetadataManager.INSTANCE.set(this._browser.isFirefox?D.text.replace(/\r\n/g,`
`):D.text,O),w.preventDefault(),w.clipboardData&&ClipboardEventUtils.setTextData(w.clipboardData,D.text,D.html,O)}};TextAreaInput=__decorate$X([__param$U(4,IAccessibilityService),__param$U(5,ILogService)],TextAreaInput);const ClipboardEventUtils={getTextData(F){const w=F.getData(Mimes.text);let D=null;const O=F.getData("vscode-editor-data");if(typeof O=="string")try{D=JSON.parse(O),D.version!==1&&(D=null)}catch{}return w.length===0&&D===null&&F.files.length>0?[Array.prototype.slice.call(F.files,0).map(U=>U.name).join(`
`),null]:[w,D]},setTextData(F,w,D,O){F.setData(Mimes.text,w),typeof D=="string"&&F.setData("text/html",D),F.setData("vscode-editor-data",JSON.stringify(O))}};class TextAreaWrapper extends Disposable{get ownerDocument(){return this._actual.ownerDocument}constructor(w){super(),this._actual=w,this.onKeyDown=this._register(new DomEmitter(this._actual,"keydown")).event,this.onKeyUp=this._register(new DomEmitter(this._actual,"keyup")).event,this.onCompositionStart=this._register(new DomEmitter(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(new DomEmitter(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(new DomEmitter(this._actual,"compositionend")).event,this.onBeforeInput=this._register(new DomEmitter(this._actual,"beforeinput")).event,this.onInput=this._register(new DomEmitter(this._actual,"input")).event,this.onCut=this._register(new DomEmitter(this._actual,"cut")).event,this.onCopy=this._register(new DomEmitter(this._actual,"copy")).event,this.onPaste=this._register(new DomEmitter(this._actual,"paste")).event,this.onFocus=this._register(new DomEmitter(this._actual,"focus")).event,this.onBlur=this._register(new DomEmitter(this._actual,"blur")).event,this._onSyntheticTap=this._register(new Emitter$1),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>inputLatency.onKeyDown())),this._register(this.onBeforeInput(()=>inputLatency.onBeforeInput())),this._register(this.onInput(()=>inputLatency.onInput())),this._register(this.onKeyUp(()=>inputLatency.onKeyUp())),this._register(addDisposableListener(this._actual,TextAreaSyntethicEvents.Tap,()=>this._onSyntheticTap.fire()))}hasFocus(){const w=getShadowRoot(this._actual);return w?w.activeElement===this._actual:this._actual.isConnected?getActiveElement()===this._actual:!1}setIgnoreSelectionChangeTime(w){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(w,D){const O=this._actual;O.value!==D&&(this.setIgnoreSelectionChangeTime("setValue"),O.value=D)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(w,D,O){const W=this._actual;let U=null;const K=getShadowRoot(W);K?U=K.activeElement:U=getActiveElement();const q=getWindow(U),G=U===W,Q=W.selectionStart,Y=W.selectionEnd;if(G&&Q===D&&Y===O){isFirefox$1&&q.parent!==q&&W.focus();return}if(G){this.setIgnoreSelectionChangeTime("setSelectionRange"),W.setSelectionRange(D,O),isFirefox$1&&q.parent!==q&&W.focus();return}try{const X=saveParentsScrollTop(W);this.setIgnoreSelectionChangeTime("setSelectionRange"),W.focus(),W.setSelectionRange(D,O),restoreParentsScrollTop(W,X)}catch{}}}class PointerEventHandler extends MouseHandler{constructor(w,D,O){super(w,D,O),this._register(Gesture.addTarget(this.viewHelper.linesContentDomNode)),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Tap,U=>this.onTap(U))),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Change,U=>this.onChange(U))),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Contextmenu,U=>this._onContextMenu(new EditorMouseEvent(U,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(addDisposableListener(this.viewHelper.linesContentDomNode,"pointerdown",U=>{const K=U.pointerType;if(K==="mouse"){this._lastPointerType="mouse";return}else K==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));const W=new EditorPointerEventFactory(this.viewHelper.viewDomNode);this._register(W.onPointerMove(this.viewHelper.viewDomNode,U=>this._onMouseMove(U))),this._register(W.onPointerUp(this.viewHelper.viewDomNode,U=>this._onMouseUp(U))),this._register(W.onPointerLeave(this.viewHelper.viewDomNode,U=>this._onMouseLeave(U))),this._register(W.onPointerDown(this.viewHelper.viewDomNode,(U,K)=>this._onMouseDown(U,K)))}onTap(w){!w.initialTarget||!this.viewHelper.linesContentDomNode.contains(w.initialTarget)||(w.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(w,!1))}onChange(w){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-w.translationX,-w.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(w,!0)}_dispatchGesture(w,D){const O=this._createMouseTarget(new EditorMouseEvent(w,!1,this.viewHelper.viewDomNode),!1);O.position&&this.viewController.dispatchMouse({position:O.position,mouseColumn:O.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:w.tapCount,inSelectionMode:D,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:O.type===6&&O.detail.injectedText!==null})}_onMouseDown(w,D){w.browserEvent.pointerType!=="touch"&&super._onMouseDown(w,D)}}class TouchHandler extends MouseHandler{constructor(w,D,O){super(w,D,O),this._register(Gesture.addTarget(this.viewHelper.linesContentDomNode)),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Tap,W=>this.onTap(W))),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Change,W=>this.onChange(W))),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Contextmenu,W=>this._onContextMenu(new EditorMouseEvent(W,!1,this.viewHelper.viewDomNode),!1)))}onTap(w){w.preventDefault(),this.viewHelper.focusTextArea();const D=this._createMouseTarget(new EditorMouseEvent(w,!1,this.viewHelper.viewDomNode),!1);if(D.position){const O=document.createEvent("CustomEvent");O.initEvent(TextAreaSyntethicEvents.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(O),this.viewController.moveTo(D.position,1)}}onChange(w){this._context.viewModel.viewLayout.deltaScrollNow(-w.translationX,-w.translationY)}}class PointerHandler extends Disposable{constructor(w,D,O){super(),(isIOS||isAndroid&&isMobile)&&BrowserFeatures.pointerEvents?this.handler=this._register(new PointerEventHandler(w,D,O)):mainWindow.TouchEvent?this.handler=this._register(new TouchHandler(w,D,O)):this.handler=this._register(new MouseHandler(w,D,O))}getTargetAtClientPoint(w,D){return this.handler.getTargetAtClientPoint(w,D)}}class DynamicViewOverlay extends ViewEventHandler{}class LineNumbersOverlay extends DynamicViewOverlay{static{this.CLASS_NAME="line-numbers"}constructor(w){super(),this._context=w,this._readConfig(),this._lastCursorModelPosition=new Position$1(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const w=this._context.configuration.options;this._lineHeight=w.get(67);const D=w.get(68);this._renderLineNumbers=D.renderType,this._renderCustomLineNumbers=D.renderFn,this._renderFinalNewline=w.get(96);const O=w.get(146);this._lineNumbersLeft=O.lineNumbersLeft,this._lineNumbersWidth=O.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(w){return this._readConfig(),!0}onCursorStateChanged(w){const D=w.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(D);let O=!1;return this._activeLineNumber!==D.lineNumber&&(this._activeLineNumber=D.lineNumber,O=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(O=!0),O}onFlushed(w){return!0}onLinesChanged(w){return!0}onLinesDeleted(w){return!0}onLinesInserted(w){return!0}onScrollChanged(w){return w.scrollTopChanged}onZonesChanged(w){return!0}onDecorationsChanged(w){return w.affectsLineNumber}_getLineRenderLineNumber(w){const D=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(w,1));if(D.column!==1)return"";const O=D.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(O);if(this._renderLineNumbers===2){const W=Math.abs(this._lastCursorModelPosition.lineNumber-O);return W===0?'<span class="relative-current-line-number">'+O+"</span>":String(W)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===O||O%10===0)return String(O);const W=this._context.viewModel.getLineCount();return O===W?String(O):""}return String(O)}prepareRender(w){if(this._renderLineNumbers===0){this._renderResult=null;return}const D=isLinux?this._lineHeight%2===0?" lh-even":" lh-odd":"",O=w.visibleRange.startLineNumber,W=w.visibleRange.endLineNumber,U=this._context.viewModel.getDecorationsInViewport(w.visibleRange).filter(Q=>!!Q.options.lineNumberClassName);U.sort((Q,Y)=>Range$2.compareRangesUsingEnds(Q.range,Y.range));let K=0;const q=this._context.viewModel.getLineCount(),G=[];for(let Q=O;Q<=W;Q++){const Y=Q-O;let X=this._getLineRenderLineNumber(Q),J="";for(;K<U.length&&U[K].range.endLineNumber<Q;)K++;for(let te=K;te<U.length;te++){const{range:ie,options:se}=U[te];ie.startLineNumber<=Q&&(J+=" "+se.lineNumberClassName)}if(!X&&!J){G[Y]="";continue}Q===q&&this._context.viewModel.getLineLength(Q)===0&&(this._renderFinalNewline==="off"&&(X=""),this._renderFinalNewline==="dimmed"&&(J+=" dimmed-line-number")),Q===this._activeLineNumber&&(J+=" active-line-number"),G[Y]=`<div class="${LineNumbersOverlay.CLASS_NAME}${D}${J}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${X}</div>`}this._renderResult=G}render(w,D){if(!this._renderResult)return"";const O=D-w;return O<0||O>=this._renderResult.length?"":this._renderResult[O]}}registerThemingParticipant((F,w)=>{const D=F.getColor(editorLineNumbers),O=F.getColor(editorDimmedLineNumber);O?w.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${O}; }`):D&&w.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${D.transparent(.4)}; }`)});class Margin extends ViewPart{static{this.CLASS_NAME="glyph-margin"}static{this.OUTER_CLASS_NAME="margin"}constructor(w){super(w);const D=this._context.configuration.options,O=D.get(146);this._canUseLayerHinting=!D.get(32),this._contentLeft=O.contentLeft,this._glyphMarginLeft=O.glyphMarginLeft,this._glyphMarginWidth=O.glyphMarginWidth,this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setClassName(Margin.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=createFastDomNode(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(Margin.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(w){const D=this._context.configuration.options,O=D.get(146);return this._canUseLayerHinting=!D.get(32),this._contentLeft=O.contentLeft,this._glyphMarginLeft=O.glyphMarginLeft,this._glyphMarginWidth=O.glyphMarginWidth,!0}onScrollChanged(w){return super.onScrollChanged(w)||w.scrollTopChanged}prepareRender(w){}render(w){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const D=w.scrollTop-w.bigNumbersDelta;this._domNode.setTop(-D);const O=Math.min(w.scrollHeight,1e6);this._domNode.setHeight(O),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(O)}}const MOUSE_CURSOR_TEXT_CSS_CLASS_NAME="monaco-mouse-cursor-text";class IMEImpl{constructor(){this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event,this._enabled=!0}get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}}const IME=new IMEImpl,IKeybindingService=createDecorator("keybindingService");var __decorate$W=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$T=function(F,w){return function(D,O){w(D,O,F)}};class VisibleTextAreaData{constructor(w,D,O,W,U){this._context=w,this.modelLineNumber=D,this.distanceToModelLineStart=O,this.widthOfHiddenLineTextBefore=W,this.distanceToModelLineEnd=U,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(w){const D=new Position$1(this.modelLineNumber,this.distanceToModelLineStart+1),O=new Position$1(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(D),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(O),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=w.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=w.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(w){return this._previousPresentation||(w?this._previousPresentation=w:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const canUseZeroSizeTextarea=isFirefox$1;let TextAreaHandler=class extends ViewPart{constructor(w,D,O,W,U){super(w),this._keybindingService=W,this._instantiationService=U,this._primaryCursorPosition=new Position$1(1,1),this._primaryCursorVisibleRange=null,this._viewController=D,this._visibleRangeProvider=O,this._scrollLeft=0,this._scrollTop=0;const K=this._context.configuration.options,q=K.get(146);this._setAccessibilityOptions(K),this._contentLeft=q.contentLeft,this._contentWidth=q.contentWidth,this._contentHeight=q.height,this._fontInfo=K.get(50),this._lineHeight=K.get(67),this._emptySelectionClipboard=K.get(37),this._copyWithSyntaxHighlighting=K.get(25),this._visibleTextArea=null,this._selections=[new Selection$1(1,1,1,1)],this._modelSelections=[new Selection$1(1,1,1,1)],this._lastRenderPosition=null,this.textArea=createFastDomNode(document.createElement("textarea")),PartFingerprints.write(this.textArea,7),this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:G}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${G*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(K)),this.textArea.setAttribute("aria-required",K.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(K.get(125))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",localize("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",K.get(92)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=createFastDomNode(document.createElement("div")),this.textAreaCover.setPosition("absolute");const Q={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:J=>this._context.viewModel.getLineMaxColumn(J),getValueInRange:(J,te)=>this._context.viewModel.getValueInRange(J,te),getValueLengthInRange:(J,te)=>this._context.viewModel.getValueLengthInRange(J,te),modifyPosition:(J,te)=>this._context.viewModel.modifyPosition(J,te)},Y={getDataToCopy:()=>{const J=this._context.viewModel.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,isWindows),te=this._context.viewModel.model.getEOL(),ie=this._emptySelectionClipboard&&this._modelSelections.length===1&&this._modelSelections[0].isEmpty(),se=Array.isArray(J)?J:null,re=Array.isArray(J)?J.join(te):J;let ae,le=null;if(this._copyWithSyntaxHighlighting&&re.length<65536){const de=this._context.viewModel.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);de&&(ae=de.html,le=de.mode)}return{isFromEmptySelection:ie,multicursorText:se,text:re,html:ae,mode:le}},getScreenReaderContent:()=>{if(this._accessibilitySupport===1){const J=this._selections[0];if(isMacintosh&&J.isEmpty()){const ie=J.getStartPosition();let se=this._getWordBeforePosition(ie);if(se.length===0&&(se=this._getCharacterBeforePosition(ie)),se.length>0)return new TextAreaState(se,se.length,se.length,Range$2.fromPositions(ie),0)}if(isMacintosh&&!J.isEmpty()&&Q.getValueLengthInRange(J,0)<500){const ie=Q.getValueInRange(J,0);return new TextAreaState(ie,0,ie.length,J,0)}if(isSafari$1&&!J.isEmpty()){const ie="vscode-placeholder";return new TextAreaState(ie,0,ie.length,null,void 0)}return TextAreaState.EMPTY}if(isAndroid$1){const J=this._selections[0];if(J.isEmpty()){const te=J.getStartPosition(),[ie,se]=this._getAndroidWordAtPosition(te);if(ie.length>0)return new TextAreaState(ie,se,se,Range$2.fromPositions(te),0)}return TextAreaState.EMPTY}return PagedScreenReaderStrategy.fromEditorSelection(Q,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0)},deduceModelPosition:(J,te,ie)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(J,te,ie)},X=this._register(new TextAreaWrapper(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(TextAreaInput,Y,X,OS,{isAndroid:isAndroid$1,isChrome:isChrome$1,isFirefox:isFirefox$1,isSafari:isSafari$1})),this._register(this._textAreaInput.onKeyDown(J=>{this._viewController.emitKeyDown(J)})),this._register(this._textAreaInput.onKeyUp(J=>{this._viewController.emitKeyUp(J)})),this._register(this._textAreaInput.onPaste(J=>{let te=!1,ie=null,se=null;J.metadata&&(te=this._emptySelectionClipboard&&!!J.metadata.isFromEmptySelection,ie=typeof J.metadata.multicursorText<"u"?J.metadata.multicursorText:null,se=J.metadata.mode),this._viewController.paste(J.text,te,ie,se)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(J=>{J.replacePrevCharCnt||J.replaceNextCharCnt||J.positionDelta?this._viewController.compositionType(J.text,J.replacePrevCharCnt,J.replaceNextCharCnt,J.positionDelta):this._viewController.type(J.text)})),this._register(this._textAreaInput.onSelectionChangeRequest(J=>{this._viewController.setSelection(J)})),this._register(this._textAreaInput.onCompositionStart(J=>{const te=this.textArea.domNode,ie=this._modelSelections[0],{distanceToModelLineStart:se,widthOfHiddenTextBefore:re}=(()=>{const le=te.value.substring(0,Math.min(te.selectionStart,te.selectionEnd)),de=le.lastIndexOf(`
`),oe=le.substring(de+1),ue=oe.lastIndexOf("	"),pe=oe.length-ue-1,fe=ie.getStartPosition(),Ce=Math.min(fe.column-1,pe),we=fe.column-1-Ce,Oe=oe.substring(0,oe.length-Ce),{tabSize:Te}=this._context.viewModel.model.getOptions(),Re=measureText(this.textArea.domNode.ownerDocument,Oe,this._fontInfo,Te);return{distanceToModelLineStart:we,widthOfHiddenTextBefore:Re}})(),{distanceToModelLineEnd:ae}=(()=>{const le=te.value.substring(Math.max(te.selectionStart,te.selectionEnd)),de=le.indexOf(`
`),oe=de===-1?le:le.substring(0,de),ue=oe.indexOf("	"),pe=ue===-1?oe.length:oe.length-ue-1,fe=ie.getEndPosition(),Ce=Math.min(this._context.viewModel.model.getLineMaxColumn(fe.lineNumber)-fe.column,pe);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(fe.lineNumber)-fe.column-Ce}})();this._context.viewModel.revealRange("keyboard",!0,Range$2.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new VisibleTextAreaData(this._context,ie.startLineNumber,se,re,ae),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(J=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(IME.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}writeScreenReaderContent(w){this._textAreaInput.writeNativeTextAreaContent(w)}dispose(){super.dispose()}_getAndroidWordAtPosition(w){const D='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',O=this._context.viewModel.getLineContent(w.lineNumber),W=getMapForWordSeparators(D,[]);let U=!0,K=w.column,q=!0,G=w.column,Q=0;for(;Q<50&&(U||q);){if(U&&K<=1&&(U=!1),U){const Y=O.charCodeAt(K-2);W.get(Y)!==0?U=!1:K--}if(q&&G>O.length&&(q=!1),q){const Y=O.charCodeAt(G-1);W.get(Y)!==0?q=!1:G++}Q++}return[O.substring(K-1,G-1),w.column-K]}_getWordBeforePosition(w){const D=this._context.viewModel.getLineContent(w.lineNumber),O=getMapForWordSeparators(this._context.configuration.options.get(132),[]);let W=w.column,U=0;for(;W>1;){const K=D.charCodeAt(W-2);if(O.get(K)!==0||U>50)return D.substring(W-1,w.column-1);U++,W--}return D.substring(0,w.column-1)}_getCharacterBeforePosition(w){if(w.column>1){const O=this._context.viewModel.getLineContent(w.lineNumber).charAt(w.column-2);if(!isHighSurrogate(O.charCodeAt(0)))return O}return""}_getAriaLabel(w){if(w.get(2)===1){const O=this._keybindingService.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),W=this._keybindingService.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),U=this._keybindingService.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),K=localize("accessibilityModeOff","The editor is not accessible at this time.");return O?localize("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",K,O):W?localize("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",K,W):U?localize("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",K,U):K}return w.get(4)}_setAccessibilityOptions(w){this._accessibilitySupport=w.get(2);const D=w.get(3);this._accessibilitySupport===2&&D===EditorOptions.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=D;const W=w.get(146).wrappingColumn;if(W!==-1&&this._accessibilitySupport!==1){const U=w.get(50);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(W*U.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=canUseZeroSizeTextarea?0:1}onConfigurationChanged(w){const D=this._context.configuration.options,O=D.get(146);this._setAccessibilityOptions(D),this._contentLeft=O.contentLeft,this._contentWidth=O.contentWidth,this._contentHeight=O.height,this._fontInfo=D.get(50),this._lineHeight=D.get(67),this._emptySelectionClipboard=D.get(37),this._copyWithSyntaxHighlighting=D.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:W}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${W*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",this._getAriaLabel(D)),this.textArea.setAttribute("aria-required",D.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(D.get(125))),(w.hasChanged(34)||w.hasChanged(92))&&this._ensureReadOnlyAttribute(),w.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(w){return this._selections=w.selections.slice(0),this._modelSelections=w.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(w){return!0}onFlushed(w){return!0}onLinesChanged(w){return!0}onLinesDeleted(w){return!0}onLinesInserted(w){return!0}onScrollChanged(w){return this._scrollLeft=w.scrollLeft,this._scrollTop=w.scrollTop,!0}onZonesChanged(w){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(w){w.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",w.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),w.role&&this.textArea.setAttribute("role",w.role)}_ensureReadOnlyAttribute(){const w=this._context.configuration.options;!IME.enabled||w.get(34)&&w.get(92)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}prepareRender(w){this._primaryCursorPosition=new Position$1(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=w.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(w)}render(w){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){const O=this._visibleTextArea.visibleTextareaStart,W=this._visibleTextArea.visibleTextareaEnd,U=this._visibleTextArea.startPosition,K=this._visibleTextArea.endPosition;if(U&&K&&O&&W&&W.left>=this._scrollLeft&&O.left<=this._scrollLeft+this._contentWidth){const q=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,G=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let Q=this._visibleTextArea.widthOfHiddenLineTextBefore,Y=this._contentLeft+O.left-this._scrollLeft,X=W.left-O.left+1;if(Y<this._contentLeft){const ae=this._contentLeft-Y;Y+=ae,Q+=ae,X-=ae}X>this._contentWidth&&(X=this._contentWidth);const J=this._context.viewModel.getViewLineData(U.lineNumber),te=J.tokens.findTokenIndexAtOffset(U.column-1),ie=J.tokens.findTokenIndexAtOffset(K.column-1),se=te===ie,re=this._visibleTextArea.definePresentation(se?J.tokens.getPresentation(te):null);this.textArea.domNode.scrollTop=G*this._lineHeight,this.textArea.domNode.scrollLeft=Q,this._doRender({lastRenderPosition:null,top:q,left:Y,width:X,height:this._lineHeight,useCover:!1,color:(TokenizationRegistry.getColorMap()||[])[re.foreground],italic:re.italic,bold:re.bold,underline:re.underline,strikethrough:re.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const w=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(w<this._contentLeft||w>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const D=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(D<0||D>this._contentHeight){this._renderAtTopLeft();return}if(isMacintosh||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:D,left:this._textAreaWrapping?this._contentLeft:w,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const O=this._textAreaInput.textAreaState.newlineCountBeforeSelection??this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=O*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:D,left:this._textAreaWrapping?this._contentLeft:w,width:this._textAreaWidth,height:canUseZeroSizeTextarea?0:1,useCover:!1})}_newlinecount(w){let D=0,O=-1;do{if(O=w.indexOf(`
`,O+1),O===-1)break;D++}while(!0);return D}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:canUseZeroSizeTextarea?0:1,useCover:!0})}_doRender(w){this._lastRenderPosition=w.lastRenderPosition;const D=this.textArea,O=this.textAreaCover;applyFontInfo(D,this._fontInfo),D.setTop(w.top),D.setLeft(w.left),D.setWidth(w.width),D.setHeight(w.height),D.setColor(w.color?Color.Format.CSS.formatHex(w.color):""),D.setFontStyle(w.italic?"italic":""),w.bold&&D.setFontWeight("bold"),D.setTextDecoration(`${w.underline?" underline":""}${w.strikethrough?" line-through":""}`),O.setTop(w.useCover?w.top:0),O.setLeft(w.useCover?w.left:0),O.setWidth(w.useCover?w.width:0),O.setHeight(w.useCover?w.height:0);const W=this._context.configuration.options;W.get(57)?O.setClassName("monaco-editor-background textAreaCover "+Margin.OUTER_CLASS_NAME):W.get(68).renderType!==0?O.setClassName("monaco-editor-background textAreaCover "+LineNumbersOverlay.CLASS_NAME):O.setClassName("monaco-editor-background textAreaCover")}};TextAreaHandler=__decorate$W([__param$T(3,IKeybindingService),__param$T(4,IInstantiationService)],TextAreaHandler);function measureText(F,w,D,O){if(w.length===0)return 0;const W=F.createElement("div");W.style.position="absolute",W.style.top="-50000px",W.style.width="50000px";const U=F.createElement("span");applyFontInfo(U,D),U.style.whiteSpace="pre",U.style.tabSize=`${O*D.spaceWidth}px`,U.append(w),W.appendChild(U),F.body.appendChild(W);const K=U.offsetWidth;return W.remove(),K}const autoCloseAlways=()=>!0,autoCloseNever=()=>!1,autoCloseBeforeWhitespace=F=>F===" "||F==="	";class CursorConfiguration{static shouldRecreate(w){return w.hasChanged(146)||w.hasChanged(132)||w.hasChanged(37)||w.hasChanged(77)||w.hasChanged(79)||w.hasChanged(80)||w.hasChanged(6)||w.hasChanged(7)||w.hasChanged(11)||w.hasChanged(9)||w.hasChanged(10)||w.hasChanged(14)||w.hasChanged(129)||w.hasChanged(50)||w.hasChanged(92)||w.hasChanged(131)}constructor(w,D,O,W){this.languageConfigurationService=W,this._cursorMoveConfigurationBrand=void 0,this._languageId=w;const U=O.options,K=U.get(146),q=U.get(50);this.readOnly=U.get(92),this.tabSize=D.tabSize,this.indentSize=D.indentSize,this.insertSpaces=D.insertSpaces,this.stickyTabStops=U.get(117),this.lineHeight=q.lineHeight,this.typicalHalfwidthCharacterWidth=q.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(K.height/this.lineHeight)-2),this.useTabStops=U.get(129),this.wordSeparators=U.get(132),this.emptySelectionClipboard=U.get(37),this.copyWithSyntaxHighlighting=U.get(25),this.multiCursorMergeOverlapping=U.get(77),this.multiCursorPaste=U.get(79),this.multiCursorLimit=U.get(80),this.autoClosingBrackets=U.get(6),this.autoClosingComments=U.get(7),this.autoClosingQuotes=U.get(11),this.autoClosingDelete=U.get(9),this.autoClosingOvertype=U.get(10),this.autoSurround=U.get(14),this.autoIndent=U.get(12),this.wordSegmenterLocales=U.get(131),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(w,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(w,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(w,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(w).getAutoClosingPairs();const G=this.languageConfigurationService.getLanguageConfiguration(w).getSurroundingPairs();if(G)for(const Y of G)this.surroundingPairs[Y.open]=Y.close;const Q=this.languageConfigurationService.getLanguageConfiguration(w).comments;this.blockCommentStartToken=Q?.blockCommentStartToken??null}get electricChars(){if(!this._electricChars){this._electricChars={};const w=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(w)for(const D of w)this._electricChars[D]=!0}return this._electricChars}onElectricCharacter(w,D,O){const W=createScopedLineTokens(D,O-1),U=this.languageConfigurationService.getLanguageConfiguration(W.languageId).electricCharacter;return U?U.onElectricCharacter(w,W,O-W.firstCharOffset):null}normalizeIndentation(w){return normalizeIndentation(w,this.indentSize,this.insertSpaces)}_getShouldAutoClose(w,D,O){switch(D){case"beforeWhitespace":return autoCloseBeforeWhitespace;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(w,O);case"always":return autoCloseAlways;case"never":return autoCloseNever}}_getLanguageDefinedShouldAutoClose(w,D){const O=this.languageConfigurationService.getLanguageConfiguration(w).getAutoCloseBeforeSet(D);return W=>O.indexOf(W)!==-1}visibleColumnFromColumn(w,D){return CursorColumns.visibleColumnFromColumn(w.getLineContent(D.lineNumber),D.column,this.tabSize)}columnFromVisibleColumn(w,D,O){const W=CursorColumns.columnFromVisibleColumn(w.getLineContent(D),O,this.tabSize),U=w.getLineMinColumn(D);if(W<U)return U;const K=w.getLineMaxColumn(D);return W>K?K:W}}class CursorState{static fromModelState(w){return new PartialModelCursorState(w)}static fromViewState(w){return new PartialViewCursorState(w)}static fromModelSelection(w){const D=Selection$1.liftSelection(w),O=new SingleCursorState(Range$2.fromPositions(D.getSelectionStart()),0,0,D.getPosition(),0);return CursorState.fromModelState(O)}static fromModelSelections(w){const D=[];for(let O=0,W=w.length;O<W;O++)D[O]=this.fromModelSelection(w[O]);return D}constructor(w,D){this._cursorStateBrand=void 0,this.modelState=w,this.viewState=D}equals(w){return this.viewState.equals(w.viewState)&&this.modelState.equals(w.modelState)}}class PartialModelCursorState{constructor(w){this.modelState=w,this.viewState=null}}class PartialViewCursorState{constructor(w){this.modelState=null,this.viewState=w}}class SingleCursorState{constructor(w,D,O,W,U){this.selectionStart=w,this.selectionStartKind=D,this.selectionStartLeftoverVisibleColumns=O,this.position=W,this.leftoverVisibleColumns=U,this._singleCursorStateBrand=void 0,this.selection=SingleCursorState._computeSelection(this.selectionStart,this.position)}equals(w){return this.selectionStartLeftoverVisibleColumns===w.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===w.leftoverVisibleColumns&&this.selectionStartKind===w.selectionStartKind&&this.position.equals(w.position)&&this.selectionStart.equalsRange(w.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(w,D,O,W){return w?new SingleCursorState(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new Position$1(D,O),W):new SingleCursorState(new Range$2(D,O,D,O),0,W,new Position$1(D,O),W)}static _computeSelection(w,D){return w.isEmpty()||!D.isBeforeOrEqual(w.getStartPosition())?Selection$1.fromPositions(w.getStartPosition(),D):Selection$1.fromPositions(w.getEndPosition(),D)}}class EditOperationResult{constructor(w,D,O){this._editOperationResultBrand=void 0,this.type=w,this.commands=D,this.shouldPushStackElementBefore=O.shouldPushStackElementBefore,this.shouldPushStackElementAfter=O.shouldPushStackElementAfter}}function isQuote(F){return F==="'"||F==='"'||F==="`"}class ColumnSelection{static columnSelect(w,D,O,W,U,K){const q=Math.abs(U-O)+1,G=O>U,Q=W>K,Y=W<K,X=[];for(let J=0;J<q;J++){const te=O+(G?-J:J),ie=w.columnFromVisibleColumn(D,te,W),se=w.columnFromVisibleColumn(D,te,K),re=w.visibleColumnFromColumn(D,new Position$1(te,ie)),ae=w.visibleColumnFromColumn(D,new Position$1(te,se));Y&&(re>K||ae<W)||Q&&(ae>W||re<K)||X.push(new SingleCursorState(new Range$2(te,ie,te,ie),0,0,new Position$1(te,se),0))}if(X.length===0)for(let J=0;J<q;J++){const te=O+(G?-J:J),ie=D.getLineMaxColumn(te);X.push(new SingleCursorState(new Range$2(te,ie,te,ie),0,0,new Position$1(te,ie),0))}return{viewStates:X,reversed:G,fromLineNumber:O,fromVisualColumn:W,toLineNumber:U,toVisualColumn:K}}static columnSelectLeft(w,D,O){let W=O.toViewVisualColumn;return W>0&&W--,ColumnSelection.columnSelect(w,D,O.fromViewLineNumber,O.fromViewVisualColumn,O.toViewLineNumber,W)}static columnSelectRight(w,D,O){let W=0;const U=Math.min(O.fromViewLineNumber,O.toViewLineNumber),K=Math.max(O.fromViewLineNumber,O.toViewLineNumber);for(let G=U;G<=K;G++){const Q=D.getLineMaxColumn(G),Y=w.visibleColumnFromColumn(D,new Position$1(G,Q));W=Math.max(W,Y)}let q=O.toViewVisualColumn;return q<W&&q++,this.columnSelect(w,D,O.fromViewLineNumber,O.fromViewVisualColumn,O.toViewLineNumber,q)}static columnSelectUp(w,D,O,W){const U=W?w.pageSize:1,K=Math.max(1,O.toViewLineNumber-U);return this.columnSelect(w,D,O.fromViewLineNumber,O.fromViewVisualColumn,K,O.toViewVisualColumn)}static columnSelectDown(w,D,O,W){const U=W?w.pageSize:1,K=Math.min(D.getLineCount(),O.toViewLineNumber+U);return this.columnSelect(w,D,O.fromViewLineNumber,O.fromViewVisualColumn,K,O.toViewVisualColumn)}}class ReplaceCommand{constructor(w,D,O=!1){this._range=w,this._text=D,this.insertsAutoWhitespace=O}getEditOperations(w,D){D.addTrackedEditOperation(this._range,this._text)}computeCursorState(w,D){const W=D.getInverseEditOperations()[0].range;return Selection$1.fromPositions(W.getEndPosition())}}class ReplaceCommandWithoutChangingPosition{constructor(w,D,O=!1){this._range=w,this._text=D,this.insertsAutoWhitespace=O}getEditOperations(w,D){D.addTrackedEditOperation(this._range,this._text)}computeCursorState(w,D){const W=D.getInverseEditOperations()[0].range;return Selection$1.fromPositions(W.getStartPosition())}}class ReplaceCommandWithOffsetCursorState{constructor(w,D,O,W,U=!1){this._range=w,this._text=D,this._columnDeltaOffset=W,this._lineNumberDeltaOffset=O,this.insertsAutoWhitespace=U}getEditOperations(w,D){D.addTrackedEditOperation(this._range,this._text)}computeCursorState(w,D){const W=D.getInverseEditOperations()[0].range;return Selection$1.fromPositions(W.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class ReplaceCommandThatPreservesSelection{constructor(w,D,O,W=!1){this._range=w,this._text=D,this._initialSelection=O,this._forceMoveMarkers=W,this._selectionId=null}getEditOperations(w,D){D.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=D.trackSelection(this._initialSelection)}computeCursorState(w,D){return D.getTrackedSelection(this._selectionId)}}class CursorPosition{constructor(w,D,O){this._cursorPositionBrand=void 0,this.lineNumber=w,this.column=D,this.leftoverVisibleColumns=O}}class MoveOperations{static leftPosition(w,D){if(D.column>w.getLineMinColumn(D.lineNumber))return D.delta(void 0,-prevCharLength(w.getLineContent(D.lineNumber),D.column-1));if(D.lineNumber>1){const O=D.lineNumber-1;return new Position$1(O,w.getLineMaxColumn(O))}else return D}static leftPositionAtomicSoftTabs(w,D,O){if(D.column<=w.getLineIndentColumn(D.lineNumber)){const W=w.getLineMinColumn(D.lineNumber),U=w.getLineContent(D.lineNumber),K=AtomicTabMoveOperations.atomicPosition(U,D.column-1,O,0);if(K!==-1&&K+1>=W)return new Position$1(D.lineNumber,K+1)}return this.leftPosition(w,D)}static left(w,D,O){const W=w.stickyTabStops?MoveOperations.leftPositionAtomicSoftTabs(D,O,w.tabSize):MoveOperations.leftPosition(D,O);return new CursorPosition(W.lineNumber,W.column,0)}static moveLeft(w,D,O,W,U){let K,q;if(O.hasSelection()&&!W)K=O.selection.startLineNumber,q=O.selection.startColumn;else{const G=O.position.delta(void 0,-(U-1)),Q=D.normalizePosition(MoveOperations.clipPositionColumn(G,D),0),Y=MoveOperations.left(w,D,Q);K=Y.lineNumber,q=Y.column}return O.move(W,K,q,0)}static clipPositionColumn(w,D){return new Position$1(w.lineNumber,MoveOperations.clipRange(w.column,D.getLineMinColumn(w.lineNumber),D.getLineMaxColumn(w.lineNumber)))}static clipRange(w,D,O){return w<D?D:w>O?O:w}static rightPosition(w,D,O){return O<w.getLineMaxColumn(D)?O=O+nextCharLength(w.getLineContent(D),O-1):D<w.getLineCount()&&(D=D+1,O=w.getLineMinColumn(D)),new Position$1(D,O)}static rightPositionAtomicSoftTabs(w,D,O,W,U){if(O<w.getLineIndentColumn(D)){const K=w.getLineContent(D),q=AtomicTabMoveOperations.atomicPosition(K,O-1,W,1);if(q!==-1)return new Position$1(D,q+1)}return this.rightPosition(w,D,O)}static right(w,D,O){const W=w.stickyTabStops?MoveOperations.rightPositionAtomicSoftTabs(D,O.lineNumber,O.column,w.tabSize,w.indentSize):MoveOperations.rightPosition(D,O.lineNumber,O.column);return new CursorPosition(W.lineNumber,W.column,0)}static moveRight(w,D,O,W,U){let K,q;if(O.hasSelection()&&!W)K=O.selection.endLineNumber,q=O.selection.endColumn;else{const G=O.position.delta(void 0,U-1),Q=D.normalizePosition(MoveOperations.clipPositionColumn(G,D),1),Y=MoveOperations.right(w,D,Q);K=Y.lineNumber,q=Y.column}return O.move(W,K,q,0)}static vertical(w,D,O,W,U,K,q,G){const Q=CursorColumns.visibleColumnFromColumn(D.getLineContent(O),W,w.tabSize)+U,Y=D.getLineCount(),X=O===1&&W===1,J=O===Y&&W===D.getLineMaxColumn(O),te=K<O?X:J;if(O=K,O<1?(O=1,q?W=D.getLineMinColumn(O):W=Math.min(D.getLineMaxColumn(O),W)):O>Y?(O=Y,q?W=D.getLineMaxColumn(O):W=Math.min(D.getLineMaxColumn(O),W)):W=w.columnFromVisibleColumn(D,O,Q),te?U=0:U=Q-CursorColumns.visibleColumnFromColumn(D.getLineContent(O),W,w.tabSize),G!==void 0){const ie=new Position$1(O,W),se=D.normalizePosition(ie,G);U=U+(W-se.column),O=se.lineNumber,W=se.column}return new CursorPosition(O,W,U)}static down(w,D,O,W,U,K,q){return this.vertical(w,D,O,W,U,O+K,q,4)}static moveDown(w,D,O,W,U){let K,q;O.hasSelection()&&!W?(K=O.selection.endLineNumber,q=O.selection.endColumn):(K=O.position.lineNumber,q=O.position.column);let G=0,Q;do if(Q=MoveOperations.down(w,D,K+G,q,O.leftoverVisibleColumns,U,!0),D.normalizePosition(new Position$1(Q.lineNumber,Q.column),2).lineNumber>K)break;while(G++<10&&K+G<D.getLineCount());return O.move(W,Q.lineNumber,Q.column,Q.leftoverVisibleColumns)}static translateDown(w,D,O){const W=O.selection,U=MoveOperations.down(w,D,W.selectionStartLineNumber,W.selectionStartColumn,O.selectionStartLeftoverVisibleColumns,1,!1),K=MoveOperations.down(w,D,W.positionLineNumber,W.positionColumn,O.leftoverVisibleColumns,1,!1);return new SingleCursorState(new Range$2(U.lineNumber,U.column,U.lineNumber,U.column),0,U.leftoverVisibleColumns,new Position$1(K.lineNumber,K.column),K.leftoverVisibleColumns)}static up(w,D,O,W,U,K,q){return this.vertical(w,D,O,W,U,O-K,q,3)}static moveUp(w,D,O,W,U){let K,q;O.hasSelection()&&!W?(K=O.selection.startLineNumber,q=O.selection.startColumn):(K=O.position.lineNumber,q=O.position.column);const G=MoveOperations.up(w,D,K,q,O.leftoverVisibleColumns,U,!0);return O.move(W,G.lineNumber,G.column,G.leftoverVisibleColumns)}static translateUp(w,D,O){const W=O.selection,U=MoveOperations.up(w,D,W.selectionStartLineNumber,W.selectionStartColumn,O.selectionStartLeftoverVisibleColumns,1,!1),K=MoveOperations.up(w,D,W.positionLineNumber,W.positionColumn,O.leftoverVisibleColumns,1,!1);return new SingleCursorState(new Range$2(U.lineNumber,U.column,U.lineNumber,U.column),0,U.leftoverVisibleColumns,new Position$1(K.lineNumber,K.column),K.leftoverVisibleColumns)}static _isBlankLine(w,D){return w.getLineFirstNonWhitespaceColumn(D)===0}static moveToPrevBlankLine(w,D,O,W){let U=O.position.lineNumber;for(;U>1&&this._isBlankLine(D,U);)U--;for(;U>1&&!this._isBlankLine(D,U);)U--;return O.move(W,U,D.getLineMinColumn(U),0)}static moveToNextBlankLine(w,D,O,W){const U=D.getLineCount();let K=O.position.lineNumber;for(;K<U&&this._isBlankLine(D,K);)K++;for(;K<U&&!this._isBlankLine(D,K);)K++;return O.move(W,K,D.getLineMinColumn(K),0)}static moveToBeginningOfLine(w,D,O,W){const U=O.position.lineNumber,K=D.getLineMinColumn(U),q=D.getLineFirstNonWhitespaceColumn(U)||K;let G;return O.position.column===q?G=K:G=q,O.move(W,U,G,0)}static moveToEndOfLine(w,D,O,W,U){const K=O.position.lineNumber,q=D.getLineMaxColumn(K);return O.move(W,K,q,U?1073741824-q:0)}static moveToBeginningOfBuffer(w,D,O,W){return O.move(W,1,1,0)}static moveToEndOfBuffer(w,D,O,W){const U=D.getLineCount(),K=D.getLineMaxColumn(U);return O.move(W,U,K,0)}}class DeleteOperations{static deleteRight(w,D,O,W){const U=[];let K=w!==3;for(let q=0,G=W.length;q<G;q++){const Q=W[q];let Y=Q;if(Y.isEmpty()){const X=Q.getPosition(),J=MoveOperations.right(D,O,X);Y=new Range$2(J.lineNumber,J.column,X.lineNumber,X.column)}if(Y.isEmpty()){U[q]=null;continue}Y.startLineNumber!==Y.endLineNumber&&(K=!0),U[q]=new ReplaceCommand(Y,"")}return[K,U]}static isAutoClosingPairDelete(w,D,O,W,U,K,q){if(D==="never"&&O==="never"||w==="never")return!1;for(let G=0,Q=K.length;G<Q;G++){const Y=K[G],X=Y.getPosition();if(!Y.isEmpty())return!1;const J=U.getLineContent(X.lineNumber);if(X.column<2||X.column>=J.length+1)return!1;const te=J.charAt(X.column-2),ie=W.get(te);if(!ie)return!1;if(isQuote(te)){if(O==="never")return!1}else if(D==="never")return!1;const se=J.charAt(X.column-1);let re=!1;for(const ae of ie)ae.open===te&&ae.close===se&&(re=!0);if(!re)return!1;if(w==="auto"){let ae=!1;for(let le=0,de=q.length;le<de;le++){const oe=q[le];if(X.lineNumber===oe.startLineNumber&&X.column===oe.startColumn){ae=!0;break}}if(!ae)return!1}}return!0}static _runAutoClosingPairDelete(w,D,O){const W=[];for(let U=0,K=O.length;U<K;U++){const q=O[U].getPosition(),G=new Range$2(q.lineNumber,q.column-1,q.lineNumber,q.column+1);W[U]=new ReplaceCommand(G,"")}return[!0,W]}static deleteLeft(w,D,O,W,U){if(this.isAutoClosingPairDelete(D.autoClosingDelete,D.autoClosingBrackets,D.autoClosingQuotes,D.autoClosingPairs.autoClosingPairsOpenByEnd,O,W,U))return this._runAutoClosingPairDelete(D,O,W);const K=[];let q=w!==2;for(let G=0,Q=W.length;G<Q;G++){const Y=DeleteOperations.getDeleteRange(W[G],O,D);if(Y.isEmpty()){K[G]=null;continue}Y.startLineNumber!==Y.endLineNumber&&(q=!0),K[G]=new ReplaceCommand(Y,"")}return[q,K]}static getDeleteRange(w,D,O){if(!w.isEmpty())return w;const W=w.getPosition();if(O.useTabStops&&W.column>1){const U=D.getLineContent(W.lineNumber),K=firstNonWhitespaceIndex(U),q=K===-1?U.length+1:K+1;if(W.column<=q){const G=O.visibleColumnFromColumn(D,W),Q=CursorColumns.prevIndentTabStop(G,O.indentSize),Y=O.columnFromVisibleColumn(D,W.lineNumber,Q);return new Range$2(W.lineNumber,Y,W.lineNumber,W.column)}}return Range$2.fromPositions(DeleteOperations.getPositionAfterDeleteLeft(W,D),W)}static getPositionAfterDeleteLeft(w,D){if(w.column>1){const O=getLeftDeleteOffset(w.column-1,D.getLineContent(w.lineNumber));return w.with(void 0,O+1)}else if(w.lineNumber>1){const O=w.lineNumber-1;return new Position$1(O,D.getLineMaxColumn(O))}else return w}static cut(w,D,O){const W=[];let U=null;O.sort((K,q)=>Position$1.compare(K.getStartPosition(),q.getEndPosition()));for(let K=0,q=O.length;K<q;K++){const G=O[K];if(G.isEmpty())if(w.emptySelectionClipboard){const Q=G.getPosition();let Y,X,J,te;Q.lineNumber<D.getLineCount()?(Y=Q.lineNumber,X=1,J=Q.lineNumber+1,te=1):Q.lineNumber>1&&U?.endLineNumber!==Q.lineNumber?(Y=Q.lineNumber-1,X=D.getLineMaxColumn(Q.lineNumber-1),J=Q.lineNumber,te=D.getLineMaxColumn(Q.lineNumber)):(Y=Q.lineNumber,X=1,J=Q.lineNumber,te=D.getLineMaxColumn(Q.lineNumber));const ie=new Range$2(Y,X,J,te);U=ie,ie.isEmpty()?W[K]=null:W[K]=new ReplaceCommand(ie,"")}else W[K]=null;else W[K]=new ReplaceCommand(G,"")}return new EditOperationResult(0,W,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class WordOperations{static _createWord(w,D,O,W,U){return{start:W,end:U,wordType:D,nextCharClass:O}}static _createIntlWord(w,D){return{start:w.index,end:w.index+w.segment.length,wordType:1,nextCharClass:D}}static _findPreviousWordOnLine(w,D,O){const W=D.getLineContent(O.lineNumber);return this._doFindPreviousWordOnLine(W,w,O)}static _doFindPreviousWordOnLine(w,D,O){let W=0;const U=D.findPrevIntlWordBeforeOrAtOffset(w,O.column-2);for(let K=O.column-2;K>=0;K--){const q=w.charCodeAt(K),G=D.get(q);if(U&&K===U.index)return this._createIntlWord(U,G);if(G===0){if(W===2)return this._createWord(w,W,G,K+1,this._findEndOfWord(w,D,W,K+1));W=1}else if(G===2){if(W===1)return this._createWord(w,W,G,K+1,this._findEndOfWord(w,D,W,K+1));W=2}else if(G===1&&W!==0)return this._createWord(w,W,G,K+1,this._findEndOfWord(w,D,W,K+1))}return W!==0?this._createWord(w,W,1,0,this._findEndOfWord(w,D,W,0)):null}static _findEndOfWord(w,D,O,W){const U=D.findNextIntlWordAtOrAfterOffset(w,W),K=w.length;for(let q=W;q<K;q++){const G=w.charCodeAt(q),Q=D.get(G);if(U&&q===U.index+U.segment.length||Q===1||O===1&&Q===2||O===2&&Q===0)return q}return K}static _findNextWordOnLine(w,D,O){const W=D.getLineContent(O.lineNumber);return this._doFindNextWordOnLine(W,w,O)}static _doFindNextWordOnLine(w,D,O){let W=0;const U=w.length,K=D.findNextIntlWordAtOrAfterOffset(w,O.column-1);for(let q=O.column-1;q<U;q++){const G=w.charCodeAt(q),Q=D.get(G);if(K&&q===K.index)return this._createIntlWord(K,Q);if(Q===0){if(W===2)return this._createWord(w,W,Q,this._findStartOfWord(w,D,W,q-1),q);W=1}else if(Q===2){if(W===1)return this._createWord(w,W,Q,this._findStartOfWord(w,D,W,q-1),q);W=2}else if(Q===1&&W!==0)return this._createWord(w,W,Q,this._findStartOfWord(w,D,W,q-1),q)}return W!==0?this._createWord(w,W,1,this._findStartOfWord(w,D,W,U-1),U):null}static _findStartOfWord(w,D,O,W){const U=D.findPrevIntlWordBeforeOrAtOffset(w,W);for(let K=W;K>=0;K--){const q=w.charCodeAt(K),G=D.get(q);if(U&&K===U.index)return K;if(G===1||O===1&&G===2||O===2&&G===0)return K+1}return 0}static moveWordLeft(w,D,O,W,U){let K=O.lineNumber,q=O.column;q===1&&K>1&&(K=K-1,q=D.getLineMaxColumn(K));let G=WordOperations._findPreviousWordOnLine(w,D,new Position$1(K,q));if(W===0)return new Position$1(K,G?G.start+1:1);if(W===1)return!U&&G&&G.wordType===2&&G.end-G.start===1&&G.nextCharClass===0&&(G=WordOperations._findPreviousWordOnLine(w,D,new Position$1(K,G.start+1))),new Position$1(K,G?G.start+1:1);if(W===3){for(;G&&G.wordType===2;)G=WordOperations._findPreviousWordOnLine(w,D,new Position$1(K,G.start+1));return new Position$1(K,G?G.start+1:1)}return G&&q<=G.end+1&&(G=WordOperations._findPreviousWordOnLine(w,D,new Position$1(K,G.start+1))),new Position$1(K,G?G.end+1:1)}static _moveWordPartLeft(w,D){const O=D.lineNumber,W=w.getLineMaxColumn(O);if(D.column===1)return O>1?new Position$1(O-1,w.getLineMaxColumn(O-1)):D;const U=w.getLineContent(O);for(let K=D.column-1;K>1;K--){const q=U.charCodeAt(K-2),G=U.charCodeAt(K-1);if(q===95&&G!==95)return new Position$1(O,K);if(q===45&&G!==45)return new Position$1(O,K);if((isLowerAsciiLetter(q)||isAsciiDigit(q))&&isUpperAsciiLetter(G))return new Position$1(O,K);if(isUpperAsciiLetter(q)&&isUpperAsciiLetter(G)&&K+1<W){const Q=U.charCodeAt(K);if(isLowerAsciiLetter(Q)||isAsciiDigit(Q))return new Position$1(O,K)}}return new Position$1(O,1)}static moveWordRight(w,D,O,W){let U=O.lineNumber,K=O.column,q=!1;K===D.getLineMaxColumn(U)&&U<D.getLineCount()&&(q=!0,U=U+1,K=1);let G=WordOperations._findNextWordOnLine(w,D,new Position$1(U,K));if(W===2)G&&G.wordType===2&&G.end-G.start===1&&G.nextCharClass===0&&(G=WordOperations._findNextWordOnLine(w,D,new Position$1(U,G.end+1))),G?K=G.end+1:K=D.getLineMaxColumn(U);else if(W===3){for(q&&(K=0);G&&(G.wordType===2||G.start+1<=K);)G=WordOperations._findNextWordOnLine(w,D,new Position$1(U,G.end+1));G?K=G.start+1:K=D.getLineMaxColumn(U)}else G&&!q&&K>=G.start+1&&(G=WordOperations._findNextWordOnLine(w,D,new Position$1(U,G.end+1))),G?K=G.start+1:K=D.getLineMaxColumn(U);return new Position$1(U,K)}static _moveWordPartRight(w,D){const O=D.lineNumber,W=w.getLineMaxColumn(O);if(D.column===W)return O<w.getLineCount()?new Position$1(O+1,1):D;const U=w.getLineContent(O);for(let K=D.column+1;K<W;K++){const q=U.charCodeAt(K-2),G=U.charCodeAt(K-1);if(q!==95&&G===95)return new Position$1(O,K);if(q!==45&&G===45)return new Position$1(O,K);if((isLowerAsciiLetter(q)||isAsciiDigit(q))&&isUpperAsciiLetter(G))return new Position$1(O,K);if(isUpperAsciiLetter(q)&&isUpperAsciiLetter(G)&&K+1<W){const Q=U.charCodeAt(K);if(isLowerAsciiLetter(Q)||isAsciiDigit(Q))return new Position$1(O,K)}}return new Position$1(O,W)}static _deleteWordLeftWhitespace(w,D){const O=w.getLineContent(D.lineNumber),W=D.column-2,U=lastNonWhitespaceIndex(O,W);return U+1<W?new Range$2(D.lineNumber,U+2,D.lineNumber,D.column):null}static deleteWordLeft(w,D){const O=w.wordSeparators,W=w.model,U=w.selection,K=w.whitespaceHeuristics;if(!U.isEmpty())return U;if(DeleteOperations.isAutoClosingPairDelete(w.autoClosingDelete,w.autoClosingBrackets,w.autoClosingQuotes,w.autoClosingPairs.autoClosingPairsOpenByEnd,w.model,[w.selection],w.autoClosedCharacters)){const X=w.selection.getPosition();return new Range$2(X.lineNumber,X.column-1,X.lineNumber,X.column+1)}const q=new Position$1(U.positionLineNumber,U.positionColumn);let G=q.lineNumber,Q=q.column;if(G===1&&Q===1)return null;if(K){const X=this._deleteWordLeftWhitespace(W,q);if(X)return X}let Y=WordOperations._findPreviousWordOnLine(O,W,q);return D===0?Y?Q=Y.start+1:Q>1?Q=1:(G--,Q=W.getLineMaxColumn(G)):(Y&&Q<=Y.end+1&&(Y=WordOperations._findPreviousWordOnLine(O,W,new Position$1(G,Y.start+1))),Y?Q=Y.end+1:Q>1?Q=1:(G--,Q=W.getLineMaxColumn(G))),new Range$2(G,Q,q.lineNumber,q.column)}static deleteInsideWord(w,D,O){if(!O.isEmpty())return O;const W=new Position$1(O.positionLineNumber,O.positionColumn),U=this._deleteInsideWordWhitespace(D,W);return U||this._deleteInsideWordDetermineDeleteRange(w,D,W)}static _charAtIsWhitespace(w,D){const O=w.charCodeAt(D);return O===32||O===9}static _deleteInsideWordWhitespace(w,D){const O=w.getLineContent(D.lineNumber),W=O.length;if(W===0)return null;let U=Math.max(D.column-2,0);if(!this._charAtIsWhitespace(O,U))return null;let K=Math.min(D.column-1,W-1);if(!this._charAtIsWhitespace(O,K))return null;for(;U>0&&this._charAtIsWhitespace(O,U-1);)U--;for(;K+1<W&&this._charAtIsWhitespace(O,K+1);)K++;return new Range$2(D.lineNumber,U+1,D.lineNumber,K+2)}static _deleteInsideWordDetermineDeleteRange(w,D,O){const W=D.getLineContent(O.lineNumber),U=W.length;if(U===0)return O.lineNumber>1?new Range$2(O.lineNumber-1,D.getLineMaxColumn(O.lineNumber-1),O.lineNumber,1):O.lineNumber<D.getLineCount()?new Range$2(O.lineNumber,1,O.lineNumber+1,1):new Range$2(O.lineNumber,1,O.lineNumber,1);const K=X=>X.start+1<=O.column&&O.column<=X.end+1,q=(X,J)=>(X=Math.min(X,O.column),J=Math.max(J,O.column),new Range$2(O.lineNumber,X,O.lineNumber,J)),G=X=>{let J=X.start+1,te=X.end+1,ie=!1;for(;te-1<U&&this._charAtIsWhitespace(W,te-1);)ie=!0,te++;if(!ie)for(;J>1&&this._charAtIsWhitespace(W,J-2);)J--;return q(J,te)},Q=WordOperations._findPreviousWordOnLine(w,D,O);if(Q&&K(Q))return G(Q);const Y=WordOperations._findNextWordOnLine(w,D,O);return Y&&K(Y)?G(Y):Q&&Y?q(Q.end+1,Y.start+1):Q?q(Q.start+1,Q.end+1):Y?q(Y.start+1,Y.end+1):q(1,U+1)}static _deleteWordPartLeft(w,D){if(!D.isEmpty())return D;const O=D.getPosition(),W=WordOperations._moveWordPartLeft(w,O);return new Range$2(O.lineNumber,O.column,W.lineNumber,W.column)}static _findFirstNonWhitespaceChar(w,D){const O=w.length;for(let W=D;W<O;W++){const U=w.charAt(W);if(U!==" "&&U!=="	")return W}return O}static _deleteWordRightWhitespace(w,D){const O=w.getLineContent(D.lineNumber),W=D.column-1,U=this._findFirstNonWhitespaceChar(O,W);return W+1<U?new Range$2(D.lineNumber,D.column,D.lineNumber,U+1):null}static deleteWordRight(w,D){const O=w.wordSeparators,W=w.model,U=w.selection,K=w.whitespaceHeuristics;if(!U.isEmpty())return U;const q=new Position$1(U.positionLineNumber,U.positionColumn);let G=q.lineNumber,Q=q.column;const Y=W.getLineCount(),X=W.getLineMaxColumn(G);if(G===Y&&Q===X)return null;if(K){const te=this._deleteWordRightWhitespace(W,q);if(te)return te}let J=WordOperations._findNextWordOnLine(O,W,q);return D===2?J?Q=J.end+1:Q<X||G===Y?Q=X:(G++,J=WordOperations._findNextWordOnLine(O,W,new Position$1(G,1)),J?Q=J.start+1:Q=W.getLineMaxColumn(G)):(J&&Q>=J.start+1&&(J=WordOperations._findNextWordOnLine(O,W,new Position$1(G,J.end+1))),J?Q=J.start+1:Q<X||G===Y?Q=X:(G++,J=WordOperations._findNextWordOnLine(O,W,new Position$1(G,1)),J?Q=J.start+1:Q=W.getLineMaxColumn(G))),new Range$2(G,Q,q.lineNumber,q.column)}static _deleteWordPartRight(w,D){if(!D.isEmpty())return D;const O=D.getPosition(),W=WordOperations._moveWordPartRight(w,O);return new Range$2(O.lineNumber,O.column,W.lineNumber,W.column)}static _createWordAtPosition(w,D,O){const W=new Range$2(D,O.start+1,D,O.end+1);return{word:w.getValueInRange(W),startColumn:W.startColumn,endColumn:W.endColumn}}static getWordAtPosition(w,D,O,W){const U=getMapForWordSeparators(D,O),K=WordOperations._findPreviousWordOnLine(U,w,W);if(K&&K.wordType===1&&K.start<=W.column-1&&W.column-1<=K.end)return WordOperations._createWordAtPosition(w,W.lineNumber,K);const q=WordOperations._findNextWordOnLine(U,w,W);return q&&q.wordType===1&&q.start<=W.column-1&&W.column-1<=q.end?WordOperations._createWordAtPosition(w,W.lineNumber,q):null}static word(w,D,O,W,U){const K=getMapForWordSeparators(w.wordSeparators,w.wordSegmenterLocales),q=WordOperations._findPreviousWordOnLine(K,D,U),G=WordOperations._findNextWordOnLine(K,D,U);if(!W){let te,ie;return q&&q.wordType===1&&q.start<=U.column-1&&U.column-1<=q.end?(te=q.start+1,ie=q.end+1):G&&G.wordType===1&&G.start<=U.column-1&&U.column-1<=G.end?(te=G.start+1,ie=G.end+1):(q?te=q.end+1:te=1,G?ie=G.start+1:ie=D.getLineMaxColumn(U.lineNumber)),new SingleCursorState(new Range$2(U.lineNumber,te,U.lineNumber,ie),1,0,new Position$1(U.lineNumber,ie),0)}let Q,Y;q&&q.wordType===1&&q.start<U.column-1&&U.column-1<q.end?(Q=q.start+1,Y=q.end+1):G&&G.wordType===1&&G.start<U.column-1&&U.column-1<G.end?(Q=G.start+1,Y=G.end+1):(Q=U.column,Y=U.column);const X=U.lineNumber;let J;if(O.selectionStart.containsPosition(U))J=O.selectionStart.endColumn;else if(U.isBeforeOrEqual(O.selectionStart.getStartPosition())){J=Q;const te=new Position$1(X,J);O.selectionStart.containsPosition(te)&&(J=O.selectionStart.endColumn)}else{J=Y;const te=new Position$1(X,J);O.selectionStart.containsPosition(te)&&(J=O.selectionStart.startColumn)}return O.move(!0,X,J,0)}}class CursorMoveCommands{static addCursorDown(w,D,O){const W=[];let U=0;for(let K=0,q=D.length;K<q;K++){const G=D[K];W[U++]=new CursorState(G.modelState,G.viewState),O?W[U++]=CursorState.fromModelState(MoveOperations.translateDown(w.cursorConfig,w.model,G.modelState)):W[U++]=CursorState.fromViewState(MoveOperations.translateDown(w.cursorConfig,w,G.viewState))}return W}static addCursorUp(w,D,O){const W=[];let U=0;for(let K=0,q=D.length;K<q;K++){const G=D[K];W[U++]=new CursorState(G.modelState,G.viewState),O?W[U++]=CursorState.fromModelState(MoveOperations.translateUp(w.cursorConfig,w.model,G.modelState)):W[U++]=CursorState.fromViewState(MoveOperations.translateUp(w.cursorConfig,w,G.viewState))}return W}static moveToBeginningOfLine(w,D,O){const W=[];for(let U=0,K=D.length;U<K;U++){const q=D[U];W[U]=this._moveToLineStart(w,q,O)}return W}static _moveToLineStart(w,D,O){const W=D.viewState.position.column,U=D.modelState.position.column,K=W===U,q=D.viewState.position.lineNumber,G=w.getLineFirstNonWhitespaceColumn(q);return!K&&!(W===G)?this._moveToLineStartByView(w,D,O):this._moveToLineStartByModel(w,D,O)}static _moveToLineStartByView(w,D,O){return CursorState.fromViewState(MoveOperations.moveToBeginningOfLine(w.cursorConfig,w,D.viewState,O))}static _moveToLineStartByModel(w,D,O){return CursorState.fromModelState(MoveOperations.moveToBeginningOfLine(w.cursorConfig,w.model,D.modelState,O))}static moveToEndOfLine(w,D,O,W){const U=[];for(let K=0,q=D.length;K<q;K++){const G=D[K];U[K]=this._moveToLineEnd(w,G,O,W)}return U}static _moveToLineEnd(w,D,O,W){const U=D.viewState.position,K=w.getLineMaxColumn(U.lineNumber),q=U.column===K,G=D.modelState.position,Q=w.model.getLineMaxColumn(G.lineNumber),Y=K-U.column===Q-G.column;return q||Y?this._moveToLineEndByModel(w,D,O,W):this._moveToLineEndByView(w,D,O,W)}static _moveToLineEndByView(w,D,O,W){return CursorState.fromViewState(MoveOperations.moveToEndOfLine(w.cursorConfig,w,D.viewState,O,W))}static _moveToLineEndByModel(w,D,O,W){return CursorState.fromModelState(MoveOperations.moveToEndOfLine(w.cursorConfig,w.model,D.modelState,O,W))}static expandLineSelection(w,D){const O=[];for(let W=0,U=D.length;W<U;W++){const K=D[W],q=K.modelState.selection.startLineNumber,G=w.model.getLineCount();let Q=K.modelState.selection.endLineNumber,Y;Q===G?Y=w.model.getLineMaxColumn(G):(Q++,Y=1),O[W]=CursorState.fromModelState(new SingleCursorState(new Range$2(q,1,q,1),0,0,new Position$1(Q,Y),0))}return O}static moveToBeginningOfBuffer(w,D,O){const W=[];for(let U=0,K=D.length;U<K;U++){const q=D[U];W[U]=CursorState.fromModelState(MoveOperations.moveToBeginningOfBuffer(w.cursorConfig,w.model,q.modelState,O))}return W}static moveToEndOfBuffer(w,D,O){const W=[];for(let U=0,K=D.length;U<K;U++){const q=D[U];W[U]=CursorState.fromModelState(MoveOperations.moveToEndOfBuffer(w.cursorConfig,w.model,q.modelState,O))}return W}static selectAll(w,D){const O=w.model.getLineCount(),W=w.model.getLineMaxColumn(O);return CursorState.fromModelState(new SingleCursorState(new Range$2(1,1,1,1),0,0,new Position$1(O,W),0))}static line(w,D,O,W,U){const K=w.model.validatePosition(W),q=U?w.coordinatesConverter.validateViewPosition(new Position$1(U.lineNumber,U.column),K):w.coordinatesConverter.convertModelPositionToViewPosition(K);if(!O){const Q=w.model.getLineCount();let Y=K.lineNumber+1,X=1;return Y>Q&&(Y=Q,X=w.model.getLineMaxColumn(Y)),CursorState.fromModelState(new SingleCursorState(new Range$2(K.lineNumber,1,Y,X),2,0,new Position$1(Y,X),0))}const G=D.modelState.selectionStart.getStartPosition().lineNumber;if(K.lineNumber<G)return CursorState.fromViewState(D.viewState.move(!0,q.lineNumber,1,0));if(K.lineNumber>G){const Q=w.getLineCount();let Y=q.lineNumber+1,X=1;return Y>Q&&(Y=Q,X=w.getLineMaxColumn(Y)),CursorState.fromViewState(D.viewState.move(!0,Y,X,0))}else{const Q=D.modelState.selectionStart.getEndPosition();return CursorState.fromModelState(D.modelState.move(!0,Q.lineNumber,Q.column,0))}}static word(w,D,O,W){const U=w.model.validatePosition(W);return CursorState.fromModelState(WordOperations.word(w.cursorConfig,w.model,D.modelState,O,U))}static cancelSelection(w,D){if(!D.modelState.hasSelection())return new CursorState(D.modelState,D.viewState);const O=D.viewState.position.lineNumber,W=D.viewState.position.column;return CursorState.fromViewState(new SingleCursorState(new Range$2(O,W,O,W),0,0,new Position$1(O,W),0))}static moveTo(w,D,O,W,U){if(O){if(D.modelState.selectionStartKind===1)return this.word(w,D,O,W);if(D.modelState.selectionStartKind===2)return this.line(w,D,O,W,U)}const K=w.model.validatePosition(W),q=U?w.coordinatesConverter.validateViewPosition(new Position$1(U.lineNumber,U.column),K):w.coordinatesConverter.convertModelPositionToViewPosition(K);return CursorState.fromViewState(D.viewState.move(O,q.lineNumber,q.column,0))}static simpleMove(w,D,O,W,U,K){switch(O){case 0:return K===4?this._moveHalfLineLeft(w,D,W):this._moveLeft(w,D,W,U);case 1:return K===4?this._moveHalfLineRight(w,D,W):this._moveRight(w,D,W,U);case 2:return K===2?this._moveUpByViewLines(w,D,W,U):this._moveUpByModelLines(w,D,W,U);case 3:return K===2?this._moveDownByViewLines(w,D,W,U):this._moveDownByModelLines(w,D,W,U);case 4:return K===2?D.map(q=>CursorState.fromViewState(MoveOperations.moveToPrevBlankLine(w.cursorConfig,w,q.viewState,W))):D.map(q=>CursorState.fromModelState(MoveOperations.moveToPrevBlankLine(w.cursorConfig,w.model,q.modelState,W)));case 5:return K===2?D.map(q=>CursorState.fromViewState(MoveOperations.moveToNextBlankLine(w.cursorConfig,w,q.viewState,W))):D.map(q=>CursorState.fromModelState(MoveOperations.moveToNextBlankLine(w.cursorConfig,w.model,q.modelState,W)));case 6:return this._moveToViewMinColumn(w,D,W);case 7:return this._moveToViewFirstNonWhitespaceColumn(w,D,W);case 8:return this._moveToViewCenterColumn(w,D,W);case 9:return this._moveToViewMaxColumn(w,D,W);case 10:return this._moveToViewLastNonWhitespaceColumn(w,D,W);default:return null}}static viewportMove(w,D,O,W,U){const K=w.getCompletelyVisibleViewRange(),q=w.coordinatesConverter.convertViewRangeToModelRange(K);switch(O){case 11:{const G=this._firstLineNumberInRange(w.model,q,U),Q=w.model.getLineFirstNonWhitespaceColumn(G);return[this._moveToModelPosition(w,D[0],W,G,Q)]}case 13:{const G=this._lastLineNumberInRange(w.model,q,U),Q=w.model.getLineFirstNonWhitespaceColumn(G);return[this._moveToModelPosition(w,D[0],W,G,Q)]}case 12:{const G=Math.round((q.startLineNumber+q.endLineNumber)/2),Q=w.model.getLineFirstNonWhitespaceColumn(G);return[this._moveToModelPosition(w,D[0],W,G,Q)]}case 14:{const G=[];for(let Q=0,Y=D.length;Q<Y;Q++){const X=D[Q];G[Q]=this.findPositionInViewportIfOutside(w,X,K,W)}return G}default:return null}}static findPositionInViewportIfOutside(w,D,O,W){const U=D.viewState.position.lineNumber;if(O.startLineNumber<=U&&U<=O.endLineNumber-1)return new CursorState(D.modelState,D.viewState);{let K;U>O.endLineNumber-1?K=O.endLineNumber-1:U<O.startLineNumber?K=O.startLineNumber:K=U;const q=MoveOperations.vertical(w.cursorConfig,w,U,D.viewState.position.column,D.viewState.leftoverVisibleColumns,K,!1);return CursorState.fromViewState(D.viewState.move(W,q.lineNumber,q.column,q.leftoverVisibleColumns))}}static _firstLineNumberInRange(w,D,O){let W=D.startLineNumber;return D.startColumn!==w.getLineMinColumn(W)&&W++,Math.min(D.endLineNumber,W+O-1)}static _lastLineNumberInRange(w,D,O){let W=D.startLineNumber;return D.startColumn!==w.getLineMinColumn(W)&&W++,Math.max(W,D.endLineNumber-O+1)}static _moveLeft(w,D,O,W){return D.map(U=>CursorState.fromViewState(MoveOperations.moveLeft(w.cursorConfig,w,U.viewState,O,W)))}static _moveHalfLineLeft(w,D,O){const W=[];for(let U=0,K=D.length;U<K;U++){const q=D[U],G=q.viewState.position.lineNumber,Q=Math.round(w.getLineLength(G)/2);W[U]=CursorState.fromViewState(MoveOperations.moveLeft(w.cursorConfig,w,q.viewState,O,Q))}return W}static _moveRight(w,D,O,W){return D.map(U=>CursorState.fromViewState(MoveOperations.moveRight(w.cursorConfig,w,U.viewState,O,W)))}static _moveHalfLineRight(w,D,O){const W=[];for(let U=0,K=D.length;U<K;U++){const q=D[U],G=q.viewState.position.lineNumber,Q=Math.round(w.getLineLength(G)/2);W[U]=CursorState.fromViewState(MoveOperations.moveRight(w.cursorConfig,w,q.viewState,O,Q))}return W}static _moveDownByViewLines(w,D,O,W){const U=[];for(let K=0,q=D.length;K<q;K++){const G=D[K];U[K]=CursorState.fromViewState(MoveOperations.moveDown(w.cursorConfig,w,G.viewState,O,W))}return U}static _moveDownByModelLines(w,D,O,W){const U=[];for(let K=0,q=D.length;K<q;K++){const G=D[K];U[K]=CursorState.fromModelState(MoveOperations.moveDown(w.cursorConfig,w.model,G.modelState,O,W))}return U}static _moveUpByViewLines(w,D,O,W){const U=[];for(let K=0,q=D.length;K<q;K++){const G=D[K];U[K]=CursorState.fromViewState(MoveOperations.moveUp(w.cursorConfig,w,G.viewState,O,W))}return U}static _moveUpByModelLines(w,D,O,W){const U=[];for(let K=0,q=D.length;K<q;K++){const G=D[K];U[K]=CursorState.fromModelState(MoveOperations.moveUp(w.cursorConfig,w.model,G.modelState,O,W))}return U}static _moveToViewPosition(w,D,O,W,U){return CursorState.fromViewState(D.viewState.move(O,W,U,0))}static _moveToModelPosition(w,D,O,W,U){return CursorState.fromModelState(D.modelState.move(O,W,U,0))}static _moveToViewMinColumn(w,D,O){const W=[];for(let U=0,K=D.length;U<K;U++){const q=D[U],G=q.viewState.position.lineNumber,Q=w.getLineMinColumn(G);W[U]=this._moveToViewPosition(w,q,O,G,Q)}return W}static _moveToViewFirstNonWhitespaceColumn(w,D,O){const W=[];for(let U=0,K=D.length;U<K;U++){const q=D[U],G=q.viewState.position.lineNumber,Q=w.getLineFirstNonWhitespaceColumn(G);W[U]=this._moveToViewPosition(w,q,O,G,Q)}return W}static _moveToViewCenterColumn(w,D,O){const W=[];for(let U=0,K=D.length;U<K;U++){const q=D[U],G=q.viewState.position.lineNumber,Q=Math.round((w.getLineMaxColumn(G)+w.getLineMinColumn(G))/2);W[U]=this._moveToViewPosition(w,q,O,G,Q)}return W}static _moveToViewMaxColumn(w,D,O){const W=[];for(let U=0,K=D.length;U<K;U++){const q=D[U],G=q.viewState.position.lineNumber,Q=w.getLineMaxColumn(G);W[U]=this._moveToViewPosition(w,q,O,G,Q)}return W}static _moveToViewLastNonWhitespaceColumn(w,D,O){const W=[];for(let U=0,K=D.length;U<K;U++){const q=D[U],G=q.viewState.position.lineNumber,Q=w.getLineLastNonWhitespaceColumn(G);W[U]=this._moveToViewPosition(w,q,O,G,Q)}return W}}var CursorMove;(function(F){const w=function(O){if(!isObject$1(O))return!1;const W=O;return!(!isString$1(W.to)||!isUndefined(W.select)&&!isBoolean$1(W.select)||!isUndefined(W.by)&&!isString$1(W.by)||!isUndefined(W.value)&&!isNumber$1(W.value))};F.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:w,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},F.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},F.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function D(O){if(!O.to)return null;let W;switch(O.to){case F.RawDirection.Left:W=0;break;case F.RawDirection.Right:W=1;break;case F.RawDirection.Up:W=2;break;case F.RawDirection.Down:W=3;break;case F.RawDirection.PrevBlankLine:W=4;break;case F.RawDirection.NextBlankLine:W=5;break;case F.RawDirection.WrappedLineStart:W=6;break;case F.RawDirection.WrappedLineFirstNonWhitespaceCharacter:W=7;break;case F.RawDirection.WrappedLineColumnCenter:W=8;break;case F.RawDirection.WrappedLineEnd:W=9;break;case F.RawDirection.WrappedLineLastNonWhitespaceCharacter:W=10;break;case F.RawDirection.ViewPortTop:W=11;break;case F.RawDirection.ViewPortBottom:W=13;break;case F.RawDirection.ViewPortCenter:W=12;break;case F.RawDirection.ViewPortIfOutside:W=14;break;default:return null}let U=0;switch(O.by){case F.RawUnit.Line:U=1;break;case F.RawUnit.WrappedLine:U=2;break;case F.RawUnit.Character:U=3;break;case F.RawUnit.HalfLine:U=4;break}return{direction:W,unit:U,select:!!O.select,value:O.value||1}}F.parse=D})(CursorMove||(CursorMove={}));class ProcessedIndentRulesSupport{constructor(w,D,O){this._indentRulesSupport=D,this._indentationLineProcessor=new IndentationLineProcessor(w,O)}shouldIncrease(w,D){const O=this._indentationLineProcessor.getProcessedLine(w,D);return this._indentRulesSupport.shouldIncrease(O)}shouldDecrease(w,D){const O=this._indentationLineProcessor.getProcessedLine(w,D);return this._indentRulesSupport.shouldDecrease(O)}shouldIgnore(w,D){const O=this._indentationLineProcessor.getProcessedLine(w,D);return this._indentRulesSupport.shouldIgnore(O)}shouldIndentNextLine(w,D){const O=this._indentationLineProcessor.getProcessedLine(w,D);return this._indentRulesSupport.shouldIndentNextLine(O)}}class IndentationContextProcessor{constructor(w,D){this.model=w,this.indentationLineProcessor=new IndentationLineProcessor(w,D)}getProcessedTokenContextAroundRange(w){const D=this._getProcessedTokensBeforeRange(w),O=this._getProcessedTokensAfterRange(w),W=this._getProcessedPreviousLineTokens(w);return{beforeRangeProcessedTokens:D,afterRangeProcessedTokens:O,previousLineProcessedTokens:W}}_getProcessedTokensBeforeRange(w){this.model.tokenization.forceTokenization(w.startLineNumber);const D=this.model.tokenization.getLineTokens(w.startLineNumber),O=createScopedLineTokens(D,w.startColumn-1);let W;if(isLanguageDifferentFromLineStart(this.model,w.getStartPosition())){const K=w.startColumn-1-O.firstCharOffset,q=O.firstCharOffset,G=q+K;W=D.sliceAndInflate(q,G,0)}else{const K=w.startColumn-1;W=D.sliceAndInflate(0,K,0)}return this.indentationLineProcessor.getProcessedTokens(W)}_getProcessedTokensAfterRange(w){const D=w.isEmpty()?w.getStartPosition():w.getEndPosition();this.model.tokenization.forceTokenization(D.lineNumber);const O=this.model.tokenization.getLineTokens(D.lineNumber),W=createScopedLineTokens(O,D.column-1),U=D.column-1-W.firstCharOffset,K=W.firstCharOffset+U,q=W.firstCharOffset+W.getLineLength(),G=O.sliceAndInflate(K,q,0);return this.indentationLineProcessor.getProcessedTokens(G)}_getProcessedPreviousLineTokens(w){const D=te=>{this.model.tokenization.forceTokenization(te);const ie=this.model.tokenization.getLineTokens(te),se=this.model.getLineMaxColumn(te)-1;return createScopedLineTokens(ie,se)};this.model.tokenization.forceTokenization(w.startLineNumber);const O=this.model.tokenization.getLineTokens(w.startLineNumber),W=createScopedLineTokens(O,w.startColumn-1),U=LineTokens.createEmpty("",W.languageIdCodec),K=w.startLineNumber-1;if(K===0||!(W.firstCharOffset===0))return U;const Q=D(K);if(!(W.languageId===Q.languageId))return U;const X=Q.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(X)}}class IndentationLineProcessor{constructor(w,D){this.model=w,this.languageConfigurationService=D}getProcessedLine(w,D){const O=(K,q)=>{const G=getLeadingWhitespace(K);return q+K.substring(G.length)};this.model.tokenization.forceTokenization?.(w);const W=this.model.tokenization.getLineTokens(w);let U=this.getProcessedTokens(W).getLineContent();return D!==void 0&&(U=O(U,D)),U}getProcessedTokens(w){const D=G=>G===2||G===3||G===1,O=w.getLanguageId(0),U=this.languageConfigurationService.getLanguageConfiguration(O).bracketsNew.getBracketRegExp({global:!0}),K=[];return w.forEach(G=>{const Q=w.getStandardTokenType(G);let Y=w.getTokenText(G);D(Q)&&(Y=Y.replace(U,""));const X=w.getMetadata(G);K.push({text:Y,metadata:X})}),LineTokens.createFromTextAndMetadata(K,w.languageIdCodec)}}function isLanguageDifferentFromLineStart(F,w){F.tokenization.forceTokenization(w.lineNumber);const D=F.tokenization.getLineTokens(w.lineNumber),O=createScopedLineTokens(D,w.column-1),W=O.firstCharOffset===0,U=D.getLanguageId(0)===O.languageId;return!W&&!U}function getEnterAction(F,w,D,O){w.tokenization.forceTokenization(D.startLineNumber);const W=w.getLanguageIdAtPosition(D.startLineNumber,D.startColumn),U=O.getLanguageConfiguration(W);if(!U)return null;const q=new IndentationContextProcessor(w,O).getProcessedTokenContextAroundRange(D),G=q.previousLineProcessedTokens.getLineContent(),Q=q.beforeRangeProcessedTokens.getLineContent(),Y=q.afterRangeProcessedTokens.getLineContent(),X=U.onEnter(F,G,Q,Y);if(!X)return null;const J=X.indentAction;let te=X.appendText;const ie=X.removeText||0;te?J===IndentAction$1.Indent&&(te="	"+te):J===IndentAction$1.Indent||J===IndentAction$1.IndentOutdent?te="	":te="";let se=getIndentationAtPosition(w,D.startLineNumber,D.startColumn);return ie&&(se=se.substring(0,se.length-ie)),{indentAction:J,appendText:te,removeText:ie,indentation:se}}var __decorate$V=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$S=function(F,w){return function(D,O){w(D,O,F)}},ShiftCommand_1;const repeatCache=Object.create(null);function cachedStringRepeat(F,w){if(w<=0)return"";repeatCache[F]||(repeatCache[F]=["",F]);const D=repeatCache[F];for(let O=D.length;O<=w;O++)D[O]=D[O-1]+F;return D[w]}let ShiftCommand=ShiftCommand_1=class{static unshiftIndent(w,D,O,W,U){const K=CursorColumns.visibleColumnFromColumn(w,D,O);if(U){const q=cachedStringRepeat(" ",W),Q=CursorColumns.prevIndentTabStop(K,W)/W;return cachedStringRepeat(q,Q)}else{const q="	",Q=CursorColumns.prevRenderTabStop(K,O)/O;return cachedStringRepeat(q,Q)}}static shiftIndent(w,D,O,W,U){const K=CursorColumns.visibleColumnFromColumn(w,D,O);if(U){const q=cachedStringRepeat(" ",W),Q=CursorColumns.nextIndentTabStop(K,W)/W;return cachedStringRepeat(q,Q)}else{const q="	",Q=CursorColumns.nextRenderTabStop(K,O)/O;return cachedStringRepeat(q,Q)}}constructor(w,D,O){this._languageConfigurationService=O,this._opts=D,this._selection=w,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(w,D,O){this._useLastEditRangeForCursorEndPosition?w.addTrackedEditOperation(D,O):w.addEditOperation(D,O)}getEditOperations(w,D){const O=this._selection.startLineNumber;let W=this._selection.endLineNumber;this._selection.endColumn===1&&O!==W&&(W=W-1);const{tabSize:U,indentSize:K,insertSpaces:q}=this._opts,G=O===W;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(w.getLineContent(O))&&(this._useLastEditRangeForCursorEndPosition=!0);let Q=0,Y=0;for(let X=O;X<=W;X++,Q=Y){Y=0;const J=w.getLineContent(X);let te=firstNonWhitespaceIndex(J);if(this._opts.isUnshift&&(J.length===0||te===0)||!G&&!this._opts.isUnshift&&J.length===0)continue;if(te===-1&&(te=J.length),X>1&&CursorColumns.visibleColumnFromColumn(J,te+1,U)%K!==0&&w.tokenization.isCheapToTokenize(X-1)){const re=getEnterAction(this._opts.autoIndent,w,new Range$2(X-1,w.getLineMaxColumn(X-1),X-1,w.getLineMaxColumn(X-1)),this._languageConfigurationService);if(re){if(Y=Q,re.appendText)for(let ae=0,le=re.appendText.length;ae<le&&Y<K&&re.appendText.charCodeAt(ae)===32;ae++)Y++;re.removeText&&(Y=Math.max(0,Y-re.removeText));for(let ae=0;ae<Y&&!(te===0||J.charCodeAt(te-1)!==32);ae++)te--}}if(this._opts.isUnshift&&te===0)continue;let ie;this._opts.isUnshift?ie=ShiftCommand_1.unshiftIndent(J,te+1,U,K,q):ie=ShiftCommand_1.shiftIndent(J,te+1,U,K,q),this._addEditOperation(D,new Range$2(X,1,X,te+1),ie),X===O&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=te+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&w.getLineLength(O)===0&&(this._useLastEditRangeForCursorEndPosition=!0);const Q=q?cachedStringRepeat(" ",K):"	";for(let Y=O;Y<=W;Y++){const X=w.getLineContent(Y);let J=firstNonWhitespaceIndex(X);if(!(this._opts.isUnshift&&(X.length===0||J===0))&&!(!G&&!this._opts.isUnshift&&X.length===0)&&(J===-1&&(J=X.length),!(this._opts.isUnshift&&J===0)))if(this._opts.isUnshift){J=Math.min(J,K);for(let te=0;te<J;te++)if(X.charCodeAt(te)===9){J=te+1;break}this._addEditOperation(D,new Range$2(Y,1,Y,J+1),"")}else this._addEditOperation(D,new Range$2(Y,1,Y,1),Q),Y===O&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=D.trackSelection(this._selection)}computeCursorState(w,D){if(this._useLastEditRangeForCursorEndPosition){const W=D.getInverseEditOperations()[0];return new Selection$1(W.range.endLineNumber,W.range.endColumn,W.range.endLineNumber,W.range.endColumn)}const O=D.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const W=this._selection.startColumn;return O.startColumn<=W?O:O.getDirection()===0?new Selection$1(O.startLineNumber,W,O.endLineNumber,O.endColumn):new Selection$1(O.endLineNumber,O.endColumn,O.startLineNumber,W)}return O}};ShiftCommand=ShiftCommand_1=__decorate$V([__param$S(2,ILanguageConfigurationService)],ShiftCommand);class SurroundSelectionCommand{constructor(w,D,O){this._range=w,this._charBeforeSelection=D,this._charAfterSelection=O}getEditOperations(w,D){D.addTrackedEditOperation(new Range$2(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),D.addTrackedEditOperation(new Range$2(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(w,D){const O=D.getInverseEditOperations(),W=O[0].range,U=O[1].range;return new Selection$1(W.endLineNumber,W.endColumn,U.endLineNumber,U.endColumn-this._charAfterSelection.length)}}class CompositionSurroundSelectionCommand{constructor(w,D,O){this._position=w,this._text=D,this._charAfter=O}getEditOperations(w,D){D.addTrackedEditOperation(new Range$2(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(w,D){const W=D.getInverseEditOperations()[0].range;return new Selection$1(W.endLineNumber,W.startColumn,W.endLineNumber,W.endColumn-this._charAfter.length)}}function getPrecedingValidLine(F,w,D){const O=F.tokenization.getLanguageIdAtPosition(w,0);if(w>1){let W,U=-1;for(W=w-1;W>=1;W--){if(F.tokenization.getLanguageIdAtPosition(W,0)!==O)return U;const K=F.getLineContent(W);if(D.shouldIgnore(W)||/^\s+$/.test(K)||K===""){U=W;continue}return W}}return-1}function getInheritIndentForLine(F,w,D,O=!0,W){if(F<4)return null;const U=W.getLanguageConfiguration(w.tokenization.getLanguageId()).indentRulesSupport;if(!U)return null;const K=new ProcessedIndentRulesSupport(w,U,W);if(D<=1)return{indentation:"",action:null};for(let G=D-1;G>0&&w.getLineContent(G)==="";G--)if(G===1)return{indentation:"",action:null};const q=getPrecedingValidLine(w,D,K);if(q<0)return null;if(q<1)return{indentation:"",action:null};if(K.shouldIncrease(q)||K.shouldIndentNextLine(q)){const G=w.getLineContent(q);return{indentation:getLeadingWhitespace(G),action:IndentAction$1.Indent,line:q}}else if(K.shouldDecrease(q)){const G=w.getLineContent(q);return{indentation:getLeadingWhitespace(G),action:null,line:q}}else{if(q===1)return{indentation:getLeadingWhitespace(w.getLineContent(q)),action:null,line:q};const G=q-1,Q=U.getIndentMetadata(w.getLineContent(G));if(!(Q&3)&&Q&4){let Y=0;for(let X=G-1;X>0;X--)if(!K.shouldIndentNextLine(X)){Y=X;break}return{indentation:getLeadingWhitespace(w.getLineContent(Y+1)),action:null,line:Y+1}}if(O)return{indentation:getLeadingWhitespace(w.getLineContent(q)),action:null,line:q};for(let Y=q;Y>0;Y--){if(K.shouldIncrease(Y))return{indentation:getLeadingWhitespace(w.getLineContent(Y)),action:IndentAction$1.Indent,line:Y};if(K.shouldIndentNextLine(Y)){let X=0;for(let J=Y-1;J>0;J--)if(!K.shouldIndentNextLine(Y)){X=J;break}return{indentation:getLeadingWhitespace(w.getLineContent(X+1)),action:null,line:X+1}}else if(K.shouldDecrease(Y))return{indentation:getLeadingWhitespace(w.getLineContent(Y)),action:null,line:Y}}return{indentation:getLeadingWhitespace(w.getLineContent(1)),action:null,line:1}}}function getIndentForEnter(F,w,D,O,W){if(F<4)return null;const U=w.getLanguageIdAtPosition(D.startLineNumber,D.startColumn),K=W.getLanguageConfiguration(U).indentRulesSupport;if(!K)return null;w.tokenization.forceTokenization(D.startLineNumber);const G=new IndentationContextProcessor(w,W).getProcessedTokenContextAroundRange(D),Q=G.afterRangeProcessedTokens,Y=G.beforeRangeProcessedTokens,X=getLeadingWhitespace(Y.getLineContent()),J=createVirtualModelWithModifiedTokensAtLine(w,D.startLineNumber,Y),te=isLanguageDifferentFromLineStart(w,D.getStartPosition()),ie=w.getLineContent(D.startLineNumber),se=getLeadingWhitespace(ie),re=getInheritIndentForLine(F,J,D.startLineNumber+1,void 0,W);if(!re){const le=te?se:X;return{beforeEnter:le,afterEnter:le}}let ae=te?se:re.indentation;return re.action===IndentAction$1.Indent&&(ae=O.shiftIndent(ae)),K.shouldDecrease(Q.getLineContent())&&(ae=O.unshiftIndent(ae)),{beforeEnter:te?se:X,afterEnter:ae}}function getIndentActionForType(F,w,D,O,W,U){const K=F.autoIndent;if(K<4||isLanguageDifferentFromLineStart(w,D.getStartPosition()))return null;const G=w.getLanguageIdAtPosition(D.startLineNumber,D.startColumn),Q=U.getLanguageConfiguration(G).indentRulesSupport;if(!Q)return null;const X=new IndentationContextProcessor(w,U).getProcessedTokenContextAroundRange(D),J=X.beforeRangeProcessedTokens.getLineContent(),te=X.afterRangeProcessedTokens.getLineContent(),ie=J+te,se=J+O+te;if(!Q.shouldDecrease(ie)&&Q.shouldDecrease(se)){const ae=getInheritIndentForLine(K,w,D.startLineNumber,!1,U);if(!ae)return null;let le=ae.indentation;return ae.action!==IndentAction$1.Indent&&(le=W.unshiftIndent(le)),le}const re=D.startLineNumber-1;if(re>0){const ae=w.getLineContent(re);if(Q.shouldIndentNextLine(ae)&&Q.shouldIncrease(se)){const de=getInheritIndentForLine(K,w,D.startLineNumber,!1,U)?.indentation;if(de!==void 0){const oe=w.getLineContent(D.startLineNumber),ue=getLeadingWhitespace(oe),fe=W.shiftIndent(de)===ue,Ce=/^\s*$/.test(ie),we=F.autoClosingPairs.autoClosingPairsOpenByEnd.get(O),Te=we&&we.length>0&&Ce;if(fe&&Te)return de}}}return null}function createVirtualModelWithModifiedTokensAtLine(F,w,D){return{tokenization:{getLineTokens:W=>W===w?D:F.tokenization.getLineTokens(W),getLanguageId:()=>F.getLanguageId(),getLanguageIdAtPosition:(W,U)=>F.getLanguageIdAtPosition(W,U)},getLineContent:W=>W===w?D.getLineContent():F.getLineContent(W)}}class AutoIndentOperation{static getEdits(w,D,O,W,U){if(!U&&this._isAutoIndentType(w,D,O)){const K=[];for(const G of O){const Q=this._findActualIndentationForSelection(w,D,G,W);if(Q===null)return;K.push({selection:G,indentation:Q})}const q=AutoClosingOpenCharTypeOperation.getAutoClosingPairClose(w,D,O,W,!1);return this._getIndentationAndAutoClosingPairEdits(w,D,K,W,q)}}static _isAutoIndentType(w,D,O){if(w.autoIndent<4)return!1;for(let W=0,U=O.length;W<U;W++)if(!D.tokenization.isCheapToTokenize(O[W].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(w,D,O,W){const U=getIndentActionForType(w,D,O,W,{shiftIndent:q=>shiftIndent(w,q),unshiftIndent:q=>unshiftIndent(w,q)},w.languageConfigurationService);if(U===null)return null;const K=getIndentationAtPosition(D,O.startLineNumber,O.startColumn);return U===w.normalizeIndentation(K)?null:U}static _getIndentationAndAutoClosingPairEdits(w,D,O,W,U){const K=O.map(({selection:G,indentation:Q})=>{if(U!==null){const Y=this._getEditFromIndentationAndSelection(w,D,Q,G,W,!1);return new TypeWithIndentationAndAutoClosingCommand(Y,G,W,U)}else{const Y=this._getEditFromIndentationAndSelection(w,D,Q,G,W,!0);return typeCommand(Y.range,Y.text,!1)}}),q={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new EditOperationResult(4,K,q)}static _getEditFromIndentationAndSelection(w,D,O,W,U,K=!0){const q=W.startLineNumber,G=D.getLineFirstNonWhitespaceColumn(q);let Q=w.normalizeIndentation(O);if(G!==0){const X=D.getLineContent(q);Q+=X.substring(G-1,W.startColumn-1)}return Q+=K?U:"",{range:new Range$2(q,1,W.endLineNumber,W.endColumn),text:Q}}}class AutoClosingOvertypeOperation{static getEdits(w,D,O,W,U,K){if(isAutoClosingOvertype(D,O,W,U,K))return this._runAutoClosingOvertype(w,W,K)}static _runAutoClosingOvertype(w,D,O){const W=[];for(let U=0,K=D.length;U<K;U++){const G=D[U].getPosition(),Q=new Range$2(G.lineNumber,G.column,G.lineNumber,G.column+1);W[U]=new ReplaceCommand(Q,O)}return new EditOperationResult(4,W,{shouldPushStackElementBefore:shouldPushStackElementBetween(w,4),shouldPushStackElementAfter:!1})}}class AutoClosingOvertypeWithInterceptorsOperation{static getEdits(w,D,O,W,U){if(isAutoClosingOvertype(w,D,O,W,U)){const K=O.map(q=>new ReplaceCommand(new Range$2(q.positionLineNumber,q.positionColumn,q.positionLineNumber,q.positionColumn+1),"",!1));return new EditOperationResult(4,K,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}}class AutoClosingOpenCharTypeOperation{static getEdits(w,D,O,W,U,K){if(!K){const q=this.getAutoClosingPairClose(w,D,O,W,U);if(q!==null)return this._runAutoClosingOpenCharType(O,W,U,q)}}static _runAutoClosingOpenCharType(w,D,O,W){const U=[];for(let K=0,q=w.length;K<q;K++){const G=w[K];U[K]=new TypeWithAutoClosingCommand(G,D,!O,W)}return new EditOperationResult(4,U,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(w,D,O,W,U){for(const ie of O)if(!ie.isEmpty())return null;const K=O.map(ie=>{const se=ie.getPosition();return U?{lineNumber:se.lineNumber,beforeColumn:se.column-W.length,afterColumn:se.column}:{lineNumber:se.lineNumber,beforeColumn:se.column,afterColumn:se.column}}),q=this._findAutoClosingPairOpen(w,D,K.map(ie=>new Position$1(ie.lineNumber,ie.beforeColumn)),W);if(!q)return null;let G,Q;if(isQuote(W)?(G=w.autoClosingQuotes,Q=w.shouldAutoCloseBefore.quote):(w.blockCommentStartToken?q.open.includes(w.blockCommentStartToken):!1)?(G=w.autoClosingComments,Q=w.shouldAutoCloseBefore.comment):(G=w.autoClosingBrackets,Q=w.shouldAutoCloseBefore.bracket),G==="never")return null;const X=this._findContainedAutoClosingPair(w,q),J=X?X.close:"";let te=!0;for(const ie of K){const{lineNumber:se,beforeColumn:re,afterColumn:ae}=ie,le=D.getLineContent(se),de=le.substring(0,re-1),oe=le.substring(ae-1);if(oe.startsWith(J)||(te=!1),oe.length>0){const Ce=oe.charAt(0);if(!this._isBeforeClosingBrace(w,oe)&&!Q(Ce))return null}if(q.open.length===1&&(W==="'"||W==='"')&&G!=="always"){const Ce=getMapForWordSeparators(w.wordSeparators,[]);if(de.length>0){const we=de.charCodeAt(de.length-1);if(Ce.get(we)===0)return null}}if(!D.tokenization.isCheapToTokenize(se))return null;D.tokenization.forceTokenization(se);const ue=D.tokenization.getLineTokens(se),pe=createScopedLineTokens(ue,re-1);if(!q.shouldAutoClose(pe,re-pe.firstCharOffset))return null;const fe=q.findNeutralCharacter();if(fe){const Ce=D.tokenization.getTokenTypeIfInsertingCharacter(se,re,fe);if(!q.isOK(Ce))return null}}return te?q.close.substring(0,q.close.length-J.length):q.close}static _findContainedAutoClosingPair(w,D){if(D.open.length<=1)return null;const O=D.close.charAt(D.close.length-1),W=w.autoClosingPairs.autoClosingPairsCloseByEnd.get(O)||[];let U=null;for(const K of W)K.open!==D.open&&D.open.includes(K.open)&&D.close.endsWith(K.close)&&(!U||K.open.length>U.open.length)&&(U=K);return U}static _findAutoClosingPairOpen(w,D,O,W){const U=w.autoClosingPairs.autoClosingPairsOpenByEnd.get(W);if(!U)return null;let K=null;for(const q of U)if(K===null||q.open.length>K.open.length){let G=!0;for(const Q of O)if(D.getValueInRange(new Range$2(Q.lineNumber,Q.column-q.open.length+1,Q.lineNumber,Q.column))+W!==q.open){G=!1;break}G&&(K=q)}return K}static _isBeforeClosingBrace(w,D){const O=D.charAt(0),W=w.autoClosingPairs.autoClosingPairsOpenByStart.get(O)||[],U=w.autoClosingPairs.autoClosingPairsCloseByStart.get(O)||[],K=W.some(G=>D.startsWith(G.open)),q=U.some(G=>D.startsWith(G.close));return!K&&q}}class SurroundSelectionOperation{static getEdits(w,D,O,W,U){if(!U&&this._isSurroundSelectionType(w,D,O,W))return this._runSurroundSelectionType(w,O,W)}static _runSurroundSelectionType(w,D,O){const W=[];for(let U=0,K=D.length;U<K;U++){const q=D[U],G=w.surroundingPairs[O];W[U]=new SurroundSelectionCommand(q,O,G)}return new EditOperationResult(0,W,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(w,D,O,W){if(!shouldSurroundChar(w,W)||!w.surroundingPairs.hasOwnProperty(W))return!1;const U=isQuote(W);for(const K of O){if(K.isEmpty())return!1;let q=!0;for(let G=K.startLineNumber;G<=K.endLineNumber;G++){const Q=D.getLineContent(G),Y=G===K.startLineNumber?K.startColumn-1:0,X=G===K.endLineNumber?K.endColumn-1:Q.length,J=Q.substring(Y,X);if(/[^ \t]/.test(J)){q=!1;break}}if(q)return!1;if(U&&K.startLineNumber===K.endLineNumber&&K.startColumn+1===K.endColumn){const G=D.getValueInRange(K);if(isQuote(G))return!1}}return!0}}class InterceptorElectricCharOperation{static getEdits(w,D,O,W,U,K){if(!K&&this._isTypeInterceptorElectricChar(D,O,W)){const q=this._typeInterceptorElectricChar(w,D,O,W[0],U);if(q)return q}}static _isTypeInterceptorElectricChar(w,D,O){return!!(O.length===1&&D.tokenization.isCheapToTokenize(O[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(w,D,O,W,U){if(!D.electricChars.hasOwnProperty(U)||!W.isEmpty())return null;const K=W.getPosition();O.tokenization.forceTokenization(K.lineNumber);const q=O.tokenization.getLineTokens(K.lineNumber);let G;try{G=D.onElectricCharacter(U,q,K.column)}catch(Q){return onUnexpectedError(Q),null}if(!G)return null;if(G.matchOpenBracket){const Q=(q.getLineContent()+U).lastIndexOf(G.matchOpenBracket)+1,Y=O.bracketPairs.findMatchingBracketUp(G.matchOpenBracket,{lineNumber:K.lineNumber,column:Q},500);if(Y){if(Y.startLineNumber===K.lineNumber)return null;const X=O.getLineContent(Y.startLineNumber),J=getLeadingWhitespace(X),te=D.normalizeIndentation(J),ie=O.getLineContent(K.lineNumber),se=O.getLineFirstNonWhitespaceColumn(K.lineNumber)||K.column,re=ie.substring(se-1,K.column-1),ae=te+re+U,le=new Range$2(K.lineNumber,1,K.lineNumber,K.column),de=new ReplaceCommand(le,ae);return new EditOperationResult(getTypingOperation(ae,w),[de],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}}class SimpleCharacterTypeOperation{static getEdits(w,D,O){const W=[];for(let K=0,q=D.length;K<q;K++)W[K]=new ReplaceCommand(D[K],O);const U=getTypingOperation(O,w);return new EditOperationResult(U,W,{shouldPushStackElementBefore:shouldPushStackElementBetween(w,U),shouldPushStackElementAfter:!1})}}class EnterOperation{static getEdits(w,D,O,W,U){if(!U&&W===`
`){const K=[];for(let q=0,G=O.length;q<G;q++)K[q]=this._enter(w,D,!1,O[q]);return new EditOperationResult(4,K,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(w,D,O,W){if(w.autoIndent===0)return typeCommand(W,`
`,O);if(!D.tokenization.isCheapToTokenize(W.getStartPosition().lineNumber)||w.autoIndent===1){const G=D.getLineContent(W.startLineNumber),Q=getLeadingWhitespace(G).substring(0,W.startColumn-1);return typeCommand(W,`
`+w.normalizeIndentation(Q),O)}const U=getEnterAction(w.autoIndent,D,W,w.languageConfigurationService);if(U){if(U.indentAction===IndentAction$1.None)return typeCommand(W,`
`+w.normalizeIndentation(U.indentation+U.appendText),O);if(U.indentAction===IndentAction$1.Indent)return typeCommand(W,`
`+w.normalizeIndentation(U.indentation+U.appendText),O);if(U.indentAction===IndentAction$1.IndentOutdent){const G=w.normalizeIndentation(U.indentation),Q=w.normalizeIndentation(U.indentation+U.appendText),Y=`
`+Q+`
`+G;return O?new ReplaceCommandWithoutChangingPosition(W,Y,!0):new ReplaceCommandWithOffsetCursorState(W,Y,-1,Q.length-G.length,!0)}else if(U.indentAction===IndentAction$1.Outdent){const G=unshiftIndent(w,U.indentation);return typeCommand(W,`
`+w.normalizeIndentation(G+U.appendText),O)}}const K=D.getLineContent(W.startLineNumber),q=getLeadingWhitespace(K).substring(0,W.startColumn-1);if(w.autoIndent>=4){const G=getIndentForEnter(w.autoIndent,D,W,{unshiftIndent:Q=>unshiftIndent(w,Q),shiftIndent:Q=>shiftIndent(w,Q),normalizeIndentation:Q=>w.normalizeIndentation(Q)},w.languageConfigurationService);if(G){let Q=w.visibleColumnFromColumn(D,W.getEndPosition());const Y=W.endColumn,X=D.getLineContent(W.endLineNumber),J=firstNonWhitespaceIndex(X);if(J>=0?W=W.setEndPosition(W.endLineNumber,Math.max(W.endColumn,J+1)):W=W.setEndPosition(W.endLineNumber,D.getLineMaxColumn(W.endLineNumber)),O)return new ReplaceCommandWithoutChangingPosition(W,`
`+w.normalizeIndentation(G.afterEnter),!0);{let te=0;return Y<=J+1&&(w.insertSpaces||(Q=Math.ceil(Q/w.indentSize)),te=Math.min(Q+1-w.normalizeIndentation(G.afterEnter).length-1,0)),new ReplaceCommandWithOffsetCursorState(W,`
`+w.normalizeIndentation(G.afterEnter),0,te,!0)}}}return typeCommand(W,`
`+w.normalizeIndentation(q),O)}static lineInsertBefore(w,D,O){if(D===null||O===null)return[];const W=[];for(let U=0,K=O.length;U<K;U++){let q=O[U].positionLineNumber;if(q===1)W[U]=new ReplaceCommandWithoutChangingPosition(new Range$2(1,1,1,1),`
`);else{q--;const G=D.getLineMaxColumn(q);W[U]=this._enter(w,D,!1,new Range$2(q,G,q,G))}}return W}static lineInsertAfter(w,D,O){if(D===null||O===null)return[];const W=[];for(let U=0,K=O.length;U<K;U++){const q=O[U].positionLineNumber,G=D.getLineMaxColumn(q);W[U]=this._enter(w,D,!1,new Range$2(q,G,q,G))}return W}static lineBreakInsert(w,D,O){const W=[];for(let U=0,K=O.length;U<K;U++)W[U]=this._enter(w,D,!0,O[U]);return W}}class PasteOperation{static getEdits(w,D,O,W,U,K){const q=this._distributePasteToCursors(w,O,W,U,K);return q?(O=O.sort(Range$2.compareRangesUsingStarts),this._distributedPaste(w,D,O,q)):this._simplePaste(w,D,O,W,U)}static _distributePasteToCursors(w,D,O,W,U){if(W||D.length===1)return null;if(U&&U.length===D.length)return U;if(w.multiCursorPaste==="spread"){O.charCodeAt(O.length-1)===10&&(O=O.substring(0,O.length-1)),O.charCodeAt(O.length-1)===13&&(O=O.substring(0,O.length-1));const K=splitLines(O);if(K.length===D.length)return K}return null}static _distributedPaste(w,D,O,W){const U=[];for(let K=0,q=O.length;K<q;K++)U[K]=new ReplaceCommand(O[K],W[K]);return new EditOperationResult(0,U,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(w,D,O,W,U){const K=[];for(let q=0,G=O.length;q<G;q++){const Q=O[q],Y=Q.getPosition();if(U&&!Q.isEmpty()&&(U=!1),U&&W.indexOf(`
`)!==W.length-1&&(U=!1),U){const X=new Range$2(Y.lineNumber,1,Y.lineNumber,1);K[q]=new ReplaceCommandThatPreservesSelection(X,W,Q,!0)}else K[q]=new ReplaceCommand(Q,W)}return new EditOperationResult(0,K,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class CompositionOperation{static getEdits(w,D,O,W,U,K,q,G){const Q=W.map(Y=>this._compositionType(O,Y,U,K,q,G));return new EditOperationResult(4,Q,{shouldPushStackElementBefore:shouldPushStackElementBetween(w,4),shouldPushStackElementAfter:!1})}static _compositionType(w,D,O,W,U,K){if(!D.isEmpty())return null;const q=D.getPosition(),G=Math.max(1,q.column-W),Q=Math.min(w.getLineMaxColumn(q.lineNumber),q.column+U),Y=new Range$2(q.lineNumber,G,q.lineNumber,Q);return w.getValueInRange(Y)===O&&K===0?null:new ReplaceCommandWithOffsetCursorState(Y,O,0,K)}}class TypeWithoutInterceptorsOperation{static getEdits(w,D,O){const W=[];for(let K=0,q=D.length;K<q;K++)W[K]=new ReplaceCommand(D[K],O);const U=getTypingOperation(O,w);return new EditOperationResult(U,W,{shouldPushStackElementBefore:shouldPushStackElementBetween(w,U),shouldPushStackElementAfter:!1})}}class TabOperation{static getCommands(w,D,O){const W=[];for(let U=0,K=O.length;U<K;U++){const q=O[U];if(q.isEmpty()){const G=D.getLineContent(q.startLineNumber);if(/^\s*$/.test(G)&&D.tokenization.isCheapToTokenize(q.startLineNumber)){let Q=this._goodIndentForLine(w,D,q.startLineNumber);Q=Q||"	";const Y=w.normalizeIndentation(Q);if(!G.startsWith(Y)){W[U]=new ReplaceCommand(new Range$2(q.startLineNumber,1,q.startLineNumber,G.length+1),Y,!0);continue}}W[U]=this._replaceJumpToNextIndent(w,D,q,!0)}else{if(q.startLineNumber===q.endLineNumber){const G=D.getLineMaxColumn(q.startLineNumber);if(q.startColumn!==1||q.endColumn!==G){W[U]=this._replaceJumpToNextIndent(w,D,q,!1);continue}}W[U]=new ShiftCommand(q,{isUnshift:!1,tabSize:w.tabSize,indentSize:w.indentSize,insertSpaces:w.insertSpaces,useTabStops:w.useTabStops,autoIndent:w.autoIndent},w.languageConfigurationService)}}return W}static _goodIndentForLine(w,D,O){let W=null,U="";const K=getInheritIndentForLine(w.autoIndent,D,O,!1,w.languageConfigurationService);if(K)W=K.action,U=K.indentation;else if(O>1){let q;for(q=O-1;q>=1;q--){const Y=D.getLineContent(q);if(lastNonWhitespaceIndex(Y)>=0)break}if(q<1)return null;const G=D.getLineMaxColumn(q),Q=getEnterAction(w.autoIndent,D,new Range$2(q,G,q,G),w.languageConfigurationService);Q&&(U=Q.indentation+Q.appendText)}return W&&(W===IndentAction$1.Indent&&(U=shiftIndent(w,U)),W===IndentAction$1.Outdent&&(U=unshiftIndent(w,U)),U=w.normalizeIndentation(U)),U||null}static _replaceJumpToNextIndent(w,D,O,W){let U="";const K=O.getStartPosition();if(w.insertSpaces){const q=w.visibleColumnFromColumn(D,K),G=w.indentSize,Q=G-q%G;for(let Y=0;Y<Q;Y++)U+=" "}else U="	";return new ReplaceCommand(O,U,W)}}class BaseTypeWithAutoClosingCommand extends ReplaceCommandWithOffsetCursorState{constructor(w,D,O,W,U,K){super(w,D,O,W),this._openCharacter=U,this._closeCharacter=K,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(w,D,O){return this.closeCharacterRange=new Range$2(D.startLineNumber,D.endColumn-this._closeCharacter.length,D.endLineNumber,D.endColumn),this.enclosingRange=new Range$2(D.startLineNumber,D.endColumn-this._openCharacter.length-this._closeCharacter.length,D.endLineNumber,D.endColumn),super.computeCursorState(w,O)}}class TypeWithAutoClosingCommand extends BaseTypeWithAutoClosingCommand{constructor(w,D,O,W){const U=(O?D:"")+W,K=0,q=-W.length;super(w,U,K,q,D,W)}computeCursorState(w,D){const W=D.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(w,W,D)}}class TypeWithIndentationAndAutoClosingCommand extends BaseTypeWithAutoClosingCommand{constructor(w,D,O,W){const U=O+W,K=0,q=O.length;super(D,U,K,q,O,W),this._autoIndentationEdit=w,this._autoClosingEdit={range:D,text:U}}getEditOperations(w,D){D.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),D.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(w,D){const O=D.getInverseEditOperations();if(O.length!==2)throw new Error("There should be two inverse edit operations!");const W=O[0].range,U=O[1].range,K=W.plusRange(U);return this._computeCursorStateWithRange(w,K,D)}}function getTypingOperation(F,w){return F===" "?w===5||w===6?6:5:4}function shouldPushStackElementBetween(F,w){return isTypingOperation(F)&&!isTypingOperation(w)?!0:F===5?!1:normalizeOperationType(F)!==normalizeOperationType(w)}function normalizeOperationType(F){return F===6||F===5?"space":F}function isTypingOperation(F){return F===4||F===5||F===6}function isAutoClosingOvertype(F,w,D,O,W){if(F.autoClosingOvertype==="never"||!F.autoClosingPairs.autoClosingPairsCloseSingleChar.has(W))return!1;for(let U=0,K=D.length;U<K;U++){const q=D[U];if(!q.isEmpty())return!1;const G=q.getPosition(),Q=w.getLineContent(G.lineNumber);if(Q.charAt(G.column-1)!==W)return!1;const X=isQuote(W);if((G.column>2?Q.charCodeAt(G.column-2):0)===92&&X)return!1;if(F.autoClosingOvertype==="auto"){let te=!1;for(let ie=0,se=O.length;ie<se;ie++){const re=O[ie];if(G.lineNumber===re.startLineNumber&&G.column===re.startColumn){te=!0;break}}if(!te)return!1}}return!0}function typeCommand(F,w,D){return D?new ReplaceCommandWithoutChangingPosition(F,w,!0):new ReplaceCommand(F,w,!0)}function shiftIndent(F,w,D){return D=D||1,ShiftCommand.shiftIndent(w,w.length+D,F.tabSize,F.indentSize,F.insertSpaces)}function unshiftIndent(F,w,D){return D=D||1,ShiftCommand.unshiftIndent(w,w.length+D,F.tabSize,F.indentSize,F.insertSpaces)}function shouldSurroundChar(F,w){return isQuote(w)?F.autoSurround==="quotes"||F.autoSurround==="languageDefined":F.autoSurround==="brackets"||F.autoSurround==="languageDefined"}class TypeOperations{static indent(w,D,O){if(D===null||O===null)return[];const W=[];for(let U=0,K=O.length;U<K;U++)W[U]=new ShiftCommand(O[U],{isUnshift:!1,tabSize:w.tabSize,indentSize:w.indentSize,insertSpaces:w.insertSpaces,useTabStops:w.useTabStops,autoIndent:w.autoIndent},w.languageConfigurationService);return W}static outdent(w,D,O){const W=[];for(let U=0,K=O.length;U<K;U++)W[U]=new ShiftCommand(O[U],{isUnshift:!0,tabSize:w.tabSize,indentSize:w.indentSize,insertSpaces:w.insertSpaces,useTabStops:w.useTabStops,autoIndent:w.autoIndent},w.languageConfigurationService);return W}static paste(w,D,O,W,U,K){return PasteOperation.getEdits(w,D,O,W,U,K)}static tab(w,D,O){return TabOperation.getCommands(w,D,O)}static compositionType(w,D,O,W,U,K,q,G){return CompositionOperation.getEdits(w,D,O,W,U,K,q,G)}static compositionEndWithInterceptors(w,D,O,W,U,K){if(!W)return null;let q=null;for(const J of W)if(q===null)q=J.insertedText;else if(q!==J.insertedText)return null;if(!q||q.length!==1)return null;const G=q;let Q=!1;for(const J of W)if(J.deletedText.length!==0){Q=!0;break}if(Q){if(!shouldSurroundChar(D,G)||!D.surroundingPairs.hasOwnProperty(G))return null;const J=isQuote(G);for(const se of W)if(se.deletedSelectionStart!==0||se.deletedSelectionEnd!==se.deletedText.length||/^[ \t]+$/.test(se.deletedText)||J&&isQuote(se.deletedText))return null;const te=[];for(const se of U){if(!se.isEmpty())return null;te.push(se.getPosition())}if(te.length!==W.length)return null;const ie=[];for(let se=0,re=te.length;se<re;se++)ie.push(new CompositionSurroundSelectionCommand(te[se],W[se].deletedText,D.surroundingPairs[G]));return new EditOperationResult(4,ie,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const Y=AutoClosingOvertypeWithInterceptorsOperation.getEdits(D,O,U,K,G);if(Y!==void 0)return Y;const X=AutoClosingOpenCharTypeOperation.getEdits(D,O,U,G,!0,!1);return X!==void 0?X:null}static typeWithInterceptors(w,D,O,W,U,K,q){const G=EnterOperation.getEdits(O,W,U,q,w);if(G!==void 0)return G;const Q=AutoIndentOperation.getEdits(O,W,U,q,w);if(Q!==void 0)return Q;const Y=AutoClosingOvertypeOperation.getEdits(D,O,W,U,K,q);if(Y!==void 0)return Y;const X=AutoClosingOpenCharTypeOperation.getEdits(O,W,U,q,!1,w);if(X!==void 0)return X;const J=SurroundSelectionOperation.getEdits(O,W,U,q,w);if(J!==void 0)return J;const te=InterceptorElectricCharOperation.getEdits(D,O,W,U,q,w);return te!==void 0?te:SimpleCharacterTypeOperation.getEdits(D,U,q)}static typeWithoutInterceptors(w,D,O,W,U){return TypeWithoutInterceptorsOperation.getEdits(w,W,U)}}class CompositionOutcome{constructor(w,D,O,W,U,K){this.deletedText=w,this.deletedSelectionStart=D,this.deletedSelectionEnd=O,this.insertedText=W,this.insertedSelectionStart=U,this.insertedSelectionEnd=K}}const CORE_WEIGHT=0;class CoreEditorCommand extends EditorCommand{runEditorCommand(w,D,O){const W=D._getViewModel();W&&this.runCoreEditorCommand(W,O||{})}}var EditorScroll_;(function(F){const w=function(O){if(!isObject$1(O))return!1;const W=O;return!(!isString$1(W.to)||!isUndefined(W.by)&&!isString$1(W.by)||!isUndefined(W.value)&&!isNumber$1(W.value)||!isUndefined(W.revealCursor)&&!isBoolean$1(W.revealCursor))};F.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:w,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},F.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},F.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function D(O){let W;switch(O.to){case F.RawDirection.Up:W=1;break;case F.RawDirection.Right:W=2;break;case F.RawDirection.Down:W=3;break;case F.RawDirection.Left:W=4;break;default:return null}let U;switch(O.by){case F.RawUnit.Line:U=1;break;case F.RawUnit.WrappedLine:U=2;break;case F.RawUnit.Page:U=3;break;case F.RawUnit.HalfPage:U=4;break;case F.RawUnit.Editor:U=5;break;case F.RawUnit.Column:U=6;break;default:U=2}const K=Math.floor(O.value||1),q=!!O.revealCursor;return{direction:W,unit:U,value:K,revealCursor:q,select:!!O.select}}F.parse=D})(EditorScroll_||(EditorScroll_={}));var RevealLine_;(function(F){const w=function(D){if(!isObject$1(D))return!1;const O=D;return!(!isNumber$1(O.lineNumber)&&!isString$1(O.lineNumber)||!isUndefined(O.at)&&!isString$1(O.at))};F.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:w,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},F.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(RevealLine_||(RevealLine_={}));class EditorOrNativeTextInputCommand{constructor(w){w.addImplementation(1e4,"code-editor",(D,O)=>{const W=D.get(ICodeEditorService).getFocusedCodeEditor();return W&&W.hasTextFocus()?this._runEditorCommand(D,W,O):!1}),w.addImplementation(1e3,"generic-dom-input-textarea",(D,O)=>{const W=getActiveElement();return W&&["input","textarea"].indexOf(W.tagName.toLowerCase())>=0?(this.runDOMCommand(W),!0):!1}),w.addImplementation(0,"generic-dom",(D,O)=>{const W=D.get(ICodeEditorService).getActiveCodeEditor();return W?(W.focus(),this._runEditorCommand(D,W,O)):!1})}_runEditorCommand(w,D,O){const W=this.runEditorCommand(w,D,O);return W||!0}}var CoreNavigationCommands;(function(F){class w extends CoreEditorCommand{constructor(le){super(le),this._inSelectionMode=le.inSelectionMode}runCoreEditorCommand(le,de){if(!de.position)return;le.model.pushStackElement(),le.setCursorStates(de.source,3,[CursorMoveCommands.moveTo(le,le.getPrimaryCursorState(),this._inSelectionMode,de.position,de.viewPosition)])&&de.revealType!==2&&le.revealAllCursors(de.source,!0,!0)}}F.MoveTo=registerEditorCommand(new w({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),F.MoveToSelect=registerEditorCommand(new w({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class D extends CoreEditorCommand{runCoreEditorCommand(le,de){le.model.pushStackElement();const oe=this._getColumnSelectResult(le,le.getPrimaryCursorState(),le.getCursorColumnSelectData(),de);oe!==null&&(le.setCursorStates(de.source,3,oe.viewStates.map(ue=>CursorState.fromViewState(ue))),le.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:oe.fromLineNumber,fromViewVisualColumn:oe.fromVisualColumn,toViewLineNumber:oe.toLineNumber,toViewVisualColumn:oe.toVisualColumn}),oe.reversed?le.revealTopMostCursor(de.source):le.revealBottomMostCursor(de.source))}}F.ColumnSelect=registerEditorCommand(new class extends D{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(ae,le,de,oe){if(typeof oe.position>"u"||typeof oe.viewPosition>"u"||typeof oe.mouseColumn>"u")return null;const ue=ae.model.validatePosition(oe.position),pe=ae.coordinatesConverter.validateViewPosition(new Position$1(oe.viewPosition.lineNumber,oe.viewPosition.column),ue),fe=oe.doColumnSelect?de.fromViewLineNumber:pe.lineNumber,Ce=oe.doColumnSelect?de.fromViewVisualColumn:oe.mouseColumn-1;return ColumnSelection.columnSelect(ae.cursorConfig,ae,fe,Ce,pe.lineNumber,oe.mouseColumn-1)}}),F.CursorColumnSelectLeft=registerEditorCommand(new class extends D{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(ae,le,de,oe){return ColumnSelection.columnSelectLeft(ae.cursorConfig,ae,de)}}),F.CursorColumnSelectRight=registerEditorCommand(new class extends D{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(ae,le,de,oe){return ColumnSelection.columnSelectRight(ae.cursorConfig,ae,de)}});class O extends D{constructor(le){super(le),this._isPaged=le.isPaged}_getColumnSelectResult(le,de,oe,ue){return ColumnSelection.columnSelectUp(le.cursorConfig,le,oe,this._isPaged)}}F.CursorColumnSelectUp=registerEditorCommand(new O({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3600,linux:{primary:0}}})),F.CursorColumnSelectPageUp=registerEditorCommand(new O({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3595,linux:{primary:0}}}));class W extends D{constructor(le){super(le),this._isPaged=le.isPaged}_getColumnSelectResult(le,de,oe,ue){return ColumnSelection.columnSelectDown(le.cursorConfig,le,oe,this._isPaged)}}F.CursorColumnSelectDown=registerEditorCommand(new W({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3602,linux:{primary:0}}})),F.CursorColumnSelectPageDown=registerEditorCommand(new W({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3596,linux:{primary:0}}}));class U extends CoreEditorCommand{constructor(){super({id:"cursorMove",precondition:void 0,metadata:CursorMove.metadata})}runCoreEditorCommand(le,de){const oe=CursorMove.parse(de);oe&&this._runCursorMove(le,de.source,oe)}_runCursorMove(le,de,oe){le.model.pushStackElement(),le.setCursorStates(de,3,U._move(le,le.getCursorStates(),oe)),le.revealAllCursors(de,!0)}static _move(le,de,oe){const ue=oe.select,pe=oe.value;switch(oe.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return CursorMoveCommands.simpleMove(le,de,oe.direction,ue,pe,oe.unit);case 11:case 13:case 12:case 14:return CursorMoveCommands.viewportMove(le,de,oe.direction,ue,pe);default:return null}}}F.CursorMoveImpl=U,F.CursorMove=registerEditorCommand(new U);class K extends CoreEditorCommand{constructor(le){super(le),this._staticArgs=le.args}runCoreEditorCommand(le,de){let oe=this._staticArgs;this._staticArgs.value===-1&&(oe={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:de.pageSize||le.cursorConfig.pageSize}),le.model.pushStackElement(),le.setCursorStates(de.source,3,CursorMoveCommands.simpleMove(le,le.getCursorStates(),oe.direction,oe.select,oe.value,oe.unit)),le.revealAllCursors(de.source,!0)}}F.CursorLeft=registerEditorCommand(new K({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),F.CursorLeftSelect=registerEditorCommand(new K({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1039}})),F.CursorRight=registerEditorCommand(new K({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),F.CursorRightSelect=registerEditorCommand(new K({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1041}})),F.CursorUp=registerEditorCommand(new K({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),F.CursorUpSelect=registerEditorCommand(new K({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),F.CursorPageUp=registerEditorCommand(new K({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:11}})),F.CursorPageUpSelect=registerEditorCommand(new K({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1035}})),F.CursorDown=registerEditorCommand(new K({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),F.CursorDownSelect=registerEditorCommand(new K({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),F.CursorPageDown=registerEditorCommand(new K({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:12}})),F.CursorPageDownSelect=registerEditorCommand(new K({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1036}})),F.CreateCursor=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(ae,le){if(!le.position)return;let de;le.wholeLine?de=CursorMoveCommands.line(ae,ae.getPrimaryCursorState(),!1,le.position,le.viewPosition):de=CursorMoveCommands.moveTo(ae,ae.getPrimaryCursorState(),!1,le.position,le.viewPosition);const oe=ae.getCursorStates();if(oe.length>1){const ue=de.modelState?de.modelState.position:null,pe=de.viewState?de.viewState.position:null;for(let fe=0,Ce=oe.length;fe<Ce;fe++){const we=oe[fe];if(!(ue&&!we.modelState.selection.containsPosition(ue))&&!(pe&&!we.viewState.selection.containsPosition(pe))){oe.splice(fe,1),ae.model.pushStackElement(),ae.setCursorStates(le.source,3,oe);return}}}oe.push(de),ae.model.pushStackElement(),ae.setCursorStates(le.source,3,oe)}}),F.LastCursorMoveToSelect=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(ae,le){if(!le.position)return;const de=ae.getLastAddedCursorIndex(),oe=ae.getCursorStates(),ue=oe.slice(0);ue[de]=CursorMoveCommands.moveTo(ae,oe[de],!0,le.position,le.viewPosition),ae.model.pushStackElement(),ae.setCursorStates(le.source,3,ue)}});class q extends CoreEditorCommand{constructor(le){super(le),this._inSelectionMode=le.inSelectionMode}runCoreEditorCommand(le,de){le.model.pushStackElement(),le.setCursorStates(de.source,3,CursorMoveCommands.moveToBeginningOfLine(le,le.getCursorStates(),this._inSelectionMode)),le.revealAllCursors(de.source,!0)}}F.CursorHome=registerEditorCommand(new q({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),F.CursorHomeSelect=registerEditorCommand(new q({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class G extends CoreEditorCommand{constructor(le){super(le),this._inSelectionMode=le.inSelectionMode}runCoreEditorCommand(le,de){le.model.pushStackElement(),le.setCursorStates(de.source,3,this._exec(le.getCursorStates())),le.revealAllCursors(de.source,!0)}_exec(le){const de=[];for(let oe=0,ue=le.length;oe<ue;oe++){const pe=le[oe],fe=pe.modelState.position.lineNumber;de[oe]=CursorState.fromModelState(pe.modelState.move(this._inSelectionMode,fe,1,0))}return de}}F.CursorLineStart=registerEditorCommand(new G({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:287}}})),F.CursorLineStartSelect=registerEditorCommand(new G({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:1311}}}));class Q extends CoreEditorCommand{constructor(le){super(le),this._inSelectionMode=le.inSelectionMode}runCoreEditorCommand(le,de){le.model.pushStackElement(),le.setCursorStates(de.source,3,CursorMoveCommands.moveToEndOfLine(le,le.getCursorStates(),this._inSelectionMode,de.sticky||!1)),le.revealAllCursors(de.source,!0)}}F.CursorEnd=registerEditorCommand(new Q({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:localize("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),F.CursorEndSelect=registerEditorCommand(new Q({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:localize("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class Y extends CoreEditorCommand{constructor(le){super(le),this._inSelectionMode=le.inSelectionMode}runCoreEditorCommand(le,de){le.model.pushStackElement(),le.setCursorStates(de.source,3,this._exec(le,le.getCursorStates())),le.revealAllCursors(de.source,!0)}_exec(le,de){const oe=[];for(let ue=0,pe=de.length;ue<pe;ue++){const fe=de[ue],Ce=fe.modelState.position.lineNumber,we=le.model.getLineMaxColumn(Ce);oe[ue]=CursorState.fromModelState(fe.modelState.move(this._inSelectionMode,Ce,we,0))}return oe}}F.CursorLineEnd=registerEditorCommand(new Y({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:291}}})),F.CursorLineEndSelect=registerEditorCommand(new Y({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:1315}}}));class X extends CoreEditorCommand{constructor(le){super(le),this._inSelectionMode=le.inSelectionMode}runCoreEditorCommand(le,de){le.model.pushStackElement(),le.setCursorStates(de.source,3,CursorMoveCommands.moveToBeginningOfBuffer(le,le.getCursorStates(),this._inSelectionMode)),le.revealAllCursors(de.source,!0)}}F.CursorTop=registerEditorCommand(new X({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2062,mac:{primary:2064}}})),F.CursorTopSelect=registerEditorCommand(new X({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3086,mac:{primary:3088}}}));class J extends CoreEditorCommand{constructor(le){super(le),this._inSelectionMode=le.inSelectionMode}runCoreEditorCommand(le,de){le.model.pushStackElement(),le.setCursorStates(de.source,3,CursorMoveCommands.moveToEndOfBuffer(le,le.getCursorStates(),this._inSelectionMode)),le.revealAllCursors(de.source,!0)}}F.CursorBottom=registerEditorCommand(new J({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2061,mac:{primary:2066}}})),F.CursorBottomSelect=registerEditorCommand(new J({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3085,mac:{primary:3090}}}));class te extends CoreEditorCommand{constructor(){super({id:"editorScroll",precondition:void 0,metadata:EditorScroll_.metadata})}determineScrollMethod(le){const de=[6],oe=[1,2,3,4,5,6],ue=[4,2],pe=[1,3];return de.includes(le.unit)&&ue.includes(le.direction)?this._runHorizontalEditorScroll.bind(this):oe.includes(le.unit)&&pe.includes(le.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(le,de){const oe=EditorScroll_.parse(de);if(!oe)return;const ue=this.determineScrollMethod(oe);ue&&ue(le,de.source,oe)}_runVerticalEditorScroll(le,de,oe){const ue=this._computeDesiredScrollTop(le,oe);if(oe.revealCursor){const pe=le.getCompletelyVisibleViewRangeAtScrollTop(ue);le.setCursorStates(de,3,[CursorMoveCommands.findPositionInViewportIfOutside(le,le.getPrimaryCursorState(),pe,oe.select)])}le.viewLayout.setScrollPosition({scrollTop:ue},0)}_computeDesiredScrollTop(le,de){if(de.unit===1){const pe=le.viewLayout.getFutureViewport(),fe=le.getCompletelyVisibleViewRangeAtScrollTop(pe.top),Ce=le.coordinatesConverter.convertViewRangeToModelRange(fe);let we;de.direction===1?we=Math.max(1,Ce.startLineNumber-de.value):we=Math.min(le.model.getLineCount(),Ce.startLineNumber+de.value);const Oe=le.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(we,1));return le.viewLayout.getVerticalOffsetForLineNumber(Oe.lineNumber)}if(de.unit===5){let pe=0;return de.direction===3&&(pe=le.model.getLineCount()-le.cursorConfig.pageSize),le.viewLayout.getVerticalOffsetForLineNumber(pe)}let oe;de.unit===3?oe=le.cursorConfig.pageSize*de.value:de.unit===4?oe=Math.round(le.cursorConfig.pageSize/2)*de.value:oe=de.value;const ue=(de.direction===1?-1:1)*oe;return le.viewLayout.getCurrentScrollTop()+ue*le.cursorConfig.lineHeight}_runHorizontalEditorScroll(le,de,oe){const ue=this._computeDesiredScrollLeft(le,oe);le.viewLayout.setScrollPosition({scrollLeft:ue},0)}_computeDesiredScrollLeft(le,de){const oe=(de.direction===4?-1:1)*de.value;return le.viewLayout.getCurrentScrollLeft()+oe*le.cursorConfig.typicalHalfwidthCharacterWidth}}F.EditorScrollImpl=te,F.EditorScroll=registerEditorCommand(new te),F.ScrollLineUp=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(ae,le){F.EditorScroll.runCoreEditorCommand(ae,{to:EditorScroll_.RawDirection.Up,by:EditorScroll_.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:le.source})}}),F.ScrollPageUp=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(ae,le){F.EditorScroll.runCoreEditorCommand(ae,{to:EditorScroll_.RawDirection.Up,by:EditorScroll_.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:le.source})}}),F.ScrollEditorTop=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus}})}runCoreEditorCommand(ae,le){F.EditorScroll.runCoreEditorCommand(ae,{to:EditorScroll_.RawDirection.Up,by:EditorScroll_.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:le.source})}}),F.ScrollLineDown=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(ae,le){F.EditorScroll.runCoreEditorCommand(ae,{to:EditorScroll_.RawDirection.Down,by:EditorScroll_.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:le.source})}}),F.ScrollPageDown=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(ae,le){F.EditorScroll.runCoreEditorCommand(ae,{to:EditorScroll_.RawDirection.Down,by:EditorScroll_.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:le.source})}}),F.ScrollEditorBottom=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus}})}runCoreEditorCommand(ae,le){F.EditorScroll.runCoreEditorCommand(ae,{to:EditorScroll_.RawDirection.Down,by:EditorScroll_.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:le.source})}}),F.ScrollLeft=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus}})}runCoreEditorCommand(ae,le){F.EditorScroll.runCoreEditorCommand(ae,{to:EditorScroll_.RawDirection.Left,by:EditorScroll_.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:le.source})}}),F.ScrollRight=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus}})}runCoreEditorCommand(ae,le){F.EditorScroll.runCoreEditorCommand(ae,{to:EditorScroll_.RawDirection.Right,by:EditorScroll_.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:le.source})}});class ie extends CoreEditorCommand{constructor(le){super(le),this._inSelectionMode=le.inSelectionMode}runCoreEditorCommand(le,de){de.position&&(le.model.pushStackElement(),le.setCursorStates(de.source,3,[CursorMoveCommands.word(le,le.getPrimaryCursorState(),this._inSelectionMode,de.position)]),de.revealType!==2&&le.revealAllCursors(de.source,!0,!0))}}F.WordSelect=registerEditorCommand(new ie({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),F.WordSelectDrag=registerEditorCommand(new ie({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),F.LastCursorWordSelect=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(ae,le){if(!le.position)return;const de=ae.getLastAddedCursorIndex(),oe=ae.getCursorStates(),ue=oe.slice(0),pe=oe[de];ue[de]=CursorMoveCommands.word(ae,pe,pe.modelState.hasSelection(),le.position),ae.model.pushStackElement(),ae.setCursorStates(le.source,3,ue)}});class se extends CoreEditorCommand{constructor(le){super(le),this._inSelectionMode=le.inSelectionMode}runCoreEditorCommand(le,de){de.position&&(le.model.pushStackElement(),le.setCursorStates(de.source,3,[CursorMoveCommands.line(le,le.getPrimaryCursorState(),this._inSelectionMode,de.position,de.viewPosition)]),de.revealType!==2&&le.revealAllCursors(de.source,!1,!0))}}F.LineSelect=registerEditorCommand(new se({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),F.LineSelectDrag=registerEditorCommand(new se({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class re extends CoreEditorCommand{constructor(le){super(le),this._inSelectionMode=le.inSelectionMode}runCoreEditorCommand(le,de){if(!de.position)return;const oe=le.getLastAddedCursorIndex(),ue=le.getCursorStates(),pe=ue.slice(0);pe[oe]=CursorMoveCommands.line(le,ue[oe],this._inSelectionMode,de.position,de.viewPosition),le.model.pushStackElement(),le.setCursorStates(de.source,3,pe)}}F.LastCursorLineSelect=registerEditorCommand(new re({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),F.LastCursorLineSelectDrag=registerEditorCommand(new re({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),F.CancelSelection=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"cancelSelection",precondition:EditorContextKeys.hasNonEmptySelection,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(ae,le){ae.model.pushStackElement(),ae.setCursorStates(le.source,3,[CursorMoveCommands.cancelSelection(ae,ae.getPrimaryCursorState())]),ae.revealAllCursors(le.source,!0)}}),F.RemoveSecondaryCursors=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"removeSecondaryCursors",precondition:EditorContextKeys.hasMultipleSelections,kbOpts:{weight:CORE_WEIGHT+1,kbExpr:EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(ae,le){ae.model.pushStackElement(),ae.setCursorStates(le.source,3,[ae.getPrimaryCursorState()]),ae.revealAllCursors(le.source,!0),status(localize("removedCursor","Removed secondary cursors"))}}),F.RevealLine=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"revealLine",precondition:void 0,metadata:RevealLine_.metadata})}runCoreEditorCommand(ae,le){const de=le,oe=de.lineNumber||0;let ue=typeof oe=="number"?oe+1:parseInt(oe)+1;ue<1&&(ue=1);const pe=ae.model.getLineCount();ue>pe&&(ue=pe);const fe=new Range$2(ue,1,ue,ae.model.getLineMaxColumn(ue));let Ce=0;if(de.at)switch(de.at){case RevealLine_.RawAtArgument.Top:Ce=3;break;case RevealLine_.RawAtArgument.Center:Ce=1;break;case RevealLine_.RawAtArgument.Bottom:Ce=4;break}const we=ae.coordinatesConverter.convertModelRangeToViewRange(fe);ae.revealRange(le.source,!1,we,Ce,0)}}),F.SelectAll=new class extends EditorOrNativeTextInputCommand{constructor(){super(SelectAllCommand)}runDOMCommand(ae){isFirefox$1&&(ae.focus(),ae.select()),ae.ownerDocument.execCommand("selectAll")}runEditorCommand(ae,le,de){const oe=le._getViewModel();oe&&this.runCoreEditorCommand(oe,de)}runCoreEditorCommand(ae,le){ae.model.pushStackElement(),ae.setCursorStates("keyboard",3,[CursorMoveCommands.selectAll(ae,ae.getPrimaryCursorState())])}},F.SetSelection=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(ae,le){le.selection&&(ae.model.pushStackElement(),ae.setCursorStates(le.source,3,[CursorState.fromModelSelection(le.selection)]))}})})(CoreNavigationCommands||(CoreNavigationCommands={}));const columnSelectionCondition=ContextKeyExpr.and(EditorContextKeys.textInputFocus,EditorContextKeys.columnSelection);function registerColumnSelection(F,w){KeybindingsRegistry.registerKeybindingRule({id:F,primary:w,when:columnSelectionCondition,weight:CORE_WEIGHT+1})}registerColumnSelection(CoreNavigationCommands.CursorColumnSelectLeft.id,1039);registerColumnSelection(CoreNavigationCommands.CursorColumnSelectRight.id,1041);registerColumnSelection(CoreNavigationCommands.CursorColumnSelectUp.id,1040);registerColumnSelection(CoreNavigationCommands.CursorColumnSelectPageUp.id,1035);registerColumnSelection(CoreNavigationCommands.CursorColumnSelectDown.id,1042);registerColumnSelection(CoreNavigationCommands.CursorColumnSelectPageDown.id,1036);function registerCommand$1(F){return F.register(),F}var CoreEditingCommands;(function(F){class w extends EditorCommand{runEditorCommand(O,W,U){const K=W._getViewModel();K&&this.runCoreEditingCommand(W,K,U||{})}}F.CoreEditingCommand=w,F.LineBreakInsert=registerEditorCommand(new class extends w{constructor(){super({id:"lineBreakInsert",precondition:EditorContextKeys.writable,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(D,O,W){D.pushUndoStop(),D.executeCommands(this.id,EnterOperation.lineBreakInsert(O.cursorConfig,O.model,O.getCursorStates().map(U=>U.modelState.selection)))}}),F.Outdent=registerEditorCommand(new class extends w{constructor(){super({id:"outdent",precondition:EditorContextKeys.writable,kbOpts:{weight:CORE_WEIGHT,kbExpr:ContextKeyExpr.and(EditorContextKeys.editorTextFocus,EditorContextKeys.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(D,O,W){D.pushUndoStop(),D.executeCommands(this.id,TypeOperations.outdent(O.cursorConfig,O.model,O.getCursorStates().map(U=>U.modelState.selection))),D.pushUndoStop()}}),F.Tab=registerEditorCommand(new class extends w{constructor(){super({id:"tab",precondition:EditorContextKeys.writable,kbOpts:{weight:CORE_WEIGHT,kbExpr:ContextKeyExpr.and(EditorContextKeys.editorTextFocus,EditorContextKeys.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(D,O,W){D.pushUndoStop(),D.executeCommands(this.id,TypeOperations.tab(O.cursorConfig,O.model,O.getCursorStates().map(U=>U.modelState.selection))),D.pushUndoStop()}}),F.DeleteLeft=registerEditorCommand(new class extends w{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(D,O,W){const[U,K]=DeleteOperations.deleteLeft(O.getPrevEditOperationType(),O.cursorConfig,O.model,O.getCursorStates().map(q=>q.modelState.selection),O.getCursorAutoClosedCharacters());U&&D.pushUndoStop(),D.executeCommands(this.id,K),O.setPrevEditOperationType(2)}}),F.DeleteRight=registerEditorCommand(new class extends w{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(D,O,W){const[U,K]=DeleteOperations.deleteRight(O.getPrevEditOperationType(),O.cursorConfig,O.model,O.getCursorStates().map(q=>q.modelState.selection));U&&D.pushUndoStop(),D.executeCommands(this.id,K),O.setPrevEditOperationType(3)}}),F.Undo=new class extends EditorOrNativeTextInputCommand{constructor(){super(UndoCommand)}runDOMCommand(D){D.ownerDocument.execCommand("undo")}runEditorCommand(D,O,W){if(!(!O.hasModel()||O.getOption(92)===!0))return O.getModel().undo()}},F.Redo=new class extends EditorOrNativeTextInputCommand{constructor(){super(RedoCommand)}runDOMCommand(D){D.ownerDocument.execCommand("redo")}runEditorCommand(D,O,W){if(!(!O.hasModel()||O.getOption(92)===!0))return O.getModel().redo()}}})(CoreEditingCommands||(CoreEditingCommands={}));class EditorHandlerCommand extends Command$1{constructor(w,D,O){super({id:w,precondition:void 0,metadata:O}),this._handlerId=D}runCommand(w,D){const O=w.get(ICodeEditorService).getFocusedCodeEditor();O&&O.trigger("keyboard",this._handlerId,D)}}function registerOverwritableCommand(F,w){registerCommand$1(new EditorHandlerCommand("default:"+F,F)),registerCommand$1(new EditorHandlerCommand(F,F,w))}registerOverwritableCommand("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});registerOverwritableCommand("replacePreviousChar");registerOverwritableCommand("compositionType");registerOverwritableCommand("compositionStart");registerOverwritableCommand("compositionEnd");registerOverwritableCommand("paste");registerOverwritableCommand("cut");class ViewController{constructor(w,D,O,W){this.configuration=w,this.viewModel=D,this.userInputEvents=O,this.commandDelegate=W}paste(w,D,O,W){this.commandDelegate.paste(w,D,O,W)}type(w){this.commandDelegate.type(w)}compositionType(w,D,O,W){this.commandDelegate.compositionType(w,D,O,W)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(w){CoreNavigationCommands.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:w})}_validateViewColumn(w){const D=this.viewModel.getLineMinColumn(w.lineNumber);return w.column<D?new Position$1(w.lineNumber,D):w}_hasMulticursorModifier(w){switch(this.configuration.options.get(78)){case"altKey":return w.altKey;case"ctrlKey":return w.ctrlKey;case"metaKey":return w.metaKey;default:return!1}}_hasNonMulticursorModifier(w){switch(this.configuration.options.get(78)){case"altKey":return w.ctrlKey||w.metaKey;case"ctrlKey":return w.altKey||w.metaKey;case"metaKey":return w.ctrlKey||w.altKey;default:return!1}}dispatchMouse(w){const D=this.configuration.options,O=isLinux&&D.get(108),W=D.get(22);w.middleButton&&!O?this._columnSelect(w.position,w.mouseColumn,w.inSelectionMode):w.startedOnLineNumbers?this._hasMulticursorModifier(w)?w.inSelectionMode?this._lastCursorLineSelect(w.position,w.revealType):this._createCursor(w.position,!0):w.inSelectionMode?this._lineSelectDrag(w.position,w.revealType):this._lineSelect(w.position,w.revealType):w.mouseDownCount>=4?this._selectAll():w.mouseDownCount===3?this._hasMulticursorModifier(w)?w.inSelectionMode?this._lastCursorLineSelectDrag(w.position,w.revealType):this._lastCursorLineSelect(w.position,w.revealType):w.inSelectionMode?this._lineSelectDrag(w.position,w.revealType):this._lineSelect(w.position,w.revealType):w.mouseDownCount===2?w.onInjectedText||(this._hasMulticursorModifier(w)?this._lastCursorWordSelect(w.position,w.revealType):w.inSelectionMode?this._wordSelectDrag(w.position,w.revealType):this._wordSelect(w.position,w.revealType)):this._hasMulticursorModifier(w)?this._hasNonMulticursorModifier(w)||(w.shiftKey?this._columnSelect(w.position,w.mouseColumn,!0):w.inSelectionMode?this._lastCursorMoveToSelect(w.position,w.revealType):this._createCursor(w.position,!1)):w.inSelectionMode?w.altKey?this._columnSelect(w.position,w.mouseColumn,!0):W?this._columnSelect(w.position,w.mouseColumn,!0):this._moveToSelect(w.position,w.revealType):this.moveTo(w.position,w.revealType)}_usualArgs(w,D){return w=this._validateViewColumn(w),{source:"mouse",position:this._convertViewToModelPosition(w),viewPosition:w,revealType:D}}moveTo(w,D){CoreNavigationCommands.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(w,D))}_moveToSelect(w,D){CoreNavigationCommands.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(w,D))}_columnSelect(w,D,O){w=this._validateViewColumn(w),CoreNavigationCommands.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(w),viewPosition:w,mouseColumn:D,doColumnSelect:O})}_createCursor(w,D){w=this._validateViewColumn(w),CoreNavigationCommands.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(w),viewPosition:w,wholeLine:D})}_lastCursorMoveToSelect(w,D){CoreNavigationCommands.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(w,D))}_wordSelect(w,D){CoreNavigationCommands.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(w,D))}_wordSelectDrag(w,D){CoreNavigationCommands.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(w,D))}_lastCursorWordSelect(w,D){CoreNavigationCommands.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(w,D))}_lineSelect(w,D){CoreNavigationCommands.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(w,D))}_lineSelectDrag(w,D){CoreNavigationCommands.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(w,D))}_lastCursorLineSelect(w,D){CoreNavigationCommands.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(w,D))}_lastCursorLineSelectDrag(w,D){CoreNavigationCommands.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(w,D))}_selectAll(){CoreNavigationCommands.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(w){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(w)}emitKeyDown(w){this.userInputEvents.emitKeyDown(w)}emitKeyUp(w){this.userInputEvents.emitKeyUp(w)}emitContextMenu(w){this.userInputEvents.emitContextMenu(w)}emitMouseMove(w){this.userInputEvents.emitMouseMove(w)}emitMouseLeave(w){this.userInputEvents.emitMouseLeave(w)}emitMouseUp(w){this.userInputEvents.emitMouseUp(w)}emitMouseDown(w){this.userInputEvents.emitMouseDown(w)}emitMouseDrag(w){this.userInputEvents.emitMouseDrag(w)}emitMouseDrop(w){this.userInputEvents.emitMouseDrop(w)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(w){this.userInputEvents.emitMouseWheel(w)}}function createTrustedTypesPolicy(F,w){const D=globalThis.MonacoEnvironment;if(D?.createTrustedTypesPolicy)try{return D.createTrustedTypesPolicy(F,w)}catch(O){onUnexpectedError(O);return}try{return globalThis.trustedTypes?.createPolicy(F,w)}catch(O){onUnexpectedError(O);return}}class RenderedLinesCollection{constructor(w){this._lineFactory=w,this._set(1,[])}flush(){this._set(1,[])}_set(w,D){this._lines=D,this._rendLineNumberStart=w}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(w){const D=w-this._rendLineNumberStart;if(D<0||D>=this._lines.length)throw new BugIndicatingError("Illegal value for lineNumber");return this._lines[D]}onLinesDeleted(w,D){if(this.getCount()===0)return null;const O=this.getStartLineNumber(),W=this.getEndLineNumber();if(D<O){const G=D-w+1;return this._rendLineNumberStart-=G,null}if(w>W)return null;let U=0,K=0;for(let G=O;G<=W;G++){const Q=G-this._rendLineNumberStart;w<=G&&G<=D&&(K===0?(U=Q,K=1):K++)}if(w<O){let G=0;D<O?G=D-w+1:G=O-w,this._rendLineNumberStart-=G}return this._lines.splice(U,K)}onLinesChanged(w,D){const O=w+D-1;if(this.getCount()===0)return!1;const W=this.getStartLineNumber(),U=this.getEndLineNumber();let K=!1;for(let q=w;q<=O;q++)q>=W&&q<=U&&(this._lines[q-this._rendLineNumberStart].onContentChanged(),K=!0);return K}onLinesInserted(w,D){if(this.getCount()===0)return null;const O=D-w+1,W=this.getStartLineNumber(),U=this.getEndLineNumber();if(w<=W)return this._rendLineNumberStart+=O,null;if(w>U)return null;if(O+w>U)return this._lines.splice(w-this._rendLineNumberStart,U-w+1);const K=[];for(let X=0;X<O;X++)K[X]=this._lineFactory.createLine();const q=w-this._rendLineNumberStart,G=this._lines.slice(0,q),Q=this._lines.slice(q,this._lines.length-O),Y=this._lines.slice(this._lines.length-O,this._lines.length);return this._lines=G.concat(K).concat(Q),Y}onTokensChanged(w){if(this.getCount()===0)return!1;const D=this.getStartLineNumber(),O=this.getEndLineNumber();let W=!1;for(let U=0,K=w.length;U<K;U++){const q=w[U];if(q.toLineNumber<D||q.fromLineNumber>O)continue;const G=Math.max(D,q.fromLineNumber),Q=Math.min(O,q.toLineNumber);for(let Y=G;Y<=Q;Y++){const X=Y-this._rendLineNumberStart;this._lines[X].onTokensChanged(),W=!0}}return W}}class VisibleLinesCollection{constructor(w){this._lineFactory=w,this.domNode=this._createDomNode(),this._linesCollection=new RenderedLinesCollection(this._lineFactory)}_createDomNode(){const w=createFastDomNode(document.createElement("div"));return w.setClassName("view-layer"),w.setPosition("absolute"),w.domNode.setAttribute("role","presentation"),w.domNode.setAttribute("aria-hidden","true"),w}onConfigurationChanged(w){return!!w.hasChanged(146)}onFlushed(w){return this._linesCollection.flush(),!0}onLinesChanged(w){return this._linesCollection.onLinesChanged(w.fromLineNumber,w.count)}onLinesDeleted(w){const D=this._linesCollection.onLinesDeleted(w.fromLineNumber,w.toLineNumber);if(D)for(let O=0,W=D.length;O<W;O++)D[O].getDomNode()?.remove();return!0}onLinesInserted(w){const D=this._linesCollection.onLinesInserted(w.fromLineNumber,w.toLineNumber);if(D)for(let O=0,W=D.length;O<W;O++)D[O].getDomNode()?.remove();return!0}onScrollChanged(w){return w.scrollTopChanged}onTokensChanged(w){return this._linesCollection.onTokensChanged(w.ranges)}onZonesChanged(w){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(w){return this._linesCollection.getLine(w)}renderLines(w){const D=this._linesCollection._get(),O=new ViewLayerRenderer(this.domNode.domNode,this._lineFactory,w),W={rendLineNumberStart:D.rendLineNumberStart,lines:D.lines,linesLength:D.lines.length},U=O.render(W,w.startLineNumber,w.endLineNumber,w.relativeVerticalOffset);this._linesCollection._set(U.rendLineNumberStart,U.lines)}}class ViewLayerRenderer{static{this._ttPolicy=createTrustedTypesPolicy("editorViewLayer",{createHTML:w=>w})}constructor(w,D,O){this._domNode=w,this._lineFactory=D,this._viewportData=O}render(w,D,O,W){const U={rendLineNumberStart:w.rendLineNumberStart,lines:w.lines.slice(0),linesLength:w.linesLength};if(U.rendLineNumberStart+U.linesLength-1<D||O<U.rendLineNumberStart){U.rendLineNumberStart=D,U.linesLength=O-D+1,U.lines=[];for(let K=D;K<=O;K++)U.lines[K-D]=this._lineFactory.createLine();return this._finishRendering(U,!0,W),U}if(this._renderUntouchedLines(U,Math.max(D-U.rendLineNumberStart,0),Math.min(O-U.rendLineNumberStart,U.linesLength-1),W,D),U.rendLineNumberStart>D){const K=D,q=Math.min(O,U.rendLineNumberStart-1);K<=q&&(this._insertLinesBefore(U,K,q,W,D),U.linesLength+=q-K+1)}else if(U.rendLineNumberStart<D){const K=Math.min(U.linesLength,D-U.rendLineNumberStart);K>0&&(this._removeLinesBefore(U,K),U.linesLength-=K)}if(U.rendLineNumberStart=D,U.rendLineNumberStart+U.linesLength-1<O){const K=U.rendLineNumberStart+U.linesLength,q=O;K<=q&&(this._insertLinesAfter(U,K,q,W,D),U.linesLength+=q-K+1)}else if(U.rendLineNumberStart+U.linesLength-1>O){const K=Math.max(0,O-U.rendLineNumberStart+1),G=U.linesLength-1-K+1;G>0&&(this._removeLinesAfter(U,G),U.linesLength-=G)}return this._finishRendering(U,!1,W),U}_renderUntouchedLines(w,D,O,W,U){const K=w.rendLineNumberStart,q=w.lines;for(let G=D;G<=O;G++){const Q=K+G;q[G].layoutLine(Q,W[Q-U],this._viewportData.lineHeight)}}_insertLinesBefore(w,D,O,W,U){const K=[];let q=0;for(let G=D;G<=O;G++)K[q++]=this._lineFactory.createLine();w.lines=K.concat(w.lines)}_removeLinesBefore(w,D){for(let O=0;O<D;O++)w.lines[O].getDomNode()?.remove();w.lines.splice(0,D)}_insertLinesAfter(w,D,O,W,U){const K=[];let q=0;for(let G=D;G<=O;G++)K[q++]=this._lineFactory.createLine();w.lines=w.lines.concat(K)}_removeLinesAfter(w,D){const O=w.linesLength-D;for(let W=0;W<D;W++)w.lines[O+W].getDomNode()?.remove();w.lines.splice(O,D)}_finishRenderingNewLines(w,D,O,W){ViewLayerRenderer._ttPolicy&&(O=ViewLayerRenderer._ttPolicy.createHTML(O));const U=this._domNode.lastChild;D||!U?this._domNode.innerHTML=O:U.insertAdjacentHTML("afterend",O);let K=this._domNode.lastChild;for(let q=w.linesLength-1;q>=0;q--){const G=w.lines[q];W[q]&&(G.setDomNode(K),K=K.previousSibling)}}_finishRenderingInvalidLines(w,D,O){const W=document.createElement("div");ViewLayerRenderer._ttPolicy&&(D=ViewLayerRenderer._ttPolicy.createHTML(D)),W.innerHTML=D;for(let U=0;U<w.linesLength;U++){const K=w.lines[U];if(O[U]){const q=W.firstChild,G=K.getDomNode();G.parentNode.replaceChild(q,G),K.setDomNode(q)}}}static{this._sb=new StringBuilder(1e5)}_finishRendering(w,D,O){const W=ViewLayerRenderer._sb,U=w.linesLength,K=w.lines,q=w.rendLineNumberStart,G=[];{W.reset();let Q=!1;for(let Y=0;Y<U;Y++){const X=K[Y];G[Y]=!1,!(X.getDomNode()||!X.renderLine(Y+q,O[Y],this._viewportData.lineHeight,this._viewportData,W))&&(G[Y]=!0,Q=!0)}Q&&this._finishRenderingNewLines(w,D,W.build(),G)}{W.reset();let Q=!1;const Y=[];for(let X=0;X<U;X++){const J=K[X];Y[X]=!1,!(G[X]||!J.renderLine(X+q,O[X],this._viewportData.lineHeight,this._viewportData,W))&&(Y[X]=!0,Q=!0)}Q&&this._finishRenderingInvalidLines(w,W.build(),Y)}}}class ViewOverlays extends ViewPart{constructor(w){super(w),this._dynamicOverlays=[],this._isFocused=!1,this._visibleLines=new VisibleLinesCollection({createLine:()=>new ViewOverlayLine(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;const O=this._context.configuration.options.get(50);applyFontInfo(this.domNode,O),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let w=0,D=this._dynamicOverlays.length;w<D;w++)if(this._dynamicOverlays[w].shouldRender())return!0;return!1}dispose(){super.dispose();for(let w=0,D=this._dynamicOverlays.length;w<D;w++)this._dynamicOverlays[w].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(w){this._dynamicOverlays.push(w)}onConfigurationChanged(w){this._visibleLines.onConfigurationChanged(w);const O=this._context.configuration.options.get(50);return applyFontInfo(this.domNode,O),!0}onFlushed(w){return this._visibleLines.onFlushed(w)}onFocusChanged(w){return this._isFocused=w.isFocused,!0}onLinesChanged(w){return this._visibleLines.onLinesChanged(w)}onLinesDeleted(w){return this._visibleLines.onLinesDeleted(w)}onLinesInserted(w){return this._visibleLines.onLinesInserted(w)}onScrollChanged(w){return this._visibleLines.onScrollChanged(w)||!0}onTokensChanged(w){return this._visibleLines.onTokensChanged(w)}onZonesChanged(w){return this._visibleLines.onZonesChanged(w)}prepareRender(w){const D=this._dynamicOverlays.filter(O=>O.shouldRender());for(let O=0,W=D.length;O<W;O++){const U=D[O];U.prepareRender(w),U.onDidRender()}}render(w){this._viewOverlaysRender(w),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(w){this._visibleLines.renderLines(w.viewportData)}}class ViewOverlayLine{constructor(w){this._dynamicOverlays=w,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(w){this._domNode=createFastDomNode(w)}onContentChanged(){}onTokensChanged(){}renderLine(w,D,O,W,U){let K="";for(let q=0,G=this._dynamicOverlays.length;q<G;q++){const Q=this._dynamicOverlays[q];K+=Q.render(W.startLineNumber,w)}return this._renderedContent===K?!1:(this._renderedContent=K,U.appendString('<div style="top:'),U.appendString(String(D)),U.appendString("px;height:"),U.appendString(String(O)),U.appendString('px;">'),U.appendString(K),U.appendString("</div>"),!0)}layoutLine(w,D,O){this._domNode&&(this._domNode.setTop(D),this._domNode.setHeight(O))}}class ContentViewOverlays extends ViewOverlays{constructor(w){super(w);const O=this._context.configuration.options.get(146);this._contentWidth=O.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(w){const O=this._context.configuration.options.get(146);return this._contentWidth=O.contentWidth,super.onConfigurationChanged(w)||!0}onScrollChanged(w){return super.onScrollChanged(w)||w.scrollWidthChanged}_viewOverlaysRender(w){super._viewOverlaysRender(w),this.domNode.setWidth(Math.max(w.scrollWidth,this._contentWidth))}}class MarginViewOverlays extends ViewOverlays{constructor(w){super(w);const D=this._context.configuration.options,O=D.get(146);this._contentLeft=O.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),applyFontInfo(this.domNode,D.get(50))}onConfigurationChanged(w){const D=this._context.configuration.options;applyFontInfo(this.domNode,D.get(50));const O=D.get(146);return this._contentLeft=O.contentLeft,super.onConfigurationChanged(w)||!0}onScrollChanged(w){return super.onScrollChanged(w)||w.scrollHeightChanged}_viewOverlaysRender(w){super._viewOverlaysRender(w);const D=Math.min(w.scrollHeight,1e6);this.domNode.setHeight(D),this.domNode.setWidth(this._contentLeft)}}class ViewUserInputEvents{constructor(w){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=w}emitKeyDown(w){this.onKeyDown?.(w)}emitKeyUp(w){this.onKeyUp?.(w)}emitContextMenu(w){this.onContextMenu?.(this._convertViewToModelMouseEvent(w))}emitMouseMove(w){this.onMouseMove?.(this._convertViewToModelMouseEvent(w))}emitMouseLeave(w){this.onMouseLeave?.(this._convertViewToModelMouseEvent(w))}emitMouseDown(w){this.onMouseDown?.(this._convertViewToModelMouseEvent(w))}emitMouseUp(w){this.onMouseUp?.(this._convertViewToModelMouseEvent(w))}emitMouseDrag(w){this.onMouseDrag?.(this._convertViewToModelMouseEvent(w))}emitMouseDrop(w){this.onMouseDrop?.(this._convertViewToModelMouseEvent(w))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(w){this.onMouseWheel?.(w)}_convertViewToModelMouseEvent(w){return w.target?{event:w.event,target:this._convertViewToModelMouseTarget(w.target)}:w}_convertViewToModelMouseTarget(w){return ViewUserInputEvents.convertViewToModelMouseTarget(w,this._coordinatesConverter)}static convertViewToModelMouseTarget(w,D){const O={...w};return O.position&&(O.position=D.convertViewPositionToModelPosition(O.position)),O.range&&(O.range=D.convertViewRangeToModelRange(O.range)),(O.type===5||O.type===8)&&(O.detail=this.convertViewToModelViewZoneData(O.detail,D)),O}static convertViewToModelViewZoneData(w,D){return{viewZoneId:w.viewZoneId,positionBefore:w.positionBefore?D.convertViewPositionToModelPosition(w.positionBefore):w.positionBefore,positionAfter:w.positionAfter?D.convertViewPositionToModelPosition(w.positionAfter):w.positionAfter,position:D.convertViewPositionToModelPosition(w.position),afterLineNumber:D.convertViewPositionToModelPosition(new Position$1(w.afterLineNumber,1)).lineNumber}}}class BlockDecorations extends ViewPart{constructor(w){super(w),this.blocks=[],this.contentWidth=-1,this.contentLeft=0,this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let w=!1;const O=this._context.configuration.options.get(146),W=O.contentWidth-O.verticalScrollbarWidth;this.contentWidth!==W&&(this.contentWidth=W,w=!0);const U=O.contentLeft;return this.contentLeft!==U&&(this.contentLeft=U,w=!0),w}dispose(){super.dispose()}onConfigurationChanged(w){return this.update()}onScrollChanged(w){return w.scrollTopChanged||w.scrollLeftChanged}onDecorationsChanged(w){return!0}onZonesChanged(w){return!0}prepareRender(w){}render(w){let D=0;const O=w.getDecorationsInViewport();for(const W of O){if(!W.options.blockClassName)continue;let U=this.blocks[D];U||(U=this.blocks[D]=createFastDomNode(document.createElement("div")),this.domNode.appendChild(U));let K,q;W.options.blockIsAfterEnd?(K=w.getVerticalOffsetAfterLineNumber(W.range.endLineNumber,!1),q=w.getVerticalOffsetAfterLineNumber(W.range.endLineNumber,!0)):(K=w.getVerticalOffsetForLineNumber(W.range.startLineNumber,!0),q=W.range.isEmpty()&&!W.options.blockDoesNotCollapse?w.getVerticalOffsetForLineNumber(W.range.startLineNumber,!1):w.getVerticalOffsetAfterLineNumber(W.range.endLineNumber,!0));const[G,Q,Y,X]=W.options.blockPadding??[0,0,0,0];U.setClassName("blockDecorations-block "+W.options.blockClassName),U.setLeft(this.contentLeft-X),U.setWidth(this.contentWidth+X+Q),U.setTop(K-w.scrollTop-G),U.setHeight(q-K+G+Y),D++}for(let W=D;W<this.blocks.length;W++)this.blocks[W].domNode.remove();this.blocks.length=D}}class ViewContentWidgets extends ViewPart{constructor(w,D){super(w),this._viewDomNode=D,this._widgets={},this.domNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(w){const D=Object.keys(this._widgets);for(const O of D)this._widgets[O].onConfigurationChanged(w);return!0}onDecorationsChanged(w){return!0}onFlushed(w){return!0}onLineMappingChanged(w){return this._updateAnchorsViewPositions(),!0}onLinesChanged(w){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(w){return this._updateAnchorsViewPositions(),!0}onLinesInserted(w){return this._updateAnchorsViewPositions(),!0}onScrollChanged(w){return!0}onZonesChanged(w){return!0}_updateAnchorsViewPositions(){const w=Object.keys(this._widgets);for(const D of w)this._widgets[D].updateAnchorViewPosition()}addWidget(w){const D=new Widget(this._context,this._viewDomNode,w);this._widgets[D.id]=D,D.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(D.domNode):this.domNode.appendChild(D.domNode),this.setShouldRender()}setWidgetPosition(w,D,O,W,U){this._widgets[w.getId()].setPosition(D,O,W,U),this.setShouldRender()}removeWidget(w){const D=w.getId();if(this._widgets.hasOwnProperty(D)){const O=this._widgets[D];delete this._widgets[D];const W=O.domNode.domNode;W.remove(),W.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(w){return this._widgets.hasOwnProperty(w)?this._widgets[w].suppressMouseDown:!1}onBeforeRender(w){const D=Object.keys(this._widgets);for(const O of D)this._widgets[O].onBeforeRender(w)}prepareRender(w){const D=Object.keys(this._widgets);for(const O of D)this._widgets[O].prepareRender(w)}render(w){const D=Object.keys(this._widgets);for(const O of D)this._widgets[O].render(w)}}class Widget{constructor(w,D,O){this._primaryAnchor=new PositionPair(null,null),this._secondaryAnchor=new PositionPair(null,null),this._context=w,this._viewDomNode=D,this._actual=O,this.domNode=createFastDomNode(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;const W=this._context.configuration.options,U=W.get(146);this._fixedOverflowWidgets=W.get(42),this._contentWidth=U.contentWidth,this._contentLeft=U.contentLeft,this._lineHeight=W.get(67),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(w){const D=this._context.configuration.options;if(this._lineHeight=D.get(67),w.hasChanged(146)){const O=D.get(146);this._contentLeft=O.contentLeft,this._contentWidth=O.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(w,D,O){this._affinity=w,this._primaryAnchor=W(D,this._context.viewModel,this._affinity),this._secondaryAnchor=W(O,this._context.viewModel,this._affinity);function W(U,K,q){if(!U)return new PositionPair(null,null);const G=K.model.validatePosition(U);if(K.coordinatesConverter.modelPositionIsVisible(G)){const Q=K.coordinatesConverter.convertModelPositionToViewPosition(G,q??void 0);return new PositionPair(U,Q)}return new PositionPair(U,null)}}_getMaxWidth(){const w=this.domNode.domNode.ownerDocument,D=w.defaultView;return this.allowEditorOverflow?D?.innerWidth||w.documentElement.offsetWidth||w.body.offsetWidth:this._contentWidth}setPosition(w,D,O,W){this._setPosition(W,w,D),this._preference=O,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(w,D,O,W){const U=w.top,K=U,q=w.top+w.height,G=W.viewportHeight-q,Q=U-O,Y=K>=O,X=q,J=G>=O;let te=w.left;return te+D>W.scrollLeft+W.viewportWidth&&(te=W.scrollLeft+W.viewportWidth-D),te<W.scrollLeft&&(te=W.scrollLeft),{fitsAbove:Y,aboveTop:Q,fitsBelow:J,belowTop:X,left:te}}_layoutHorizontalSegmentInPage(w,D,O,W){const q=Math.max(15,D.left-W),G=Math.min(D.left+D.width+W,w.width-15),Y=this._viewDomNode.domNode.ownerDocument.defaultView;let X=D.left+O-(Y?.scrollX??0);if(X+W>G){const J=X-(G-W);X-=J,O-=J}if(X<q){const J=X-q;X-=J,O-=J}return[O,X]}_layoutBoxInPage(w,D,O,W){const U=w.top-O,K=w.top+w.height,q=getDomNodePagePosition(this._viewDomNode.domNode),G=this._viewDomNode.domNode.ownerDocument,Q=G.defaultView,Y=q.top+U-(Q?.scrollY??0),X=q.top+K-(Q?.scrollY??0),J=getClientArea(G.body),[te,ie]=this._layoutHorizontalSegmentInPage(J,q,w.left-W.scrollLeft+this._contentLeft,D),se=22,re=22,ae=Y>=se,le=X+O<=J.height-re;return this._fixedOverflowWidgets?{fitsAbove:ae,aboveTop:Math.max(Y,se),fitsBelow:le,belowTop:X,left:ie}:{fitsAbove:ae,aboveTop:U,fitsBelow:le,belowTop:K,left:te}}_prepareRenderWidgetAtExactPositionOverflowing(w){return new Coordinate(w.top,w.left+this._contentLeft)}_getAnchorsCoordinates(w){const D=U(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),O=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,W=U(O,this._affinity,this._lineHeight);return{primary:D,secondary:W};function U(K,q,G){if(!K)return null;const Q=w.visibleRangeForPosition(K);if(!Q)return null;const Y=K.column===1&&q===3?0:Q.left,X=w.getVerticalOffsetForLineNumber(K.lineNumber)-w.scrollTop;return new AnchorCoordinate(X,Y,G)}}_reduceAnchorCoordinates(w,D,O){if(!D)return w;const W=this._context.configuration.options.get(50);let U=D.left;return U<w.left?U=Math.max(U,w.left-O+W.typicalFullwidthCharacterWidth):U=Math.min(U,w.left+O-W.typicalFullwidthCharacterWidth),new AnchorCoordinate(w.top,U,w.height)}_prepareRenderWidget(w){if(!this._preference||this._preference.length===0)return null;const{primary:D,secondary:O}=this._getAnchorsCoordinates(w);if(!D)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let K=null;if(typeof this._actual.beforeRender=="function"&&(K=safeInvoke(this._actual.beforeRender,this._actual)),K)this._cachedDomNodeOffsetWidth=K.width,this._cachedDomNodeOffsetHeight=K.height;else{const G=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(G.width),this._cachedDomNodeOffsetHeight=Math.round(G.height)}}const W=this._reduceAnchorCoordinates(D,O,this._cachedDomNodeOffsetWidth);let U;this.allowEditorOverflow?U=this._layoutBoxInPage(W,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,w):U=this._layoutBoxInViewport(W,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,w);for(let K=1;K<=2;K++)for(const q of this._preference)if(q===1){if(!U)return null;if(K===2||U.fitsAbove)return{kind:"inViewport",coordinate:new Coordinate(U.aboveTop,U.left),position:1}}else if(q===2){if(!U)return null;if(K===2||U.fitsBelow)return{kind:"inViewport",coordinate:new Coordinate(U.belowTop,U.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new Coordinate(W.top,W.left)),position:0}:{kind:"inViewport",coordinate:new Coordinate(W.top,W.left),position:0};return null}onBeforeRender(w){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<w.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>w.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(w){this._renderData=this._prepareRenderWidget(w)}render(w){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&safeInvoke(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+w.scrollTop-w.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&safeInvoke(this._actual.afterRender,this._actual,this._renderData.position)}}class PositionPair{constructor(w,D){this.modelPosition=w,this.viewPosition=D}}class Coordinate{constructor(w,D){this.top=w,this.left=D,this._coordinateBrand=void 0}}class AnchorCoordinate{constructor(w,D,O){this.top=w,this.left=D,this.height=O,this._anchorCoordinateBrand=void 0}}function safeInvoke(F,w,...D){try{return F.call(w,...D)}catch{return null}}class AbstractLineHighlightOverlay extends DynamicViewOverlay{constructor(w){super(),this._context=w;const D=this._context.configuration.options,O=D.get(146);this._renderLineHighlight=D.get(97),this._renderLineHighlightOnlyWhenFocus=D.get(98),this._wordWrap=O.isViewportWrapping,this._contentLeft=O.contentLeft,this._contentWidth=O.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new Selection$1(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let w=!1;const D=new Set;for(const U of this._selections)D.add(U.positionLineNumber);const O=Array.from(D);O.sort((U,K)=>U-K),equals$1(this._cursorLineNumbers,O)||(this._cursorLineNumbers=O,w=!0);const W=this._selections.every(U=>U.isEmpty());return this._selectionIsEmpty!==W&&(this._selectionIsEmpty=W,w=!0),w}onThemeChanged(w){return this._readFromSelections()}onConfigurationChanged(w){const D=this._context.configuration.options,O=D.get(146);return this._renderLineHighlight=D.get(97),this._renderLineHighlightOnlyWhenFocus=D.get(98),this._wordWrap=O.isViewportWrapping,this._contentLeft=O.contentLeft,this._contentWidth=O.contentWidth,!0}onCursorStateChanged(w){return this._selections=w.selections,this._readFromSelections()}onFlushed(w){return!0}onLinesDeleted(w){return!0}onLinesInserted(w){return!0}onScrollChanged(w){return w.scrollWidthChanged||w.scrollTopChanged}onZonesChanged(w){return!0}onFocusChanged(w){return this._renderLineHighlightOnlyWhenFocus?(this._focused=w.isFocused,!0):!1}prepareRender(w){if(!this._shouldRenderThis()){this._renderData=null;return}const D=w.visibleRange.startLineNumber,O=w.visibleRange.endLineNumber,W=[];for(let K=D;K<=O;K++){const q=K-D;W[q]=""}if(this._wordWrap){const K=this._renderOne(w,!1);for(const q of this._cursorLineNumbers){const G=this._context.viewModel.coordinatesConverter,Q=G.convertViewPositionToModelPosition(new Position$1(q,1)).lineNumber,Y=G.convertModelPositionToViewPosition(new Position$1(Q,1)).lineNumber,X=G.convertModelPositionToViewPosition(new Position$1(Q,this._context.viewModel.model.getLineMaxColumn(Q))).lineNumber,J=Math.max(Y,D),te=Math.min(X,O);for(let ie=J;ie<=te;ie++){const se=ie-D;W[se]=K}}}const U=this._renderOne(w,!0);for(const K of this._cursorLineNumbers){if(K<D||K>O)continue;const q=K-D;W[q]=U}this._renderData=W}render(w,D){if(!this._renderData)return"";const O=D-w;return O>=this._renderData.length?"":this._renderData[O]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class CurrentLineHighlightOverlay extends AbstractLineHighlightOverlay{_renderOne(w,D){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(D?" current-line-exact":"")}" style="width:${Math.max(w.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}}class CurrentLineMarginHighlightOverlay extends AbstractLineHighlightOverlay{_renderOne(w,D){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&D?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}}registerThemingParticipant((F,w)=>{const D=F.getColor(editorLineHighlight);if(D&&(w.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${D}; }`),w.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${D}; border: none; }`)),!D||D.isTransparent()||F.defines(editorLineHighlightBorder)){const O=F.getColor(editorLineHighlightBorder);O&&(w.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${O}; }`),w.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${O}; }`),isHighContrast(F.type)&&(w.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),w.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});class DecorationsOverlay extends DynamicViewOverlay{constructor(w){super(),this._context=w;const D=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=D.get(50).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(w){const D=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=D.get(50).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(w){return!0}onFlushed(w){return!0}onLinesChanged(w){return!0}onLinesDeleted(w){return!0}onLinesInserted(w){return!0}onScrollChanged(w){return w.scrollTopChanged||w.scrollWidthChanged}onZonesChanged(w){return!0}prepareRender(w){const D=w.getDecorationsInViewport();let O=[],W=0;for(let G=0,Q=D.length;G<Q;G++){const Y=D[G];Y.options.className&&(O[W++]=Y)}O=O.sort((G,Q)=>{if(G.options.zIndex<Q.options.zIndex)return-1;if(G.options.zIndex>Q.options.zIndex)return 1;const Y=G.options.className,X=Q.options.className;return Y<X?-1:Y>X?1:Range$2.compareRangesUsingStarts(G.range,Q.range)});const U=w.visibleRange.startLineNumber,K=w.visibleRange.endLineNumber,q=[];for(let G=U;G<=K;G++){const Q=G-U;q[Q]=""}this._renderWholeLineDecorations(w,O,q),this._renderNormalDecorations(w,O,q),this._renderResult=q}_renderWholeLineDecorations(w,D,O){const W=w.visibleRange.startLineNumber,U=w.visibleRange.endLineNumber;for(let K=0,q=D.length;K<q;K++){const G=D[K];if(!G.options.isWholeLine)continue;const Q='<div class="cdr '+G.options.className+'" style="left:0;width:100%;"></div>',Y=Math.max(G.range.startLineNumber,W),X=Math.min(G.range.endLineNumber,U);for(let J=Y;J<=X;J++){const te=J-W;O[te]+=Q}}}_renderNormalDecorations(w,D,O){const W=w.visibleRange.startLineNumber;let U=null,K=!1,q=null,G=!1;for(let Q=0,Y=D.length;Q<Y;Q++){const X=D[Q];if(X.options.isWholeLine)continue;const J=X.options.className,te=!!X.options.showIfCollapsed;let ie=X.range;if(te&&ie.endColumn===1&&ie.endLineNumber!==ie.startLineNumber&&(ie=new Range$2(ie.startLineNumber,ie.startColumn,ie.endLineNumber-1,this._context.viewModel.getLineMaxColumn(ie.endLineNumber-1))),U===J&&K===te&&Range$2.areIntersectingOrTouching(q,ie)){q=Range$2.plusRange(q,ie);continue}U!==null&&this._renderNormalDecoration(w,q,U,G,K,W,O),U=J,K=te,q=ie,G=X.options.shouldFillLineOnLineBreak??!1}U!==null&&this._renderNormalDecoration(w,q,U,G,K,W,O)}_renderNormalDecoration(w,D,O,W,U,K,q){const G=w.linesVisibleRangesForRange(D,O==="findMatch");if(G)for(let Q=0,Y=G.length;Q<Y;Q++){const X=G[Q];if(X.outsideRenderedLine)continue;const J=X.lineNumber-K;if(U&&X.ranges.length===1){const te=X.ranges[0];if(te.width<this._typicalHalfwidthCharacterWidth){const ie=Math.round(te.left+te.width/2),se=Math.max(0,Math.round(ie-this._typicalHalfwidthCharacterWidth/2));X.ranges[0]=new HorizontalRange(se,this._typicalHalfwidthCharacterWidth)}}for(let te=0,ie=X.ranges.length;te<ie;te++){const se=W&&X.continuesOnNextLine&&ie===1,re=X.ranges[te],ae='<div class="cdr '+O+'" style="left:'+String(re.left)+"px;width:"+(se?"100%;":String(re.width)+"px;")+'"></div>';q[J]+=ae}}}render(w,D){if(!this._renderResult)return"";const O=D-w;return O<0||O>=this._renderResult.length?"":this._renderResult[O]}}class EditorScrollbar extends ViewPart{constructor(w,D,O,W){super(w);const U=this._context.configuration.options,K=U.get(104),q=U.get(75),G=U.get(40),Q=U.get(107),Y={listenOnDomNode:O.domNode,className:"editor-scrollable "+getThemeTypeSelector(w.theme.type),useShadows:!1,lazyRender:!0,vertical:K.vertical,horizontal:K.horizontal,verticalHasArrows:K.verticalHasArrows,horizontalHasArrows:K.horizontalHasArrows,verticalScrollbarSize:K.verticalScrollbarSize,verticalSliderSize:K.verticalSliderSize,horizontalScrollbarSize:K.horizontalScrollbarSize,horizontalSliderSize:K.horizontalSliderSize,handleMouseWheel:K.handleMouseWheel,alwaysConsumeMouseWheel:K.alwaysConsumeMouseWheel,arrowSize:K.arrowSize,mouseWheelScrollSensitivity:q,fastScrollSensitivity:G,scrollPredominantAxis:Q,scrollByPage:K.scrollByPage};this.scrollbar=this._register(new SmoothScrollableElement(D.domNode,Y,this._context.viewLayout.getScrollable())),PartFingerprints.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=createFastDomNode(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const X=(J,te,ie)=>{const se={};{const re=J.scrollTop;re&&(se.scrollTop=this._context.viewLayout.getCurrentScrollTop()+re,J.scrollTop=0)}if(ie){const re=J.scrollLeft;re&&(se.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+re,J.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(se,1)};this._register(addDisposableListener(O.domNode,"scroll",J=>X(O.domNode,!0,!0))),this._register(addDisposableListener(D.domNode,"scroll",J=>X(D.domNode,!0,!1))),this._register(addDisposableListener(W.domNode,"scroll",J=>X(W.domNode,!0,!1))),this._register(addDisposableListener(this.scrollbarDomNode.domNode,"scroll",J=>X(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){const w=this._context.configuration.options,D=w.get(146);this.scrollbarDomNode.setLeft(D.contentLeft),w.get(73).side==="right"?this.scrollbarDomNode.setWidth(D.contentWidth+D.minimap.minimapWidth):this.scrollbarDomNode.setWidth(D.contentWidth),this.scrollbarDomNode.setHeight(D.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(w){this.scrollbar.delegateVerticalScrollbarPointerDown(w)}delegateScrollFromMouseWheelEvent(w){this.scrollbar.delegateScrollFromMouseWheelEvent(w)}onConfigurationChanged(w){if(w.hasChanged(104)||w.hasChanged(75)||w.hasChanged(40)){const D=this._context.configuration.options,O=D.get(104),W=D.get(75),U=D.get(40),K=D.get(107),q={vertical:O.vertical,horizontal:O.horizontal,verticalScrollbarSize:O.verticalScrollbarSize,horizontalScrollbarSize:O.horizontalScrollbarSize,scrollByPage:O.scrollByPage,handleMouseWheel:O.handleMouseWheel,mouseWheelScrollSensitivity:W,fastScrollSensitivity:U,scrollPredominantAxis:K};this.scrollbar.updateOptions(q)}return w.hasChanged(146)&&this._setLayout(),!0}onScrollChanged(w){return!0}onThemeChanged(w){return this.scrollbar.updateClassName("editor-scrollable "+getThemeTypeSelector(this._context.theme.type)),!0}prepareRender(w){}render(w){this.scrollbar.renderNow()}}class DecorationToRender{constructor(w,D,O,W,U){this.startLineNumber=w,this.endLineNumber=D,this.className=O,this.tooltip=W,this._decorationToRenderBrand=void 0,this.zIndex=U??0}}class LineDecorationToRender{constructor(w,D,O){this.className=w,this.zIndex=D,this.tooltip=O}}class VisibleLineDecorationsToRender{constructor(){this.decorations=[]}add(w){this.decorations.push(w)}getDecorations(){return this.decorations}}class DedupOverlay extends DynamicViewOverlay{_render(w,D,O){const W=[];for(let q=w;q<=D;q++){const G=q-w;W[G]=new VisibleLineDecorationsToRender}if(O.length===0)return W;O.sort((q,G)=>q.className===G.className?q.startLineNumber===G.startLineNumber?q.endLineNumber-G.endLineNumber:q.startLineNumber-G.startLineNumber:q.className<G.className?-1:1);let U=null,K=0;for(let q=0,G=O.length;q<G;q++){const Q=O[q],Y=Q.className,X=Q.zIndex;let J=Math.max(Q.startLineNumber,w)-w;const te=Math.min(Q.endLineNumber,D)-w;U===Y?(J=Math.max(K+1,J),K=Math.max(K,te)):(U=Y,K=te);for(let ie=J;ie<=K;ie++)W[ie].add(new LineDecorationToRender(Y,X,Q.tooltip))}return W}}class GlyphMarginWidgets extends ViewPart{constructor(w){super(w),this._widgets={},this._context=w;const D=this._context.configuration.options,O=D.get(146);this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=D.get(67),this._glyphMargin=D.get(57),this._glyphMarginLeft=O.glyphMarginLeft,this._glyphMarginWidth=O.glyphMarginWidth,this._glyphMarginDecorationLaneCount=O.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(w){const D=this._context.configuration.options,O=D.get(146);return this._lineHeight=D.get(67),this._glyphMargin=D.get(57),this._glyphMarginLeft=O.glyphMarginLeft,this._glyphMarginWidth=O.glyphMarginWidth,this._glyphMarginDecorationLaneCount=O.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(w){return!0}onFlushed(w){return!0}onLinesChanged(w){return!0}onLinesDeleted(w){return!0}onLinesInserted(w){return!0}onScrollChanged(w){return w.scrollTopChanged}onZonesChanged(w){return!0}addWidget(w){const D=createFastDomNode(w.getDomNode());this._widgets[w.getId()]={widget:w,preference:w.getPosition(),domNode:D,renderInfo:null},D.setPosition("absolute"),D.setDisplay("none"),D.setAttribute("widgetId",w.getId()),this.domNode.appendChild(D),this.setShouldRender()}setWidgetPosition(w,D){const O=this._widgets[w.getId()];return O.preference.lane===D.lane&&O.preference.zIndex===D.zIndex&&Range$2.equalsRange(O.preference.range,D.range)?!1:(O.preference=D,this.setShouldRender(),!0)}removeWidget(w){const D=w.getId();if(this._widgets[D]){const W=this._widgets[D].domNode.domNode;delete this._widgets[D],W.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(w,D){const O=w.visibleRange.startLineNumber,W=w.visibleRange.endLineNumber,U=w.getDecorationsInViewport();for(const K of U){const q=K.options.glyphMarginClassName;if(!q)continue;const G=Math.max(K.range.startLineNumber,O),Q=Math.min(K.range.endLineNumber,W),Y=K.options.glyphMargin?.position??GlyphMarginLane$1.Center,X=K.options.zIndex??0;for(let J=G;J<=Q;J++){const te=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(J,0)),ie=this._context.viewModel.glyphLanes.getLanesAtLine(te.lineNumber).indexOf(Y);D.push(new DecorationBasedGlyphRenderRequest(J,ie,X,q))}}}_collectWidgetBasedGlyphRenderRequest(w,D){const O=w.visibleRange.startLineNumber,W=w.visibleRange.endLineNumber;for(const U of Object.values(this._widgets)){const K=U.preference.range,{startLineNumber:q,endLineNumber:G}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(Range$2.lift(K));if(!q||!G||G<O||q>W)continue;const Q=Math.max(q,O),Y=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(Q,0)),X=this._context.viewModel.glyphLanes.getLanesAtLine(Y.lineNumber).indexOf(U.preference.lane);D.push(new WidgetBasedGlyphRenderRequest(Q,X,U.preference.zIndex,U))}}_collectSortedGlyphRenderRequests(w){const D=[];return this._collectDecorationBasedGlyphRenderRequest(w,D),this._collectWidgetBasedGlyphRenderRequest(w,D),D.sort((O,W)=>O.lineNumber===W.lineNumber?O.laneIndex===W.laneIndex?O.zIndex===W.zIndex?W.type===O.type?O.type===0&&W.type===0?O.className<W.className?-1:1:0:W.type-O.type:W.zIndex-O.zIndex:O.laneIndex-W.laneIndex:O.lineNumber-W.lineNumber),D}prepareRender(w){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(const W of Object.values(this._widgets))W.renderInfo=null;const D=new ArrayQueue(this._collectSortedGlyphRenderRequests(w)),O=[];for(;D.length>0;){const W=D.peek();if(!W)break;const U=D.takeWhile(q=>q.lineNumber===W.lineNumber&&q.laneIndex===W.laneIndex);if(!U||U.length===0)break;const K=U[0];if(K.type===0){const q=[];for(const G of U){if(G.zIndex!==K.zIndex||G.type!==K.type)break;(q.length===0||q[q.length-1]!==G.className)&&q.push(G.className)}O.push(K.accept(q.join(" ")))}else K.widget.renderInfo={lineNumber:K.lineNumber,laneIndex:K.laneIndex}}this._decorationGlyphsToRender=O}render(w){if(!this._glyphMargin){for(const O of Object.values(this._widgets))O.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}const D=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(const O of Object.values(this._widgets))if(!O.renderInfo)O.domNode.setDisplay("none");else{const W=w.viewportData.relativeVerticalOffset[O.renderInfo.lineNumber-w.viewportData.startLineNumber],U=this._glyphMarginLeft+O.renderInfo.laneIndex*this._lineHeight;O.domNode.setDisplay("block"),O.domNode.setTop(W),O.domNode.setLeft(U),O.domNode.setWidth(D),O.domNode.setHeight(this._lineHeight)}for(let O=0;O<this._decorationGlyphsToRender.length;O++){const W=this._decorationGlyphsToRender[O],U=w.viewportData.relativeVerticalOffset[W.lineNumber-w.viewportData.startLineNumber],K=this._glyphMarginLeft+W.laneIndex*this._lineHeight;let q;O<this._managedDomNodes.length?q=this._managedDomNodes[O]:(q=createFastDomNode(document.createElement("div")),this._managedDomNodes.push(q),this.domNode.appendChild(q)),q.setClassName("cgmr codicon "+W.combinedClassName),q.setPosition("absolute"),q.setTop(U),q.setLeft(K),q.setWidth(D),q.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}}class DecorationBasedGlyphRenderRequest{constructor(w,D,O,W){this.lineNumber=w,this.laneIndex=D,this.zIndex=O,this.className=W,this.type=0}accept(w){return new DecorationBasedGlyph(this.lineNumber,this.laneIndex,w)}}class WidgetBasedGlyphRenderRequest{constructor(w,D,O,W){this.lineNumber=w,this.laneIndex=D,this.zIndex=O,this.widget=W,this.type=1}}class DecorationBasedGlyph{constructor(w,D,O){this.lineNumber=w,this.laneIndex=D,this.combinedClassName=O}}class IndentGuidesOverlay extends DynamicViewOverlay{constructor(w){super(),this._context=w,this._primaryPosition=null;const D=this._context.configuration.options,O=D.get(147),W=D.get(50);this._spaceWidth=W.spaceWidth,this._maxIndentLeft=O.wrappingColumn===-1?-1:O.wrappingColumn*W.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=D.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(w){const D=this._context.configuration.options,O=D.get(147),W=D.get(50);return this._spaceWidth=W.spaceWidth,this._maxIndentLeft=O.wrappingColumn===-1?-1:O.wrappingColumn*W.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=D.get(16),!0}onCursorStateChanged(w){const O=w.selections[0].getPosition();return this._primaryPosition?.equals(O)?!1:(this._primaryPosition=O,!0)}onDecorationsChanged(w){return!0}onFlushed(w){return!0}onLinesChanged(w){return!0}onLinesDeleted(w){return!0}onLinesInserted(w){return!0}onScrollChanged(w){return w.scrollTopChanged}onZonesChanged(w){return!0}onLanguageConfigurationChanged(w){return!0}prepareRender(w){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}const D=w.visibleRange.startLineNumber,O=w.visibleRange.endLineNumber,W=w.scrollWidth,U=this._primaryPosition,K=this.getGuidesByLine(D,Math.min(O+1,this._context.viewModel.getLineCount()),U),q=[];for(let G=D;G<=O;G++){const Q=G-D,Y=K[Q];let X="";const J=w.visibleRangeForPosition(new Position$1(G,1))?.left??0;for(const te of Y){const ie=te.column===-1?J+(te.visibleColumn-1)*this._spaceWidth:w.visibleRangeForPosition(new Position$1(G,te.column)).left;if(ie>W||this._maxIndentLeft>0&&ie>this._maxIndentLeft)break;const se=te.horizontalLine?te.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",re=te.horizontalLine?(w.visibleRangeForPosition(new Position$1(G,te.horizontalLine.endColumn))?.left??ie+this._spaceWidth)-ie:this._spaceWidth;X+=`<div class="core-guide ${te.className} ${se}" style="left:${ie}px;width:${re}px"></div>`}q[Q]=X}this._renderResult=q}getGuidesByLine(w,D,O){const W=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(w,D,O,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?HorizontalGuidesState.Enabled:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?HorizontalGuidesState.EnabledForActive:HorizontalGuidesState.Disabled,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,U=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(w,D):null;let K=0,q=0,G=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&O){const X=this._context.viewModel.getActiveIndentGuide(O.lineNumber,w,D);K=X.startLineNumber,q=X.endLineNumber,G=X.indent}const{indentSize:Q}=this._context.viewModel.model.getOptions(),Y=[];for(let X=w;X<=D;X++){const J=new Array;Y.push(J);const te=W?W[X-w]:[],ie=new ArrayQueue(te),se=U?U[X-w]:0;for(let re=1;re<=se;re++){const ae=(re-1)*Q+1,le=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||te.length===0)&&K<=X&&X<=q&&re===G;J.push(...ie.takeWhile(oe=>oe.visibleColumn<ae)||[]);const de=ie.peek();(!de||de.visibleColumn!==ae||de.horizontalLine)&&J.push(new IndentGuide(ae,-1,`core-guide-indent lvl-${(re-1)%30}`+(le?" indent-active":""),null,-1,-1))}J.push(...ie.takeWhile(re=>!0)||[])}return Y}render(w,D){if(!this._renderResult)return"";const O=D-w;return O<0||O>=this._renderResult.length?"":this._renderResult[O]}}function transparentToUndefined(F){if(!(F&&F.isTransparent()))return F}registerThemingParticipant((F,w)=>{const D=[{bracketColor:editorBracketHighlightingForeground1,guideColor:editorBracketPairGuideBackground1,guideColorActive:editorBracketPairGuideActiveBackground1},{bracketColor:editorBracketHighlightingForeground2,guideColor:editorBracketPairGuideBackground2,guideColorActive:editorBracketPairGuideActiveBackground2},{bracketColor:editorBracketHighlightingForeground3,guideColor:editorBracketPairGuideBackground3,guideColorActive:editorBracketPairGuideActiveBackground3},{bracketColor:editorBracketHighlightingForeground4,guideColor:editorBracketPairGuideBackground4,guideColorActive:editorBracketPairGuideActiveBackground4},{bracketColor:editorBracketHighlightingForeground5,guideColor:editorBracketPairGuideBackground5,guideColorActive:editorBracketPairGuideActiveBackground5},{bracketColor:editorBracketHighlightingForeground6,guideColor:editorBracketPairGuideBackground6,guideColorActive:editorBracketPairGuideActiveBackground6}],O=new BracketPairGuidesClassNames,W=[{indentColor:editorIndentGuide1,indentColorActive:editorActiveIndentGuide1},{indentColor:editorIndentGuide2,indentColorActive:editorActiveIndentGuide2},{indentColor:editorIndentGuide3,indentColorActive:editorActiveIndentGuide3},{indentColor:editorIndentGuide4,indentColorActive:editorActiveIndentGuide4},{indentColor:editorIndentGuide5,indentColorActive:editorActiveIndentGuide5},{indentColor:editorIndentGuide6,indentColorActive:editorActiveIndentGuide6}],U=D.map(q=>{const G=F.getColor(q.bracketColor),Q=F.getColor(q.guideColor),Y=F.getColor(q.guideColorActive),X=transparentToUndefined(transparentToUndefined(Q)??G?.transparent(.3)),J=transparentToUndefined(transparentToUndefined(Y)??G);if(!(!X||!J))return{guideColor:X,guideColorActive:J}}).filter(isDefined),K=W.map(q=>{const G=F.getColor(q.indentColor),Q=F.getColor(q.indentColorActive),Y=transparentToUndefined(G),X=transparentToUndefined(Q);if(!(!Y||!X))return{indentColor:Y,indentColorActive:X}}).filter(isDefined);if(U.length>0){for(let q=0;q<30;q++){const G=U[q%U.length];w.addRule(`.monaco-editor .${O.getInlineClassNameOfLevel(q).replace(/ /g,".")} { --guide-color: ${G.guideColor}; --guide-color-active: ${G.guideColorActive}; }`)}w.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),w.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),w.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),w.addRule(`.monaco-editor .vertical.${O.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),w.addRule(`.monaco-editor .horizontal-top.${O.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),w.addRule(`.monaco-editor .horizontal-bottom.${O.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(K.length>0){for(let q=0;q<30;q++){const G=K[q%K.length];w.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${q} { --indent-color: ${G.indentColor}; --indent-color-active: ${G.indentColorActive}; }`)}w.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),w.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});class DomReadingContext{get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const w=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=w.left,this._clientRectScale=w.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}constructor(w,D){this._domNode=w,this.endNode=D,this._didDomLayout=!1,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1}markDidDomLayout(){this._didDomLayout=!0}}class LastRenderedData{constructor(){this._currentVisibleRange=new Range$2(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(w){this._currentVisibleRange=w}}class HorizontalRevealRangeRequest{constructor(w,D,O,W,U,K,q){this.minimalReveal=w,this.lineNumber=D,this.startColumn=O,this.endColumn=W,this.startScrollTop=U,this.stopScrollTop=K,this.scrollType=q,this.type="range",this.minLineNumber=D,this.maxLineNumber=D}}class HorizontalRevealSelectionsRequest{constructor(w,D,O,W,U){this.minimalReveal=w,this.selections=D,this.startScrollTop=O,this.stopScrollTop=W,this.scrollType=U,this.type="selections";let K=D[0].startLineNumber,q=D[0].endLineNumber;for(let G=1,Q=D.length;G<Q;G++){const Y=D[G];K=Math.min(K,Y.startLineNumber),q=Math.max(q,Y.endLineNumber)}this.minLineNumber=K,this.maxLineNumber=q}}class ViewLines extends ViewPart{static{this.HORIZONTAL_EXTRA_PX=30}constructor(w,D){super(w);const O=this._context.configuration,W=this._context.configuration.options,U=W.get(50),K=W.get(147);this._lineHeight=W.get(67),this._typicalHalfwidthCharacterWidth=U.typicalHalfwidthCharacterWidth,this._isViewportWrapping=K.isViewportWrapping,this._revealHorizontalRightPadding=W.get(101),this._cursorSurroundingLines=W.get(29),this._cursorSurroundingLinesStyle=W.get(30),this._canUseLayerHinting=!W.get(32),this._viewLineOptions=new ViewLineOptions(O,this._context.theme.type),this._linesContent=D,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new VisibleLinesCollection({createLine:()=>new ViewLine(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,PartFingerprints.write(this.domNode,8),this.domNode.setClassName(`view-lines ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),applyFontInfo(this.domNode,U),this._maxLineWidth=0,this._asyncUpdateLineWidths=new RunOnceScheduler(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new RunOnceScheduler(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new LastRenderedData,this._horizontalRevealRequest=null,this._stickyScrollEnabled=W.get(116).enabled,this._maxNumberStickyLines=W.get(116).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(w){this._visibleLines.onConfigurationChanged(w),w.hasChanged(147)&&(this._maxLineWidth=0);const D=this._context.configuration.options,O=D.get(50),W=D.get(147);return this._lineHeight=D.get(67),this._typicalHalfwidthCharacterWidth=O.typicalHalfwidthCharacterWidth,this._isViewportWrapping=W.isViewportWrapping,this._revealHorizontalRightPadding=D.get(101),this._cursorSurroundingLines=D.get(29),this._cursorSurroundingLinesStyle=D.get(30),this._canUseLayerHinting=!D.get(32),this._stickyScrollEnabled=D.get(116).enabled,this._maxNumberStickyLines=D.get(116).maxLineCount,applyFontInfo(this.domNode,O),this._onOptionsMaybeChanged(),w.hasChanged(146)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const w=this._context.configuration,D=new ViewLineOptions(w,this._context.theme.type);if(!this._viewLineOptions.equals(D)){this._viewLineOptions=D;const O=this._visibleLines.getStartLineNumber(),W=this._visibleLines.getEndLineNumber();for(let U=O;U<=W;U++)this._visibleLines.getVisibleLine(U).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(w){const D=this._visibleLines.getStartLineNumber(),O=this._visibleLines.getEndLineNumber();let W=!1;for(let U=D;U<=O;U++)W=this._visibleLines.getVisibleLine(U).onSelectionChanged()||W;return W}onDecorationsChanged(w){{const D=this._visibleLines.getStartLineNumber(),O=this._visibleLines.getEndLineNumber();for(let W=D;W<=O;W++)this._visibleLines.getVisibleLine(W).onDecorationsChanged()}return!0}onFlushed(w){const D=this._visibleLines.onFlushed(w);return this._maxLineWidth=0,D}onLinesChanged(w){return this._visibleLines.onLinesChanged(w)}onLinesDeleted(w){return this._visibleLines.onLinesDeleted(w)}onLinesInserted(w){return this._visibleLines.onLinesInserted(w)}onRevealRangeRequest(w){const D=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),w.source,w.minimalReveal,w.range,w.selections,w.verticalType);if(D===-1)return!1;let O=this._context.viewLayout.validateScrollPosition({scrollTop:D});w.revealHorizontal?w.range&&w.range.startLineNumber!==w.range.endLineNumber?O={scrollTop:O.scrollTop,scrollLeft:0}:w.range?this._horizontalRevealRequest=new HorizontalRevealRangeRequest(w.minimalReveal,w.range.startLineNumber,w.range.startColumn,w.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),O.scrollTop,w.scrollType):w.selections&&w.selections.length>0&&(this._horizontalRevealRequest=new HorizontalRevealSelectionsRequest(w.minimalReveal,w.selections,this._context.viewLayout.getCurrentScrollTop(),O.scrollTop,w.scrollType)):this._horizontalRevealRequest=null;const U=Math.abs(this._context.viewLayout.getCurrentScrollTop()-O.scrollTop)<=this._lineHeight?1:w.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(O,U),!0}onScrollChanged(w){if(this._horizontalRevealRequest&&w.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&w.scrollTopChanged){const D=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),O=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(w.scrollTop<D||w.scrollTop>O)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(w.scrollWidth),this._visibleLines.onScrollChanged(w)||!0}onTokensChanged(w){return this._visibleLines.onTokensChanged(w)}onZonesChanged(w){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(w)}onThemeChanged(w){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(w,D){const O=this._getViewLineDomNode(w);if(O===null)return null;const W=this._getLineNumberFor(O);if(W===-1||W<1||W>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(W)===1)return new Position$1(W,1);const U=this._visibleLines.getStartLineNumber(),K=this._visibleLines.getEndLineNumber();if(W<U||W>K)return null;let q=this._visibleLines.getVisibleLine(W).getColumnOfNodeOffset(w,D);const G=this._context.viewModel.getLineMinColumn(W);return q<G&&(q=G),new Position$1(W,q)}_getViewLineDomNode(w){for(;w&&w.nodeType===1;){if(w.className===ViewLine.CLASS_NAME)return w;w=w.parentElement}return null}_getLineNumberFor(w){const D=this._visibleLines.getStartLineNumber(),O=this._visibleLines.getEndLineNumber();for(let W=D;W<=O;W++){const U=this._visibleLines.getVisibleLine(W);if(w===U.getDomNode())return W}return-1}getLineWidth(w){const D=this._visibleLines.getStartLineNumber(),O=this._visibleLines.getEndLineNumber();if(w<D||w>O)return-1;const W=new DomReadingContext(this.domNode.domNode,this._textRangeRestingSpot),U=this._visibleLines.getVisibleLine(w).getWidth(W);return this._updateLineWidthsSlowIfDomDidLayout(W),U}linesVisibleRangesForRange(w,D){if(this.shouldRender())return null;const O=w.endLineNumber,W=Range$2.intersectRanges(w,this._lastRenderedData.getCurrentVisibleRange());if(!W)return null;const U=[];let K=0;const q=new DomReadingContext(this.domNode.domNode,this._textRangeRestingSpot);let G=0;D&&(G=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(W.startLineNumber,1)).lineNumber);const Q=this._visibleLines.getStartLineNumber(),Y=this._visibleLines.getEndLineNumber();for(let X=W.startLineNumber;X<=W.endLineNumber;X++){if(X<Q||X>Y)continue;const J=X===W.startLineNumber?W.startColumn:1,te=X!==W.endLineNumber,ie=te?this._context.viewModel.getLineMaxColumn(X):W.endColumn,se=this._visibleLines.getVisibleLine(X).getVisibleRangesForRange(X,J,ie,q);if(se){if(D&&X<O){const re=G;G=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(X+1,1)).lineNumber,re!==G&&(se.ranges[se.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}U[K++]=new LineVisibleRanges(se.outsideRenderedLine,X,HorizontalRange.from(se.ranges),te)}}return this._updateLineWidthsSlowIfDomDidLayout(q),K===0?null:U}_visibleRangesForLineRange(w,D,O){if(this.shouldRender()||w<this._visibleLines.getStartLineNumber()||w>this._visibleLines.getEndLineNumber())return null;const W=new DomReadingContext(this.domNode.domNode,this._textRangeRestingSpot),U=this._visibleLines.getVisibleLine(w).getVisibleRangesForRange(w,D,O,W);return this._updateLineWidthsSlowIfDomDidLayout(W),U}visibleRangeForPosition(w){const D=this._visibleRangesForLineRange(w.lineNumber,w.column,w.column);return D?new HorizontalPosition(D.outsideRenderedLine,D.ranges[0].left):null}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(w){w.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(w){const D=this._visibleLines.getStartLineNumber(),O=this._visibleLines.getEndLineNumber();let W=1,U=!0;for(let K=D;K<=O;K++){const q=this._visibleLines.getVisibleLine(K);if(w&&!q.getWidthIsFast()){U=!1;continue}W=Math.max(W,q.getWidth(null))}return U&&D===1&&O===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(W),U}_checkMonospaceFontAssumptions(){let w=-1,D=-1;const O=this._visibleLines.getStartLineNumber(),W=this._visibleLines.getEndLineNumber();for(let U=O;U<=W;U++){const K=this._visibleLines.getVisibleLine(U);if(K.needsMonospaceFontCheck()){const q=K.getWidth(null);q>D&&(D=q,w=U)}}if(w!==-1&&!this._visibleLines.getVisibleLine(w).monospaceAssumptionsAreValid())for(let U=O;U<=W;U++)this._visibleLines.getVisibleLine(U).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(w){if(this._visibleLines.renderLines(w),this._lastRenderedData.setCurrentVisibleRange(w.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const O=this._horizontalRevealRequest;if(w.startLineNumber<=O.minLineNumber&&O.maxLineNumber<=w.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const W=this._computeScrollLeftToReveal(O);W&&(this._isViewportWrapping||this._ensureMaxLineWidth(W.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:W.scrollLeft},O.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),isLinux&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const O=this._visibleLines.getStartLineNumber(),W=this._visibleLines.getEndLineNumber();for(let U=O;U<=W;U++)if(this._visibleLines.getVisibleLine(U).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const D=this._context.viewLayout.getCurrentScrollTop()-w.bigNumbersDelta;this._linesContent.setTop(-D),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(w){const D=Math.ceil(w);this._maxLineWidth<D&&(this._maxLineWidth=D,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(w,D,O,W,U,K){const q=w.top,G=w.height,Q=q+G;let Y,X,J;if(U&&U.length>0){let ae=U[0].startLineNumber,le=U[0].endLineNumber;for(let de=1,oe=U.length;de<oe;de++){const ue=U[de];ae=Math.min(ae,ue.startLineNumber),le=Math.max(le,ue.endLineNumber)}Y=!1,X=this._context.viewLayout.getVerticalOffsetForLineNumber(ae),J=this._context.viewLayout.getVerticalOffsetForLineNumber(le)+this._lineHeight}else if(W)Y=!0,X=this._context.viewLayout.getVerticalOffsetForLineNumber(W.startLineNumber),J=this._context.viewLayout.getVerticalOffsetForLineNumber(W.endLineNumber)+this._lineHeight;else return-1;const te=(D==="mouse"||O)&&this._cursorSurroundingLinesStyle==="default";let ie=0,se=0;if(te)O||(ie=this._lineHeight);else{const ae=G/this._lineHeight,le=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),de=Math.min(ae/2,le);ie=de*this._lineHeight,se=Math.max(0,de-1)*this._lineHeight}O||(K===0||K===4)&&(se+=this._lineHeight),X-=ie,J+=se;let re;if(J-X>G){if(!Y)return-1;re=X}else if(K===5||K===6)if(K===6&&q<=X&&J<=Q)re=q;else{const ae=Math.max(5*this._lineHeight,G*.2),le=X-ae,de=J-G;re=Math.max(de,le)}else if(K===1||K===2)if(K===2&&q<=X&&J<=Q)re=q;else{const ae=(X+J)/2;re=Math.max(0,ae-G/2)}else re=this._computeMinimumScrolling(q,Q,X,J,K===3,K===4);return re}_computeScrollLeftToReveal(w){const D=this._context.viewLayout.getCurrentViewport(),O=this._context.configuration.options.get(146),W=D.left,U=W+D.width-O.verticalScrollbarWidth;let K=1073741824,q=0;if(w.type==="range"){const Q=this._visibleRangesForLineRange(w.lineNumber,w.startColumn,w.endColumn);if(!Q)return null;for(const Y of Q.ranges)K=Math.min(K,Math.round(Y.left)),q=Math.max(q,Math.round(Y.left+Y.width))}else for(const Q of w.selections){if(Q.startLineNumber!==Q.endLineNumber)return null;const Y=this._visibleRangesForLineRange(Q.startLineNumber,Q.startColumn,Q.endColumn);if(!Y)return null;for(const X of Y.ranges)K=Math.min(K,Math.round(X.left)),q=Math.max(q,Math.round(X.left+X.width))}return w.minimalReveal||(K=Math.max(0,K-ViewLines.HORIZONTAL_EXTRA_PX),q+=this._revealHorizontalRightPadding),w.type==="selections"&&q-K>D.width?null:{scrollLeft:this._computeMinimumScrolling(W,U,K,q),maxHorizontalOffset:q}}_computeMinimumScrolling(w,D,O,W,U,K){w=w|0,D=D|0,O=O|0,W=W|0,U=!!U,K=!!K;const q=D-w;if(W-O<q){if(U)return O;if(K)return Math.max(0,W-q);if(O<w)return O;if(W>D)return Math.max(0,W-q)}else return O;return w}}class LinesDecorationsOverlay extends DedupOverlay{constructor(w){super(),this._context=w;const O=this._context.configuration.options.get(146);this._decorationsLeft=O.decorationsLeft,this._decorationsWidth=O.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(w){const O=this._context.configuration.options.get(146);return this._decorationsLeft=O.decorationsLeft,this._decorationsWidth=O.decorationsWidth,!0}onDecorationsChanged(w){return!0}onFlushed(w){return!0}onLinesChanged(w){return!0}onLinesDeleted(w){return!0}onLinesInserted(w){return!0}onScrollChanged(w){return w.scrollTopChanged}onZonesChanged(w){return!0}_getDecorations(w){const D=w.getDecorationsInViewport(),O=[];let W=0;for(let U=0,K=D.length;U<K;U++){const q=D[U],G=q.options.linesDecorationsClassName,Q=q.options.zIndex;G&&(O[W++]=new DecorationToRender(q.range.startLineNumber,q.range.endLineNumber,G,q.options.linesDecorationsTooltip??null,Q));const Y=q.options.firstLineDecorationClassName;Y&&(O[W++]=new DecorationToRender(q.range.startLineNumber,q.range.startLineNumber,Y,q.options.linesDecorationsTooltip??null,Q))}return O}prepareRender(w){const D=w.visibleRange.startLineNumber,O=w.visibleRange.endLineNumber,W=this._render(D,O,this._getDecorations(w)),U=this._decorationsLeft.toString(),K=this._decorationsWidth.toString(),q='" style="left:'+U+"px;width:"+K+'px;"></div>',G=[];for(let Q=D;Q<=O;Q++){const Y=Q-D,X=W[Y].getDecorations();let J="";for(const te of X){let ie='<div class="cldr '+te.className;te.tooltip!==null&&(ie+='" title="'+te.tooltip),ie+=q,J+=ie}G[Y]=J}this._renderResult=G}render(w,D){return this._renderResult?this._renderResult[D-w]:""}}class MarginViewLineDecorationsOverlay extends DedupOverlay{constructor(w){super(),this._context=w,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(w){return!0}onDecorationsChanged(w){return!0}onFlushed(w){return!0}onLinesChanged(w){return!0}onLinesDeleted(w){return!0}onLinesInserted(w){return!0}onScrollChanged(w){return w.scrollTopChanged}onZonesChanged(w){return!0}_getDecorations(w){const D=w.getDecorationsInViewport(),O=[];let W=0;for(let U=0,K=D.length;U<K;U++){const q=D[U],G=q.options.marginClassName,Q=q.options.zIndex;G&&(O[W++]=new DecorationToRender(q.range.startLineNumber,q.range.endLineNumber,G,null,Q))}return O}prepareRender(w){const D=w.visibleRange.startLineNumber,O=w.visibleRange.endLineNumber,W=this._render(D,O,this._getDecorations(w)),U=[];for(let K=D;K<=O;K++){const q=K-D,G=W[q].getDecorations();let Q="";for(const Y of G)Q+='<div class="cmdr '+Y.className+'" style=""></div>';U[q]=Q}this._renderResult=U}render(w,D){return this._renderResult?this._renderResult[D-w]:""}}class RGBA8{static{this.Empty=new RGBA8(0,0,0,0)}constructor(w,D,O,W){this._rgba8Brand=void 0,this.r=RGBA8._clamp(w),this.g=RGBA8._clamp(D),this.b=RGBA8._clamp(O),this.a=RGBA8._clamp(W)}equals(w){return this.r===w.r&&this.g===w.g&&this.b===w.b&&this.a===w.a}static _clamp(w){return w<0?0:w>255?255:w|0}}class MinimapTokensColorTracker extends Disposable{static{this._INSTANCE=null}static getInstance(){return this._INSTANCE||(this._INSTANCE=new MinimapTokensColorTracker),this._INSTANCE}constructor(){super(),this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(TokenizationRegistry.onDidChange(w=>{w.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){const w=TokenizationRegistry.getColorMap();if(!w){this._colors=[RGBA8.Empty],this._backgroundIsLight=!0;return}this._colors=[RGBA8.Empty];for(let O=1;O<w.length;O++){const W=w[O].rgba;this._colors[O]=new RGBA8(W.r,W.g,W.b,Math.round(W.a*255))}const D=w[2].getRelativeLuminance();this._backgroundIsLight=D>=.5,this._onDidChange.fire(void 0)}getColor(w){return(w<1||w>=this._colors.length)&&(w=2),this._colors[w]}backgroundIsLight(){return this._backgroundIsLight}}class Viewport{constructor(w,D,O,W){this._viewportBrand=void 0,this.top=w|0,this.left=D|0,this.width=O|0,this.height=W|0}}class MinimapLinesRenderingData{constructor(w,D){this.tabSize=w,this.data=D}}class ViewLineData{constructor(w,D,O,W,U,K,q){this._viewLineDataBrand=void 0,this.content=w,this.continuesWithWrappedLine=D,this.minColumn=O,this.maxColumn=W,this.startVisibleColumn=U,this.tokens=K,this.inlineDecorations=q}}class ViewLineRenderingData{constructor(w,D,O,W,U,K,q,G,Q,Y){this.minColumn=w,this.maxColumn=D,this.content=O,this.continuesWithWrappedLine=W,this.isBasicASCII=ViewLineRenderingData.isBasicASCII(O,K),this.containsRTL=ViewLineRenderingData.containsRTL(O,this.isBasicASCII,U),this.tokens=q,this.inlineDecorations=G,this.tabSize=Q,this.startVisibleColumn=Y}static isBasicASCII(w,D){return D?isBasicASCII(w):!0}static containsRTL(w,D,O){return!D&&O?containsRTL(w):!1}}class InlineDecoration{constructor(w,D,O){this.range=w,this.inlineClassName=D,this.type=O}}class SingleLineInlineDecoration{constructor(w,D,O,W){this.startOffset=w,this.endOffset=D,this.inlineClassName=O,this.inlineClassNameAffectsLetterSpacing=W}toInlineDecoration(w){return new InlineDecoration(new Range$2(w,this.startOffset+1,w,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class ViewModelDecoration{constructor(w,D){this._viewModelDecorationBrand=void 0,this.range=w,this.options=D}}class OverviewRulerDecorationsGroup{constructor(w,D,O){this.color=w,this.zIndex=D,this.data=O}static compareByRenderingProps(w,D){return w.zIndex===D.zIndex?w.color<D.color?-1:w.color>D.color?1:0:w.zIndex-D.zIndex}static equals(w,D){return w.color===D.color&&w.zIndex===D.zIndex&&equals$1(w.data,D.data)}static equalsArr(w,D){return equals$1(w,D,OverviewRulerDecorationsGroup.equals)}}const allCharCodes=(()=>{const F=[];for(let w=32;w<=126;w++)F.push(w);return F.push(65533),F})(),getCharIndex=(F,w)=>(F-=32,F<0||F>96?w<=2?(F+96)%96:95:F);class MinimapCharRenderer{constructor(w,D){this.scale=D,this._minimapCharRendererBrand=void 0,this.charDataNormal=MinimapCharRenderer.soften(w,12/15),this.charDataLight=MinimapCharRenderer.soften(w,50/60)}static soften(w,D){const O=new Uint8ClampedArray(w.length);for(let W=0,U=w.length;W<U;W++)O[W]=toUint8(w[W]*D);return O}renderChar(w,D,O,W,U,K,q,G,Q,Y,X){const J=1*this.scale,te=2*this.scale,ie=X?1:te;if(D+J>w.width||O+ie>w.height){console.warn("bad render request outside image data");return}const se=Y?this.charDataLight:this.charDataNormal,re=getCharIndex(W,Q),ae=w.width*4,le=q.r,de=q.g,oe=q.b,ue=U.r-le,pe=U.g-de,fe=U.b-oe,Ce=Math.max(K,G),we=w.data;let Oe=re*J*te,Te=O*ae+D*4;for(let Re=0;Re<ie;Re++){let Me=Te;for(let Ne=0;Ne<J;Ne++){const ze=se[Oe++]/255*(K/255);we[Me++]=le+ue*ze,we[Me++]=de+pe*ze,we[Me++]=oe+fe*ze,we[Me++]=Ce}Te+=ae}}blockRenderChar(w,D,O,W,U,K,q,G){const Q=1*this.scale,Y=2*this.scale,X=G?1:Y;if(D+Q>w.width||O+X>w.height){console.warn("bad render request outside image data");return}const J=w.width*4,te=.5*(U/255),ie=K.r,se=K.g,re=K.b,ae=W.r-ie,le=W.g-se,de=W.b-re,oe=ie+ae*te,ue=se+le*te,pe=re+de*te,fe=Math.max(U,q),Ce=w.data;let we=O*J+D*4;for(let Oe=0;Oe<X;Oe++){let Te=we;for(let Re=0;Re<Q;Re++)Ce[Te++]=oe,Ce[Te++]=ue,Ce[Te++]=pe,Ce[Te++]=fe;we+=J}}}const charTable={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},decodeData=F=>{const w=new Uint8ClampedArray(F.length/2);for(let D=0;D<F.length;D+=2)w[D>>1]=charTable[F[D]]<<4|charTable[F[D+1]]&15;return w},prebakedMiniMaps={1:createSingleCallFunction(()=>decodeData("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:createSingleCallFunction(()=>decodeData("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};class MinimapCharRendererFactory{static create(w,D){if(this.lastCreated&&w===this.lastCreated.scale&&D===this.lastFontFamily)return this.lastCreated;let O;return prebakedMiniMaps[w]?O=new MinimapCharRenderer(prebakedMiniMaps[w](),w):O=MinimapCharRendererFactory.createFromSampleData(MinimapCharRendererFactory.createSampleData(D).data,w),this.lastFontFamily=D,this.lastCreated=O,O}static createSampleData(w){const D=document.createElement("canvas"),O=D.getContext("2d");D.style.height="16px",D.height=16,D.width=96*10,D.style.width=96*10+"px",O.fillStyle="#ffffff",O.font=`bold 16px ${w}`,O.textBaseline="middle";let W=0;for(const U of allCharCodes)O.fillText(String.fromCharCode(U),W,16/2),W+=10;return O.getImageData(0,0,96*10,16)}static createFromSampleData(w,D){if(w.length!==61440)throw new Error("Unexpected source in MinimapCharRenderer");const W=MinimapCharRendererFactory._downsample(w,D);return new MinimapCharRenderer(W,D)}static _downsampleChar(w,D,O,W,U){const K=1*U,q=2*U;let G=W,Q=0;for(let Y=0;Y<q;Y++){const X=Y/q*16,J=(Y+1)/q*16;for(let te=0;te<K;te++){const ie=te/K*10,se=(te+1)/K*10;let re=0,ae=0;for(let de=X;de<J;de++){const oe=D+Math.floor(de)*3840,ue=1-(de-Math.floor(de));for(let pe=ie;pe<se;pe++){const fe=1-(pe-Math.floor(pe)),Ce=oe+Math.floor(pe)*4,we=fe*ue;ae+=we,re+=w[Ce]*w[Ce+3]/255*we}}const le=re/ae;Q=Math.max(Q,le),O[G++]=toUint8(le)}}return Q}static _downsample(w,D){const O=2*D*1*D,W=O*96,U=new Uint8ClampedArray(W);let K=0,q=0,G=0;for(let Q=0;Q<96;Q++)G=Math.max(G,this._downsampleChar(w,q,U,K,D)),K+=O,q+=10*4;if(G>0){const Q=255/G;for(let Y=0;Y<W;Y++)U[Y]*=Q}return U}}const DEFAULT_FONT_FAMILY=isWindows?'"Segoe WPC", "Segoe UI", sans-serif':isMacintosh?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif',POINTER_DRAG_RESET_DISTANCE=140,GUTTER_DECORATION_WIDTH=2;class MinimapOptions{constructor(w,D,O){const W=w.options,U=W.get(144),K=W.get(146),q=K.minimap,G=W.get(50),Q=W.get(73);this.renderMinimap=q.renderMinimap,this.size=Q.size,this.minimapHeightIsEditorHeight=q.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=W.get(106),this.paddingTop=W.get(84).top,this.paddingBottom=W.get(84).bottom,this.showSlider=Q.showSlider,this.autohide=Q.autohide,this.pixelRatio=U,this.typicalHalfwidthCharacterWidth=G.typicalHalfwidthCharacterWidth,this.lineHeight=W.get(67),this.minimapLeft=q.minimapLeft,this.minimapWidth=q.minimapWidth,this.minimapHeight=K.height,this.canvasInnerWidth=q.minimapCanvasInnerWidth,this.canvasInnerHeight=q.minimapCanvasInnerHeight,this.canvasOuterWidth=q.minimapCanvasOuterWidth,this.canvasOuterHeight=q.minimapCanvasOuterHeight,this.isSampling=q.minimapIsSampling,this.editorHeight=K.height,this.fontScale=q.minimapScale,this.minimapLineHeight=q.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=DEFAULT_FONT_FAMILY,this.sectionHeaderFontSize=Q.sectionHeaderFontSize*U,this.sectionHeaderLetterSpacing=Q.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=MinimapOptions._getSectionHeaderColor(D,O.getColor(1)),this.charRenderer=createSingleCallFunction(()=>MinimapCharRendererFactory.create(this.fontScale,G.fontFamily)),this.defaultBackgroundColor=O.getColor(2),this.backgroundColor=MinimapOptions._getMinimapBackground(D,this.defaultBackgroundColor),this.foregroundAlpha=MinimapOptions._getMinimapForegroundOpacity(D)}static _getMinimapBackground(w,D){const O=w.getColor(minimapBackground);return O?new RGBA8(O.rgba.r,O.rgba.g,O.rgba.b,Math.round(255*O.rgba.a)):D}static _getMinimapForegroundOpacity(w){const D=w.getColor(minimapForegroundOpacity);return D?RGBA8._clamp(Math.round(255*D.rgba.a)):255}static _getSectionHeaderColor(w,D){const O=w.getColor(editorForeground);return O?new RGBA8(O.rgba.r,O.rgba.g,O.rgba.b,Math.round(255*O.rgba.a)):D}equals(w){return this.renderMinimap===w.renderMinimap&&this.size===w.size&&this.minimapHeightIsEditorHeight===w.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===w.scrollBeyondLastLine&&this.paddingTop===w.paddingTop&&this.paddingBottom===w.paddingBottom&&this.showSlider===w.showSlider&&this.autohide===w.autohide&&this.pixelRatio===w.pixelRatio&&this.typicalHalfwidthCharacterWidth===w.typicalHalfwidthCharacterWidth&&this.lineHeight===w.lineHeight&&this.minimapLeft===w.minimapLeft&&this.minimapWidth===w.minimapWidth&&this.minimapHeight===w.minimapHeight&&this.canvasInnerWidth===w.canvasInnerWidth&&this.canvasInnerHeight===w.canvasInnerHeight&&this.canvasOuterWidth===w.canvasOuterWidth&&this.canvasOuterHeight===w.canvasOuterHeight&&this.isSampling===w.isSampling&&this.editorHeight===w.editorHeight&&this.fontScale===w.fontScale&&this.minimapLineHeight===w.minimapLineHeight&&this.minimapCharWidth===w.minimapCharWidth&&this.sectionHeaderFontSize===w.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===w.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(w.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(w.backgroundColor)&&this.foregroundAlpha===w.foregroundAlpha}}class MinimapLayout{constructor(w,D,O,W,U,K,q,G,Q){this.scrollTop=w,this.scrollHeight=D,this.sliderNeeded=O,this._computedSliderRatio=W,this.sliderTop=U,this.sliderHeight=K,this.topPaddingLineCount=q,this.startLineNumber=G,this.endLineNumber=Q}getDesiredScrollTopFromDelta(w){return Math.round(this.scrollTop+w/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(w){return Math.round((w-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(w){const D=Math.max(this.startLineNumber,w.startLineNumber),O=Math.min(this.endLineNumber,w.endLineNumber);return D>O?null:[D,O]}getYForLineNumber(w,D){return+(w-this.startLineNumber+this.topPaddingLineCount)*D}static create(w,D,O,W,U,K,q,G,Q,Y,X){const J=w.pixelRatio,te=w.minimapLineHeight,ie=Math.floor(w.canvasInnerHeight/te),se=w.lineHeight;if(w.minimapHeightIsEditorHeight){let pe=G*w.lineHeight+w.paddingTop+w.paddingBottom;w.scrollBeyondLastLine&&(pe+=Math.max(0,U-w.lineHeight-w.paddingBottom));const fe=Math.max(1,Math.floor(U*U/pe)),Ce=Math.max(0,w.minimapHeight-fe),we=Ce/(Y-U),Oe=Q*we,Te=Ce>0,Re=Math.floor(w.canvasInnerHeight/w.minimapLineHeight),Me=Math.floor(w.paddingTop/w.lineHeight);return new MinimapLayout(Q,Y,Te,we,Oe,fe,Me,1,Math.min(q,Re))}let re;if(K&&O!==q){const pe=O-D+1;re=Math.floor(pe*te/J)}else{const pe=U/se;re=Math.floor(pe*te/J)}const ae=Math.floor(w.paddingTop/se);let le=Math.floor(w.paddingBottom/se);if(w.scrollBeyondLastLine){const pe=U/se;le=Math.max(le,pe-1)}let de;if(le>0){const pe=U/se;de=(ae+q+le-pe-1)*te/J}else de=Math.max(0,(ae+q)*te/J-re);de=Math.min(w.minimapHeight-re,de);const oe=de/(Y-U),ue=Q*oe;if(ie>=ae+q+le){const pe=de>0;return new MinimapLayout(Q,Y,pe,oe,ue,re,ae,1,q)}else{let pe;D>1?pe=D+ae:pe=Math.max(1,Q/se);let fe,Ce=Math.max(1,Math.floor(pe-ue*J/te));Ce<ae?(fe=ae-Ce+1,Ce=1):(fe=0,Ce=Math.max(1,Ce-ae)),X&&X.scrollHeight===Y&&(X.scrollTop>Q&&(Ce=Math.min(Ce,X.startLineNumber),fe=Math.max(fe,X.topPaddingLineCount)),X.scrollTop<Q&&(Ce=Math.max(Ce,X.startLineNumber),fe=Math.min(fe,X.topPaddingLineCount)));const we=Math.min(q,Ce-fe+ie-1),Oe=(Q-W)/se;let Te;return Q>=w.paddingTop?Te=(D-Ce+fe+Oe)*te/J:Te=Q/w.paddingTop*(fe+Oe)*te/J,new MinimapLayout(Q,Y,!0,oe,Te,re,fe,Ce,we)}}}class MinimapLine{static{this.INVALID=new MinimapLine(-1)}constructor(w){this.dy=w}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}}class RenderData{constructor(w,D,O){this.renderedLayout=w,this._imageData=D,this._renderedLines=new RenderedLinesCollection({createLine:()=>MinimapLine.INVALID}),this._renderedLines._set(w.startLineNumber,O)}linesEquals(w){if(!this.scrollEquals(w))return!1;const O=this._renderedLines._get().lines;for(let W=0,U=O.length;W<U;W++)if(O[W].dy===-1)return!1;return!0}scrollEquals(w){return this.renderedLayout.startLineNumber===w.startLineNumber&&this.renderedLayout.endLineNumber===w.endLineNumber}_get(){const w=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:w.rendLineNumberStart,lines:w.lines}}onLinesChanged(w,D){return this._renderedLines.onLinesChanged(w,D)}onLinesDeleted(w,D){this._renderedLines.onLinesDeleted(w,D)}onLinesInserted(w,D){this._renderedLines.onLinesInserted(w,D)}onTokensChanged(w){return this._renderedLines.onTokensChanged(w)}}class MinimapBuffers{constructor(w,D,O,W){this._backgroundFillData=MinimapBuffers._createBackgroundFillData(D,O,W),this._buffers=[w.createImageData(D,O),w.createImageData(D,O)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const w=this._buffers[this._lastUsedBuffer];return w.data.set(this._backgroundFillData),w}static _createBackgroundFillData(w,D,O){const W=O.r,U=O.g,K=O.b,q=O.a,G=new Uint8ClampedArray(w*D*4);let Q=0;for(let Y=0;Y<D;Y++)for(let X=0;X<w;X++)G[Q]=W,G[Q+1]=U,G[Q+2]=K,G[Q+3]=q,Q+=4;return G}}class MinimapSamplingState{static compute(w,D,O){if(w.renderMinimap===0||!w.isSampling)return[null,[]];const{minimapLineCount:W}=EditorLayoutInfoComputer.computeContainedMinimapLineCount({viewLineCount:D,scrollBeyondLastLine:w.scrollBeyondLastLine,paddingTop:w.paddingTop,paddingBottom:w.paddingBottom,height:w.editorHeight,lineHeight:w.lineHeight,pixelRatio:w.pixelRatio}),U=D/W,K=U/2;if(!O||O.minimapLines.length===0){const re=[];if(re[0]=1,W>1){for(let ae=0,le=W-1;ae<le;ae++)re[ae]=Math.round(ae*U+K);re[W-1]=D}return[new MinimapSamplingState(U,re),[]]}const q=O.minimapLines,G=q.length,Q=[];let Y=0,X=0,J=1;const te=10;let ie=[],se=null;for(let re=0;re<W;re++){const ae=Math.max(J,Math.round(re*U)),le=Math.max(ae,Math.round((re+1)*U));for(;Y<G&&q[Y]<ae;){if(ie.length<te){const oe=Y+1+X;se&&se.type==="deleted"&&se._oldIndex===Y-1?se.deleteToLineNumber++:(se={type:"deleted",_oldIndex:Y,deleteFromLineNumber:oe,deleteToLineNumber:oe},ie.push(se)),X--}Y++}let de;if(Y<G&&q[Y]<=le)de=q[Y],Y++;else if(re===0?de=1:re+1===W?de=D:de=Math.round(re*U+K),ie.length<te){const oe=Y+1+X;se&&se.type==="inserted"&&se._i===re-1?se.insertToLineNumber++:(se={type:"inserted",_i:re,insertFromLineNumber:oe,insertToLineNumber:oe},ie.push(se)),X++}Q[re]=de,J=de}if(ie.length<te)for(;Y<G;){const re=Y+1+X;se&&se.type==="deleted"&&se._oldIndex===Y-1?se.deleteToLineNumber++:(se={type:"deleted",_oldIndex:Y,deleteFromLineNumber:re,deleteToLineNumber:re},ie.push(se)),X--,Y++}else ie=[{type:"flush"}];return[new MinimapSamplingState(U,Q),ie]}constructor(w,D){this.samplingRatio=w,this.minimapLines=D}modelLineToMinimapLine(w){return Math.min(this.minimapLines.length,Math.max(1,Math.round(w/this.samplingRatio)))}modelLineRangeToMinimapLineRange(w,D){let O=this.modelLineToMinimapLine(w)-1;for(;O>0&&this.minimapLines[O-1]>=w;)O--;let W=this.modelLineToMinimapLine(D)-1;for(;W+1<this.minimapLines.length&&this.minimapLines[W+1]<=D;)W++;if(O===W){const U=this.minimapLines[O];if(U<w||U>D)return null}return[O+1,W+1]}decorationLineRangeToMinimapLineRange(w,D){let O=this.modelLineToMinimapLine(w),W=this.modelLineToMinimapLine(D);return w!==D&&W===O&&(W===this.minimapLines.length?O>1&&O--:W++),[O,W]}onLinesDeleted(w){const D=w.toLineNumber-w.fromLineNumber+1;let O=this.minimapLines.length,W=0;for(let U=this.minimapLines.length-1;U>=0&&!(this.minimapLines[U]<w.fromLineNumber);U--)this.minimapLines[U]<=w.toLineNumber?(this.minimapLines[U]=Math.max(1,w.fromLineNumber-1),O=Math.min(O,U),W=Math.max(W,U)):this.minimapLines[U]-=D;return[O,W]}onLinesInserted(w){const D=w.toLineNumber-w.fromLineNumber+1;for(let O=this.minimapLines.length-1;O>=0&&!(this.minimapLines[O]<w.fromLineNumber);O--)this.minimapLines[O]+=D}}class Minimap extends ViewPart{constructor(w){super(w),this._sectionHeaderCache=new LRUCache(10,1.5),this.tokensColorTracker=MinimapTokensColorTracker.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new MinimapOptions(this._context.configuration,this._context.theme,this.tokensColorTracker);const[D]=MinimapSamplingState.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=D,this._shouldCheckSampling=!1,this._actual=new InnerMinimap(w.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const w=new MinimapOptions(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(w)?!1:(this.options=w,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(w){return this._onOptionsMaybeChanged()}onCursorStateChanged(w){return this._selections=w.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(w){return w.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(w){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(w){if(this._samplingState){const D=this._samplingState.modelLineRangeToMinimapLineRange(w.fromLineNumber,w.fromLineNumber+w.count-1);return D?this._actual.onLinesChanged(D[0],D[1]-D[0]+1):!1}else return this._actual.onLinesChanged(w.fromLineNumber,w.count)}onLinesDeleted(w){if(this._samplingState){const[D,O]=this._samplingState.onLinesDeleted(w);return D<=O&&this._actual.onLinesChanged(D+1,O-D+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(w.fromLineNumber,w.toLineNumber)}onLinesInserted(w){return this._samplingState?(this._samplingState.onLinesInserted(w),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(w.fromLineNumber,w.toLineNumber)}onScrollChanged(w){return this._actual.onScrollChanged()}onThemeChanged(w){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(w){if(this._samplingState){const D=[];for(const O of w.ranges){const W=this._samplingState.modelLineRangeToMinimapLineRange(O.fromLineNumber,O.toLineNumber);W&&D.push({fromLineNumber:W[0],toLineNumber:W[1]})}return D.length?this._actual.onTokensChanged(D):!1}else return this._actual.onTokensChanged(w.ranges)}onTokensColorsChanged(w){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(w){return this._actual.onZonesChanged()}prepareRender(w){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(w){let D=w.visibleRange.startLineNumber,O=w.visibleRange.endLineNumber;this._samplingState&&(D=this._samplingState.modelLineToMinimapLine(D),O=this._samplingState.modelLineToMinimapLine(O));const W={viewportContainsWhitespaceGaps:w.viewportData.whitespaceViewportData.length>0,scrollWidth:w.scrollWidth,scrollHeight:w.scrollHeight,viewportStartLineNumber:D,viewportEndLineNumber:O,viewportStartLineNumberVerticalOffset:w.getVerticalOffsetForLineNumber(D),scrollTop:w.scrollTop,scrollLeft:w.scrollLeft,viewportWidth:w.viewportWidth,viewportHeight:w.viewportHeight};this._actual.render(W)}_recreateLineSampling(){this._minimapSelections=null;const w=!!this._samplingState,[D,O]=MinimapSamplingState.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=D,w&&this._samplingState)for(const W of O)switch(W.type){case"deleted":this._actual.onLinesDeleted(W.deleteFromLineNumber,W.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(W.insertFromLineNumber,W.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(w){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[w-1]):this._context.viewModel.getLineContent(w)}getLineMaxColumn(w){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[w-1]):this._context.viewModel.getLineMaxColumn(w)}getMinimapLinesRenderingData(w,D,O){if(this._samplingState){const W=[];for(let U=0,K=D-w+1;U<K;U++)O[U]?W[U]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[w+U-1]):W[U]=null;return W}return this._context.viewModel.getMinimapLinesRenderingData(w,D,O).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(const w of this._selections){const[D,O]=this._samplingState.decorationLineRangeToMinimapLineRange(w.startLineNumber,w.endLineNumber);this._minimapSelections.push(new Selection$1(D,w.startColumn,O,w.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(w,D){const O=this._getMinimapDecorationsInViewport(w,D).filter(W=>!W.options.minimap?.sectionHeaderStyle);if(this._samplingState){const W=[];for(const U of O){if(!U.options.minimap)continue;const K=U.range,q=this._samplingState.modelLineToMinimapLine(K.startLineNumber),G=this._samplingState.modelLineToMinimapLine(K.endLineNumber);W.push(new ViewModelDecoration(new Range$2(q,K.startColumn,G,K.endColumn),U.options))}return W}return O}getSectionHeaderDecorationsInViewport(w,D){const O=this.options.minimapLineHeight,U=this.options.sectionHeaderFontSize/O;return w=Math.floor(Math.max(1,w-U)),this._getMinimapDecorationsInViewport(w,D).filter(K=>!!K.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(w,D){let O;if(this._samplingState){const W=this._samplingState.minimapLines[w-1],U=this._samplingState.minimapLines[D-1];O=new Range$2(W,1,U,this._context.viewModel.getLineMaxColumn(U))}else O=new Range$2(w,1,D,this._context.viewModel.getLineMaxColumn(D));return this._context.viewModel.getMinimapDecorationsInRange(O)}getSectionHeaderText(w,D){const O=w.options.minimap?.sectionHeaderText;if(!O)return null;const W=this._sectionHeaderCache.get(O);if(W)return W;const U=D(O);return this._sectionHeaderCache.set(O,U),U}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(w){this._samplingState&&(w=this._samplingState.minimapLines[w-1]),this._context.viewModel.revealRange("mouse",!1,new Range$2(w,1,w,1),1,0)}setScrollTop(w){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:w},1)}}class InnerMinimap extends Disposable{constructor(w,D){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._theme=w,this._model=D,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(minimapSelection),this._domNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=createFastDomNode(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=createFastDomNode(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=createFastDomNode(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=createFastDomNode(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=createFastDomNode(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=addStandardDisposableListener(this._domNode.domNode,EventType$1.POINTER_DOWN,O=>{if(O.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(O.button===0&&this._lastRenderData){const Q=getDomNodePagePosition(this._slider.domNode),Y=Q.top+Q.height/2;this._startSliderDragging(O,Y,this._lastRenderData.renderedLayout)}return}const U=this._model.options.minimapLineHeight,K=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*O.offsetY;let G=Math.floor(K/U)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;G=Math.min(G,this._model.getLineCount()),this._model.revealLineNumber(G)}),this._sliderPointerMoveMonitor=new GlobalPointerMoveMonitor,this._sliderPointerDownListener=addStandardDisposableListener(this._slider.domNode,EventType$1.POINTER_DOWN,O=>{O.preventDefault(),O.stopPropagation(),O.button===0&&this._lastRenderData&&this._startSliderDragging(O,O.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Gesture.addTarget(this._domNode.domNode),this._sliderTouchStartListener=addDisposableListener(this._domNode.domNode,EventType.Start,O=>{O.preventDefault(),O.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(O))},{passive:!1}),this._sliderTouchMoveListener=addDisposableListener(this._domNode.domNode,EventType.Change,O=>{O.preventDefault(),O.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(O)},{passive:!1}),this._sliderTouchEndListener=addStandardDisposableListener(this._domNode.domNode,EventType.End,O=>{O.preventDefault(),O.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(w,D,O){if(!w.target||!(w.target instanceof Element))return;const W=w.pageX;this._slider.toggleClassName("active",!0);const U=(K,q)=>{const G=getDomNodePagePosition(this._domNode.domNode),Q=Math.min(Math.abs(q-W),Math.abs(q-G.left),Math.abs(q-G.left-G.width));if(isWindows&&Q>POINTER_DRAG_RESET_DISTANCE){this._model.setScrollTop(O.scrollTop);return}const Y=K-D;this._model.setScrollTop(O.getDesiredScrollTopFromDelta(Y))};w.pageY!==D&&U(w.pageY,W),this._sliderPointerMoveMonitor.startMonitoring(w.target,w.pointerId,w.buttons,K=>U(K.pageY,K.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(w){const D=this._domNode.domNode.getBoundingClientRect().top,O=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(w.pageY-D);this._model.setScrollTop(O)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){const w=["minimap"];return this._model.options.showSlider==="always"?w.push("slider-always"):w.push("slider-mouseover"),this._model.options.autohide&&w.push("autohide"),w.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new MinimapBuffers(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(w,D){return this._lastRenderData?this._lastRenderData.onLinesChanged(w,D):!1}onLinesDeleted(w,D){return this._lastRenderData?.onLinesDeleted(w,D),!0}onLinesInserted(w,D){return this._lastRenderData?.onLinesInserted(w,D),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(minimapSelection),this._renderDecorations=!0,!0}onTokensChanged(w){return this._lastRenderData?this._lastRenderData.onTokensChanged(w):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(w){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}w.scrollLeft+w.viewportWidth>=w.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const O=MinimapLayout.create(this._model.options,w.viewportStartLineNumber,w.viewportEndLineNumber,w.viewportStartLineNumberVerticalOffset,w.viewportHeight,w.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),w.scrollTop,w.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(O.sliderNeeded?"block":"none"),this._slider.setTop(O.sliderTop),this._slider.setHeight(O.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(O.sliderHeight),this.renderDecorations(O),this._lastRenderData=this.renderLines(O)}renderDecorations(w){if(this._renderDecorations){this._renderDecorations=!1;const D=this._model.getSelections();D.sort(Range$2.compareRangesUsingStarts);const O=this._model.getMinimapDecorationsInViewport(w.startLineNumber,w.endLineNumber);O.sort((J,te)=>(J.options.zIndex||0)-(te.options.zIndex||0));const{canvasInnerWidth:W,canvasInnerHeight:U}=this._model.options,K=this._model.options.minimapLineHeight,q=this._model.options.minimapCharWidth,G=this._model.getOptions().tabSize,Q=this._decorationsCanvas.domNode.getContext("2d");Q.clearRect(0,0,W,U);const Y=new ContiguousLineMap(w.startLineNumber,w.endLineNumber,!1);this._renderSelectionLineHighlights(Q,D,Y,w,K),this._renderDecorationsLineHighlights(Q,O,Y,w,K);const X=new ContiguousLineMap(w.startLineNumber,w.endLineNumber,null);this._renderSelectionsHighlights(Q,D,X,w,K,G,q,W),this._renderDecorationsHighlights(Q,O,X,w,K,G,q,W),this._renderSectionHeaders(w)}}_renderSelectionLineHighlights(w,D,O,W,U){if(!this._selectionColor||this._selectionColor.isTransparent())return;w.fillStyle=this._selectionColor.transparent(.5).toString();let K=0,q=0;for(const G of D){const Q=W.intersectWithViewport(G);if(!Q)continue;const[Y,X]=Q;for(let ie=Y;ie<=X;ie++)O.set(ie,!0);const J=W.getYForLineNumber(Y,U),te=W.getYForLineNumber(X,U);q>=J||(q>K&&w.fillRect(MINIMAP_GUTTER_WIDTH,K,w.canvas.width,q-K),K=J),q=te}q>K&&w.fillRect(MINIMAP_GUTTER_WIDTH,K,w.canvas.width,q-K)}_renderDecorationsLineHighlights(w,D,O,W,U){const K=new Map;for(let q=D.length-1;q>=0;q--){const G=D[q],Q=G.options.minimap;if(!Q||Q.position!==1)continue;const Y=W.intersectWithViewport(G.range);if(!Y)continue;const[X,J]=Y,te=Q.getColor(this._theme.value);if(!te||te.isTransparent())continue;let ie=K.get(te.toString());ie||(ie=te.transparent(.5).toString(),K.set(te.toString(),ie)),w.fillStyle=ie;for(let se=X;se<=J;se++){if(O.has(se))continue;O.set(se,!0);const re=W.getYForLineNumber(X,U);w.fillRect(MINIMAP_GUTTER_WIDTH,re,w.canvas.width,U)}}}_renderSelectionsHighlights(w,D,O,W,U,K,q,G){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(const Q of D){const Y=W.intersectWithViewport(Q);if(!Y)continue;const[X,J]=Y;for(let te=X;te<=J;te++)this.renderDecorationOnLine(w,O,Q,this._selectionColor,W,te,U,U,K,q,G)}}_renderDecorationsHighlights(w,D,O,W,U,K,q,G){for(const Q of D){const Y=Q.options.minimap;if(!Y)continue;const X=W.intersectWithViewport(Q.range);if(!X)continue;const[J,te]=X,ie=Y.getColor(this._theme.value);if(!(!ie||ie.isTransparent()))for(let se=J;se<=te;se++)switch(Y.position){case 1:this.renderDecorationOnLine(w,O,Q.range,ie,W,se,U,U,K,q,G);continue;case 2:{const re=W.getYForLineNumber(se,U);this.renderDecoration(w,ie,2,re,GUTTER_DECORATION_WIDTH,U);continue}}}}renderDecorationOnLine(w,D,O,W,U,K,q,G,Q,Y,X){const J=U.getYForLineNumber(K,G);if(J+q<0||J>this._model.options.canvasInnerHeight)return;const{startLineNumber:te,endLineNumber:ie}=O,se=te===K?O.startColumn:1,re=ie===K?O.endColumn:this._model.getLineMaxColumn(K),ae=this.getXOffsetForPosition(D,K,se,Q,Y,X),le=this.getXOffsetForPosition(D,K,re,Q,Y,X);this.renderDecoration(w,W,ae,J,le-ae,q)}getXOffsetForPosition(w,D,O,W,U,K){if(O===1)return MINIMAP_GUTTER_WIDTH;if((O-1)*U>=K)return K;let G=w.get(D);if(!G){const Q=this._model.getLineContent(D);G=[MINIMAP_GUTTER_WIDTH];let Y=MINIMAP_GUTTER_WIDTH;for(let X=1;X<Q.length+1;X++){const J=Q.charCodeAt(X-1),te=J===9?W*U:isFullWidthCharacter(J)?2*U:U,ie=Y+te;if(ie>=K){G[X]=K;break}G[X]=ie,Y=ie}w.set(D,G)}return O-1<G.length?G[O-1]:K}renderDecoration(w,D,O,W,U,K){w.fillStyle=D&&D.toString()||"",w.fillRect(O,W,U,K)}_renderSectionHeaders(w){const D=this._model.options.minimapLineHeight,O=this._model.options.sectionHeaderFontSize,W=this._model.options.sectionHeaderLetterSpacing,U=O*1.5,{canvasInnerWidth:K}=this._model.options,q=this._model.options.backgroundColor,G=`rgb(${q.r} ${q.g} ${q.b} / .7)`,Q=this._model.options.sectionHeaderFontColor,Y=`rgb(${Q.r} ${Q.g} ${Q.b})`,X=Y,J=this._decorationsCanvas.domNode.getContext("2d");J.letterSpacing=W+"px",J.font="500 "+O+"px "+this._model.options.sectionHeaderFontFamily,J.strokeStyle=X,J.lineWidth=.2;const te=this._model.getSectionHeaderDecorationsInViewport(w.startLineNumber,w.endLineNumber);te.sort((se,re)=>se.range.startLineNumber-re.range.startLineNumber);const ie=InnerMinimap._fitSectionHeader.bind(null,J,K-MINIMAP_GUTTER_WIDTH);for(const se of te){const re=w.getYForLineNumber(se.range.startLineNumber,D)+O,ae=re-O,le=ae+2,de=this._model.getSectionHeaderText(se,ie);InnerMinimap._renderSectionLabel(J,de,se.options.minimap?.sectionHeaderStyle===2,G,Y,K,ae,U,re,le)}}static _fitSectionHeader(w,D,O){if(!O)return O;const W="…",U=w.measureText(O).width,K=w.measureText(W).width;if(U<=D||U<=K)return O;const q=O.length,G=U/O.length,Q=Math.floor((D-K)/G)-1;let Y=Math.ceil(Q/2);for(;Y>0&&/\s/.test(O[Y-1]);)--Y;return O.substring(0,Y)+W+O.substring(q-(Q-Y))}static _renderSectionLabel(w,D,O,W,U,K,q,G,Q,Y){D&&(w.fillStyle=W,w.fillRect(0,q,K,G),w.fillStyle=U,w.fillText(D,MINIMAP_GUTTER_WIDTH,Q)),O&&(w.beginPath(),w.moveTo(0,Y),w.lineTo(K,Y),w.closePath(),w.stroke())}renderLines(w){const D=w.startLineNumber,O=w.endLineNumber,W=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(w)){const ze=this._lastRenderData._get();return new RenderData(w,ze.imageData,ze.lines)}const U=this._getBuffer();if(!U)return null;const[K,q,G]=InnerMinimap._renderUntouchedLines(U,w.topPaddingLineCount,D,O,W,this._lastRenderData),Q=this._model.getMinimapLinesRenderingData(D,O,G),Y=this._model.getOptions().tabSize,X=this._model.options.defaultBackgroundColor,J=this._model.options.backgroundColor,te=this._model.options.foregroundAlpha,ie=this._model.tokensColorTracker,se=ie.backgroundIsLight(),re=this._model.options.renderMinimap,ae=this._model.options.charRenderer(),le=this._model.options.fontScale,de=this._model.options.minimapCharWidth,ue=(re===1?2:3)*le,pe=W>ue?Math.floor((W-ue)/2):0,fe=J.a/255,Ce=new RGBA8(Math.round((J.r-X.r)*fe+X.r),Math.round((J.g-X.g)*fe+X.g),Math.round((J.b-X.b)*fe+X.b),255);let we=w.topPaddingLineCount*W;const Oe=[];for(let ze=0,Qe=O-D+1;ze<Qe;ze++)G[ze]&&InnerMinimap._renderLine(U,Ce,J.a,se,re,de,ie,te,ae,we,pe,Y,Q[ze],le,W),Oe[ze]=new MinimapLine(we),we+=W;const Te=K===-1?0:K,Me=(q===-1?U.height:q)-Te;return this._canvas.domNode.getContext("2d").putImageData(U,0,0,0,Te,U.width,Me),new RenderData(w,U,Oe)}static _renderUntouchedLines(w,D,O,W,U,K){const q=[];if(!K){for(let we=0,Oe=W-O+1;we<Oe;we++)q[we]=!0;return[-1,-1,q]}const G=K._get(),Q=G.imageData.data,Y=G.rendLineNumberStart,X=G.lines,J=X.length,te=w.width,ie=w.data,se=(W-O+1)*U*te*4;let re=-1,ae=-1,le=-1,de=-1,oe=-1,ue=-1,pe=D*U;for(let we=O;we<=W;we++){const Oe=we-O,Te=we-Y,Re=Te>=0&&Te<J?X[Te].dy:-1;if(Re===-1){q[Oe]=!0,pe+=U;continue}const Me=Re*te*4,Ne=(Re+U)*te*4,ze=pe*te*4,Qe=(pe+U)*te*4;de===Me&&ue===ze?(de=Ne,ue=Qe):(le!==-1&&(ie.set(Q.subarray(le,de),oe),re===-1&&le===0&&le===oe&&(re=de),ae===-1&&de===se&&le===oe&&(ae=le)),le=Me,de=Ne,oe=ze,ue=Qe),q[Oe]=!1,pe+=U}le!==-1&&(ie.set(Q.subarray(le,de),oe),re===-1&&le===0&&le===oe&&(re=de),ae===-1&&de===se&&le===oe&&(ae=le));const fe=re===-1?-1:re/(te*4),Ce=ae===-1?-1:ae/(te*4);return[fe,Ce,q]}static _renderLine(w,D,O,W,U,K,q,G,Q,Y,X,J,te,ie,se){const re=te.content,ae=te.tokens,le=w.width-K,de=se===1;let oe=MINIMAP_GUTTER_WIDTH,ue=0,pe=0;for(let fe=0,Ce=ae.getCount();fe<Ce;fe++){const we=ae.getEndOffset(fe),Oe=ae.getForeground(fe),Te=q.getColor(Oe);for(;ue<we;ue++){if(oe>le)return;const Re=re.charCodeAt(ue);if(Re===9){const Me=J-(ue+pe)%J;pe+=Me-1,oe+=Me*K}else if(Re===32)oe+=K;else{const Me=isFullWidthCharacter(Re)?2:1;for(let Ne=0;Ne<Me;Ne++)if(U===2?Q.blockRenderChar(w,oe,Y+X,Te,G,D,O,de):Q.renderChar(w,oe,Y+X,Re,Te,G,D,O,ie,W,de),oe+=K,oe>le)return}}}}}class ContiguousLineMap{constructor(w,D,O){this._startLineNumber=w,this._endLineNumber=D,this._defaultValue=O,this._values=[];for(let W=0,U=this._endLineNumber-this._startLineNumber+1;W<U;W++)this._values[W]=O}has(w){return this.get(w)!==this._defaultValue}set(w,D){w<this._startLineNumber||w>this._endLineNumber||(this._values[w-this._startLineNumber]=D)}get(w){return w<this._startLineNumber||w>this._endLineNumber?this._defaultValue:this._values[w-this._startLineNumber]}}class ViewOverlayWidgets extends ViewPart{constructor(w,D){super(w),this._viewDomNode=D;const W=this._context.configuration.options.get(146);this._widgets={},this._verticalScrollbarWidth=W.verticalScrollbarWidth,this._minimapWidth=W.minimap.minimapWidth,this._horizontalScrollbarHeight=W.horizontalScrollbarHeight,this._editorHeight=W.height,this._editorWidth=W.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(w){const O=this._context.configuration.options.get(146);return this._verticalScrollbarWidth=O.verticalScrollbarWidth,this._minimapWidth=O.minimap.minimapWidth,this._horizontalScrollbarHeight=O.horizontalScrollbarHeight,this._editorHeight=O.height,this._editorWidth=O.width,!0}addWidget(w){const D=createFastDomNode(w.getDomNode());this._widgets[w.getId()]={widget:w,preference:null,domNode:D},D.setPosition("absolute"),D.setAttribute("widgetId",w.getId()),w.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(D):this._domNode.appendChild(D),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(w,D){const O=this._widgets[w.getId()],W=D?D.preference:null,U=D?.stackOridinal;return O.preference===W&&O.stack===U?(this._updateMaxMinWidth(),!1):(O.preference=W,O.stack=U,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(w){const D=w.getId();if(this._widgets.hasOwnProperty(D)){const W=this._widgets[D].domNode.domNode;delete this._widgets[D],W.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let w=0;const D=Object.keys(this._widgets);for(let O=0,W=D.length;O<W;O++){const U=D[O],q=this._widgets[U].widget.getMinContentWidthInPx?.();typeof q<"u"&&(w=Math.max(w,q))}this._context.viewLayout.setOverlayWidgetsMinWidth(w)}_renderWidget(w,D){const O=w.domNode;if(w.preference===null){O.setTop("");return}const W=2*this._verticalScrollbarWidth+this._minimapWidth;if(w.preference===0||w.preference===1){if(w.preference===1){const U=O.domNode.clientHeight;O.setTop(this._editorHeight-U-2*this._horizontalScrollbarHeight)}else O.setTop(0);w.stack!==void 0?(O.setTop(D[w.preference]),D[w.preference]+=O.domNode.clientWidth):O.setRight(W)}else if(w.preference===2)O.domNode.style.right="50%",w.stack!==void 0?(O.setTop(D[2]),D[2]+=O.domNode.clientHeight):O.setTop(0);else{const{top:U,left:K}=w.preference;if(this._context.configuration.options.get(42)&&w.widget.allowEditorOverflow){const G=this._viewDomNodeRect;O.setTop(U+G.top),O.setLeft(K+G.left),O.setPosition("fixed")}else O.setTop(U),O.setLeft(K),O.setPosition("absolute")}}prepareRender(w){this._viewDomNodeRect=getDomNodePagePosition(this._viewDomNode.domNode)}render(w){this._domNode.setWidth(this._editorWidth);const D=Object.keys(this._widgets),O=Array.from({length:3},()=>0);D.sort((W,U)=>(this._widgets[W].stack||0)-(this._widgets[U].stack||0));for(let W=0,U=D.length;W<U;W++){const K=D[W];this._renderWidget(this._widgets[K],O)}}}class Settings{constructor(w,D){const O=w.options;this.lineHeight=O.get(67),this.pixelRatio=O.get(144),this.overviewRulerLanes=O.get(83),this.renderBorder=O.get(82);const W=D.getColor(editorOverviewRulerBorder);this.borderColor=W?W.toString():null,this.hideCursor=O.get(59);const U=D.getColor(editorCursorForeground);this.cursorColorSingle=U?U.transparent(.7).toString():null;const K=D.getColor(editorMultiCursorPrimaryForeground);this.cursorColorPrimary=K?K.transparent(.7).toString():null;const q=D.getColor(editorMultiCursorSecondaryForeground);this.cursorColorSecondary=q?q.transparent(.7).toString():null,this.themeType=D.type;const G=O.get(73),Q=G.enabled,Y=G.side,X=D.getColor(editorOverviewRulerBackground),J=TokenizationRegistry.getDefaultBackground();X?this.backgroundColor=X:Q&&Y==="right"?this.backgroundColor=J:this.backgroundColor=null;const ie=O.get(146).overviewRuler;this.top=ie.top,this.right=ie.right,this.domWidth=ie.width,this.domHeight=ie.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[se,re]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=se,this.w=re}_initLanes(w,D,O){const W=D-w;if(O>=3){const U=Math.floor(W/3),K=Math.floor(W/3),q=W-U-K,G=w,Q=G+U,Y=G+U+q;return[[0,G,Q,G,Y,G,Q,G],[0,U,q,U+q,K,U+q+K,q+K,U+q+K]]}else if(O===2){const U=Math.floor(W/2),K=W-U,q=w,G=q+U;return[[0,q,q,q,G,q,q,q],[0,U,U,U,K,U+K,U+K,U+K]]}else{const U=w,K=W;return[[0,U,U,U,U,U,U,U],[0,K,K,K,K,K,K,K]]}}equals(w){return this.lineHeight===w.lineHeight&&this.pixelRatio===w.pixelRatio&&this.overviewRulerLanes===w.overviewRulerLanes&&this.renderBorder===w.renderBorder&&this.borderColor===w.borderColor&&this.hideCursor===w.hideCursor&&this.cursorColorSingle===w.cursorColorSingle&&this.cursorColorPrimary===w.cursorColorPrimary&&this.cursorColorSecondary===w.cursorColorSecondary&&this.themeType===w.themeType&&Color.equals(this.backgroundColor,w.backgroundColor)&&this.top===w.top&&this.right===w.right&&this.domWidth===w.domWidth&&this.domHeight===w.domHeight&&this.canvasWidth===w.canvasWidth&&this.canvasHeight===w.canvasHeight}}class DecorationsOverviewRuler extends ViewPart{constructor(w){super(w),this._actualShouldRender=0,this._renderedDecorations=[],this._renderedCursorPositions=[],this._domNode=createFastDomNode(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=TokenizationRegistry.onDidChange(D=>{D.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new Position$1(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(w){const D=new Settings(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(D)?!1:(this._settings=D,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,w&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(w){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(w){this._cursorPositions=[];for(let D=0,O=w.selections.length;D<O;D++){let W=this._settings.cursorColorSingle;O>1&&(W=D===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:w.selections[D].getPosition(),color:W})}return this._cursorPositions.sort((D,O)=>Position$1.compare(D.position,O.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(w){return w.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(w){return this._markRenderingIsNeeded()}onScrollChanged(w){return w.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(w){return this._markRenderingIsNeeded()}onThemeChanged(w){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(w){}render(w){this._render(),this._actualShouldRender=0}_render(){const w=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(w?Color.Format.CSS.formatHexA(w):""),this._domNode.setDisplay("none");return}const D=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(D.sort(OverviewRulerDecorationsGroup.compareByRenderingProps),this._actualShouldRender===1&&!OverviewRulerDecorationsGroup.equalsArr(this._renderedDecorations,D)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!equals$1(this._renderedCursorPositions,this._cursorPositions,(ie,se)=>ie.position.lineNumber===se.position.lineNumber&&ie.color===se.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=D,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");const O=this._settings.canvasWidth,W=this._settings.canvasHeight,U=this._settings.lineHeight,K=this._context.viewLayout,q=this._context.viewLayout.getScrollHeight(),G=W/q,Q=6*this._settings.pixelRatio|0,Y=Q/2|0,X=this._domNode.domNode.getContext("2d");w?w.isOpaque()?(X.fillStyle=Color.Format.CSS.formatHexA(w),X.fillRect(0,0,O,W)):(X.clearRect(0,0,O,W),X.fillStyle=Color.Format.CSS.formatHexA(w),X.fillRect(0,0,O,W)):X.clearRect(0,0,O,W);const J=this._settings.x,te=this._settings.w;for(const ie of D){const se=ie.color,re=ie.data;X.fillStyle=se;let ae=0,le=0,de=0;for(let oe=0,ue=re.length/3;oe<ue;oe++){const pe=re[3*oe],fe=re[3*oe+1],Ce=re[3*oe+2];let we=K.getVerticalOffsetForLineNumber(fe)*G|0,Oe=(K.getVerticalOffsetForLineNumber(Ce)+U)*G|0;if(Oe-we<Q){let Re=(we+Oe)/2|0;Re<Y?Re=Y:Re+Y>W&&(Re=W-Y),we=Re-Y,Oe=Re+Y}we>de+1||pe!==ae?(oe!==0&&X.fillRect(J[ae],le,te[ae],de-le),ae=pe,le=we,de=Oe):Oe>de&&(de=Oe)}X.fillRect(J[ae],le,te[ae],de-le)}if(!this._settings.hideCursor){const ie=2*this._settings.pixelRatio|0,se=ie/2|0,re=this._settings.x[7],ae=this._settings.w[7];let le=-100,de=-100,oe=null;for(let ue=0,pe=this._cursorPositions.length;ue<pe;ue++){const fe=this._cursorPositions[ue].color;if(!fe)continue;const Ce=this._cursorPositions[ue].position;let we=K.getVerticalOffsetForLineNumber(Ce.lineNumber)*G|0;we<se?we=se:we+se>W&&(we=W-se);const Oe=we-se,Te=Oe+ie;Oe>de+1||fe!==oe?(ue!==0&&oe&&X.fillRect(re,le,ae,de-le),le=Oe,de=Te):Te>de&&(de=Te),oe=fe,X.fillStyle=fe}oe&&X.fillRect(re,le,ae,de-le)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(X.beginPath(),X.lineWidth=1,X.strokeStyle=this._settings.borderColor,X.moveTo(0,0),X.lineTo(0,W),X.moveTo(1,0),X.lineTo(O,0),X.stroke())}}class ColorZone{constructor(w,D,O){this._colorZoneBrand=void 0,this.from=w|0,this.to=D|0,this.colorId=O|0}static compare(w,D){return w.colorId===D.colorId?w.from===D.from?w.to-D.to:w.from-D.from:w.colorId-D.colorId}}class OverviewRulerZone{constructor(w,D,O,W){this._overviewRulerZoneBrand=void 0,this.startLineNumber=w,this.endLineNumber=D,this.heightInLines=O,this.color=W,this._colorZone=null}static compare(w,D){return w.color===D.color?w.startLineNumber===D.startLineNumber?w.heightInLines===D.heightInLines?w.endLineNumber-D.endLineNumber:w.heightInLines-D.heightInLines:w.startLineNumber-D.startLineNumber:w.color<D.color?-1:1}setColorZone(w){this._colorZone=w}getColorZones(){return this._colorZone}}class OverviewZoneManager{constructor(w){this._getVerticalOffsetForLine=w,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(w){this._zones=w,this._zones.sort(OverviewRulerZone.compare)}setLineHeight(w){return this._lineHeight===w?!1:(this._lineHeight=w,this._colorZonesInvalid=!0,!0)}setPixelRatio(w){this._pixelRatio=w,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(w){return this._domWidth===w?!1:(this._domWidth=w,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(w){return this._domHeight===w?!1:(this._domHeight=w,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(w){return this._outerHeight===w?!1:(this._outerHeight=w,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const w=this._colorZonesInvalid,D=Math.floor(this._lineHeight),O=Math.floor(this.getCanvasHeight()),W=Math.floor(this._outerHeight),U=O/W,K=Math.floor(4*this._pixelRatio/2),q=[];for(let G=0,Q=this._zones.length;G<Q;G++){const Y=this._zones[G];if(!w){const oe=Y.getColorZones();if(oe){q.push(oe);continue}}const X=this._getVerticalOffsetForLine(Y.startLineNumber),J=Y.heightInLines===0?this._getVerticalOffsetForLine(Y.endLineNumber)+D:X+Y.heightInLines*D,te=Math.floor(U*X),ie=Math.floor(U*J);let se=Math.floor((te+ie)/2),re=ie-se;re<K&&(re=K),se-re<0&&(se=re),se+re>O&&(se=O-re);const ae=Y.color;let le=this._color2Id[ae];le||(le=++this._lastAssignedId,this._color2Id[ae]=le,this._id2Color[le]=ae);const de=new ColorZone(se-re,se+re,le);Y.setColorZone(de),q.push(de)}return this._colorZonesInvalid=!1,q.sort(ColorZone.compare),q}}class OverviewRuler extends ViewEventHandler{constructor(w,D){super(),this._context=w;const O=this._context.configuration.options;this._domNode=createFastDomNode(document.createElement("canvas")),this._domNode.setClassName(D),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new OverviewZoneManager(W=>this._context.viewLayout.getVerticalOffsetForLineNumber(W)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(O.get(67)),this._zoneManager.setPixelRatio(O.get(144)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(w){const D=this._context.configuration.options;return w.hasChanged(67)&&(this._zoneManager.setLineHeight(D.get(67)),this._render()),w.hasChanged(144)&&(this._zoneManager.setPixelRatio(D.get(144)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(w){return this._render(),!0}onScrollChanged(w){return w.scrollHeightChanged&&(this._zoneManager.setOuterHeight(w.scrollHeight),this._render()),!0}onZonesChanged(w){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(w){this._domNode.setTop(w.top),this._domNode.setRight(w.right);let D=!1;D=this._zoneManager.setDOMWidth(w.width)||D,D=this._zoneManager.setDOMHeight(w.height)||D,D&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(w){this._zoneManager.setZones(w),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;const w=this._zoneManager.getCanvasWidth(),D=this._zoneManager.getCanvasHeight(),O=this._zoneManager.resolveColorZones(),W=this._zoneManager.getId2Color(),U=this._domNode.domNode.getContext("2d");return U.clearRect(0,0,w,D),O.length>0&&this._renderOneLane(U,O,W,w),!0}_renderOneLane(w,D,O,W){let U=0,K=0,q=0;for(const G of D){const Q=G.colorId,Y=G.from,X=G.to;Q!==U?(w.fillRect(0,K,W,q-K),U=Q,w.fillStyle=O[U],K=Y,q=X):q>=Y?q=Math.max(q,X):(w.fillRect(0,K,W,q-K),K=Y,q=X)}w.fillRect(0,K,W,q-K)}}class Rulers extends ViewPart{constructor(w){super(w),this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const D=this._context.configuration.options;this._rulers=D.get(103),this._typicalHalfwidthCharacterWidth=D.get(50).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(w){const D=this._context.configuration.options;return this._rulers=D.get(103),this._typicalHalfwidthCharacterWidth=D.get(50).typicalHalfwidthCharacterWidth,!0}onScrollChanged(w){return w.scrollHeightChanged}prepareRender(w){}_ensureRulersCount(){const w=this._renderedRulers.length,D=this._rulers.length;if(w===D)return;if(w<D){const{tabSize:W}=this._context.viewModel.model.getOptions(),U=W;let K=D-w;for(;K>0;){const q=createFastDomNode(document.createElement("div"));q.setClassName("view-ruler"),q.setWidth(U),this.domNode.appendChild(q),this._renderedRulers.push(q),K--}return}let O=w-D;for(;O>0;){const W=this._renderedRulers.pop();this.domNode.removeChild(W),O--}}render(w){this._ensureRulersCount();for(let D=0,O=this._rulers.length;D<O;D++){const W=this._renderedRulers[D],U=this._rulers[D];W.setBoxShadow(U.color?`1px 0 0 0 ${U.color} inset`:""),W.setHeight(Math.min(w.scrollHeight,1e6)),W.setLeft(U.column*this._typicalHalfwidthCharacterWidth)}}}class ScrollDecorationViewPart extends ViewPart{constructor(w){super(w),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const O=this._context.configuration.options.get(104);this._useShadows=O.useShadows,this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const w=this._useShadows&&this._scrollTop>0;return this._shouldShow!==w?(this._shouldShow=w,!0):!1}getDomNode(){return this._domNode}_updateWidth(){const D=this._context.configuration.options.get(146);D.minimap.renderMinimap===0||D.minimap.minimapWidth>0&&D.minimap.minimapLeft===0?this._width=D.width:this._width=D.width-D.verticalScrollbarWidth}onConfigurationChanged(w){const O=this._context.configuration.options.get(104);return this._useShadows=O.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(w){return this._scrollTop=w.scrollTop,this._updateShouldShow()}prepareRender(w){}render(w){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}class HorizontalRangeWithStyle{constructor(w){this.left=w.left,this.width=w.width,this.startStyle=null,this.endStyle=null}}class LineVisibleRangesWithStyle{constructor(w,D){this.lineNumber=w,this.ranges=D}}function toStyledRange(F){return new HorizontalRangeWithStyle(F)}function toStyled(F){return new LineVisibleRangesWithStyle(F.lineNumber,F.ranges.map(toStyledRange))}class SelectionsOverlay extends DynamicViewOverlay{static{this.SELECTION_CLASS_NAME="selected-text"}static{this.SELECTION_TOP_LEFT="top-left-radius"}static{this.SELECTION_BOTTOM_LEFT="bottom-left-radius"}static{this.SELECTION_TOP_RIGHT="top-right-radius"}static{this.SELECTION_BOTTOM_RIGHT="bottom-right-radius"}static{this.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background"}static{this.ROUNDED_PIECE_WIDTH=10}constructor(w){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=w;const D=this._context.configuration.options;this._roundedSelection=D.get(102),this._typicalHalfwidthCharacterWidth=D.get(50).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(w){const D=this._context.configuration.options;return this._roundedSelection=D.get(102),this._typicalHalfwidthCharacterWidth=D.get(50).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(w){return this._selections=w.selections.slice(0),!0}onDecorationsChanged(w){return!0}onFlushed(w){return!0}onLinesChanged(w){return!0}onLinesDeleted(w){return!0}onLinesInserted(w){return!0}onScrollChanged(w){return w.scrollTopChanged}onZonesChanged(w){return!0}_visibleRangesHaveGaps(w){for(let D=0,O=w.length;D<O;D++)if(w[D].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(w,D,O){const W=this._typicalHalfwidthCharacterWidth/4;let U=null,K=null;if(O&&O.length>0&&D.length>0){const q=D[0].lineNumber;if(q===w.startLineNumber)for(let Q=0;!U&&Q<O.length;Q++)O[Q].lineNumber===q&&(U=O[Q].ranges[0]);const G=D[D.length-1].lineNumber;if(G===w.endLineNumber)for(let Q=O.length-1;!K&&Q>=0;Q--)O[Q].lineNumber===G&&(K=O[Q].ranges[0]);U&&!U.startStyle&&(U=null),K&&!K.startStyle&&(K=null)}for(let q=0,G=D.length;q<G;q++){const Q=D[q].ranges[0],Y=Q.left,X=Q.left+Q.width,J={top:0,bottom:0},te={top:0,bottom:0};if(q>0){const ie=D[q-1].ranges[0].left,se=D[q-1].ranges[0].left+D[q-1].ranges[0].width;abs(Y-ie)<W?J.top=2:Y>ie&&(J.top=1),abs(X-se)<W?te.top=2:ie<X&&X<se&&(te.top=1)}else U&&(J.top=U.startStyle.top,te.top=U.endStyle.top);if(q+1<G){const ie=D[q+1].ranges[0].left,se=D[q+1].ranges[0].left+D[q+1].ranges[0].width;abs(Y-ie)<W?J.bottom=2:ie<Y&&Y<se&&(J.bottom=1),abs(X-se)<W?te.bottom=2:X<se&&(te.bottom=1)}else K&&(J.bottom=K.startStyle.bottom,te.bottom=K.endStyle.bottom);Q.startStyle=J,Q.endStyle=te}}_getVisibleRangesWithStyle(w,D,O){const U=(D.linesVisibleRangesForRange(w,!0)||[]).map(toStyled);return!this._visibleRangesHaveGaps(U)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(D.visibleRange,U,O),U}_createSelectionPiece(w,D,O,W,U){return'<div class="cslr '+O+'" style="top:'+w.toString()+"px;bottom:"+D.toString()+"px;left:"+W.toString()+"px;width:"+U.toString()+'px;"></div>'}_actualRenderOneSelection(w,D,O,W){if(W.length===0)return;const U=!!W[0].ranges[0].startStyle,K=W[0].lineNumber,q=W[W.length-1].lineNumber;for(let G=0,Q=W.length;G<Q;G++){const Y=W[G],X=Y.lineNumber,J=X-D,te=O&&X===K?1:0,ie=O&&X!==K&&X===q?1:0;let se="",re="";for(let ae=0,le=Y.ranges.length;ae<le;ae++){const de=Y.ranges[ae];if(U){const ue=de.startStyle,pe=de.endStyle;if(ue.top===1||ue.bottom===1){se+=this._createSelectionPiece(te,ie,SelectionsOverlay.SELECTION_CLASS_NAME,de.left-SelectionsOverlay.ROUNDED_PIECE_WIDTH,SelectionsOverlay.ROUNDED_PIECE_WIDTH);let fe=SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;ue.top===1&&(fe+=" "+SelectionsOverlay.SELECTION_TOP_RIGHT),ue.bottom===1&&(fe+=" "+SelectionsOverlay.SELECTION_BOTTOM_RIGHT),se+=this._createSelectionPiece(te,ie,fe,de.left-SelectionsOverlay.ROUNDED_PIECE_WIDTH,SelectionsOverlay.ROUNDED_PIECE_WIDTH)}if(pe.top===1||pe.bottom===1){se+=this._createSelectionPiece(te,ie,SelectionsOverlay.SELECTION_CLASS_NAME,de.left+de.width,SelectionsOverlay.ROUNDED_PIECE_WIDTH);let fe=SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;pe.top===1&&(fe+=" "+SelectionsOverlay.SELECTION_TOP_LEFT),pe.bottom===1&&(fe+=" "+SelectionsOverlay.SELECTION_BOTTOM_LEFT),se+=this._createSelectionPiece(te,ie,fe,de.left+de.width,SelectionsOverlay.ROUNDED_PIECE_WIDTH)}}let oe=SelectionsOverlay.SELECTION_CLASS_NAME;if(U){const ue=de.startStyle,pe=de.endStyle;ue.top===0&&(oe+=" "+SelectionsOverlay.SELECTION_TOP_LEFT),ue.bottom===0&&(oe+=" "+SelectionsOverlay.SELECTION_BOTTOM_LEFT),pe.top===0&&(oe+=" "+SelectionsOverlay.SELECTION_TOP_RIGHT),pe.bottom===0&&(oe+=" "+SelectionsOverlay.SELECTION_BOTTOM_RIGHT)}re+=this._createSelectionPiece(te,ie,oe,de.left,de.width)}w[J][0]+=se,w[J][1]+=re}}prepareRender(w){const D=[],O=w.visibleRange.startLineNumber,W=w.visibleRange.endLineNumber;for(let K=O;K<=W;K++){const q=K-O;D[q]=["",""]}const U=[];for(let K=0,q=this._selections.length;K<q;K++){const G=this._selections[K];if(G.isEmpty()){U[K]=null;continue}const Q=this._getVisibleRangesWithStyle(G,w,this._previousFrameVisibleRangesWithStyle[K]);U[K]=Q,this._actualRenderOneSelection(D,O,this._selections.length>1,Q)}this._previousFrameVisibleRangesWithStyle=U,this._renderResult=D.map(([K,q])=>K+q)}render(w,D){if(!this._renderResult)return"";const O=D-w;return O<0||O>=this._renderResult.length?"":this._renderResult[O]}}registerThemingParticipant((F,w)=>{const D=F.getColor(editorSelectionForeground);D&&!D.isTransparent()&&w.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${D}; }`)});function abs(F){return F<0?-F:F}class ViewCursorRenderData{constructor(w,D,O,W,U,K,q){this.top=w,this.left=D,this.paddingLeft=O,this.width=W,this.height=U,this.textContent=K,this.textContentClassName=q}}var CursorPlurality;(function(F){F[F.Single=0]="Single",F[F.MultiPrimary=1]="MultiPrimary",F[F.MultiSecondary=2]="MultiSecondary"})(CursorPlurality||(CursorPlurality={}));class ViewCursor{constructor(w,D){this._context=w;const O=this._context.configuration.options,W=O.get(50);this._cursorStyle=O.get(28),this._lineHeight=O.get(67),this._typicalHalfwidthCharacterWidth=W.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(O.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setClassName(`cursor ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),applyFontInfo(this._domNode,W),this._domNode.setDisplay("none"),this._position=new Position$1(1,1),this._pluralityClass="",this.setPlurality(D),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(w){switch(w){default:case CursorPlurality.Single:this._pluralityClass="";break;case CursorPlurality.MultiPrimary:this._pluralityClass="cursor-primary";break;case CursorPlurality.MultiSecondary:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(w){const D=this._context.configuration.options,O=D.get(50);return this._cursorStyle=D.get(28),this._lineHeight=D.get(67),this._typicalHalfwidthCharacterWidth=O.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(D.get(31),this._typicalHalfwidthCharacterWidth),applyFontInfo(this._domNode,O),!0}onCursorPositionChanged(w,D){return D?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=w,!0}_getGraphemeAwarePosition(){const{lineNumber:w,column:D}=this._position,O=this._context.viewModel.getLineContent(w),[W,U]=getCharContainingOffset(O,D-1);return[new Position$1(w,W+1),O.substring(W,U)]}_prepareRender(w){let D="",O="";const[W,U]=this._getGraphemeAwarePosition();if(this._cursorStyle===TextEditorCursorStyle$1.Line||this._cursorStyle===TextEditorCursorStyle$1.LineThin){const J=w.visibleRangeForPosition(W);if(!J||J.outsideRenderedLine)return null;const te=getWindow(this._domNode.domNode);let ie;this._cursorStyle===TextEditorCursorStyle$1.Line?(ie=computeScreenAwareSize(te,this._lineCursorWidth>0?this._lineCursorWidth:2),ie>2&&(D=U,O=this._getTokenClassName(W))):ie=computeScreenAwareSize(te,1);let se=J.left,re=0;ie>=2&&se>=1&&(re=1,se-=re);const ae=w.getVerticalOffsetForLineNumber(W.lineNumber)-w.bigNumbersDelta;return new ViewCursorRenderData(ae,se,re,ie,this._lineHeight,D,O)}const K=w.linesVisibleRangesForRange(new Range$2(W.lineNumber,W.column,W.lineNumber,W.column+U.length),!1);if(!K||K.length===0)return null;const q=K[0];if(q.outsideRenderedLine||q.ranges.length===0)return null;const G=q.ranges[0],Q=U==="	"?this._typicalHalfwidthCharacterWidth:G.width<1?this._typicalHalfwidthCharacterWidth:G.width;this._cursorStyle===TextEditorCursorStyle$1.Block&&(D=U,O=this._getTokenClassName(W));let Y=w.getVerticalOffsetForLineNumber(W.lineNumber)-w.bigNumbersDelta,X=this._lineHeight;return(this._cursorStyle===TextEditorCursorStyle$1.Underline||this._cursorStyle===TextEditorCursorStyle$1.UnderlineThin)&&(Y+=this._lineHeight-2,X=2),new ViewCursorRenderData(Y,G.left,0,Q,X,D,O)}_getTokenClassName(w){const D=this._context.viewModel.getViewLineData(w.lineNumber),O=D.tokens.findTokenIndexAtOffset(w.column-1);return D.tokens.getClassName(O)}prepareRender(w){this._renderData=this._prepareRender(w)}render(w){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}class ViewCursors extends ViewPart{static{this.BLINK_INTERVAL=500}constructor(w){super(w);const D=this._context.configuration.options;this._readOnly=D.get(92),this._cursorBlinking=D.get(26),this._cursorStyle=D.get(28),this._cursorSmoothCaretAnimation=D.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new ViewCursor(this._context,CursorPlurality.Single),this._secondaryCursors=[],this._renderData=[],this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new TimeoutTimer,this._cursorFlatBlinkInterval=new WindowIntervalTimer,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(w){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(w){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(w){const D=this._context.configuration.options;this._readOnly=D.get(92),this._cursorBlinking=D.get(26),this._cursorStyle=D.get(28),this._cursorSmoothCaretAnimation=D.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(w);for(let O=0,W=this._secondaryCursors.length;O<W;O++)this._secondaryCursors[O].onConfigurationChanged(w);return!0}_onCursorPositionChanged(w,D,O){const W=this._secondaryCursors.length!==D.length||this._cursorSmoothCaretAnimation==="explicit"&&O!==3;if(this._primaryCursor.setPlurality(D.length?CursorPlurality.MultiPrimary:CursorPlurality.Single),this._primaryCursor.onCursorPositionChanged(w,W),this._updateBlinking(),this._secondaryCursors.length<D.length){const U=D.length-this._secondaryCursors.length;for(let K=0;K<U;K++){const q=new ViewCursor(this._context,CursorPlurality.MultiSecondary);this._domNode.domNode.insertBefore(q.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(q)}}else if(this._secondaryCursors.length>D.length){const U=this._secondaryCursors.length-D.length;for(let K=0;K<U;K++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let U=0;U<D.length;U++)this._secondaryCursors[U].onCursorPositionChanged(D[U],W)}onCursorStateChanged(w){const D=[];for(let W=0,U=w.selections.length;W<U;W++)D[W]=w.selections[W].getPosition();this._onCursorPositionChanged(D[0],D.slice(1),w.reason);const O=w.selections[0].isEmpty();return this._selectionIsEmpty!==O&&(this._selectionIsEmpty=O,this._updateDomClassName()),!0}onDecorationsChanged(w){return!0}onFlushed(w){return!0}onFocusChanged(w){return this._editorHasFocus=w.isFocused,this._updateBlinking(),!1}onLinesChanged(w){return!0}onLinesDeleted(w){return!0}onLinesInserted(w){return!0}onScrollChanged(w){return!0}onTokensChanged(w){const D=O=>{for(let W=0,U=w.ranges.length;W<U;W++)if(w.ranges[W].fromLineNumber<=O.lineNumber&&O.lineNumber<=w.ranges[W].toLineNumber)return!0;return!1};if(D(this._primaryCursor.getPosition()))return!0;for(const O of this._secondaryCursors)if(D(O.getPosition()))return!0;return!1}onZonesChanged(w){return!0}_getCursorBlinking(){return this._isComposingInput||!this._editorHasFocus?0:this._readOnly?5:this._cursorBlinking}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const w=this._getCursorBlinking(),D=w===0,O=w===5;D?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!D&&!O&&(w===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},ViewCursors.BLINK_INTERVAL,getWindow(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},ViewCursors.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let w="cursors-layer";switch(this._selectionIsEmpty||(w+=" has-selection"),this._cursorStyle){case TextEditorCursorStyle$1.Line:w+=" cursor-line-style";break;case TextEditorCursorStyle$1.Block:w+=" cursor-block-style";break;case TextEditorCursorStyle$1.Underline:w+=" cursor-underline-style";break;case TextEditorCursorStyle$1.LineThin:w+=" cursor-line-thin-style";break;case TextEditorCursorStyle$1.BlockOutline:w+=" cursor-block-outline-style";break;case TextEditorCursorStyle$1.UnderlineThin:w+=" cursor-underline-thin-style";break;default:w+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:w+=" cursor-blink";break;case 2:w+=" cursor-smooth";break;case 3:w+=" cursor-phase";break;case 4:w+=" cursor-expand";break;case 5:w+=" cursor-solid";break;default:w+=" cursor-solid"}else w+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(w+=" cursor-smooth-caret-animation"),w}_show(){this._primaryCursor.show();for(let w=0,D=this._secondaryCursors.length;w<D;w++)this._secondaryCursors[w].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let w=0,D=this._secondaryCursors.length;w<D;w++)this._secondaryCursors[w].hide();this._isVisible=!1}prepareRender(w){this._primaryCursor.prepareRender(w);for(let D=0,O=this._secondaryCursors.length;D<O;D++)this._secondaryCursors[D].prepareRender(w)}render(w){const D=[];let O=0;const W=this._primaryCursor.render(w);W&&(D[O++]=W);for(let U=0,K=this._secondaryCursors.length;U<K;U++){const q=this._secondaryCursors[U].render(w);q&&(D[O++]=q)}this._renderData=D}getLastRenderData(){return this._renderData}}registerThemingParticipant((F,w)=>{const D=[{class:".cursor",foreground:editorCursorForeground,background:editorCursorBackground},{class:".cursor-primary",foreground:editorMultiCursorPrimaryForeground,background:editorMultiCursorPrimaryBackground},{class:".cursor-secondary",foreground:editorMultiCursorSecondaryForeground,background:editorMultiCursorSecondaryBackground}];for(const O of D){const W=F.getColor(O.foreground);if(W){let U=F.getColor(O.background);U||(U=W.opposite()),w.addRule(`.monaco-editor .cursors-layer ${O.class} { background-color: ${W}; border-color: ${W}; color: ${U}; }`),isHighContrast(F.type)&&w.addRule(`.monaco-editor .cursors-layer.has-selection ${O.class} { border-left: 1px solid ${U}; border-right: 1px solid ${U}; }`)}}});const invalidFunc=()=>{throw new Error("Invalid change accessor")};class ViewZones extends ViewPart{constructor(w){super(w);const D=this._context.configuration.options,O=D.get(146);this._lineHeight=D.get(67),this._contentWidth=O.contentWidth,this._contentLeft=O.contentLeft,this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=createFastDomNode(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const w=this._context.viewLayout.getWhitespaces(),D=new Map;for(const W of w)D.set(W.id,W);let O=!1;return this._context.viewModel.changeWhitespace(W=>{const U=Object.keys(this._zones);for(let K=0,q=U.length;K<q;K++){const G=U[K],Q=this._zones[G],Y=this._computeWhitespaceProps(Q.delegate);Q.isInHiddenArea=Y.isInHiddenArea;const X=D.get(G);X&&(X.afterLineNumber!==Y.afterViewLineNumber||X.height!==Y.heightInPx)&&(W.changeOneWhitespace(G,Y.afterViewLineNumber,Y.heightInPx),this._safeCallOnComputedHeight(Q.delegate,Y.heightInPx),O=!0)}}),O}onConfigurationChanged(w){const D=this._context.configuration.options,O=D.get(146);return this._lineHeight=D.get(67),this._contentWidth=O.contentWidth,this._contentLeft=O.contentLeft,w.hasChanged(67)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(w){return this._recomputeWhitespacesProps()}onLinesDeleted(w){return!0}onScrollChanged(w){return w.scrollTopChanged||w.scrollWidthChanged}onZonesChanged(w){return!0}onLinesInserted(w){return!0}_getZoneOrdinal(w){return w.ordinal??w.afterColumn??1e4}_computeWhitespaceProps(w){if(w.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(w),minWidthInPx:this._minWidthInPixels(w)};let D;if(typeof w.afterColumn<"u")D=this._context.viewModel.model.validatePosition({lineNumber:w.afterLineNumber,column:w.afterColumn});else{const K=this._context.viewModel.model.validatePosition({lineNumber:w.afterLineNumber,column:1}).lineNumber;D=new Position$1(K,this._context.viewModel.model.getLineMaxColumn(K))}let O;D.column===this._context.viewModel.model.getLineMaxColumn(D.lineNumber)?O=this._context.viewModel.model.validatePosition({lineNumber:D.lineNumber+1,column:1}):O=this._context.viewModel.model.validatePosition({lineNumber:D.lineNumber,column:D.column+1});const W=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(D,w.afterColumnAffinity,!0),U=w.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(O);return{isInHiddenArea:!U,afterViewLineNumber:W.lineNumber,heightInPx:U?this._heightInPixels(w):0,minWidthInPx:this._minWidthInPixels(w)}}changeViewZones(w){let D=!1;return this._context.viewModel.changeWhitespace(O=>{const W={addZone:U=>(D=!0,this._addZone(O,U)),removeZone:U=>{U&&(D=this._removeZone(O,U)||D)},layoutZone:U=>{U&&(D=this._layoutZone(O,U)||D)}};safeInvoke1Arg(w,W),W.addZone=invalidFunc,W.removeZone=invalidFunc,W.layoutZone=invalidFunc}),D}_addZone(w,D){const O=this._computeWhitespaceProps(D),U={whitespaceId:w.insertWhitespace(O.afterViewLineNumber,this._getZoneOrdinal(D),O.heightInPx,O.minWidthInPx),delegate:D,isInHiddenArea:O.isInHiddenArea,isVisible:!1,domNode:createFastDomNode(D.domNode),marginDomNode:D.marginDomNode?createFastDomNode(D.marginDomNode):null};return this._safeCallOnComputedHeight(U.delegate,O.heightInPx),U.domNode.setPosition("absolute"),U.domNode.domNode.style.width="100%",U.domNode.setDisplay("none"),U.domNode.setAttribute("monaco-view-zone",U.whitespaceId),this.domNode.appendChild(U.domNode),U.marginDomNode&&(U.marginDomNode.setPosition("absolute"),U.marginDomNode.domNode.style.width="100%",U.marginDomNode.setDisplay("none"),U.marginDomNode.setAttribute("monaco-view-zone",U.whitespaceId),this.marginDomNode.appendChild(U.marginDomNode)),this._zones[U.whitespaceId]=U,this.setShouldRender(),U.whitespaceId}_removeZone(w,D){if(this._zones.hasOwnProperty(D)){const O=this._zones[D];return delete this._zones[D],w.removeWhitespace(O.whitespaceId),O.domNode.removeAttribute("monaco-visible-view-zone"),O.domNode.removeAttribute("monaco-view-zone"),O.domNode.domNode.remove(),O.marginDomNode&&(O.marginDomNode.removeAttribute("monaco-visible-view-zone"),O.marginDomNode.removeAttribute("monaco-view-zone"),O.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(w,D){if(this._zones.hasOwnProperty(D)){const O=this._zones[D],W=this._computeWhitespaceProps(O.delegate);return O.isInHiddenArea=W.isInHiddenArea,w.changeOneWhitespace(O.whitespaceId,W.afterViewLineNumber,W.heightInPx),this._safeCallOnComputedHeight(O.delegate,W.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(w){return this._zones.hasOwnProperty(w)?!!this._zones[w].delegate.suppressMouseDown:!1}_heightInPixels(w){return typeof w.heightInPx=="number"?w.heightInPx:typeof w.heightInLines=="number"?this._lineHeight*w.heightInLines:this._lineHeight}_minWidthInPixels(w){return typeof w.minWidthInPx=="number"?w.minWidthInPx:0}_safeCallOnComputedHeight(w,D){if(typeof w.onComputedHeight=="function")try{w.onComputedHeight(D)}catch(O){onUnexpectedError(O)}}_safeCallOnDomNodeTop(w,D){if(typeof w.onDomNodeTop=="function")try{w.onDomNodeTop(D)}catch(O){onUnexpectedError(O)}}prepareRender(w){}render(w){const D=w.viewportData.whitespaceViewportData,O={};let W=!1;for(const K of D)this._zones[K.id].isInHiddenArea||(O[K.id]=K,W=!0);const U=Object.keys(this._zones);for(let K=0,q=U.length;K<q;K++){const G=U[K],Q=this._zones[G];let Y=0,X=0,J="none";O.hasOwnProperty(G)?(Y=O[G].verticalOffset-w.bigNumbersDelta,X=O[G].height,J="block",Q.isVisible||(Q.domNode.setAttribute("monaco-visible-view-zone","true"),Q.isVisible=!0),this._safeCallOnDomNodeTop(Q.delegate,w.getScrolledTopFromAbsoluteTop(O[G].verticalOffset))):(Q.isVisible&&(Q.domNode.removeAttribute("monaco-visible-view-zone"),Q.isVisible=!1),this._safeCallOnDomNodeTop(Q.delegate,w.getScrolledTopFromAbsoluteTop(-1e6))),Q.domNode.setTop(Y),Q.domNode.setHeight(X),Q.domNode.setDisplay(J),Q.marginDomNode&&(Q.marginDomNode.setTop(Y),Q.marginDomNode.setHeight(X),Q.marginDomNode.setDisplay(J))}W&&(this.domNode.setWidth(Math.max(w.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}function safeInvoke1Arg(F,w){try{return F(w)}catch(D){onUnexpectedError(D)}}class WhitespaceOverlay extends DynamicViewOverlay{constructor(w){super(),this._context=w,this._options=new WhitespaceOptions(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(w){const D=new WhitespaceOptions(this._context.configuration);return this._options.equals(D)?w.hasChanged(146):(this._options=D,!0)}onCursorStateChanged(w){return this._selection=w.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(w){return!0}onFlushed(w){return!0}onLinesChanged(w){return!0}onLinesDeleted(w){return!0}onLinesInserted(w){return!0}onScrollChanged(w){return w.scrollTopChanged}onZonesChanged(w){return!0}prepareRender(w){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}const D=w.visibleRange.startLineNumber,W=w.visibleRange.endLineNumber-D+1,U=new Array(W);for(let q=0;q<W;q++)U[q]=!0;const K=this._context.viewModel.getMinimapLinesRenderingData(w.viewportData.startLineNumber,w.viewportData.endLineNumber,U);this._renderResult=[];for(let q=w.viewportData.startLineNumber;q<=w.viewportData.endLineNumber;q++){const G=q-w.viewportData.startLineNumber,Q=K.data[G];let Y=null;if(this._options.renderWhitespace==="selection"){const X=this._selection;for(const J of X){if(J.endLineNumber<q||J.startLineNumber>q)continue;const te=J.startLineNumber===q?J.startColumn:Q.minColumn,ie=J.endLineNumber===q?J.endColumn:Q.maxColumn;te<ie&&(Y||(Y=[]),Y.push(new LineRange(te-1,ie-1)))}}this._renderResult[G]=this._applyRenderWhitespace(w,q,Y,Q)}}_applyRenderWhitespace(w,D,O,W){if(this._options.renderWhitespace==="selection"&&!O||this._options.renderWhitespace==="trailing"&&W.continuesWithWrappedLine)return"";const U=this._context.theme.getColor(editorWhitespaces),K=this._options.renderWithSVG,q=W.content,G=this._options.stopRenderingLineAfter===-1?q.length:Math.min(this._options.stopRenderingLineAfter,q.length),Q=W.continuesWithWrappedLine,Y=W.minColumn-1,X=this._options.renderWhitespace==="boundary",J=this._options.renderWhitespace==="trailing",te=this._options.lineHeight,ie=this._options.middotWidth,se=this._options.wsmiddotWidth,re=this._options.spaceWidth,ae=Math.abs(se-re),le=Math.abs(ie-re),de=ae<le?11825:183,oe=this._options.canUseHalfwidthRightwardsArrow;let ue="",pe=!1,fe=firstNonWhitespaceIndex(q),Ce;fe===-1?(pe=!0,fe=G,Ce=G):Ce=lastNonWhitespaceIndex(q);let we=0,Oe=O&&O[we],Te=0;for(let Re=Y;Re<G;Re++){const Me=q.charCodeAt(Re);if(Oe&&Re>=Oe.endOffset&&(we++,Oe=O&&O[we]),Me!==9&&Me!==32||J&&!pe&&Re<=Ce)continue;if(X&&Re>=fe&&Re<=Ce&&Me===32){const ze=Re-1>=0?q.charCodeAt(Re-1):0,Qe=Re+1<G?q.charCodeAt(Re+1):0;if(ze!==32&&Qe!==32)continue}if(X&&Q&&Re===G-1){const ze=Re-1>=0?q.charCodeAt(Re-1):0;if(Me===32&&ze!==32&&ze!==9)continue}if(O&&(!Oe||Oe.startOffset>Re||Oe.endOffset<=Re))continue;const Ne=w.visibleRangeForPosition(new Position$1(D,Re+1));Ne&&(K?(Te=Math.max(Te,Ne.left),Me===9?ue+=this._renderArrow(te,re,Ne.left):ue+=`<circle cx="${(Ne.left+re/2).toFixed(2)}" cy="${(te/2).toFixed(2)}" r="${(re/7).toFixed(2)}" />`):Me===9?ue+=`<div class="mwh" style="left:${Ne.left}px;height:${te}px;">${oe?"￫":"→"}</div>`:ue+=`<div class="mwh" style="left:${Ne.left}px;height:${te}px;">${String.fromCharCode(de)}</div>`)}return K?(Te=Math.round(Te+re),`<svg style="bottom:0;position:absolute;width:${Te}px;height:${te}px" viewBox="0 0 ${Te} ${te}" xmlns="http://www.w3.org/2000/svg" fill="${U}">`+ue+"</svg>"):ue}_renderArrow(w,D,O){const W=D/7,U=D,K=w/2,q=O,G={x:0,y:W/2},Q={x:100/125*U,y:G.y},Y={x:Q.x-.2*Q.x,y:Q.y+.2*Q.x},X={x:Y.x+.1*Q.x,y:Y.y+.1*Q.x},J={x:X.x+.35*Q.x,y:X.y-.35*Q.x},te={x:J.x,y:-J.y},ie={x:X.x,y:-X.y},se={x:Y.x,y:-Y.y},re={x:Q.x,y:-Q.y},ae={x:G.x,y:-G.y};return`<path d="M ${[G,Q,Y,X,J,te,ie,se,re,ae].map(oe=>`${(q+oe.x).toFixed(2)} ${(K+oe.y).toFixed(2)}`).join(" L ")}" />`}render(w,D){if(!this._renderResult)return"";const O=D-w;return O<0||O>=this._renderResult.length?"":this._renderResult[O]}}class WhitespaceOptions{constructor(w){const D=w.options,O=D.get(50),W=D.get(38);W==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):W==="svg"?(this.renderWhitespace=D.get(100),this.renderWithSVG=!0):(this.renderWhitespace=D.get(100),this.renderWithSVG=!1),this.spaceWidth=O.spaceWidth,this.middotWidth=O.middotWidth,this.wsmiddotWidth=O.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=O.canUseHalfwidthRightwardsArrow,this.lineHeight=D.get(67),this.stopRenderingLineAfter=D.get(118)}equals(w){return this.renderWhitespace===w.renderWhitespace&&this.renderWithSVG===w.renderWithSVG&&this.spaceWidth===w.spaceWidth&&this.middotWidth===w.middotWidth&&this.wsmiddotWidth===w.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===w.canUseHalfwidthRightwardsArrow&&this.lineHeight===w.lineHeight&&this.stopRenderingLineAfter===w.stopRenderingLineAfter}}class ViewportData{constructor(w,D,O,W){this.selections=w,this.startLineNumber=D.startLineNumber|0,this.endLineNumber=D.endLineNumber|0,this.relativeVerticalOffset=D.relativeVerticalOffset,this.bigNumbersDelta=D.bigNumbersDelta|0,this.lineHeight=D.lineHeight|0,this.whitespaceViewportData=O,this._model=W,this.visibleRange=new Range$2(D.startLineNumber,this._model.getLineMinColumn(D.startLineNumber),D.endLineNumber,this._model.getLineMaxColumn(D.endLineNumber))}getViewLineRenderingData(w){return this._model.getViewportViewLineRenderingData(this.visibleRange,w)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class EditorTheme{get type(){return this._theme.type}get value(){return this._theme}constructor(w){this._theme=w}update(w){this._theme=w}getColor(w){return this._theme.getColor(w)}}class ViewContext{constructor(w,D,O){this.configuration=w,this.theme=new EditorTheme(D),this.viewModel=O,this.viewLayout=O.viewLayout}addEventHandler(w){this.viewModel.addViewEventHandler(w)}removeEventHandler(w){this.viewModel.removeViewEventHandler(w)}}var __decorate$U=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$R=function(F,w){return function(D,O){w(D,O,F)}};let View$1=class extends ViewEventHandler{constructor(w,D,O,W,U,K,q){super(),this._instantiationService=q,this._shouldRecomputeGlyphMarginLanes=!1,this._selections=[new Selection$1(1,1,1,1)],this._renderAnimationFrame=null;const G=new ViewController(D,W,U,w);this._context=new ViewContext(D,O,W),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=this._instantiationService.createInstance(TextAreaHandler,this._context,G,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=createFastDomNode(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=createFastDomNode(document.createElement("div")),PartFingerprints.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new EditorScrollbar(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new ViewLines(this._context,this._linesContent),this._viewZones=new ViewZones(this._context),this._viewParts.push(this._viewZones);const Q=new DecorationsOverviewRuler(this._context);this._viewParts.push(Q);const Y=new ScrollDecorationViewPart(this._context);this._viewParts.push(Y);const X=new ContentViewOverlays(this._context);this._viewParts.push(X),X.addDynamicOverlay(new CurrentLineHighlightOverlay(this._context)),X.addDynamicOverlay(new SelectionsOverlay(this._context)),X.addDynamicOverlay(new IndentGuidesOverlay(this._context)),X.addDynamicOverlay(new DecorationsOverlay(this._context)),X.addDynamicOverlay(new WhitespaceOverlay(this._context));const J=new MarginViewOverlays(this._context);this._viewParts.push(J),J.addDynamicOverlay(new CurrentLineMarginHighlightOverlay(this._context)),J.addDynamicOverlay(new MarginViewLineDecorationsOverlay(this._context)),J.addDynamicOverlay(new LinesDecorationsOverlay(this._context)),J.addDynamicOverlay(new LineNumbersOverlay(this._context)),this._glyphMarginWidgets=new GlyphMarginWidgets(this._context),this._viewParts.push(this._glyphMarginWidgets);const te=new Margin(this._context);te.getDomNode().appendChild(this._viewZones.marginDomNode),te.getDomNode().appendChild(J.getDomNode()),te.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(te),this._contentWidgets=new ViewContentWidgets(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new ViewCursors(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new ViewOverlayWidgets(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);const ie=new Rulers(this._context);this._viewParts.push(ie);const se=new BlockDecorations(this._context);this._viewParts.push(se);const re=new Minimap(this._context);if(this._viewParts.push(re),Q){const ae=this._scrollbar.getOverviewRulerLayoutInfo();ae.parent.insertBefore(Q.getDomNode(),ae.insertBefore)}this._linesContent.appendChild(X.getDomNode()),this._linesContent.appendChild(ie.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(te.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(Y.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(re.getDomNode()),this._overflowGuardContainer.appendChild(se.domNode),this.domNode.appendChild(this._overflowGuardContainer),K?(K.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),K.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new PointerHandler(this._context,G,this._createPointerHandlerHelper()))}_computeGlyphMarginLanes(){const w=this._context.viewModel.model,D=this._context.viewModel.glyphLanes;let O=[],W=0;O=O.concat(w.getAllMarginDecorations().map(U=>{const K=U.options.glyphMargin?.position??GlyphMarginLane$1.Center;return W=Math.max(W,U.range.endLineNumber),{range:U.range,lane:K,persist:U.options.glyphMargin?.persistLane}})),O=O.concat(this._glyphMarginWidgets.getWidgets().map(U=>{const K=w.validateRange(U.preference.range);return W=Math.max(W,K.endLineNumber),{range:K,lane:U.preference.lane}})),O.sort((U,K)=>Range$2.compareRangesUsingStarts(U.range,K.range)),D.reset(W);for(const U of O)D.push(U.lane,U.range,U.persist);return D}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:w=>{this._textAreaHandler.textArea.domNode.dispatchEvent(w)},getLastRenderData:()=>{const w=this._viewCursors.getLastRenderData()||[],D=this._textAreaHandler.getLastRenderData();return new PointerHandlerLastRenderData(w,D)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:w=>this._viewZones.shouldSuppressMouseDownOnViewZone(w),shouldSuppressMouseDownOnWidget:w=>this._contentWidgets.shouldSuppressMouseDownOnWidget(w),getPositionFromDOMInfo:(w,D)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(w,D)),visibleRangeForPosition:(w,D)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new Position$1(w,D))),getLineWidth:w=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(w))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:w=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(w))}}_applyLayout(){const D=this._context.configuration.options.get(146);this.domNode.setWidth(D.width),this.domNode.setHeight(D.height),this._overflowGuardContainer.setWidth(D.width),this._overflowGuardContainer.setHeight(D.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){const w=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(143)+" "+getThemeTypeSelector(this._context.theme.type)+w}handleEvents(w){super.handleEvents(w),this._scheduleRender()}onConfigurationChanged(w){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(w){return this._selections=w.selections,!1}onDecorationsChanged(w){return w.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(w){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(w){return this._context.theme.update(w.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const w of this._viewParts)w.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new BugIndicatingError;if(this._renderAnimationFrame===null){const w=this._createCoordinatedRendering();this._renderAnimationFrame=EditorRenderingCoordinator.INSTANCE.scheduleCoordinatedRendering({window:getWindow(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new BugIndicatingError;try{return w.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new BugIndicatingError;return w.renderText()},prepareRender:(D,O)=>{if(this._store.isDisposed)throw new BugIndicatingError;return w.prepareRender(D,O)},render:(D,O)=>{if(this._store.isDisposed)throw new BugIndicatingError;return w.render(D,O)}})}}_flushAccumulatedAndRenderNow(){const w=this._createCoordinatedRendering();safeInvokeNoArg(()=>w.prepareRenderText());const D=safeInvokeNoArg(()=>w.renderText());if(D){const[O,W]=D;safeInvokeNoArg(()=>w.prepareRender(O,W)),safeInvokeNoArg(()=>w.render(O,W))}}_getViewPartsToRender(){const w=[];let D=0;for(const O of this._viewParts)O.shouldRender()&&(w[D++]=O);return w}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;const w=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(w.requiredLanes)}inputLatency.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let w=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&w.length===0)return null;const D=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(D.startLineNumber,D.endLineNumber,D.centeredLineNumber);const O=new ViewportData(this._selections,D,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(O),this._viewLines.shouldRender()&&(this._viewLines.renderText(O),this._viewLines.onDidRender(),w=this._getViewPartsToRender()),[w,new RenderingContext(this._context.viewLayout,O,this._viewLines)]},prepareRender:(w,D)=>{for(const O of w)O.prepareRender(D)},render:(w,D)=>{for(const O of w)O.render(D),O.onDidRender()}}}delegateVerticalScrollbarPointerDown(w){this._scrollbar.delegateVerticalScrollbarPointerDown(w)}delegateScrollFromMouseWheelEvent(w){this._scrollbar.delegateScrollFromMouseWheelEvent(w)}restoreState(w){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:w.scrollTop,scrollLeft:w.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(w,D){const O=this._context.viewModel.model.validatePosition({lineNumber:w,column:D}),W=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(O);this._flushAccumulatedAndRenderNow();const U=this._viewLines.visibleRangeForPosition(new Position$1(W.lineNumber,W.column));return U?U.left:-1}getTargetAtClientPoint(w,D){const O=this._pointerHandler.getTargetAtClientPoint(w,D);return O?ViewUserInputEvents.convertViewToModelMouseTarget(O,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(w){return new OverviewRuler(this._context,w)}change(w){this._viewZones.changeViewZones(w),this._scheduleRender()}render(w,D){if(D){this._viewLines.forceShouldRender();for(const O of this._viewParts)O.forceShouldRender()}w?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(w){this._textAreaHandler.writeScreenReaderContent(w)}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(w){this._textAreaHandler.setAriaOptions(w)}addContentWidget(w){this._contentWidgets.addWidget(w.widget),this.layoutContentWidget(w),this._scheduleRender()}layoutContentWidget(w){this._contentWidgets.setWidgetPosition(w.widget,w.position?.position??null,w.position?.secondaryPosition??null,w.position?.preference??null,w.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(w){this._contentWidgets.removeWidget(w.widget),this._scheduleRender()}addOverlayWidget(w){this._overlayWidgets.addWidget(w.widget),this.layoutOverlayWidget(w),this._scheduleRender()}layoutOverlayWidget(w){this._overlayWidgets.setWidgetPosition(w.widget,w.position)&&this._scheduleRender()}removeOverlayWidget(w){this._overlayWidgets.removeWidget(w.widget),this._scheduleRender()}addGlyphMarginWidget(w){this._glyphMarginWidgets.addWidget(w.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(w){const D=w.position;this._glyphMarginWidgets.setWidgetPosition(w.widget,D)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(w){this._glyphMarginWidgets.removeWidget(w.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};View$1=__decorate$U([__param$R(6,IInstantiationService)],View$1);function safeInvokeNoArg(F){try{return F()}catch(w){return onUnexpectedError(w),null}}class EditorRenderingCoordinator{static{this.INSTANCE=new EditorRenderingCoordinator}constructor(){this._coordinatedRenderings=[],this._animationFrameRunners=new Map}scheduleCoordinatedRendering(w){return this._coordinatedRenderings.push(w),this._scheduleRender(w.window),{dispose:()=>{const D=this._coordinatedRenderings.indexOf(w);if(D!==-1&&(this._coordinatedRenderings.splice(D,1),this._coordinatedRenderings.length===0)){for(const[O,W]of this._animationFrameRunners)W.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(w){if(!this._animationFrameRunners.has(w)){const D=()=>{this._animationFrameRunners.delete(w),this._onRenderScheduled()};this._animationFrameRunners.set(w,runAtThisOrScheduleAtNextAnimationFrame(w,D,100))}}_onRenderScheduled(){const w=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(const O of w)safeInvokeNoArg(()=>O.prepareRenderText());const D=[];for(let O=0,W=w.length;O<W;O++){const U=w[O];D[O]=safeInvokeNoArg(()=>U.renderText())}for(let O=0,W=w.length;O<W;O++){const U=w[O],K=D[O];if(!K)continue;const[q,G]=K;safeInvokeNoArg(()=>U.prepareRender(q,G))}for(let O=0,W=w.length;O<W;O++){const U=w[O],K=D[O];if(!K)continue;const[q,G]=K;safeInvokeNoArg(()=>U.render(q,G))}}}class ModelLineProjectionData{constructor(w,D,O,W,U){this.injectionOffsets=w,this.injectionOptions=D,this.breakOffsets=O,this.breakOffsetsVisibleColumn=W,this.wrappedTextIndentLength=U}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(w){return w>0?this.wrappedTextIndentLength:0}getLineLength(w){const D=w>0?this.breakOffsets[w-1]:0;let W=this.breakOffsets[w]-D;return w>0&&(W+=this.wrappedTextIndentLength),W}getMaxOutputOffset(w){return this.getLineLength(w)}translateToInputOffset(w,D){w>0&&(D=Math.max(0,D-this.wrappedTextIndentLength));let W=w===0?D:this.breakOffsets[w-1]+D;if(this.injectionOffsets!==null)for(let U=0;U<this.injectionOffsets.length&&W>this.injectionOffsets[U];U++)W<this.injectionOffsets[U]+this.injectionOptions[U].content.length?W=this.injectionOffsets[U]:W-=this.injectionOptions[U].content.length;return W}translateToOutputPosition(w,D=2){let O=w;if(this.injectionOffsets!==null)for(let W=0;W<this.injectionOffsets.length&&!(w<this.injectionOffsets[W]||D!==1&&w===this.injectionOffsets[W]);W++)O+=this.injectionOptions[W].content.length;return this.offsetInInputWithInjectionsToOutputPosition(O,D)}offsetInInputWithInjectionsToOutputPosition(w,D=2){let O=0,W=this.breakOffsets.length-1,U=0,K=0;for(;O<=W;){U=O+(W-O)/2|0;const G=this.breakOffsets[U];if(K=U>0?this.breakOffsets[U-1]:0,D===0)if(w<=K)W=U-1;else if(w>G)O=U+1;else break;else if(w<K)W=U-1;else if(w>=G)O=U+1;else break}let q=w-K;return U>0&&(q+=this.wrappedTextIndentLength),new OutputPosition(U,q)}normalizeOutputPosition(w,D,O){if(this.injectionOffsets!==null){const W=this.outputPositionToOffsetInInputWithInjections(w,D),U=this.normalizeOffsetInInputWithInjectionsAroundInjections(W,O);if(U!==W)return this.offsetInInputWithInjectionsToOutputPosition(U,O)}if(O===0){if(w>0&&D===this.getMinOutputOffset(w))return new OutputPosition(w-1,this.getMaxOutputOffset(w-1))}else if(O===1){const W=this.getOutputLineCount()-1;if(w<W&&D===this.getMaxOutputOffset(w))return new OutputPosition(w+1,this.getMinOutputOffset(w+1))}return new OutputPosition(w,D)}outputPositionToOffsetInInputWithInjections(w,D){return w>0&&(D=Math.max(0,D-this.wrappedTextIndentLength)),(w>0?this.breakOffsets[w-1]:0)+D}normalizeOffsetInInputWithInjectionsAroundInjections(w,D){const O=this.getInjectedTextAtOffset(w);if(!O)return w;if(D===2){if(w===O.offsetInInputWithInjections+O.length&&hasRightCursorStop(this.injectionOptions[O.injectedTextIndex].cursorStops))return O.offsetInInputWithInjections+O.length;{let W=O.offsetInInputWithInjections;if(hasLeftCursorStop(this.injectionOptions[O.injectedTextIndex].cursorStops))return W;let U=O.injectedTextIndex-1;for(;U>=0&&this.injectionOffsets[U]===this.injectionOffsets[O.injectedTextIndex]&&!(hasRightCursorStop(this.injectionOptions[U].cursorStops)||(W-=this.injectionOptions[U].content.length,hasLeftCursorStop(this.injectionOptions[U].cursorStops)));)U--;return W}}else if(D===1||D===4){let W=O.offsetInInputWithInjections+O.length,U=O.injectedTextIndex;for(;U+1<this.injectionOffsets.length&&this.injectionOffsets[U+1]===this.injectionOffsets[U];)W+=this.injectionOptions[U+1].content.length,U++;return W}else if(D===0||D===3){let W=O.offsetInInputWithInjections,U=O.injectedTextIndex;for(;U-1>=0&&this.injectionOffsets[U-1]===this.injectionOffsets[U];)W-=this.injectionOptions[U-1].content.length,U--;return W}assertNever()}getInjectedText(w,D){const O=this.outputPositionToOffsetInInputWithInjections(w,D),W=this.getInjectedTextAtOffset(O);return W?{options:this.injectionOptions[W.injectedTextIndex]}:null}getInjectedTextAtOffset(w){const D=this.injectionOffsets,O=this.injectionOptions;if(D!==null){let W=0;for(let U=0;U<D.length;U++){const K=O[U].content.length,q=D[U]+W,G=D[U]+W+K;if(q>w)break;if(w<=G)return{injectedTextIndex:U,offsetInInputWithInjections:q,length:K};W+=K}}}}function hasRightCursorStop(F){return F==null?!0:F===InjectedTextCursorStops$1.Right||F===InjectedTextCursorStops$1.Both}function hasLeftCursorStop(F){return F==null?!0:F===InjectedTextCursorStops$1.Left||F===InjectedTextCursorStops$1.Both}class OutputPosition{constructor(w,D){this.outputLineIndex=w,this.outputOffset=D}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(w){return new Position$1(w+this.outputLineIndex,this.outputOffset+1)}}const ttPolicy$3=createTrustedTypesPolicy("domLineBreaksComputer",{createHTML:F=>F});class DOMLineBreaksComputerFactory{static create(w){return new DOMLineBreaksComputerFactory(new WeakRef(w))}constructor(w){this.targetWindow=w}createLineBreaksComputer(w,D,O,W,U){const K=[],q=[];return{addRequest:(G,Q,Y)=>{K.push(G),q.push(Q)},finalize:()=>createLineBreaks$1(assertIsDefined(this.targetWindow.deref()),K,w,D,O,W,U,q)}}}function createLineBreaks$1(F,w,D,O,W,U,K,q){function G(we){const Oe=q[we];if(Oe){const Te=LineInjectedText.applyInjectedText(w[we],Oe),Re=Oe.map(Ne=>Ne.options),Me=Oe.map(Ne=>Ne.column-1);return new ModelLineProjectionData(Me,Re,[Te.length],[],0)}else return null}if(W===-1){const we=[];for(let Oe=0,Te=w.length;Oe<Te;Oe++)we[Oe]=G(Oe);return we}const Q=Math.round(W*D.typicalHalfwidthCharacterWidth),X=Math.round(O*(U===3?2:U===2?1:0)),J=Math.ceil(D.spaceWidth*X),te=document.createElement("div");applyFontInfo(te,D);const ie=new StringBuilder(1e4),se=[],re=[],ae=[],le=[],de=[];for(let we=0;we<w.length;we++){const Oe=LineInjectedText.applyInjectedText(w[we],q[we]);let Te=0,Re=0,Me=Q;if(U!==0)if(Te=firstNonWhitespaceIndex(Oe),Te===-1)Te=0;else{for(let Ye=0;Ye<Te;Ye++){const Je=Oe.charCodeAt(Ye)===9?O-Re%O:1;Re+=Je}const Qe=Math.ceil(D.spaceWidth*Re);Qe+D.typicalFullwidthCharacterWidth>Q?(Te=0,Re=0):Me=Q-Qe}const Ne=Oe.substr(Te),ze=renderLine(Ne,Re,O,Me,ie,J);se[we]=Te,re[we]=Re,ae[we]=Ne,le[we]=ze[0],de[we]=ze[1]}const oe=ie.build(),ue=ttPolicy$3?.createHTML(oe)??oe;te.innerHTML=ue,te.style.position="absolute",te.style.top="10000",K==="keepAll"?(te.style.wordBreak="keep-all",te.style.overflowWrap="anywhere"):(te.style.wordBreak="inherit",te.style.overflowWrap="break-word"),F.document.body.appendChild(te);const pe=document.createRange(),fe=Array.prototype.slice.call(te.children,0),Ce=[];for(let we=0;we<w.length;we++){const Oe=fe[we],Te=readLineBreaks(pe,Oe,ae[we],le[we]);if(Te===null){Ce[we]=G(we);continue}const Re=se[we],Me=re[we]+X,Ne=de[we],ze=[];for(let at=0,st=Te.length;at<st;at++)ze[at]=Ne[Te[at]];if(Re!==0)for(let at=0,st=Te.length;at<st;at++)Te[at]+=Re;let Qe,Ye;const Je=q[we];Je?(Qe=Je.map(at=>at.options),Ye=Je.map(at=>at.column-1)):(Qe=null,Ye=null),Ce[we]=new ModelLineProjectionData(Ye,Qe,Te,ze,Me)}return te.remove(),Ce}function renderLine(F,w,D,O,W,U){if(U!==0){const J=String(U);W.appendString('<div style="text-indent: -'),W.appendString(J),W.appendString("px; padding-left: "),W.appendString(J),W.appendString("px; box-sizing: border-box; width:")}else W.appendString('<div style="width:');W.appendString(String(O)),W.appendString('px;">');const K=F.length;let q=w,G=0;const Q=[],Y=[];let X=0<K?F.charCodeAt(0):0;W.appendString("<span>");for(let J=0;J<K;J++){J!==0&&J%16384===0&&W.appendString("</span><span>"),Q[J]=G,Y[J]=q;const te=X;X=J+1<K?F.charCodeAt(J+1):0;let ie=1,se=1;switch(te){case 9:ie=D-q%D,se=ie;for(let re=1;re<=ie;re++)re<ie?W.appendCharCode(160):W.appendASCIICharCode(32);break;case 32:X===32?W.appendCharCode(160):W.appendASCIICharCode(32);break;case 60:W.appendString("&lt;");break;case 62:W.appendString("&gt;");break;case 38:W.appendString("&amp;");break;case 0:W.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:W.appendCharCode(65533);break;default:isFullWidthCharacter(te)&&se++,te<32?W.appendCharCode(9216+te):W.appendCharCode(te)}G+=ie,q+=se}return W.appendString("</span>"),Q[F.length]=G,Y[F.length]=q,W.appendString("</div>"),[Q,Y]}function readLineBreaks(F,w,D,O){if(D.length<=1)return null;const W=Array.prototype.slice.call(w.children,0),U=[];try{discoverBreaks(F,W,O,0,null,D.length-1,null,U)}catch(K){return console.log(K),null}return U.length===0?null:(U.push(D.length),U)}function discoverBreaks(F,w,D,O,W,U,K,q){if(O===U||(W=W||readClientRect(F,w,D[O],D[O+1]),K=K||readClientRect(F,w,D[U],D[U+1]),Math.abs(W[0].top-K[0].top)<=.1))return;if(O+1===U){q.push(U);return}const G=O+(U-O)/2|0,Q=readClientRect(F,w,D[G],D[G+1]);discoverBreaks(F,w,D,O,W,G,Q,q),discoverBreaks(F,w,D,G,Q,U,K,q)}function readClientRect(F,w,D,O){return F.setStart(w[D/16384|0].firstChild,D%16384),F.setEnd(w[O/16384|0].firstChild,O%16384),F.getClientRects()}class CodeEditorContributions extends Disposable{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new DisposableMap),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(w,D,O){this._editor=w,this._instantiationService=O;for(const W of D){if(this._pending.has(W.id)){onUnexpectedError(new Error(`Cannot have two contributions with the same id ${W.id}`));continue}this._pending.set(W.id,W)}this._instantiateSome(0),this._register(runWhenWindowIdle(getWindow(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(runWhenWindowIdle(getWindow(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(runWhenWindowIdle(getWindow(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){const w={};for(const[D,O]of this._instances)typeof O.saveViewState=="function"&&(w[D]=O.saveViewState());return w}restoreViewState(w){for(const[D,O]of this._instances)typeof O.restoreViewState=="function"&&O.restoreViewState(w[D])}get(w){return this._instantiateById(w),this._instances.get(w)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return runWhenWindowIdle(getWindow(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(w){if(this._finishedInstantiation[w])return;this._finishedInstantiation[w]=!0;const D=this._findPendingContributionsByInstantiation(w);for(const O of D)this._instantiateById(O.id)}_findPendingContributionsByInstantiation(w){const D=[];for(const[,O]of this._pending)O.instantiation===w&&D.push(O);return D}_instantiateById(w){const D=this._pending.get(w);if(D){if(this._pending.delete(w),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const O=this._instantiationService.createInstance(D.ctor,this._editor);this._instances.set(D.id,O),typeof O.restoreViewState=="function"&&D.instantiation!==0&&console.warn(`Editor contribution '${D.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(O){onUnexpectedError(O)}}}}class InternalEditorAction{constructor(w,D,O,W,U,K,q){this.id=w,this.label=D,this.alias=O,this.metadata=W,this._precondition=U,this._run=K,this._contextKeyService=q}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(w){return this.isSupported()?this._run(w):Promise.resolve(void 0)}}const EditorType={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};class MonospaceLineBreaksComputerFactory{static create(w){return new MonospaceLineBreaksComputerFactory(w.get(135),w.get(134))}constructor(w,D){this.classifier=new WrappingCharacterClassifier(w,D)}createLineBreaksComputer(w,D,O,W,U){const K=[],q=[],G=[];return{addRequest:(Q,Y,X)=>{K.push(Q),q.push(Y),G.push(X)},finalize:()=>{const Q=w.typicalFullwidthCharacterWidth/w.typicalHalfwidthCharacterWidth,Y=[];for(let X=0,J=K.length;X<J;X++){const te=q[X],ie=G[X];ie&&!ie.injectionOptions&&!te?Y[X]=createLineBreaksFromPreviousLineBreaks(this.classifier,ie,K[X],D,O,Q,W,U):Y[X]=createLineBreaks(this.classifier,K[X],te,D,O,Q,W,U)}return arrPool1.length=0,arrPool2.length=0,Y}}}}class WrappingCharacterClassifier extends CharacterClassifier{constructor(w,D){super(0);for(let O=0;O<w.length;O++)this.set(w.charCodeAt(O),1);for(let O=0;O<D.length;O++)this.set(D.charCodeAt(O),2)}get(w){return w>=0&&w<256?this._asciiMap[w]:w>=12352&&w<=12543||w>=13312&&w<=19903||w>=19968&&w<=40959?3:this._map.get(w)||this._defaultValue}}let arrPool1=[],arrPool2=[];function createLineBreaksFromPreviousLineBreaks(F,w,D,O,W,U,K,q){if(W===-1)return null;const G=D.length;if(G<=1)return null;const Q=q==="keepAll",Y=w.breakOffsets,X=w.breakOffsetsVisibleColumn,J=computeWrappedTextIndentLength(D,O,W,U,K),te=W-J,ie=arrPool1,se=arrPool2;let re=0,ae=0,le=0,de=W;const oe=Y.length;let ue=0;if(ue>=0){let pe=Math.abs(X[ue]-de);for(;ue+1<oe;){const fe=Math.abs(X[ue+1]-de);if(fe>=pe)break;pe=fe,ue++}}for(;ue<oe;){let pe=ue<0?0:Y[ue],fe=ue<0?0:X[ue];ae>pe&&(pe=ae,fe=le);let Ce=0,we=0,Oe=0,Te=0;if(fe<=de){let Me=fe,Ne=pe===0?0:D.charCodeAt(pe-1),ze=pe===0?0:F.get(Ne),Qe=!0;for(let Ye=pe;Ye<G;Ye++){const Je=Ye,at=D.charCodeAt(Ye);let st,lt;if(isHighSurrogate(at)?(Ye++,st=0,lt=2):(st=F.get(at),lt=computeCharWidth(at,Me,O,U)),Je>ae&&canBreak(Ne,ze,at,st,Q)&&(Ce=Je,we=Me),Me+=lt,Me>de){Je>ae?(Oe=Je,Te=Me-lt):(Oe=Ye+1,Te=Me),Me-we>te&&(Ce=0),Qe=!1;break}Ne=at,ze=st}if(Qe){re>0&&(ie[re]=Y[Y.length-1],se[re]=X[Y.length-1],re++);break}}if(Ce===0){let Me=fe,Ne=D.charCodeAt(pe),ze=F.get(Ne),Qe=!1;for(let Ye=pe-1;Ye>=ae;Ye--){const Je=Ye+1,at=D.charCodeAt(Ye);if(at===9){Qe=!0;break}let st,lt;if(isLowSurrogate(at)?(Ye--,st=0,lt=2):(st=F.get(at),lt=isFullWidthCharacter(at)?U:1),Me<=de){if(Oe===0&&(Oe=Je,Te=Me),Me<=de-te)break;if(canBreak(at,st,Ne,ze,Q)){Ce=Je,we=Me;break}}Me-=lt,Ne=at,ze=st}if(Ce!==0){const Ye=te-(Te-we);if(Ye<=O){const Je=D.charCodeAt(Oe);let at;isHighSurrogate(Je)?at=2:at=computeCharWidth(Je,Te,O,U),Ye-at<0&&(Ce=0)}}if(Qe){ue--;continue}}if(Ce===0&&(Ce=Oe,we=Te),Ce<=ae){const Me=D.charCodeAt(ae);isHighSurrogate(Me)?(Ce=ae+2,we=le+2):(Ce=ae+1,we=le+computeCharWidth(Me,le,O,U))}for(ae=Ce,ie[re]=Ce,le=we,se[re]=we,re++,de=we+te;ue<0||ue<oe&&X[ue]<we;)ue++;let Re=Math.abs(X[ue]-de);for(;ue+1<oe;){const Me=Math.abs(X[ue+1]-de);if(Me>=Re)break;Re=Me,ue++}}return re===0?null:(ie.length=re,se.length=re,arrPool1=w.breakOffsets,arrPool2=w.breakOffsetsVisibleColumn,w.breakOffsets=ie,w.breakOffsetsVisibleColumn=se,w.wrappedTextIndentLength=J,w)}function createLineBreaks(F,w,D,O,W,U,K,q){const G=LineInjectedText.applyInjectedText(w,D);let Q,Y;if(D&&D.length>0?(Q=D.map(we=>we.options),Y=D.map(we=>we.column-1)):(Q=null,Y=null),W===-1)return Q?new ModelLineProjectionData(Y,Q,[G.length],[],0):null;const X=G.length;if(X<=1)return Q?new ModelLineProjectionData(Y,Q,[G.length],[],0):null;const J=q==="keepAll",te=computeWrappedTextIndentLength(G,O,W,U,K),ie=W-te,se=[],re=[];let ae=0,le=0,de=0,oe=W,ue=G.charCodeAt(0),pe=F.get(ue),fe=computeCharWidth(ue,0,O,U),Ce=1;isHighSurrogate(ue)&&(fe+=1,ue=G.charCodeAt(1),pe=F.get(ue),Ce++);for(let we=Ce;we<X;we++){const Oe=we,Te=G.charCodeAt(we);let Re,Me;isHighSurrogate(Te)?(we++,Re=0,Me=2):(Re=F.get(Te),Me=computeCharWidth(Te,fe,O,U)),canBreak(ue,pe,Te,Re,J)&&(le=Oe,de=fe),fe+=Me,fe>oe&&((le===0||fe-de>ie)&&(le=Oe,de=fe-Me),se[ae]=le,re[ae]=de,ae++,oe=de+ie,le=0),ue=Te,pe=Re}return ae===0&&(!D||D.length===0)?null:(se[ae]=X,re[ae]=fe,new ModelLineProjectionData(Y,Q,se,re,te))}function computeCharWidth(F,w,D,O){return F===9?D-w%D:isFullWidthCharacter(F)||F<32?O:1}function tabCharacterWidth(F,w){return w-F%w}function canBreak(F,w,D,O,W){return D!==32&&(w===2&&O!==2||w!==1&&O===1||!W&&w===3&&O!==2||!W&&O===3&&w!==1)}function computeWrappedTextIndentLength(F,w,D,O,W){let U=0;if(W!==0){const K=firstNonWhitespaceIndex(F);if(K!==-1){for(let G=0;G<K;G++){const Q=F.charCodeAt(G)===9?tabCharacterWidth(U,w):1;U+=Q}const q=W===3?2:W===2?1:0;for(let G=0;G<q;G++){const Q=tabCharacterWidth(U,w);U+=Q}U+O>D&&(U=0)}}return U}class Cursor{constructor(w){this._selTrackedRange=null,this._trackSelection=!0,this._setState(w,new SingleCursorState(new Range$2(1,1,1,1),0,0,new Position$1(1,1),0),new SingleCursorState(new Range$2(1,1,1,1),0,0,new Position$1(1,1),0))}dispose(w){this._removeTrackedRange(w)}startTrackingSelection(w){this._trackSelection=!0,this._updateTrackedRange(w)}stopTrackingSelection(w){this._trackSelection=!1,this._removeTrackedRange(w)}_updateTrackedRange(w){this._trackSelection&&(this._selTrackedRange=w.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(w){this._selTrackedRange=w.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new CursorState(this.modelState,this.viewState)}readSelectionFromMarkers(w){const D=w.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!D.isEmpty()?Selection$1.fromRange(D.collapseToEnd(),this.modelState.selection.getDirection()):Selection$1.fromRange(D,this.modelState.selection.getDirection())}ensureValidState(w){this._setState(w,this.modelState,this.viewState)}setState(w,D,O){this._setState(w,D,O)}static _validatePositionWithCache(w,D,O,W){return D.equals(O)?W:w.normalizePosition(D,2)}static _validateViewState(w,D){const O=D.position,W=D.selectionStart.getStartPosition(),U=D.selectionStart.getEndPosition(),K=w.normalizePosition(O,2),q=this._validatePositionWithCache(w,W,O,K),G=this._validatePositionWithCache(w,U,W,q);return O.equals(K)&&W.equals(q)&&U.equals(G)?D:new SingleCursorState(Range$2.fromPositions(q,G),D.selectionStartKind,D.selectionStartLeftoverVisibleColumns+W.column-q.column,K,D.leftoverVisibleColumns+O.column-K.column)}_setState(w,D,O){if(O&&(O=Cursor._validateViewState(w.viewModel,O)),D){const W=w.model.validateRange(D.selectionStart),U=D.selectionStart.equalsRange(W)?D.selectionStartLeftoverVisibleColumns:0,K=w.model.validatePosition(D.position),q=D.position.equals(K)?D.leftoverVisibleColumns:0;D=new SingleCursorState(W,D.selectionStartKind,U,K,q)}else{if(!O)return;const W=w.model.validateRange(w.coordinatesConverter.convertViewRangeToModelRange(O.selectionStart)),U=w.model.validatePosition(w.coordinatesConverter.convertViewPositionToModelPosition(O.position));D=new SingleCursorState(W,O.selectionStartKind,O.selectionStartLeftoverVisibleColumns,U,O.leftoverVisibleColumns)}if(O){const W=w.coordinatesConverter.validateViewRange(O.selectionStart,D.selectionStart),U=w.coordinatesConverter.validateViewPosition(O.position,D.position);O=new SingleCursorState(W,D.selectionStartKind,D.selectionStartLeftoverVisibleColumns,U,D.leftoverVisibleColumns)}else{const W=w.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(D.selectionStart.startLineNumber,D.selectionStart.startColumn)),U=w.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(D.selectionStart.endLineNumber,D.selectionStart.endColumn)),K=new Range$2(W.lineNumber,W.column,U.lineNumber,U.column),q=w.coordinatesConverter.convertModelPositionToViewPosition(D.position);O=new SingleCursorState(K,D.selectionStartKind,D.selectionStartLeftoverVisibleColumns,q,D.leftoverVisibleColumns)}this.modelState=D,this.viewState=O,this._updateTrackedRange(w)}}class CursorCollection{constructor(w){this.context=w,this.cursors=[new Cursor(w)],this.lastAddedCursorIndex=0}dispose(){for(const w of this.cursors)w.dispose(this.context)}startTrackingSelections(){for(const w of this.cursors)w.startTrackingSelection(this.context)}stopTrackingSelections(){for(const w of this.cursors)w.stopTrackingSelection(this.context)}updateContext(w){this.context=w}ensureValidState(){for(const w of this.cursors)w.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(w=>w.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(w=>w.asCursorState())}getViewPositions(){return this.cursors.map(w=>w.viewState.position)}getTopMostViewPosition(){return findFirstMin(this.cursors,compareBy(w=>w.viewState.position,Position$1.compare)).viewState.position}getBottomMostViewPosition(){return findLastMax(this.cursors,compareBy(w=>w.viewState.position,Position$1.compare)).viewState.position}getSelections(){return this.cursors.map(w=>w.modelState.selection)}getViewSelections(){return this.cursors.map(w=>w.viewState.selection)}setSelections(w){this.setStates(CursorState.fromModelSelections(w))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(w){w!==null&&(this.cursors[0].setState(this.context,w[0].modelState,w[0].viewState),this._setSecondaryStates(w.slice(1)))}_setSecondaryStates(w){const D=this.cursors.length-1,O=w.length;if(D<O){const W=O-D;for(let U=0;U<W;U++)this._addSecondaryCursor()}else if(D>O){const W=D-O;for(let U=0;U<W;U++)this._removeSecondaryCursor(this.cursors.length-2)}for(let W=0;W<O;W++)this.cursors[W+1].setState(this.context,w[W].modelState,w[W].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new Cursor(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(w){this.lastAddedCursorIndex>=w+1&&this.lastAddedCursorIndex--,this.cursors[w+1].dispose(this.context),this.cursors.splice(w+1,1)}normalize(){if(this.cursors.length===1)return;const w=this.cursors.slice(0),D=[];for(let O=0,W=w.length;O<W;O++)D.push({index:O,selection:w[O].modelState.selection});D.sort(compareBy(O=>O.selection,Range$2.compareRangesUsingStarts));for(let O=0;O<D.length-1;O++){const W=D[O],U=D[O+1],K=W.selection,q=U.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let G;if(q.isEmpty()||K.isEmpty()?G=q.getStartPosition().isBeforeOrEqual(K.getEndPosition()):G=q.getStartPosition().isBefore(K.getEndPosition()),G){const Q=W.index<U.index?O:O+1,Y=W.index<U.index?O+1:O,X=D[Y].index,J=D[Q].index,te=D[Y].selection,ie=D[Q].selection;if(!te.equalsSelection(ie)){const se=te.plusRange(ie),re=te.selectionStartLineNumber===te.startLineNumber&&te.selectionStartColumn===te.startColumn,ae=ie.selectionStartLineNumber===ie.startLineNumber&&ie.selectionStartColumn===ie.startColumn;let le;X===this.lastAddedCursorIndex?(le=re,this.lastAddedCursorIndex=J):le=ae;let de;le?de=new Selection$1(se.startLineNumber,se.startColumn,se.endLineNumber,se.endColumn):de=new Selection$1(se.endLineNumber,se.endColumn,se.startLineNumber,se.startColumn),D[Q].selection=de;const oe=CursorState.fromModelSelection(de);w[J].setState(this.context,oe.modelState,oe.viewState)}for(const se of D)se.index>X&&se.index--;w.splice(X,1),D.splice(Y,1),this._removeSecondaryCursor(X-1),O--}}}}class CursorContext{constructor(w,D,O,W){this._cursorContextBrand=void 0,this.model=w,this.viewModel=D,this.coordinatesConverter=O,this.cursorConfig=W}}class ViewCompositionStartEvent{constructor(){this.type=0}}class ViewCompositionEndEvent{constructor(){this.type=1}}class ViewConfigurationChangedEvent{constructor(w){this.type=2,this._source=w}hasChanged(w){return this._source.hasChanged(w)}}class ViewCursorStateChangedEvent{constructor(w,D,O){this.selections=w,this.modelSelections=D,this.reason=O,this.type=3}}class ViewDecorationsChangedEvent{constructor(w){this.type=4,w?(this.affectsMinimap=w.affectsMinimap,this.affectsOverviewRuler=w.affectsOverviewRuler,this.affectsGlyphMargin=w.affectsGlyphMargin,this.affectsLineNumber=w.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}}class ViewFlushedEvent{constructor(){this.type=5}}class ViewFocusChangedEvent{constructor(w){this.type=6,this.isFocused=w}}class ViewLanguageConfigurationEvent{constructor(){this.type=7}}class ViewLineMappingChangedEvent{constructor(){this.type=8}}class ViewLinesChangedEvent{constructor(w,D){this.fromLineNumber=w,this.count=D,this.type=9}}class ViewLinesDeletedEvent{constructor(w,D){this.type=10,this.fromLineNumber=w,this.toLineNumber=D}}class ViewLinesInsertedEvent{constructor(w,D){this.type=11,this.fromLineNumber=w,this.toLineNumber=D}}class ViewRevealRangeRequestEvent{constructor(w,D,O,W,U,K,q){this.source=w,this.minimalReveal=D,this.range=O,this.selections=W,this.verticalType=U,this.revealHorizontal=K,this.scrollType=q,this.type=12}}class ViewScrollChangedEvent{constructor(w){this.type=13,this.scrollWidth=w.scrollWidth,this.scrollLeft=w.scrollLeft,this.scrollHeight=w.scrollHeight,this.scrollTop=w.scrollTop,this.scrollWidthChanged=w.scrollWidthChanged,this.scrollLeftChanged=w.scrollLeftChanged,this.scrollHeightChanged=w.scrollHeightChanged,this.scrollTopChanged=w.scrollTopChanged}}class ViewThemeChangedEvent{constructor(w){this.theme=w,this.type=14}}class ViewTokensChangedEvent{constructor(w){this.type=15,this.ranges=w}}class ViewTokensColorsChangedEvent{constructor(){this.type=16}}let ViewZonesChangedEvent$1=class{constructor(){this.type=17}};class ViewModelEventDispatcher extends Disposable{constructor(){super(),this._onEvent=this._register(new Emitter$1),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(w){this._addOutgoingEvent(w),this._emitOutgoingEvents()}_addOutgoingEvent(w){for(let D=0,O=this._outgoingEvents.length;D<O;D++){const W=this._outgoingEvents[D].kind===w.kind?this._outgoingEvents[D].attemptToMerge(w):null;if(W){this._outgoingEvents[D]=W;return}}this._outgoingEvents.push(w)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const w=this._outgoingEvents.shift();w.isNoOp()||this._onEvent.fire(w)}}addViewEventHandler(w){for(let D=0,O=this._eventHandlers.length;D<O;D++)this._eventHandlers[D]===w&&console.warn("Detected duplicate listener in ViewEventDispatcher",w);this._eventHandlers.push(w)}removeViewEventHandler(w){for(let D=0;D<this._eventHandlers.length;D++)if(this._eventHandlers[D]===w){this._eventHandlers.splice(D,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new ViewModelEventsCollector),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){const w=this._collector.outgoingEvents,D=this._collector.viewEvents;this._collector=null;for(const O of w)this._addOutgoingEvent(O);D.length>0&&this._emitMany(D)}this._emitOutgoingEvents()}emitSingleViewEvent(w){try{this.beginEmitViewEvents().emitViewEvent(w)}finally{this.endEmitViewEvents()}}_emitMany(w){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(w):this._viewEventQueue=w,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const w=this._viewEventQueue;this._viewEventQueue=null;const D=this._eventHandlers.slice(0);for(const O of D)O.handleEvents(w)}}}class ViewModelEventsCollector{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(w){this.viewEvents.push(w)}emitOutgoingEvent(w){this.outgoingEvents.push(w)}}class ContentSizeChangedEvent{constructor(w,D,O,W){this.kind=0,this._oldContentWidth=w,this._oldContentHeight=D,this.contentWidth=O,this.contentHeight=W,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(w){return w.kind!==this.kind?null:new ContentSizeChangedEvent(this._oldContentWidth,this._oldContentHeight,w.contentWidth,w.contentHeight)}}class FocusChangedEvent{constructor(w,D){this.kind=1,this.oldHasFocus=w,this.hasFocus=D}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(w){return w.kind!==this.kind?null:new FocusChangedEvent(this.oldHasFocus,w.hasFocus)}}class ScrollChangedEvent{constructor(w,D,O,W,U,K,q,G){this.kind=2,this._oldScrollWidth=w,this._oldScrollLeft=D,this._oldScrollHeight=O,this._oldScrollTop=W,this.scrollWidth=U,this.scrollLeft=K,this.scrollHeight=q,this.scrollTop=G,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(w){return w.kind!==this.kind?null:new ScrollChangedEvent(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,w.scrollWidth,w.scrollLeft,w.scrollHeight,w.scrollTop)}}class ViewZonesChangedEvent{constructor(){this.kind=3}isNoOp(){return!1}attemptToMerge(w){return w.kind!==this.kind?null:this}}class HiddenAreasChangedEvent{constructor(){this.kind=4}isNoOp(){return!1}attemptToMerge(w){return w.kind!==this.kind?null:this}}class CursorStateChangedEvent{constructor(w,D,O,W,U,K,q){this.kind=6,this.oldSelections=w,this.selections=D,this.oldModelVersionId=O,this.modelVersionId=W,this.source=U,this.reason=K,this.reachedMaxCursorCount=q}static _selectionsAreEqual(w,D){if(!w&&!D)return!0;if(!w||!D)return!1;const O=w.length,W=D.length;if(O!==W)return!1;for(let U=0;U<O;U++)if(!w[U].equalsSelection(D[U]))return!1;return!0}isNoOp(){return CursorStateChangedEvent._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(w){return w.kind!==this.kind?null:new CursorStateChangedEvent(this.oldSelections,w.selections,this.oldModelVersionId,w.modelVersionId,w.source,w.reason,this.reachedMaxCursorCount||w.reachedMaxCursorCount)}}class ReadOnlyEditAttemptEvent{constructor(){this.kind=5}isNoOp(){return!1}attemptToMerge(w){return w.kind!==this.kind?null:this}}class ModelDecorationsChangedEvent{constructor(w){this.event=w,this.kind=7}isNoOp(){return!1}attemptToMerge(w){return null}}class ModelLanguageChangedEvent{constructor(w){this.event=w,this.kind=8}isNoOp(){return!1}attemptToMerge(w){return null}}class ModelLanguageConfigurationChangedEvent{constructor(w){this.event=w,this.kind=9}isNoOp(){return!1}attemptToMerge(w){return null}}class ModelContentChangedEvent{constructor(w){this.event=w,this.kind=10}isNoOp(){return!1}attemptToMerge(w){return null}}class ModelOptionsChangedEvent{constructor(w){this.event=w,this.kind=11}isNoOp(){return!1}attemptToMerge(w){return null}}class ModelTokensChangedEvent{constructor(w){this.event=w,this.kind=12}isNoOp(){return!1}attemptToMerge(w){return null}}class CursorsController extends Disposable{constructor(w,D,O,W){super(),this._model=w,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=D,this._coordinatesConverter=O,this.context=new CursorContext(this._model,this._viewModel,this._coordinatesConverter,W),this._cursors=new CursorCollection(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=dispose(this._autoClosedActions),super.dispose()}updateConfiguration(w){this.context=new CursorContext(this._model,this._viewModel,this._coordinatesConverter,w),this._cursors.updateContext(this.context)}onLineMappingChanged(w){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(w,"viewModel",0,this.getCursorStates())}setHasFocus(w){this._hasFocus=w}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const w=this._cursors.getSelections();for(let D=0;D<this._autoClosedActions.length;D++){const O=this._autoClosedActions[D];O.isValid(w)||(O.dispose(),this._autoClosedActions.splice(D,1),D--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(w,D,O,W){let U=!1;const K=this.context.cursorConfig.multiCursorLimit;W!==null&&W.length>K&&(W=W.slice(0,K),U=!0);const q=CursorModelState.from(this._model,this);return this._cursors.setStates(W),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(w,D,O,q,U)}setCursorColumnSelectData(w){this._columnSelectData=w}revealAll(w,D,O,W,U,K){const q=this._cursors.getViewPositions();let G=null,Q=null;q.length>1?Q=this._cursors.getViewSelections():G=Range$2.fromPositions(q[0],q[0]),w.emitViewEvent(new ViewRevealRangeRequestEvent(D,O,G,Q,W,U,K))}revealPrimary(w,D,O,W,U,K){const G=[this._cursors.getPrimaryCursor().viewState.selection];w.emitViewEvent(new ViewRevealRangeRequestEvent(D,O,null,G,W,U,K))}saveState(){const w=[],D=this._cursors.getSelections();for(let O=0,W=D.length;O<W;O++){const U=D[O];w.push({inSelectionMode:!U.isEmpty(),selectionStart:{lineNumber:U.selectionStartLineNumber,column:U.selectionStartColumn},position:{lineNumber:U.positionLineNumber,column:U.positionColumn}})}return w}restoreState(w,D){const O=[];for(let W=0,U=D.length;W<U;W++){const K=D[W];let q=1,G=1;K.position&&K.position.lineNumber&&(q=K.position.lineNumber),K.position&&K.position.column&&(G=K.position.column);let Q=q,Y=G;K.selectionStart&&K.selectionStart.lineNumber&&(Q=K.selectionStart.lineNumber),K.selectionStart&&K.selectionStart.column&&(Y=K.selectionStart.column),O.push({selectionStartLineNumber:Q,selectionStartColumn:Y,positionLineNumber:q,positionColumn:G})}this.setStates(w,"restoreState",0,CursorState.fromModelSelections(O)),this.revealAll(w,"restoreState",!1,0,!0,1)}onModelContentChanged(w,D){if(D instanceof ModelInjectedTextChangedEvent){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(w,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{const O=D.rawContentChangedEvent;if(this._knownModelVersionId=O.versionId,this._isHandling)return;const W=O.containsEvent(1);if(this._prevEditOperationType=0,W)this._cursors.dispose(),this._cursors=new CursorCollection(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(w,"model",1,null,!1);else if(this._hasFocus&&O.resultingSelection&&O.resultingSelection.length>0){const U=CursorState.fromModelSelections(O.resultingSelection);this.setStates(w,"modelChange",O.isUndoing?5:O.isRedoing?6:2,U)&&this.revealAll(w,"modelChange",!1,0,!0,0)}else{const U=this._cursors.readSelectionFromMarkers();this.setStates(w,"modelChange",2,CursorState.fromModelSelections(U))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const w=this._cursors.getPrimaryCursor(),D=w.viewState.selectionStart.getStartPosition(),O=w.viewState.position;return{isReal:!1,fromViewLineNumber:D.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,D),toViewLineNumber:O.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,O)}}getSelections(){return this._cursors.getSelections()}setSelections(w,D,O,W){this.setStates(w,D,W,CursorState.fromModelSelections(O))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(w){this._prevEditOperationType=w}_pushAutoClosedAction(w,D){const O=[],W=[];for(let q=0,G=w.length;q<G;q++)O.push({range:w[q],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),W.push({range:D[q],options:{description:"auto-closed-enclosing",stickiness:1}});const U=this._model.deltaDecorations([],O),K=this._model.deltaDecorations([],W);this._autoClosedActions.push(new AutoClosedAction(this._model,U,K))}_executeEditOperation(w){if(!w)return;w.shouldPushStackElementBefore&&this._model.pushStackElement();const D=CommandExecutor.executeCommands(this._model,this._cursors.getSelections(),w.commands);if(D){this._interpretCommandResult(D);const O=[],W=[];for(let U=0;U<w.commands.length;U++){const K=w.commands[U];K instanceof BaseTypeWithAutoClosingCommand&&K.enclosingRange&&K.closeCharacterRange&&(O.push(K.closeCharacterRange),W.push(K.enclosingRange))}O.length>0&&this._pushAutoClosedAction(O,W),this._prevEditOperationType=w.type}w.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(w){(!w||w.length===0)&&(w=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(w),this._cursors.normalize()}_emitStateChangedIfNecessary(w,D,O,W,U){const K=CursorModelState.from(this._model,this);if(K.equals(W))return!1;const q=this._cursors.getSelections(),G=this._cursors.getViewSelections();if(w.emitViewEvent(new ViewCursorStateChangedEvent(G,q,O)),!W||W.cursorState.length!==K.cursorState.length||K.cursorState.some((Q,Y)=>!Q.modelState.equals(W.cursorState[Y].modelState))){const Q=W?W.cursorState.map(X=>X.modelState.selection):null,Y=W?W.modelVersionId:0;w.emitOutgoingEvent(new CursorStateChangedEvent(Q,q,Y,K.modelVersionId,D||"keyboard",O,U))}return!0}_findAutoClosingPairs(w){if(!w.length)return null;const D=[];for(let O=0,W=w.length;O<W;O++){const U=w[O];if(!U.text||U.text.indexOf(`
`)>=0)return null;const K=U.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!K)return null;const q=K[1],G=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(q);if(!G||G.length!==1)return null;const Q=G[0].open,Y=U.text.length-K[2].length-1,X=U.text.lastIndexOf(Q,Y-1);if(X===-1)return null;D.push([X,Y])}return D}executeEdits(w,D,O,W){let U=null;D==="snippet"&&(U=this._findAutoClosingPairs(O)),U&&(O[0]._isTracked=!0);const K=[],q=[],G=this._model.pushEditOperations(this.getSelections(),O,Q=>{if(U)for(let X=0,J=U.length;X<J;X++){const[te,ie]=U[X],se=Q[X],re=se.range.startLineNumber,ae=se.range.startColumn-1+te,le=se.range.startColumn-1+ie;K.push(new Range$2(re,le+1,re,le+2)),q.push(new Range$2(re,ae+1,re,le+2))}const Y=W(Q);return Y&&(this._isHandling=!0),Y});G&&(this._isHandling=!1,this.setSelections(w,D,G,0)),K.length>0&&this._pushAutoClosedAction(K,q)}_executeEdit(w,D,O,W=0){if(this.context.cursorConfig.readOnly)return;const U=CursorModelState.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),w()}catch(K){onUnexpectedError(K)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(D,O,W,U,!1)&&this.revealAll(D,O,!1,0,!0,0)}getAutoClosedCharacters(){return AutoClosedAction.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(w){this._compositionState=new CompositionState(this._model,this.getSelections())}endComposition(w,D){const O=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{D==="keyboard"&&this._executeEditOperation(TypeOperations.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,O,this.getSelections(),this.getAutoClosedCharacters()))},w,D)}type(w,D,O){this._executeEdit(()=>{if(O==="keyboard"){const W=D.length;let U=0;for(;U<W;){const K=nextCharLength(D,U),q=D.substr(U,K);this._executeEditOperation(TypeOperations.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),q)),U+=K}}else this._executeEditOperation(TypeOperations.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),D))},w,O)}compositionType(w,D,O,W,U,K){if(D.length===0&&O===0&&W===0){if(U!==0){const q=this.getSelections().map(G=>{const Q=G.getPosition();return new Selection$1(Q.lineNumber,Q.column+U,Q.lineNumber,Q.column+U)});this.setSelections(w,K,q,0)}return}this._executeEdit(()=>{this._executeEditOperation(TypeOperations.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),D,O,W,U))},w,K)}paste(w,D,O,W,U){this._executeEdit(()=>{this._executeEditOperation(TypeOperations.paste(this.context.cursorConfig,this._model,this.getSelections(),D,O,W||[]))},w,U,4)}cut(w,D){this._executeEdit(()=>{this._executeEditOperation(DeleteOperations.cut(this.context.cursorConfig,this._model,this.getSelections()))},w,D)}executeCommand(w,D,O){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new EditOperationResult(0,[D],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},w,O)}executeCommands(w,D,O){this._executeEdit(()=>{this._executeEditOperation(new EditOperationResult(0,D,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},w,O)}}class CursorModelState{static from(w,D){return new CursorModelState(w.getVersionId(),D.getCursorStates())}constructor(w,D){this.modelVersionId=w,this.cursorState=D}equals(w){if(!w||this.modelVersionId!==w.modelVersionId||this.cursorState.length!==w.cursorState.length)return!1;for(let D=0,O=this.cursorState.length;D<O;D++)if(!this.cursorState[D].equals(w.cursorState[D]))return!1;return!0}}class AutoClosedAction{static getAllAutoClosedCharacters(w){let D=[];for(const O of w)D=D.concat(O.getAutoClosedCharactersRanges());return D}constructor(w,D,O){this._model=w,this._autoClosedCharactersDecorations=D,this._autoClosedEnclosingDecorations=O}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const w=[];for(let D=0;D<this._autoClosedCharactersDecorations.length;D++){const O=this._model.getDecorationRange(this._autoClosedCharactersDecorations[D]);O&&w.push(O)}return w}isValid(w){const D=[];for(let O=0;O<this._autoClosedEnclosingDecorations.length;O++){const W=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[O]);if(W&&(D.push(W),W.startLineNumber!==W.endLineNumber))return!1}D.sort(Range$2.compareRangesUsingStarts),w.sort(Range$2.compareRangesUsingStarts);for(let O=0;O<w.length;O++)if(O>=D.length||!D[O].strictContainsRange(w[O]))return!1;return!0}}class CommandExecutor{static executeCommands(w,D,O){const W={model:w,selectionsBefore:D,trackedRanges:[],trackedRangesDirection:[]},U=this._innerExecuteCommands(W,O);for(let K=0,q=W.trackedRanges.length;K<q;K++)W.model._setTrackedRange(W.trackedRanges[K],null,0);return U}static _innerExecuteCommands(w,D){if(this._arrayIsEmpty(D))return null;const O=this._getEditOperations(w,D);if(O.operations.length===0)return null;const W=O.operations,U=this._getLoserCursorMap(W);if(U.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;const K=[];for(let Q=0,Y=W.length;Q<Y;Q++)U.hasOwnProperty(W[Q].identifier.major.toString())||K.push(W[Q]);O.hadTrackedEditOperation&&K.length>0&&(K[0]._isTracked=!0);let q=w.model.pushEditOperations(w.selectionsBefore,K,Q=>{const Y=[];for(let te=0;te<w.selectionsBefore.length;te++)Y[te]=[];for(const te of Q)te.identifier&&Y[te.identifier.major].push(te);const X=(te,ie)=>te.identifier.minor-ie.identifier.minor,J=[];for(let te=0;te<w.selectionsBefore.length;te++)Y[te].length>0?(Y[te].sort(X),J[te]=D[te].computeCursorState(w.model,{getInverseEditOperations:()=>Y[te],getTrackedSelection:ie=>{const se=parseInt(ie,10),re=w.model._getTrackedRange(w.trackedRanges[se]);return w.trackedRangesDirection[se]===0?new Selection$1(re.startLineNumber,re.startColumn,re.endLineNumber,re.endColumn):new Selection$1(re.endLineNumber,re.endColumn,re.startLineNumber,re.startColumn)}})):J[te]=w.selectionsBefore[te];return J});q||(q=w.selectionsBefore);const G=[];for(const Q in U)U.hasOwnProperty(Q)&&G.push(parseInt(Q,10));G.sort((Q,Y)=>Y-Q);for(const Q of G)q.splice(Q,1);return q}static _arrayIsEmpty(w){for(let D=0,O=w.length;D<O;D++)if(w[D])return!1;return!0}static _getEditOperations(w,D){let O=[],W=!1;for(let U=0,K=D.length;U<K;U++){const q=D[U];if(q){const G=this._getEditOperationsFromCommand(w,U,q);O=O.concat(G.operations),W=W||G.hadTrackedEditOperation}}return{operations:O,hadTrackedEditOperation:W}}static _getEditOperationsFromCommand(w,D,O){const W=[];let U=0;const K=(X,J,te=!1)=>{Range$2.isEmpty(X)&&J===""||W.push({identifier:{major:D,minor:U++},range:X,text:J,forceMoveMarkers:te,isAutoWhitespaceEdit:O.insertsAutoWhitespace})};let q=!1;const Y={addEditOperation:K,addTrackedEditOperation:(X,J,te)=>{q=!0,K(X,J,te)},trackSelection:(X,J)=>{const te=Selection$1.liftSelection(X);let ie;if(te.isEmpty())if(typeof J=="boolean")J?ie=2:ie=3;else{const ae=w.model.getLineMaxColumn(te.startLineNumber);te.startColumn===ae?ie=2:ie=3}else ie=1;const se=w.trackedRanges.length,re=w.model._setTrackedRange(null,te,ie);return w.trackedRanges[se]=re,w.trackedRangesDirection[se]=te.getDirection(),se.toString()}};try{O.getEditOperations(w.model,Y)}catch(X){return onUnexpectedError(X),{operations:[],hadTrackedEditOperation:!1}}return{operations:W,hadTrackedEditOperation:q}}static _getLoserCursorMap(w){w=w.slice(0),w.sort((O,W)=>-Range$2.compareRangesUsingEnds(O.range,W.range));const D={};for(let O=1;O<w.length;O++){const W=w[O-1],U=w[O];if(Range$2.getStartPosition(W.range).isBefore(Range$2.getEndPosition(U.range))){let K;W.identifier.major>U.identifier.major?K=W.identifier.major:K=U.identifier.major,D[K.toString()]=!0;for(let q=0;q<w.length;q++)w[q].identifier.major===K&&(w.splice(q,1),q<O&&O--,q--);O>0&&O--}}return D}}class CompositionLineState{constructor(w,D,O){this.text=w,this.startSelection=D,this.endSelection=O}}class CompositionState{static _capture(w,D){const O=[];for(const W of D){if(W.startLineNumber!==W.endLineNumber)return null;O.push(new CompositionLineState(w.getLineContent(W.startLineNumber),W.startColumn-1,W.endColumn-1))}return O}constructor(w,D){this._original=CompositionState._capture(w,D)}deduceOutcome(w,D){if(!this._original)return null;const O=CompositionState._capture(w,D);if(!O||this._original.length!==O.length)return null;const W=[];for(let U=0,K=this._original.length;U<K;U++)W.push(CompositionState._deduceOutcome(this._original[U],O[U]));return W}static _deduceOutcome(w,D){const O=Math.min(w.startSelection,D.startSelection,commonPrefixLength(w.text,D.text)),W=Math.min(w.text.length-w.endSelection,D.text.length-D.endSelection,commonSuffixLength(w.text,D.text)),U=w.text.substring(O,w.text.length-W),K=D.text.substring(O,D.text.length-W);return new CompositionOutcome(U,w.startSelection-O,w.endSelection-O,K,D.startSelection-O,D.endSelection-O)}}const fallback={getInitialState:()=>NullState,tokenizeEncoded:(F,w,D)=>nullTokenizeEncoded(0,D)};async function tokenizeToString(F,w,D){if(!D)return _tokenizeToString(w,F.languageIdCodec,fallback);const O=await TokenizationRegistry.getOrCreate(D);return _tokenizeToString(w,F.languageIdCodec,O||fallback)}function tokenizeLineToHTML(F,w,D,O,W,U,K){let q="<div>",G=O,Q=0,Y=!0;for(let X=0,J=w.getCount();X<J;X++){const te=w.getEndOffset(X);if(te<=O)continue;let ie="";for(;G<te&&G<W;G++){const se=F.charCodeAt(G);switch(se){case 9:{let re=U-(G+Q)%U;for(Q+=re-1;re>0;)K&&Y?(ie+="&#160;",Y=!1):(ie+=" ",Y=!0),re--;break}case 60:ie+="&lt;",Y=!1;break;case 62:ie+="&gt;",Y=!1;break;case 38:ie+="&amp;",Y=!1;break;case 0:ie+="&#00;",Y=!1;break;case 65279:case 8232:case 8233:case 133:ie+="�",Y=!1;break;case 13:ie+="&#8203",Y=!1;break;case 32:K&&Y?(ie+="&#160;",Y=!1):(ie+=" ",Y=!0);break;default:ie+=String.fromCharCode(se),Y=!1}}if(q+=`<span style="${w.getInlineStyle(X,D)}">${ie}</span>`,te>W||G>=W)break}return q+="</div>",q}function _tokenizeToString(F,w,D){let O='<div class="monaco-tokenized-source">';const W=splitLines(F);let U=D.getInitialState();for(let K=0,q=W.length;K<q;K++){const G=W[K];K>0&&(O+="<br/>");const Q=D.tokenizeEncoded(G,!0,U);LineTokens.convertToEndOffset(Q.tokens,G.length);const X=new LineTokens(Q.tokens,G,w).inflate();let J=0;for(let te=0,ie=X.getCount();te<ie;te++){const se=X.getClassName(te),re=X.getEndOffset(te);O+=`<span class="${se}">${escape(G.substring(J,re))}</span>`,J=re}U=Q.endState}return O+="</div>",O}class PendingChanges{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(w){this._hasPending=!0,this._inserts.push(w)}change(w){this._hasPending=!0,this._changes.push(w)}remove(w){this._hasPending=!0,this._removes.push(w)}mustCommit(){return this._hasPending}commit(w){if(!this._hasPending)return;const D=this._inserts,O=this._changes,W=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],w._commitPendingChanges(D,O,W)}}class EditorWhitespace{constructor(w,D,O,W,U){this.id=w,this.afterLineNumber=D,this.ordinal=O,this.height=W,this.minWidth=U,this.prefixSum=0}}let LinesLayout$1=class Uo{static{this.INSTANCE_COUNT=0}constructor(w,D,O,W){this._instanceId=singleLetterHash(++Uo.INSTANCE_COUNT),this._pendingChanges=new PendingChanges,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=w,this._lineHeight=D,this._paddingTop=O,this._paddingBottom=W}static findInsertionIndex(w,D,O){let W=0,U=w.length;for(;W<U;){const K=W+U>>>1;D===w[K].afterLineNumber?O<w[K].ordinal?U=K:W=K+1:D<w[K].afterLineNumber?U=K:W=K+1}return W}setLineHeight(w){this._checkPendingChanges(),this._lineHeight=w}setPadding(w,D){this._paddingTop=w,this._paddingBottom=D}onFlushed(w){this._checkPendingChanges(),this._lineCount=w}changeWhitespace(w){let D=!1;try{w({insertWhitespace:(W,U,K,q)=>{D=!0,W=W|0,U=U|0,K=K|0,q=q|0;const G=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new EditorWhitespace(G,W,U,K,q)),G},changeOneWhitespace:(W,U,K)=>{D=!0,U=U|0,K=K|0,this._pendingChanges.change({id:W,newAfterLineNumber:U,newHeight:K})},removeWhitespace:W=>{D=!0,this._pendingChanges.remove({id:W})}})}finally{this._pendingChanges.commit(this)}return D}_commitPendingChanges(w,D,O){if((w.length>0||O.length>0)&&(this._minWidth=-1),w.length+D.length+O.length<=1){for(const G of w)this._insertWhitespace(G);for(const G of D)this._changeOneWhitespace(G.id,G.newAfterLineNumber,G.newHeight);for(const G of O){const Q=this._findWhitespaceIndex(G.id);Q!==-1&&this._removeWhitespace(Q)}return}const W=new Set;for(const G of O)W.add(G.id);const U=new Map;for(const G of D)U.set(G.id,G);const K=G=>{const Q=[];for(const Y of G)if(!W.has(Y.id)){if(U.has(Y.id)){const X=U.get(Y.id);Y.afterLineNumber=X.newAfterLineNumber,Y.height=X.newHeight}Q.push(Y)}return Q},q=K(this._arr).concat(K(w));q.sort((G,Q)=>G.afterLineNumber===Q.afterLineNumber?G.ordinal-Q.ordinal:G.afterLineNumber-Q.afterLineNumber),this._arr=q,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(w){const D=Uo.findInsertionIndex(this._arr,w.afterLineNumber,w.ordinal);this._arr.splice(D,0,w),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,D-1)}_findWhitespaceIndex(w){const D=this._arr;for(let O=0,W=D.length;O<W;O++)if(D[O].id===w)return O;return-1}_changeOneWhitespace(w,D,O){const W=this._findWhitespaceIndex(w);if(W!==-1&&(this._arr[W].height!==O&&(this._arr[W].height=O,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,W-1)),this._arr[W].afterLineNumber!==D)){const U=this._arr[W];this._removeWhitespace(W),U.afterLineNumber=D,this._insertWhitespace(U)}}_removeWhitespace(w){this._arr.splice(w,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,w-1)}onLinesDeleted(w,D){this._checkPendingChanges(),w=w|0,D=D|0,this._lineCount-=D-w+1;for(let O=0,W=this._arr.length;O<W;O++){const U=this._arr[O].afterLineNumber;w<=U&&U<=D?this._arr[O].afterLineNumber=w-1:U>D&&(this._arr[O].afterLineNumber-=D-w+1)}}onLinesInserted(w,D){this._checkPendingChanges(),w=w|0,D=D|0,this._lineCount+=D-w+1;for(let O=0,W=this._arr.length;O<W;O++){const U=this._arr[O].afterLineNumber;w<=U&&(this._arr[O].afterLineNumber+=D-w+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(w){this._checkPendingChanges(),w=w|0;let D=Math.max(0,this._prefixSumValidIndex+1);D===0&&(this._arr[0].prefixSum=this._arr[0].height,D++);for(let O=D;O<=w;O++)this._arr[O].prefixSum=this._arr[O-1].prefixSum+this._arr[O].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,w),this._arr[w].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();const w=this._lineHeight*this._lineCount,D=this.getWhitespacesTotalHeight();return w+D+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(w){this._checkPendingChanges(),w=w|0;const D=this._findLastWhitespaceBeforeLineNumber(w);return D===-1?0:this.getWhitespacesAccumulatedHeight(D)}_findLastWhitespaceBeforeLineNumber(w){w=w|0;const D=this._arr;let O=0,W=D.length-1;for(;O<=W;){const K=(W-O|0)/2|0,q=O+K|0;if(D[q].afterLineNumber<w){if(q+1>=D.length||D[q+1].afterLineNumber>=w)return q;O=q+1|0}else W=q-1|0}return-1}_findFirstWhitespaceAfterLineNumber(w){w=w|0;const O=this._findLastWhitespaceBeforeLineNumber(w)+1;return O<this._arr.length?O:-1}getFirstWhitespaceIndexAfterLineNumber(w){return this._checkPendingChanges(),w=w|0,this._findFirstWhitespaceAfterLineNumber(w)}getVerticalOffsetForLineNumber(w,D=!1){this._checkPendingChanges(),w=w|0;let O;w>1?O=this._lineHeight*(w-1):O=0;const W=this.getWhitespaceAccumulatedHeightBeforeLineNumber(w-(D?1:0));return O+W+this._paddingTop}getVerticalOffsetAfterLineNumber(w,D=!1){this._checkPendingChanges(),w=w|0;const O=this._lineHeight*w,W=this.getWhitespaceAccumulatedHeightBeforeLineNumber(w+(D?1:0));return O+W+this._paddingTop}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let w=0;for(let D=0,O=this._arr.length;D<O;D++)w=Math.max(w,this._arr[D].minWidth);this._minWidth=w}return this._minWidth}isAfterLines(w){this._checkPendingChanges();const D=this.getLinesTotalHeight();return w>D}isInTopPadding(w){return this._paddingTop===0?!1:(this._checkPendingChanges(),w<this._paddingTop)}isInBottomPadding(w){if(this._paddingBottom===0)return!1;this._checkPendingChanges();const D=this.getLinesTotalHeight();return w>=D-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(w){if(this._checkPendingChanges(),w=w|0,w<0)return 1;const D=this._lineCount|0,O=this._lineHeight;let W=1,U=D;for(;W<U;){const K=(W+U)/2|0,q=this.getVerticalOffsetForLineNumber(K)|0;if(w>=q+O)W=K+1;else{if(w>=q)return K;U=K}}return W>D?D:W}getLinesViewportData(w,D){this._checkPendingChanges(),w=w|0,D=D|0;const O=this._lineHeight,W=this.getLineNumberAtOrAfterVerticalOffset(w)|0,U=this.getVerticalOffsetForLineNumber(W)|0;let K=this._lineCount|0,q=this.getFirstWhitespaceIndexAfterLineNumber(W)|0;const G=this.getWhitespacesCount()|0;let Q,Y;q===-1?(q=G,Y=K+1,Q=0):(Y=this.getAfterLineNumberForWhitespaceIndex(q)|0,Q=this.getHeightForWhitespaceIndex(q)|0);let X=U,J=X;const te=5e5;let ie=0;U>=te&&(ie=Math.floor(U/te)*te,ie=Math.floor(ie/O)*O,J-=ie);const se=[],re=w+(D-w)/2;let ae=-1;for(let ue=W;ue<=K;ue++){if(ae===-1){const pe=X,fe=X+O;(pe<=re&&re<fe||pe>re)&&(ae=ue)}for(X+=O,se[ue-W]=J,J+=O;Y===ue;)J+=Q,X+=Q,q++,q>=G?Y=K+1:(Y=this.getAfterLineNumberForWhitespaceIndex(q)|0,Q=this.getHeightForWhitespaceIndex(q)|0);if(X>=D){K=ue;break}}ae===-1&&(ae=K);const le=this.getVerticalOffsetForLineNumber(K)|0;let de=W,oe=K;return de<oe&&U<w&&de++,de<oe&&le+O>D&&oe--,{bigNumbersDelta:ie,startLineNumber:W,endLineNumber:K,relativeVerticalOffset:se,centeredLineNumber:ae,completelyVisibleStartLineNumber:de,completelyVisibleEndLineNumber:oe,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(w){this._checkPendingChanges(),w=w|0;const D=this.getAfterLineNumberForWhitespaceIndex(w);let O;D>=1?O=this._lineHeight*D:O=0;let W;return w>0?W=this.getWhitespacesAccumulatedHeight(w-1):W=0,O+W+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(w){this._checkPendingChanges(),w=w|0;let D=0,O=this.getWhitespacesCount()-1;if(O<0)return-1;const W=this.getVerticalOffsetForWhitespaceIndex(O),U=this.getHeightForWhitespaceIndex(O);if(w>=W+U)return-1;for(;D<O;){const K=Math.floor((D+O)/2),q=this.getVerticalOffsetForWhitespaceIndex(K),G=this.getHeightForWhitespaceIndex(K);if(w>=q+G)D=K+1;else{if(w>=q)return K;O=K}}return D}getWhitespaceAtVerticalOffset(w){this._checkPendingChanges(),w=w|0;const D=this.getWhitespaceIndexAtOrAfterVerticallOffset(w);if(D<0||D>=this.getWhitespacesCount())return null;const O=this.getVerticalOffsetForWhitespaceIndex(D);if(O>w)return null;const W=this.getHeightForWhitespaceIndex(D),U=this.getIdForWhitespaceIndex(D),K=this.getAfterLineNumberForWhitespaceIndex(D);return{id:U,afterLineNumber:K,verticalOffset:O,height:W}}getWhitespaceViewportData(w,D){this._checkPendingChanges(),w=w|0,D=D|0;const O=this.getWhitespaceIndexAtOrAfterVerticallOffset(w),W=this.getWhitespacesCount()-1;if(O<0)return[];const U=[];for(let K=O;K<=W;K++){const q=this.getVerticalOffsetForWhitespaceIndex(K),G=this.getHeightForWhitespaceIndex(K);if(q>=D)break;U.push({id:this.getIdForWhitespaceIndex(K),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(K),verticalOffset:q,height:G})}return U}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(w){return this._checkPendingChanges(),w=w|0,this._arr[w].id}getAfterLineNumberForWhitespaceIndex(w){return this._checkPendingChanges(),w=w|0,this._arr[w].afterLineNumber}getHeightForWhitespaceIndex(w){return this._checkPendingChanges(),w=w|0,this._arr[w].height}};const SMOOTH_SCROLLING_TIME=125;class EditorScrollDimensions{constructor(w,D,O,W){w=w|0,D=D|0,O=O|0,W=W|0,w<0&&(w=0),D<0&&(D=0),O<0&&(O=0),W<0&&(W=0),this.width=w,this.contentWidth=D,this.scrollWidth=Math.max(w,D),this.height=O,this.contentHeight=W,this.scrollHeight=Math.max(O,W)}equals(w){return this.width===w.width&&this.contentWidth===w.contentWidth&&this.height===w.height&&this.contentHeight===w.contentHeight}}class EditorScrollable extends Disposable{constructor(w,D){super(),this._onDidContentSizeChange=this._register(new Emitter$1),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new EditorScrollDimensions(0,0,0,0),this._scrollable=this._register(new Scrollable({forceIntegerValues:!0,smoothScrollDuration:w,scheduleAtNextAnimationFrame:D})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(w){this._scrollable.setSmoothScrollDuration(w)}validateScrollPosition(w){return this._scrollable.validateScrollPosition(w)}getScrollDimensions(){return this._dimensions}setScrollDimensions(w){if(this._dimensions.equals(w))return;const D=this._dimensions;this._dimensions=w,this._scrollable.setScrollDimensions({width:w.width,scrollWidth:w.scrollWidth,height:w.height,scrollHeight:w.scrollHeight},!0);const O=D.contentWidth!==w.contentWidth,W=D.contentHeight!==w.contentHeight;(O||W)&&this._onDidContentSizeChange.fire(new ContentSizeChangedEvent(D.contentWidth,D.contentHeight,w.contentWidth,w.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(w){this._scrollable.setScrollPositionNow(w)}setScrollPositionSmooth(w){this._scrollable.setScrollPositionSmooth(w)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}}class ViewLayout extends Disposable{constructor(w,D,O){super(),this._configuration=w;const W=this._configuration.options,U=W.get(146),K=W.get(84);this._linesLayout=new LinesLayout$1(D,W.get(67),K.top,K.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new EditorScrollable(0,O)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new EditorScrollDimensions(U.contentWidth,0,U.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(115)?SMOOTH_SCROLLING_TIME:0)}onConfigurationChanged(w){const D=this._configuration.options;if(w.hasChanged(67)&&this._linesLayout.setLineHeight(D.get(67)),w.hasChanged(84)){const O=D.get(84);this._linesLayout.setPadding(O.top,O.bottom)}if(w.hasChanged(146)){const O=D.get(146),W=O.contentWidth,U=O.height,K=this._scrollable.getScrollDimensions(),q=K.contentWidth;this._scrollable.setScrollDimensions(new EditorScrollDimensions(W,K.contentWidth,U,this._getContentHeight(W,U,q)))}else this._updateHeight();w.hasChanged(115)&&this._configureSmoothScrollDuration()}onFlushed(w){this._linesLayout.onFlushed(w)}onLinesDeleted(w,D){this._linesLayout.onLinesDeleted(w,D)}onLinesInserted(w,D){this._linesLayout.onLinesInserted(w,D)}_getHorizontalScrollbarHeight(w,D){const W=this._configuration.options.get(104);return W.horizontal===2||w>=D?0:W.horizontalScrollbarSize}_getContentHeight(w,D,O){const W=this._configuration.options;let U=this._linesLayout.getLinesTotalHeight();return W.get(106)?U+=Math.max(0,D-W.get(67)-W.get(84).bottom):W.get(104).ignoreHorizontalScrollbarInContentHeight||(U+=this._getHorizontalScrollbarHeight(w,O)),U}_updateHeight(){const w=this._scrollable.getScrollDimensions(),D=w.width,O=w.height,W=w.contentWidth;this._scrollable.setScrollDimensions(new EditorScrollDimensions(D,w.contentWidth,O,this._getContentHeight(D,O,W)))}getCurrentViewport(){const w=this._scrollable.getScrollDimensions(),D=this._scrollable.getCurrentScrollPosition();return new Viewport(D.scrollTop,D.scrollLeft,w.width,w.height)}getFutureViewport(){const w=this._scrollable.getScrollDimensions(),D=this._scrollable.getFutureScrollPosition();return new Viewport(D.scrollTop,D.scrollLeft,w.width,w.height)}_computeContentWidth(){const w=this._configuration.options,D=this._maxLineWidth,O=w.get(147),W=w.get(50),U=w.get(146);if(O.isViewportWrapping){const K=w.get(73);return D>U.contentWidth+W.typicalHalfwidthCharacterWidth&&K.enabled&&K.side==="right"?D+U.verticalScrollbarWidth:D}else{const K=w.get(105)*W.typicalHalfwidthCharacterWidth,q=this._linesLayout.getWhitespaceMinWidth();return Math.max(D+K+U.verticalScrollbarWidth,q,this._overlayWidgetsMinWidth)}}setMaxLineWidth(w){this._maxLineWidth=w,this._updateContentWidth()}setOverlayWidgetsMinWidth(w){this._overlayWidgetsMinWidth=w,this._updateContentWidth()}_updateContentWidth(){const w=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new EditorScrollDimensions(w.width,this._computeContentWidth(),w.height,w.contentHeight)),this._updateHeight()}saveState(){const w=this._scrollable.getFutureScrollPosition(),D=w.scrollTop,O=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(D),W=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(O);return{scrollTop:D,scrollTopWithoutViewZones:D-W,scrollLeft:w.scrollLeft}}changeWhitespace(w){const D=this._linesLayout.changeWhitespace(w);return D&&this.onHeightMaybeChanged(),D}getVerticalOffsetForLineNumber(w,D=!1){return this._linesLayout.getVerticalOffsetForLineNumber(w,D)}getVerticalOffsetAfterLineNumber(w,D=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(w,D)}isAfterLines(w){return this._linesLayout.isAfterLines(w)}isInTopPadding(w){return this._linesLayout.isInTopPadding(w)}isInBottomPadding(w){return this._linesLayout.isInBottomPadding(w)}getLineNumberAtVerticalOffset(w){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(w)}getWhitespaceAtVerticalOffset(w){return this._linesLayout.getWhitespaceAtVerticalOffset(w)}getLinesViewportData(){const w=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(w.top,w.top+w.height)}getLinesViewportDataAtScrollTop(w){const D=this._scrollable.getScrollDimensions();return w+D.height>D.scrollHeight&&(w=D.scrollHeight-D.height),w<0&&(w=0),this._linesLayout.getLinesViewportData(w,w+D.height)}getWhitespaceViewportData(){const w=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(w.top,w.top+w.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(w){return this._scrollable.validateScrollPosition(w)}setScrollPosition(w,D){D===1?this._scrollable.setScrollPositionNow(w):this._scrollable.setScrollPositionSmooth(w)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(w,D){const O=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:O.scrollLeft+w,scrollTop:O.scrollTop+D})}}class ViewModelDecorations{constructor(w,D,O,W,U){this.editorId=w,this.model=D,this.configuration=O,this._linesCollection=W,this._coordinatesConverter=U,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(w){const D=w.id;let O=this._decorationsCache[D];if(!O){const W=w.range,U=w.options;let K;if(U.isWholeLine){const q=this._coordinatesConverter.convertModelPositionToViewPosition(new Position$1(W.startLineNumber,1),0,!1,!0),G=this._coordinatesConverter.convertModelPositionToViewPosition(new Position$1(W.endLineNumber,this.model.getLineMaxColumn(W.endLineNumber)),1);K=new Range$2(q.lineNumber,q.column,G.lineNumber,G.column)}else K=this._coordinatesConverter.convertModelRangeToViewRange(W,1);O=new ViewModelDecoration(K,U),this._decorationsCache[D]=O}return O}getMinimapDecorationsInRange(w){return this._getDecorationsInRange(w,!0,!1).decorations}getDecorationsViewportData(w){let D=this._cachedModelDecorationsResolver!==null;return D=D&&w.equalsRange(this._cachedModelDecorationsResolverViewRange),D||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(w,!1,!1),this._cachedModelDecorationsResolverViewRange=w),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(w,D=!1,O=!1){const W=new Range$2(w,this._linesCollection.getViewLineMinColumn(w),w,this._linesCollection.getViewLineMaxColumn(w));return this._getDecorationsInRange(W,D,O).inlineDecorations[0]}_getDecorationsInRange(w,D,O){const W=this._linesCollection.getDecorationsInRange(w,this.editorId,filterValidationDecorations(this.configuration.options),D,O),U=w.startLineNumber,K=w.endLineNumber,q=[];let G=0;const Q=[];for(let Y=U;Y<=K;Y++)Q[Y-U]=[];for(let Y=0,X=W.length;Y<X;Y++){const J=W[Y],te=J.options;if(!isModelDecorationVisible(this.model,J))continue;const ie=this._getOrCreateViewModelDecoration(J),se=ie.range;if(q[G++]=ie,te.inlineClassName){const re=new InlineDecoration(se,te.inlineClassName,te.inlineClassNameAffectsLetterSpacing?3:0),ae=Math.max(U,se.startLineNumber),le=Math.min(K,se.endLineNumber);for(let de=ae;de<=le;de++)Q[de-U].push(re)}if(te.beforeContentClassName&&U<=se.startLineNumber&&se.startLineNumber<=K){const re=new InlineDecoration(new Range$2(se.startLineNumber,se.startColumn,se.startLineNumber,se.startColumn),te.beforeContentClassName,1);Q[se.startLineNumber-U].push(re)}if(te.afterContentClassName&&U<=se.endLineNumber&&se.endLineNumber<=K){const re=new InlineDecoration(new Range$2(se.endLineNumber,se.endColumn,se.endLineNumber,se.endColumn),te.afterContentClassName,2);Q[se.endLineNumber-U].push(re)}}return{decorations:q,inlineDecorations:Q}}}function isModelDecorationVisible(F,w){return!(w.options.hideInCommentTokens&&isModelDecorationInComment(F,w)||w.options.hideInStringTokens&&isModelDecorationInString(F,w))}function isModelDecorationInComment(F,w){return testTokensInRange(F,w.range,D=>D===1)}function isModelDecorationInString(F,w){return testTokensInRange(F,w.range,D=>D===2)}function testTokensInRange(F,w,D){for(let O=w.startLineNumber;O<=w.endLineNumber;O++){const W=F.tokenization.getLineTokens(O),U=O===w.startLineNumber,K=O===w.endLineNumber;let q=U?W.findTokenIndexAtOffset(w.startColumn-1):0;for(;q<W.getCount()&&!(K&&W.getStartOffset(q)>w.endColumn-1);){if(!D(W.getStandardTokenType(q)))return!1;q++}}return!0}function createModelLineProjection(F,w){return F===null?w?IdentityModelLineProjection.INSTANCE:HiddenModelLineProjection.INSTANCE:new ModelLineProjection(F,w)}class ModelLineProjection{constructor(w,D){this._projectionData=w,this._isVisible=D}isVisible(){return this._isVisible}setVisible(w){return this._isVisible=w,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(w,D,O){this._assertVisible();const W=O>0?this._projectionData.breakOffsets[O-1]:0,U=this._projectionData.breakOffsets[O];let K;if(this._projectionData.injectionOffsets!==null){const q=this._projectionData.injectionOffsets.map((Q,Y)=>new LineInjectedText(0,0,Q+1,this._projectionData.injectionOptions[Y],0));K=LineInjectedText.applyInjectedText(w.getLineContent(D),q).substring(W,U)}else K=w.getValueInRange({startLineNumber:D,startColumn:W+1,endLineNumber:D,endColumn:U+1});return O>0&&(K=spaces(this._projectionData.wrappedTextIndentLength)+K),K}getViewLineLength(w,D,O){return this._assertVisible(),this._projectionData.getLineLength(O)}getViewLineMinColumn(w,D,O){return this._assertVisible(),this._projectionData.getMinOutputOffset(O)+1}getViewLineMaxColumn(w,D,O){return this._assertVisible(),this._projectionData.getMaxOutputOffset(O)+1}getViewLineData(w,D,O){const W=new Array;return this.getViewLinesData(w,D,O,1,0,[!0],W),W[0]}getViewLinesData(w,D,O,W,U,K,q){this._assertVisible();const G=this._projectionData,Q=G.injectionOffsets,Y=G.injectionOptions;let X=null;if(Q){X=[];let te=0,ie=0;for(let se=0;se<G.getOutputLineCount();se++){const re=new Array;X[se]=re;const ae=se>0?G.breakOffsets[se-1]:0,le=G.breakOffsets[se];for(;ie<Q.length;){const de=Y[ie].content.length,oe=Q[ie]+te,ue=oe+de;if(oe>le)break;if(ae<ue){const pe=Y[ie];if(pe.inlineClassName){const fe=se>0?G.wrappedTextIndentLength:0,Ce=fe+Math.max(oe-ae,0),we=fe+Math.min(ue-ae,le-ae);Ce!==we&&re.push(new SingleLineInlineDecoration(Ce,we,pe.inlineClassName,pe.inlineClassNameAffectsLetterSpacing))}}if(ue<=le)te+=de,ie++;else break}}}let J;Q?J=w.tokenization.getLineTokens(D).withInserted(Q.map((te,ie)=>({offset:te,text:Y[ie].content,tokenMetadata:LineTokens.defaultTokenMetadata}))):J=w.tokenization.getLineTokens(D);for(let te=O;te<O+W;te++){const ie=U+te-O;if(!K[ie]){q[ie]=null;continue}q[ie]=this._getViewLineData(J,X?X[te]:null,te)}}_getViewLineData(w,D,O){this._assertVisible();const W=this._projectionData,U=O>0?W.wrappedTextIndentLength:0,K=O>0?W.breakOffsets[O-1]:0,q=W.breakOffsets[O],G=w.sliceAndInflate(K,q,U);let Q=G.getLineContent();O>0&&(Q=spaces(W.wrappedTextIndentLength)+Q);const Y=this._projectionData.getMinOutputOffset(O)+1,X=Q.length+1,J=O+1<this.getViewLineCount(),te=O===0?0:W.breakOffsetsVisibleColumn[O-1];return new ViewLineData(Q,J,Y,X,te,G,D)}getModelColumnOfViewPosition(w,D){return this._assertVisible(),this._projectionData.translateToInputOffset(w,D-1)+1}getViewPositionOfModelPosition(w,D,O=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(D-1,O).toPosition(w)}getViewLineNumberOfModelPosition(w,D){this._assertVisible();const O=this._projectionData.translateToOutputPosition(D-1);return w+O.outputLineIndex}normalizePosition(w,D,O){const W=D.lineNumber-w;return this._projectionData.normalizeOutputPosition(w,D.column-1,O).toPosition(W)}getInjectedTextAt(w,D){return this._projectionData.getInjectedText(w,D-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}class IdentityModelLineProjection{static{this.INSTANCE=new IdentityModelLineProjection}constructor(){}isVisible(){return!0}setVisible(w){return w?this:HiddenModelLineProjection.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(w,D,O){return w.getLineContent(D)}getViewLineLength(w,D,O){return w.getLineLength(D)}getViewLineMinColumn(w,D,O){return w.getLineMinColumn(D)}getViewLineMaxColumn(w,D,O){return w.getLineMaxColumn(D)}getViewLineData(w,D,O){const W=w.tokenization.getLineTokens(D),U=W.getLineContent();return new ViewLineData(U,!1,1,U.length+1,0,W.inflate(),null)}getViewLinesData(w,D,O,W,U,K,q){if(!K[U]){q[U]=null;return}q[U]=this.getViewLineData(w,D,0)}getModelColumnOfViewPosition(w,D){return D}getViewPositionOfModelPosition(w,D){return new Position$1(w,D)}getViewLineNumberOfModelPosition(w,D){return w}normalizePosition(w,D,O){return D}getInjectedTextAt(w,D){return null}}class HiddenModelLineProjection{static{this.INSTANCE=new HiddenModelLineProjection}constructor(){}isVisible(){return!1}setVisible(w){return w?IdentityModelLineProjection.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(w,D,O){throw new Error("Not supported")}getViewLineLength(w,D,O){throw new Error("Not supported")}getViewLineMinColumn(w,D,O){throw new Error("Not supported")}getViewLineMaxColumn(w,D,O){throw new Error("Not supported")}getViewLineData(w,D,O){throw new Error("Not supported")}getViewLinesData(w,D,O,W,U,K,q){throw new Error("Not supported")}getModelColumnOfViewPosition(w,D){throw new Error("Not supported")}getViewPositionOfModelPosition(w,D){throw new Error("Not supported")}getViewLineNumberOfModelPosition(w,D){throw new Error("Not supported")}normalizePosition(w,D,O){throw new Error("Not supported")}getInjectedTextAt(w,D){throw new Error("Not supported")}}const _spaces=[""];function spaces(F){if(F>=_spaces.length)for(let w=1;w<=F;w++)_spaces[w]=_makeSpaces(w);return _spaces[F]}function _makeSpaces(F){return new Array(F+1).join(" ")}class PrefixSumComputer{constructor(w){this.values=w,this.prefixSum=new Uint32Array(w.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(w,D){w=toUint32(w);const O=this.values,W=this.prefixSum,U=D.length;return U===0?!1:(this.values=new Uint32Array(O.length+U),this.values.set(O.subarray(0,w),0),this.values.set(O.subarray(w),w+U),this.values.set(D,w),w-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=w-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(W.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(w,D){return w=toUint32(w),D=toUint32(D),this.values[w]===D?!1:(this.values[w]=D,w-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=w-1),!0)}removeValues(w,D){w=toUint32(w),D=toUint32(D);const O=this.values,W=this.prefixSum;if(w>=O.length)return!1;const U=O.length-w;return D>=U&&(D=U),D===0?!1:(this.values=new Uint32Array(O.length-D),this.values.set(O.subarray(0,w),0),this.values.set(O.subarray(w+D),w),this.prefixSum=new Uint32Array(this.values.length),w-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=w-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(W.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(w){return w<0?0:(w=toUint32(w),this._getPrefixSum(w))}_getPrefixSum(w){if(w<=this.prefixSumValidIndex[0])return this.prefixSum[w];let D=this.prefixSumValidIndex[0]+1;D===0&&(this.prefixSum[0]=this.values[0],D++),w>=this.values.length&&(w=this.values.length-1);for(let O=D;O<=w;O++)this.prefixSum[O]=this.prefixSum[O-1]+this.values[O];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],w),this.prefixSum[w]}getIndexOf(w){w=Math.floor(w),this.getTotalSum();let D=0,O=this.values.length-1,W=0,U=0,K=0;for(;D<=O;)if(W=D+(O-D)/2|0,U=this.prefixSum[W],K=U-this.values[W],w<K)O=W-1;else if(w>=U)D=W+1;else break;return new PrefixSumIndexOfResult(W,w-K)}}class ConstantTimePrefixSumComputer{constructor(w){this._values=w,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(w){return this._ensureValid(),w===0?0:this._prefixSum[w-1]}getIndexOf(w){this._ensureValid();const D=this._indexBySum[w],O=D>0?this._prefixSum[D-1]:0;return new PrefixSumIndexOfResult(D,w-O)}removeValues(w,D){this._values.splice(w,D),this._invalidate(w)}insertValues(w,D){this._values=arrayInsert(this._values,w,D),this._invalidate(w)}_invalidate(w){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,w-1)}_ensureValid(){if(!this._isValid){for(let w=this._validEndIndex+1,D=this._values.length;w<D;w++){const O=this._values[w],W=w>0?this._prefixSum[w-1]:0;this._prefixSum[w]=W+O;for(let U=0;U<O;U++)this._indexBySum[W+U]=w}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(w,D){this._values[w]!==D&&(this._values[w]=D,this._invalidate(w))}}class PrefixSumIndexOfResult{constructor(w,D){this.index=w,this.remainder=D,this._prefixSumIndexOfResultBrand=void 0,this.index=w,this.remainder=D}}class ViewModelLinesFromProjectedModel{constructor(w,D,O,W,U,K,q,G,Q,Y){this._editorId=w,this.model=D,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=O,this._monospaceLineBreaksComputerFactory=W,this.fontInfo=U,this.tabSize=K,this.wrappingStrategy=q,this.wrappingColumn=G,this.wrappingIndent=Q,this.wordBreak=Y,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new CoordinatesConverter(this)}_constructLines(w,D){this.modelLineProjections=[],w&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const O=this.model.getLinesContent(),W=this.model.getInjectedTextDecorations(this._editorId),U=O.length,K=this.createLineBreaksComputer(),q=new ArrayQueue(LineInjectedText.fromDecorations(W));for(let se=0;se<U;se++){const re=q.takeWhile(ae=>ae.lineNumber===se+1);K.addRequest(O[se],re,D?D[se]:null)}const G=K.finalize(),Q=[],Y=this.hiddenAreasDecorationIds.map(se=>this.model.getDecorationRange(se)).sort(Range$2.compareRangesUsingStarts);let X=1,J=0,te=-1,ie=te+1<Y.length?J+1:U+2;for(let se=0;se<U;se++){const re=se+1;re===ie&&(te++,X=Y[te].startLineNumber,J=Y[te].endLineNumber,ie=te+1<Y.length?J+1:U+2);const ae=re>=X&&re<=J,le=createModelLineProjection(G[se],!ae);Q[se]=le.getViewLineCount(),this.modelLineProjections[se]=le}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new ConstantTimePrefixSumComputer(Q)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(w=>this.model.getDecorationRange(w))}setHiddenAreas(w){const D=w.map(J=>this.model.validateRange(J)),O=normalizeLineRanges(D),W=this.hiddenAreasDecorationIds.map(J=>this.model.getDecorationRange(J)).sort(Range$2.compareRangesUsingStarts);if(O.length===W.length){let J=!1;for(let te=0;te<O.length;te++)if(!O[te].equalsRange(W[te])){J=!0;break}if(!J)return!1}const U=O.map(J=>({range:J,options:ModelDecorationOptions.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,U);const K=O;let q=1,G=0,Q=-1,Y=Q+1<K.length?G+1:this.modelLineProjections.length+2,X=!1;for(let J=0;J<this.modelLineProjections.length;J++){const te=J+1;te===Y&&(Q++,q=K[Q].startLineNumber,G=K[Q].endLineNumber,Y=Q+1<K.length?G+1:this.modelLineProjections.length+2);let ie=!1;if(te>=q&&te<=G?this.modelLineProjections[J].isVisible()&&(this.modelLineProjections[J]=this.modelLineProjections[J].setVisible(!1),ie=!0):(X=!0,this.modelLineProjections[J].isVisible()||(this.modelLineProjections[J]=this.modelLineProjections[J].setVisible(!0),ie=!0)),ie){const se=this.modelLineProjections[J].getViewLineCount();this.projectedModelLineLineCounts.setValue(J,se)}}return X||this.setHiddenAreas([]),!0}modelPositionIsVisible(w,D){return w<1||w>this.modelLineProjections.length?!1:this.modelLineProjections[w-1].isVisible()}getModelLineViewLineCount(w){return w<1||w>this.modelLineProjections.length?1:this.modelLineProjections[w-1].getViewLineCount()}setTabSize(w){return this.tabSize===w?!1:(this.tabSize=w,this._constructLines(!1,null),!0)}setWrappingSettings(w,D,O,W,U){const K=this.fontInfo.equals(w),q=this.wrappingStrategy===D,G=this.wrappingColumn===O,Q=this.wrappingIndent===W,Y=this.wordBreak===U;if(K&&q&&G&&Q&&Y)return!1;const X=K&&q&&!G&&Q&&Y;this.fontInfo=w,this.wrappingStrategy=D,this.wrappingColumn=O,this.wrappingIndent=W,this.wordBreak=U;let J=null;if(X){J=[];for(let te=0,ie=this.modelLineProjections.length;te<ie;te++)J[te]=this.modelLineProjections[te].getProjectionData()}return this._constructLines(!1,J),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(w,D,O){if(!w||w<=this._validModelVersionId)return null;const W=D===1?1:this.projectedModelLineLineCounts.getPrefixSum(D-1)+1,U=this.projectedModelLineLineCounts.getPrefixSum(O);return this.modelLineProjections.splice(D-1,O-D+1),this.projectedModelLineLineCounts.removeValues(D-1,O-D+1),new ViewLinesDeletedEvent(W,U)}onModelLinesInserted(w,D,O,W){if(!w||w<=this._validModelVersionId)return null;const U=D>2&&!this.modelLineProjections[D-2].isVisible(),K=D===1?1:this.projectedModelLineLineCounts.getPrefixSum(D-1)+1;let q=0;const G=[],Q=[];for(let Y=0,X=W.length;Y<X;Y++){const J=createModelLineProjection(W[Y],!U);G.push(J);const te=J.getViewLineCount();q+=te,Q[Y]=te}return this.modelLineProjections=this.modelLineProjections.slice(0,D-1).concat(G).concat(this.modelLineProjections.slice(D-1)),this.projectedModelLineLineCounts.insertValues(D-1,Q),new ViewLinesInsertedEvent(K,K+q-1)}onModelLineChanged(w,D,O){if(w!==null&&w<=this._validModelVersionId)return[!1,null,null,null];const W=D-1,U=this.modelLineProjections[W].getViewLineCount(),K=this.modelLineProjections[W].isVisible(),q=createModelLineProjection(O,K);this.modelLineProjections[W]=q;const G=this.modelLineProjections[W].getViewLineCount();let Q=!1,Y=0,X=-1,J=0,te=-1,ie=0,se=-1;U>G?(Y=this.projectedModelLineLineCounts.getPrefixSum(D-1)+1,X=Y+G-1,ie=X+1,se=ie+(U-G)-1,Q=!0):U<G?(Y=this.projectedModelLineLineCounts.getPrefixSum(D-1)+1,X=Y+U-1,J=X+1,te=J+(G-U)-1,Q=!0):(Y=this.projectedModelLineLineCounts.getPrefixSum(D-1)+1,X=Y+G-1),this.projectedModelLineLineCounts.setValue(W,G);const re=Y<=X?new ViewLinesChangedEvent(Y,X-Y+1):null,ae=J<=te?new ViewLinesInsertedEvent(J,te):null,le=ie<=se?new ViewLinesDeletedEvent(ie,se):null;return[Q,re,ae,le]}acceptVersionId(w){this._validModelVersionId=w,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(w){if(w<1)return 1;const D=this.getViewLineCount();return w>D?D:w|0}getActiveIndentGuide(w,D,O){w=this._toValidViewLineNumber(w),D=this._toValidViewLineNumber(D),O=this._toValidViewLineNumber(O);const W=this.convertViewPositionToModelPosition(w,this.getViewLineMinColumn(w)),U=this.convertViewPositionToModelPosition(D,this.getViewLineMinColumn(D)),K=this.convertViewPositionToModelPosition(O,this.getViewLineMinColumn(O)),q=this.model.guides.getActiveIndentGuide(W.lineNumber,U.lineNumber,K.lineNumber),G=this.convertModelPositionToViewPosition(q.startLineNumber,1),Q=this.convertModelPositionToViewPosition(q.endLineNumber,this.model.getLineMaxColumn(q.endLineNumber));return{startLineNumber:G.lineNumber,endLineNumber:Q.lineNumber,indent:q.indent}}getViewLineInfo(w){w=this._toValidViewLineNumber(w);const D=this.projectedModelLineLineCounts.getIndexOf(w-1),O=D.index,W=D.remainder;return new ViewLineInfo(O+1,W)}getMinColumnOfViewLine(w){return this.modelLineProjections[w.modelLineNumber-1].getViewLineMinColumn(this.model,w.modelLineNumber,w.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(w){return this.modelLineProjections[w.modelLineNumber-1].getViewLineMaxColumn(this.model,w.modelLineNumber,w.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(w){const D=this.modelLineProjections[w.modelLineNumber-1],O=D.getViewLineMinColumn(this.model,w.modelLineNumber,w.modelLineWrappedLineIdx),W=D.getModelColumnOfViewPosition(w.modelLineWrappedLineIdx,O);return new Position$1(w.modelLineNumber,W)}getModelEndPositionOfViewLine(w){const D=this.modelLineProjections[w.modelLineNumber-1],O=D.getViewLineMaxColumn(this.model,w.modelLineNumber,w.modelLineWrappedLineIdx),W=D.getModelColumnOfViewPosition(w.modelLineWrappedLineIdx,O);return new Position$1(w.modelLineNumber,W)}getViewLineInfosGroupedByModelRanges(w,D){const O=this.getViewLineInfo(w),W=this.getViewLineInfo(D),U=new Array;let K=this.getModelStartPositionOfViewLine(O),q=new Array;for(let G=O.modelLineNumber;G<=W.modelLineNumber;G++){const Q=this.modelLineProjections[G-1];if(Q.isVisible()){const Y=G===O.modelLineNumber?O.modelLineWrappedLineIdx:0,X=G===W.modelLineNumber?W.modelLineWrappedLineIdx+1:Q.getViewLineCount();for(let J=Y;J<X;J++)q.push(new ViewLineInfo(G,J))}if(!Q.isVisible()&&K){const Y=new Position$1(G-1,this.model.getLineMaxColumn(G-1)+1),X=Range$2.fromPositions(K,Y);U.push(new ViewLineInfoGroupedByModelRange(X,q)),q=[],K=null}else Q.isVisible()&&!K&&(K=new Position$1(G,1))}if(K){const G=Range$2.fromPositions(K,this.getModelEndPositionOfViewLine(W));U.push(new ViewLineInfoGroupedByModelRange(G,q))}return U}getViewLinesBracketGuides(w,D,O,W){const U=O?this.convertViewPositionToModelPosition(O.lineNumber,O.column):null,K=[];for(const q of this.getViewLineInfosGroupedByModelRanges(w,D)){const G=q.modelRange.startLineNumber,Q=this.model.guides.getLinesBracketGuides(G,q.modelRange.endLineNumber,U,W);for(const Y of q.viewLines){const J=Q[Y.modelLineNumber-G].map(te=>{if(te.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[Y.modelLineNumber-1].getViewPositionOfModelPosition(0,te.forWrappedLinesAfterColumn).lineNumber>=Y.modelLineWrappedLineIdx||te.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[Y.modelLineNumber-1].getViewPositionOfModelPosition(0,te.forWrappedLinesBeforeOrAtColumn).lineNumber<Y.modelLineWrappedLineIdx)return;if(!te.horizontalLine)return te;let ie=-1;if(te.column!==-1){const ae=this.modelLineProjections[Y.modelLineNumber-1].getViewPositionOfModelPosition(0,te.column);if(ae.lineNumber===Y.modelLineWrappedLineIdx)ie=ae.column;else if(ae.lineNumber<Y.modelLineWrappedLineIdx)ie=this.getMinColumnOfViewLine(Y);else if(ae.lineNumber>Y.modelLineWrappedLineIdx)return}const se=this.convertModelPositionToViewPosition(Y.modelLineNumber,te.horizontalLine.endColumn),re=this.modelLineProjections[Y.modelLineNumber-1].getViewPositionOfModelPosition(0,te.horizontalLine.endColumn);return re.lineNumber===Y.modelLineWrappedLineIdx?new IndentGuide(te.visibleColumn,ie,te.className,new IndentGuideHorizontalLine(te.horizontalLine.top,se.column),-1,-1):re.lineNumber<Y.modelLineWrappedLineIdx||te.visibleColumn!==-1?void 0:new IndentGuide(te.visibleColumn,ie,te.className,new IndentGuideHorizontalLine(te.horizontalLine.top,this.getMaxColumnOfViewLine(Y)),-1,-1)});K.push(J.filter(te=>!!te))}}return K}getViewLinesIndentGuides(w,D){w=this._toValidViewLineNumber(w),D=this._toValidViewLineNumber(D);const O=this.convertViewPositionToModelPosition(w,this.getViewLineMinColumn(w)),W=this.convertViewPositionToModelPosition(D,this.getViewLineMaxColumn(D));let U=[];const K=[],q=[],G=O.lineNumber-1,Q=W.lineNumber-1;let Y=null;for(let ie=G;ie<=Q;ie++){const se=this.modelLineProjections[ie];if(se.isVisible()){const re=se.getViewLineNumberOfModelPosition(0,ie===G?O.column:1),ae=se.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(ie+1)),le=ae-re+1;let de=0;le>1&&se.getViewLineMinColumn(this.model,ie+1,ae)===1&&(de=re===0?1:2),K.push(le),q.push(de),Y===null&&(Y=new Position$1(ie+1,0))}else Y!==null&&(U=U.concat(this.model.guides.getLinesIndentGuides(Y.lineNumber,ie)),Y=null)}Y!==null&&(U=U.concat(this.model.guides.getLinesIndentGuides(Y.lineNumber,W.lineNumber)),Y=null);const X=D-w+1,J=new Array(X);let te=0;for(let ie=0,se=U.length;ie<se;ie++){let re=U[ie];const ae=Math.min(X-te,K[ie]),le=q[ie];let de;le===2?de=0:le===1?de=1:de=ae;for(let oe=0;oe<ae;oe++)oe===de&&(re=0),J[te++]=re}return J}getViewLineContent(w){const D=this.getViewLineInfo(w);return this.modelLineProjections[D.modelLineNumber-1].getViewLineContent(this.model,D.modelLineNumber,D.modelLineWrappedLineIdx)}getViewLineLength(w){const D=this.getViewLineInfo(w);return this.modelLineProjections[D.modelLineNumber-1].getViewLineLength(this.model,D.modelLineNumber,D.modelLineWrappedLineIdx)}getViewLineMinColumn(w){const D=this.getViewLineInfo(w);return this.modelLineProjections[D.modelLineNumber-1].getViewLineMinColumn(this.model,D.modelLineNumber,D.modelLineWrappedLineIdx)}getViewLineMaxColumn(w){const D=this.getViewLineInfo(w);return this.modelLineProjections[D.modelLineNumber-1].getViewLineMaxColumn(this.model,D.modelLineNumber,D.modelLineWrappedLineIdx)}getViewLineData(w){const D=this.getViewLineInfo(w);return this.modelLineProjections[D.modelLineNumber-1].getViewLineData(this.model,D.modelLineNumber,D.modelLineWrappedLineIdx)}getViewLinesData(w,D,O){w=this._toValidViewLineNumber(w),D=this._toValidViewLineNumber(D);const W=this.projectedModelLineLineCounts.getIndexOf(w-1);let U=w;const K=W.index,q=W.remainder,G=[];for(let Q=K,Y=this.model.getLineCount();Q<Y;Q++){const X=this.modelLineProjections[Q];if(!X.isVisible())continue;const J=Q===K?q:0;let te=X.getViewLineCount()-J,ie=!1;if(U+te>D&&(ie=!0,te=D-U+1),X.getViewLinesData(this.model,Q+1,J,te,U-w,O,G),U+=te,ie)break}return G}validateViewPosition(w,D,O){w=this._toValidViewLineNumber(w);const W=this.projectedModelLineLineCounts.getIndexOf(w-1),U=W.index,K=W.remainder,q=this.modelLineProjections[U],G=q.getViewLineMinColumn(this.model,U+1,K),Q=q.getViewLineMaxColumn(this.model,U+1,K);D<G&&(D=G),D>Q&&(D=Q);const Y=q.getModelColumnOfViewPosition(K,D);return this.model.validatePosition(new Position$1(U+1,Y)).equals(O)?new Position$1(w,D):this.convertModelPositionToViewPosition(O.lineNumber,O.column)}validateViewRange(w,D){const O=this.validateViewPosition(w.startLineNumber,w.startColumn,D.getStartPosition()),W=this.validateViewPosition(w.endLineNumber,w.endColumn,D.getEndPosition());return new Range$2(O.lineNumber,O.column,W.lineNumber,W.column)}convertViewPositionToModelPosition(w,D){const O=this.getViewLineInfo(w),W=this.modelLineProjections[O.modelLineNumber-1].getModelColumnOfViewPosition(O.modelLineWrappedLineIdx,D);return this.model.validatePosition(new Position$1(O.modelLineNumber,W))}convertViewRangeToModelRange(w){const D=this.convertViewPositionToModelPosition(w.startLineNumber,w.startColumn),O=this.convertViewPositionToModelPosition(w.endLineNumber,w.endColumn);return new Range$2(D.lineNumber,D.column,O.lineNumber,O.column)}convertModelPositionToViewPosition(w,D,O=2,W=!1,U=!1){const K=this.model.validatePosition(new Position$1(w,D)),q=K.lineNumber,G=K.column;let Q=q-1,Y=!1;if(U)for(;Q<this.modelLineProjections.length&&!this.modelLineProjections[Q].isVisible();)Q++,Y=!0;else for(;Q>0&&!this.modelLineProjections[Q].isVisible();)Q--,Y=!0;if(Q===0&&!this.modelLineProjections[Q].isVisible())return new Position$1(W?0:1,1);const X=1+this.projectedModelLineLineCounts.getPrefixSum(Q);let J;return Y?U?J=this.modelLineProjections[Q].getViewPositionOfModelPosition(X,1,O):J=this.modelLineProjections[Q].getViewPositionOfModelPosition(X,this.model.getLineMaxColumn(Q+1),O):J=this.modelLineProjections[q-1].getViewPositionOfModelPosition(X,G,O),J}convertModelRangeToViewRange(w,D=0){if(w.isEmpty()){const O=this.convertModelPositionToViewPosition(w.startLineNumber,w.startColumn,D);return Range$2.fromPositions(O)}else{const O=this.convertModelPositionToViewPosition(w.startLineNumber,w.startColumn,1),W=this.convertModelPositionToViewPosition(w.endLineNumber,w.endColumn,0);return new Range$2(O.lineNumber,O.column,W.lineNumber,W.column)}}getViewLineNumberOfModelPosition(w,D){let O=w-1;if(this.modelLineProjections[O].isVisible()){const U=1+this.projectedModelLineLineCounts.getPrefixSum(O);return this.modelLineProjections[O].getViewLineNumberOfModelPosition(U,D)}for(;O>0&&!this.modelLineProjections[O].isVisible();)O--;if(O===0&&!this.modelLineProjections[O].isVisible())return 1;const W=1+this.projectedModelLineLineCounts.getPrefixSum(O);return this.modelLineProjections[O].getViewLineNumberOfModelPosition(W,this.model.getLineMaxColumn(O+1))}getDecorationsInRange(w,D,O,W,U){const K=this.convertViewPositionToModelPosition(w.startLineNumber,w.startColumn),q=this.convertViewPositionToModelPosition(w.endLineNumber,w.endColumn);if(q.lineNumber-K.lineNumber<=w.endLineNumber-w.startLineNumber)return this.model.getDecorationsInRange(new Range$2(K.lineNumber,1,q.lineNumber,q.column),D,O,W,U);let G=[];const Q=K.lineNumber-1,Y=q.lineNumber-1;let X=null;for(let se=Q;se<=Y;se++)if(this.modelLineProjections[se].isVisible())X===null&&(X=new Position$1(se+1,se===Q?K.column:1));else if(X!==null){const ae=this.model.getLineMaxColumn(se);G=G.concat(this.model.getDecorationsInRange(new Range$2(X.lineNumber,X.column,se,ae),D,O,W)),X=null}X!==null&&(G=G.concat(this.model.getDecorationsInRange(new Range$2(X.lineNumber,X.column,q.lineNumber,q.column),D,O,W)),X=null),G.sort((se,re)=>{const ae=Range$2.compareRangesUsingStarts(se.range,re.range);return ae===0?se.id<re.id?-1:se.id>re.id?1:0:ae});const J=[];let te=0,ie=null;for(const se of G){const re=se.id;ie!==re&&(ie=re,J[te++]=se)}return J}getInjectedTextAt(w){const D=this.getViewLineInfo(w.lineNumber);return this.modelLineProjections[D.modelLineNumber-1].getInjectedTextAt(D.modelLineWrappedLineIdx,w.column)}normalizePosition(w,D){const O=this.getViewLineInfo(w.lineNumber);return this.modelLineProjections[O.modelLineNumber-1].normalizePosition(O.modelLineWrappedLineIdx,w,D)}getLineIndentColumn(w){const D=this.getViewLineInfo(w);return D.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(D.modelLineNumber):0}}function normalizeLineRanges(F){if(F.length===0)return[];const w=F.slice();w.sort(Range$2.compareRangesUsingStarts);const D=[];let O=w[0].startLineNumber,W=w[0].endLineNumber;for(let U=1,K=w.length;U<K;U++){const q=w[U];q.startLineNumber>W+1?(D.push(new Range$2(O,1,W,1)),O=q.startLineNumber,W=q.endLineNumber):q.endLineNumber>W&&(W=q.endLineNumber)}return D.push(new Range$2(O,1,W,1)),D}class ViewLineInfo{constructor(w,D){this.modelLineNumber=w,this.modelLineWrappedLineIdx=D}}class ViewLineInfoGroupedByModelRange{constructor(w,D){this.modelRange=w,this.viewLines=D}}class CoordinatesConverter{constructor(w){this._lines=w}convertViewPositionToModelPosition(w){return this._lines.convertViewPositionToModelPosition(w.lineNumber,w.column)}convertViewRangeToModelRange(w){return this._lines.convertViewRangeToModelRange(w)}validateViewPosition(w,D){return this._lines.validateViewPosition(w.lineNumber,w.column,D)}validateViewRange(w,D){return this._lines.validateViewRange(w,D)}convertModelPositionToViewPosition(w,D,O,W){return this._lines.convertModelPositionToViewPosition(w.lineNumber,w.column,D,O,W)}convertModelRangeToViewRange(w,D){return this._lines.convertModelRangeToViewRange(w,D)}modelPositionIsVisible(w){return this._lines.modelPositionIsVisible(w.lineNumber,w.column)}getModelLineViewLineCount(w){return this._lines.getModelLineViewLineCount(w)}getViewLineNumberOfModelPosition(w,D){return this._lines.getViewLineNumberOfModelPosition(w,D)}}class ViewModelLinesFromModelAsIs{constructor(w){this.model=w}dispose(){}createCoordinatesConverter(){return new IdentityCoordinatesConverter(this)}getHiddenAreas(){return[]}setHiddenAreas(w){return!1}setTabSize(w){return!1}setWrappingSettings(w,D,O,W){return!1}createLineBreaksComputer(){const w=[];return{addRequest:(D,O,W)=>{w.push(null)},finalize:()=>w}}onModelFlushed(){}onModelLinesDeleted(w,D,O){return new ViewLinesDeletedEvent(D,O)}onModelLinesInserted(w,D,O,W){return new ViewLinesInsertedEvent(D,O)}onModelLineChanged(w,D,O){return[!1,new ViewLinesChangedEvent(D,1),null,null]}acceptVersionId(w){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(w,D,O){return{startLineNumber:w,endLineNumber:w,indent:0}}getViewLinesBracketGuides(w,D,O){return new Array(D-w+1).fill([])}getViewLinesIndentGuides(w,D){const O=D-w+1,W=new Array(O);for(let U=0;U<O;U++)W[U]=0;return W}getViewLineContent(w){return this.model.getLineContent(w)}getViewLineLength(w){return this.model.getLineLength(w)}getViewLineMinColumn(w){return this.model.getLineMinColumn(w)}getViewLineMaxColumn(w){return this.model.getLineMaxColumn(w)}getViewLineData(w){const D=this.model.tokenization.getLineTokens(w),O=D.getLineContent();return new ViewLineData(O,!1,1,O.length+1,0,D.inflate(),null)}getViewLinesData(w,D,O){const W=this.model.getLineCount();w=Math.min(Math.max(1,w),W),D=Math.min(Math.max(1,D),W);const U=[];for(let K=w;K<=D;K++){const q=K-w;U[q]=O[q]?this.getViewLineData(K):null}return U}getDecorationsInRange(w,D,O,W,U){return this.model.getDecorationsInRange(w,D,O,W,U)}normalizePosition(w,D){return this.model.normalizePosition(w,D)}getLineIndentColumn(w){return this.model.getLineIndentColumn(w)}getInjectedTextAt(w){return null}}class IdentityCoordinatesConverter{constructor(w){this._lines=w}_validPosition(w){return this._lines.model.validatePosition(w)}_validRange(w){return this._lines.model.validateRange(w)}convertViewPositionToModelPosition(w){return this._validPosition(w)}convertViewRangeToModelRange(w){return this._validRange(w)}validateViewPosition(w,D){return this._validPosition(D)}validateViewRange(w,D){return this._validRange(D)}convertModelPositionToViewPosition(w){return this._validPosition(w)}convertModelRangeToViewRange(w){return this._validRange(w)}modelPositionIsVisible(w){const D=this._lines.model.getLineCount();return!(w.lineNumber<1||w.lineNumber>D)}getModelLineViewLineCount(w){return 1}getViewLineNumberOfModelPosition(w,D){return w}}const MAX_LANE=GlyphMarginLane$1.Right;class GlyphMarginLanesModel{constructor(w){this.persist=0,this._requiredLanes=1,this.lanes=new Uint8Array(Math.ceil((w+1)*MAX_LANE/8))}reset(w){const D=Math.ceil((w+1)*MAX_LANE/8);this.lanes.length<D?this.lanes=new Uint8Array(D):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(w,D,O){O&&(this.persist|=1<<w-1);for(let W=D.startLineNumber;W<=D.endLineNumber;W++){const U=MAX_LANE*W+(w-1);this.lanes[U>>>3]|=1<<U%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(W))}}getLanesAtLine(w){const D=[];let O=MAX_LANE*w;for(let W=0;W<MAX_LANE;W++)(this.persist&1<<W||this.lanes[O>>>3]&1<<O%8)&&D.push(W+1),O++;return D.length?D:[GlyphMarginLane$1.Center]}countAtLine(w){let D=MAX_LANE*w,O=0;for(let W=0;W<MAX_LANE;W++)(this.persist&1<<W||this.lanes[D>>>3]&1<<D%8)&&O++,D++;return O}}let ViewModel$1=class extends Disposable{constructor(w,D,O,W,U,K,q,G,Q,Y){if(super(),this.languageConfigurationService=q,this._themeService=G,this._attachedView=Q,this._transactionalTarget=Y,this.hiddenAreasModel=new HiddenAreasModel,this.previousHiddenAreas=[],this._editorId=w,this._configuration=D,this.model=O,this._eventDispatcher=new ViewModelEventDispatcher,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new RunOnceScheduler(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=ViewportStart.create(this.model),this.glyphLanes=new GlyphMarginLanesModel(0),this.model.isTooLargeForTokenization())this._lines=new ViewModelLinesFromModelAsIs(this.model);else{const X=this._configuration.options,J=X.get(50),te=X.get(140),ie=X.get(147),se=X.get(139),re=X.get(130);this._lines=new ViewModelLinesFromProjectedModel(this._editorId,this.model,W,U,J,this.model.getOptions().tabSize,te,ie.wrappingColumn,se,re)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new CursorsController(O,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new ViewLayout(this._configuration,this.getLineCount(),K)),this._register(this.viewLayout.onDidScroll(X=>{X.scrollTopChanged&&this._handleVisibleLinesChanged(),X.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new ViewScrollChangedEvent(X)),this._eventDispatcher.emitOutgoingEvent(new ScrollChangedEvent(X.oldScrollWidth,X.oldScrollLeft,X.oldScrollHeight,X.oldScrollTop,X.scrollWidth,X.scrollLeft,X.scrollHeight,X.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(X=>{this._eventDispatcher.emitOutgoingEvent(X)})),this._decorations=new ViewModelDecorations(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(X=>{try{const J=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(J,X)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(MinimapTokensColorTracker.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new ViewTokensColorsChangedEvent)})),this._register(this._themeService.onDidColorThemeChange(X=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new ViewThemeChangedEvent(X))})),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(w){this._eventDispatcher.addViewEventHandler(w)}removeViewEventHandler(w){this._eventDispatcher.removeViewEventHandler(w)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){const w=this.viewLayout.getLinesViewportData(),D=new Range$2(w.startLineNumber,this.getLineMinColumn(w.startLineNumber),w.endLineNumber,this.getLineMaxColumn(w.endLineNumber));return this._toModelVisibleRanges(D)}visibleLinesStabilized(){const w=this.getModelVisibleRanges();this._attachedView.setVisibleLines(w,!0)}_handleVisibleLinesChanged(){const w=this.getModelVisibleRanges();this._attachedView.setVisibleLines(w,!1)}setHasFocus(w){this._hasFocus=w,this._cursor.setHasFocus(w),this._eventDispatcher.emitSingleViewEvent(new ViewFocusChangedEvent(w)),this._eventDispatcher.emitOutgoingEvent(new FocusChangedEvent(!w,w))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new ViewCompositionStartEvent)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new ViewCompositionEndEvent)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){const w=new Position$1(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),D=this.coordinatesConverter.convertViewPositionToModelPosition(w);return new StableViewport(D,this._viewportStart.startLineDelta)}return new StableViewport(null,0)}_onConfigurationChanged(w,D){const O=this._captureStableViewport(),W=this._configuration.options,U=W.get(50),K=W.get(140),q=W.get(147),G=W.get(139),Q=W.get(130);this._lines.setWrappingSettings(U,K,q.wrappingColumn,G,Q)&&(w.emitViewEvent(new ViewFlushedEvent),w.emitViewEvent(new ViewLineMappingChangedEvent),w.emitViewEvent(new ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(w),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),D.hasChanged(92)&&(this._decorations.reset(),w.emitViewEvent(new ViewDecorationsChangedEvent(null))),D.hasChanged(99)&&(this._decorations.reset(),w.emitViewEvent(new ViewDecorationsChangedEvent(null))),w.emitViewEvent(new ViewConfigurationChangedEvent(D)),this.viewLayout.onConfigurationChanged(D),O.recoverViewportStart(this.coordinatesConverter,this.viewLayout),CursorConfiguration.shouldRecreate(D)&&(this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(w=>{try{const O=this._eventDispatcher.beginEmitViewEvents();let W=!1,U=!1;const K=w instanceof InternalModelContentChangeEvent?w.rawContentChangedEvent.changes:w.changes,q=w instanceof InternalModelContentChangeEvent?w.rawContentChangedEvent.versionId:null,G=this._lines.createLineBreaksComputer();for(const X of K)switch(X.changeType){case 4:{for(let J=0;J<X.detail.length;J++){const te=X.detail[J];let ie=X.injectedTexts[J];ie&&(ie=ie.filter(se=>!se.ownerId||se.ownerId===this._editorId)),G.addRequest(te,ie,null)}break}case 2:{let J=null;X.injectedText&&(J=X.injectedText.filter(te=>!te.ownerId||te.ownerId===this._editorId)),G.addRequest(X.detail,J,null);break}}const Q=G.finalize(),Y=new ArrayQueue(Q);for(const X of K)switch(X.changeType){case 1:{this._lines.onModelFlushed(),O.emitViewEvent(new ViewFlushedEvent),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),W=!0;break}case 3:{const J=this._lines.onModelLinesDeleted(q,X.fromLineNumber,X.toLineNumber);J!==null&&(O.emitViewEvent(J),this.viewLayout.onLinesDeleted(J.fromLineNumber,J.toLineNumber)),W=!0;break}case 4:{const J=Y.takeCount(X.detail.length),te=this._lines.onModelLinesInserted(q,X.fromLineNumber,X.toLineNumber,J);te!==null&&(O.emitViewEvent(te),this.viewLayout.onLinesInserted(te.fromLineNumber,te.toLineNumber)),W=!0;break}case 2:{const J=Y.dequeue(),[te,ie,se,re]=this._lines.onModelLineChanged(q,X.lineNumber,J);U=te,ie&&O.emitViewEvent(ie),se&&(O.emitViewEvent(se),this.viewLayout.onLinesInserted(se.fromLineNumber,se.toLineNumber)),re&&(O.emitViewEvent(re),this.viewLayout.onLinesDeleted(re.fromLineNumber,re.toLineNumber));break}case 5:break}q!==null&&this._lines.acceptVersionId(q),this.viewLayout.onHeightMaybeChanged(),!W&&U&&(O.emitViewEvent(new ViewLineMappingChangedEvent),O.emitViewEvent(new ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(O),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}const D=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&D){const O=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(O){const W=this.coordinatesConverter.convertModelPositionToViewPosition(O.getStartPosition()),U=this.viewLayout.getVerticalOffsetForLineNumber(W.lineNumber);this.viewLayout.setScrollPosition({scrollTop:U+this._viewportStart.startLineDelta},1)}}try{const O=this._eventDispatcher.beginEmitViewEvents();w instanceof InternalModelContentChangeEvent&&O.emitOutgoingEvent(new ModelContentChangedEvent(w.contentChangedEvent)),this._cursor.onModelContentChanged(O,w)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(w=>{const D=[];for(let O=0,W=w.ranges.length;O<W;O++){const U=w.ranges[O],K=this.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(U.fromLineNumber,1)).lineNumber,q=this.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(U.toLineNumber,this.model.getLineMaxColumn(U.toLineNumber))).lineNumber;D[O]={fromLineNumber:K,toLineNumber:q}}this._eventDispatcher.emitSingleViewEvent(new ViewTokensChangedEvent(D)),this._eventDispatcher.emitOutgoingEvent(new ModelTokensChangedEvent(w))})),this._register(this.model.onDidChangeLanguageConfiguration(w=>{this._eventDispatcher.emitSingleViewEvent(new ViewLanguageConfigurationEvent),this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new ModelLanguageConfigurationChangedEvent(w))})),this._register(this.model.onDidChangeLanguage(w=>{this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new ModelLanguageChangedEvent(w))})),this._register(this.model.onDidChangeOptions(w=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const D=this._eventDispatcher.beginEmitViewEvents();D.emitViewEvent(new ViewFlushedEvent),D.emitViewEvent(new ViewLineMappingChangedEvent),D.emitViewEvent(new ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(D),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new ModelOptionsChangedEvent(w))})),this._register(this.model.onDidChangeDecorations(w=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new ViewDecorationsChangedEvent(w)),this._eventDispatcher.emitOutgoingEvent(new ModelDecorationsChangedEvent(w))}))}setHiddenAreas(w,D){this.hiddenAreasModel.setHiddenAreas(D,w);const O=this.hiddenAreasModel.getMergedRanges();if(O===this.previousHiddenAreas)return;this.previousHiddenAreas=O;const W=this._captureStableViewport();let U=!1;try{const K=this._eventDispatcher.beginEmitViewEvents();U=this._lines.setHiddenAreas(O),U&&(K.emitViewEvent(new ViewFlushedEvent),K.emitViewEvent(new ViewLineMappingChangedEvent),K.emitViewEvent(new ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(K),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());const q=W.viewportStartModelPosition?.lineNumber;q&&O.some(Q=>Q.startLineNumber<=q&&q<=Q.endLineNumber)||W.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),U&&this._eventDispatcher.emitOutgoingEvent(new HiddenAreasChangedEvent)}getVisibleRangesPlusViewportAboveBelow(){const w=this._configuration.options.get(146),D=this._configuration.options.get(67),O=Math.max(20,Math.round(w.height/D)),W=this.viewLayout.getLinesViewportData(),U=Math.max(1,W.completelyVisibleStartLineNumber-O),K=Math.min(this.getLineCount(),W.completelyVisibleEndLineNumber+O);return this._toModelVisibleRanges(new Range$2(U,this.getLineMinColumn(U),K,this.getLineMaxColumn(K)))}getVisibleRanges(){const w=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(w)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(w){const D=this.coordinatesConverter.convertViewRangeToModelRange(w),O=this._lines.getHiddenAreas();if(O.length===0)return[D];const W=[];let U=0,K=D.startLineNumber,q=D.startColumn;const G=D.endLineNumber,Q=D.endColumn;for(let Y=0,X=O.length;Y<X;Y++){const J=O[Y].startLineNumber,te=O[Y].endLineNumber;te<K||J>G||(K<J&&(W[U++]=new Range$2(K,q,J-1,this.model.getLineMaxColumn(J-1))),K=te+1,q=1)}return(K<G||K===G&&q<Q)&&(W[U++]=new Range$2(K,q,G,Q)),W}getCompletelyVisibleViewRange(){const w=this.viewLayout.getLinesViewportData(),D=w.completelyVisibleStartLineNumber,O=w.completelyVisibleEndLineNumber;return new Range$2(D,this.getLineMinColumn(D),O,this.getLineMaxColumn(O))}getCompletelyVisibleViewRangeAtScrollTop(w){const D=this.viewLayout.getLinesViewportDataAtScrollTop(w),O=D.completelyVisibleStartLineNumber,W=D.completelyVisibleEndLineNumber;return new Range$2(O,this.getLineMinColumn(O),W,this.getLineMaxColumn(W))}saveState(){const w=this.viewLayout.saveState(),D=w.scrollTop,O=this.viewLayout.getLineNumberAtVerticalOffset(D),W=this.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(O,this.getLineMinColumn(O))),U=this.viewLayout.getVerticalOffsetForLineNumber(O)-D;return{scrollLeft:w.scrollLeft,firstPosition:W,firstPositionDeltaTop:U}}reduceRestoreState(w){if(typeof w.firstPosition>"u")return this._reduceRestoreStateCompatibility(w);const D=this.model.validatePosition(w.firstPosition),O=this.coordinatesConverter.convertModelPositionToViewPosition(D),W=this.viewLayout.getVerticalOffsetForLineNumber(O.lineNumber)-w.firstPositionDeltaTop;return{scrollLeft:w.scrollLeft,scrollTop:W}}_reduceRestoreStateCompatibility(w){return{scrollLeft:w.scrollLeft,scrollTop:w.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(w,D,O){this._viewportStart.update(this,w)}getActiveIndentGuide(w,D,O){return this._lines.getActiveIndentGuide(w,D,O)}getLinesIndentGuides(w,D){return this._lines.getViewLinesIndentGuides(w,D)}getBracketGuidesInRangeByLine(w,D,O,W){return this._lines.getViewLinesBracketGuides(w,D,O,W)}getLineContent(w){return this._lines.getViewLineContent(w)}getLineLength(w){return this._lines.getViewLineLength(w)}getLineMinColumn(w){return this._lines.getViewLineMinColumn(w)}getLineMaxColumn(w){return this._lines.getViewLineMaxColumn(w)}getLineFirstNonWhitespaceColumn(w){const D=firstNonWhitespaceIndex(this.getLineContent(w));return D===-1?0:D+1}getLineLastNonWhitespaceColumn(w){const D=lastNonWhitespaceIndex(this.getLineContent(w));return D===-1?0:D+2}getMinimapDecorationsInRange(w){return this._decorations.getMinimapDecorationsInRange(w)}getDecorationsInViewport(w){return this._decorations.getDecorationsViewportData(w).decorations}getInjectedTextAt(w){return this._lines.getInjectedTextAt(w)}getViewportViewLineRenderingData(w,D){const W=this._decorations.getDecorationsViewportData(w).inlineDecorations[D-w.startLineNumber];return this._getViewLineRenderingData(D,W)}getViewLineRenderingData(w){const D=this._decorations.getInlineDecorationsOnLine(w);return this._getViewLineRenderingData(w,D)}_getViewLineRenderingData(w,D){const O=this.model.mightContainRTL(),W=this.model.mightContainNonBasicASCII(),U=this.getTabSize(),K=this._lines.getViewLineData(w);return K.inlineDecorations&&(D=[...D,...K.inlineDecorations.map(q=>q.toInlineDecoration(w))]),new ViewLineRenderingData(K.minColumn,K.maxColumn,K.content,K.continuesWithWrappedLine,O,W,K.tokens,D,U,K.startVisibleColumn)}getViewLineData(w){return this._lines.getViewLineData(w)}getMinimapLinesRenderingData(w,D,O){const W=this._lines.getViewLinesData(w,D,O);return new MinimapLinesRenderingData(this.getTabSize(),W)}getAllOverviewRulerDecorations(w){const D=this.model.getOverviewRulerDecorations(this._editorId,filterValidationDecorations(this._configuration.options)),O=new OverviewRulerDecorations;for(const W of D){const U=W.options,K=U.overviewRuler;if(!K)continue;const q=K.position;if(q===0)continue;const G=K.getColor(w.value),Q=this.coordinatesConverter.getViewLineNumberOfModelPosition(W.range.startLineNumber,W.range.startColumn),Y=this.coordinatesConverter.getViewLineNumberOfModelPosition(W.range.endLineNumber,W.range.endColumn);O.accept(G,U.zIndex,Q,Y,q)}return O.asArray}_invalidateDecorationsColorCache(){const w=this.model.getOverviewRulerDecorations();for(const D of w)D.options.overviewRuler?.invalidateCachedColor(),D.options.minimap?.invalidateCachedColor()}getValueInRange(w,D){const O=this.coordinatesConverter.convertViewRangeToModelRange(w);return this.model.getValueInRange(O,D)}getValueLengthInRange(w,D){const O=this.coordinatesConverter.convertViewRangeToModelRange(w);return this.model.getValueLengthInRange(O,D)}modifyPosition(w,D){const O=this.coordinatesConverter.convertViewPositionToModelPosition(w),W=this.model.modifyPosition(O,D);return this.coordinatesConverter.convertModelPositionToViewPosition(W)}deduceModelPositionRelativeToViewPosition(w,D,O){const W=this.coordinatesConverter.convertViewPositionToModelPosition(w);this.model.getEOL().length===2&&(D<0?D-=O:D+=O);const K=this.model.getOffsetAt(W)+D;return this.model.getPositionAt(K)}getPlainTextToCopy(w,D,O){const W=O?`\r
`:this.model.getEOL();w=w.slice(0),w.sort(Range$2.compareRangesUsingStarts);let U=!1,K=!1;for(const G of w)G.isEmpty()?U=!0:K=!0;if(!K){if(!D)return"";const G=w.map(Y=>Y.startLineNumber);let Q="";for(let Y=0;Y<G.length;Y++)Y>0&&G[Y-1]===G[Y]||(Q+=this.model.getLineContent(G[Y])+W);return Q}if(U&&D){const G=[];let Q=0;for(const Y of w){const X=Y.startLineNumber;Y.isEmpty()?X!==Q&&G.push(this.model.getLineContent(X)):G.push(this.model.getValueInRange(Y,O?2:0)),Q=X}return G.length===1?G[0]:G}const q=[];for(const G of w)G.isEmpty()||q.push(this.model.getValueInRange(G,O?2:0));return q.length===1?q[0]:q}getRichTextToCopy(w,D){const O=this.model.getLanguageId();if(O===PLAINTEXT_LANGUAGE_ID||w.length!==1)return null;let W=w[0];if(W.isEmpty()){if(!D)return null;const Y=W.startLineNumber;W=new Range$2(Y,this.model.getLineMinColumn(Y),Y,this.model.getLineMaxColumn(Y))}const U=this._configuration.options.get(50),K=this._getColorMap(),G=/[:;\\\/<>]/.test(U.fontFamily)||U.fontFamily===EDITOR_FONT_DEFAULTS.fontFamily;let Q;return G?Q=EDITOR_FONT_DEFAULTS.fontFamily:(Q=U.fontFamily,Q=Q.replace(/"/g,"'"),/[,']/.test(Q)||/[+ ]/.test(Q)&&(Q=`'${Q}'`),Q=`${Q}, ${EDITOR_FONT_DEFAULTS.fontFamily}`),{mode:O,html:`<div style="color: ${K[1]};background-color: ${K[2]};font-family: ${Q};font-weight: ${U.fontWeight};font-size: ${U.fontSize}px;line-height: ${U.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(W,K)+"</div>"}}_getHTMLToCopy(w,D){const O=w.startLineNumber,W=w.startColumn,U=w.endLineNumber,K=w.endColumn,q=this.getTabSize();let G="";for(let Q=O;Q<=U;Q++){const Y=this.model.tokenization.getLineTokens(Q),X=Y.getLineContent(),J=Q===O?W-1:0,te=Q===U?K-1:X.length;X===""?G+="<br>":G+=tokenizeLineToHTML(X,Y.inflate(),D,J,te,q,isWindows)}return G}_getColorMap(){const w=TokenizationRegistry.getColorMap(),D=["#000000"];if(w)for(let O=1,W=w.length;O<W;O++)D[O]=Color.Format.CSS.formatHex(w[O]);return D}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(w,D,O){return this._withViewEventsCollector(W=>this._cursor.setStates(W,w,D,O))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(w){this._cursor.setCursorColumnSelectData(w)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(w){this._cursor.setPrevEditOperationType(w)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(w,D,O=0){this._withViewEventsCollector(W=>this._cursor.setSelections(W,w,D,O))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(w){this._withViewEventsCollector(D=>this._cursor.restoreState(D,w))}_executeCursorEdit(w){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new ReadOnlyEditAttemptEvent);return}this._withViewEventsCollector(w)}executeEdits(w,D,O){this._executeCursorEdit(W=>this._cursor.executeEdits(W,w,D,O))}startComposition(){this._executeCursorEdit(w=>this._cursor.startComposition(w))}endComposition(w){this._executeCursorEdit(D=>this._cursor.endComposition(D,w))}type(w,D){this._executeCursorEdit(O=>this._cursor.type(O,w,D))}compositionType(w,D,O,W,U){this._executeCursorEdit(K=>this._cursor.compositionType(K,w,D,O,W,U))}paste(w,D,O,W){this._executeCursorEdit(U=>this._cursor.paste(U,w,D,O,W))}cut(w){this._executeCursorEdit(D=>this._cursor.cut(D,w))}executeCommand(w,D){this._executeCursorEdit(O=>this._cursor.executeCommand(O,w,D))}executeCommands(w,D){this._executeCursorEdit(O=>this._cursor.executeCommands(O,w,D))}revealAllCursors(w,D,O=!1){this._withViewEventsCollector(W=>this._cursor.revealAll(W,w,O,0,D,0))}revealPrimaryCursor(w,D,O=!1){this._withViewEventsCollector(W=>this._cursor.revealPrimary(W,w,O,0,D,0))}revealTopMostCursor(w){const D=this._cursor.getTopMostViewPosition(),O=new Range$2(D.lineNumber,D.column,D.lineNumber,D.column);this._withViewEventsCollector(W=>W.emitViewEvent(new ViewRevealRangeRequestEvent(w,!1,O,null,0,!0,0)))}revealBottomMostCursor(w){const D=this._cursor.getBottomMostViewPosition(),O=new Range$2(D.lineNumber,D.column,D.lineNumber,D.column);this._withViewEventsCollector(W=>W.emitViewEvent(new ViewRevealRangeRequestEvent(w,!1,O,null,0,!0,0)))}revealRange(w,D,O,W,U){this._withViewEventsCollector(K=>K.emitViewEvent(new ViewRevealRangeRequestEvent(w,!1,O,null,W,D,U)))}changeWhitespace(w){this.viewLayout.changeWhitespace(w)&&(this._eventDispatcher.emitSingleViewEvent(new ViewZonesChangedEvent$1),this._eventDispatcher.emitOutgoingEvent(new ViewZonesChangedEvent))}_withViewEventsCollector(w){return this._transactionalTarget.batchChanges(()=>{try{const D=this._eventDispatcher.beginEmitViewEvents();return w(D)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(w){this._withViewEventsCollector(()=>{w()})}normalizePosition(w,D){return this._lines.normalizePosition(w,D)}getLineIndentColumn(w){return this._lines.getLineIndentColumn(w)}};class ViewportStart{static create(w){const D=w._setTrackedRange(null,new Range$2(1,1,1,1),1);return new ViewportStart(w,1,!1,D,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}constructor(w,D,O,W,U){this._model=w,this._viewLineNumber=D,this._isValid=O,this._modelTrackedRange=W,this._startLineDelta=U}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(w,D){const O=w.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(D,w.getLineMinColumn(D))),W=w.model._setTrackedRange(this._modelTrackedRange,new Range$2(O.lineNumber,O.column,O.lineNumber,O.column),1),U=w.viewLayout.getVerticalOffsetForLineNumber(D),K=w.viewLayout.getCurrentScrollTop();this._viewLineNumber=D,this._isValid=!0,this._modelTrackedRange=W,this._startLineDelta=K-U}invalidate(){this._isValid=!1}}class OverviewRulerDecorations{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(w,D,O,W,U){const K=this._asMap[w];if(K){const q=K.data,G=q[q.length-3],Q=q[q.length-1];if(G===U&&Q+1>=O){W>Q&&(q[q.length-1]=W);return}q.push(U,O,W)}else{const q=new OverviewRulerDecorationsGroup(w,D,[U,O,W]);this._asMap[w]=q,this.asArray.push(q)}}}class HiddenAreasModel{constructor(){this.hiddenAreas=new Map,this.shouldRecompute=!1,this.ranges=[]}setHiddenAreas(w,D){const O=this.hiddenAreas.get(w);O&&rangeArraysEqual(O,D)||(this.hiddenAreas.set(w,D),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;const w=Array.from(this.hiddenAreas.values()).reduce((D,O)=>mergeLineRangeArray(D,O),[]);return rangeArraysEqual(this.ranges,w)?this.ranges:(this.ranges=w,this.ranges)}}function mergeLineRangeArray(F,w){const D=[];let O=0,W=0;for(;O<F.length&&W<w.length;){const U=F[O],K=w[W];if(U.endLineNumber<K.startLineNumber-1)D.push(F[O++]);else if(K.endLineNumber<U.startLineNumber-1)D.push(w[W++]);else{const q=Math.min(U.startLineNumber,K.startLineNumber),G=Math.max(U.endLineNumber,K.endLineNumber);D.push(new Range$2(q,1,G,1)),O++,W++}}for(;O<F.length;)D.push(F[O++]);for(;W<w.length;)D.push(w[W++]);return D}function rangeArraysEqual(F,w){if(F.length!==w.length)return!1;for(let D=0;D<F.length;D++)if(!F[D].equalsRange(w[D]))return!1;return!0}class StableViewport{constructor(w,D){this.viewportStartModelPosition=w,this.startLineDelta=D}recoverViewportStart(w,D){if(!this.viewportStartModelPosition)return;const O=w.convertModelPositionToViewPosition(this.viewportStartModelPosition),W=D.getVerticalOffsetForLineNumber(O.lineNumber);D.setScrollPosition({scrollTop:W+this.startLineDelta},1)}}class ServiceCollection{constructor(...w){this._entries=new Map;for(const[D,O]of w)this.set(D,O)}set(w,D){const O=this._entries.get(w);return this._entries.set(w,D),O}get(w){return this._entries.get(w)}}var Severity$1;(function(F){F[F.Ignore=0]="Ignore",F[F.Info=1]="Info",F[F.Warning=2]="Warning",F[F.Error=3]="Error"})(Severity$1||(Severity$1={}));(function(F){const w="error",D="warning",O="warn",W="info",U="ignore";function K(G){return G?equalsIgnoreCase(w,G)?F.Error:equalsIgnoreCase(D,G)||equalsIgnoreCase(O,G)?F.Warning:equalsIgnoreCase(W,G)?F.Info:F.Ignore:F.Ignore}F.fromValue=K;function q(G){switch(G){case F.Error:return w;case F.Warning:return D;case F.Info:return W;default:return U}}F.toString=q})(Severity$1||(Severity$1={}));const Severity$2=Severity$1;var Severity=Severity$2;const INotificationService=createDecorator("notificationService");class NoOpNotification{}var __decorate$T=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$Q=function(F,w){return function(D,O){w(D,O,F)}},CodeEditorWidget_1;let CodeEditorWidget=class extends Disposable{static{CodeEditorWidget_1=this}static{this.dropIntoEditorDecorationOptions=ModelDecorationOptions.register({description:"workbench-dnd-target",className:"dnd-target"})}get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}constructor(w,D,O,W,U,K,q,G,Q,Y,X,J){super(),this.languageConfigurationService=X,this._deliveryQueue=createEventDeliveryQueue(),this._contributions=this._register(new CodeEditorContributions),this._onDidDispose=this._register(new Emitter$1),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onWillChangeModel=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onWillChangeModel=this._onWillChangeModel.event,this._onDidChangeModel=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new BooleanEventEmitter({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new BooleanEventEmitter({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new InteractionEmitter(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new Emitter$1({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._updateCounter=0,this._onBeginUpdate=this._register(new Emitter$1),this.onBeginUpdate=this._onBeginUpdate.event,this._onEndUpdate=this._register(new Emitter$1),this.onEndUpdate=this._onEndUpdate.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),U.willCreateCodeEditor();const te={...D};this._domElement=w,this._overflowWidgetsDomNode=te.overflowWidgetsDomNode,delete te.overflowWidgetsDomNode,this._id=++EDITOR_ID,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=O.telemetryData,this._configuration=this._register(this._createConfiguration(O.isSimpleWidget||!1,O.contextMenuId??(O.isSimpleWidget?MenuId.SimpleEditorContext:MenuId.EditorContext),te,Y)),this._register(this._configuration.onDidChange(re=>{this._onDidChangeConfiguration.fire(re);const ae=this._configuration.options;if(re.hasChanged(146)){const le=ae.get(146);this._onDidLayoutChange.fire(le)}})),this._contextKeyService=this._register(q.createScoped(this._domElement)),this._notificationService=Q,this._codeEditorService=U,this._commandService=K,this._themeService=G,this._register(new EditorContextKeysManager(this,this._contextKeyService)),this._register(new EditorModeContext(this,this._contextKeyService,J)),this._instantiationService=this._register(W.createChild(new ServiceCollection([IContextKeyService,this._contextKeyService]))),this._modelData=null,this._focusTracker=new CodeEditorWidgetFocusTracker(w,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let ie;Array.isArray(O.contributions)?ie=O.contributions:ie=EditorExtensionsRegistry.getEditorContributions(),this._contributions.initialize(this,ie,this._instantiationService);for(const re of EditorExtensionsRegistry.getEditorActions()){if(this._actions.has(re.id)){onUnexpectedError(new Error(`Cannot have two actions with the same id ${re.id}`));continue}const ae=new InternalEditorAction(re.id,re.label,re.alias,re.metadata,re.precondition??void 0,le=>this._instantiationService.invokeFunction(de=>Promise.resolve(re.runEditorCommand(de,this,le))),this._contextKeyService);this._actions.set(ae.id,ae)}const se=()=>!this._configuration.options.get(92)&&this._configuration.options.get(36).enabled;this._register(new DragAndDropObserver(this._domElement,{onDragOver:re=>{if(!se())return;const ae=this.getTargetAtClientPoint(re.clientX,re.clientY);ae?.position&&this.showDropIndicatorAt(ae.position)},onDrop:async re=>{if(!se()||(this.removeDropIndicator(),!re.dataTransfer))return;const ae=this.getTargetAtClientPoint(re.clientX,re.clientY);ae?.position&&this._onDropIntoEditor.fire({position:ae.position,event:re})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(w){this._modelData?.view.writeScreenReaderContent(w)}_createConfiguration(w,D,O,W){return new EditorConfiguration(w,D,O,this._domElement,W)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return EditorType.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(w){return this._instantiationService.invokeFunction(w)}updateOptions(w){this._configuration.updateOptions(w||{})}getOptions(){return this._configuration.options}getOption(w){return this._configuration.options.get(w)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(w){return this._modelData?WordOperations.getWordAtPosition(this._modelData.model,this._configuration.options.get(132),this._configuration.options.get(131),w):null}getValue(w=null){if(!this._modelData)return"";const D=!!(w&&w.preserveBOM);let O=0;return w&&w.lineEnding&&w.lineEnding===`
`?O=1:w&&w.lineEnding&&w.lineEnding===`\r
`&&(O=2),this._modelData.model.getValue(O,D)}setValue(w){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(w)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(w=null){try{this._beginUpdate();const D=w;if(this._modelData===null&&D===null||this._modelData&&this._modelData.model===D)return;const O={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:D?.uri||null};this._onWillChangeModel.fire(O);const W=this.hasTextFocus(),U=this._detachModel();this._attachModel(D),W&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(O),this._postDetachModelCleanup(U),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const w in this._decorationTypeSubtypes){const D=this._decorationTypeSubtypes[w];for(const O in D)this._removeDecorationType(w+"-"+O)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(w,D,O,W){const U=w.model.validatePosition({lineNumber:D,column:O}),K=w.viewModel.coordinatesConverter.convertModelPositionToViewPosition(U);return w.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(K.lineNumber,W)}getTopForLineNumber(w,D=!1){return this._modelData?CodeEditorWidget_1._getVerticalOffsetForPosition(this._modelData,w,1,D):-1}getTopForPosition(w,D){return this._modelData?CodeEditorWidget_1._getVerticalOffsetForPosition(this._modelData,w,D,!1):-1}static _getVerticalOffsetForPosition(w,D,O,W=!1){const U=w.model.validatePosition({lineNumber:D,column:O}),K=w.viewModel.coordinatesConverter.convertModelPositionToViewPosition(U);return w.viewModel.viewLayout.getVerticalOffsetForLineNumber(K.lineNumber,W)}getBottomForLineNumber(w,D=!1){if(!this._modelData)return-1;const O=this._modelData.model.getLineMaxColumn(w);return CodeEditorWidget_1._getVerticalOffsetAfterPosition(this._modelData,w,O,D)}setHiddenAreas(w,D){this._modelData?.viewModel.setHiddenAreas(w.map(O=>Range$2.lift(O)),D)}getVisibleColumnFromPosition(w){if(!this._modelData)return w.column;const D=this._modelData.model.validatePosition(w),O=this._modelData.model.getOptions().tabSize;return CursorColumns.visibleColumnFromColumn(this._modelData.model.getLineContent(D.lineNumber),D.column,O)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(w,D="api"){if(this._modelData){if(!Position$1.isIPosition(w))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(D,[{selectionStartLineNumber:w.lineNumber,selectionStartColumn:w.column,positionLineNumber:w.lineNumber,positionColumn:w.column}])}}_sendRevealRange(w,D,O,W){if(!this._modelData)return;if(!Range$2.isIRange(w))throw new Error("Invalid arguments");const U=this._modelData.model.validateRange(w),K=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(U);this._modelData.viewModel.revealRange("api",O,K,D,W)}revealLine(w,D=0){this._revealLine(w,0,D)}revealLineInCenter(w,D=0){this._revealLine(w,1,D)}revealLineInCenterIfOutsideViewport(w,D=0){this._revealLine(w,2,D)}revealLineNearTop(w,D=0){this._revealLine(w,5,D)}_revealLine(w,D,O){if(typeof w!="number")throw new Error("Invalid arguments");this._sendRevealRange(new Range$2(w,1,w,1),D,!1,O)}revealPosition(w,D=0){this._revealPosition(w,0,!0,D)}revealPositionInCenter(w,D=0){this._revealPosition(w,1,!0,D)}revealPositionInCenterIfOutsideViewport(w,D=0){this._revealPosition(w,2,!0,D)}revealPositionNearTop(w,D=0){this._revealPosition(w,5,!0,D)}_revealPosition(w,D,O,W){if(!Position$1.isIPosition(w))throw new Error("Invalid arguments");this._sendRevealRange(new Range$2(w.lineNumber,w.column,w.lineNumber,w.column),D,O,W)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(w,D="api"){const O=Selection$1.isISelection(w),W=Range$2.isIRange(w);if(!O&&!W)throw new Error("Invalid arguments");if(O)this._setSelectionImpl(w,D);else if(W){const U={selectionStartLineNumber:w.startLineNumber,selectionStartColumn:w.startColumn,positionLineNumber:w.endLineNumber,positionColumn:w.endColumn};this._setSelectionImpl(U,D)}}_setSelectionImpl(w,D){if(!this._modelData)return;const O=new Selection$1(w.selectionStartLineNumber,w.selectionStartColumn,w.positionLineNumber,w.positionColumn);this._modelData.viewModel.setSelections(D,[O])}revealLines(w,D,O=0){this._revealLines(w,D,0,O)}revealLinesInCenter(w,D,O=0){this._revealLines(w,D,1,O)}revealLinesInCenterIfOutsideViewport(w,D,O=0){this._revealLines(w,D,2,O)}revealLinesNearTop(w,D,O=0){this._revealLines(w,D,5,O)}_revealLines(w,D,O,W){if(typeof w!="number"||typeof D!="number")throw new Error("Invalid arguments");this._sendRevealRange(new Range$2(w,1,D,1),O,!1,W)}revealRange(w,D=0,O=!1,W=!0){this._revealRange(w,O?1:0,W,D)}revealRangeInCenter(w,D=0){this._revealRange(w,1,!0,D)}revealRangeInCenterIfOutsideViewport(w,D=0){this._revealRange(w,2,!0,D)}revealRangeNearTop(w,D=0){this._revealRange(w,5,!0,D)}revealRangeNearTopIfOutsideViewport(w,D=0){this._revealRange(w,6,!0,D)}revealRangeAtTop(w,D=0){this._revealRange(w,3,!0,D)}_revealRange(w,D,O,W){if(!Range$2.isIRange(w))throw new Error("Invalid arguments");this._sendRevealRange(Range$2.lift(w),D,O,W)}setSelections(w,D="api",O=0){if(this._modelData){if(!w||w.length===0)throw new Error("Invalid arguments");for(let W=0,U=w.length;W<U;W++)if(!Selection$1.isISelection(w[W]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(D,w,O)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(w,D=1){if(this._modelData){if(typeof w!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:w},D)}}setScrollTop(w,D=1){if(this._modelData){if(typeof w!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:w},D)}}setScrollPosition(w,D=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(w,D)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;const w=this._contributions.saveViewState(),D=this._modelData.viewModel.saveCursorState(),O=this._modelData.viewModel.saveState();return{cursorState:D,viewState:O,contributionsState:w}}restoreViewState(w){if(!this._modelData||!this._modelData.hasRealView)return;const D=w;if(D&&D.cursorState&&D.viewState){const O=D.cursorState;Array.isArray(O)?O.length>0&&this._modelData.viewModel.restoreCursorState(O):this._modelData.viewModel.restoreCursorState([O]),this._contributions.restoreViewState(D.contributionsState||{});const W=this._modelData.viewModel.reduceRestoreState(D.viewState);this._modelData.view.restoreState(W)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}getContribution(w){return this._contributions.get(w)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let w=this.getActions();return w=w.filter(D=>D.isSupported()),w}getAction(w){return this._actions.get(w)||null}trigger(w,D,O){O=O||{};try{switch(this._beginUpdate(),D){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(w);return;case"type":{const U=O;this._type(w,U.text||"");return}case"replacePreviousChar":{const U=O;this._compositionType(w,U.text||"",U.replaceCharCnt||0,0,0);return}case"compositionType":{const U=O;this._compositionType(w,U.text||"",U.replacePrevCharCnt||0,U.replaceNextCharCnt||0,U.positionDelta||0);return}case"paste":{const U=O;this._paste(w,U.text||"",U.pasteOnNewLine||!1,U.multicursorText||null,U.mode||null,U.clipboardEvent);return}case"cut":this._cut(w);return}const W=this.getAction(D);if(W){Promise.resolve(W.run(O)).then(void 0,onUnexpectedError);return}if(!this._modelData||this._triggerEditorCommand(w,D,O))return;this._triggerCommand(D,O)}finally{this._endUpdate()}}_triggerCommand(w,D){this._commandService.executeCommand(w,D)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(w){this._modelData&&(this._modelData.viewModel.endComposition(w),this._onDidCompositionEnd.fire())}_type(w,D){!this._modelData||D.length===0||(w==="keyboard"&&this._onWillType.fire(D),this._modelData.viewModel.type(D,w),w==="keyboard"&&this._onDidType.fire(D))}_compositionType(w,D,O,W,U){this._modelData&&this._modelData.viewModel.compositionType(D,O,W,U,w)}_paste(w,D,O,W,U,K){if(!this._modelData)return;const q=this._modelData.viewModel,G=q.getSelection().getStartPosition();q.paste(D,O,W,w);const Q=q.getSelection().getStartPosition();w==="keyboard"&&this._onDidPaste.fire({clipboardEvent:K,range:new Range$2(G.lineNumber,G.column,Q.lineNumber,Q.column),languageId:U})}_cut(w){this._modelData&&this._modelData.viewModel.cut(w)}_triggerEditorCommand(w,D,O){const W=EditorExtensionsRegistry.getEditorCommand(D);return W?(O=O||{},O.source=w,this._instantiationService.invokeFunction(U=>{Promise.resolve(W.runEditorCommand(U,this,O)).then(void 0,onUnexpectedError)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(92)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(92)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(w,D,O){if(!this._modelData||this._configuration.options.get(92))return!1;let W;return O?Array.isArray(O)?W=()=>O:W=O:W=()=>null,this._modelData.viewModel.executeEdits(w,D,W),!0}executeCommand(w,D){this._modelData&&this._modelData.viewModel.executeCommand(D,w)}executeCommands(w,D){this._modelData&&this._modelData.viewModel.executeCommands(D,w)}createDecorationsCollection(w){return new EditorDecorationsCollection(this,w)}changeDecorations(w){return this._modelData?this._modelData.model.changeDecorations(w,this._id):null}getLineDecorations(w){return this._modelData?this._modelData.model.getLineDecorations(w,this._id,filterValidationDecorations(this._configuration.options)):null}getDecorationsInRange(w){return this._modelData?this._modelData.model.getDecorationsInRange(w,this._id,filterValidationDecorations(this._configuration.options)):null}deltaDecorations(w,D){return this._modelData?w.length===0&&D.length===0?w:this._modelData.model.deltaDecorations(w,D,this._id):[]}removeDecorations(w){!this._modelData||w.length===0||this._modelData.model.changeDecorations(D=>{D.deltaDecorations(w,[])})}removeDecorationsByType(w){const D=this._decorationTypeKeysToIds[w];D&&this.changeDecorations(O=>O.deltaDecorations(D,[])),this._decorationTypeKeysToIds.hasOwnProperty(w)&&delete this._decorationTypeKeysToIds[w],this._decorationTypeSubtypes.hasOwnProperty(w)&&delete this._decorationTypeSubtypes[w]}getLayoutInfo(){return this._configuration.options.get(146)}createOverviewRuler(w){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(w)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(w){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(w)}delegateScrollFromMouseWheelEvent(w){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(w)}layout(w,D=!1){this._configuration.observeContainer(w),D||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(w){const D={widget:w,position:w.getPosition()};this._contentWidgets.hasOwnProperty(w.getId())&&console.warn("Overwriting a content widget with the same id:"+w.getId()),this._contentWidgets[w.getId()]=D,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(D)}layoutContentWidget(w){const D=w.getId();if(this._contentWidgets.hasOwnProperty(D)){const O=this._contentWidgets[D];O.position=w.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(O)}}removeContentWidget(w){const D=w.getId();if(this._contentWidgets.hasOwnProperty(D)){const O=this._contentWidgets[D];delete this._contentWidgets[D],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(O)}}addOverlayWidget(w){const D={widget:w,position:w.getPosition()};this._overlayWidgets.hasOwnProperty(w.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[w.getId()]=D,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(D)}layoutOverlayWidget(w){const D=w.getId();if(this._overlayWidgets.hasOwnProperty(D)){const O=this._overlayWidgets[D];O.position=w.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(O)}}removeOverlayWidget(w){const D=w.getId();if(this._overlayWidgets.hasOwnProperty(D)){const O=this._overlayWidgets[D];delete this._overlayWidgets[D],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(O)}}addGlyphMarginWidget(w){const D={widget:w,position:w.getPosition()};this._glyphMarginWidgets.hasOwnProperty(w.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[w.getId()]=D,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(D)}layoutGlyphMarginWidget(w){const D=w.getId();if(this._glyphMarginWidgets.hasOwnProperty(D)){const O=this._glyphMarginWidgets[D];O.position=w.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(O)}}removeGlyphMarginWidget(w){const D=w.getId();if(this._glyphMarginWidgets.hasOwnProperty(D)){const O=this._glyphMarginWidgets[D];delete this._glyphMarginWidgets[D],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(O)}}changeViewZones(w){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(w)}getTargetAtClientPoint(w,D){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(w,D)}getScrolledVisiblePosition(w){if(!this._modelData||!this._modelData.hasRealView)return null;const D=this._modelData.model.validatePosition(w),O=this._configuration.options,W=O.get(146),U=CodeEditorWidget_1._getVerticalOffsetForPosition(this._modelData,D.lineNumber,D.column)-this.getScrollTop(),K=this._modelData.view.getOffsetForColumn(D.lineNumber,D.column)+W.glyphMarginWidth+W.lineNumbersWidth+W.decorationsWidth-this.getScrollLeft();return{top:U,left:K,height:O.get(67)}}getOffsetForColumn(w,D){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(w,D)}render(w=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,w)})}setAriaOptions(w){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(w)}applyFontInfo(w){applyFontInfo(w,this._configuration.options.get(50))}setBanner(w,D){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=w,this._configuration.setReservedHeight(w?D:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(w){if(!w){this._modelData=null;return}const D=[];this._domElement.setAttribute("data-mode-id",w.getLanguageId()),this._configuration.setIsDominatedByLongLines(w.isDominatedByLongLines()),this._configuration.setModelLineCount(w.getLineCount());const O=w.onBeforeAttached(),W=new ViewModel$1(this._id,this._configuration,w,DOMLineBreaksComputerFactory.create(getWindow(this._domElement)),MonospaceLineBreaksComputerFactory.create(this._configuration.options),q=>scheduleAtNextAnimationFrame(getWindow(this._domElement),q),this.languageConfigurationService,this._themeService,O,{batchChanges:q=>{try{return this._beginUpdate(),q()}finally{this._endUpdate()}}});D.push(w.onWillDispose(()=>this.setModel(null))),D.push(W.onEvent(q=>{switch(q.kind){case 0:this._onDidContentSizeChange.fire(q);break;case 1:this._editorTextFocus.setValue(q.hasFocus);break;case 2:this._onDidScrollChange.fire(q);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(q.reachedMaxCursorCount){const X=this.getOption(80),J=localize("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",X);this._notificationService.prompt(Severity.Warning,J,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:localize("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const G=[];for(let X=0,J=q.selections.length;X<J;X++)G[X]=q.selections[X].getPosition();const Q={position:G[0],secondaryPositions:G.slice(1),reason:q.reason,source:q.source};this._onDidChangeCursorPosition.fire(Q);const Y={selection:q.selections[0],secondarySelections:q.selections.slice(1),modelVersionId:q.modelVersionId,oldSelections:q.oldSelections,oldModelVersionId:q.oldModelVersionId,source:q.source,reason:q.reason};this._onDidChangeCursorSelection.fire(Y);break}case 7:this._onDidChangeModelDecorations.fire(q.event);break;case 8:this._domElement.setAttribute("data-mode-id",w.getLanguageId()),this._onDidChangeModelLanguage.fire(q.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(q.event);break;case 10:this._onDidChangeModelContent.fire(q.event);break;case 11:this._onDidChangeModelOptions.fire(q.event);break;case 12:this._onDidChangeModelTokens.fire(q.event);break}}));const[U,K]=this._createView(W);if(K){this._domElement.appendChild(U.domNode.domNode);let q=Object.keys(this._contentWidgets);for(let G=0,Q=q.length;G<Q;G++){const Y=q[G];U.addContentWidget(this._contentWidgets[Y])}q=Object.keys(this._overlayWidgets);for(let G=0,Q=q.length;G<Q;G++){const Y=q[G];U.addOverlayWidget(this._overlayWidgets[Y])}q=Object.keys(this._glyphMarginWidgets);for(let G=0,Q=q.length;G<Q;G++){const Y=q[G];U.addGlyphMarginWidget(this._glyphMarginWidgets[Y])}U.render(!1,!0),U.domNode.domNode.setAttribute("data-uri",w.uri.toString())}this._modelData=new ModelData$1(w,W,U,K,D,O)}_createView(w){let D;this.isSimpleWidget?D={paste:(U,K,q,G)=>{this._paste("keyboard",U,K,q,G)},type:U=>{this._type("keyboard",U)},compositionType:(U,K,q,G)=>{this._compositionType("keyboard",U,K,q,G)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:D={paste:(U,K,q,G)=>{const Q={text:U,pasteOnNewLine:K,multicursorText:q,mode:G};this._commandService.executeCommand("paste",Q)},type:U=>{const K={text:U};this._commandService.executeCommand("type",K)},compositionType:(U,K,q,G)=>{if(q||G){const Q={text:U,replacePrevCharCnt:K,replaceNextCharCnt:q,positionDelta:G};this._commandService.executeCommand("compositionType",Q)}else{const Q={text:U,replaceCharCnt:K};this._commandService.executeCommand("replacePreviousChar",Q)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const O=new ViewUserInputEvents(w.coordinatesConverter);return O.onKeyDown=U=>this._onKeyDown.fire(U),O.onKeyUp=U=>this._onKeyUp.fire(U),O.onContextMenu=U=>this._onContextMenu.fire(U),O.onMouseMove=U=>this._onMouseMove.fire(U),O.onMouseLeave=U=>this._onMouseLeave.fire(U),O.onMouseDown=U=>this._onMouseDown.fire(U),O.onMouseUp=U=>this._onMouseUp.fire(U),O.onMouseDrag=U=>this._onMouseDrag.fire(U),O.onMouseDrop=U=>this._onMouseDrop.fire(U),O.onMouseDropCanceled=U=>this._onMouseDropCanceled.fire(U),O.onMouseWheel=U=>this._onMouseWheel.fire(U),[new View$1(D,this._configuration,this._themeService.getColorTheme(),w,O,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(w){w?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;const w=this._modelData.model,D=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),D&&this._domElement.contains(D)&&D.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),w}_removeDecorationType(w){this._codeEditorService.removeDecorationType(w)}hasModel(){return this._modelData!==null}showDropIndicatorAt(w){const D=[{range:new Range$2(w.lineNumber,w.column,w.lineNumber,w.column),options:CodeEditorWidget_1.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(D),this.revealPosition(w,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(w,D){this._contextKeyService.createKey(w,D)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}};CodeEditorWidget=CodeEditorWidget_1=__decorate$T([__param$Q(3,IInstantiationService),__param$Q(4,ICodeEditorService),__param$Q(5,ICommandService),__param$Q(6,IContextKeyService),__param$Q(7,IThemeService),__param$Q(8,INotificationService),__param$Q(9,IAccessibilityService),__param$Q(10,ILanguageConfigurationService),__param$Q(11,ILanguageFeaturesService)],CodeEditorWidget);let EDITOR_ID=0,ModelData$1=class{constructor(w,D,O,W,U,K){this.model=w,this.viewModel=D,this.view=O,this.hasRealView=W,this.listenersToRemove=U,this.attachedView=K}dispose(){dispose(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};class BooleanEventEmitter extends Disposable{constructor(w){super(),this._emitterOptions=w,this._onDidChangeToTrue=this._register(new Emitter$1(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new Emitter$1(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(w){const D=w?2:1;this._value!==D&&(this._value=D,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}}class InteractionEmitter extends Emitter$1{constructor(w,D){super({deliveryQueue:D}),this._contributions=w}fire(w){this._contributions.onBeforeInteractionEvent(),super.fire(w)}}class EditorContextKeysManager extends Disposable{constructor(w,D){super(),this._editor=w,D.createKey("editorId",w.getId()),this._editorSimpleInput=EditorContextKeys.editorSimpleInput.bindTo(D),this._editorFocus=EditorContextKeys.focus.bindTo(D),this._textInputFocus=EditorContextKeys.textInputFocus.bindTo(D),this._editorTextFocus=EditorContextKeys.editorTextFocus.bindTo(D),this._tabMovesFocus=EditorContextKeys.tabMovesFocus.bindTo(D),this._editorReadonly=EditorContextKeys.readOnly.bindTo(D),this._inDiffEditor=EditorContextKeys.inDiffEditor.bindTo(D),this._editorColumnSelection=EditorContextKeys.columnSelection.bindTo(D),this._hasMultipleSelections=EditorContextKeys.hasMultipleSelections.bindTo(D),this._hasNonEmptySelection=EditorContextKeys.hasNonEmptySelection.bindTo(D),this._canUndo=EditorContextKeys.canUndo.bindTo(D),this._canRedo=EditorContextKeys.canRedo.bindTo(D),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(TabFocus.onDidChangeTabFocus(O=>this._tabMovesFocus.set(O))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const w=this._editor.getOptions();this._tabMovesFocus.set(TabFocus.getTabFocusMode()),this._editorReadonly.set(w.get(92)),this._inDiffEditor.set(w.get(61)),this._editorColumnSelection.set(w.get(22))}_updateFromSelection(){const w=this._editor.getSelections();w?(this._hasMultipleSelections.set(w.length>1),this._hasNonEmptySelection.set(w.some(D=>!D.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const w=this._editor.getModel();this._canUndo.set(!!(w&&w.canUndo())),this._canRedo.set(!!(w&&w.canRedo()))}}class EditorModeContext extends Disposable{constructor(w,D,O){super(),this._editor=w,this._contextKeyService=D,this._languageFeaturesService=O,this._langId=EditorContextKeys.languageId.bindTo(D),this._hasCompletionItemProvider=EditorContextKeys.hasCompletionItemProvider.bindTo(D),this._hasCodeActionsProvider=EditorContextKeys.hasCodeActionsProvider.bindTo(D),this._hasCodeLensProvider=EditorContextKeys.hasCodeLensProvider.bindTo(D),this._hasDefinitionProvider=EditorContextKeys.hasDefinitionProvider.bindTo(D),this._hasDeclarationProvider=EditorContextKeys.hasDeclarationProvider.bindTo(D),this._hasImplementationProvider=EditorContextKeys.hasImplementationProvider.bindTo(D),this._hasTypeDefinitionProvider=EditorContextKeys.hasTypeDefinitionProvider.bindTo(D),this._hasHoverProvider=EditorContextKeys.hasHoverProvider.bindTo(D),this._hasDocumentHighlightProvider=EditorContextKeys.hasDocumentHighlightProvider.bindTo(D),this._hasDocumentSymbolProvider=EditorContextKeys.hasDocumentSymbolProvider.bindTo(D),this._hasReferenceProvider=EditorContextKeys.hasReferenceProvider.bindTo(D),this._hasRenameProvider=EditorContextKeys.hasRenameProvider.bindTo(D),this._hasSignatureHelpProvider=EditorContextKeys.hasSignatureHelpProvider.bindTo(D),this._hasInlayHintsProvider=EditorContextKeys.hasInlayHintsProvider.bindTo(D),this._hasDocumentFormattingProvider=EditorContextKeys.hasDocumentFormattingProvider.bindTo(D),this._hasDocumentSelectionFormattingProvider=EditorContextKeys.hasDocumentSelectionFormattingProvider.bindTo(D),this._hasMultipleDocumentFormattingProvider=EditorContextKeys.hasMultipleDocumentFormattingProvider.bindTo(D),this._hasMultipleDocumentSelectionFormattingProvider=EditorContextKeys.hasMultipleDocumentSelectionFormattingProvider.bindTo(D),this._isInEmbeddedEditor=EditorContextKeys.isInEmbeddedEditor.bindTo(D);const W=()=>this._update();this._register(w.onDidChangeModel(W)),this._register(w.onDidChangeModelLanguage(W)),this._register(O.completionProvider.onDidChange(W)),this._register(O.codeActionProvider.onDidChange(W)),this._register(O.codeLensProvider.onDidChange(W)),this._register(O.definitionProvider.onDidChange(W)),this._register(O.declarationProvider.onDidChange(W)),this._register(O.implementationProvider.onDidChange(W)),this._register(O.typeDefinitionProvider.onDidChange(W)),this._register(O.hoverProvider.onDidChange(W)),this._register(O.documentHighlightProvider.onDidChange(W)),this._register(O.documentSymbolProvider.onDidChange(W)),this._register(O.referenceProvider.onDidChange(W)),this._register(O.renameProvider.onDidChange(W)),this._register(O.documentFormattingEditProvider.onDidChange(W)),this._register(O.documentRangeFormattingEditProvider.onDidChange(W)),this._register(O.signatureHelpProvider.onDidChange(W)),this._register(O.inlayHintsProvider.onDidChange(W)),W()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){const w=this._editor.getModel();if(!w){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(w.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(w)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(w)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(w)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(w)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(w)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(w)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(w)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(w)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(w)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(w)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(w)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(w)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(w)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(w)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(w)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(w)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(w)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(w).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(w).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(w).length>1),this._isInEmbeddedEditor.set(w.uri.scheme===Schemas.walkThroughSnippet||w.uri.scheme===Schemas.vscodeChatCodeBlock)})}}class CodeEditorWidgetFocusTracker extends Disposable{constructor(w,D){super(),this._onChange=this._register(new Emitter$1),this.onChange=this._onChange.event,this._hadFocus=void 0,this._hasDomElementFocus=!1,this._domFocusTracker=this._register(trackFocus(w)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),D&&(this._overflowWidgetsDomNode=this._register(trackFocus(D)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){const w=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==w&&(this._hadFocus=w,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}}class EditorDecorationsCollection{get length(){return this._decorationIds.length}constructor(w,D){this._editor=w,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(D)&&D.length>0&&this.set(D)}onDidChange(w,D,O){return this._editor.onDidChangeModelDecorations(W=>{this._isChangingDecorations||w.call(D,W)},O)}getRange(w){return!this._editor.hasModel()||w>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[w])}getRanges(){if(!this._editor.hasModel())return[];const w=this._editor.getModel(),D=[];for(const O of this._decorationIds){const W=w.getDecorationRange(O);W&&D.push(W)}return D}has(w){return this._decorationIds.includes(w.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(w){try{this._isChangingDecorations=!0,this._editor.changeDecorations(D=>{this._decorationIds=D.deltaDecorations(this._decorationIds,w)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(w){let D=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(O=>{D=O.deltaDecorations([],w),this._decorationIds=this._decorationIds.concat(D)})}finally{this._isChangingDecorations=!1}return D}}const squigglyStart=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),squigglyEnd=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function getSquigglySVGData(F){return squigglyStart+encodeURIComponent(F.toString())+squigglyEnd}const dotdotdotStart=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),dotdotdotEnd=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function getDotDotDotSVGData(F){return dotdotdotStart+encodeURIComponent(F.toString())+dotdotdotEnd}registerThemingParticipant((F,w)=>{const D=F.getColor(editorErrorForeground);D&&w.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${getSquigglySVGData(D)}") repeat-x bottom left; }`);const O=F.getColor(editorWarningForeground);O&&w.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${getSquigglySVGData(O)}") repeat-x bottom left; }`);const W=F.getColor(editorInfoForeground);W&&w.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${getSquigglySVGData(W)}") repeat-x bottom left; }`);const U=F.getColor(editorHintForeground);U&&w.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${getDotDotDotSVGData(U)}") no-repeat bottom left; }`);const K=F.getColor(editorUnnecessaryCodeOpacity);K&&w.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${K.rgba.a}; }`)});var __decorate$S=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$P=function(F,w){return function(D,O){w(D,O,F)}};let EmbeddedCodeEditorWidget=class extends CodeEditorWidget{constructor(w,D,O,W,U,K,q,G,Q,Y,X,J,te){super(w,{...W.getRawOptions(),overflowWidgetsDomNode:W.getOverflowWidgetsDomNode()},O,U,K,q,G,Q,Y,X,J,te),this._parentEditor=W,this._overwriteOptions=D,super.updateOptions(this._overwriteOptions),this._register(W.onDidChangeConfiguration(ie=>this._onParentConfigurationChanged(ie)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(w){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(w){mixin(this._overwriteOptions,w,!0),super.updateOptions(this._overwriteOptions)}};EmbeddedCodeEditorWidget=__decorate$S([__param$P(4,IInstantiationService),__param$P(5,ICodeEditorService),__param$P(6,ICommandService),__param$P(7,IContextKeyService),__param$P(8,IThemeService),__param$P(9,INotificationService),__param$P(10,IAccessibilityService),__param$P(11,ILanguageConfigurationService),__param$P(12,ILanguageFeaturesService)],EmbeddedCodeEditorWidget);class BaseDropdown extends ActionRunner{constructor(w,D){super(),this._onDidChangeVisibility=this._register(new Emitter$1),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=append$1(w,$$8(".monaco-dropdown")),this._label=append$1(this._element,$$8(".dropdown-label"));let O=D.labelRenderer;O||(O=U=>(U.textContent=D.label||"",null));for(const U of[EventType$1.CLICK,EventType$1.MOUSE_DOWN,EventType.Tap])this._register(addDisposableListener(this.element,U,K=>EventHelper.stop(K,!0)));for(const U of[EventType$1.MOUSE_DOWN,EventType.Tap])this._register(addDisposableListener(this._label,U,K=>{isMouseEvent(K)&&(K.detail>1||K.button!==0)||(this.visible?this.hide():this.show())}));this._register(addDisposableListener(this._label,EventType$1.KEY_UP,U=>{const K=new StandardKeyboardEvent(U);(K.equals(3)||K.equals(10))&&(EventHelper.stop(U,!0),this.visible?this.hide():this.show())}));const W=O(this._label);W&&this._register(W),this._register(Gesture.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class DropdownMenu extends BaseDropdown{constructor(w,D){super(w,D),this._options=D,this._actions=[],this.actions=D.actions||[]}set menuOptions(w){this._menuOptions=w}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(w){this._actions=w}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(w,D)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(w,D):void 0,getKeyBinding:w=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(w):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class DropdownMenuActionViewItem extends BaseActionViewItem{constructor(w,D,O,W=Object.create(null)){super(null,w,W),this.actionItem=null,this._onDidChangeVisibility=this._register(new Emitter$1),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this.menuActionsOrProvider=D,this.contextMenuProvider=O,this.options=W,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(w){this.actionItem=w;const D=U=>{this.element=append$1(U,$$8("a.action-label"));let K=[];return typeof this.options.classNames=="string"?K=this.options.classNames.split(/\s+/g).filter(q=>!!q):this.options.classNames&&(K=this.options.classNames),K.find(q=>q==="icon")||K.push("codicon"),this.element.classList.add(...K),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(getBaseLayerHoverDelegate().setupManagedHover(this.options.hoverDelegate??getDefaultHoverDelegate("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},O=Array.isArray(this.menuActionsOrProvider),W={contextMenuProvider:this.contextMenuProvider,labelRenderer:D,menuAsChild:this.options.menuAsChild,actions:O?this.menuActionsOrProvider:void 0,actionProvider:O?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new DropdownMenu(w,W)),this._register(this.dropdownMenu.onDidChangeVisibility(U=>{this.element?.setAttribute("aria-expanded",`${U}`),this._onDidChangeVisibility.fire(U)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const U=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return U.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let w=null;return this.action.tooltip?w=this.action.tooltip:this.action.label&&(w=this.action.label),w??void 0}setActionContext(w){super.setActionContext(w),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=w:this.dropdownMenu.menuOptions={context:w})}show(){this.dropdownMenu?.show()}updateEnabled(){const w=!this.action.enabled;this.actionItem?.classList.toggle("disabled",w),this.element?.classList.toggle("disabled",w)}}class ModifierLabelProvider{constructor(w,D,O=D){this.modifierLabels=[null],this.modifierLabels[2]=w,this.modifierLabels[1]=D,this.modifierLabels[3]=O}toLabel(w,D,O){if(D.length===0)return null;const W=[];for(let U=0,K=D.length;U<K;U++){const q=D[U],G=O(q);if(G===null)return null;W[U]=_simpleAsString(q,G,this.modifierLabels[w])}return W.join(" ")}}const UILabelProvider=new ModifierLabelProvider({ctrlKey:"⌃",shiftKey:"⇧",altKey:"⌥",metaKey:"⌘",separator:""},{ctrlKey:localize({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:localize({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:localize({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:localize({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:localize({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:localize({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),AriaLabelProvider=new ModifierLabelProvider({ctrlKey:localize({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:localize({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:localize({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:localize({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:localize({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:localize({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:localize({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:localize({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:localize({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),ElectronAcceleratorLabelProvider=new ModifierLabelProvider({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),UserSettingsLabelProvider=new ModifierLabelProvider({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function _simpleAsString(F,w,D){if(w===null)return"";const O=[];return F.ctrlKey&&O.push(D.ctrlKey),F.shiftKey&&O.push(D.shiftKey),F.altKey&&O.push(D.altKey),F.metaKey&&O.push(D.metaKey),w!==""&&O.push(w),O.join(D.separator)}function isICommandActionToggleInfo(F){return F?F.condition!==void 0:!1}const IContextViewService=createDecorator("contextViewService"),IContextMenuService=createDecorator("contextMenuService");function overrideStyles(F,w){const D={...w};for(const O in F){const W=F[O];D[O]=W!==void 0?asCssVariable(W):void 0}return D}const defaultKeybindingLabelStyles={keybindingLabelBackground:asCssVariable(keybindingLabelBackground),keybindingLabelForeground:asCssVariable(keybindingLabelForeground),keybindingLabelBorder:asCssVariable(keybindingLabelBorder),keybindingLabelBottomBorder:asCssVariable(keybindingLabelBottomBorder),keybindingLabelShadow:asCssVariable(widgetShadow)},defaultButtonStyles={buttonForeground:asCssVariable(buttonForeground),buttonSeparator:asCssVariable(buttonSeparator),buttonBackground:asCssVariable(buttonBackground),buttonHoverBackground:asCssVariable(buttonHoverBackground),buttonSecondaryForeground:asCssVariable(buttonSecondaryForeground),buttonSecondaryBackground:asCssVariable(buttonSecondaryBackground),buttonSecondaryHoverBackground:asCssVariable(buttonSecondaryHoverBackground),buttonBorder:asCssVariable(buttonBorder)},defaultProgressBarStyles={progressBarBackground:asCssVariable(progressBarBackground)},defaultToggleStyles={inputActiveOptionBorder:asCssVariable(inputActiveOptionBorder),inputActiveOptionForeground:asCssVariable(inputActiveOptionForeground),inputActiveOptionBackground:asCssVariable(inputActiveOptionBackground)};asCssVariable(radioActiveForeground),asCssVariable(radioActiveBackground),asCssVariable(radioActiveBorder),asCssVariable(radioInactiveForeground),asCssVariable(radioInactiveBackground),asCssVariable(radioInactiveBorder),asCssVariable(radioInactiveHoverBackground);asCssVariable(checkboxBackground),asCssVariable(checkboxBorder),asCssVariable(checkboxForeground);asCssVariable(editorWidgetBackground),asCssVariable(editorWidgetForeground),asCssVariable(widgetShadow),asCssVariable(contrastBorder),asCssVariable(problemsErrorIconForeground),asCssVariable(problemsWarningIconForeground),asCssVariable(problemsInfoIconForeground),asCssVariable(textLinkForeground);const defaultInputBoxStyles={inputBackground:asCssVariable(inputBackground),inputForeground:asCssVariable(inputForeground),inputBorder:asCssVariable(inputBorder),inputValidationInfoBorder:asCssVariable(inputValidationInfoBorder),inputValidationInfoBackground:asCssVariable(inputValidationInfoBackground),inputValidationInfoForeground:asCssVariable(inputValidationInfoForeground),inputValidationWarningBorder:asCssVariable(inputValidationWarningBorder),inputValidationWarningBackground:asCssVariable(inputValidationWarningBackground),inputValidationWarningForeground:asCssVariable(inputValidationWarningForeground),inputValidationErrorBorder:asCssVariable(inputValidationErrorBorder),inputValidationErrorBackground:asCssVariable(inputValidationErrorBackground),inputValidationErrorForeground:asCssVariable(inputValidationErrorForeground)},defaultFindWidgetStyles={listFilterWidgetBackground:asCssVariable(listFilterWidgetBackground),listFilterWidgetOutline:asCssVariable(listFilterWidgetOutline),listFilterWidgetNoMatchesOutline:asCssVariable(listFilterWidgetNoMatchesOutline),listFilterWidgetShadow:asCssVariable(listFilterWidgetShadow),inputBoxStyles:defaultInputBoxStyles,toggleStyles:defaultToggleStyles},defaultCountBadgeStyles={badgeBackground:asCssVariable(badgeBackground),badgeForeground:asCssVariable(badgeForeground),badgeBorder:asCssVariable(contrastBorder)};asCssVariable(breadcrumbsBackground),asCssVariable(breadcrumbsForeground),asCssVariable(breadcrumbsFocusForeground),asCssVariable(breadcrumbsFocusForeground),asCssVariable(breadcrumbsActiveSelectionForeground);const defaultListStyles={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:asCssVariable(listFocusBackground),listFocusForeground:asCssVariable(listFocusForeground),listFocusOutline:asCssVariable(listFocusOutline),listActiveSelectionBackground:asCssVariable(listActiveSelectionBackground),listActiveSelectionForeground:asCssVariable(listActiveSelectionForeground),listActiveSelectionIconForeground:asCssVariable(listActiveSelectionIconForeground),listFocusAndSelectionOutline:asCssVariable(listFocusAndSelectionOutline),listFocusAndSelectionBackground:asCssVariable(listActiveSelectionBackground),listFocusAndSelectionForeground:asCssVariable(listActiveSelectionForeground),listInactiveSelectionBackground:asCssVariable(listInactiveSelectionBackground),listInactiveSelectionIconForeground:asCssVariable(listInactiveSelectionIconForeground),listInactiveSelectionForeground:asCssVariable(listInactiveSelectionForeground),listInactiveFocusBackground:asCssVariable(listInactiveFocusBackground),listInactiveFocusOutline:asCssVariable(listInactiveFocusOutline),listHoverBackground:asCssVariable(listHoverBackground),listHoverForeground:asCssVariable(listHoverForeground),listDropOverBackground:asCssVariable(listDropOverBackground),listDropBetweenBackground:asCssVariable(listDropBetweenBackground),listSelectionOutline:asCssVariable(activeContrastBorder),listHoverOutline:asCssVariable(activeContrastBorder),treeIndentGuidesStroke:asCssVariable(treeIndentGuidesStroke),treeInactiveIndentGuidesStroke:asCssVariable(treeInactiveIndentGuidesStroke),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:asCssVariable(scrollbarShadow),tableColumnsBorder:asCssVariable(tableColumnsBorder),tableOddRowsBackgroundColor:asCssVariable(tableOddRowsBackgroundColor)};function getListStyles(F){return overrideStyles(F,defaultListStyles)}const defaultSelectBoxStyles={selectBackground:asCssVariable(selectBackground),selectListBackground:asCssVariable(selectListBackground),selectForeground:asCssVariable(selectForeground),decoratorRightForeground:asCssVariable(pickerGroupForeground),selectBorder:asCssVariable(selectBorder),focusBorder:asCssVariable(focusBorder),listFocusBackground:asCssVariable(quickInputListFocusBackground),listInactiveSelectionIconForeground:asCssVariable(quickInputListFocusIconForeground),listFocusForeground:asCssVariable(quickInputListFocusForeground),listFocusOutline:asCssVariableWithDefault(activeContrastBorder,Color.transparent.toString()),listHoverBackground:asCssVariable(listHoverBackground),listHoverForeground:asCssVariable(listHoverForeground),listHoverOutline:asCssVariable(activeContrastBorder),selectListBorder:asCssVariable(editorWidgetBorder),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},defaultMenuStyles={shadowColor:asCssVariable(widgetShadow),borderColor:asCssVariable(menuBorder),foregroundColor:asCssVariable(menuForeground),backgroundColor:asCssVariable(menuBackground),selectionForegroundColor:asCssVariable(menuSelectionForeground),selectionBackgroundColor:asCssVariable(menuSelectionBackground),selectionBorderColor:asCssVariable(menuSelectionBorder),separatorColor:asCssVariable(menuSeparatorBackground),scrollbarShadow:asCssVariable(scrollbarShadow),scrollbarSliderBackground:asCssVariable(scrollbarSliderBackground),scrollbarSliderHoverBackground:asCssVariable(scrollbarSliderHoverBackground),scrollbarSliderActiveBackground:asCssVariable(scrollbarSliderActiveBackground)};var __decorate$R=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$O=function(F,w){return function(D,O){w(D,O,F)}};function createAndFillInContextMenuActions(F,w,D,O){let W,U,K;if(Array.isArray(F))K=F,W=w,U=D;else{const Q=w;K=F.getActions(Q),W=D,U=O}const q=ModifierKeyEmitter.getInstance(),G=q.keyStatus.altKey||(isWindows||isLinux)&&q.keyStatus.shiftKey;fillInActions(K,W,G,U?Q=>Q===U:Q=>Q==="navigation")}function createAndFillInActionBarActions(F,w,D,O,W,U){let K,q,G,Q,Y;if(Array.isArray(F))Y=F,K=w,q=D,G=O,Q=W;else{const J=w;Y=F.getActions(J),K=D,q=O,G=W,Q=U}fillInActions(Y,K,!1,typeof q=="string"?J=>J===q:q,G,Q)}function fillInActions(F,w,D,O=K=>K==="navigation",W=()=>!1,U=!1){let K,q;Array.isArray(w)?(K=w,q=w):(K=w.primary,q=w.secondary);const G=new Set;for(const[Q,Y]of F){let X;O(Q)?(X=K,X.length>0&&U&&X.push(new Separator)):(X=q,X.length>0&&X.push(new Separator));for(let J of Y){D&&(J=J instanceof MenuItemAction&&J.alt?J.alt:J);const te=X.push(J);J instanceof SubmenuAction&&G.add({group:Q,action:J,index:te-1})}}for(const{group:Q,action:Y,index:X}of G){const J=O(Q)?K:q,te=Y.actions;W(Y,Q,J.length)&&J.splice(X,1,...te)}}let MenuEntryActionViewItem=class extends ActionViewItem{constructor(w,D,O,W,U,K,q,G){super(void 0,w,{icon:!!(w.class||w.item.icon),label:!w.class&&!w.item.icon,draggable:D?.draggable,keybinding:D?.keybinding,hoverDelegate:D?.hoverDelegate}),this._options=D,this._keybindingService=O,this._notificationService=W,this._contextKeyService=U,this._themeService=K,this._contextMenuService=q,this._accessibilityService=G,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new MutableDisposable),this._altKey=ModifierKeyEmitter.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(w){w.preventDefault(),w.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(D){this._notificationService.error(D)}}render(w){if(super.render(w),w.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let D=!1;const O=()=>{const W=!!this._menuItemAction.alt?.enabled&&(!this._accessibilityService.isMotionReduced()||D)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&D);W!==this._wantsAltCommand&&(this._wantsAltCommand=W,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(O)),this._register(addDisposableListener(w,"mouseleave",W=>{D=!1,O()})),this._register(addDisposableListener(w,"mouseenter",W=>{D=!0,O()})),O()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){const w=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),D=w&&w.getLabel(),O=this._commandAction.tooltip||this._commandAction.label;let W=D?localize("titleAndKb","{0} ({1})",O,D):O;if(!this._wantsAltCommand&&this._menuItemAction.alt?.enabled){const U=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,K=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),q=K&&K.getLabel(),G=q?localize("titleAndKb","{0} ({1})",U,q):U;W=localize("titleAndKbAndAlt",`{0}
[{1}] {2}`,W,UILabelProvider.modifierLabels[OS].altKey,G)}return W}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(w){this._itemClassDispose.value=void 0;const{element:D,label:O}=this;if(!D||!O)return;const W=this._commandAction.checked&&isICommandActionToggleInfo(w.toggled)&&w.toggled.icon?w.toggled.icon:w.icon;if(W)if(ThemeIcon.isThemeIcon(W)){const U=ThemeIcon.asClassNameArray(W);O.classList.add(...U),this._itemClassDispose.value=toDisposable(()=>{O.classList.remove(...U)})}else O.style.backgroundImage=isDark(this._themeService.getColorTheme().type)?asCSSUrl(W.dark):asCSSUrl(W.light),O.classList.add("icon"),this._itemClassDispose.value=combinedDisposable(toDisposable(()=>{O.style.backgroundImage="",O.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};MenuEntryActionViewItem=__decorate$R([__param$O(2,IKeybindingService),__param$O(3,INotificationService),__param$O(4,IContextKeyService),__param$O(5,IThemeService),__param$O(6,IContextMenuService),__param$O(7,IAccessibilityService)],MenuEntryActionViewItem);class TextOnlyMenuEntryActionViewItem extends MenuEntryActionViewItem{render(w){this.options.label=!0,this.options.icon=!1,super.render(w),w.classList.add("text-only"),w.classList.toggle("use-comma",this._options?.useComma??!1)}updateLabel(){const w=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!w)return super.updateLabel();if(this.label){const D=TextOnlyMenuEntryActionViewItem._symbolPrintEnter(w);this._options?.conversational?this.label.textContent=localize({key:"content2",comment:['A label with keybindg like "ESC to dismiss"']},"{1} to {0}",this._action.label,D):this.label.textContent=localize({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",this._action.label,D)}}static _symbolPrintEnter(w){return w.getLabel()?.replace(/\benter\b/gi,"⏎").replace(/\bEscape\b/gi,"Esc")}}let SubmenuEntryActionViewItem=class extends DropdownMenuActionViewItem{constructor(w,D,O,W,U){const K={...D,menuAsChild:D?.menuAsChild??!1,classNames:D?.classNames??(ThemeIcon.isThemeIcon(w.item.icon)?ThemeIcon.asClassName(w.item.icon):void 0),keybindingProvider:D?.keybindingProvider??(q=>O.lookupKeybinding(q.id))};super(w,{getActions:()=>w.actions},W,K),this._keybindingService=O,this._contextMenuService=W,this._themeService=U}render(w){super.render(w),assertType(this.element),w.classList.add("menu-entry");const D=this._action,{icon:O}=D.item;if(O&&!ThemeIcon.isThemeIcon(O)){this.element.classList.add("icon");const W=()=>{this.element&&(this.element.style.backgroundImage=isDark(this._themeService.getColorTheme().type)?asCSSUrl(O.dark):asCSSUrl(O.light))};W(),this._register(this._themeService.onDidColorThemeChange(()=>{W()}))}}};SubmenuEntryActionViewItem=__decorate$R([__param$O(2,IKeybindingService),__param$O(3,IContextMenuService),__param$O(4,IThemeService)],SubmenuEntryActionViewItem);let DropdownWithDefaultActionViewItem=class extends BaseActionViewItem{constructor(w,D,O,W,U,K,q,G){super(null,w),this._keybindingService=O,this._notificationService=W,this._contextMenuService=U,this._menuService=K,this._instaService=q,this._storageService=G,this._container=null,this._options=D,this._storageKey=`${w.item.submenu.id}_lastActionId`;let Q;const Y=D?.persistLastActionId?G.get(this._storageKey,1):void 0;Y&&(Q=w.actions.find(J=>Y===J.id)),Q||(Q=w.actions[0]),this._defaultAction=this._instaService.createInstance(MenuEntryActionViewItem,Q,{keybinding:this._getDefaultActionKeybindingLabel(Q)});const X={keybindingProvider:J=>this._keybindingService.lookupKeybinding(J.id),...D,menuAsChild:D?.menuAsChild??!0,classNames:D?.classNames??["codicon","codicon-chevron-down"],actionRunner:D?.actionRunner??new ActionRunner};this._dropdown=new DropdownMenuActionViewItem(w,w.actions,this._contextMenuService,X),this._register(this._dropdown.actionRunner.onDidRun(J=>{J.action instanceof MenuItemAction&&this.update(J.action)}))}update(w){this._options?.persistLastActionId&&this._storageService.store(this._storageKey,w.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(MenuEntryActionViewItem,w,{keybinding:this._getDefaultActionKeybindingLabel(w)}),this._defaultAction.actionRunner=new class extends ActionRunner{async runAction(D,O){await D.run(void 0)}},this._container&&this._defaultAction.render(prepend$1(this._container,$$8(".action-container")))}_getDefaultActionKeybindingLabel(w){let D;if(this._options?.renderKeybindingWithDefaultActionLabel){const O=this._keybindingService.lookupKeybinding(w.id);O&&(D=`(${O.getLabel()})`)}return D}setActionContext(w){super.setActionContext(w),this._defaultAction.setActionContext(w),this._dropdown.setActionContext(w)}render(w){this._container=w,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const D=$$8(".action-container");this._defaultAction.render(append$1(this._container,D)),this._register(addDisposableListener(D,EventType$1.KEY_DOWN,W=>{const U=new StandardKeyboardEvent(W);U.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),U.stopPropagation())}));const O=$$8(".dropdown-action-container");this._dropdown.render(append$1(this._container,O)),this._register(addDisposableListener(O,EventType$1.KEY_DOWN,W=>{const U=new StandardKeyboardEvent(W);U.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._defaultAction.element?.focus(),U.stopPropagation())}))}focus(w){w?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(w){w?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};DropdownWithDefaultActionViewItem=__decorate$R([__param$O(2,IKeybindingService),__param$O(3,INotificationService),__param$O(4,IContextMenuService),__param$O(5,IMenuService),__param$O(6,IInstantiationService),__param$O(7,IStorageService)],DropdownWithDefaultActionViewItem);let SubmenuEntrySelectActionViewItem=class extends SelectActionViewItem{constructor(w,D){super(null,w,w.actions.map(O=>({text:O.id===Separator.ID?"─────────":O.label,isDisabled:!O.enabled})),0,D,defaultSelectBoxStyles,{ariaLabel:w.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,w.actions.findIndex(O=>O.checked)))}render(w){super.render(w),w.style.borderColor=asCssVariable(selectBorder)}runAction(w,D){const O=this.action.actions[D];O&&this.actionRunner.run(O)}};SubmenuEntrySelectActionViewItem=__decorate$R([__param$O(1,IContextViewService)],SubmenuEntrySelectActionViewItem);function createActionViewItem(F,w,D){return w instanceof MenuItemAction?F.createInstance(MenuEntryActionViewItem,w,D):w instanceof SubmenuItemAction?w.item.isSelection?F.createInstance(SubmenuEntrySelectActionViewItem,w):w.item.rememberDefaultAction?F.createInstance(DropdownWithDefaultActionViewItem,w,{...D,persistLastActionId:!0}):F.createInstance(SubmenuEntryActionViewItem,w,D):void 0}var __decorate$Q=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$N=function(F,w){return function(D,O){w(D,O,F)}};let SuggestWidgetStatus=class{constructor(w,D,O,W,U){this._menuId=D,this._menuService=W,this._contextKeyService=U,this._menuDisposables=new DisposableStore,this.element=append$1(w,$$8(".suggest-status-bar"));const K=q=>q instanceof MenuItemAction?O.createInstance(TextOnlyMenuEntryActionViewItem,q,{useComma:!0}):void 0;this._leftActions=new ActionBar(this.element,{actionViewItemProvider:K}),this._rightActions=new ActionBar(this.element,{actionViewItemProvider:K}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}dispose(){this._menuDisposables.dispose(),this._leftActions.dispose(),this._rightActions.dispose(),this.element.remove()}show(){const w=this._menuService.createMenu(this._menuId,this._contextKeyService),D=()=>{const O=[],W=[];for(const[U,K]of w.getActions())U==="left"?O.push(...K):W.push(...K);this._leftActions.clear(),this._leftActions.push(O),this._rightActions.clear(),this._rightActions.push(W)};this._menuDisposables.add(w.onDidChange(()=>D())),this._menuDisposables.add(w)}hide(){this._menuDisposables.clear()}};SuggestWidgetStatus=__decorate$Q([__param$N(2,IInstantiationService),__param$N(3,IMenuService),__param$N(4,IContextKeyService)],SuggestWidgetStatus);registerColor("symbolIcon.arrayForeground",foreground,localize("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.booleanForeground",foreground,localize("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},localize("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.colorForeground",foreground,localize("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.constantForeground",foreground,localize("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},localize("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},localize("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},localize("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},localize("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},localize("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.fileForeground",foreground,localize("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.folderForeground",foreground,localize("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},localize("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},localize("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.keyForeground",foreground,localize("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.keywordForeground",foreground,localize("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},localize("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.moduleForeground",foreground,localize("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.namespaceForeground",foreground,localize("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.nullForeground",foreground,localize("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.numberForeground",foreground,localize("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.objectForeground",foreground,localize("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.operatorForeground",foreground,localize("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.packageForeground",foreground,localize("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.propertyForeground",foreground,localize("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.referenceForeground",foreground,localize("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.snippetForeground",foreground,localize("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.stringForeground",foreground,localize("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.structForeground",foreground,localize("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.textForeground",foreground,localize("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.typeParameterForeground",foreground,localize("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.unitForeground",foreground,localize("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerColor("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},localize("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));var __decorate$P=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U};const DEBUG=!1;var OrthogonalEdge;(function(F){F.North="north",F.South="south",F.East="east",F.West="west"})(OrthogonalEdge||(OrthogonalEdge={}));let globalSize=4;const onDidChangeGlobalSize=new Emitter$1;let globalHoverDelay=300;const onDidChangeHoverDelay=new Emitter$1;class MouseEventFactory{constructor(w){this.el=w,this.disposables=new DisposableStore}get onPointerMove(){return this.disposables.add(new DomEmitter(getWindow(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new DomEmitter(getWindow(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}}__decorate$P([memoize],MouseEventFactory.prototype,"onPointerMove",null);__decorate$P([memoize],MouseEventFactory.prototype,"onPointerUp",null);class GestureEventFactory{get onPointerMove(){return this.disposables.add(new DomEmitter(this.el,EventType.Change)).event}get onPointerUp(){return this.disposables.add(new DomEmitter(this.el,EventType.End)).event}constructor(w){this.el=w,this.disposables=new DisposableStore}dispose(){this.disposables.dispose()}}__decorate$P([memoize],GestureEventFactory.prototype,"onPointerMove",null);__decorate$P([memoize],GestureEventFactory.prototype,"onPointerUp",null);class OrthogonalPointerEventFactory{get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}constructor(w){this.factory=w}dispose(){}}__decorate$P([memoize],OrthogonalPointerEventFactory.prototype,"onPointerMove",null);__decorate$P([memoize],OrthogonalPointerEventFactory.prototype,"onPointerUp",null);const PointerEventsDisabledCssClass="pointer-events-disabled";class Sash extends Disposable{get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(w){this._state!==w&&(this.el.classList.toggle("disabled",w===0),this.el.classList.toggle("minimum",w===1),this.el.classList.toggle("maximum",w===2),this._state=w,this.onDidEnablementChange.fire(w))}set orthogonalStartSash(w){if(this._orthogonalStartSash!==w){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),w){const D=O=>{this.orthogonalStartDragHandleDisposables.clear(),O!==0&&(this._orthogonalStartDragHandle=append$1(this.el,$$8(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(toDisposable(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new DomEmitter(this._orthogonalStartDragHandle,"mouseenter")).event(()=>Sash.onMouseEnter(w),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new DomEmitter(this._orthogonalStartDragHandle,"mouseleave")).event(()=>Sash.onMouseLeave(w),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(w.onDidEnablementChange.event(D,this)),D(w.state)}this._orthogonalStartSash=w}}set orthogonalEndSash(w){if(this._orthogonalEndSash!==w){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),w){const D=O=>{this.orthogonalEndDragHandleDisposables.clear(),O!==0&&(this._orthogonalEndDragHandle=append$1(this.el,$$8(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(toDisposable(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new DomEmitter(this._orthogonalEndDragHandle,"mouseenter")).event(()=>Sash.onMouseEnter(w),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new DomEmitter(this._orthogonalEndDragHandle,"mouseleave")).event(()=>Sash.onMouseLeave(w),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(w.onDidEnablementChange.event(D,this)),D(w.state)}this._orthogonalEndSash=w}}constructor(w,D,O){super(),this.hoverDelay=globalHoverDelay,this.hoverDelayer=this._register(new Delayer(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new Emitter$1),this._onDidStart=this._register(new Emitter$1),this._onDidChange=this._register(new Emitter$1),this._onDidReset=this._register(new Emitter$1),this._onDidEnd=this._register(new Emitter$1),this.orthogonalStartSashDisposables=this._register(new DisposableStore),this.orthogonalStartDragHandleDisposables=this._register(new DisposableStore),this.orthogonalEndSashDisposables=this._register(new DisposableStore),this.orthogonalEndDragHandleDisposables=this._register(new DisposableStore),this.onDidStart=this._onDidStart.event,this.onDidChange=this._onDidChange.event,this.onDidReset=this._onDidReset.event,this.onDidEnd=this._onDidEnd.event,this.linkedSash=void 0,this.el=append$1(w,$$8(".monaco-sash")),O.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${O.orthogonalEdge}`),isMacintosh&&this.el.classList.add("mac");const W=this._register(new DomEmitter(this.el,"mousedown")).event;this._register(W(X=>this.onPointerStart(X,new MouseEventFactory(w)),this));const U=this._register(new DomEmitter(this.el,"dblclick")).event;this._register(U(this.onPointerDoublePress,this));const K=this._register(new DomEmitter(this.el,"mouseenter")).event;this._register(K(()=>Sash.onMouseEnter(this)));const q=this._register(new DomEmitter(this.el,"mouseleave")).event;this._register(q(()=>Sash.onMouseLeave(this))),this._register(Gesture.addTarget(this.el));const G=this._register(new DomEmitter(this.el,EventType.Start)).event;this._register(G(X=>this.onPointerStart(X,new GestureEventFactory(this.el)),this));const Q=this._register(new DomEmitter(this.el,EventType.Tap)).event;let Y;this._register(Q(X=>{if(Y){clearTimeout(Y),Y=void 0,this.onPointerDoublePress(X);return}clearTimeout(Y),Y=setTimeout(()=>Y=void 0,250)},this)),typeof O.size=="number"?(this.size=O.size,O.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=globalSize,this._register(onDidChangeGlobalSize.event(X=>{this.size=X,this.layout()}))),this._register(onDidChangeHoverDelay.event(X=>this.hoverDelay=X)),this.layoutProvider=D,this.orthogonalStartSash=O.orthogonalStartSash,this.orthogonalEndSash=O.orthogonalEndSash,this.orientation=O.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",DEBUG),this.layout()}onPointerStart(w,D){EventHelper.stop(w);let O=!1;if(!w.__orthogonalSashEvent){const ie=this.getOrthogonalSash(w);ie&&(O=!0,w.__orthogonalSashEvent=!0,ie.onPointerStart(w,new OrthogonalPointerEventFactory(D)))}if(this.linkedSash&&!w.__linkedSashEvent&&(w.__linkedSashEvent=!0,this.linkedSash.onPointerStart(w,new OrthogonalPointerEventFactory(D))),!this.state)return;const W=this.el.ownerDocument.getElementsByTagName("iframe");for(const ie of W)ie.classList.add(PointerEventsDisabledCssClass);const U=w.pageX,K=w.pageY,q=w.altKey,G={startX:U,currentX:U,startY:K,currentY:K,altKey:q};this.el.classList.add("active"),this._onDidStart.fire(G);const Q=createStyleSheet(this.el),Y=()=>{let ie="";O?ie="all-scroll":this.orientation===1?this.state===1?ie="s-resize":this.state===2?ie="n-resize":ie=isMacintosh?"row-resize":"ns-resize":this.state===1?ie="e-resize":this.state===2?ie="w-resize":ie=isMacintosh?"col-resize":"ew-resize",Q.textContent=`* { cursor: ${ie} !important; }`},X=new DisposableStore;Y(),O||this.onDidEnablementChange.event(Y,null,X);const J=ie=>{EventHelper.stop(ie,!1);const se={startX:U,currentX:ie.pageX,startY:K,currentY:ie.pageY,altKey:q};this._onDidChange.fire(se)},te=ie=>{EventHelper.stop(ie,!1),Q.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),X.dispose();for(const se of W)se.classList.remove(PointerEventsDisabledCssClass)};D.onPointerMove(J,null,X),D.onPointerUp(te,null,X),X.add(D)}onPointerDoublePress(w){const D=this.getOrthogonalSash(w);D&&D._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(w,D=!1){w.el.classList.contains("active")?(w.hoverDelayer.cancel(),w.el.classList.add("hover")):w.hoverDelayer.trigger(()=>w.el.classList.add("hover"),w.hoverDelay).then(void 0,()=>{}),!D&&w.linkedSash&&Sash.onMouseEnter(w.linkedSash,!0)}static onMouseLeave(w,D=!1){w.hoverDelayer.cancel(),w.el.classList.remove("hover"),!D&&w.linkedSash&&Sash.onMouseLeave(w.linkedSash,!0)}clearSashHoverState(){Sash.onMouseLeave(this)}layout(){if(this.orientation===0){const w=this.layoutProvider;this.el.style.left=w.getVerticalSashLeft(this)-this.size/2+"px",w.getVerticalSashTop&&(this.el.style.top=w.getVerticalSashTop(this)+"px"),w.getVerticalSashHeight&&(this.el.style.height=w.getVerticalSashHeight(this)+"px")}else{const w=this.layoutProvider;this.el.style.top=w.getHorizontalSashTop(this)-this.size/2+"px",w.getHorizontalSashLeft&&(this.el.style.left=w.getHorizontalSashLeft(this)+"px"),w.getHorizontalSashWidth&&(this.el.style.width=w.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(w){const D=w.initialTarget??w.target;if(!(!D||!isHTMLElement(D))&&D.classList.contains("orthogonal-drag-handle"))return D.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}}class ResizableHTMLElement{constructor(){this._onDidWillResize=new Emitter$1,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new Emitter$1,this.onDidResize=this._onDidResize.event,this._sashListener=new DisposableStore,this._size=new Dimension(0,0),this._minSize=new Dimension(0,0),this._maxSize=new Dimension(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new Sash(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new Sash(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new Sash(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:OrthogonalEdge.North}),this._southSash=new Sash(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:OrthogonalEdge.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let w,D=0,O=0;this._sashListener.add(Event$1.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{w===void 0&&(this._onDidWillResize.fire(),w=this._size,D=0,O=0)})),this._sashListener.add(Event$1.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{w!==void 0&&(w=void 0,D=0,O=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(W=>{w&&(O=W.currentX-W.startX,this.layout(w.height+D,w.width+O),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(W=>{w&&(O=-(W.currentX-W.startX),this.layout(w.height+D,w.width+O),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(W=>{w&&(D=-(W.currentY-W.startY),this.layout(w.height+D,w.width+O),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(W=>{w&&(D=W.currentY-W.startY,this.layout(w.height+D,w.width+O),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(Event$1.any(this._eastSash.onDidReset,this._westSash.onDidReset)(W=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(Event$1.any(this._northSash.onDidReset,this._southSash.onDidReset)(W=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(w,D,O,W){this._northSash.state=w?3:0,this._eastSash.state=D?3:0,this._southSash.state=O?3:0,this._westSash.state=W?3:0}layout(w=this.size.height,D=this.size.width){const{height:O,width:W}=this._minSize,{height:U,width:K}=this._maxSize;w=Math.max(O,Math.min(U,w)),D=Math.max(W,Math.min(K,D));const q=new Dimension(D,w);Dimension.equals(q,this._size)||(this.domNode.style.height=w+"px",this.domNode.style.width=D+"px",this._size=q,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(w){this._maxSize=w}get maxSize(){return this._maxSize}set minSize(w){this._minSize=w}get minSize(){return this._minSize}set preferredSize(w){this._preferredSize=w}get preferredSize(){return this._preferredSize}}const IOpenerService=createDecorator("openerService");function extractSelection(F){let w;const D=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(F.fragment);return D&&(w={startLineNumber:parseInt(D[1]),startColumn:D[2]?parseInt(D[2]):1,endLineNumber:D[4]?parseInt(D[4]):void 0,endColumn:D[4]?D[5]?parseInt(D[5]):1:void 0},F=F.with({fragment:""})),{selection:w,uri:F}}var __decorate$O=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$M=function(F,w){return function(D,O){w(D,O,F)}},MarkdownRenderer_1;let MarkdownRenderer=class{static{MarkdownRenderer_1=this}static{this._ttpTokenizer=createTrustedTypesPolicy("tokenizeToString",{createHTML(w){return w}})}constructor(w,D,O){this._options=w,this._languageService=D,this._openerService=O,this._onDidRenderAsync=new Emitter$1,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(w,D,O){if(!w)return{element:document.createElement("span"),dispose:()=>{}};const W=new DisposableStore,U=W.add(renderMarkdown(w,{...this._getRenderOptions(w,W),...D},O));return U.element.classList.add("rendered-markdown"),{element:U.element,dispose:()=>W.dispose()}}_getRenderOptions(w,D){return{codeBlockRenderer:async(O,W)=>{let U;O?U=this._languageService.getLanguageIdByLanguageName(O):this._options.editor&&(U=this._options.editor.getModel()?.getLanguageId()),U||(U=PLAINTEXT_LANGUAGE_ID);const K=await tokenizeToString(this._languageService,W,U),q=document.createElement("span");if(q.innerHTML=MarkdownRenderer_1._ttpTokenizer?.createHTML(K)??K,this._options.editor){const G=this._options.editor.getOption(50);applyFontInfo(q,G)}else this._options.codeBlockFontFamily&&(q.style.fontFamily=this._options.codeBlockFontFamily);return this._options.codeBlockFontSize!==void 0&&(q.style.fontSize=this._options.codeBlockFontSize),q},asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:O=>openLinkFromMarkdown(this._openerService,O,w.isTrusted),disposables:D}}}};MarkdownRenderer=MarkdownRenderer_1=__decorate$O([__param$M(1,ILanguageService),__param$M(2,IOpenerService)],MarkdownRenderer);async function openLinkFromMarkdown(F,w,D){try{return await F.open(w,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:toAllowCommandsOption(D)})}catch(O){return onUnexpectedError(O),!1}}function toAllowCommandsOption(F){return F===!0?!0:F&&Array.isArray(F.enabledCommands)?F.enabledCommands:!1}var __decorate$N=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$L=function(F,w){return function(D,O){w(D,O,F)}};function canExpandCompletionItem(F){return!!F&&!!(F.completion.documentation||F.completion.detail&&F.completion.detail!==F.completion.label)}let SuggestDetailsWidget=class{constructor(w,D){this._editor=w,this._onDidClose=new Emitter$1,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new Emitter$1,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new DisposableStore,this._renderDisposeable=new DisposableStore,this._borderWidth=1,this._size=new Dimension(330,0),this.domNode=$$8(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=D.createInstance(MarkdownRenderer,{editor:w}),this._body=$$8(".body"),this._scrollbar=new DomScrollableElement(this._body,{alwaysConsumeMouseWheel:!0}),append$1(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=append$1(this._body,$$8(".header")),this._close=append$1(this._header,$$8("span"+ThemeIcon.asCSSSelector(Codicon.close))),this._close.title=localize("details.close","Close"),this._type=append$1(this._header,$$8("p.type")),this._docs=append$1(this._body,$$8("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration(O=>{O.hasChanged(50)&&this._configureFont()}))}dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){const w=this._editor.getOptions(),D=w.get(50),O=D.getMassagedFontFamily(),W=w.get(120)||D.fontSize,U=w.get(121)||D.lineHeight,K=D.fontWeight,q=`${W}px`,G=`${U}px`;this.domNode.style.fontSize=q,this.domNode.style.lineHeight=`${U/W}`,this.domNode.style.fontWeight=K,this.domNode.style.fontFeatureSettings=D.fontFeatureSettings,this._type.style.fontFamily=O,this._close.style.height=G,this._close.style.width=G}getLayoutInfo(){const w=this._editor.getOption(121)||this._editor.getOption(50).lineHeight,D=this._borderWidth,O=D*2;return{lineHeight:w,borderWidth:D,borderHeight:O,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=localize("loading","Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,this.getLayoutInfo().lineHeight*2),this._onDidChangeContents.fire(this)}renderItem(w,D){this._renderDisposeable.clear();let{detail:O,documentation:W}=w.completion;if(D){let U="";U+=`score: ${w.score[0]}
`,U+=`prefix: ${w.word??"(no prefix)"}
`,U+=`word: ${w.completion.filterText?w.completion.filterText+" (filterText)":w.textLabel}
`,U+=`distance: ${w.distance} (localityBonus-setting)
`,U+=`index: ${w.idx}, based on ${w.completion.sortText&&`sortText: "${w.completion.sortText}"`||"label"}
`,U+=`commit_chars: ${w.completion.commitCharacters?.join("")}
`,W=new MarkdownString().appendCodeblock("empty",U),O=`Provider: ${w.provider._debugDisplayName}`}if(!D&&!canExpandCompletionItem(w)){this.clearContents();return}if(this.domNode.classList.remove("no-docs","no-type"),O){const U=O.length>1e5?`${O.substr(0,1e5)}…`:O;this._type.textContent=U,this._type.title=U,show(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gmi.test(U))}else clearNode(this._type),this._type.title="",hide(this._type),this.domNode.classList.add("no-type");if(clearNode(this._docs),typeof W=="string")this._docs.classList.remove("markdown-docs"),this._docs.textContent=W;else if(W){this._docs.classList.add("markdown-docs"),clearNode(this._docs);const U=this._markdownRenderer.render(W);this._docs.appendChild(U.element),this._renderDisposeable.add(U),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=U=>{U.preventDefault(),U.stopPropagation()},this._close.onclick=U=>{U.preventDefault(),U.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get isEmpty(){return this.domNode.classList.contains("no-docs")}get size(){return this._size}layout(w,D){const O=new Dimension(w,D);Dimension.equals(O,this._size)||(this._size=O,size(this.domNode,w,D)),this._scrollbar.scanDomNode()}scrollDown(w=8){this._body.scrollTop+=w}scrollUp(w=8){this._body.scrollTop-=w}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(w){this._borderWidth=w}get borderWidth(){return this._borderWidth}};SuggestDetailsWidget=__decorate$N([__param$L(1,IInstantiationService)],SuggestDetailsWidget);class SuggestDetailsOverlay{constructor(w,D){this.widget=w,this._editor=D,this.allowEditorOverflow=!0,this._disposables=new DisposableStore,this._added=!1,this._preferAlignAtTop=!0,this._resizable=new ResizableHTMLElement,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(w.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let O,W,U=0,K=0;this._disposables.add(this._resizable.onDidWillResize(()=>{O=this._topLeft,W=this._resizable.size})),this._disposables.add(this._resizable.onDidResize(q=>{if(O&&W){this.widget.layout(q.dimension.width,q.dimension.height);let G=!1;q.west&&(K=W.width-q.dimension.width,G=!0),q.north&&(U=W.height-q.dimension.height,G=!0),G&&this._applyTopLeft({top:O.top+U,left:O.left+K})}q.done&&(O=void 0,W=void 0,U=0,K=0,this._userSize=q.dimension)})),this._disposables.add(this.widget.onDidChangeContents(()=>{this._anchorBox&&this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,this._preferAlignAtTop)}))}dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return this._topLeft?{preference:this._topLeft}:null}show(){this._added||(this._editor.addOverlayWidget(this),this._added=!0)}hide(w=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),w&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(w,D){const O=w.getBoundingClientRect();this._anchorBox=O,this._preferAlignAtTop=D,this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,D)}_placeAtAnchor(w,D,O){const W=getClientArea(this.getDomNode().ownerDocument.body),U=this.widget.getLayoutInfo(),K=new Dimension(220,2*U.lineHeight),q=w.top,G=function(){const ue=W.width-(w.left+w.width+U.borderWidth+U.horizontalPadding),pe=-U.borderWidth+w.left+w.width,fe=new Dimension(ue,W.height-w.top-U.borderHeight-U.verticalPadding),Ce=fe.with(void 0,w.top+w.height-U.borderHeight-U.verticalPadding);return{top:q,left:pe,fit:ue-D.width,maxSizeTop:fe,maxSizeBottom:Ce,minSize:K.with(Math.min(ue,K.width))}}(),Q=function(){const ue=w.left-U.borderWidth-U.horizontalPadding,pe=Math.max(U.horizontalPadding,w.left-D.width-U.borderWidth),fe=new Dimension(ue,W.height-w.top-U.borderHeight-U.verticalPadding),Ce=fe.with(void 0,w.top+w.height-U.borderHeight-U.verticalPadding);return{top:q,left:pe,fit:ue-D.width,maxSizeTop:fe,maxSizeBottom:Ce,minSize:K.with(Math.min(ue,K.width))}}(),Y=function(){const ue=w.left,pe=-U.borderWidth+w.top+w.height,fe=new Dimension(w.width-U.borderHeight,W.height-w.top-w.height-U.verticalPadding);return{top:pe,left:ue,fit:fe.height-D.height,maxSizeBottom:fe,maxSizeTop:fe,minSize:K.with(fe.width)}}(),X=[G,Q,Y],J=X.find(ue=>ue.fit>=0)??X.sort((ue,pe)=>pe.fit-ue.fit)[0],te=w.top+w.height-U.borderHeight;let ie,se=D.height;const re=Math.max(J.maxSizeTop.height,J.maxSizeBottom.height);se>re&&(se=re);let ae;O?se<=J.maxSizeTop.height?(ie=!0,ae=J.maxSizeTop):(ie=!1,ae=J.maxSizeBottom):se<=J.maxSizeBottom.height?(ie=!1,ae=J.maxSizeBottom):(ie=!0,ae=J.maxSizeTop);let{top:le,left:de}=J;!ie&&se>w.height&&(le=te-se);const oe=this._editor.getDomNode();if(oe){const ue=oe.getBoundingClientRect();le-=ue.top,de-=ue.left}this._applyTopLeft({left:de,top:le}),this._resizable.enableSashes(!ie,J===G,ie,J!==G),this._resizable.minSize=J.minSize,this._resizable.maxSize=ae,this._resizable.layout(se,Math.min(ae.width,D.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(w){this._topLeft=w,this._editor.layoutOverlayWidget(this)}}class HighlightedLabel extends Disposable{constructor(w,D){super(),this.options=D,this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.supportIcons=D?.supportIcons??!1,this.domNode=append$1(w,$$8("span.monaco-highlighted-label"))}get element(){return this.domNode}set(w,D=[],O="",W){w||(w=""),W&&(w=HighlightedLabel.escapeNewLines(w,D)),!(this.didEverRender&&this.text===w&&this.title===O&&equals(this.highlights,D))&&(this.text=w,this.title=O,this.highlights=D,this.render())}render(){const w=[];let D=0;for(const O of this.highlights){if(O.end===O.start)continue;if(D<O.start){const K=this.text.substring(D,O.start);this.supportIcons?w.push(...renderLabelWithIcons(K)):w.push(K),D=O.start}const W=this.text.substring(D,O.end),U=$$8("span.highlight",void 0,...this.supportIcons?renderLabelWithIcons(W):[W]);O.extraClasses&&U.classList.add(...O.extraClasses),w.push(U),D=O.end}if(D<this.text.length){const O=this.text.substring(D);this.supportIcons?w.push(...renderLabelWithIcons(O)):w.push(O)}if(reset(this.domNode,...w),this.options?.hoverDelegate?.showNativeHover)this.domNode.title=this.title;else if(!this.customHover&&this.title!==""){const O=this.options?.hoverDelegate??getDefaultHoverDelegate("mouse");this.customHover=this._register(getBaseLayerHoverDelegate().setupManagedHover(O,this.domNode,this.title))}else this.customHover&&this.customHover.update(this.title);this.didEverRender=!0}static escapeNewLines(w,D){let O=0,W=0;return w.replace(/\r\n|\r|\n/g,(U,K)=>{W=U===`\r
`?-1:0,K+=O;for(const q of D)q.end<=K||(q.start>=K&&(q.start+=W),q.end>=K&&(q.end+=W));return O+=W,"⏎"})}}class FastLabelNode{constructor(w){this._element=w}get element(){return this._element}set textContent(w){this.disposed||w===this._textContent||(this._textContent=w,this._element.textContent=w)}set classNames(w){this.disposed||equals(w,this._classNames)||(this._classNames=w,this._element.classList.value="",this._element.classList.add(...w))}set empty(w){this.disposed||w===this._empty||(this._empty=w,this._element.style.marginLeft=w?"0":"")}dispose(){this.disposed=!0}}class IconLabel extends Disposable{constructor(w,D){super(),this.customHovers=new Map,this.creationOptions=D,this.domNode=this._register(new FastLabelNode(append$1(w,$$8(".monaco-icon-label")))),this.labelContainer=append$1(this.domNode.element,$$8(".monaco-icon-label-container")),this.nameContainer=append$1(this.labelContainer,$$8("span.monaco-icon-name-container")),D?.supportHighlights||D?.supportIcons?this.nameNode=this._register(new LabelWithHighlights(this.nameContainer,!!D.supportIcons)):this.nameNode=new Label(this.nameContainer),this.hoverDelegate=D?.hoverDelegate??getDefaultHoverDelegate("mouse")}get element(){return this.domNode.element}setLabel(w,D,O){const W=["monaco-icon-label"],U=["monaco-icon-label-container"];let K="";O&&(O.extraClasses&&W.push(...O.extraClasses),O.italic&&W.push("italic"),O.strikethrough&&W.push("strikethrough"),O.disabledCommand&&U.push("disabled"),O.title&&(typeof O.title=="string"?K+=O.title:K+=w));const q=this.domNode.element.querySelector(".monaco-icon-label-iconpath");if(O?.iconPath){let G;!q||!isHTMLElement(q)?(G=$$8(".monaco-icon-label-iconpath"),this.domNode.element.prepend(G)):G=q,G.style.backgroundImage=asCSSUrl(O?.iconPath)}else q&&q.remove();if(this.domNode.classNames=W,this.domNode.element.setAttribute("aria-label",K),this.labelContainer.classList.value="",this.labelContainer.classList.add(...U),this.setupHover(O?.descriptionTitle?this.labelContainer:this.element,O?.title),this.nameNode.setLabel(w,O),D||this.descriptionNode){const G=this.getOrCreateDescriptionNode();G instanceof HighlightedLabel?(G.set(D||"",O?O.descriptionMatches:void 0,void 0,O?.labelEscapeNewLines),this.setupHover(G.element,O?.descriptionTitle)):(G.textContent=D&&O?.labelEscapeNewLines?HighlightedLabel.escapeNewLines(D,[]):D||"",this.setupHover(G.element,O?.descriptionTitle||""),G.empty=!D)}if(O?.suffix||this.suffixNode){const G=this.getOrCreateSuffixNode();G.textContent=O?.suffix??""}}setupHover(w,D){const O=this.customHovers.get(w);if(O&&(O.dispose(),this.customHovers.delete(w)),!D){w.removeAttribute("title");return}if(this.hoverDelegate.showNativeHover){let U=function(K,q){isString$1(q)?K.title=stripIcons(q):q?.markdownNotSupportedFallback?K.title=q.markdownNotSupportedFallback:K.removeAttribute("title")};var W=U;U(w,D)}else{const U=getBaseLayerHoverDelegate().setupManagedHover(this.hoverDelegate,w,D);U&&this.customHovers.set(w,U)}}dispose(){super.dispose();for(const w of this.customHovers.values())w.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){const w=this._register(new FastLabelNode(after(this.nameContainer,$$8("span.monaco-icon-suffix-container"))));this.suffixNode=this._register(new FastLabelNode(append$1(w.element,$$8("span.label-suffix"))))}return this.suffixNode}getOrCreateDescriptionNode(){if(!this.descriptionNode){const w=this._register(new FastLabelNode(append$1(this.labelContainer,$$8("span.monaco-icon-description-container"))));this.creationOptions?.supportDescriptionHighlights?this.descriptionNode=this._register(new HighlightedLabel(append$1(w.element,$$8("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons})):this.descriptionNode=this._register(new FastLabelNode(append$1(w.element,$$8("span.label-description"))))}return this.descriptionNode}}class Label{constructor(w){this.container=w,this.label=void 0,this.singleLabel=void 0}setLabel(w,D){if(!(this.label===w&&equals(this.options,D)))if(this.label=w,this.options=D,typeof w=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=append$1(this.container,$$8("a.label-name",{id:D?.domId}))),this.singleLabel.textContent=w;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let O=0;O<w.length;O++){const W=w[O],U=D?.domId&&`${D?.domId}_${O}`;append$1(this.container,$$8("a.label-name",{id:U,"data-icon-label-count":w.length,"data-icon-label-index":O,role:"treeitem"},W)),O<w.length-1&&append$1(this.container,$$8("span.label-separator",void 0,D?.separator||"/"))}}}}function splitMatches(F,w,D){if(!D)return;let O=0;return F.map(W=>{const U={start:O,end:O+W.length},K=D.map(q=>Range$1.intersect(U,q)).filter(q=>!Range$1.isEmpty(q)).map(({start:q,end:G})=>({start:q-O,end:G-O}));return O=U.end+w.length,K})}class LabelWithHighlights extends Disposable{constructor(w,D){super(),this.container=w,this.supportIcons=D,this.label=void 0,this.singleLabel=void 0}setLabel(w,D){if(!(this.label===w&&equals(this.options,D)))if(this.label=w,this.options=D,typeof w=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new HighlightedLabel(append$1(this.container,$$8("a.label-name",{id:D?.domId})),{supportIcons:this.supportIcons}))),this.singleLabel.set(w,D?.matches,void 0,D?.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;const O=D?.separator||"/",W=splitMatches(w,O,D?.matches);for(let U=0;U<w.length;U++){const K=w[U],q=W?W[U]:void 0,G=D?.domId&&`${D?.domId}_${U}`,Q=$$8("a.label-name",{id:G,"data-icon-label-count":w.length,"data-icon-label-index":U,role:"treeitem"});this._register(new HighlightedLabel(append$1(this.container,Q),{supportIcons:this.supportIcons})).set(K,q,void 0,D?.labelEscapeNewLines),U<w.length-1&&append$1(Q,$$8("span.label-separator",void 0,O))}}}}var FileKind;(function(F){F[F.FILE=0]="FILE",F[F.FOLDER=1]="FOLDER",F[F.ROOT_FOLDER=2]="ROOT_FOLDER"})(FileKind||(FileKind={}));const fileIconDirectoryRegex=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function getIconClasses(F,w,D,O,W){if(ThemeIcon.isThemeIcon(W))return[`codicon-${W.id}`,"predefined-file-icon"];if(URI.isUri(W))return[];const U=O===FileKind.ROOT_FOLDER?["rootfolder-icon"]:O===FileKind.FOLDER?["folder-icon"]:["file-icon"];if(D){let K;if(D.scheme===Schemas.data)K=DataUri.parseMetaData(D).get(DataUri.META_DATA_LABEL);else{const q=D.path.match(fileIconDirectoryRegex);q?(K=cssEscape(q[2].toLowerCase()),q[1]&&U.push(`${cssEscape(q[1].toLowerCase())}-name-dir-icon`)):K=cssEscape(D.authority.toLowerCase())}if(O===FileKind.ROOT_FOLDER)U.push(`${K}-root-name-folder-icon`);else if(O===FileKind.FOLDER)U.push(`${K}-name-folder-icon`);else{if(K){if(U.push(`${K}-name-file-icon`),U.push("name-file-icon"),K.length<=255){const G=K.split(".");for(let Q=1;Q<G.length;Q++)U.push(`${G.slice(Q).join(".")}-ext-file-icon`)}U.push("ext-file-icon")}const q=detectLanguageId(F,w,D);q&&U.push(`${cssEscape(q)}-lang-file-icon`)}}return U}function detectLanguageId(F,w,D){if(!D)return null;let O=null;if(D.scheme===Schemas.data){const U=DataUri.parseMetaData(D).get(DataUri.META_DATA_MIME);U&&(O=w.getLanguageIdByMimeType(U))}else{const W=F.getModel(D);W&&(O=W.getLanguageId())}return O&&O!==PLAINTEXT_LANGUAGE_ID?O:w.guessLanguageIdByFilepathOrFirstLine(D)}function cssEscape(F){return F.replace(/[\s]/g,"/")}const Extensions$1={IconContribution:"base.contributions.icons"};var IconContribution;(function(F){function w(D,O){let W=D.defaults;for(;ThemeIcon.isThemeIcon(W);){const U=iconRegistry.getIcon(W.id);if(!U)return;W=U.defaults}return W}F.getDefinition=w})(IconContribution||(IconContribution={}));var IconFontDefinition;(function(F){function w(O){return{weight:O.weight,style:O.style,src:O.src.map(W=>({format:W.format,location:W.location.toString()}))}}F.toJSONObject=w;function D(O){const W=U=>isString$1(U)?U:void 0;if(O&&Array.isArray(O.src)&&O.src.every(U=>isString$1(U.format)&&isString$1(U.location)))return{weight:W(O.weight),style:W(O.style),src:O.src.map(U=>({format:U.format,location:URI.parse(U.location)}))}}F.fromJSONObject=D})(IconFontDefinition||(IconFontDefinition={}));class IconRegistry{constructor(){this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:localize("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:localize("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${ThemeIcon.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(w,D,O,W){const U=this.iconsById[w];if(U){if(O&&!U.description){U.description=O,this.iconSchema.properties[w].markdownDescription=`${O} $(${w})`;const G=this.iconReferenceSchema.enum.indexOf(w);G!==-1&&(this.iconReferenceSchema.enumDescriptions[G]=O),this._onDidChange.fire()}return U}const K={id:w,description:O,defaults:D,deprecationMessage:W};this.iconsById[w]=K;const q={$ref:"#/definitions/icons"};return W&&(q.deprecationMessage=W),O&&(q.markdownDescription=`${O}: $(${w})`),this.iconSchema.properties[w]=q,this.iconReferenceSchema.enum.push(w),this.iconReferenceSchema.enumDescriptions.push(O||""),this._onDidChange.fire(),{id:w}}getIcons(){return Object.keys(this.iconsById).map(w=>this.iconsById[w])}getIcon(w){return this.iconsById[w]}getIconSchema(){return this.iconSchema}toString(){const w=(U,K)=>U.id.localeCompare(K.id),D=U=>{for(;ThemeIcon.isThemeIcon(U.defaults);)U=this.iconsById[U.defaults.id];return`codicon codicon-${U?U.id:""}`},O=[];O.push("| preview     | identifier                        | default codicon ID                | description"),O.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const W=Object.keys(this.iconsById).map(U=>this.iconsById[U]);for(const U of W.filter(K=>!!K.description).sort(w))O.push(`|<i class="${D(U)}"></i>|${U.id}|${ThemeIcon.isThemeIcon(U.defaults)?U.defaults.id:U.id}|${U.description||""}|`);O.push("| preview     | identifier                        "),O.push("| ----------- | --------------------------------- |");for(const U of W.filter(K=>!ThemeIcon.isThemeIcon(K.defaults)).sort(w))O.push(`|<i class="${D(U)}"></i>|${U.id}|`);return O.join(`
`)}}const iconRegistry=new IconRegistry;Registry.add(Extensions$1.IconContribution,iconRegistry);function registerIcon(F,w,D,O){return iconRegistry.registerIcon(F,w,D,O)}function getIconRegistry(){return iconRegistry}function initialize(){const F=getCodiconFontCharacters();for(const w in F){const D="\\"+F[w].toString(16);iconRegistry.registerIcon(w,{fontCharacter:D})}}initialize();const iconsSchemaId="vscode://schemas/icons",schemaRegistry=Registry.as(Extensions$6.JSONContribution);schemaRegistry.registerSchema(iconsSchemaId,iconRegistry.getIconSchema());const delayer=new RunOnceScheduler(()=>schemaRegistry.notifySchemaChanged(iconsSchemaId),200);iconRegistry.onDidChange(()=>{delayer.isScheduled()||delayer.schedule()});registerIcon("widget-close",Codicon.close,localize("widgetClose","Icon for the close action in widgets."));registerIcon("goto-previous-location",Codicon.arrowUp,localize("previousChangeIcon","Icon for goto previous editor location."));registerIcon("goto-next-location",Codicon.arrowDown,localize("nextChangeIcon","Icon for goto next editor location."));ThemeIcon.modify(Codicon.sync,"spin");ThemeIcon.modify(Codicon.loading,"spin");var __decorate$M=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$K=function(F,w){return function(D,O){w(D,O,F)}};function getAriaId(F){return`suggest-aria-id:${F}`}const suggestMoreInfoIcon=registerIcon("suggest-more-info",Codicon.chevronRight,localize("suggestMoreInfoIcon","Icon for more information in the suggest widget.")),_completionItemColor=new class Bs{static{this._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/}static{this._regexStrict=new RegExp(`^${Bs._regexRelaxed.source}$`,"i")}extract(w,D){if(w.textLabel.match(Bs._regexStrict))return D[0]=w.textLabel,!0;if(w.completion.detail&&w.completion.detail.match(Bs._regexStrict))return D[0]=w.completion.detail,!0;if(w.completion.documentation){const O=typeof w.completion.documentation=="string"?w.completion.documentation:w.completion.documentation.value,W=Bs._regexRelaxed.exec(O);if(W&&(W.index===0||W.index+W[0].length===O.length))return D[0]=W[0],!0}return!1}};let ItemRenderer=class{constructor(w,D,O,W){this._editor=w,this._modelService=D,this._languageService=O,this._themeService=W,this._onDidToggleDetails=new Emitter$1,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(w){const D=new DisposableStore,O=w;O.classList.add("show-file-icons");const W=append$1(w,$$8(".icon")),U=append$1(W,$$8("span.colorspan")),K=append$1(w,$$8(".contents")),q=append$1(K,$$8(".main")),G=append$1(q,$$8(".icon-label.codicon")),Q=append$1(q,$$8("span.left")),Y=append$1(q,$$8("span.right")),X=new IconLabel(Q,{supportHighlights:!0,supportIcons:!0});D.add(X);const J=append$1(Q,$$8("span.signature-label")),te=append$1(Q,$$8("span.qualifier-label")),ie=append$1(Y,$$8("span.details-label")),se=append$1(Y,$$8("span.readMore"+ThemeIcon.asCSSSelector(suggestMoreInfoIcon)));return se.title=localize("readMore","Read More"),{root:O,left:Q,right:Y,icon:W,colorspan:U,iconLabel:X,iconContainer:G,parametersLabel:J,qualifierLabel:te,detailsLabel:ie,readMore:se,disposables:D,configureFont:()=>{const ae=this._editor.getOptions(),le=ae.get(50),de=le.getMassagedFontFamily(),oe=le.fontFeatureSettings,ue=ae.get(120)||le.fontSize,pe=ae.get(121)||le.lineHeight,fe=le.fontWeight,Ce=le.letterSpacing,we=`${ue}px`,Oe=`${pe}px`,Te=`${Ce}px`;O.style.fontSize=we,O.style.fontWeight=fe,O.style.letterSpacing=Te,q.style.fontFamily=de,q.style.fontFeatureSettings=oe,q.style.lineHeight=Oe,W.style.height=Oe,W.style.width=Oe,se.style.height=Oe,se.style.width=Oe}}}renderElement(w,D,O){O.configureFont();const{completion:W}=w;O.root.id=getAriaId(D),O.colorspan.style.backgroundColor="";const U={labelEscapeNewLines:!0,matches:createMatches(w.score)},K=[];if(W.kind===19&&_completionItemColor.extract(w,K))O.icon.className="icon customcolor",O.iconContainer.className="icon hide",O.colorspan.style.backgroundColor=K[0];else if(W.kind===20&&this._themeService.getFileIconTheme().hasFileIcons){O.icon.className="icon hide",O.iconContainer.className="icon hide";const q=getIconClasses(this._modelService,this._languageService,URI.from({scheme:"fake",path:w.textLabel}),FileKind.FILE),G=getIconClasses(this._modelService,this._languageService,URI.from({scheme:"fake",path:W.detail}),FileKind.FILE);U.extraClasses=q.length>G.length?q:G}else W.kind===23&&this._themeService.getFileIconTheme().hasFolderIcons?(O.icon.className="icon hide",O.iconContainer.className="icon hide",U.extraClasses=[getIconClasses(this._modelService,this._languageService,URI.from({scheme:"fake",path:w.textLabel}),FileKind.FOLDER),getIconClasses(this._modelService,this._languageService,URI.from({scheme:"fake",path:W.detail}),FileKind.FOLDER)].flat()):(O.icon.className="icon hide",O.iconContainer.className="",O.iconContainer.classList.add("suggest-icon",...ThemeIcon.asClassNameArray(CompletionItemKinds.toIcon(W.kind))));W.tags&&W.tags.indexOf(1)>=0&&(U.extraClasses=(U.extraClasses||[]).concat(["deprecated"]),U.matches=[]),O.iconLabel.setLabel(w.textLabel,void 0,U),typeof W.label=="string"?(O.parametersLabel.textContent="",O.detailsLabel.textContent=stripNewLines(W.detail||""),O.root.classList.add("string-label")):(O.parametersLabel.textContent=stripNewLines(W.label.detail||""),O.detailsLabel.textContent=stripNewLines(W.label.description||""),O.root.classList.remove("string-label")),this._editor.getOption(119).showInlineDetails?show(O.detailsLabel):hide(O.detailsLabel),canExpandCompletionItem(w)?(O.right.classList.add("can-expand-details"),show(O.readMore),O.readMore.onmousedown=q=>{q.stopPropagation(),q.preventDefault()},O.readMore.onclick=q=>{q.stopPropagation(),q.preventDefault(),this._onDidToggleDetails.fire()}):(O.right.classList.remove("can-expand-details"),hide(O.readMore),O.readMore.onmousedown=null,O.readMore.onclick=null)}disposeTemplate(w){w.disposables.dispose()}};ItemRenderer=__decorate$M([__param$K(1,IModelService),__param$K(2,ILanguageService),__param$K(3,IThemeService)],ItemRenderer);function stripNewLines(F){return F.replace(/\r\n|\r|\n/g,"")}var __decorate$L=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$J=function(F,w){return function(D,O){w(D,O,F)}},SuggestWidget_1;registerColor("editorSuggestWidget.background",editorWidgetBackground,localize("editorSuggestWidgetBackground","Background color of the suggest widget."));registerColor("editorSuggestWidget.border",editorWidgetBorder,localize("editorSuggestWidgetBorder","Border color of the suggest widget."));const editorSuggestWidgetForeground=registerColor("editorSuggestWidget.foreground",editorForeground,localize("editorSuggestWidgetForeground","Foreground color of the suggest widget."));registerColor("editorSuggestWidget.selectedForeground",quickInputListFocusForeground,localize("editorSuggestWidgetSelectedForeground","Foreground color of the selected entry in the suggest widget."));registerColor("editorSuggestWidget.selectedIconForeground",quickInputListFocusIconForeground,localize("editorSuggestWidgetSelectedIconForeground","Icon foreground color of the selected entry in the suggest widget."));const editorSuggestWidgetSelectedBackground=registerColor("editorSuggestWidget.selectedBackground",quickInputListFocusBackground,localize("editorSuggestWidgetSelectedBackground","Background color of the selected entry in the suggest widget."));registerColor("editorSuggestWidget.highlightForeground",listHighlightForeground,localize("editorSuggestWidgetHighlightForeground","Color of the match highlights in the suggest widget."));registerColor("editorSuggestWidget.focusHighlightForeground",listFocusHighlightForeground,localize("editorSuggestWidgetFocusHighlightForeground","Color of the match highlights in the suggest widget when an item is focused."));registerColor("editorSuggestWidgetStatus.foreground",transparent(editorSuggestWidgetForeground,.5),localize("editorSuggestWidgetStatusForeground","Foreground color of the suggest widget status."));class PersistedWidgetSize{constructor(w,D){this._service=w,this._key=`suggestWidget.size/${D.getEditorType()}/${D instanceof EmbeddedCodeEditorWidget}`}restore(){const w=this._service.get(this._key,0)??"";try{const D=JSON.parse(w);if(Dimension.is(D))return Dimension.lift(D)}catch{}}store(w){this._service.store(this._key,JSON.stringify(w),0,1)}reset(){this._service.remove(this._key,0)}}let SuggestWidget=class{static{SuggestWidget_1=this}static{this.LOADING_MESSAGE=localize("suggestWidget.loading","Loading...")}static{this.NO_SUGGESTIONS_MESSAGE=localize("suggestWidget.noSuggestions","No suggestions.")}constructor(w,D,O,W,U){this.editor=w,this._storageService=D,this._state=0,this._isAuto=!1,this._pendingLayout=new MutableDisposable,this._pendingShowDetails=new MutableDisposable,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new TimeoutTimer,this._disposables=new DisposableStore,this._onDidSelect=new PauseableEmitter,this._onDidFocus=new PauseableEmitter,this._onDidHide=new Emitter$1,this._onDidShow=new Emitter$1,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new Emitter$1,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new ResizableHTMLElement,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new SuggestContentWidget(this,w),this._persistedSize=new PersistedWidgetSize(D,w);class K{constructor(te,ie,se=!1,re=!1){this.persistedSize=te,this.currentSize=ie,this.persistHeight=se,this.persistWidth=re}}let q;this._disposables.add(this.element.onDidWillResize(()=>{this._contentWidget.lockPreference(),q=new K(this._persistedSize.restore(),this.element.size)})),this._disposables.add(this.element.onDidResize(J=>{if(this._resize(J.dimension.width,J.dimension.height),q&&(q.persistHeight=q.persistHeight||!!J.north||!!J.south,q.persistWidth=q.persistWidth||!!J.east||!!J.west),!!J.done){if(q){const{itemHeight:te,defaultSize:ie}=this.getLayoutInfo(),se=Math.round(te/2);let{width:re,height:ae}=this.element.size;(!q.persistHeight||Math.abs(q.currentSize.height-ae)<=se)&&(ae=q.persistedSize?.height??ie.height),(!q.persistWidth||Math.abs(q.currentSize.width-re)<=se)&&(re=q.persistedSize?.width??ie.width),this._persistedSize.store(new Dimension(re,ae))}this._contentWidget.unlockPreference(),q=void 0}})),this._messageElement=append$1(this.element.domNode,$$8(".message")),this._listElement=append$1(this.element.domNode,$$8(".tree"));const G=this._disposables.add(U.createInstance(SuggestDetailsWidget,this.editor));G.onDidClose(this.toggleDetails,this,this._disposables),this._details=new SuggestDetailsOverlay(G,this.editor);const Q=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(119).showIcons);Q();const Y=U.createInstance(ItemRenderer,this.editor);this._disposables.add(Y),this._disposables.add(Y.onDidToggleDetails(()=>this.toggleDetails())),this._list=new List("SuggestWidget",this._listElement,{getHeight:J=>this.getLayoutInfo().itemHeight,getTemplateId:J=>"suggestion"},[Y],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>localize("suggest","Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:J=>{let te=J.textLabel;if(typeof J.completion.label!="string"){const{detail:ae,description:le}=J.completion.label;ae&&le?te=localize("label.full","{0} {1}, {2}",te,ae,le):ae?te=localize("label.detail","{0} {1}",te,ae):le&&(te=localize("label.desc","{0}, {1}",te,le))}if(!J.isResolved||!this._isDetailsVisible())return te;const{documentation:ie,detail:se}=J.completion,re=format("{0}{1}",se||"",ie?typeof ie=="string"?ie:ie.value:"");return localize("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",te,re)}}}),this._list.style(getListStyles({listInactiveFocusBackground:editorSuggestWidgetSelectedBackground,listInactiveFocusOutline:activeContrastBorder})),this._status=U.createInstance(SuggestWidgetStatus,this.element.domNode,suggestWidgetStatusbarMenu);const X=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(119).showStatusBar);X(),this._disposables.add(W.onDidColorThemeChange(J=>this._onThemeChange(J))),this._onThemeChange(W.getColorTheme()),this._disposables.add(this._list.onMouseDown(J=>this._onListMouseDownOrTap(J))),this._disposables.add(this._list.onTap(J=>this._onListMouseDownOrTap(J))),this._disposables.add(this._list.onDidChangeSelection(J=>this._onListSelection(J))),this._disposables.add(this._list.onDidChangeFocus(J=>this._onListFocus(J))),this._disposables.add(this.editor.onDidChangeCursorSelection(()=>this._onCursorSelectionChanged())),this._disposables.add(this.editor.onDidChangeConfiguration(J=>{J.hasChanged(119)&&(X(),Q()),this._completionModel&&(J.hasChanged(50)||J.hasChanged(120)||J.hasChanged(121))&&this._list.splice(0,this._list.length,this._completionModel.items)})),this._ctxSuggestWidgetVisible=Context$1.Visible.bindTo(O),this._ctxSuggestWidgetDetailsVisible=Context$1.DetailsVisible.bindTo(O),this._ctxSuggestWidgetMultipleSuggestions=Context$1.MultipleSuggestions.bindTo(O),this._ctxSuggestWidgetHasFocusedSuggestion=Context$1.HasFocusedSuggestion.bindTo(O),this._disposables.add(addStandardDisposableListener(this._details.widget.domNode,"keydown",J=>{this._onDetailsKeydown.fire(J)})),this._disposables.add(this.editor.onMouseDown(J=>this._onEditorMouseDown(J)))}dispose(){this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),this._loadingTimeout?.dispose(),this._pendingLayout.dispose(),this._pendingShowDetails.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(w){this._details.widget.domNode.contains(w.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(w.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){this._state!==0&&this._contentWidget.layout()}_onListMouseDownOrTap(w){typeof w.element>"u"||typeof w.index>"u"||(w.browserEvent.preventDefault(),w.browserEvent.stopPropagation(),this._select(w.element,w.index))}_onListSelection(w){w.elements.length&&this._select(w.elements[0],w.indexes[0])}_select(w,D){const O=this._completionModel;O&&(this._onDidSelect.fire({item:w,index:D,model:O}),this.editor.focus())}_onThemeChange(w){this._details.widget.borderWidth=isHighContrast(w.type)?2:1}_onListFocus(w){if(this._ignoreFocusEvents)return;if(!w.elements.length){this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0}),this._ctxSuggestWidgetHasFocusedSuggestion.set(!1);return}if(!this._completionModel)return;this._ctxSuggestWidgetHasFocusedSuggestion.set(!0);const D=w.elements[0],O=w.indexes[0];D!==this._focusedItem&&(this._currentSuggestionDetails?.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=D,this._list.reveal(O),this._currentSuggestionDetails=createCancelablePromise(async W=>{const U=disposableTimeout(()=>{this._isDetailsVisible()&&this.showDetails(!0)},250),K=W.onCancellationRequested(()=>U.dispose());try{return await D.resolve(W)}finally{U.dispose(),K.dispose()}}),this._currentSuggestionDetails.then(()=>{O>=this._list.length||D!==this._list.element(O)||(this._ignoreFocusEvents=!0,this._list.splice(O,1,[D]),this._list.setFocus([O]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this.showDetails(!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:getAriaId(O)}))}).catch(onUnexpectedError)),this._onDidFocus.fire({item:D,index:O,model:this._completionModel})}_setState(w){if(this._state!==w)switch(this._state=w,this.element.domNode.classList.toggle("frozen",w===4),this.element.domNode.classList.remove("message"),w){case 0:hide(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._ctxSuggestWidgetHasFocusedSuggestion.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=SuggestWidget_1.LOADING_MESSAGE,hide(this._listElement,this._status.element),show(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,status(SuggestWidget_1.LOADING_MESSAGE);break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=SuggestWidget_1.NO_SUGGESTIONS_MESSAGE,hide(this._listElement,this._status.element),show(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,status(SuggestWidget_1.NO_SUGGESTIONS_MESSAGE);break;case 3:hide(this._messageElement),show(this._listElement,this._status.element),this._show();break;case 4:hide(this._messageElement),show(this._listElement,this._status.element),this._show();break;case 5:hide(this._messageElement),show(this._listElement,this._status.element),this._details.show(),this._show();break}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet(()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)},100)}showTriggered(w,D){this._state===0&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!w,this._isAuto||(this._loadingTimeout=disposableTimeout(()=>this._setState(1),D)))}showSuggestions(w,D,O,W,U){if(this._contentWidget.setPosition(this.editor.getPosition()),this._loadingTimeout?.dispose(),this._currentSuggestionDetails?.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==w&&(this._completionModel=w),O&&this._state!==2&&this._state!==0){this._setState(4);return}const K=this._completionModel.items.length,q=K===0;if(this._ctxSuggestWidgetMultipleSuggestions.set(K>1),q){this._setState(W?0:2),this._completionModel=void 0;return}this._focusedItem=void 0,this._onDidFocus.pause(),this._onDidSelect.pause();try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(O?4:3),this._list.reveal(D,0),this._list.setFocus(U?[]:[D])}finally{this._onDidFocus.resume(),this._onDidSelect.resume()}this._pendingLayout.value=runAtThisOrScheduleAtNextAnimationFrame(getWindow(this.element.domNode),()=>{this._pendingLayout.clear(),this._layout(this.element.size),this._details.widget.domNode.classList.remove("focused")})}focusSelected(){this._list.length>0&&this._list.setFocus([0])}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(this._state!==0&&this._state!==2&&this._state!==1&&this._completionModel&&this._list.getFocus().length>0)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){this._state===5?(this._setState(3),this._details.widget.domNode.classList.remove("focused")):this._state===3&&this._isDetailsVisible()&&(this._setState(5),this._details.widget.domNode.classList.add("focused"))}toggleDetails(){this._isDetailsVisible()?(this._pendingShowDetails.clear(),this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):(canExpandCompletionItem(this._list.getFocusedElements()[0])||this._explainMode)&&(this._state===3||this._state===5||this._state===4)&&(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this.showDetails(!1))}showDetails(w){this._pendingShowDetails.value=runAtThisOrScheduleAtNextAnimationFrame(getWindow(this.element.domNode),()=>{this._pendingShowDetails.clear(),this._details.show(),w?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._details.widget.isEmpty?this._details.hide():(this._positionDetails(),this.element.domNode.classList.add("shows-details")),this.editor.focus()})}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this.showDetails(!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){this._pendingLayout.clear(),this._pendingShowDetails.clear(),this._loadingTimeout?.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();const w=this._persistedSize.restore(),D=Math.ceil(this.getLayoutInfo().itemHeight*4.3);w&&w.height<D&&this._persistedSize.store(w.with(void 0,D))}isFrozen(){return this._state===4}_afterRender(w){if(w===null){this._isDetailsVisible()&&this._details.hide();return}this._state===2||this._state===1||(this._isDetailsVisible()&&!this._details.widget.isEmpty&&this._details.show(),this._positionDetails())}_layout(w){if(!this.editor.hasModel()||!this.editor.getDomNode())return;const D=getClientArea(this.element.domNode.ownerDocument.body),O=this.getLayoutInfo();w||(w=O.defaultSize);let W=w.height,U=w.width;if(this._status.element.style.height=`${O.itemHeight}px`,this._state===2||this._state===1)W=O.itemHeight+O.borderHeight,U=O.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new Dimension(U,W),this._contentWidget.setPreference(2);else{const K=D.width-O.borderHeight-2*O.horizontalPadding;U>K&&(U=K);const q=this._completionModel?this._completionModel.stats.pLabelLen*O.typicalHalfwidthCharacterWidth:U,G=O.statusBarHeight+this._list.contentHeight+O.borderHeight,Q=O.itemHeight+O.statusBarHeight,Y=getDomNodePagePosition(this.editor.getDomNode()),X=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),J=Y.top+X.top+X.height,te=Math.min(D.height-J-O.verticalPadding,G),ie=Y.top+X.top-O.verticalPadding,se=Math.min(ie,G);let re=Math.min(Math.max(se,te)+O.borderHeight,G);W===this._cappedHeight?.capped&&(W=this._cappedHeight.wanted),W<Q&&(W=Q),W>re&&(W=re),W>te||this._forceRenderingAbove&&ie>150?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),re=se):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),re=te),this.element.preferredSize=new Dimension(q,O.defaultSize.height),this.element.maxSize=new Dimension(K,re),this.element.minSize=new Dimension(220,Q),this._cappedHeight=W===G?{wanted:this._cappedHeight?.wanted??w.height,capped:W}:void 0}this._resize(U,W)}_resize(w,D){const{width:O,height:W}=this.element.maxSize;w=Math.min(O,w),D=Math.min(W,D);const{statusBarHeight:U}=this.getLayoutInfo();this._list.layout(D-U,w),this._listElement.style.height=`${D-U}px`,this.element.layout(D,w),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,this._contentWidget.getPosition()?.preference[0]===2)}getLayoutInfo(){const w=this.editor.getOption(50),D=clamp(this.editor.getOption(121)||w.lineHeight,8,1e3),O=!this.editor.getOption(119).showStatusBar||this._state===2||this._state===1?0:D,W=this._details.widget.borderWidth,U=2*W;return{itemHeight:D,statusBarHeight:O,borderWidth:W,borderHeight:U,typicalHalfwidthCharacterWidth:w.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new Dimension(430,O+12*D+U)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(w){this._storageService.store("expandSuggestionDocs",w,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};SuggestWidget=SuggestWidget_1=__decorate$L([__param$J(1,IStorageService),__param$J(2,IContextKeyService),__param$J(3,IThemeService),__param$J(4,IInstantiationService)],SuggestWidget);class SuggestContentWidget{constructor(w,D){this._widget=w,this._editor=D,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return this._hidden||!this._position||!this._preference?null:{position:this._position,preference:[this._preference]}}beforeRender(){const{height:w,width:D}=this._widget.element.size,{borderWidth:O,horizontalPadding:W}=this._widget.getLayoutInfo();return new Dimension(D+2*O+W,w+2*O)}afterRender(w){this._widget._afterRender(w)}setPreference(w){this._preferenceLocked||(this._preference=w)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(w){this._position=w}}var __decorate$K=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$I=function(F,w){return function(D,O){w(D,O,F)}},SuggestController_1;class LineSuffix{constructor(w,D){if(this._model=w,this._position=D,this._decorationOptions=ModelDecorationOptions.register({description:"suggest-line-suffix",stickiness:1}),w.getLineMaxColumn(D.lineNumber)!==D.column){const W=w.getOffsetAt(D),U=w.getPositionAt(W+1);w.changeDecorations(K=>{this._marker&&K.removeDecoration(this._marker),this._marker=K.addDecoration(Range$2.fromPositions(D,U),this._decorationOptions)})}}dispose(){this._marker&&!this._model.isDisposed()&&this._model.changeDecorations(w=>{w.removeDecoration(this._marker),this._marker=void 0})}delta(w){if(this._model.isDisposed()||this._position.lineNumber!==w.lineNumber)return 0;if(this._marker){const D=this._model.getDecorationRange(this._marker);return this._model.getOffsetAt(D.getStartPosition())-this._model.getOffsetAt(w)}else return this._model.getLineMaxColumn(w.lineNumber)-w.column}}let SuggestController=class{static{SuggestController_1=this}static{this.ID="editor.contrib.suggestController"}static get(w){return w.getContribution(SuggestController_1.ID)}constructor(w,D,O,W,U,K,q){this._memoryService=D,this._commandService=O,this._contextKeyService=W,this._instantiationService=U,this._logService=K,this._telemetryService=q,this._lineSuffix=new MutableDisposable,this._toDispose=new DisposableStore,this._selectors=new PriorityRegistry(X=>X.priority),this._onWillInsertSuggestItem=new Emitter$1,this.onWillInsertSuggestItem=this._onWillInsertSuggestItem.event,this.editor=w,this.model=U.createInstance(SuggestModel,this.editor),this._selectors.register({priority:0,select:(X,J,te)=>this._memoryService.select(X,J,te)});const G=Context$1.InsertMode.bindTo(W);G.set(w.getOption(119).insertMode),this._toDispose.add(this.model.onDidTrigger(()=>G.set(w.getOption(119).insertMode))),this.widget=this._toDispose.add(new WindowIdleValue(getWindow(w.getDomNode()),()=>{const X=this._instantiationService.createInstance(SuggestWidget,this.editor);this._toDispose.add(X),this._toDispose.add(X.onDidSelect(re=>this._insertSuggestion(re,0),this));const J=new CommitCharacterController(this.editor,X,this.model,re=>this._insertSuggestion(re,2));this._toDispose.add(J);const te=Context$1.MakesTextEdit.bindTo(this._contextKeyService),ie=Context$1.HasInsertAndReplaceRange.bindTo(this._contextKeyService),se=Context$1.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(toDisposable(()=>{te.reset(),ie.reset(),se.reset()})),this._toDispose.add(X.onDidFocus(({item:re})=>{const ae=this.editor.getPosition(),le=re.editStart.column,de=ae.column;let oe=!0;this.editor.getOption(1)==="smart"&&this.model.state===2&&!re.completion.additionalTextEdits&&!(re.completion.insertTextRules&4)&&de-le===re.completion.insertText.length&&(oe=this.editor.getModel().getValueInRange({startLineNumber:ae.lineNumber,startColumn:le,endLineNumber:ae.lineNumber,endColumn:de})!==re.completion.insertText),te.set(oe),ie.set(!Position$1.equals(re.editInsertEnd,re.editReplaceEnd)),se.set(!!re.provider.resolveCompletionItem||!!re.completion.documentation||re.completion.detail!==re.completion.label)})),this._toDispose.add(X.onDetailsKeyDown(re=>{if(re.toKeyCodeChord().equals(new KeyCodeChord(!0,!1,!1,!1,33))||isMacintosh&&re.toKeyCodeChord().equals(new KeyCodeChord(!1,!1,!1,!0,33))){re.stopPropagation();return}re.toKeyCodeChord().isModifierKey()||this.editor.focus()})),X})),this._overtypingCapturer=this._toDispose.add(new WindowIdleValue(getWindow(w.getDomNode()),()=>this._toDispose.add(new OvertypingCapturer(this.editor,this.model)))),this._alternatives=this._toDispose.add(new WindowIdleValue(getWindow(w.getDomNode()),()=>this._toDispose.add(new SuggestAlternatives(this.editor,this._contextKeyService)))),this._toDispose.add(U.createInstance(WordContextKey,w)),this._toDispose.add(this.model.onDidTrigger(X=>{this.widget.value.showTriggered(X.auto,X.shy?250:50),this._lineSuffix.value=new LineSuffix(this.editor.getModel(),X.position)})),this._toDispose.add(this.model.onDidSuggest(X=>{if(X.triggerOptions.shy)return;let J=-1;for(const ie of this._selectors.itemsOrderedByPriorityDesc)if(J=ie.select(this.editor.getModel(),this.editor.getPosition(),X.completionModel.items),J!==-1)break;if(J===-1&&(J=0),this.model.state===0)return;let te=!1;if(X.triggerOptions.auto){const ie=this.editor.getOption(119);ie.selectionMode==="never"||ie.selectionMode==="always"?te=ie.selectionMode==="never":ie.selectionMode==="whenTriggerCharacter"?te=X.triggerOptions.triggerKind!==1:ie.selectionMode==="whenQuickSuggestion"&&(te=X.triggerOptions.triggerKind===1&&!X.triggerOptions.refilter)}this.widget.value.showSuggestions(X.completionModel,J,X.isFrozen,X.triggerOptions.auto,te)})),this._toDispose.add(this.model.onDidCancel(X=>{X.retrigger||this.widget.value.hideWidget()})),this._toDispose.add(this.editor.onDidBlurEditorWidget(()=>{this.model.cancel(),this.model.clear()}));const Q=Context$1.AcceptSuggestionsOnEnter.bindTo(W),Y=()=>{const X=this.editor.getOption(1);Q.set(X==="on"||X==="smart")};this._toDispose.add(this.editor.onDidChangeConfiguration(()=>Y())),Y()}dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose(),this._onWillInsertSuggestItem.dispose()}_insertSuggestion(w,D){if(!w||!w.item){this._alternatives.value.reset(),this.model.cancel(),this.model.clear();return}if(!this.editor.hasModel())return;const O=SnippetController2.get(this.editor);if(!O)return;this._onWillInsertSuggestItem.fire({item:w.item});const W=this.editor.getModel(),U=W.getAlternativeVersionId(),{item:K}=w,q=[],G=new CancellationTokenSource$1;D&1||this.editor.pushUndoStop();const Q=this.getOverwriteInfo(K,!!(D&8));this._memoryService.memorize(W,this.editor.getPosition(),K);const Y=K.isResolved;let X=-1,J=-1;if(Array.isArray(K.completion.additionalTextEdits)){this.model.cancel();const ie=StableEditorScrollState.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",K.completion.additionalTextEdits.map(se=>{let re=Range$2.lift(se.range);if(re.startLineNumber===K.position.lineNumber&&re.startColumn>K.position.column){const ae=this.editor.getPosition().column-K.position.column,le=ae,de=Range$2.spansMultipleLines(re)?0:ae;re=new Range$2(re.startLineNumber,re.startColumn+le,re.endLineNumber,re.endColumn+de)}return EditOperation.replaceMove(re,se.text)})),ie.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!Y){const ie=new StopWatch;let se;const re=W.onDidChangeContent(oe=>{if(oe.isFlush){G.cancel(),re.dispose();return}for(const ue of oe.changes){const pe=Range$2.getEndPosition(ue.range);(!se||Position$1.isBefore(pe,se))&&(se=pe)}}),ae=D;D|=2;let le=!1;const de=this.editor.onWillType(()=>{de.dispose(),le=!0,ae&2||this.editor.pushUndoStop()});q.push(K.resolve(G.token).then(()=>{if(!K.completion.additionalTextEdits||G.token.isCancellationRequested)return;if(se&&K.completion.additionalTextEdits.some(ue=>Position$1.isBefore(se,Range$2.getStartPosition(ue.range))))return!1;le&&this.editor.pushUndoStop();const oe=StableEditorScrollState.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",K.completion.additionalTextEdits.map(ue=>EditOperation.replaceMove(Range$2.lift(ue.range),ue.text))),oe.restoreRelativeVerticalPositionOfCursor(this.editor),(le||!(ae&2))&&this.editor.pushUndoStop(),!0}).then(oe=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",ie.elapsed(),oe),J=oe===!0?1:oe===!1?0:-2}).finally(()=>{re.dispose(),de.dispose()}))}let{insertText:te}=K.completion;if(K.completion.insertTextRules&4||(te=SnippetParser.escape(te)),this.model.cancel(),O.insert(te,{overwriteBefore:Q.overwriteBefore,overwriteAfter:Q.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(K.completion.insertTextRules&1),clipboardText:w.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),D&2||this.editor.pushUndoStop(),K.completion.command)if(K.completion.command.id===TriggerSuggestAction.id)this.model.trigger({auto:!0,retrigger:!0});else{const ie=new StopWatch;q.push(this._commandService.executeCommand(K.completion.command.id,...K.completion.command.arguments?[...K.completion.command.arguments]:[]).catch(se=>{K.completion.extensionId?onUnexpectedExternalError(se):onUnexpectedError(se)}).finally(()=>{X=ie.elapsed()}))}D&4&&this._alternatives.value.set(w,ie=>{for(G.cancel();W.canUndo();){U!==W.getAlternativeVersionId()&&W.undo(),this._insertSuggestion(ie,3|(D&8?8:0));break}}),this._alertCompletionItem(K),Promise.all(q).finally(()=>{this._reportSuggestionAcceptedTelemetry(K,W,Y,X,J,w.index,w.model.items),this.model.clear(),G.dispose()})}_reportSuggestionAcceptedTelemetry(w,D,O,W,U,K,q){if(Math.floor(Math.random()*100)===0)return;const G=new Map;for(let J=0;J<Math.min(30,q.length);J++){const te=q[J].textLabel;G.has(te)?G.get(te).push(J):G.set(te,[J])}const Q=G.get(w.textLabel),X=Q&&Q.length>1?Q[0]:-1;this._telemetryService.publicLog2("suggest.acceptedSuggestion",{extensionId:w.extensionId?.value??"unknown",providerId:w.provider._debugDisplayName??"unknown",kind:w.completion.kind,basenameHash:hash(basename(D.uri)).toString(16),languageId:D.getLanguageId(),fileExtension:extname(D.uri),resolveInfo:w.provider.resolveCompletionItem?O?1:0:-1,resolveDuration:w.resolveDuration,commandDuration:W,additionalEditsAsync:U,index:K,firstIndex:X})}getOverwriteInfo(w,D){assertType(this.editor.hasModel());let O=this.editor.getOption(119).insertMode==="replace";D&&(O=!O);const W=w.position.column-w.editStart.column,U=(O?w.editReplaceEnd.column:w.editInsertEnd.column)-w.position.column,K=this.editor.getPosition().column-w.position.column,q=this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0;return{overwriteBefore:W+K,overwriteAfter:U+q}}_alertCompletionItem(w){if(isNonEmptyArray(w.completion.additionalTextEdits)){const D=localize("aria.alert.snippet","Accepting '{0}' made {1} additional edits",w.textLabel,w.completion.additionalTextEdits.length);alert(D)}}triggerSuggest(w,D,O){this.editor.hasModel()&&(this.model.trigger({auto:D??!1,completionOptions:{providerFilter:w,kindFilter:O?new Set:void 0}}),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(w){if(!this.editor.hasModel())return;const D=this.editor.getPosition(),O=()=>{D.equals(this.editor.getPosition())&&this._commandService.executeCommand(w.fallback)},W=U=>{if(U.completion.insertTextRules&4||U.completion.additionalTextEdits)return!0;const K=this.editor.getPosition(),q=U.editStart.column,G=K.column;return G-q!==U.completion.insertText.length?!0:this.editor.getModel().getValueInRange({startLineNumber:K.lineNumber,startColumn:q,endLineNumber:K.lineNumber,endColumn:G})!==U.completion.insertText};Event$1.once(this.model.onDidTrigger)(U=>{const K=[];Event$1.any(this.model.onDidTrigger,this.model.onDidCancel)(()=>{dispose(K),O()},void 0,K),this.model.onDidSuggest(({completionModel:q})=>{if(dispose(K),q.items.length===0){O();return}const G=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),q.items),Q=q.items[G];if(!W(Q)){O();return}this.editor.pushUndoStop(),this._insertSuggestion({index:G,item:Q,model:q},7)},void 0,K)}),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(D,0),this.editor.focus()}acceptSelectedSuggestion(w,D){const O=this.widget.value.getFocusedItem();let W=0;w&&(W|=4),D&&(W|=8),this._insertSuggestion(O,W)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}focusSuggestion(){this.widget.value.focusSelected()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(w){return this._selectors.register(w)}};SuggestController=SuggestController_1=__decorate$K([__param$I(1,ISuggestMemoryService),__param$I(2,ICommandService),__param$I(3,IContextKeyService),__param$I(4,IInstantiationService),__param$I(5,ILogService),__param$I(6,ITelemetryService)],SuggestController);class PriorityRegistry{constructor(w){this.prioritySelector=w,this._items=new Array}register(w){if(this._items.indexOf(w)!==-1)throw new Error("Value is already registered");return this._items.push(w),this._items.sort((D,O)=>this.prioritySelector(O)-this.prioritySelector(D)),{dispose:()=>{const D=this._items.indexOf(w);D>=0&&this._items.splice(D,1)}}}get itemsOrderedByPriorityDesc(){return this._items}}class TriggerSuggestAction extends EditorAction{static{this.id="editor.action.triggerSuggest"}constructor(){super({id:TriggerSuggestAction.id,label:localize("suggest.trigger.label","Trigger Suggest"),alias:"Trigger Suggest",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasCompletionItemProvider,Context$1.Visible.toNegated()),kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(w,D,O){const W=SuggestController.get(D);if(!W)return;let U;O&&typeof O=="object"&&O.auto===!0&&(U=!0),W.triggerSuggest(void 0,U,void 0)}}registerEditorContribution(SuggestController.ID,SuggestController,2);registerEditorAction(TriggerSuggestAction);const weight=190,SuggestCommand=EditorCommand.bindToContribution(SuggestController.get);registerEditorCommand(new SuggestCommand({id:"acceptSelectedSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,Context$1.HasFocusedSuggestion),handler(F){F.acceptSelectedSuggestion(!0,!1)},kbOpts:[{primary:2,kbExpr:ContextKeyExpr.and(Context$1.Visible,EditorContextKeys.textInputFocus),weight},{primary:3,kbExpr:ContextKeyExpr.and(Context$1.Visible,EditorContextKeys.textInputFocus,Context$1.AcceptSuggestionsOnEnter,Context$1.MakesTextEdit),weight}],menuOpts:[{menuId:suggestWidgetStatusbarMenu,title:localize("accept.insert","Insert"),group:"left",order:1,when:Context$1.HasInsertAndReplaceRange.toNegated()},{menuId:suggestWidgetStatusbarMenu,title:localize("accept.insert","Insert"),group:"left",order:1,when:ContextKeyExpr.and(Context$1.HasInsertAndReplaceRange,Context$1.InsertMode.isEqualTo("insert"))},{menuId:suggestWidgetStatusbarMenu,title:localize("accept.replace","Replace"),group:"left",order:1,when:ContextKeyExpr.and(Context$1.HasInsertAndReplaceRange,Context$1.InsertMode.isEqualTo("replace"))}]}));registerEditorCommand(new SuggestCommand({id:"acceptAlternativeSelectedSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,EditorContextKeys.textInputFocus,Context$1.HasFocusedSuggestion),kbOpts:{weight,kbExpr:EditorContextKeys.textInputFocus,primary:1027,secondary:[1026]},handler(F){F.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:suggestWidgetStatusbarMenu,group:"left",order:2,when:ContextKeyExpr.and(Context$1.HasInsertAndReplaceRange,Context$1.InsertMode.isEqualTo("insert")),title:localize("accept.replace","Replace")},{menuId:suggestWidgetStatusbarMenu,group:"left",order:2,when:ContextKeyExpr.and(Context$1.HasInsertAndReplaceRange,Context$1.InsertMode.isEqualTo("replace")),title:localize("accept.insert","Insert")}]}));CommandsRegistry.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion");registerEditorCommand(new SuggestCommand({id:"hideSuggestWidget",precondition:Context$1.Visible,handler:F=>F.cancelSuggestWidget(),kbOpts:{weight,kbExpr:EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}}));registerEditorCommand(new SuggestCommand({id:"selectNextSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,ContextKeyExpr.or(Context$1.MultipleSuggestions,Context$1.HasFocusedSuggestion.negate())),handler:F=>F.selectNextSuggestion(),kbOpts:{weight,kbExpr:EditorContextKeys.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}}));registerEditorCommand(new SuggestCommand({id:"selectNextPageSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,ContextKeyExpr.or(Context$1.MultipleSuggestions,Context$1.HasFocusedSuggestion.negate())),handler:F=>F.selectNextPageSuggestion(),kbOpts:{weight,kbExpr:EditorContextKeys.textInputFocus,primary:12,secondary:[2060]}}));registerEditorCommand(new SuggestCommand({id:"selectLastSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,ContextKeyExpr.or(Context$1.MultipleSuggestions,Context$1.HasFocusedSuggestion.negate())),handler:F=>F.selectLastSuggestion()}));registerEditorCommand(new SuggestCommand({id:"selectPrevSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,ContextKeyExpr.or(Context$1.MultipleSuggestions,Context$1.HasFocusedSuggestion.negate())),handler:F=>F.selectPrevSuggestion(),kbOpts:{weight,kbExpr:EditorContextKeys.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}}));registerEditorCommand(new SuggestCommand({id:"selectPrevPageSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,ContextKeyExpr.or(Context$1.MultipleSuggestions,Context$1.HasFocusedSuggestion.negate())),handler:F=>F.selectPrevPageSuggestion(),kbOpts:{weight,kbExpr:EditorContextKeys.textInputFocus,primary:11,secondary:[2059]}}));registerEditorCommand(new SuggestCommand({id:"selectFirstSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,ContextKeyExpr.or(Context$1.MultipleSuggestions,Context$1.HasFocusedSuggestion.negate())),handler:F=>F.selectFirstSuggestion()}));registerEditorCommand(new SuggestCommand({id:"focusSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,Context$1.HasFocusedSuggestion.negate()),handler:F=>F.focusSuggestion(),kbOpts:{weight,kbExpr:EditorContextKeys.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}}}));registerEditorCommand(new SuggestCommand({id:"focusAndAcceptSuggestion",precondition:ContextKeyExpr.and(Context$1.Visible,Context$1.HasFocusedSuggestion.negate()),handler:F=>{F.focusSuggestion(),F.acceptSelectedSuggestion(!0,!1)}}));registerEditorCommand(new SuggestCommand({id:"toggleSuggestionDetails",precondition:ContextKeyExpr.and(Context$1.Visible,Context$1.HasFocusedSuggestion),handler:F=>F.toggleSuggestionDetails(),kbOpts:{weight,kbExpr:EditorContextKeys.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:suggestWidgetStatusbarMenu,group:"right",order:1,when:ContextKeyExpr.and(Context$1.DetailsVisible,Context$1.CanResolve),title:localize("detail.more","Show Less")},{menuId:suggestWidgetStatusbarMenu,group:"right",order:1,when:ContextKeyExpr.and(Context$1.DetailsVisible.toNegated(),Context$1.CanResolve),title:localize("detail.less","Show More")}]}));registerEditorCommand(new SuggestCommand({id:"toggleExplainMode",precondition:Context$1.Visible,handler:F=>F.toggleExplainMode(),kbOpts:{weight:100,primary:2138}}));registerEditorCommand(new SuggestCommand({id:"toggleSuggestionFocus",precondition:Context$1.Visible,handler:F=>F.toggleSuggestionFocus(),kbOpts:{weight,kbExpr:EditorContextKeys.textInputFocus,primary:2570,mac:{primary:778}}}));registerEditorCommand(new SuggestCommand({id:"insertBestCompletion",precondition:ContextKeyExpr.and(EditorContextKeys.textInputFocus,ContextKeyExpr.equals("config.editor.tabCompletion","on"),WordContextKey.AtEnd,Context$1.Visible.toNegated(),SuggestAlternatives.OtherSuggestions.toNegated(),SnippetController2.InSnippetMode.toNegated()),handler:(F,w)=>{F.triggerSuggestAndAcceptBest(isObject$1(w)?{fallback:"tab",...w}:{fallback:"tab"})},kbOpts:{weight,primary:2}}));registerEditorCommand(new SuggestCommand({id:"insertNextSuggestion",precondition:ContextKeyExpr.and(EditorContextKeys.textInputFocus,ContextKeyExpr.equals("config.editor.tabCompletion","on"),SuggestAlternatives.OtherSuggestions,Context$1.Visible.toNegated(),SnippetController2.InSnippetMode.toNegated()),handler:F=>F.acceptNextSuggestion(),kbOpts:{weight,kbExpr:EditorContextKeys.textInputFocus,primary:2}}));registerEditorCommand(new SuggestCommand({id:"insertPrevSuggestion",precondition:ContextKeyExpr.and(EditorContextKeys.textInputFocus,ContextKeyExpr.equals("config.editor.tabCompletion","on"),SuggestAlternatives.OtherSuggestions,Context$1.Visible.toNegated(),SnippetController2.InSnippetMode.toNegated()),handler:F=>F.acceptPrevSuggestion(),kbOpts:{weight,kbExpr:EditorContextKeys.textInputFocus,primary:1026}}));registerEditorAction(class extends EditorAction{constructor(){super({id:"editor.action.resetSuggestSize",label:localize("suggest.reset.label","Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}run(F,w){SuggestController.get(w)?.resetWidgetSize()}});var AccessibilitySupport;(function(F){F[F.Unknown=0]="Unknown",F[F.Disabled=1]="Disabled",F[F.Enabled=2]="Enabled"})(AccessibilitySupport||(AccessibilitySupport={}));var CodeActionTriggerType;(function(F){F[F.Invoke=1]="Invoke",F[F.Auto=2]="Auto"})(CodeActionTriggerType||(CodeActionTriggerType={}));var CompletionItemInsertTextRule;(function(F){F[F.None=0]="None",F[F.KeepWhitespace=1]="KeepWhitespace",F[F.InsertAsSnippet=4]="InsertAsSnippet"})(CompletionItemInsertTextRule||(CompletionItemInsertTextRule={}));var CompletionItemKind;(function(F){F[F.Method=0]="Method",F[F.Function=1]="Function",F[F.Constructor=2]="Constructor",F[F.Field=3]="Field",F[F.Variable=4]="Variable",F[F.Class=5]="Class",F[F.Struct=6]="Struct",F[F.Interface=7]="Interface",F[F.Module=8]="Module",F[F.Property=9]="Property",F[F.Event=10]="Event",F[F.Operator=11]="Operator",F[F.Unit=12]="Unit",F[F.Value=13]="Value",F[F.Constant=14]="Constant",F[F.Enum=15]="Enum",F[F.EnumMember=16]="EnumMember",F[F.Keyword=17]="Keyword",F[F.Text=18]="Text",F[F.Color=19]="Color",F[F.File=20]="File",F[F.Reference=21]="Reference",F[F.Customcolor=22]="Customcolor",F[F.Folder=23]="Folder",F[F.TypeParameter=24]="TypeParameter",F[F.User=25]="User",F[F.Issue=26]="Issue",F[F.Snippet=27]="Snippet"})(CompletionItemKind||(CompletionItemKind={}));var CompletionItemTag;(function(F){F[F.Deprecated=1]="Deprecated"})(CompletionItemTag||(CompletionItemTag={}));var CompletionTriggerKind;(function(F){F[F.Invoke=0]="Invoke",F[F.TriggerCharacter=1]="TriggerCharacter",F[F.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(CompletionTriggerKind||(CompletionTriggerKind={}));var ContentWidgetPositionPreference;(function(F){F[F.EXACT=0]="EXACT",F[F.ABOVE=1]="ABOVE",F[F.BELOW=2]="BELOW"})(ContentWidgetPositionPreference||(ContentWidgetPositionPreference={}));var CursorChangeReason;(function(F){F[F.NotSet=0]="NotSet",F[F.ContentFlush=1]="ContentFlush",F[F.RecoverFromMarkers=2]="RecoverFromMarkers",F[F.Explicit=3]="Explicit",F[F.Paste=4]="Paste",F[F.Undo=5]="Undo",F[F.Redo=6]="Redo"})(CursorChangeReason||(CursorChangeReason={}));var DefaultEndOfLine;(function(F){F[F.LF=1]="LF",F[F.CRLF=2]="CRLF"})(DefaultEndOfLine||(DefaultEndOfLine={}));var DocumentHighlightKind;(function(F){F[F.Text=0]="Text",F[F.Read=1]="Read",F[F.Write=2]="Write"})(DocumentHighlightKind||(DocumentHighlightKind={}));var EditorAutoIndentStrategy;(function(F){F[F.None=0]="None",F[F.Keep=1]="Keep",F[F.Brackets=2]="Brackets",F[F.Advanced=3]="Advanced",F[F.Full=4]="Full"})(EditorAutoIndentStrategy||(EditorAutoIndentStrategy={}));var EditorOption;(function(F){F[F.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",F[F.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",F[F.accessibilitySupport=2]="accessibilitySupport",F[F.accessibilityPageSize=3]="accessibilityPageSize",F[F.ariaLabel=4]="ariaLabel",F[F.ariaRequired=5]="ariaRequired",F[F.autoClosingBrackets=6]="autoClosingBrackets",F[F.autoClosingComments=7]="autoClosingComments",F[F.screenReaderAnnounceInlineSuggestion=8]="screenReaderAnnounceInlineSuggestion",F[F.autoClosingDelete=9]="autoClosingDelete",F[F.autoClosingOvertype=10]="autoClosingOvertype",F[F.autoClosingQuotes=11]="autoClosingQuotes",F[F.autoIndent=12]="autoIndent",F[F.automaticLayout=13]="automaticLayout",F[F.autoSurround=14]="autoSurround",F[F.bracketPairColorization=15]="bracketPairColorization",F[F.guides=16]="guides",F[F.codeLens=17]="codeLens",F[F.codeLensFontFamily=18]="codeLensFontFamily",F[F.codeLensFontSize=19]="codeLensFontSize",F[F.colorDecorators=20]="colorDecorators",F[F.colorDecoratorsLimit=21]="colorDecoratorsLimit",F[F.columnSelection=22]="columnSelection",F[F.comments=23]="comments",F[F.contextmenu=24]="contextmenu",F[F.copyWithSyntaxHighlighting=25]="copyWithSyntaxHighlighting",F[F.cursorBlinking=26]="cursorBlinking",F[F.cursorSmoothCaretAnimation=27]="cursorSmoothCaretAnimation",F[F.cursorStyle=28]="cursorStyle",F[F.cursorSurroundingLines=29]="cursorSurroundingLines",F[F.cursorSurroundingLinesStyle=30]="cursorSurroundingLinesStyle",F[F.cursorWidth=31]="cursorWidth",F[F.disableLayerHinting=32]="disableLayerHinting",F[F.disableMonospaceOptimizations=33]="disableMonospaceOptimizations",F[F.domReadOnly=34]="domReadOnly",F[F.dragAndDrop=35]="dragAndDrop",F[F.dropIntoEditor=36]="dropIntoEditor",F[F.emptySelectionClipboard=37]="emptySelectionClipboard",F[F.experimentalWhitespaceRendering=38]="experimentalWhitespaceRendering",F[F.extraEditorClassName=39]="extraEditorClassName",F[F.fastScrollSensitivity=40]="fastScrollSensitivity",F[F.find=41]="find",F[F.fixedOverflowWidgets=42]="fixedOverflowWidgets",F[F.folding=43]="folding",F[F.foldingStrategy=44]="foldingStrategy",F[F.foldingHighlight=45]="foldingHighlight",F[F.foldingImportsByDefault=46]="foldingImportsByDefault",F[F.foldingMaximumRegions=47]="foldingMaximumRegions",F[F.unfoldOnClickAfterEndOfLine=48]="unfoldOnClickAfterEndOfLine",F[F.fontFamily=49]="fontFamily",F[F.fontInfo=50]="fontInfo",F[F.fontLigatures=51]="fontLigatures",F[F.fontSize=52]="fontSize",F[F.fontWeight=53]="fontWeight",F[F.fontVariations=54]="fontVariations",F[F.formatOnPaste=55]="formatOnPaste",F[F.formatOnType=56]="formatOnType",F[F.glyphMargin=57]="glyphMargin",F[F.gotoLocation=58]="gotoLocation",F[F.hideCursorInOverviewRuler=59]="hideCursorInOverviewRuler",F[F.hover=60]="hover",F[F.inDiffEditor=61]="inDiffEditor",F[F.inlineSuggest=62]="inlineSuggest",F[F.inlineEdit=63]="inlineEdit",F[F.letterSpacing=64]="letterSpacing",F[F.lightbulb=65]="lightbulb",F[F.lineDecorationsWidth=66]="lineDecorationsWidth",F[F.lineHeight=67]="lineHeight",F[F.lineNumbers=68]="lineNumbers",F[F.lineNumbersMinChars=69]="lineNumbersMinChars",F[F.linkedEditing=70]="linkedEditing",F[F.links=71]="links",F[F.matchBrackets=72]="matchBrackets",F[F.minimap=73]="minimap",F[F.mouseStyle=74]="mouseStyle",F[F.mouseWheelScrollSensitivity=75]="mouseWheelScrollSensitivity",F[F.mouseWheelZoom=76]="mouseWheelZoom",F[F.multiCursorMergeOverlapping=77]="multiCursorMergeOverlapping",F[F.multiCursorModifier=78]="multiCursorModifier",F[F.multiCursorPaste=79]="multiCursorPaste",F[F.multiCursorLimit=80]="multiCursorLimit",F[F.occurrencesHighlight=81]="occurrencesHighlight",F[F.overviewRulerBorder=82]="overviewRulerBorder",F[F.overviewRulerLanes=83]="overviewRulerLanes",F[F.padding=84]="padding",F[F.pasteAs=85]="pasteAs",F[F.parameterHints=86]="parameterHints",F[F.peekWidgetDefaultFocus=87]="peekWidgetDefaultFocus",F[F.placeholder=88]="placeholder",F[F.definitionLinkOpensInPeek=89]="definitionLinkOpensInPeek",F[F.quickSuggestions=90]="quickSuggestions",F[F.quickSuggestionsDelay=91]="quickSuggestionsDelay",F[F.readOnly=92]="readOnly",F[F.readOnlyMessage=93]="readOnlyMessage",F[F.renameOnType=94]="renameOnType",F[F.renderControlCharacters=95]="renderControlCharacters",F[F.renderFinalNewline=96]="renderFinalNewline",F[F.renderLineHighlight=97]="renderLineHighlight",F[F.renderLineHighlightOnlyWhenFocus=98]="renderLineHighlightOnlyWhenFocus",F[F.renderValidationDecorations=99]="renderValidationDecorations",F[F.renderWhitespace=100]="renderWhitespace",F[F.revealHorizontalRightPadding=101]="revealHorizontalRightPadding",F[F.roundedSelection=102]="roundedSelection",F[F.rulers=103]="rulers",F[F.scrollbar=104]="scrollbar",F[F.scrollBeyondLastColumn=105]="scrollBeyondLastColumn",F[F.scrollBeyondLastLine=106]="scrollBeyondLastLine",F[F.scrollPredominantAxis=107]="scrollPredominantAxis",F[F.selectionClipboard=108]="selectionClipboard",F[F.selectionHighlight=109]="selectionHighlight",F[F.selectOnLineNumbers=110]="selectOnLineNumbers",F[F.showFoldingControls=111]="showFoldingControls",F[F.showUnused=112]="showUnused",F[F.snippetSuggestions=113]="snippetSuggestions",F[F.smartSelect=114]="smartSelect",F[F.smoothScrolling=115]="smoothScrolling",F[F.stickyScroll=116]="stickyScroll",F[F.stickyTabStops=117]="stickyTabStops",F[F.stopRenderingLineAfter=118]="stopRenderingLineAfter",F[F.suggest=119]="suggest",F[F.suggestFontSize=120]="suggestFontSize",F[F.suggestLineHeight=121]="suggestLineHeight",F[F.suggestOnTriggerCharacters=122]="suggestOnTriggerCharacters",F[F.suggestSelection=123]="suggestSelection",F[F.tabCompletion=124]="tabCompletion",F[F.tabIndex=125]="tabIndex",F[F.unicodeHighlighting=126]="unicodeHighlighting",F[F.unusualLineTerminators=127]="unusualLineTerminators",F[F.useShadowDOM=128]="useShadowDOM",F[F.useTabStops=129]="useTabStops",F[F.wordBreak=130]="wordBreak",F[F.wordSegmenterLocales=131]="wordSegmenterLocales",F[F.wordSeparators=132]="wordSeparators",F[F.wordWrap=133]="wordWrap",F[F.wordWrapBreakAfterCharacters=134]="wordWrapBreakAfterCharacters",F[F.wordWrapBreakBeforeCharacters=135]="wordWrapBreakBeforeCharacters",F[F.wordWrapColumn=136]="wordWrapColumn",F[F.wordWrapOverride1=137]="wordWrapOverride1",F[F.wordWrapOverride2=138]="wordWrapOverride2",F[F.wrappingIndent=139]="wrappingIndent",F[F.wrappingStrategy=140]="wrappingStrategy",F[F.showDeprecated=141]="showDeprecated",F[F.inlayHints=142]="inlayHints",F[F.editorClassName=143]="editorClassName",F[F.pixelRatio=144]="pixelRatio",F[F.tabFocusMode=145]="tabFocusMode",F[F.layoutInfo=146]="layoutInfo",F[F.wrappingInfo=147]="wrappingInfo",F[F.defaultColorDecorators=148]="defaultColorDecorators",F[F.colorDecoratorsActivatedOn=149]="colorDecoratorsActivatedOn",F[F.inlineCompletionsAccessibilityVerbose=150]="inlineCompletionsAccessibilityVerbose"})(EditorOption||(EditorOption={}));var EndOfLinePreference;(function(F){F[F.TextDefined=0]="TextDefined",F[F.LF=1]="LF",F[F.CRLF=2]="CRLF"})(EndOfLinePreference||(EndOfLinePreference={}));var EndOfLineSequence;(function(F){F[F.LF=0]="LF",F[F.CRLF=1]="CRLF"})(EndOfLineSequence||(EndOfLineSequence={}));var GlyphMarginLane;(function(F){F[F.Left=1]="Left",F[F.Center=2]="Center",F[F.Right=3]="Right"})(GlyphMarginLane||(GlyphMarginLane={}));var HoverVerbosityAction;(function(F){F[F.Increase=0]="Increase",F[F.Decrease=1]="Decrease"})(HoverVerbosityAction||(HoverVerbosityAction={}));var IndentAction;(function(F){F[F.None=0]="None",F[F.Indent=1]="Indent",F[F.IndentOutdent=2]="IndentOutdent",F[F.Outdent=3]="Outdent"})(IndentAction||(IndentAction={}));var InjectedTextCursorStops;(function(F){F[F.Both=0]="Both",F[F.Right=1]="Right",F[F.Left=2]="Left",F[F.None=3]="None"})(InjectedTextCursorStops||(InjectedTextCursorStops={}));var InlayHintKind;(function(F){F[F.Type=1]="Type",F[F.Parameter=2]="Parameter"})(InlayHintKind||(InlayHintKind={}));var InlineCompletionTriggerKind;(function(F){F[F.Automatic=0]="Automatic",F[F.Explicit=1]="Explicit"})(InlineCompletionTriggerKind||(InlineCompletionTriggerKind={}));var InlineEditTriggerKind;(function(F){F[F.Invoke=0]="Invoke",F[F.Automatic=1]="Automatic"})(InlineEditTriggerKind||(InlineEditTriggerKind={}));var KeyCode$1;(function(F){F[F.DependsOnKbLayout=-1]="DependsOnKbLayout",F[F.Unknown=0]="Unknown",F[F.Backspace=1]="Backspace",F[F.Tab=2]="Tab",F[F.Enter=3]="Enter",F[F.Shift=4]="Shift",F[F.Ctrl=5]="Ctrl",F[F.Alt=6]="Alt",F[F.PauseBreak=7]="PauseBreak",F[F.CapsLock=8]="CapsLock",F[F.Escape=9]="Escape",F[F.Space=10]="Space",F[F.PageUp=11]="PageUp",F[F.PageDown=12]="PageDown",F[F.End=13]="End",F[F.Home=14]="Home",F[F.LeftArrow=15]="LeftArrow",F[F.UpArrow=16]="UpArrow",F[F.RightArrow=17]="RightArrow",F[F.DownArrow=18]="DownArrow",F[F.Insert=19]="Insert",F[F.Delete=20]="Delete",F[F.Digit0=21]="Digit0",F[F.Digit1=22]="Digit1",F[F.Digit2=23]="Digit2",F[F.Digit3=24]="Digit3",F[F.Digit4=25]="Digit4",F[F.Digit5=26]="Digit5",F[F.Digit6=27]="Digit6",F[F.Digit7=28]="Digit7",F[F.Digit8=29]="Digit8",F[F.Digit9=30]="Digit9",F[F.KeyA=31]="KeyA",F[F.KeyB=32]="KeyB",F[F.KeyC=33]="KeyC",F[F.KeyD=34]="KeyD",F[F.KeyE=35]="KeyE",F[F.KeyF=36]="KeyF",F[F.KeyG=37]="KeyG",F[F.KeyH=38]="KeyH",F[F.KeyI=39]="KeyI",F[F.KeyJ=40]="KeyJ",F[F.KeyK=41]="KeyK",F[F.KeyL=42]="KeyL",F[F.KeyM=43]="KeyM",F[F.KeyN=44]="KeyN",F[F.KeyO=45]="KeyO",F[F.KeyP=46]="KeyP",F[F.KeyQ=47]="KeyQ",F[F.KeyR=48]="KeyR",F[F.KeyS=49]="KeyS",F[F.KeyT=50]="KeyT",F[F.KeyU=51]="KeyU",F[F.KeyV=52]="KeyV",F[F.KeyW=53]="KeyW",F[F.KeyX=54]="KeyX",F[F.KeyY=55]="KeyY",F[F.KeyZ=56]="KeyZ",F[F.Meta=57]="Meta",F[F.ContextMenu=58]="ContextMenu",F[F.F1=59]="F1",F[F.F2=60]="F2",F[F.F3=61]="F3",F[F.F4=62]="F4",F[F.F5=63]="F5",F[F.F6=64]="F6",F[F.F7=65]="F7",F[F.F8=66]="F8",F[F.F9=67]="F9",F[F.F10=68]="F10",F[F.F11=69]="F11",F[F.F12=70]="F12",F[F.F13=71]="F13",F[F.F14=72]="F14",F[F.F15=73]="F15",F[F.F16=74]="F16",F[F.F17=75]="F17",F[F.F18=76]="F18",F[F.F19=77]="F19",F[F.F20=78]="F20",F[F.F21=79]="F21",F[F.F22=80]="F22",F[F.F23=81]="F23",F[F.F24=82]="F24",F[F.NumLock=83]="NumLock",F[F.ScrollLock=84]="ScrollLock",F[F.Semicolon=85]="Semicolon",F[F.Equal=86]="Equal",F[F.Comma=87]="Comma",F[F.Minus=88]="Minus",F[F.Period=89]="Period",F[F.Slash=90]="Slash",F[F.Backquote=91]="Backquote",F[F.BracketLeft=92]="BracketLeft",F[F.Backslash=93]="Backslash",F[F.BracketRight=94]="BracketRight",F[F.Quote=95]="Quote",F[F.OEM_8=96]="OEM_8",F[F.IntlBackslash=97]="IntlBackslash",F[F.Numpad0=98]="Numpad0",F[F.Numpad1=99]="Numpad1",F[F.Numpad2=100]="Numpad2",F[F.Numpad3=101]="Numpad3",F[F.Numpad4=102]="Numpad4",F[F.Numpad5=103]="Numpad5",F[F.Numpad6=104]="Numpad6",F[F.Numpad7=105]="Numpad7",F[F.Numpad8=106]="Numpad8",F[F.Numpad9=107]="Numpad9",F[F.NumpadMultiply=108]="NumpadMultiply",F[F.NumpadAdd=109]="NumpadAdd",F[F.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",F[F.NumpadSubtract=111]="NumpadSubtract",F[F.NumpadDecimal=112]="NumpadDecimal",F[F.NumpadDivide=113]="NumpadDivide",F[F.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",F[F.ABNT_C1=115]="ABNT_C1",F[F.ABNT_C2=116]="ABNT_C2",F[F.AudioVolumeMute=117]="AudioVolumeMute",F[F.AudioVolumeUp=118]="AudioVolumeUp",F[F.AudioVolumeDown=119]="AudioVolumeDown",F[F.BrowserSearch=120]="BrowserSearch",F[F.BrowserHome=121]="BrowserHome",F[F.BrowserBack=122]="BrowserBack",F[F.BrowserForward=123]="BrowserForward",F[F.MediaTrackNext=124]="MediaTrackNext",F[F.MediaTrackPrevious=125]="MediaTrackPrevious",F[F.MediaStop=126]="MediaStop",F[F.MediaPlayPause=127]="MediaPlayPause",F[F.LaunchMediaPlayer=128]="LaunchMediaPlayer",F[F.LaunchMail=129]="LaunchMail",F[F.LaunchApp2=130]="LaunchApp2",F[F.Clear=131]="Clear",F[F.MAX_VALUE=132]="MAX_VALUE"})(KeyCode$1||(KeyCode$1={}));var MarkerSeverity$2;(function(F){F[F.Hint=1]="Hint",F[F.Info=2]="Info",F[F.Warning=4]="Warning",F[F.Error=8]="Error"})(MarkerSeverity$2||(MarkerSeverity$2={}));var MarkerTag$1;(function(F){F[F.Unnecessary=1]="Unnecessary",F[F.Deprecated=2]="Deprecated"})(MarkerTag$1||(MarkerTag$1={}));var MinimapPosition;(function(F){F[F.Inline=1]="Inline",F[F.Gutter=2]="Gutter"})(MinimapPosition||(MinimapPosition={}));var MinimapSectionHeaderStyle;(function(F){F[F.Normal=1]="Normal",F[F.Underlined=2]="Underlined"})(MinimapSectionHeaderStyle||(MinimapSectionHeaderStyle={}));var MouseTargetType;(function(F){F[F.UNKNOWN=0]="UNKNOWN",F[F.TEXTAREA=1]="TEXTAREA",F[F.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",F[F.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",F[F.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",F[F.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",F[F.CONTENT_TEXT=6]="CONTENT_TEXT",F[F.CONTENT_EMPTY=7]="CONTENT_EMPTY",F[F.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",F[F.CONTENT_WIDGET=9]="CONTENT_WIDGET",F[F.OVERVIEW_RULER=10]="OVERVIEW_RULER",F[F.SCROLLBAR=11]="SCROLLBAR",F[F.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",F[F.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"})(MouseTargetType||(MouseTargetType={}));var NewSymbolNameTag;(function(F){F[F.AIGenerated=1]="AIGenerated"})(NewSymbolNameTag||(NewSymbolNameTag={}));var NewSymbolNameTriggerKind;(function(F){F[F.Invoke=0]="Invoke",F[F.Automatic=1]="Automatic"})(NewSymbolNameTriggerKind||(NewSymbolNameTriggerKind={}));var OverlayWidgetPositionPreference;(function(F){F[F.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",F[F.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",F[F.TOP_CENTER=2]="TOP_CENTER"})(OverlayWidgetPositionPreference||(OverlayWidgetPositionPreference={}));var OverviewRulerLane;(function(F){F[F.Left=1]="Left",F[F.Center=2]="Center",F[F.Right=4]="Right",F[F.Full=7]="Full"})(OverviewRulerLane||(OverviewRulerLane={}));var PartialAcceptTriggerKind;(function(F){F[F.Word=0]="Word",F[F.Line=1]="Line",F[F.Suggest=2]="Suggest"})(PartialAcceptTriggerKind||(PartialAcceptTriggerKind={}));var PositionAffinity;(function(F){F[F.Left=0]="Left",F[F.Right=1]="Right",F[F.None=2]="None",F[F.LeftOfInjectedText=3]="LeftOfInjectedText",F[F.RightOfInjectedText=4]="RightOfInjectedText"})(PositionAffinity||(PositionAffinity={}));var RenderLineNumbersType;(function(F){F[F.Off=0]="Off",F[F.On=1]="On",F[F.Relative=2]="Relative",F[F.Interval=3]="Interval",F[F.Custom=4]="Custom"})(RenderLineNumbersType||(RenderLineNumbersType={}));var RenderMinimap;(function(F){F[F.None=0]="None",F[F.Text=1]="Text",F[F.Blocks=2]="Blocks"})(RenderMinimap||(RenderMinimap={}));var ScrollType;(function(F){F[F.Smooth=0]="Smooth",F[F.Immediate=1]="Immediate"})(ScrollType||(ScrollType={}));var ScrollbarVisibility;(function(F){F[F.Auto=1]="Auto",F[F.Hidden=2]="Hidden",F[F.Visible=3]="Visible"})(ScrollbarVisibility||(ScrollbarVisibility={}));var SelectionDirection$1;(function(F){F[F.LTR=0]="LTR",F[F.RTL=1]="RTL"})(SelectionDirection$1||(SelectionDirection$1={}));var ShowLightbulbIconMode;(function(F){F.Off="off",F.OnCode="onCode",F.On="on"})(ShowLightbulbIconMode||(ShowLightbulbIconMode={}));var SignatureHelpTriggerKind;(function(F){F[F.Invoke=1]="Invoke",F[F.TriggerCharacter=2]="TriggerCharacter",F[F.ContentChange=3]="ContentChange"})(SignatureHelpTriggerKind||(SignatureHelpTriggerKind={}));var SymbolKind;(function(F){F[F.File=0]="File",F[F.Module=1]="Module",F[F.Namespace=2]="Namespace",F[F.Package=3]="Package",F[F.Class=4]="Class",F[F.Method=5]="Method",F[F.Property=6]="Property",F[F.Field=7]="Field",F[F.Constructor=8]="Constructor",F[F.Enum=9]="Enum",F[F.Interface=10]="Interface",F[F.Function=11]="Function",F[F.Variable=12]="Variable",F[F.Constant=13]="Constant",F[F.String=14]="String",F[F.Number=15]="Number",F[F.Boolean=16]="Boolean",F[F.Array=17]="Array",F[F.Object=18]="Object",F[F.Key=19]="Key",F[F.Null=20]="Null",F[F.EnumMember=21]="EnumMember",F[F.Struct=22]="Struct",F[F.Event=23]="Event",F[F.Operator=24]="Operator",F[F.TypeParameter=25]="TypeParameter"})(SymbolKind||(SymbolKind={}));var SymbolTag;(function(F){F[F.Deprecated=1]="Deprecated"})(SymbolTag||(SymbolTag={}));var TextEditorCursorBlinkingStyle;(function(F){F[F.Hidden=0]="Hidden",F[F.Blink=1]="Blink",F[F.Smooth=2]="Smooth",F[F.Phase=3]="Phase",F[F.Expand=4]="Expand",F[F.Solid=5]="Solid"})(TextEditorCursorBlinkingStyle||(TextEditorCursorBlinkingStyle={}));var TextEditorCursorStyle;(function(F){F[F.Line=1]="Line",F[F.Block=2]="Block",F[F.Underline=3]="Underline",F[F.LineThin=4]="LineThin",F[F.BlockOutline=5]="BlockOutline",F[F.UnderlineThin=6]="UnderlineThin"})(TextEditorCursorStyle||(TextEditorCursorStyle={}));var TrackedRangeStickiness;(function(F){F[F.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",F[F.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",F[F.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",F[F.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(TrackedRangeStickiness||(TrackedRangeStickiness={}));var WrappingIndent;(function(F){F[F.None=0]="None",F[F.Same=1]="Same",F[F.Indent=2]="Indent",F[F.DeepIndent=3]="DeepIndent"})(WrappingIndent||(WrappingIndent={}));let KeyMod$1=class{static{this.CtrlCmd=2048}static{this.Shift=1024}static{this.Alt=512}static{this.WinCtrl=256}static chord(w,D){return KeyChord(w,D)}};function createMonacoBaseAPI(){return{editor:void 0,languages:void 0,CancellationTokenSource:CancellationTokenSource$1,Emitter:Emitter$1,KeyCode:KeyCode$1,KeyMod:KeyMod$1,Position:Position$1,Range:Range$2,Selection:Selection$1,SelectionDirection:SelectionDirection$1,MarkerSeverity:MarkerSeverity$2,MarkerTag:MarkerTag$1,Uri:URI,Token:Token$1}}const scriptRel="modulepreload",assetsURL=function(F){return"/"+F},seen={},__vitePreload=function(w,D,O){let W=Promise.resolve();if(D&&D.length>0){let K=function(Q){return Promise.all(Q.map(Y=>Promise.resolve(Y).then(X=>({status:"fulfilled",value:X}),X=>({status:"rejected",reason:X}))))};document.getElementsByTagName("link");const q=document.querySelector("meta[property=csp-nonce]"),G=q?.nonce||q?.getAttribute("nonce");W=K(D.map(Q=>{if(Q=assetsURL(Q),Q in seen)return;seen[Q]=!0;const Y=Q.endsWith(".css"),X=Y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${Q}"]${X}`))return;const J=document.createElement("link");if(J.rel=Y?"stylesheet":scriptRel,Y||(J.as="script"),J.crossOrigin="",J.href=Q,G&&J.setAttribute("nonce",G),document.head.appendChild(J),Y)return new Promise((te,ie)=>{J.addEventListener("load",te),J.addEventListener("error",()=>ie(new Error(`Unable to preload CSS for ${Q}`)))})}))}function U(K){const q=new Event("vite:preloadError",{cancelable:!0});if(q.payload=K,window.dispatchEvent(q),!q.defaultPrevented)throw K}return W.then(K=>{for(const q of K||[])q.status==="rejected"&&U(q.reason);return w().catch(U)})},DEFAULT_CHANNEL="default",INITIALIZE="$initialize";let webWorkerWarningLogged=!1;function logOnceWebWorkerWarning(F){isWeb&&(webWorkerWarningLogged||(webWorkerWarningLogged=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(F.message))}class RequestMessage{constructor(w,D,O,W,U){this.vsWorker=w,this.req=D,this.channel=O,this.method=W,this.args=U,this.type=0}}class ReplyMessage{constructor(w,D,O,W){this.vsWorker=w,this.seq=D,this.res=O,this.err=W,this.type=1}}class SubscribeEventMessage{constructor(w,D,O,W,U){this.vsWorker=w,this.req=D,this.channel=O,this.eventName=W,this.arg=U,this.type=2}}class EventMessage{constructor(w,D,O){this.vsWorker=w,this.req=D,this.event=O,this.type=3}}class UnsubscribeEventMessage{constructor(w,D){this.vsWorker=w,this.req=D,this.type=4}}class SimpleWorkerProtocol{constructor(w){this._workerId=-1,this._handler=w,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(w){this._workerId=w}sendMessage(w,D,O){const W=String(++this._lastSentReq);return new Promise((U,K)=>{this._pendingReplies[W]={resolve:U,reject:K},this._send(new RequestMessage(this._workerId,W,w,D,O))})}listen(w,D,O){let W=null;const U=new Emitter$1({onWillAddFirstListener:()=>{W=String(++this._lastSentReq),this._pendingEmitters.set(W,U),this._send(new SubscribeEventMessage(this._workerId,W,w,D,O))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(W),this._send(new UnsubscribeEventMessage(this._workerId,W)),W=null}});return U.event}handleMessage(w){!w||!w.vsWorker||this._workerId!==-1&&w.vsWorker!==this._workerId||this._handleMessage(w)}createProxyToRemoteChannel(w,D){const O={get:(W,U)=>(typeof U=="string"&&!W[U]&&(propertyIsDynamicEvent(U)?W[U]=K=>this.listen(w,U,K):propertyIsEvent(U)?W[U]=this.listen(w,U,void 0):U.charCodeAt(0)===36&&(W[U]=async(...K)=>(await D?.(),this.sendMessage(w,U,K)))),W[U])};return new Proxy(Object.create(null),O)}_handleMessage(w){switch(w.type){case 1:return this._handleReplyMessage(w);case 0:return this._handleRequestMessage(w);case 2:return this._handleSubscribeEventMessage(w);case 3:return this._handleEventMessage(w);case 4:return this._handleUnsubscribeEventMessage(w)}}_handleReplyMessage(w){if(!this._pendingReplies[w.seq]){console.warn("Got reply to unknown seq");return}const D=this._pendingReplies[w.seq];if(delete this._pendingReplies[w.seq],w.err){let O=w.err;w.err.$isError&&(O=new Error,O.name=w.err.name,O.message=w.err.message,O.stack=w.err.stack),D.reject(O);return}D.resolve(w.res)}_handleRequestMessage(w){const D=w.req;this._handler.handleMessage(w.channel,w.method,w.args).then(W=>{this._send(new ReplyMessage(this._workerId,D,W,void 0))},W=>{W.detail instanceof Error&&(W.detail=transformErrorForSerialization(W.detail)),this._send(new ReplyMessage(this._workerId,D,void 0,transformErrorForSerialization(W)))})}_handleSubscribeEventMessage(w){const D=w.req,O=this._handler.handleEvent(w.channel,w.eventName,w.arg)(W=>{this._send(new EventMessage(this._workerId,D,W))});this._pendingEvents.set(D,O)}_handleEventMessage(w){if(!this._pendingEmitters.has(w.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(w.req).fire(w.event)}_handleUnsubscribeEventMessage(w){if(!this._pendingEvents.has(w.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(w.req).dispose(),this._pendingEvents.delete(w.req)}_send(w){const D=[];if(w.type===0)for(let O=0;O<w.args.length;O++)w.args[O]instanceof ArrayBuffer&&D.push(w.args[O]);else w.type===1&&w.res instanceof ArrayBuffer&&D.push(w.res);this._handler.sendMessage(w,D)}}class SimpleWorkerClient extends Disposable{constructor(w,D){super(),this._localChannels=new Map,this._worker=this._register(w.create({amdModuleId:"vs/base/common/worker/simpleWorker",esmModuleLocation:D.esmModuleLocation,label:D.label},U=>{this._protocol.handleMessage(U)},U=>{onUnexpectedError(U)})),this._protocol=new SimpleWorkerProtocol({sendMessage:(U,K)=>{this._worker.postMessage(U,K)},handleMessage:(U,K,q)=>this._handleMessage(U,K,q),handleEvent:(U,K,q)=>this._handleEvent(U,K,q)}),this._protocol.setWorkerId(this._worker.getId());let O=null;const W=globalThis.require;typeof W<"u"&&typeof W.getConfig=="function"?O=W.getConfig():typeof globalThis.requirejs<"u"&&(O=globalThis.requirejs.s.contexts._.config),this._onModuleLoaded=this._protocol.sendMessage(DEFAULT_CHANNEL,INITIALIZE,[this._worker.getId(),JSON.parse(JSON.stringify(O)),D.amdModuleId]),this.proxy=this._protocol.createProxyToRemoteChannel(DEFAULT_CHANNEL,async()=>{await this._onModuleLoaded}),this._onModuleLoaded.catch(U=>{this._onError("Worker failed to load "+D.amdModuleId,U)})}_handleMessage(w,D,O){const W=this._localChannels.get(w);if(!W)return Promise.reject(new Error(`Missing channel ${w} on main thread`));if(typeof W[D]!="function")return Promise.reject(new Error(`Missing method ${D} on main thread channel ${w}`));try{return Promise.resolve(W[D].apply(W,O))}catch(U){return Promise.reject(U)}}_handleEvent(w,D,O){const W=this._localChannels.get(w);if(!W)throw new Error(`Missing channel ${w} on main thread`);if(propertyIsDynamicEvent(D)){const U=W[D].call(W,O);if(typeof U!="function")throw new Error(`Missing dynamic event ${D} on main thread channel ${w}.`);return U}if(propertyIsEvent(D)){const U=W[D];if(typeof U!="function")throw new Error(`Missing event ${D} on main thread channel ${w}.`);return U}throw new Error(`Malformed event name ${D}`)}setChannel(w,D){this._localChannels.set(w,D)}_onError(w,D){console.error(w),console.info(D)}}function propertyIsEvent(F){return F[0]==="o"&&F[1]==="n"&&isUpperAsciiLetter(F.charCodeAt(2))}function propertyIsDynamicEvent(F){return/^onDynamic/.test(F)&&isUpperAsciiLetter(F.charCodeAt(9))}let ttPolicy$2;typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope"&&globalThis.workerttPolicy!==void 0?ttPolicy$2=globalThis.workerttPolicy:ttPolicy$2=createTrustedTypesPolicy("defaultWorkerFactory",{createScriptURL:F=>F});function getWorker(F,w){const D=globalThis.MonacoEnvironment;if(D){if(typeof D.getWorker=="function")return D.getWorker("workerMain.js",w);if(typeof D.getWorkerUrl=="function"){const O=D.getWorkerUrl("workerMain.js",w);return new Worker(ttPolicy$2?ttPolicy$2.createScriptURL(O):O,{name:w,type:"module"})}}if(F){const O=getWorkerBootstrapUrl(w,F.toString(!0)),W=new Worker(ttPolicy$2?ttPolicy$2.createScriptURL(O):O,{name:w,type:"module"});return whenESMWorkerReady(W)}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function getWorkerBootstrapUrl(F,w,D){if(!(/^((http:)|(https:)|(file:)|(vscode-file:))/.test(w)&&w.substring(0,globalThis.origin.length)!==globalThis.origin)){const U=w.lastIndexOf("?"),K=w.lastIndexOf("#",U),q=U>0?new URLSearchParams(w.substring(U+1,~K?K:void 0)):new URLSearchParams;COI.addSearchParam(q,!0,!0),q.toString()?w=`${w}?${q.toString()}#${F}`:w=`${w}#${F}`}const W=new Blob([coalesce([`/*${F}*/`,void 0,`globalThis._VSCODE_NLS_MESSAGES = ${JSON.stringify(getNLSMessages())};`,`globalThis._VSCODE_NLS_LANGUAGE = ${JSON.stringify(getNLSLanguage())};`,`globalThis._VSCODE_FILE_ROOT = '${globalThis._VSCODE_FILE_ROOT}';`,"const ttPolicy = globalThis.trustedTypes?.createPolicy('defaultWorkerFactory', { createScriptURL: value => value });","globalThis.workerttPolicy = ttPolicy;",`await import(ttPolicy?.createScriptURL('${w}') ?? '${w}');`,"globalThis.postMessage({ type: 'vscode-worker-ready' });",`/*${F}*/`]).join("")],{type:"application/javascript"});return URL.createObjectURL(W)}function whenESMWorkerReady(F){return new Promise((w,D)=>{F.onmessage=function(O){O.data.type==="vscode-worker-ready"&&(F.onmessage=null,w(F))},F.onerror=D})}function isPromiseLike(F){return typeof F.then=="function"}class WebWorker extends Disposable{constructor(w,D,O,W,U,K){super(),this.id=O,this.label=W;const q=getWorker(w,W);isPromiseLike(q)?this.worker=q:this.worker=Promise.resolve(q),this.postMessage(D,[]),this.worker.then(G=>{G.onmessage=function(Q){U(Q.data)},G.onmessageerror=K,typeof G.addEventListener=="function"&&G.addEventListener("error",K)}),this._register(toDisposable(()=>{this.worker?.then(G=>{G.onmessage=null,G.onmessageerror=null,G.removeEventListener("error",K),G.terminate()}),this.worker=null}))}getId(){return this.id}postMessage(w,D){this.worker?.then(O=>{try{O.postMessage(w,D)}catch(W){onUnexpectedError(W),onUnexpectedError(new Error(`FAILED to post message to '${this.label}'-worker`,{cause:W}))}})}}class WorkerDescriptor{constructor(w,D){this.amdModuleId=w,this.label=D,this.esmModuleLocation=FileAccess.asBrowserUri(`${w}.esm.js`)}}class DefaultWorkerFactory{static{this.LAST_WORKER_ID=0}constructor(){this._webWorkerFailedBeforeError=!1}create(w,D,O){const W=++DefaultWorkerFactory.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new WebWorker(w.esmModuleLocation,w.amdModuleId,W,w.label||"anonymous"+W,D,U=>{logOnceWebWorkerWarning(U),this._webWorkerFailedBeforeError=U,O(U)})}}function createWebWorker$2(F,w){const D=typeof F=="string"?new WorkerDescriptor(F,w):F;return new SimpleWorkerClient(new DefaultWorkerFactory,D)}class DiffChange{constructor(w,D,O,W){this.originalStart=w,this.originalLength=D,this.modifiedStart=O,this.modifiedLength=W}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}class StringDiffSequence{constructor(w){this.source=w}getElements(){const w=this.source,D=new Int32Array(w.length);for(let O=0,W=w.length;O<W;O++)D[O]=w.charCodeAt(O);return D}}function stringDiff(F,w,D){return new LcsDiff(new StringDiffSequence(F),new StringDiffSequence(w)).ComputeDiff(D).changes}class Debug{static Assert(w,D){if(!w)throw new Error(D)}}class MyArray{static Copy(w,D,O,W,U){for(let K=0;K<U;K++)O[W+K]=w[D+K]}static Copy2(w,D,O,W,U){for(let K=0;K<U;K++)O[W+K]=w[D+K]}}class DiffChangeHelper{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new DiffChange(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(w,D){this.m_originalStart=Math.min(this.m_originalStart,w),this.m_modifiedStart=Math.min(this.m_modifiedStart,D),this.m_originalCount++}AddModifiedElement(w,D){this.m_originalStart=Math.min(this.m_originalStart,w),this.m_modifiedStart=Math.min(this.m_modifiedStart,D),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class LcsDiff{constructor(w,D,O=null){this.ContinueProcessingPredicate=O,this._originalSequence=w,this._modifiedSequence=D;const[W,U,K]=LcsDiff._getElements(w),[q,G,Q]=LcsDiff._getElements(D);this._hasStrings=K&&Q,this._originalStringElements=W,this._originalElementsOrHash=U,this._modifiedStringElements=q,this._modifiedElementsOrHash=G,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(w){return w.length>0&&typeof w[0]=="string"}static _getElements(w){const D=w.getElements();if(LcsDiff._isStringArray(D)){const O=new Int32Array(D.length);for(let W=0,U=D.length;W<U;W++)O[W]=stringHash(D[W],0);return[D,O,!0]}return D instanceof Int32Array?[[],D,!1]:[[],new Int32Array(D),!1]}ElementsAreEqual(w,D){return this._originalElementsOrHash[w]!==this._modifiedElementsOrHash[D]?!1:this._hasStrings?this._originalStringElements[w]===this._modifiedStringElements[D]:!0}ElementsAreStrictEqual(w,D){if(!this.ElementsAreEqual(w,D))return!1;const O=LcsDiff._getStrictElement(this._originalSequence,w),W=LcsDiff._getStrictElement(this._modifiedSequence,D);return O===W}static _getStrictElement(w,D){return typeof w.getStrictElement=="function"?w.getStrictElement(D):null}OriginalElementsAreEqual(w,D){return this._originalElementsOrHash[w]!==this._originalElementsOrHash[D]?!1:this._hasStrings?this._originalStringElements[w]===this._originalStringElements[D]:!0}ModifiedElementsAreEqual(w,D){return this._modifiedElementsOrHash[w]!==this._modifiedElementsOrHash[D]?!1:this._hasStrings?this._modifiedStringElements[w]===this._modifiedStringElements[D]:!0}ComputeDiff(w){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,w)}_ComputeDiff(w,D,O,W,U){const K=[!1];let q=this.ComputeDiffRecursive(w,D,O,W,K);return U&&(q=this.PrettifyChanges(q)),{quitEarly:K[0],changes:q}}ComputeDiffRecursive(w,D,O,W,U){for(U[0]=!1;w<=D&&O<=W&&this.ElementsAreEqual(w,O);)w++,O++;for(;D>=w&&W>=O&&this.ElementsAreEqual(D,W);)D--,W--;if(w>D||O>W){let X;return O<=W?(Debug.Assert(w===D+1,"originalStart should only be one more than originalEnd"),X=[new DiffChange(w,0,O,W-O+1)]):w<=D?(Debug.Assert(O===W+1,"modifiedStart should only be one more than modifiedEnd"),X=[new DiffChange(w,D-w+1,O,0)]):(Debug.Assert(w===D+1,"originalStart should only be one more than originalEnd"),Debug.Assert(O===W+1,"modifiedStart should only be one more than modifiedEnd"),X=[]),X}const K=[0],q=[0],G=this.ComputeRecursionPoint(w,D,O,W,K,q,U),Q=K[0],Y=q[0];if(G!==null)return G;if(!U[0]){const X=this.ComputeDiffRecursive(w,Q,O,Y,U);let J=[];return U[0]?J=[new DiffChange(Q+1,D-(Q+1)+1,Y+1,W-(Y+1)+1)]:J=this.ComputeDiffRecursive(Q+1,D,Y+1,W,U),this.ConcatenateChanges(X,J)}return[new DiffChange(w,D-w+1,O,W-O+1)]}WALKTRACE(w,D,O,W,U,K,q,G,Q,Y,X,J,te,ie,se,re,ae,le){let de=null,oe=null,ue=new DiffChangeHelper,pe=D,fe=O,Ce=te[0]-re[0]-W,we=-1073741824,Oe=this.m_forwardHistory.length-1;do{const Te=Ce+w;Te===pe||Te<fe&&Q[Te-1]<Q[Te+1]?(X=Q[Te+1],ie=X-Ce-W,X<we&&ue.MarkNextChange(),we=X,ue.AddModifiedElement(X+1,ie),Ce=Te+1-w):(X=Q[Te-1]+1,ie=X-Ce-W,X<we&&ue.MarkNextChange(),we=X-1,ue.AddOriginalElement(X,ie+1),Ce=Te-1-w),Oe>=0&&(Q=this.m_forwardHistory[Oe],w=Q[0],pe=1,fe=Q.length-1)}while(--Oe>=-1);if(de=ue.getReverseChanges(),le[0]){let Te=te[0]+1,Re=re[0]+1;if(de!==null&&de.length>0){const Me=de[de.length-1];Te=Math.max(Te,Me.getOriginalEnd()),Re=Math.max(Re,Me.getModifiedEnd())}oe=[new DiffChange(Te,J-Te+1,Re,se-Re+1)]}else{ue=new DiffChangeHelper,pe=K,fe=q,Ce=te[0]-re[0]-G,we=1073741824,Oe=ae?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const Te=Ce+U;Te===pe||Te<fe&&Y[Te-1]>=Y[Te+1]?(X=Y[Te+1]-1,ie=X-Ce-G,X>we&&ue.MarkNextChange(),we=X+1,ue.AddOriginalElement(X+1,ie+1),Ce=Te+1-U):(X=Y[Te-1],ie=X-Ce-G,X>we&&ue.MarkNextChange(),we=X,ue.AddModifiedElement(X+1,ie+1),Ce=Te-1-U),Oe>=0&&(Y=this.m_reverseHistory[Oe],U=Y[0],pe=1,fe=Y.length-1)}while(--Oe>=-1);oe=ue.getChanges()}return this.ConcatenateChanges(de,oe)}ComputeRecursionPoint(w,D,O,W,U,K,q){let G=0,Q=0,Y=0,X=0,J=0,te=0;w--,O--,U[0]=0,K[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const ie=D-w+(W-O),se=ie+1,re=new Int32Array(se),ae=new Int32Array(se),le=W-O,de=D-w,oe=w-O,ue=D-W,fe=(de-le)%2===0;re[le]=w,ae[de]=D,q[0]=!1;for(let Ce=1;Ce<=ie/2+1;Ce++){let we=0,Oe=0;Y=this.ClipDiagonalBound(le-Ce,Ce,le,se),X=this.ClipDiagonalBound(le+Ce,Ce,le,se);for(let Re=Y;Re<=X;Re+=2){Re===Y||Re<X&&re[Re-1]<re[Re+1]?G=re[Re+1]:G=re[Re-1]+1,Q=G-(Re-le)-oe;const Me=G;for(;G<D&&Q<W&&this.ElementsAreEqual(G+1,Q+1);)G++,Q++;if(re[Re]=G,G+Q>we+Oe&&(we=G,Oe=Q),!fe&&Math.abs(Re-de)<=Ce-1&&G>=ae[Re])return U[0]=G,K[0]=Q,Me<=ae[Re]&&Ce<=1448?this.WALKTRACE(le,Y,X,oe,de,J,te,ue,re,ae,G,D,U,Q,W,K,fe,q):null}const Te=(we-w+(Oe-O)-Ce)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(we,Te))return q[0]=!0,U[0]=we,K[0]=Oe,Te>0&&Ce<=1448?this.WALKTRACE(le,Y,X,oe,de,J,te,ue,re,ae,G,D,U,Q,W,K,fe,q):(w++,O++,[new DiffChange(w,D-w+1,O,W-O+1)]);J=this.ClipDiagonalBound(de-Ce,Ce,de,se),te=this.ClipDiagonalBound(de+Ce,Ce,de,se);for(let Re=J;Re<=te;Re+=2){Re===J||Re<te&&ae[Re-1]>=ae[Re+1]?G=ae[Re+1]-1:G=ae[Re-1],Q=G-(Re-de)-ue;const Me=G;for(;G>w&&Q>O&&this.ElementsAreEqual(G,Q);)G--,Q--;if(ae[Re]=G,fe&&Math.abs(Re-le)<=Ce&&G<=re[Re])return U[0]=G,K[0]=Q,Me>=re[Re]&&Ce<=1448?this.WALKTRACE(le,Y,X,oe,de,J,te,ue,re,ae,G,D,U,Q,W,K,fe,q):null}if(Ce<=1447){let Re=new Int32Array(X-Y+2);Re[0]=le-Y+1,MyArray.Copy2(re,Y,Re,1,X-Y+1),this.m_forwardHistory.push(Re),Re=new Int32Array(te-J+2),Re[0]=de-J+1,MyArray.Copy2(ae,J,Re,1,te-J+1),this.m_reverseHistory.push(Re)}}return this.WALKTRACE(le,Y,X,oe,de,J,te,ue,re,ae,G,D,U,Q,W,K,fe,q)}PrettifyChanges(w){for(let D=0;D<w.length;D++){const O=w[D],W=D<w.length-1?w[D+1].originalStart:this._originalElementsOrHash.length,U=D<w.length-1?w[D+1].modifiedStart:this._modifiedElementsOrHash.length,K=O.originalLength>0,q=O.modifiedLength>0;for(;O.originalStart+O.originalLength<W&&O.modifiedStart+O.modifiedLength<U&&(!K||this.OriginalElementsAreEqual(O.originalStart,O.originalStart+O.originalLength))&&(!q||this.ModifiedElementsAreEqual(O.modifiedStart,O.modifiedStart+O.modifiedLength));){const Q=this.ElementsAreStrictEqual(O.originalStart,O.modifiedStart);if(this.ElementsAreStrictEqual(O.originalStart+O.originalLength,O.modifiedStart+O.modifiedLength)&&!Q)break;O.originalStart++,O.modifiedStart++}const G=[null];if(D<w.length-1&&this.ChangesOverlap(w[D],w[D+1],G)){w[D]=G[0],w.splice(D+1,1),D--;continue}}for(let D=w.length-1;D>=0;D--){const O=w[D];let W=0,U=0;if(D>0){const X=w[D-1];W=X.originalStart+X.originalLength,U=X.modifiedStart+X.modifiedLength}const K=O.originalLength>0,q=O.modifiedLength>0;let G=0,Q=this._boundaryScore(O.originalStart,O.originalLength,O.modifiedStart,O.modifiedLength);for(let X=1;;X++){const J=O.originalStart-X,te=O.modifiedStart-X;if(J<W||te<U||K&&!this.OriginalElementsAreEqual(J,J+O.originalLength)||q&&!this.ModifiedElementsAreEqual(te,te+O.modifiedLength))break;const se=(J===W&&te===U?5:0)+this._boundaryScore(J,O.originalLength,te,O.modifiedLength);se>Q&&(Q=se,G=X)}O.originalStart-=G,O.modifiedStart-=G;const Y=[null];if(D>0&&this.ChangesOverlap(w[D-1],w[D],Y)){w[D-1]=Y[0],w.splice(D,1),D++;continue}}if(this._hasStrings)for(let D=1,O=w.length;D<O;D++){const W=w[D-1],U=w[D],K=U.originalStart-W.originalStart-W.originalLength,q=W.originalStart,G=U.originalStart+U.originalLength,Q=G-q,Y=W.modifiedStart,X=U.modifiedStart+U.modifiedLength,J=X-Y;if(K<5&&Q<20&&J<20){const te=this._findBetterContiguousSequence(q,Q,Y,J,K);if(te){const[ie,se]=te;(ie!==W.originalStart+W.originalLength||se!==W.modifiedStart+W.modifiedLength)&&(W.originalLength=ie-W.originalStart,W.modifiedLength=se-W.modifiedStart,U.originalStart=ie+K,U.modifiedStart=se+K,U.originalLength=G-U.originalStart,U.modifiedLength=X-U.modifiedStart)}}}return w}_findBetterContiguousSequence(w,D,O,W,U){if(D<U||W<U)return null;const K=w+D-U+1,q=O+W-U+1;let G=0,Q=0,Y=0;for(let X=w;X<K;X++)for(let J=O;J<q;J++){const te=this._contiguousSequenceScore(X,J,U);te>0&&te>G&&(G=te,Q=X,Y=J)}return G>0?[Q,Y]:null}_contiguousSequenceScore(w,D,O){let W=0;for(let U=0;U<O;U++){if(!this.ElementsAreEqual(w+U,D+U))return 0;W+=this._originalStringElements[w+U].length}return W}_OriginalIsBoundary(w){return w<=0||w>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[w])}_OriginalRegionIsBoundary(w,D){if(this._OriginalIsBoundary(w)||this._OriginalIsBoundary(w-1))return!0;if(D>0){const O=w+D;if(this._OriginalIsBoundary(O-1)||this._OriginalIsBoundary(O))return!0}return!1}_ModifiedIsBoundary(w){return w<=0||w>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[w])}_ModifiedRegionIsBoundary(w,D){if(this._ModifiedIsBoundary(w)||this._ModifiedIsBoundary(w-1))return!0;if(D>0){const O=w+D;if(this._ModifiedIsBoundary(O-1)||this._ModifiedIsBoundary(O))return!0}return!1}_boundaryScore(w,D,O,W){const U=this._OriginalRegionIsBoundary(w,D)?1:0,K=this._ModifiedRegionIsBoundary(O,W)?1:0;return U+K}ConcatenateChanges(w,D){const O=[];if(w.length===0||D.length===0)return D.length>0?D:w;if(this.ChangesOverlap(w[w.length-1],D[0],O)){const W=new Array(w.length+D.length-1);return MyArray.Copy(w,0,W,0,w.length-1),W[w.length-1]=O[0],MyArray.Copy(D,1,W,w.length,D.length-1),W}else{const W=new Array(w.length+D.length);return MyArray.Copy(w,0,W,0,w.length),MyArray.Copy(D,0,W,w.length,D.length),W}}ChangesOverlap(w,D,O){if(Debug.Assert(w.originalStart<=D.originalStart,"Left change is not less than or equal to right change"),Debug.Assert(w.modifiedStart<=D.modifiedStart,"Left change is not less than or equal to right change"),w.originalStart+w.originalLength>=D.originalStart||w.modifiedStart+w.modifiedLength>=D.modifiedStart){const W=w.originalStart;let U=w.originalLength;const K=w.modifiedStart;let q=w.modifiedLength;return w.originalStart+w.originalLength>=D.originalStart&&(U=D.originalStart+D.originalLength-w.originalStart),w.modifiedStart+w.modifiedLength>=D.modifiedStart&&(q=D.modifiedStart+D.modifiedLength-w.modifiedStart),O[0]=new DiffChange(W,U,K,q),!0}else return O[0]=null,!1}ClipDiagonalBound(w,D,O,W){if(w>=0&&w<W)return w;const U=O,K=W-O-1,q=D%2===0;if(w<0){const G=U%2===0;return q===G?0:1}else{const G=K%2===0;return q===G?W-1:W-2}}}class Uint8Matrix{constructor(w,D,O){const W=new Uint8Array(w*D);for(let U=0,K=w*D;U<K;U++)W[U]=O;this._data=W,this.rows=w,this.cols=D}get(w,D){return this._data[w*this.cols+D]}set(w,D,O){this._data[w*this.cols+D]=O}}class StateMachine{constructor(w){let D=0,O=0;for(let U=0,K=w.length;U<K;U++){const[q,G,Q]=w[U];G>D&&(D=G),q>O&&(O=q),Q>O&&(O=Q)}D++,O++;const W=new Uint8Matrix(O,D,0);for(let U=0,K=w.length;U<K;U++){const[q,G,Q]=w[U];W.set(q,G,Q)}this._states=W,this._maxCharCode=D}nextState(w,D){return D<0||D>=this._maxCharCode?0:this._states.get(w,D)}}let _stateMachine=null;function getStateMachine(){return _stateMachine===null&&(_stateMachine=new StateMachine([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),_stateMachine}let _classifier=null;function getClassifier(){if(_classifier===null){_classifier=new CharacterClassifier(0);const F=` 	<>'"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…`;for(let D=0;D<F.length;D++)_classifier.set(F.charCodeAt(D),1);const w=".,;:";for(let D=0;D<w.length;D++)_classifier.set(w.charCodeAt(D),2)}return _classifier}class LinkComputer{static _createLink(w,D,O,W,U){let K=U-1;do{const q=D.charCodeAt(K);if(w.get(q)!==2)break;K--}while(K>W);if(W>0){const q=D.charCodeAt(W-1),G=D.charCodeAt(K);(q===40&&G===41||q===91&&G===93||q===123&&G===125)&&K--}return{range:{startLineNumber:O,startColumn:W+1,endLineNumber:O,endColumn:K+2},url:D.substring(W,K+1)}}static computeLinks(w,D=getStateMachine()){const O=getClassifier(),W=[];for(let U=1,K=w.getLineCount();U<=K;U++){const q=w.getLineContent(U),G=q.length;let Q=0,Y=0,X=0,J=1,te=!1,ie=!1,se=!1,re=!1;for(;Q<G;){let ae=!1;const le=q.charCodeAt(Q);if(J===13){let de;switch(le){case 40:te=!0,de=0;break;case 41:de=te?0:1;break;case 91:se=!0,ie=!0,de=0;break;case 93:se=!1,de=ie?0:1;break;case 123:re=!0,de=0;break;case 125:de=re?0:1;break;case 39:case 34:case 96:X===le?de=1:X===39||X===34||X===96?de=0:de=1;break;case 42:de=X===42?1:0;break;case 124:de=X===124?1:0;break;case 32:de=se?0:1;break;default:de=O.get(le)}de===1&&(W.push(LinkComputer._createLink(O,q,U,Y,Q)),ae=!0)}else if(J===12){let de;le===91?(ie=!0,de=0):de=O.get(le),de===1?ae=!0:J=13}else J=D.nextState(J,le),J===0&&(ae=!0);ae&&(J=1,te=!1,ie=!1,re=!1,Y=Q+1,X=le),Q++}J===13&&W.push(LinkComputer._createLink(O,q,U,Y,G))}return W}}function computeLinks(F){return!F||typeof F.getLineCount!="function"||typeof F.getLineContent!="function"?[]:LinkComputer.computeLinks(F)}class BasicInplaceReplace{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}static{this.INSTANCE=new BasicInplaceReplace}navigateValueSet(w,D,O,W,U){if(w&&D){const K=this.doNavigateValueSet(D,U);if(K)return{range:w,value:K}}if(O&&W){const K=this.doNavigateValueSet(W,U);if(K)return{range:O,value:K}}return null}doNavigateValueSet(w,D){const O=this.numberReplace(w,D);return O!==null?O:this.textReplace(w,D)}numberReplace(w,D){const O=Math.pow(10,w.length-(w.lastIndexOf(".")+1));let W=Number(w);const U=parseFloat(w);return!isNaN(W)&&!isNaN(U)&&W===U?W===0&&!D?null:(W=Math.floor(W*O),W+=D?O:-O,String(W/O)):null}textReplace(w,D){return this.valueSetsReplace(this._defaultValueSet,w,D)}valueSetsReplace(w,D,O){let W=null;for(let U=0,K=w.length;W===null&&U<K;U++)W=this.valueSetReplace(w[U],D,O);return W}valueSetReplace(w,D,O){let W=w.indexOf(D);return W>=0?(W+=O?1:-1,W<0?W=w.length-1:W%=w.length,w[W]):null}}class EditorWorkerHost{static{this.CHANNEL_NAME="editorWorkerHost"}static getChannel(w){return w.getChannel(EditorWorkerHost.CHANNEL_NAME)}static setChannel(w,D){w.setChannel(EditorWorkerHost.CHANNEL_NAME,D)}}class UnicodeTextModelHighlighter{static computeUnicodeHighlights(w,D,O){const W=O?O.startLineNumber:1,U=O?O.endLineNumber:w.getLineCount(),K=new CodePointHighlighter(D),q=K.getCandidateCodePoints();let G;q==="allNonBasicAscii"?G=new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):G=new RegExp(`${buildRegExpCharClassExpr(Array.from(q))}`,"g");const Q=new Searcher(null,G),Y=[];let X=!1,J,te=0,ie=0,se=0;e:for(let re=W,ae=U;re<=ae;re++){const le=w.getLineContent(re),de=le.length;Q.reset(0);do if(J=Q.next(le),J){let oe=J.index,ue=J.index+J[0].length;if(oe>0){const we=le.charCodeAt(oe-1);isHighSurrogate(we)&&oe--}if(ue+1<de){const we=le.charCodeAt(ue-1);isHighSurrogate(we)&&ue++}const pe=le.substring(oe,ue);let fe=getWordAtText(oe+1,DEFAULT_WORD_REGEXP,le,0);fe&&fe.endColumn<=oe+1&&(fe=null);const Ce=K.shouldHighlightNonBasicASCII(pe,fe?fe.word:null);if(Ce!==0){if(Ce===3?te++:Ce===2?ie++:Ce===1?se++:assertNever(),Y.length>=1e3){X=!0;break e}Y.push(new Range$2(re,oe+1,re,ue+1))}}while(J)}return{ranges:Y,hasMore:X,ambiguousCharacterCount:te,invisibleCharacterCount:ie,nonBasicAsciiCharacterCount:se}}static computeUnicodeHighlightReason(w,D){const O=new CodePointHighlighter(D);switch(O.shouldHighlightNonBasicASCII(w,null)){case 0:return null;case 2:return{kind:1};case 3:{const U=w.codePointAt(0),K=O.ambiguousCharacters.getPrimaryConfusable(U),q=AmbiguousCharacters.getLocales().filter(G=>!AmbiguousCharacters.getInstance(new Set([...D.allowedLocales,G])).isAmbiguous(U));return{kind:0,confusableWith:String.fromCodePoint(K),notAmbiguousInLocales:q}}case 1:return{kind:2}}}}function buildRegExpCharClassExpr(F,w){return`[${escapeRegExpCharacters(F.map(O=>String.fromCodePoint(O)).join(""))}]`}class CodePointHighlighter{constructor(w){this.options=w,this.allowedCodePoints=new Set(w.allowedCodePoints),this.ambiguousCharacters=AmbiguousCharacters.getInstance(new Set(w.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const w=new Set;if(this.options.invisibleCharacters)for(const D of InvisibleCharacters.codePoints)isAllowedInvisibleCharacter(String.fromCodePoint(D))||w.add(D);if(this.options.ambiguousCharacters)for(const D of this.ambiguousCharacters.getConfusableCodePoints())w.add(D);for(const D of this.allowedCodePoints)w.delete(D);return w}shouldHighlightNonBasicASCII(w,D){const O=w.codePointAt(0);if(this.allowedCodePoints.has(O))return 0;if(this.options.nonBasicASCII)return 1;let W=!1,U=!1;if(D)for(const K of D){const q=K.codePointAt(0),G=isBasicASCII(K);W=W||G,!G&&!this.ambiguousCharacters.isAmbiguous(q)&&!InvisibleCharacters.isInvisibleCharacter(q)&&(U=!0)}return!W&&U?0:this.options.invisibleCharacters&&!isAllowedInvisibleCharacter(w)&&InvisibleCharacters.isInvisibleCharacter(O)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(O)?3:0}}function isAllowedInvisibleCharacter(F){return F===" "||F===`
`||F==="	"}class LinesDiff{constructor(w,D,O){this.changes=w,this.moves=D,this.hitTimeout=O}}class MovedText{constructor(w,D){this.lineRangeMapping=w,this.changes=D}}class PositionOffsetTransformer{constructor(w){this.text=w,this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let D=0;D<w.length;D++)w.charAt(D)===`
`&&this.lineStartOffsetByLineIdx.push(D+1)}getOffset(w){return this.lineStartOffsetByLineIdx[w.lineNumber-1]+w.column-1}getOffsetRange(w){return new OffsetRange(this.getOffset(w.getStartPosition()),this.getOffset(w.getEndPosition()))}get textLength(){const w=this.lineStartOffsetByLineIdx.length-1;return new TextLength(w,this.text.length-this.lineStartOffsetByLineIdx[w])}}class TextEdit{constructor(w){this.edits=w,assertFn(()=>checkAdjacentItems(w,(D,O)=>D.range.getEndPosition().isBeforeOrEqual(O.range.getStartPosition())))}apply(w){let D="",O=new Position$1(1,1);for(const U of this.edits){const K=U.range,q=K.getStartPosition(),G=K.getEndPosition(),Q=rangeFromPositions(O,q);Q.isEmpty()||(D+=w.getValueOfRange(Q)),D+=U.text,O=G}const W=rangeFromPositions(O,w.endPositionExclusive);return W.isEmpty()||(D+=w.getValueOfRange(W)),D}applyToString(w){const D=new StringText(w);return this.apply(D)}getNewRanges(){const w=[];let D=0,O=0,W=0;for(const U of this.edits){const K=TextLength.ofText(U.text),q=Position$1.lift({lineNumber:U.range.startLineNumber+O,column:U.range.startColumn+(U.range.startLineNumber===D?W:0)}),G=K.createRange(q);w.push(G),O=G.endLineNumber-U.range.endLineNumber,W=G.endColumn-U.range.endColumn,D=U.range.endLineNumber}return w}}class SingleTextEdit{constructor(w,D){this.range=w,this.text=D}toSingleEditOperation(){return{range:this.range,text:this.text}}}function rangeFromPositions(F,w){if(F.lineNumber===w.lineNumber&&F.column===Number.MAX_SAFE_INTEGER)return Range$2.fromPositions(w,w);if(!F.isBeforeOrEqual(w))throw new BugIndicatingError("start must be before end");return new Range$2(F.lineNumber,F.column,w.lineNumber,w.column)}class AbstractText{get endPositionExclusive(){return this.length.addToPosition(new Position$1(1,1))}}class StringText extends AbstractText{constructor(w){super(),this.value=w,this._t=new PositionOffsetTransformer(this.value)}getValueOfRange(w){return this._t.getOffsetRange(w).substring(this.value)}get length(){return this._t.textLength}}class LineRangeMapping{static inverse(w,D,O){const W=[];let U=1,K=1;for(const G of w){const Q=new LineRangeMapping(new LineRange$1(U,G.original.startLineNumber),new LineRange$1(K,G.modified.startLineNumber));Q.modified.isEmpty||W.push(Q),U=G.original.endLineNumberExclusive,K=G.modified.endLineNumberExclusive}const q=new LineRangeMapping(new LineRange$1(U,D+1),new LineRange$1(K,O+1));return q.modified.isEmpty||W.push(q),W}static clip(w,D,O){const W=[];for(const U of w){const K=U.original.intersect(D),q=U.modified.intersect(O);K&&!K.isEmpty&&q&&!q.isEmpty&&W.push(new LineRangeMapping(K,q))}return W}constructor(w,D){this.original=w,this.modified=D}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new LineRangeMapping(this.modified,this.original)}join(w){return new LineRangeMapping(this.original.join(w.original),this.modified.join(w.modified))}toRangeMapping(){const w=this.original.toInclusiveRange(),D=this.modified.toInclusiveRange();if(w&&D)return new RangeMapping(w,D);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new BugIndicatingError("not a valid diff");return new RangeMapping(new Range$2(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new Range$2(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new RangeMapping(new Range$2(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new Range$2(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(w,D){if(isValidLineNumber(this.original.endLineNumberExclusive,w)&&isValidLineNumber(this.modified.endLineNumberExclusive,D))return new RangeMapping(new Range$2(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new Range$2(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new RangeMapping(Range$2.fromPositions(new Position$1(this.original.startLineNumber,1),normalizePosition(new Position$1(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),w)),Range$2.fromPositions(new Position$1(this.modified.startLineNumber,1),normalizePosition(new Position$1(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),D)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new RangeMapping(Range$2.fromPositions(normalizePosition(new Position$1(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),w),normalizePosition(new Position$1(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),w)),Range$2.fromPositions(normalizePosition(new Position$1(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),D),normalizePosition(new Position$1(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),D)));throw new BugIndicatingError}}function normalizePosition(F,w){if(F.lineNumber<1)return new Position$1(1,1);if(F.lineNumber>w.length)return new Position$1(w.length,w[w.length-1].length+1);const D=w[F.lineNumber-1];return F.column>D.length+1?new Position$1(F.lineNumber,D.length+1):F}function isValidLineNumber(F,w){return F>=1&&F<=w.length}class DetailedLineRangeMapping extends LineRangeMapping{static fromRangeMappings(w){const D=LineRange$1.join(w.map(W=>LineRange$1.fromRangeInclusive(W.originalRange))),O=LineRange$1.join(w.map(W=>LineRange$1.fromRangeInclusive(W.modifiedRange)));return new DetailedLineRangeMapping(D,O,w)}constructor(w,D,O){super(w,D),this.innerChanges=O}flip(){return new DetailedLineRangeMapping(this.modified,this.original,this.innerChanges?.map(w=>w.flip()))}withInnerChangesFromLineRanges(){return new DetailedLineRangeMapping(this.original,this.modified,[this.toRangeMapping()])}}class RangeMapping{static assertSorted(w){for(let D=1;D<w.length;D++){const O=w[D-1],W=w[D];if(!(O.originalRange.getEndPosition().isBeforeOrEqual(W.originalRange.getStartPosition())&&O.modifiedRange.getEndPosition().isBeforeOrEqual(W.modifiedRange.getStartPosition())))throw new BugIndicatingError("Range mappings must be sorted")}}constructor(w,D){this.originalRange=w,this.modifiedRange=D}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new RangeMapping(this.modifiedRange,this.originalRange)}toTextEdit(w){const D=w.getValueOfRange(this.modifiedRange);return new SingleTextEdit(this.originalRange,D)}}const MINIMUM_MATCHING_CHARACTER_LENGTH=3;class LegacyLinesDiffComputer{computeDiff(w,D,O){const U=new DiffComputer(w,D,{maxComputationTime:O.maxComputationTimeMs,shouldIgnoreTrimWhitespace:O.ignoreTrimWhitespace,shouldComputeCharChanges:!0,shouldMakePrettyDiff:!0,shouldPostProcessCharChanges:!0}).computeDiff(),K=[];let q=null;for(const G of U.changes){let Q;G.originalEndLineNumber===0?Q=new LineRange$1(G.originalStartLineNumber+1,G.originalStartLineNumber+1):Q=new LineRange$1(G.originalStartLineNumber,G.originalEndLineNumber+1);let Y;G.modifiedEndLineNumber===0?Y=new LineRange$1(G.modifiedStartLineNumber+1,G.modifiedStartLineNumber+1):Y=new LineRange$1(G.modifiedStartLineNumber,G.modifiedEndLineNumber+1);let X=new DetailedLineRangeMapping(Q,Y,G.charChanges?.map(J=>new RangeMapping(new Range$2(J.originalStartLineNumber,J.originalStartColumn,J.originalEndLineNumber,J.originalEndColumn),new Range$2(J.modifiedStartLineNumber,J.modifiedStartColumn,J.modifiedEndLineNumber,J.modifiedEndColumn))));q&&(q.modified.endLineNumberExclusive===X.modified.startLineNumber||q.original.endLineNumberExclusive===X.original.startLineNumber)&&(X=new DetailedLineRangeMapping(q.original.join(X.original),q.modified.join(X.modified),q.innerChanges&&X.innerChanges?q.innerChanges.concat(X.innerChanges):void 0),K.pop()),K.push(X),q=X}return assertFn(()=>checkAdjacentItems(K,(G,Q)=>Q.original.startLineNumber-G.original.endLineNumberExclusive===Q.modified.startLineNumber-G.modified.endLineNumberExclusive&&G.original.endLineNumberExclusive<Q.original.startLineNumber&&G.modified.endLineNumberExclusive<Q.modified.startLineNumber)),new LinesDiff(K,[],U.quitEarly)}}function computeDiff(F,w,D,O){return new LcsDiff(F,w,D).ComputeDiff(O)}let LineSequence$1=class{constructor(w){const D=[],O=[];for(let W=0,U=w.length;W<U;W++)D[W]=getFirstNonBlankColumn(w[W],1),O[W]=getLastNonBlankColumn(w[W],1);this.lines=w,this._startColumns=D,this._endColumns=O}getElements(){const w=[];for(let D=0,O=this.lines.length;D<O;D++)w[D]=this.lines[D].substring(this._startColumns[D]-1,this._endColumns[D]-1);return w}getStrictElement(w){return this.lines[w]}getStartLineNumber(w){return w+1}getEndLineNumber(w){return w+1}createCharSequence(w,D,O){const W=[],U=[],K=[];let q=0;for(let G=D;G<=O;G++){const Q=this.lines[G],Y=w?this._startColumns[G]:1,X=w?this._endColumns[G]:Q.length+1;for(let J=Y;J<X;J++)W[q]=Q.charCodeAt(J-1),U[q]=G+1,K[q]=J,q++;!w&&G<O&&(W[q]=10,U[q]=G+1,K[q]=Q.length+1,q++)}return new CharSequence(W,U,K)}};class CharSequence{constructor(w,D,O){this._charCodes=w,this._lineNumbers=D,this._columns=O}toString(){return"["+this._charCodes.map((w,D)=>(w===10?"\\n":String.fromCharCode(w))+`-(${this._lineNumbers[D]},${this._columns[D]})`).join(", ")+"]"}_assertIndex(w,D){if(w<0||w>=D.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(w){return w>0&&w===this._lineNumbers.length?this.getEndLineNumber(w-1):(this._assertIndex(w,this._lineNumbers),this._lineNumbers[w])}getEndLineNumber(w){return w===-1?this.getStartLineNumber(w+1):(this._assertIndex(w,this._lineNumbers),this._charCodes[w]===10?this._lineNumbers[w]+1:this._lineNumbers[w])}getStartColumn(w){return w>0&&w===this._columns.length?this.getEndColumn(w-1):(this._assertIndex(w,this._columns),this._columns[w])}getEndColumn(w){return w===-1?this.getStartColumn(w+1):(this._assertIndex(w,this._columns),this._charCodes[w]===10?1:this._columns[w]+1)}}class CharChange{constructor(w,D,O,W,U,K,q,G){this.originalStartLineNumber=w,this.originalStartColumn=D,this.originalEndLineNumber=O,this.originalEndColumn=W,this.modifiedStartLineNumber=U,this.modifiedStartColumn=K,this.modifiedEndLineNumber=q,this.modifiedEndColumn=G}static createFromDiffChange(w,D,O){const W=D.getStartLineNumber(w.originalStart),U=D.getStartColumn(w.originalStart),K=D.getEndLineNumber(w.originalStart+w.originalLength-1),q=D.getEndColumn(w.originalStart+w.originalLength-1),G=O.getStartLineNumber(w.modifiedStart),Q=O.getStartColumn(w.modifiedStart),Y=O.getEndLineNumber(w.modifiedStart+w.modifiedLength-1),X=O.getEndColumn(w.modifiedStart+w.modifiedLength-1);return new CharChange(W,U,K,q,G,Q,Y,X)}}function postProcessCharChanges(F){if(F.length<=1)return F;const w=[F[0]];let D=w[0];for(let O=1,W=F.length;O<W;O++){const U=F[O],K=U.originalStart-(D.originalStart+D.originalLength),q=U.modifiedStart-(D.modifiedStart+D.modifiedLength);Math.min(K,q)<MINIMUM_MATCHING_CHARACTER_LENGTH?(D.originalLength=U.originalStart+U.originalLength-D.originalStart,D.modifiedLength=U.modifiedStart+U.modifiedLength-D.modifiedStart):(w.push(U),D=U)}return w}class LineChange{constructor(w,D,O,W,U){this.originalStartLineNumber=w,this.originalEndLineNumber=D,this.modifiedStartLineNumber=O,this.modifiedEndLineNumber=W,this.charChanges=U}static createFromDiffResult(w,D,O,W,U,K,q){let G,Q,Y,X,J;if(D.originalLength===0?(G=O.getStartLineNumber(D.originalStart)-1,Q=0):(G=O.getStartLineNumber(D.originalStart),Q=O.getEndLineNumber(D.originalStart+D.originalLength-1)),D.modifiedLength===0?(Y=W.getStartLineNumber(D.modifiedStart)-1,X=0):(Y=W.getStartLineNumber(D.modifiedStart),X=W.getEndLineNumber(D.modifiedStart+D.modifiedLength-1)),K&&D.originalLength>0&&D.originalLength<20&&D.modifiedLength>0&&D.modifiedLength<20&&U()){const te=O.createCharSequence(w,D.originalStart,D.originalStart+D.originalLength-1),ie=W.createCharSequence(w,D.modifiedStart,D.modifiedStart+D.modifiedLength-1);if(te.getElements().length>0&&ie.getElements().length>0){let se=computeDiff(te,ie,U,!0).changes;q&&(se=postProcessCharChanges(se)),J=[];for(let re=0,ae=se.length;re<ae;re++)J.push(CharChange.createFromDiffChange(se[re],te,ie))}}return new LineChange(G,Q,Y,X,J)}}class DiffComputer{constructor(w,D,O){this.shouldComputeCharChanges=O.shouldComputeCharChanges,this.shouldPostProcessCharChanges=O.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=O.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=O.shouldMakePrettyDiff,this.originalLines=w,this.modifiedLines=D,this.original=new LineSequence$1(w),this.modified=new LineSequence$1(D),this.continueLineDiff=createContinueProcessingPredicate(O.maxComputationTime),this.continueCharDiff=createContinueProcessingPredicate(O.maxComputationTime===0?0:Math.min(O.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:void 0}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:void 0}]};const w=computeDiff(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),D=w.changes,O=w.quitEarly;if(this.shouldIgnoreTrimWhitespace){const q=[];for(let G=0,Q=D.length;G<Q;G++)q.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace,D[G],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:O,changes:q}}const W=[];let U=0,K=0;for(let q=-1,G=D.length;q<G;q++){const Q=q+1<G?D[q+1]:null,Y=Q?Q.originalStart:this.originalLines.length,X=Q?Q.modifiedStart:this.modifiedLines.length;for(;U<Y&&K<X;){const J=this.originalLines[U],te=this.modifiedLines[K];if(J!==te){{let ie=getFirstNonBlankColumn(J,1),se=getFirstNonBlankColumn(te,1);for(;ie>1&&se>1;){const re=J.charCodeAt(ie-2),ae=te.charCodeAt(se-2);if(re!==ae)break;ie--,se--}(ie>1||se>1)&&this._pushTrimWhitespaceCharChange(W,U+1,1,ie,K+1,1,se)}{let ie=getLastNonBlankColumn(J,1),se=getLastNonBlankColumn(te,1);const re=J.length+1,ae=te.length+1;for(;ie<re&&se<ae;){const le=J.charCodeAt(ie-1),de=J.charCodeAt(se-1);if(le!==de)break;ie++,se++}(ie<re||se<ae)&&this._pushTrimWhitespaceCharChange(W,U+1,ie,re,K+1,se,ae)}}U++,K++}Q&&(W.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace,Q,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),U+=Q.originalLength,K+=Q.modifiedLength)}return{quitEarly:O,changes:W}}_pushTrimWhitespaceCharChange(w,D,O,W,U,K,q){if(this._mergeTrimWhitespaceCharChange(w,D,O,W,U,K,q))return;let G;this.shouldComputeCharChanges&&(G=[new CharChange(D,O,D,W,U,K,U,q)]),w.push(new LineChange(D,D,U,U,G))}_mergeTrimWhitespaceCharChange(w,D,O,W,U,K,q){const G=w.length;if(G===0)return!1;const Q=w[G-1];return Q.originalEndLineNumber===0||Q.modifiedEndLineNumber===0?!1:Q.originalEndLineNumber===D&&Q.modifiedEndLineNumber===U?(this.shouldComputeCharChanges&&Q.charChanges&&Q.charChanges.push(new CharChange(D,O,D,W,U,K,U,q)),!0):Q.originalEndLineNumber+1===D&&Q.modifiedEndLineNumber+1===U?(Q.originalEndLineNumber=D,Q.modifiedEndLineNumber=U,this.shouldComputeCharChanges&&Q.charChanges&&Q.charChanges.push(new CharChange(D,O,D,W,U,K,U,q)),!0):!1}}function getFirstNonBlankColumn(F,w){const D=firstNonWhitespaceIndex(F);return D===-1?w:D+1}function getLastNonBlankColumn(F,w){const D=lastNonWhitespaceIndex(F);return D===-1?w:D+2}function createContinueProcessingPredicate(F){if(F===0)return()=>!0;const w=Date.now();return()=>Date.now()-w<F}class DiffAlgorithmResult{static trivial(w,D){return new DiffAlgorithmResult([new SequenceDiff(OffsetRange.ofLength(w.length),OffsetRange.ofLength(D.length))],!1)}static trivialTimedOut(w,D){return new DiffAlgorithmResult([new SequenceDiff(OffsetRange.ofLength(w.length),OffsetRange.ofLength(D.length))],!0)}constructor(w,D){this.diffs=w,this.hitTimeout=D}}class SequenceDiff{static invert(w,D){const O=[];return forEachAdjacent(w,(W,U)=>{O.push(SequenceDiff.fromOffsetPairs(W?W.getEndExclusives():OffsetPair.zero,U?U.getStarts():new OffsetPair(D,(W?W.seq2Range.endExclusive-W.seq1Range.endExclusive:0)+D)))}),O}static fromOffsetPairs(w,D){return new SequenceDiff(new OffsetRange(w.offset1,D.offset1),new OffsetRange(w.offset2,D.offset2))}static assertSorted(w){let D;for(const O of w){if(D&&!(D.seq1Range.endExclusive<=O.seq1Range.start&&D.seq2Range.endExclusive<=O.seq2Range.start))throw new BugIndicatingError("Sequence diffs must be sorted");D=O}}constructor(w,D){this.seq1Range=w,this.seq2Range=D}swap(){return new SequenceDiff(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(w){return new SequenceDiff(this.seq1Range.join(w.seq1Range),this.seq2Range.join(w.seq2Range))}delta(w){return w===0?this:new SequenceDiff(this.seq1Range.delta(w),this.seq2Range.delta(w))}deltaStart(w){return w===0?this:new SequenceDiff(this.seq1Range.deltaStart(w),this.seq2Range.deltaStart(w))}deltaEnd(w){return w===0?this:new SequenceDiff(this.seq1Range.deltaEnd(w),this.seq2Range.deltaEnd(w))}intersect(w){const D=this.seq1Range.intersect(w.seq1Range),O=this.seq2Range.intersect(w.seq2Range);if(!(!D||!O))return new SequenceDiff(D,O)}getStarts(){return new OffsetPair(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new OffsetPair(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}}class OffsetPair{static{this.zero=new OffsetPair(0,0)}static{this.max=new OffsetPair(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER)}constructor(w,D){this.offset1=w,this.offset2=D}toString(){return`${this.offset1} <-> ${this.offset2}`}delta(w){return w===0?this:new OffsetPair(this.offset1+w,this.offset2+w)}equals(w){return this.offset1===w.offset1&&this.offset2===w.offset2}}class InfiniteTimeout{static{this.instance=new InfiniteTimeout}isValid(){return!0}}class DateTimeout{constructor(w){if(this.timeout=w,this.startTime=Date.now(),this.valid=!0,w<=0)throw new BugIndicatingError("timeout must be positive")}isValid(){if(!(Date.now()-this.startTime<this.timeout)&&this.valid){this.valid=!1;debugger}return this.valid}}class Array2D{constructor(w,D){this.width=w,this.height=D,this.array=[],this.array=new Array(w*D)}get(w,D){return this.array[w+D*this.width]}set(w,D,O){this.array[w+D*this.width]=O}}function isSpace(F){return F===32||F===9}class LineRangeFragment{static{this.chrKeys=new Map}static getKey(w){let D=this.chrKeys.get(w);return D===void 0&&(D=this.chrKeys.size,this.chrKeys.set(w,D)),D}constructor(w,D,O){this.range=w,this.lines=D,this.source=O,this.histogram=[];let W=0;for(let U=w.startLineNumber-1;U<w.endLineNumberExclusive-1;U++){const K=D[U];for(let G=0;G<K.length;G++){W++;const Q=K[G],Y=LineRangeFragment.getKey(Q);this.histogram[Y]=(this.histogram[Y]||0)+1}W++;const q=LineRangeFragment.getKey(`
`);this.histogram[q]=(this.histogram[q]||0)+1}this.totalCount=W}computeSimilarity(w){let D=0;const O=Math.max(this.histogram.length,w.histogram.length);for(let W=0;W<O;W++)D+=Math.abs((this.histogram[W]??0)-(w.histogram[W]??0));return 1-D/(this.totalCount+w.totalCount)}}class DynamicProgrammingDiffing{compute(w,D,O=InfiniteTimeout.instance,W){if(w.length===0||D.length===0)return DiffAlgorithmResult.trivial(w,D);const U=new Array2D(w.length,D.length),K=new Array2D(w.length,D.length),q=new Array2D(w.length,D.length);for(let ie=0;ie<w.length;ie++)for(let se=0;se<D.length;se++){if(!O.isValid())return DiffAlgorithmResult.trivialTimedOut(w,D);const re=ie===0?0:U.get(ie-1,se),ae=se===0?0:U.get(ie,se-1);let le;w.getElement(ie)===D.getElement(se)?(ie===0||se===0?le=0:le=U.get(ie-1,se-1),ie>0&&se>0&&K.get(ie-1,se-1)===3&&(le+=q.get(ie-1,se-1)),le+=W?W(ie,se):1):le=-1;const de=Math.max(re,ae,le);if(de===le){const oe=ie>0&&se>0?q.get(ie-1,se-1):0;q.set(ie,se,oe+1),K.set(ie,se,3)}else de===re?(q.set(ie,se,0),K.set(ie,se,1)):de===ae&&(q.set(ie,se,0),K.set(ie,se,2));U.set(ie,se,de)}const G=[];let Q=w.length,Y=D.length;function X(ie,se){(ie+1!==Q||se+1!==Y)&&G.push(new SequenceDiff(new OffsetRange(ie+1,Q),new OffsetRange(se+1,Y))),Q=ie,Y=se}let J=w.length-1,te=D.length-1;for(;J>=0&&te>=0;)K.get(J,te)===3?(X(J,te),J--,te--):K.get(J,te)===1?J--:te--;return X(-1,-1),G.reverse(),new DiffAlgorithmResult(G,!1)}}class MyersDiffAlgorithm{compute(w,D,O=InfiniteTimeout.instance){if(w.length===0||D.length===0)return DiffAlgorithmResult.trivial(w,D);const W=w,U=D;function K(se,re){for(;se<W.length&&re<U.length&&W.getElement(se)===U.getElement(re);)se++,re++;return se}let q=0;const G=new FastInt32Array;G.set(0,K(0,0));const Q=new FastArrayNegativeIndices;Q.set(0,G.get(0)===0?null:new SnakePath(null,0,0,G.get(0)));let Y=0;e:for(;;){if(q++,!O.isValid())return DiffAlgorithmResult.trivialTimedOut(W,U);const se=-Math.min(q,U.length+q%2),re=Math.min(q,W.length+q%2);for(Y=se;Y<=re;Y+=2){const ae=Y===re?-1:G.get(Y+1),le=Y===se?-1:G.get(Y-1)+1,de=Math.min(Math.max(ae,le),W.length),oe=de-Y;if(de>W.length||oe>U.length)continue;const ue=K(de,oe);G.set(Y,ue);const pe=de===ae?Q.get(Y+1):Q.get(Y-1);if(Q.set(Y,ue!==de?new SnakePath(pe,de,oe,ue-de):pe),G.get(Y)===W.length&&G.get(Y)-Y===U.length)break e}}let X=Q.get(Y);const J=[];let te=W.length,ie=U.length;for(;;){const se=X?X.x+X.length:0,re=X?X.y+X.length:0;if((se!==te||re!==ie)&&J.push(new SequenceDiff(new OffsetRange(se,te),new OffsetRange(re,ie))),!X)break;te=X.x,ie=X.y,X=X.prev}return J.reverse(),new DiffAlgorithmResult(J,!1)}}class SnakePath{constructor(w,D,O,W){this.prev=w,this.x=D,this.y=O,this.length=W}}class FastInt32Array{constructor(){this.positiveArr=new Int32Array(10),this.negativeArr=new Int32Array(10)}get(w){return w<0?(w=-w-1,this.negativeArr[w]):this.positiveArr[w]}set(w,D){if(w<0){if(w=-w-1,w>=this.negativeArr.length){const O=this.negativeArr;this.negativeArr=new Int32Array(O.length*2),this.negativeArr.set(O)}this.negativeArr[w]=D}else{if(w>=this.positiveArr.length){const O=this.positiveArr;this.positiveArr=new Int32Array(O.length*2),this.positiveArr.set(O)}this.positiveArr[w]=D}}}class FastArrayNegativeIndices{constructor(){this.positiveArr=[],this.negativeArr=[]}get(w){return w<0?(w=-w-1,this.negativeArr[w]):this.positiveArr[w]}set(w,D){w<0?(w=-w-1,this.negativeArr[w]=D):this.positiveArr[w]=D}}class LinesSliceCharSequence{constructor(w,D,O){this.lines=w,this.range=D,this.considerWhitespaceChanges=O,this.elements=[],this.firstElementOffsetByLineIdx=[],this.lineStartOffsets=[],this.trimmedWsLengthsByLineIdx=[],this.firstElementOffsetByLineIdx.push(0);for(let W=this.range.startLineNumber;W<=this.range.endLineNumber;W++){let U=w[W-1],K=0;W===this.range.startLineNumber&&this.range.startColumn>1&&(K=this.range.startColumn-1,U=U.substring(K)),this.lineStartOffsets.push(K);let q=0;if(!O){const Q=U.trimStart();q=U.length-Q.length,U=Q.trimEnd()}this.trimmedWsLengthsByLineIdx.push(q);const G=W===this.range.endLineNumber?Math.min(this.range.endColumn-1-K-q,U.length):U.length;for(let Q=0;Q<G;Q++)this.elements.push(U.charCodeAt(Q));W<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new OffsetRange(0,this.length))}getText(w){return this.elements.slice(w.start,w.endExclusive).map(D=>String.fromCharCode(D)).join("")}getElement(w){return this.elements[w]}get length(){return this.elements.length}getBoundaryScore(w){const D=getCategory(w>0?this.elements[w-1]:-1),O=getCategory(w<this.elements.length?this.elements[w]:-1);if(D===7&&O===8)return 0;if(D===8)return 150;let W=0;return D!==O&&(W+=10,D===0&&O===1&&(W+=1)),W+=getCategoryBoundaryScore(D),W+=getCategoryBoundaryScore(O),W}translateOffset(w,D="right"){const O=findLastIdxMonotonous(this.firstElementOffsetByLineIdx,U=>U<=w),W=w-this.firstElementOffsetByLineIdx[O];return new Position$1(this.range.startLineNumber+O,1+this.lineStartOffsets[O]+W+(W===0&&D==="left"?0:this.trimmedWsLengthsByLineIdx[O]))}translateRange(w){const D=this.translateOffset(w.start,"right"),O=this.translateOffset(w.endExclusive,"left");return O.isBefore(D)?Range$2.fromPositions(O,O):Range$2.fromPositions(D,O)}findWordContaining(w){if(w<0||w>=this.elements.length||!isWordChar(this.elements[w]))return;let D=w;for(;D>0&&isWordChar(this.elements[D-1]);)D--;let O=w;for(;O<this.elements.length&&isWordChar(this.elements[O]);)O++;return new OffsetRange(D,O)}countLinesIn(w){return this.translateOffset(w.endExclusive).lineNumber-this.translateOffset(w.start).lineNumber}isStronglyEqual(w,D){return this.elements[w]===this.elements[D]}extendToFullLines(w){const D=findLastMonotonous(this.firstElementOffsetByLineIdx,W=>W<=w.start)??0,O=findFirstMonotonous(this.firstElementOffsetByLineIdx,W=>w.endExclusive<=W)??this.elements.length;return new OffsetRange(D,O)}}function isWordChar(F){return F>=97&&F<=122||F>=65&&F<=90||F>=48&&F<=57}const score$1={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function getCategoryBoundaryScore(F){return score$1[F]}function getCategory(F){return F===10?8:F===13?7:isSpace(F)?6:F>=97&&F<=122?0:F>=65&&F<=90?1:F>=48&&F<=57?2:F===-1?3:F===44||F===59?5:4}function computeMovedLines(F,w,D,O,W,U){let{moves:K,excludedChanges:q}=computeMovesFromSimpleDeletionsToSimpleInsertions(F,w,D,U);if(!U.isValid())return[];const G=F.filter(Y=>!q.has(Y)),Q=computeUnchangedMoves(G,O,W,w,D,U);return pushMany(K,Q),K=joinCloseConsecutiveMoves(K),K=K.filter(Y=>{const X=Y.original.toOffsetRange().slice(w).map(te=>te.trim());return X.join(`
`).length>=15&&countWhere(X,te=>te.length>=2)>=2}),K=removeMovesInSameDiff(F,K),K}function countWhere(F,w){let D=0;for(const O of F)w(O)&&D++;return D}function computeMovesFromSimpleDeletionsToSimpleInsertions(F,w,D,O){const W=[],U=F.filter(G=>G.modified.isEmpty&&G.original.length>=3).map(G=>new LineRangeFragment(G.original,w,G)),K=new Set(F.filter(G=>G.original.isEmpty&&G.modified.length>=3).map(G=>new LineRangeFragment(G.modified,D,G))),q=new Set;for(const G of U){let Q=-1,Y;for(const X of K){const J=G.computeSimilarity(X);J>Q&&(Q=J,Y=X)}if(Q>.9&&Y&&(K.delete(Y),W.push(new LineRangeMapping(G.range,Y.range)),q.add(G.source),q.add(Y.source)),!O.isValid())return{moves:W,excludedChanges:q}}return{moves:W,excludedChanges:q}}function computeUnchangedMoves(F,w,D,O,W,U){const K=[],q=new SetMap;for(const J of F)for(let te=J.original.startLineNumber;te<J.original.endLineNumberExclusive-2;te++){const ie=`${w[te-1]}:${w[te+1-1]}:${w[te+2-1]}`;q.add(ie,{range:new LineRange$1(te,te+3)})}const G=[];F.sort(compareBy(J=>J.modified.startLineNumber,numberComparator));for(const J of F){let te=[];for(let ie=J.modified.startLineNumber;ie<J.modified.endLineNumberExclusive-2;ie++){const se=`${D[ie-1]}:${D[ie+1-1]}:${D[ie+2-1]}`,re=new LineRange$1(ie,ie+3),ae=[];q.forEach(se,({range:le})=>{for(const oe of te)if(oe.originalLineRange.endLineNumberExclusive+1===le.endLineNumberExclusive&&oe.modifiedLineRange.endLineNumberExclusive+1===re.endLineNumberExclusive){oe.originalLineRange=new LineRange$1(oe.originalLineRange.startLineNumber,le.endLineNumberExclusive),oe.modifiedLineRange=new LineRange$1(oe.modifiedLineRange.startLineNumber,re.endLineNumberExclusive),ae.push(oe);return}const de={modifiedLineRange:re,originalLineRange:le};G.push(de),ae.push(de)}),te=ae}if(!U.isValid())return[]}G.sort(reverseOrder(compareBy(J=>J.modifiedLineRange.length,numberComparator)));const Q=new LineRangeSet,Y=new LineRangeSet;for(const J of G){const te=J.modifiedLineRange.startLineNumber-J.originalLineRange.startLineNumber,ie=Q.subtractFrom(J.modifiedLineRange),se=Y.subtractFrom(J.originalLineRange).getWithDelta(te),re=ie.getIntersection(se);for(const ae of re.ranges){if(ae.length<3)continue;const le=ae,de=ae.delta(-te);K.push(new LineRangeMapping(de,le)),Q.addRange(le),Y.addRange(de)}}K.sort(compareBy(J=>J.original.startLineNumber,numberComparator));const X=new MonotonousArray(F);for(let J=0;J<K.length;J++){const te=K[J],ie=X.findLastMonotonous(pe=>pe.original.startLineNumber<=te.original.startLineNumber),se=findLastMonotonous(F,pe=>pe.modified.startLineNumber<=te.modified.startLineNumber),re=Math.max(te.original.startLineNumber-ie.original.startLineNumber,te.modified.startLineNumber-se.modified.startLineNumber),ae=X.findLastMonotonous(pe=>pe.original.startLineNumber<te.original.endLineNumberExclusive),le=findLastMonotonous(F,pe=>pe.modified.startLineNumber<te.modified.endLineNumberExclusive),de=Math.max(ae.original.endLineNumberExclusive-te.original.endLineNumberExclusive,le.modified.endLineNumberExclusive-te.modified.endLineNumberExclusive);let oe;for(oe=0;oe<re;oe++){const pe=te.original.startLineNumber-oe-1,fe=te.modified.startLineNumber-oe-1;if(pe>O.length||fe>W.length||Q.contains(fe)||Y.contains(pe)||!areLinesSimilar(O[pe-1],W[fe-1],U))break}oe>0&&(Y.addRange(new LineRange$1(te.original.startLineNumber-oe,te.original.startLineNumber)),Q.addRange(new LineRange$1(te.modified.startLineNumber-oe,te.modified.startLineNumber)));let ue;for(ue=0;ue<de;ue++){const pe=te.original.endLineNumberExclusive+ue,fe=te.modified.endLineNumberExclusive+ue;if(pe>O.length||fe>W.length||Q.contains(fe)||Y.contains(pe)||!areLinesSimilar(O[pe-1],W[fe-1],U))break}ue>0&&(Y.addRange(new LineRange$1(te.original.endLineNumberExclusive,te.original.endLineNumberExclusive+ue)),Q.addRange(new LineRange$1(te.modified.endLineNumberExclusive,te.modified.endLineNumberExclusive+ue))),(oe>0||ue>0)&&(K[J]=new LineRangeMapping(new LineRange$1(te.original.startLineNumber-oe,te.original.endLineNumberExclusive+ue),new LineRange$1(te.modified.startLineNumber-oe,te.modified.endLineNumberExclusive+ue)))}return K}function areLinesSimilar(F,w,D){if(F.trim()===w.trim())return!0;if(F.length>300&&w.length>300)return!1;const W=new MyersDiffAlgorithm().compute(new LinesSliceCharSequence([F],new Range$2(1,1,1,F.length),!1),new LinesSliceCharSequence([w],new Range$2(1,1,1,w.length),!1),D);let U=0;const K=SequenceDiff.invert(W.diffs,F.length);for(const Y of K)Y.seq1Range.forEach(X=>{isSpace(F.charCodeAt(X))||U++});function q(Y){let X=0;for(let J=0;J<F.length;J++)isSpace(Y.charCodeAt(J))||X++;return X}const G=q(F.length>w.length?F:w);return U/G>.6&&G>10}function joinCloseConsecutiveMoves(F){if(F.length===0)return F;F.sort(compareBy(D=>D.original.startLineNumber,numberComparator));const w=[F[0]];for(let D=1;D<F.length;D++){const O=w[w.length-1],W=F[D],U=W.original.startLineNumber-O.original.endLineNumberExclusive,K=W.modified.startLineNumber-O.modified.endLineNumberExclusive;if(U>=0&&K>=0&&U+K<=2){w[w.length-1]=O.join(W);continue}w.push(W)}return w}function removeMovesInSameDiff(F,w){const D=new MonotonousArray(F);return w=w.filter(O=>{const W=D.findLastMonotonous(q=>q.original.startLineNumber<O.original.endLineNumberExclusive)||new LineRangeMapping(new LineRange$1(1,1),new LineRange$1(1,1)),U=findLastMonotonous(F,q=>q.modified.startLineNumber<O.modified.endLineNumberExclusive);return W!==U}),w}function optimizeSequenceDiffs(F,w,D){let O=D;return O=joinSequenceDiffsByShifting(F,w,O),O=joinSequenceDiffsByShifting(F,w,O),O=shiftSequenceDiffs(F,w,O),O}function joinSequenceDiffsByShifting(F,w,D){if(D.length===0)return D;const O=[];O.push(D[0]);for(let U=1;U<D.length;U++){const K=O[O.length-1];let q=D[U];if(q.seq1Range.isEmpty||q.seq2Range.isEmpty){const G=q.seq1Range.start-K.seq1Range.endExclusive;let Q;for(Q=1;Q<=G&&!(F.getElement(q.seq1Range.start-Q)!==F.getElement(q.seq1Range.endExclusive-Q)||w.getElement(q.seq2Range.start-Q)!==w.getElement(q.seq2Range.endExclusive-Q));Q++);if(Q--,Q===G){O[O.length-1]=new SequenceDiff(new OffsetRange(K.seq1Range.start,q.seq1Range.endExclusive-G),new OffsetRange(K.seq2Range.start,q.seq2Range.endExclusive-G));continue}q=q.delta(-Q)}O.push(q)}const W=[];for(let U=0;U<O.length-1;U++){const K=O[U+1];let q=O[U];if(q.seq1Range.isEmpty||q.seq2Range.isEmpty){const G=K.seq1Range.start-q.seq1Range.endExclusive;let Q;for(Q=0;Q<G&&!(!F.isStronglyEqual(q.seq1Range.start+Q,q.seq1Range.endExclusive+Q)||!w.isStronglyEqual(q.seq2Range.start+Q,q.seq2Range.endExclusive+Q));Q++);if(Q===G){O[U+1]=new SequenceDiff(new OffsetRange(q.seq1Range.start+G,K.seq1Range.endExclusive),new OffsetRange(q.seq2Range.start+G,K.seq2Range.endExclusive));continue}Q>0&&(q=q.delta(Q))}W.push(q)}return O.length>0&&W.push(O[O.length-1]),W}function shiftSequenceDiffs(F,w,D){if(!F.getBoundaryScore||!w.getBoundaryScore)return D;for(let O=0;O<D.length;O++){const W=O>0?D[O-1]:void 0,U=D[O],K=O+1<D.length?D[O+1]:void 0,q=new OffsetRange(W?W.seq1Range.endExclusive+1:0,K?K.seq1Range.start-1:F.length),G=new OffsetRange(W?W.seq2Range.endExclusive+1:0,K?K.seq2Range.start-1:w.length);U.seq1Range.isEmpty?D[O]=shiftDiffToBetterPosition(U,F,w,q,G):U.seq2Range.isEmpty&&(D[O]=shiftDiffToBetterPosition(U.swap(),w,F,G,q).swap())}return D}function shiftDiffToBetterPosition(F,w,D,O,W){let K=1;for(;F.seq1Range.start-K>=O.start&&F.seq2Range.start-K>=W.start&&D.isStronglyEqual(F.seq2Range.start-K,F.seq2Range.endExclusive-K)&&K<100;)K++;K--;let q=0;for(;F.seq1Range.start+q<O.endExclusive&&F.seq2Range.endExclusive+q<W.endExclusive&&D.isStronglyEqual(F.seq2Range.start+q,F.seq2Range.endExclusive+q)&&q<100;)q++;if(K===0&&q===0)return F;let G=0,Q=-1;for(let Y=-K;Y<=q;Y++){const X=F.seq2Range.start+Y,J=F.seq2Range.endExclusive+Y,te=F.seq1Range.start+Y,ie=w.getBoundaryScore(te)+D.getBoundaryScore(X)+D.getBoundaryScore(J);ie>Q&&(Q=ie,G=Y)}return F.delta(G)}function removeShortMatches(F,w,D){const O=[];for(const W of D){const U=O[O.length-1];if(!U){O.push(W);continue}W.seq1Range.start-U.seq1Range.endExclusive<=2||W.seq2Range.start-U.seq2Range.endExclusive<=2?O[O.length-1]=new SequenceDiff(U.seq1Range.join(W.seq1Range),U.seq2Range.join(W.seq2Range)):O.push(W)}return O}function extendDiffsToEntireWordIfAppropriate(F,w,D){const O=SequenceDiff.invert(D,F.length),W=[];let U=new OffsetPair(0,0);function K(G,Q){if(G.offset1<U.offset1||G.offset2<U.offset2)return;const Y=F.findWordContaining(G.offset1),X=w.findWordContaining(G.offset2);if(!Y||!X)return;let J=new SequenceDiff(Y,X);const te=J.intersect(Q);let ie=te.seq1Range.length,se=te.seq2Range.length;for(;O.length>0;){const re=O[0];if(!(re.seq1Range.intersects(J.seq1Range)||re.seq2Range.intersects(J.seq2Range)))break;const le=F.findWordContaining(re.seq1Range.start),de=w.findWordContaining(re.seq2Range.start),oe=new SequenceDiff(le,de),ue=oe.intersect(re);if(ie+=ue.seq1Range.length,se+=ue.seq2Range.length,J=J.join(oe),J.seq1Range.endExclusive>=re.seq1Range.endExclusive)O.shift();else break}ie+se<(J.seq1Range.length+J.seq2Range.length)*2/3&&W.push(J),U=J.getEndExclusives()}for(;O.length>0;){const G=O.shift();G.seq1Range.isEmpty||(K(G.getStarts(),G),K(G.getEndExclusives().delta(-1),G))}return mergeSequenceDiffs(D,W)}function mergeSequenceDiffs(F,w){const D=[];for(;F.length>0||w.length>0;){const O=F[0],W=w[0];let U;O&&(!W||O.seq1Range.start<W.seq1Range.start)?U=F.shift():U=w.shift(),D.length>0&&D[D.length-1].seq1Range.endExclusive>=U.seq1Range.start?D[D.length-1]=D[D.length-1].join(U):D.push(U)}return D}function removeVeryShortMatchingLinesBetweenDiffs(F,w,D){let O=D;if(O.length===0)return O;let W=0,U;do{U=!1;const q=[O[0]];for(let G=1;G<O.length;G++){let X=function(te,ie){const se=new OffsetRange(Y.seq1Range.endExclusive,Q.seq1Range.start);return F.getText(se).replace(/\s/g,"").length<=4&&(te.seq1Range.length+te.seq2Range.length>5||ie.seq1Range.length+ie.seq2Range.length>5)};var K=X;const Q=O[G],Y=q[q.length-1];X(Y,Q)?(U=!0,q[q.length-1]=q[q.length-1].join(Q)):q.push(Q)}O=q}while(W++<10&&U);return O}function removeVeryShortMatchingTextBetweenLongDiffs(F,w,D){let O=D;if(O.length===0)return O;let W=0,U;do{U=!1;const G=[O[0]];for(let Q=1;Q<O.length;Q++){let J=function(ie,se){const re=new OffsetRange(X.seq1Range.endExclusive,Y.seq1Range.start);if(F.countLinesIn(re)>5||re.length>500)return!1;const le=F.getText(re).trim();if(le.length>20||le.split(/\r\n|\r|\n/).length>1)return!1;const de=F.countLinesIn(ie.seq1Range),oe=ie.seq1Range.length,ue=w.countLinesIn(ie.seq2Range),pe=ie.seq2Range.length,fe=F.countLinesIn(se.seq1Range),Ce=se.seq1Range.length,we=w.countLinesIn(se.seq2Range),Oe=se.seq2Range.length,Te=2*40+50;function Re(Me){return Math.min(Me,Te)}return Math.pow(Math.pow(Re(de*40+oe),1.5)+Math.pow(Re(ue*40+pe),1.5),1.5)+Math.pow(Math.pow(Re(fe*40+Ce),1.5)+Math.pow(Re(we*40+Oe),1.5),1.5)>(Te**1.5)**1.5*1.3};var q=J;const Y=O[Q],X=G[G.length-1];J(X,Y)?(U=!0,G[G.length-1]=G[G.length-1].join(Y)):G.push(Y)}O=G}while(W++<10&&U);const K=[];return forEachWithNeighbors(O,(G,Q,Y)=>{let X=Q;function J(le){return le.length>0&&le.trim().length<=3&&Q.seq1Range.length+Q.seq2Range.length>100}const te=F.extendToFullLines(Q.seq1Range),ie=F.getText(new OffsetRange(te.start,Q.seq1Range.start));J(ie)&&(X=X.deltaStart(-ie.length));const se=F.getText(new OffsetRange(Q.seq1Range.endExclusive,te.endExclusive));J(se)&&(X=X.deltaEnd(se.length));const re=SequenceDiff.fromOffsetPairs(G?G.getEndExclusives():OffsetPair.zero,Y?Y.getStarts():OffsetPair.max),ae=X.intersect(re);K.length>0&&ae.getStarts().equals(K[K.length-1].getEndExclusives())?K[K.length-1]=K[K.length-1].join(ae):K.push(ae)}),K}class LineSequence{constructor(w,D){this.trimmedHash=w,this.lines=D}getElement(w){return this.trimmedHash[w]}get length(){return this.trimmedHash.length}getBoundaryScore(w){const D=w===0?0:getIndentation(this.lines[w-1]),O=w===this.lines.length?0:getIndentation(this.lines[w]);return 1e3-(D+O)}getText(w){return this.lines.slice(w.start,w.endExclusive).join(`
`)}isStronglyEqual(w,D){return this.lines[w]===this.lines[D]}}function getIndentation(F){let w=0;for(;w<F.length&&(F.charCodeAt(w)===32||F.charCodeAt(w)===9);)w++;return w}class DefaultLinesDiffComputer{constructor(){this.dynamicProgrammingDiffing=new DynamicProgrammingDiffing,this.myersDiffingAlgorithm=new MyersDiffAlgorithm}computeDiff(w,D,O){if(w.length<=1&&equals$1(w,D,(ue,pe)=>ue===pe))return new LinesDiff([],[],!1);if(w.length===1&&w[0].length===0||D.length===1&&D[0].length===0)return new LinesDiff([new DetailedLineRangeMapping(new LineRange$1(1,w.length+1),new LineRange$1(1,D.length+1),[new RangeMapping(new Range$2(1,1,w.length,w[w.length-1].length+1),new Range$2(1,1,D.length,D[D.length-1].length+1))])],[],!1);const W=O.maxComputationTimeMs===0?InfiniteTimeout.instance:new DateTimeout(O.maxComputationTimeMs),U=!O.ignoreTrimWhitespace,K=new Map;function q(ue){let pe=K.get(ue);return pe===void 0&&(pe=K.size,K.set(ue,pe)),pe}const G=w.map(ue=>q(ue.trim())),Q=D.map(ue=>q(ue.trim())),Y=new LineSequence(G,w),X=new LineSequence(Q,D),J=Y.length+X.length<1700?this.dynamicProgrammingDiffing.compute(Y,X,W,(ue,pe)=>w[ue]===D[pe]?D[pe].length===0?.1:1+Math.log(1+D[pe].length):.99):this.myersDiffingAlgorithm.compute(Y,X,W);let te=J.diffs,ie=J.hitTimeout;te=optimizeSequenceDiffs(Y,X,te),te=removeVeryShortMatchingLinesBetweenDiffs(Y,X,te);const se=[],re=ue=>{if(U)for(let pe=0;pe<ue;pe++){const fe=ae+pe,Ce=le+pe;if(w[fe]!==D[Ce]){const we=this.refineDiff(w,D,new SequenceDiff(new OffsetRange(fe,fe+1),new OffsetRange(Ce,Ce+1)),W,U);for(const Oe of we.mappings)se.push(Oe);we.hitTimeout&&(ie=!0)}}};let ae=0,le=0;for(const ue of te){assertFn(()=>ue.seq1Range.start-ae===ue.seq2Range.start-le);const pe=ue.seq1Range.start-ae;re(pe),ae=ue.seq1Range.endExclusive,le=ue.seq2Range.endExclusive;const fe=this.refineDiff(w,D,ue,W,U);fe.hitTimeout&&(ie=!0);for(const Ce of fe.mappings)se.push(Ce)}re(w.length-ae);const de=lineRangeMappingFromRangeMappings(se,w,D);let oe=[];return O.computeMoves&&(oe=this.computeMoves(de,w,D,G,Q,W,U)),assertFn(()=>{function ue(fe,Ce){if(fe.lineNumber<1||fe.lineNumber>Ce.length)return!1;const we=Ce[fe.lineNumber-1];return!(fe.column<1||fe.column>we.length+1)}function pe(fe,Ce){return!(fe.startLineNumber<1||fe.startLineNumber>Ce.length+1||fe.endLineNumberExclusive<1||fe.endLineNumberExclusive>Ce.length+1)}for(const fe of de){if(!fe.innerChanges)return!1;for(const Ce of fe.innerChanges)if(!(ue(Ce.modifiedRange.getStartPosition(),D)&&ue(Ce.modifiedRange.getEndPosition(),D)&&ue(Ce.originalRange.getStartPosition(),w)&&ue(Ce.originalRange.getEndPosition(),w)))return!1;if(!pe(fe.modified,D)||!pe(fe.original,w))return!1}return!0}),new LinesDiff(de,oe,ie)}computeMoves(w,D,O,W,U,K,q){return computeMovedLines(w,D,O,W,U,K).map(Y=>{const X=this.refineDiff(D,O,new SequenceDiff(Y.original.toOffsetRange(),Y.modified.toOffsetRange()),K,q),J=lineRangeMappingFromRangeMappings(X.mappings,D,O,!0);return new MovedText(Y,J)})}refineDiff(w,D,O,W,U){const q=toLineRangeMapping(O).toRangeMapping2(w,D),G=new LinesSliceCharSequence(w,q.originalRange,U),Q=new LinesSliceCharSequence(D,q.modifiedRange,U),Y=G.length+Q.length<500?this.dynamicProgrammingDiffing.compute(G,Q,W):this.myersDiffingAlgorithm.compute(G,Q,W);let X=Y.diffs;return X=optimizeSequenceDiffs(G,Q,X),X=extendDiffsToEntireWordIfAppropriate(G,Q,X),X=removeShortMatches(G,Q,X),X=removeVeryShortMatchingTextBetweenLongDiffs(G,Q,X),{mappings:X.map(te=>new RangeMapping(G.translateRange(te.seq1Range),Q.translateRange(te.seq2Range))),hitTimeout:Y.hitTimeout}}}function lineRangeMappingFromRangeMappings(F,w,D,O=!1){const W=[];for(const U of groupAdjacentBy(F.map(K=>getLineRangeMapping(K,w,D)),(K,q)=>K.original.overlapOrTouch(q.original)||K.modified.overlapOrTouch(q.modified))){const K=U[0],q=U[U.length-1];W.push(new DetailedLineRangeMapping(K.original.join(q.original),K.modified.join(q.modified),U.map(G=>G.innerChanges[0])))}return assertFn(()=>!O&&W.length>0&&(W[0].modified.startLineNumber!==W[0].original.startLineNumber||D.length-W[W.length-1].modified.endLineNumberExclusive!==w.length-W[W.length-1].original.endLineNumberExclusive)?!1:checkAdjacentItems(W,(U,K)=>K.original.startLineNumber-U.original.endLineNumberExclusive===K.modified.startLineNumber-U.modified.endLineNumberExclusive&&U.original.endLineNumberExclusive<K.original.startLineNumber&&U.modified.endLineNumberExclusive<K.modified.startLineNumber)),W}function getLineRangeMapping(F,w,D){let O=0,W=0;F.modifiedRange.endColumn===1&&F.originalRange.endColumn===1&&F.originalRange.startLineNumber+O<=F.originalRange.endLineNumber&&F.modifiedRange.startLineNumber+O<=F.modifiedRange.endLineNumber&&(W=-1),F.modifiedRange.startColumn-1>=D[F.modifiedRange.startLineNumber-1].length&&F.originalRange.startColumn-1>=w[F.originalRange.startLineNumber-1].length&&F.originalRange.startLineNumber<=F.originalRange.endLineNumber+W&&F.modifiedRange.startLineNumber<=F.modifiedRange.endLineNumber+W&&(O=1);const U=new LineRange$1(F.originalRange.startLineNumber+O,F.originalRange.endLineNumber+1+W),K=new LineRange$1(F.modifiedRange.startLineNumber+O,F.modifiedRange.endLineNumber+1+W);return new DetailedLineRangeMapping(U,K,[F])}function toLineRangeMapping(F){return new LineRangeMapping(new LineRange$1(F.seq1Range.start+1,F.seq1Range.endExclusive+1),new LineRange$1(F.seq2Range.start+1,F.seq2Range.endExclusive+1))}const linesDiffComputers={getLegacy:()=>new LegacyLinesDiffComputer,getDefault:()=>new DefaultLinesDiffComputer};function _parseCaptureGroups(F){const w=[];for(const D of F){const O=Number(D);(O||O===0&&D.replace(/\s/g,"")!=="")&&w.push(O)}return w}function _toIColor(F,w,D,O){return{red:F/255,blue:D/255,green:w/255,alpha:O}}function _findRange(F,w){const D=w.index,O=w[0].length;if(!D)return;const W=F.positionAt(D);return{startLineNumber:W.lineNumber,startColumn:W.column,endLineNumber:W.lineNumber,endColumn:W.column+O}}function _findHexColorInformation(F,w){if(!F)return;const D=Color.Format.CSS.parseHex(w);if(D)return{range:F,color:_toIColor(D.rgba.r,D.rgba.g,D.rgba.b,D.rgba.a)}}function _findRGBColorInformation(F,w,D){if(!F||w.length!==1)return;const W=w[0].values(),U=_parseCaptureGroups(W);return{range:F,color:_toIColor(U[0],U[1],U[2],D?U[3]:1)}}function _findHSLColorInformation(F,w,D){if(!F||w.length!==1)return;const W=w[0].values(),U=_parseCaptureGroups(W),K=new Color(new HSLA(U[0],U[1]/100,U[2]/100,D?U[3]:1));return{range:F,color:_toIColor(K.rgba.r,K.rgba.g,K.rgba.b,K.rgba.a)}}function _findMatches(F,w){return typeof F=="string"?[...F.matchAll(w)]:F.findMatches(w)}function computeColors(F){const w=[],O=_findMatches(F,/\b(rgb|rgba|hsl|hsla)(\([0-9\s,.\%]*\))|(#)([A-Fa-f0-9]{3})\b|(#)([A-Fa-f0-9]{4})\b|(#)([A-Fa-f0-9]{6})\b|(#)([A-Fa-f0-9]{8})\b/gm);if(O.length>0)for(const W of O){const U=W.filter(Q=>Q!==void 0),K=U[1],q=U[2];if(!q)continue;let G;if(K==="rgb"){const Q=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;G=_findRGBColorInformation(_findRange(F,W),_findMatches(q,Q),!1)}else if(K==="rgba"){const Q=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;G=_findRGBColorInformation(_findRange(F,W),_findMatches(q,Q),!0)}else if(K==="hsl"){const Q=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;G=_findHSLColorInformation(_findRange(F,W),_findMatches(q,Q),!1)}else if(K==="hsla"){const Q=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;G=_findHSLColorInformation(_findRange(F,W),_findMatches(q,Q),!0)}else K==="#"&&(G=_findHexColorInformation(_findRange(F,W),K+q));G&&w.push(G)}return w}function computeDefaultDocumentColors(F){return!F||typeof F.getValue!="function"||typeof F.positionAt!="function"?[]:computeColors(F)}const markRegex=new RegExp("\\bMARK:\\s*(.*)$","d"),trimDashesRegex=/^-+|-+$/g;function findSectionHeaders(F,w){let D=[];if(w.findRegionSectionHeaders&&w.foldingRules?.markers){const O=collectRegionHeaders(F,w);D=D.concat(O)}if(w.findMarkSectionHeaders){const O=collectMarkHeaders(F);D=D.concat(O)}return D}function collectRegionHeaders(F,w){const D=[],O=F.getLineCount();for(let W=1;W<=O;W++){const U=F.getLineContent(W),K=U.match(w.foldingRules.markers.start);if(K){const q={startLineNumber:W,startColumn:K[0].length+1,endLineNumber:W,endColumn:U.length+1};if(q.endColumn>q.startColumn){const G={range:q,...getHeaderText(U.substring(K[0].length)),shouldBeInComments:!1};(G.text||G.hasSeparatorLine)&&D.push(G)}}}return D}function collectMarkHeaders(F){const w=[],D=F.getLineCount();for(let O=1;O<=D;O++){const W=F.getLineContent(O);addMarkHeaderIfFound(W,O,w)}return w}function addMarkHeaderIfFound(F,w,D){markRegex.lastIndex=0;const O=markRegex.exec(F);if(O){const W=O.indices[1][0]+1,U=O.indices[1][1]+1,K={startLineNumber:w,startColumn:W,endLineNumber:w,endColumn:U};if(K.endColumn>K.startColumn){const q={range:K,...getHeaderText(O[1]),shouldBeInComments:!0};(q.text||q.hasSeparatorLine)&&D.push(q)}}}function getHeaderText(F){F=F.trim();const w=F.startsWith("-");return F=F.replace(trimDashesRegex,""),{text:F,hasSeparatorLine:w}}class MirrorTextModel{constructor(w,D,O,W){this._uri=w,this._lines=D,this._eol=O,this._versionId=W,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(w){w.eol&&w.eol!==this._eol&&(this._eol=w.eol,this._lineStarts=null);const D=w.changes;for(const O of D)this._acceptDeleteRange(O.range),this._acceptInsertText(new Position$1(O.range.startLineNumber,O.range.startColumn),O.text);this._versionId=w.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const w=this._eol.length,D=this._lines.length,O=new Uint32Array(D);for(let W=0;W<D;W++)O[W]=this._lines[W].length+w;this._lineStarts=new PrefixSumComputer(O)}}_setLineText(w,D){this._lines[w]=D,this._lineStarts&&this._lineStarts.setValue(w,this._lines[w].length+this._eol.length)}_acceptDeleteRange(w){if(w.startLineNumber===w.endLineNumber){if(w.startColumn===w.endColumn)return;this._setLineText(w.startLineNumber-1,this._lines[w.startLineNumber-1].substring(0,w.startColumn-1)+this._lines[w.startLineNumber-1].substring(w.endColumn-1));return}this._setLineText(w.startLineNumber-1,this._lines[w.startLineNumber-1].substring(0,w.startColumn-1)+this._lines[w.endLineNumber-1].substring(w.endColumn-1)),this._lines.splice(w.startLineNumber,w.endLineNumber-w.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(w.startLineNumber,w.endLineNumber-w.startLineNumber)}_acceptInsertText(w,D){if(D.length===0)return;const O=splitLines(D);if(O.length===1){this._setLineText(w.lineNumber-1,this._lines[w.lineNumber-1].substring(0,w.column-1)+O[0]+this._lines[w.lineNumber-1].substring(w.column-1));return}O[O.length-1]+=this._lines[w.lineNumber-1].substring(w.column-1),this._setLineText(w.lineNumber-1,this._lines[w.lineNumber-1].substring(0,w.column-1)+O[0]);const W=new Uint32Array(O.length-1);for(let U=1;U<O.length;U++)this._lines.splice(w.lineNumber+U-1,0,O[U]),W[U-1]=O[U].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(w.lineNumber,W)}}const STOP_SYNC_MODEL_DELTA_TIME_MS=60*1e3;class WorkerTextModelSyncClient extends Disposable{constructor(w,D,O=!1){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=w,this._modelService=D,!O){const W=new IntervalTimer;W.cancelAndSet(()=>this._checkStopModelSync(),Math.round(STOP_SYNC_MODEL_DELTA_TIME_MS/2)),this._register(W)}}dispose(){for(const w in this._syncedModels)dispose(this._syncedModels[w]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(w,D=!1){for(const O of w){const W=O.toString();this._syncedModels[W]||this._beginModelSync(O,D),this._syncedModels[W]&&(this._syncedModelsLastUsedTime[W]=new Date().getTime())}}_checkStopModelSync(){const w=new Date().getTime(),D=[];for(const O in this._syncedModelsLastUsedTime)w-this._syncedModelsLastUsedTime[O]>STOP_SYNC_MODEL_DELTA_TIME_MS&&D.push(O);for(const O of D)this._stopModelSync(O)}_beginModelSync(w,D){const O=this._modelService.getModel(w);if(!O||!D&&O.isTooLargeForSyncing())return;const W=w.toString();this._proxy.$acceptNewModel({url:O.uri.toString(),lines:O.getLinesContent(),EOL:O.getEOL(),versionId:O.getVersionId()});const U=new DisposableStore;U.add(O.onDidChangeContent(K=>{this._proxy.$acceptModelChanged(W.toString(),K)})),U.add(O.onWillDispose(()=>{this._stopModelSync(W)})),U.add(toDisposable(()=>{this._proxy.$acceptRemovedModel(W)})),this._syncedModels[W]=U}_stopModelSync(w){const D=this._syncedModels[w];delete this._syncedModels[w],delete this._syncedModelsLastUsedTime[w],dispose(D)}}class WorkerTextModelSyncServer{constructor(){this._models=Object.create(null)}getModel(w){return this._models[w]}getModels(){const w=[];return Object.keys(this._models).forEach(D=>w.push(this._models[D])),w}$acceptNewModel(w){this._models[w.url]=new MirrorModel(URI.parse(w.url),w.lines,w.EOL,w.versionId)}$acceptModelChanged(w,D){if(!this._models[w])return;this._models[w].onEvents(D)}$acceptRemovedModel(w){this._models[w]&&delete this._models[w]}}class MirrorModel extends MirrorTextModel{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(w){const D=[];for(let O=0;O<this._lines.length;O++){const W=this._lines[O],U=this.offsetAt(new Position$1(O+1,1)),K=W.matchAll(w);for(const q of K)(q.index||q.index===0)&&(q.index=q.index+U),D.push(q)}return D}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(w){return this._lines[w-1]}getWordAtPosition(w,D){const O=getWordAtText(w.column,ensureValidWordDefinition(D),this._lines[w.lineNumber-1],0);return O?new Range$2(w.lineNumber,O.startColumn,w.lineNumber,O.endColumn):null}words(w){const D=this._lines,O=this._wordenize.bind(this);let W=0,U="",K=0,q=[];return{*[Symbol.iterator](){for(;;)if(K<q.length){const G=U.substring(q[K].start,q[K].end);K+=1,yield G}else if(W<D.length)U=D[W],q=O(U,w),K=0,W+=1;else break}}}getLineWords(w,D){const O=this._lines[w-1],W=this._wordenize(O,D),U=[];for(const K of W)U.push({word:O.substring(K.start,K.end),startColumn:K.start+1,endColumn:K.end+1});return U}_wordenize(w,D){const O=[];let W;for(D.lastIndex=0;(W=D.exec(w))&&W[0].length!==0;)O.push({start:W.index,end:W.index+W[0].length});return O}getValueInRange(w){if(w=this._validateRange(w),w.startLineNumber===w.endLineNumber)return this._lines[w.startLineNumber-1].substring(w.startColumn-1,w.endColumn-1);const D=this._eol,O=w.startLineNumber-1,W=w.endLineNumber-1,U=[];U.push(this._lines[O].substring(w.startColumn-1));for(let K=O+1;K<W;K++)U.push(this._lines[K]);return U.push(this._lines[W].substring(0,w.endColumn-1)),U.join(D)}offsetAt(w){return w=this._validatePosition(w),this._ensureLineStarts(),this._lineStarts.getPrefixSum(w.lineNumber-2)+(w.column-1)}positionAt(w){w=Math.floor(w),w=Math.max(0,w),this._ensureLineStarts();const D=this._lineStarts.getIndexOf(w),O=this._lines[D.index].length;return{lineNumber:1+D.index,column:1+Math.min(D.remainder,O)}}_validateRange(w){const D=this._validatePosition({lineNumber:w.startLineNumber,column:w.startColumn}),O=this._validatePosition({lineNumber:w.endLineNumber,column:w.endColumn});return D.lineNumber!==w.startLineNumber||D.column!==w.startColumn||O.lineNumber!==w.endLineNumber||O.column!==w.endColumn?{startLineNumber:D.lineNumber,startColumn:D.column,endLineNumber:O.lineNumber,endColumn:O.column}:w}_validatePosition(w){if(!Position$1.isIPosition(w))throw new Error("bad position");let{lineNumber:D,column:O}=w,W=!1;if(D<1)D=1,O=1,W=!0;else if(D>this._lines.length)D=this._lines.length,O=this._lines[D-1].length+1,W=!0;else{const U=this._lines[D-1].length+1;O<1?(O=1,W=!0):O>U&&(O=U,W=!0)}return W?{lineNumber:D,column:O}:w}}class BaseEditorSimpleWorker{constructor(){this._workerTextModelSyncServer=new WorkerTextModelSyncServer}dispose(){}_getModel(w){return this._workerTextModelSyncServer.getModel(w)}_getModels(){return this._workerTextModelSyncServer.getModels()}$acceptNewModel(w){this._workerTextModelSyncServer.$acceptNewModel(w)}$acceptModelChanged(w,D){this._workerTextModelSyncServer.$acceptModelChanged(w,D)}$acceptRemovedModel(w){this._workerTextModelSyncServer.$acceptRemovedModel(w)}async $computeUnicodeHighlights(w,D,O){const W=this._getModel(w);return W?UnicodeTextModelHighlighter.computeUnicodeHighlights(W,D,O):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}}async $findSectionHeaders(w,D){const O=this._getModel(w);return O?findSectionHeaders(O,D):[]}async $computeDiff(w,D,O,W){const U=this._getModel(w),K=this._getModel(D);return!U||!K?null:EditorSimpleWorker.computeDiff(U,K,O,W)}static computeDiff(w,D,O,W){const U=W==="advanced"?linesDiffComputers.getDefault():linesDiffComputers.getLegacy(),K=w.getLinesContent(),q=D.getLinesContent(),G=U.computeDiff(K,q,O),Q=G.changes.length>0?!1:this._modelsAreIdentical(w,D);function Y(X){return X.map(J=>[J.original.startLineNumber,J.original.endLineNumberExclusive,J.modified.startLineNumber,J.modified.endLineNumberExclusive,J.innerChanges?.map(te=>[te.originalRange.startLineNumber,te.originalRange.startColumn,te.originalRange.endLineNumber,te.originalRange.endColumn,te.modifiedRange.startLineNumber,te.modifiedRange.startColumn,te.modifiedRange.endLineNumber,te.modifiedRange.endColumn])])}return{identical:Q,quitEarly:G.hitTimeout,changes:Y(G.changes),moves:G.moves.map(X=>[X.lineRangeMapping.original.startLineNumber,X.lineRangeMapping.original.endLineNumberExclusive,X.lineRangeMapping.modified.startLineNumber,X.lineRangeMapping.modified.endLineNumberExclusive,Y(X.changes)])}}static _modelsAreIdentical(w,D){const O=w.getLineCount(),W=D.getLineCount();if(O!==W)return!1;for(let U=1;U<=O;U++){const K=w.getLineContent(U),q=D.getLineContent(U);if(K!==q)return!1}return!0}static{this._diffLimit=1e5}async $computeMoreMinimalEdits(w,D,O){const W=this._getModel(w);if(!W)return D;const U=[];let K;D=D.slice(0).sort((G,Q)=>{if(G.range&&Q.range)return Range$2.compareRangesUsingStarts(G.range,Q.range);const Y=G.range?0:1,X=Q.range?0:1;return Y-X});let q=0;for(let G=1;G<D.length;G++)Range$2.getEndPosition(D[q].range).equals(Range$2.getStartPosition(D[G].range))?(D[q].range=Range$2.fromPositions(Range$2.getStartPosition(D[q].range),Range$2.getEndPosition(D[G].range)),D[q].text+=D[G].text):(q++,D[q]=D[G]);D.length=q+1;for(let{range:G,text:Q,eol:Y}of D){if(typeof Y=="number"&&(K=Y),Range$2.isEmpty(G)&&!Q)continue;const X=W.getValueInRange(G);if(Q=Q.replace(/\r\n|\n|\r/g,W.eol),X===Q)continue;if(Math.max(Q.length,X.length)>EditorSimpleWorker._diffLimit){U.push({range:G,text:Q});continue}const J=stringDiff(X,Q,O),te=W.offsetAt(Range$2.lift(G).getStartPosition());for(const ie of J){const se=W.positionAt(te+ie.originalStart),re=W.positionAt(te+ie.originalStart+ie.originalLength),ae={text:Q.substr(ie.modifiedStart,ie.modifiedLength),range:{startLineNumber:se.lineNumber,startColumn:se.column,endLineNumber:re.lineNumber,endColumn:re.column}};W.getValueInRange(ae.range)!==ae.text&&U.push(ae)}}return typeof K=="number"&&U.push({eol:K,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),U}async $computeLinks(w){const D=this._getModel(w);return D?computeLinks(D):null}async $computeDefaultDocumentColors(w){const D=this._getModel(w);return D?computeDefaultDocumentColors(D):null}static{this._suggestionsLimit=1e4}async $textualSuggest(w,D,O,W){const U=new StopWatch,K=new RegExp(O,W),q=new Set;e:for(const G of w){const Q=this._getModel(G);if(Q){for(const Y of Q.words(K))if(!(Y===D||!isNaN(Number(Y)))&&(q.add(Y),q.size>EditorSimpleWorker._suggestionsLimit))break e}}return{words:Array.from(q),duration:U.elapsed()}}async $computeWordRanges(w,D,O,W){const U=this._getModel(w);if(!U)return Object.create(null);const K=new RegExp(O,W),q=Object.create(null);for(let G=D.startLineNumber;G<D.endLineNumber;G++){const Q=U.getLineWords(G,K);for(const Y of Q){if(!isNaN(Number(Y.word)))continue;let X=q[Y.word];X||(X=[],q[Y.word]=X),X.push({startLineNumber:G,startColumn:Y.startColumn,endLineNumber:G,endColumn:Y.endColumn})}}return q}async $navigateValueSet(w,D,O,W,U){const K=this._getModel(w);if(!K)return null;const q=new RegExp(W,U);D.startColumn===D.endColumn&&(D={startLineNumber:D.startLineNumber,startColumn:D.startColumn,endLineNumber:D.endLineNumber,endColumn:D.endColumn+1});const G=K.getValueInRange(D),Q=K.getWordAtPosition({lineNumber:D.startLineNumber,column:D.startColumn},q);if(!Q)return null;const Y=K.getValueInRange(Q);return BasicInplaceReplace.INSTANCE.navigateValueSet(D,G,Q,Y,O)}}class EditorSimpleWorker extends BaseEditorSimpleWorker{constructor(w,D){super(),this._host=w,this._foreignModuleFactory=D,this._foreignModule=null}async $ping(){return"pong"}$loadForeignModule(w,D,O){const K={host:createProxyObject(O,(q,G)=>this._host.$fhr(q,G)),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(K,D),Promise.resolve(getAllMethodNames(this._foreignModule))):new Promise((q,G)=>{const Q=Y=>{this._foreignModule=Y.create(K,D),q(getAllMethodNames(this._foreignModule))};{const Y=FileAccess.asBrowserUri(`${w}.js`).toString(!0);__vitePreload(()=>import(`${Y}`),[]).then(Q).catch(G)}})}$fmr(w,D){if(!this._foreignModule||typeof this._foreignModule[w]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+w));try{return Promise.resolve(this._foreignModule[w].apply(this._foreignModule,D))}catch(O){return Promise.reject(O)}}}typeof importScripts=="function"&&(globalThis.monaco=createMonacoBaseAPI());const ITextResourceConfigurationService=createDecorator("textResourceConfigurationService"),ITextResourcePropertiesService=createDecorator("textResourcePropertiesService");var __decorate$J=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$H=function(F,w){return function(D,O){w(D,O,F)}};const STOP_WORKER_DELTA_TIME_MS=5*60*1e3;function canSyncModel(F,w){const D=F.getModel(w);return!(!D||D.isTooLargeForSyncing())}let EditorWorkerService=class extends Disposable{constructor(w,D,O,W,U,K){super(),this._languageConfigurationService=U,this._modelService=D,this._workerManager=this._register(new WorkerManager(w,this._modelService)),this._logService=W,this._register(K.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:async(q,G)=>{if(!canSyncModel(this._modelService,q.uri))return Promise.resolve({links:[]});const Y=await(await this._workerWithResources([q.uri])).$computeLinks(q.uri.toString());return Y&&{links:Y}}})),this._register(K.completionProvider.register("*",new WordBasedCompletionItemProvider(this._workerManager,O,this._modelService,this._languageConfigurationService)))}dispose(){super.dispose()}canComputeUnicodeHighlights(w){return canSyncModel(this._modelService,w)}async computedUnicodeHighlights(w,D,O){return(await this._workerWithResources([w])).$computeUnicodeHighlights(w.toString(),D,O)}async computeDiff(w,D,O,W){const K=await(await this._workerWithResources([w,D],!0)).$computeDiff(w.toString(),D.toString(),O,W);if(!K)return null;return{identical:K.identical,quitEarly:K.quitEarly,changes:G(K.changes),moves:K.moves.map(Q=>new MovedText(new LineRangeMapping(new LineRange$1(Q[0],Q[1]),new LineRange$1(Q[2],Q[3])),G(Q[4])))};function G(Q){return Q.map(Y=>new DetailedLineRangeMapping(new LineRange$1(Y[0],Y[1]),new LineRange$1(Y[2],Y[3]),Y[4]?.map(X=>new RangeMapping(new Range$2(X[0],X[1],X[2],X[3]),new Range$2(X[4],X[5],X[6],X[7])))))}}async computeMoreMinimalEdits(w,D,O=!1){if(isNonEmptyArray(D)){if(!canSyncModel(this._modelService,w))return Promise.resolve(D);const W=StopWatch.create(),U=this._workerWithResources([w]).then(K=>K.$computeMoreMinimalEdits(w.toString(),D,O));return U.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",w.toString(!0),W.elapsed())),Promise.race([U,timeout(1e3).then(()=>D)])}else return Promise.resolve(void 0)}canNavigateValueSet(w){return canSyncModel(this._modelService,w)}async navigateValueSet(w,D,O){const W=this._modelService.getModel(w);if(!W)return null;const U=this._languageConfigurationService.getLanguageConfiguration(W.getLanguageId()).getWordDefinition(),K=U.source,q=U.flags;return(await this._workerWithResources([w])).$navigateValueSet(w.toString(),D,O,K,q)}canComputeWordRanges(w){return canSyncModel(this._modelService,w)}async computeWordRanges(w,D){const O=this._modelService.getModel(w);if(!O)return Promise.resolve(null);const W=this._languageConfigurationService.getLanguageConfiguration(O.getLanguageId()).getWordDefinition(),U=W.source,K=W.flags;return(await this._workerWithResources([w])).$computeWordRanges(w.toString(),D,U,K)}async findSectionHeaders(w,D){return(await this._workerWithResources([w])).$findSectionHeaders(w.toString(),D)}async computeDefaultDocumentColors(w){return(await this._workerWithResources([w])).$computeDefaultDocumentColors(w.toString())}async _workerWithResources(w,D=!1){return await(await this._workerManager.withWorker()).workerWithSyncedResources(w,D)}};EditorWorkerService=__decorate$J([__param$H(1,IModelService),__param$H(2,ITextResourceConfigurationService),__param$H(3,ILogService),__param$H(4,ILanguageConfigurationService),__param$H(5,ILanguageFeaturesService)],EditorWorkerService);class WordBasedCompletionItemProvider{constructor(w,D,O,W){this.languageConfigurationService=W,this._debugDisplayName="wordbasedCompletions",this._workerManager=w,this._configurationService=D,this._modelService=O}async provideCompletionItems(w,D){const O=this._configurationService.getValue(w.uri,D,"editor");if(O.wordBasedSuggestions==="off")return;const W=[];if(O.wordBasedSuggestions==="currentDocument")canSyncModel(this._modelService,w.uri)&&W.push(w.uri);else for(const X of this._modelService.getModels())canSyncModel(this._modelService,X.uri)&&(X===w?W.unshift(X.uri):(O.wordBasedSuggestions==="allDocuments"||X.getLanguageId()===w.getLanguageId())&&W.push(X.uri));if(W.length===0)return;const U=this.languageConfigurationService.getLanguageConfiguration(w.getLanguageId()).getWordDefinition(),K=w.getWordAtPosition(D),q=K?new Range$2(D.lineNumber,K.startColumn,D.lineNumber,K.endColumn):Range$2.fromPositions(D),G=q.setEndPosition(D.lineNumber,D.column),Y=await(await this._workerManager.withWorker()).textualSuggest(W,K?.word,U);if(Y)return{duration:Y.duration,suggestions:Y.words.map(X=>({kind:18,label:X,insertText:X,range:{insert:G,replace:q}}))}}}let WorkerManager=class extends Disposable{constructor(w,D){super(),this._workerDescriptor=w,this._modelService=D,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new WindowIntervalTimer).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(STOP_WORKER_DELTA_TIME_MS/2),mainWindow),this._register(this._modelService.onModelRemoved(W=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>STOP_WORKER_DELTA_TIME_MS&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new EditorWorkerClient(this._workerDescriptor,!1,this._modelService)),Promise.resolve(this._editorWorkerClient)}};WorkerManager=__decorate$J([__param$H(1,IModelService)],WorkerManager);class SynchronousWorkerClient{constructor(w){this._instance=w,this.proxy=this._instance}dispose(){this._instance.dispose()}setChannel(w,D){throw new Error("Not supported")}}let EditorWorkerClient=class extends Disposable{constructor(w,D,O){super(),this._workerDescriptor=w,this._disposed=!1,this._modelService=O,this._keepIdleModels=D,this._worker=null,this._modelManager=null}fhr(w,D){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(createWebWorker$2(this._workerDescriptor)),EditorWorkerHost.setChannel(this._worker,this._createEditorWorkerHost())}catch(w){logOnceWebWorkerWarning(w),this._worker=this._createFallbackLocalWorker()}return this._worker}async _getProxy(){try{const w=this._getOrCreateWorker().proxy;return await w.$ping(),w}catch(w){return logOnceWebWorkerWarning(w),this._worker=this._createFallbackLocalWorker(),this._worker.proxy}}_createFallbackLocalWorker(){return new SynchronousWorkerClient(new EditorSimpleWorker(this._createEditorWorkerHost(),null))}_createEditorWorkerHost(){return{$fhr:(w,D)=>this.fhr(w,D)}}_getOrCreateModelManager(w){return this._modelManager||(this._modelManager=this._register(new WorkerTextModelSyncClient(w,this._modelService,this._keepIdleModels))),this._modelManager}async workerWithSyncedResources(w,D=!1){if(this._disposed)return Promise.reject(canceled());const O=await this._getProxy();return this._getOrCreateModelManager(O).ensureSyncedResources(w,D),O}async textualSuggest(w,D,O){const W=await this.workerWithSyncedResources(w),U=O.source,K=O.flags;return W.$textualSuggest(w.map(q=>q.toString()),D,U,K)}dispose(){super.dispose(),this._disposed=!0}};EditorWorkerClient=__decorate$J([__param$H(2,IModelService)],EditorWorkerClient);var __decorate$I=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$G=function(F,w){return function(D,O){w(D,O,F)}};let AbstractCodeEditorService=class extends Disposable{constructor(w){super(),this._themeService=w,this._onWillCreateCodeEditor=this._register(new Emitter$1),this._onCodeEditorAdd=this._register(new Emitter$1),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new Emitter$1),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onWillCreateDiffEditor=this._register(new Emitter$1),this._onDiffEditorAdd=this._register(new Emitter$1),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new Emitter$1),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new LinkedList,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}willCreateCodeEditor(){this._onWillCreateCodeEditor.fire()}addCodeEditor(w){this._codeEditors[w.getId()]=w,this._onCodeEditorAdd.fire(w)}removeCodeEditor(w){delete this._codeEditors[w.getId()]&&this._onCodeEditorRemove.fire(w)}listCodeEditors(){return Object.keys(this._codeEditors).map(w=>this._codeEditors[w])}willCreateDiffEditor(){this._onWillCreateDiffEditor.fire()}addDiffEditor(w){this._diffEditors[w.getId()]=w,this._onDiffEditorAdd.fire(w)}listDiffEditors(){return Object.keys(this._diffEditors).map(w=>this._diffEditors[w])}getFocusedCodeEditor(){let w=null;const D=this.listCodeEditors();for(const O of D){if(O.hasTextFocus())return O;O.hasWidgetFocus()&&(w=O)}return w}removeDecorationType(w){const D=this._decorationOptionProviders.get(w);D&&(D.refCount--,D.refCount<=0&&(this._decorationOptionProviders.delete(w),D.dispose(),this.listCodeEditors().forEach(O=>O.removeDecorationsByType(w))))}setModelProperty(w,D,O){const W=w.toString();let U;this._modelProperties.has(W)?U=this._modelProperties.get(W):(U=new Map,this._modelProperties.set(W,U)),U.set(D,O)}getModelProperty(w,D){const O=w.toString();if(this._modelProperties.has(O))return this._modelProperties.get(O).get(D)}async openCodeEditor(w,D,O){for(const W of this._codeEditorOpenHandlers){const U=await W(w,D,O);if(U!==null)return U}return null}registerCodeEditorOpenHandler(w){const D=this._codeEditorOpenHandlers.unshift(w);return toDisposable(D)}};AbstractCodeEditorService=__decorate$I([__param$G(0,IThemeService)],AbstractCodeEditorService);var __decorate$H=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$F=function(F,w){return function(D,O){w(D,O,F)}};let StandaloneCodeEditorService=class extends AbstractCodeEditorService{constructor(w,D){super(D),this._register(this.onCodeEditorAdd(()=>this._checkContextKey())),this._register(this.onCodeEditorRemove(()=>this._checkContextKey())),this._editorIsOpen=w.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this._register(this.registerCodeEditorOpenHandler(async(O,W,U)=>W?this.doOpenEditor(W,O):null))}_checkContextKey(){let w=!1;for(const D of this.listCodeEditors())if(!D.isSimpleWidget){w=!0;break}this._editorIsOpen.set(w)}setActiveCodeEditor(w){this._activeCodeEditor=w}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(w,D){if(!this.findModel(w,D.resource)){if(D.resource){const U=D.resource.scheme;if(U===Schemas.http||U===Schemas.https)return windowOpenNoOpener(D.resource.toString()),w}return null}const W=D.options?D.options.selection:null;if(W)if(typeof W.endLineNumber=="number"&&typeof W.endColumn=="number")w.setSelection(W),w.revealRangeInCenter(W,1);else{const U={lineNumber:W.startLineNumber,column:W.startColumn};w.setPosition(U),w.revealPositionInCenter(U,1)}return w}findModel(w,D){const O=w.getModel();return O&&O.uri.toString()!==D.toString()?null:O}};StandaloneCodeEditorService=__decorate$H([__param$F(0,IContextKeyService),__param$F(1,IThemeService)],StandaloneCodeEditorService);registerSingleton(ICodeEditorService,StandaloneCodeEditorService,0);const ILayoutService=createDecorator("layoutService");var __decorate$G=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$E=function(F,w){return function(D,O){w(D,O,F)}};let StandaloneLayoutService=class{get mainContainer(){return firstOrDefault(this._codeEditorService.listCodeEditors())?.getContainerDomNode()??mainWindow.document.body}get activeContainer(){return(this._codeEditorService.getFocusedCodeEditor()??this._codeEditorService.getActiveCodeEditor())?.getContainerDomNode()??this.mainContainer}get mainContainerDimension(){return getClientArea(this.mainContainer)}get activeContainerDimension(){return getClientArea(this.activeContainer)}get containers(){return coalesce(this._codeEditorService.listCodeEditors().map(w=>w.getContainerDomNode()))}getContainer(){return this.activeContainer}whenContainerStylesLoaded(){}focus(){this._codeEditorService.getFocusedCodeEditor()?.focus()}constructor(w){this._codeEditorService=w,this.onDidLayoutMainContainer=Event$1.None,this.onDidLayoutActiveContainer=Event$1.None,this.onDidLayoutContainer=Event$1.None,this.onDidChangeActiveContainer=Event$1.None,this.onDidAddContainer=Event$1.None,this.mainContainerOffset={top:0,quickPickTop:0},this.activeContainerOffset={top:0,quickPickTop:0}}};StandaloneLayoutService=__decorate$G([__param$E(0,ICodeEditorService)],StandaloneLayoutService);let EditorScopedLayoutService=class extends StandaloneLayoutService{get mainContainer(){return this._container}constructor(w,D){super(D),this._container=w}};EditorScopedLayoutService=__decorate$G([__param$E(1,ICodeEditorService)],EditorScopedLayoutService);registerSingleton(ILayoutService,StandaloneLayoutService,1);const IDialogService=createDecorator("dialogService");var __decorate$F=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$D=function(F,w){return function(D,O){w(D,O,F)}};function getResourceLabel(F){return F.scheme===Schemas.file?F.fsPath:F.path}let stackElementCounter=0;class ResourceStackElement{constructor(w,D,O,W,U,K,q){this.id=++stackElementCounter,this.type=0,this.actual=w,this.label=w.label,this.confirmBeforeUndo=w.confirmBeforeUndo||!1,this.resourceLabel=D,this.strResource=O,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=W,this.groupOrder=U,this.sourceId=K,this.sourceOrder=q,this.isValid=!0}setValid(w){this.isValid=w}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class ResourceReasonPair{constructor(w,D){this.resourceLabel=w,this.reason=D}}class RemovedResources{constructor(){this.elements=new Map}createMessage(){const w=[],D=[];for(const[,W]of this.elements)(W.reason===0?w:D).push(W.resourceLabel);const O=[];return w.length>0&&O.push(localize({key:"externalRemoval",comment:["{0} is a list of filenames"]},"The following files have been closed and modified on disk: {0}.",w.join(", "))),D.length>0&&O.push(localize({key:"noParallelUniverses",comment:["{0} is a list of filenames"]},"The following files have been modified in an incompatible way: {0}.",D.join(", "))),O.join(`
`)}get size(){return this.elements.size}has(w){return this.elements.has(w)}set(w,D){this.elements.set(w,D)}delete(w){return this.elements.delete(w)}}class WorkspaceStackElement{constructor(w,D,O,W,U,K,q){this.id=++stackElementCounter,this.type=1,this.actual=w,this.label=w.label,this.confirmBeforeUndo=w.confirmBeforeUndo||!1,this.resourceLabels=D,this.strResources=O,this.groupId=W,this.groupOrder=U,this.sourceId=K,this.sourceOrder=q,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(w,D,O){this.removedResources||(this.removedResources=new RemovedResources),this.removedResources.has(D)||this.removedResources.set(D,new ResourceReasonPair(w,O))}setValid(w,D,O){O?this.invalidatedResources&&(this.invalidatedResources.delete(D),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new RemovedResources),this.invalidatedResources.has(D)||this.invalidatedResources.set(D,new ResourceReasonPair(w,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class ResourceEditStack{constructor(w,D){this.resourceLabel=w,this.strResource=D,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const w of this._past)w.type===1&&w.removeResource(this.resourceLabel,this.strResource,0);for(const w of this._future)w.type===1&&w.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const w=[];w.push(`* ${this.strResource}:`);for(let D=0;D<this._past.length;D++)w.push(`   * [UNDO] ${this._past[D]}`);for(let D=this._future.length-1;D>=0;D--)w.push(`   * [REDO] ${this._future[D]}`);return w.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(w,D){w.type===1?w.setValid(this.resourceLabel,this.strResource,D):w.setValid(D)}setElementsValidFlag(w,D){for(const O of this._past)D(O.actual)&&this._setElementValidFlag(O,w);for(const O of this._future)D(O.actual)&&this._setElementValidFlag(O,w)}pushElement(w){for(const D of this._future)D.type===1&&D.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(w),this.versionId++}createSnapshot(w){const D=[];for(let O=0,W=this._past.length;O<W;O++)D.push(this._past[O].id);for(let O=this._future.length-1;O>=0;O--)D.push(this._future[O].id);return new ResourceEditStackSnapshot(w,D)}restoreSnapshot(w){const D=w.elements.length;let O=!0,W=0,U=-1;for(let q=0,G=this._past.length;q<G;q++,W++){const Q=this._past[q];O&&(W>=D||Q.id!==w.elements[W])&&(O=!1,U=0),!O&&Q.type===1&&Q.removeResource(this.resourceLabel,this.strResource,0)}let K=-1;for(let q=this._future.length-1;q>=0;q--,W++){const G=this._future[q];O&&(W>=D||G.id!==w.elements[W])&&(O=!1,K=q),!O&&G.type===1&&G.removeResource(this.resourceLabel,this.strResource,0)}U!==-1&&(this._past=this._past.slice(0,U)),K!==-1&&(this._future=this._future.slice(K+1)),this.versionId++}getElements(){const w=[],D=[];for(const O of this._past)w.push(O.actual);for(const O of this._future)D.push(O.actual);return{past:w,future:D}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(w,D){for(let O=this._past.length-1;O>=0;O--)if(this._past[O]===w){D.has(this.strResource)?this._past[O]=D.get(this.strResource):this._past.splice(O,1);break}this.versionId++}splitFutureWorkspaceElement(w,D){for(let O=this._future.length-1;O>=0;O--)if(this._future[O]===w){D.has(this.strResource)?this._future[O]=D.get(this.strResource):this._future.splice(O,1);break}this.versionId++}moveBackward(w){this._past.pop(),this._future.push(w),this.versionId++}moveForward(w){this._future.pop(),this._past.push(w),this.versionId++}}class EditStackSnapshot{constructor(w){this.editStacks=w,this._versionIds=[];for(let D=0,O=this.editStacks.length;D<O;D++)this._versionIds[D]=this.editStacks[D].versionId}isValid(){for(let w=0,D=this.editStacks.length;w<D;w++)if(this._versionIds[w]!==this.editStacks[w].versionId)return!1;return!0}}const missingEditStack=new ResourceEditStack("","");missingEditStack.locked=!0;let UndoRedoService=class{constructor(w,D){this._dialogService=w,this._notificationService=D,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(w){for(const D of this._uriComparisonKeyComputers)if(D[0]===w.scheme)return D[1].getComparisonKey(w);return w.toString()}_print(w){console.log("------------------------------------"),console.log(`AFTER ${w}: `);const D=[];for(const O of this._editStacks)D.push(O[1].toString());console.log(D.join(`
`))}pushElement(w,D=UndoRedoGroup.None,O=UndoRedoSource.None){if(w.type===0){const W=getResourceLabel(w.resource),U=this.getUriComparisonKey(w.resource);this._pushElement(new ResourceStackElement(w,W,U,D.id,D.nextOrder(),O.id,O.nextOrder()))}else{const W=new Set,U=[],K=[];for(const q of w.resources){const G=getResourceLabel(q),Q=this.getUriComparisonKey(q);W.has(Q)||(W.add(Q),U.push(G),K.push(Q))}U.length===1?this._pushElement(new ResourceStackElement(w,U[0],K[0],D.id,D.nextOrder(),O.id,O.nextOrder())):this._pushElement(new WorkspaceStackElement(w,U,K,D.id,D.nextOrder(),O.id,O.nextOrder()))}}_pushElement(w){for(let D=0,O=w.strResources.length;D<O;D++){const W=w.resourceLabels[D],U=w.strResources[D];let K;this._editStacks.has(U)?K=this._editStacks.get(U):(K=new ResourceEditStack(W,U),this._editStacks.set(U,K)),K.pushElement(w)}}getLastElement(w){const D=this.getUriComparisonKey(w);if(this._editStacks.has(D)){const O=this._editStacks.get(D);if(O.hasFutureElements())return null;const W=O.getClosestPastElement();return W?W.actual:null}return null}_splitPastWorkspaceElement(w,D){const O=w.actual.split(),W=new Map;for(const U of O){const K=getResourceLabel(U.resource),q=this.getUriComparisonKey(U.resource),G=new ResourceStackElement(U,K,q,0,0,0,0);W.set(G.strResource,G)}for(const U of w.strResources){if(D&&D.has(U))continue;this._editStacks.get(U).splitPastWorkspaceElement(w,W)}}_splitFutureWorkspaceElement(w,D){const O=w.actual.split(),W=new Map;for(const U of O){const K=getResourceLabel(U.resource),q=this.getUriComparisonKey(U.resource),G=new ResourceStackElement(U,K,q,0,0,0,0);W.set(G.strResource,G)}for(const U of w.strResources){if(D&&D.has(U))continue;this._editStacks.get(U).splitFutureWorkspaceElement(w,W)}}removeElements(w){const D=typeof w=="string"?w:this.getUriComparisonKey(w);this._editStacks.has(D)&&(this._editStacks.get(D).dispose(),this._editStacks.delete(D))}setElementsValidFlag(w,D,O){const W=this.getUriComparisonKey(w);this._editStacks.has(W)&&this._editStacks.get(W).setElementsValidFlag(D,O)}createSnapshot(w){const D=this.getUriComparisonKey(w);return this._editStacks.has(D)?this._editStacks.get(D).createSnapshot(w):new ResourceEditStackSnapshot(w,[])}restoreSnapshot(w){const D=this.getUriComparisonKey(w.resource);if(this._editStacks.has(D)){const O=this._editStacks.get(D);O.restoreSnapshot(w),!O.hasPastElements()&&!O.hasFutureElements()&&(O.dispose(),this._editStacks.delete(D))}}getElements(w){const D=this.getUriComparisonKey(w);return this._editStacks.has(D)?this._editStacks.get(D).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(w){if(!w)return[null,null];let D=null,O=null;for(const[W,U]of this._editStacks){const K=U.getClosestPastElement();K&&K.sourceId===w&&(!D||K.sourceOrder>D.sourceOrder)&&(D=K,O=W)}return[D,O]}canUndo(w){if(w instanceof UndoRedoSource){const[,O]=this._findClosestUndoElementWithSource(w.id);return!!O}const D=this.getUriComparisonKey(w);return this._editStacks.has(D)?this._editStacks.get(D).hasPastElements():!1}_onError(w,D){onUnexpectedError(w);for(const O of D.strResources)this.removeElements(O);this._notificationService.error(w)}_acquireLocks(w){for(const D of w.editStacks)if(D.locked)throw new Error("Cannot acquire edit stack lock");for(const D of w.editStacks)D.locked=!0;return()=>{for(const D of w.editStacks)D.locked=!1}}_safeInvokeWithLocks(w,D,O,W,U){const K=this._acquireLocks(O);let q;try{q=D()}catch(G){return K(),W.dispose(),this._onError(G,w)}return q?q.then(()=>(K(),W.dispose(),U()),G=>(K(),W.dispose(),this._onError(G,w))):(K(),W.dispose(),U())}async _invokeWorkspacePrepare(w){if(typeof w.actual.prepareUndoRedo>"u")return Disposable.None;const D=w.actual.prepareUndoRedo();return typeof D>"u"?Disposable.None:D}_invokeResourcePrepare(w,D){if(w.actual.type!==1||typeof w.actual.prepareUndoRedo>"u")return D(Disposable.None);const O=w.actual.prepareUndoRedo();return O?isDisposable(O)?D(O):O.then(W=>D(W)):D(Disposable.None)}_getAffectedEditStacks(w){const D=[];for(const O of w.strResources)D.push(this._editStacks.get(O)||missingEditStack);return new EditStackSnapshot(D)}_tryToSplitAndUndo(w,D,O,W){if(D.canSplit())return this._splitPastWorkspaceElement(D,O),this._notificationService.warn(W),new WorkspaceVerificationError(this._undo(w,0,!0));for(const U of D.strResources)this.removeElements(U);return this._notificationService.warn(W),new WorkspaceVerificationError}_checkWorkspaceUndo(w,D,O,W){if(D.removedResources)return this._tryToSplitAndUndo(w,D,D.removedResources,localize({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",D.label,D.removedResources.createMessage()));if(W&&D.invalidatedResources)return this._tryToSplitAndUndo(w,D,D.invalidatedResources,localize({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",D.label,D.invalidatedResources.createMessage()));const U=[];for(const q of O.editStacks)q.getClosestPastElement()!==D&&U.push(q.resourceLabel);if(U.length>0)return this._tryToSplitAndUndo(w,D,null,localize({key:"cannotWorkspaceUndoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because changes were made to {1}",D.label,U.join(", ")));const K=[];for(const q of O.editStacks)q.locked&&K.push(q.resourceLabel);return K.length>0?this._tryToSplitAndUndo(w,D,null,localize({key:"cannotWorkspaceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",D.label,K.join(", "))):O.isValid()?null:this._tryToSplitAndUndo(w,D,null,localize({key:"cannotWorkspaceUndoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",D.label))}_workspaceUndo(w,D,O){const W=this._getAffectedEditStacks(D),U=this._checkWorkspaceUndo(w,D,W,!1);return U?U.returnValue:this._confirmAndExecuteWorkspaceUndo(w,D,W,O)}_isPartOfUndoGroup(w){if(!w.groupId)return!1;for(const[,D]of this._editStacks){const O=D.getClosestPastElement();if(O){if(O===w){const W=D.getSecondClosestPastElement();if(W&&W.groupId===w.groupId)return!0}if(O.groupId===w.groupId)return!0}}return!1}async _confirmAndExecuteWorkspaceUndo(w,D,O,W){if(D.canSplit()&&!this._isPartOfUndoGroup(D)){let q;(function(Y){Y[Y.All=0]="All",Y[Y.This=1]="This",Y[Y.Cancel=2]="Cancel"})(q||(q={}));const{result:G}=await this._dialogService.prompt({type:Severity$2.Info,message:localize("confirmWorkspace","Would you like to undo '{0}' across all files?",D.label),buttons:[{label:localize({key:"ok",comment:["{0} denotes a number that is > 1, && denotes a mnemonic"]},"&&Undo in {0} Files",O.editStacks.length),run:()=>q.All},{label:localize({key:"nok",comment:["&& denotes a mnemonic"]},"Undo this &&File"),run:()=>q.This}],cancelButton:{run:()=>q.Cancel}});if(G===q.Cancel)return;if(G===q.This)return this._splitPastWorkspaceElement(D,null),this._undo(w,0,!0);const Q=this._checkWorkspaceUndo(w,D,O,!1);if(Q)return Q.returnValue;W=!0}let U;try{U=await this._invokeWorkspacePrepare(D)}catch(q){return this._onError(q,D)}const K=this._checkWorkspaceUndo(w,D,O,!0);if(K)return U.dispose(),K.returnValue;for(const q of O.editStacks)q.moveBackward(D);return this._safeInvokeWithLocks(D,()=>D.actual.undo(),O,U,()=>this._continueUndoInGroup(D.groupId,W))}_resourceUndo(w,D,O){if(!D.isValid){w.flushAllElements();return}if(w.locked){const W=localize({key:"cannotResourceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not undo '{0}' because there is already an undo or redo operation running.",D.label);this._notificationService.warn(W);return}return this._invokeResourcePrepare(D,W=>(w.moveBackward(D),this._safeInvokeWithLocks(D,()=>D.actual.undo(),new EditStackSnapshot([w]),W,()=>this._continueUndoInGroup(D.groupId,O))))}_findClosestUndoElementInGroup(w){if(!w)return[null,null];let D=null,O=null;for(const[W,U]of this._editStacks){const K=U.getClosestPastElement();K&&K.groupId===w&&(!D||K.groupOrder>D.groupOrder)&&(D=K,O=W)}return[D,O]}_continueUndoInGroup(w,D){if(!w)return;const[,O]=this._findClosestUndoElementInGroup(w);if(O)return this._undo(O,0,D)}undo(w){if(w instanceof UndoRedoSource){const[,D]=this._findClosestUndoElementWithSource(w.id);return D?this._undo(D,w.id,!1):void 0}return typeof w=="string"?this._undo(w,0,!1):this._undo(this.getUriComparisonKey(w),0,!1)}_undo(w,D=0,O){if(!this._editStacks.has(w))return;const W=this._editStacks.get(w),U=W.getClosestPastElement();if(!U)return;if(U.groupId){const[q,G]=this._findClosestUndoElementInGroup(U.groupId);if(U!==q&&G)return this._undo(G,D,O)}if((U.sourceId!==D||U.confirmBeforeUndo)&&!O)return this._confirmAndContinueUndo(w,D,U);try{return U.type===1?this._workspaceUndo(w,U,O):this._resourceUndo(W,U,O)}finally{}}async _confirmAndContinueUndo(w,D,O){if((await this._dialogService.confirm({message:localize("confirmDifferentSource","Would you like to undo '{0}'?",O.label),primaryButton:localize({key:"confirmDifferentSource.yes",comment:["&& denotes a mnemonic"]},"&&Yes"),cancelButton:localize("confirmDifferentSource.no","No")})).confirmed)return this._undo(w,D,!0)}_findClosestRedoElementWithSource(w){if(!w)return[null,null];let D=null,O=null;for(const[W,U]of this._editStacks){const K=U.getClosestFutureElement();K&&K.sourceId===w&&(!D||K.sourceOrder<D.sourceOrder)&&(D=K,O=W)}return[D,O]}canRedo(w){if(w instanceof UndoRedoSource){const[,O]=this._findClosestRedoElementWithSource(w.id);return!!O}const D=this.getUriComparisonKey(w);return this._editStacks.has(D)?this._editStacks.get(D).hasFutureElements():!1}_tryToSplitAndRedo(w,D,O,W){if(D.canSplit())return this._splitFutureWorkspaceElement(D,O),this._notificationService.warn(W),new WorkspaceVerificationError(this._redo(w));for(const U of D.strResources)this.removeElements(U);return this._notificationService.warn(W),new WorkspaceVerificationError}_checkWorkspaceRedo(w,D,O,W){if(D.removedResources)return this._tryToSplitAndRedo(w,D,D.removedResources,localize({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",D.label,D.removedResources.createMessage()));if(W&&D.invalidatedResources)return this._tryToSplitAndRedo(w,D,D.invalidatedResources,localize({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",D.label,D.invalidatedResources.createMessage()));const U=[];for(const q of O.editStacks)q.getClosestFutureElement()!==D&&U.push(q.resourceLabel);if(U.length>0)return this._tryToSplitAndRedo(w,D,null,localize({key:"cannotWorkspaceRedoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because changes were made to {1}",D.label,U.join(", ")));const K=[];for(const q of O.editStacks)q.locked&&K.push(q.resourceLabel);return K.length>0?this._tryToSplitAndRedo(w,D,null,localize({key:"cannotWorkspaceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",D.label,K.join(", "))):O.isValid()?null:this._tryToSplitAndRedo(w,D,null,localize({key:"cannotWorkspaceRedoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",D.label))}_workspaceRedo(w,D){const O=this._getAffectedEditStacks(D),W=this._checkWorkspaceRedo(w,D,O,!1);return W?W.returnValue:this._executeWorkspaceRedo(w,D,O)}async _executeWorkspaceRedo(w,D,O){let W;try{W=await this._invokeWorkspacePrepare(D)}catch(K){return this._onError(K,D)}const U=this._checkWorkspaceRedo(w,D,O,!0);if(U)return W.dispose(),U.returnValue;for(const K of O.editStacks)K.moveForward(D);return this._safeInvokeWithLocks(D,()=>D.actual.redo(),O,W,()=>this._continueRedoInGroup(D.groupId))}_resourceRedo(w,D){if(!D.isValid){w.flushAllElements();return}if(w.locked){const O=localize({key:"cannotResourceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not redo '{0}' because there is already an undo or redo operation running.",D.label);this._notificationService.warn(O);return}return this._invokeResourcePrepare(D,O=>(w.moveForward(D),this._safeInvokeWithLocks(D,()=>D.actual.redo(),new EditStackSnapshot([w]),O,()=>this._continueRedoInGroup(D.groupId))))}_findClosestRedoElementInGroup(w){if(!w)return[null,null];let D=null,O=null;for(const[W,U]of this._editStacks){const K=U.getClosestFutureElement();K&&K.groupId===w&&(!D||K.groupOrder<D.groupOrder)&&(D=K,O=W)}return[D,O]}_continueRedoInGroup(w){if(!w)return;const[,D]=this._findClosestRedoElementInGroup(w);if(D)return this._redo(D)}redo(w){if(w instanceof UndoRedoSource){const[,D]=this._findClosestRedoElementWithSource(w.id);return D?this._redo(D):void 0}return typeof w=="string"?this._redo(w):this._redo(this.getUriComparisonKey(w))}_redo(w){if(!this._editStacks.has(w))return;const D=this._editStacks.get(w),O=D.getClosestFutureElement();if(O){if(O.groupId){const[W,U]=this._findClosestRedoElementInGroup(O.groupId);if(O!==W&&U)return this._redo(U)}try{return O.type===1?this._workspaceRedo(w,O):this._resourceRedo(D,O)}finally{}}}};UndoRedoService=__decorate$F([__param$D(0,IDialogService),__param$D(1,INotificationService)],UndoRedoService);class WorkspaceVerificationError{constructor(w){this.returnValue=w}}registerSingleton(IUndoRedoService,UndoRedoService,1);var __decorate$E=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$C=function(F,w){return function(D,O){w(D,O,F)}};const ILanguageFeatureDebounceService=createDecorator("ILanguageFeatureDebounceService");var IdentityHash;(function(F){const w=new WeakMap;let D=0;function O(W){let U=w.get(W);return U===void 0&&(U=++D,w.set(W,U)),U}F.of=O})(IdentityHash||(IdentityHash={}));class NullDebounceInformation{constructor(w){this._default=w}get(w){return this._default}update(w,D){return this._default}default(){return this._default}}class FeatureDebounceInformation{constructor(w,D,O,W,U,K){this._logService=w,this._name=D,this._registry=O,this._default=W,this._min=U,this._max=K,this._cache=new LRUCache(50,.7)}_key(w){return w.id+this._registry.all(w).reduce((D,O)=>doHash(IdentityHash.of(O),D),0)}get(w){const D=this._key(w),O=this._cache.get(D);return O?clamp(O.value,this._min,this._max):this.default()}update(w,D){const O=this._key(w);let W=this._cache.get(O);W||(W=new SlidingWindowAverage(6),this._cache.set(O,W));const U=clamp(W.update(D),this._min,this._max);return matchesScheme(w.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${w.uri.toString()} is ${U}ms`),U}_overall(){const w=new MovingAverage;for(const[,D]of this._cache)w.update(D.value);return w.value}default(){const w=this._overall()|0||this._default;return clamp(w,this._min,this._max)}}let LanguageFeatureDebounceService=class{constructor(w,D){this._logService=w,this._data=new Map,this._isDev=D.isExtensionDevelopment||!D.isBuilt}for(w,D,O){const W=O?.min??50,U=O?.max??W**2,K=O?.key??void 0,q=`${IdentityHash.of(w)},${W}${K?","+K:""}`;let G=this._data.get(q);return G||(this._isDev?(this._logService.debug(`[DEBOUNCE: ${D}] is disabled in developed mode`),G=new NullDebounceInformation(W*1.5)):G=new FeatureDebounceInformation(this._logService,D,w,this._overallAverage()|0||W*1.5,W,U),this._data.set(q,G)),G}_overallAverage(){const w=new MovingAverage;for(const D of this._data.values())w.update(D.default());return w.value}};LanguageFeatureDebounceService=__decorate$E([__param$C(0,ILogService),__param$C(1,IEnvironmentService)],LanguageFeatureDebounceService);registerSingleton(ILanguageFeatureDebounceService,LanguageFeatureDebounceService,1);var __decorate$D=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$B=function(F,w){return function(D,O){w(D,O,F)}};let SemanticTokensProviderStyling=class{constructor(w,D,O,W){this._legend=w,this._themeService=D,this._languageService=O,this._logService=W,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new HashTable}getMetadata(w,D,O){const W=this._languageService.languageIdCodec.encodeLanguageId(O),U=this._hashTable.get(w,D,W);let K;if(U)K=U.metadata;else{let q=this._legend.tokenTypes[w];const G=[];if(q){let Q=D;for(let X=0;Q>0&&X<this._legend.tokenModifiers.length;X++)Q&1&&G.push(this._legend.tokenModifiers[X]),Q=Q>>1;const Y=this._themeService.getColorTheme().getTokenStyleMetadata(q,G,O);if(typeof Y>"u")K=2147483647;else{if(K=0,typeof Y.italic<"u"){const X=(Y.italic?1:0)<<11;K|=X|1}if(typeof Y.bold<"u"){const X=(Y.bold?2:0)<<11;K|=X|2}if(typeof Y.underline<"u"){const X=(Y.underline?4:0)<<11;K|=X|4}if(typeof Y.strikethrough<"u"){const X=(Y.strikethrough?8:0)<<11;K|=X|8}if(Y.foreground){const X=Y.foreground<<15;K|=X|16}K===0&&(K=2147483647)}}else K=2147483647,q="not-in-legend";this._hashTable.add(w,D,W,K)}return K}warnOverlappingSemanticTokens(w,D){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,this._logService.warn(`Overlapping semantic tokens detected at lineNumber ${w}, column ${D}`))}warnInvalidLengthSemanticTokens(w,D){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,this._logService.warn(`Semantic token with invalid length detected at lineNumber ${w}, column ${D}`))}warnInvalidEditStart(w,D,O,W,U){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,this._logService.warn(`Invalid semantic tokens edit detected (previousResultId: ${w}, resultId: ${D}) at edit #${O}: The provided start offset ${W} is outside the previous data (length ${U}).`))}};SemanticTokensProviderStyling=__decorate$D([__param$B(1,IThemeService),__param$B(2,ILanguageService),__param$B(3,ILogService)],SemanticTokensProviderStyling);class HashTableEntry{constructor(w,D,O,W){this.tokenTypeIndex=w,this.tokenModifierSet=D,this.languageId=O,this.metadata=W,this.next=null}}class HashTable{static{this._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143]}constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=HashTable._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<HashTable._SIZES.length?2/3*this._currentLength:0),this._elements=[],HashTable._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(w,D){for(let O=0;O<D;O++)w[O]=null}_hash2(w,D){return(w<<5)-w+D|0}_hashFunc(w,D,O){return this._hash2(this._hash2(w,D),O)%this._currentLength}get(w,D,O){const W=this._hashFunc(w,D,O);let U=this._elements[W];for(;U;){if(U.tokenTypeIndex===w&&U.tokenModifierSet===D&&U.languageId===O)return U;U=U.next}return null}add(w,D,O,W){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const U=this._elements;this._currentLengthIndex++,this._currentLength=HashTable._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<HashTable._SIZES.length?2/3*this._currentLength:0),this._elements=[],HashTable._nullOutEntries(this._elements,this._currentLength);for(const K of U){let q=K;for(;q;){const G=q.next;q.next=null,this._add(q),q=G}}}this._add(new HashTableEntry(w,D,O,W))}_add(w){const D=this._hashFunc(w.tokenTypeIndex,w.tokenModifierSet,w.languageId);w.next=this._elements[D],this._elements[D]=w}}const ISemanticTokensStylingService=createDecorator("semanticTokensStylingService");var __decorate$C=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$A=function(F,w){return function(D,O){w(D,O,F)}};let SemanticTokensStylingService=class extends Disposable{constructor(w,D,O){super(),this._themeService=w,this._logService=D,this._languageService=O,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap}))}getStyling(w){return this._caches.has(w)||this._caches.set(w,new SemanticTokensProviderStyling(w.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(w)}};SemanticTokensStylingService=__decorate$C([__param$A(0,IThemeService),__param$A(1,ILogService),__param$A(2,ILanguageService)],SemanticTokensStylingService);registerSingleton(ISemanticTokensStylingService,SemanticTokensStylingService,1);const GLOBSTAR="**",GLOB_SPLIT="/",PATH_REGEX="[/\\\\]",NO_PATH_REGEX="[^/\\\\]",ALL_FORWARD_SLASHES=/\//g;function starsToRegExp(F,w){switch(F){case 0:return"";case 1:return`${NO_PATH_REGEX}*?`;default:return`(?:${PATH_REGEX}|${NO_PATH_REGEX}+${PATH_REGEX}${w?`|${PATH_REGEX}${NO_PATH_REGEX}+`:""})*?`}}function splitGlobAware(F,w){if(!F)return[];const D=[];let O=!1,W=!1,U="";for(const K of F){switch(K){case w:if(!O&&!W){D.push(U),U="";continue}break;case"{":O=!0;break;case"}":O=!1;break;case"[":W=!0;break;case"]":W=!1;break}U+=K}return U&&D.push(U),D}function parseRegExp(F){if(!F)return"";let w="";const D=splitGlobAware(F,GLOB_SPLIT);if(D.every(O=>O===GLOBSTAR))w=".*";else{let O=!1;D.forEach((W,U)=>{if(W===GLOBSTAR){if(O)return;w+=starsToRegExp(2,U===D.length-1)}else{let K=!1,q="",G=!1,Q="";for(const Y of W){if(Y!=="}"&&K){q+=Y;continue}if(G&&(Y!=="]"||!Q)){let X;Y==="-"?X=Y:(Y==="^"||Y==="!")&&!Q?X="^":Y===GLOB_SPLIT?X="":X=escapeRegExpCharacters(Y),Q+=X;continue}switch(Y){case"{":K=!0;continue;case"[":G=!0;continue;case"}":{const J=`(?:${splitGlobAware(q,",").map(te=>parseRegExp(te)).join("|")})`;w+=J,K=!1,q="";break}case"]":{w+="["+Q+"]",G=!1,Q="";break}case"?":w+=NO_PATH_REGEX;continue;case"*":w+=starsToRegExp(1);continue;default:w+=escapeRegExpCharacters(Y)}}U<D.length-1&&(D[U+1]!==GLOBSTAR||U+2<D.length)&&(w+=PATH_REGEX)}O=W===GLOBSTAR})}return w}const T1=/^\*\*\/\*\.[\w\.-]+$/,T2=/^\*\*\/([\w\.-]+)\/?$/,T3=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,T3_2=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,T4=/^\*\*((\/[\w\.-]+)+)\/?$/,T5=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,CACHE=new LRUCache(1e4),FALSE=function(){return!1},NULL=function(){return null};function parsePattern(F,w){if(!F)return NULL;let D;typeof F!="string"?D=F.pattern:D=F,D=D.trim();const O=`${D}_${!!w.trimForExclusions}`;let W=CACHE.get(O);if(W)return wrapRelativePattern(W,F);let U;return T1.test(D)?W=trivia1(D.substr(4),D):(U=T2.exec(trimForExclusions(D,w)))?W=trivia2(U[1],D):(w.trimForExclusions?T3_2:T3).test(D)?W=trivia3(D,w):(U=T4.exec(trimForExclusions(D,w)))?W=trivia4and5(U[1].substr(1),D,!0):(U=T5.exec(trimForExclusions(D,w)))?W=trivia4and5(U[1],D,!1):W=toRegExp(D),CACHE.set(O,W),wrapRelativePattern(W,F)}function wrapRelativePattern(F,w){if(typeof w=="string")return F;const D=function(O,W){return isEqualOrParent(O,w.base,!isLinux)?F(ltrim(O.substr(w.base.length),sep),W):null};return D.allBasenames=F.allBasenames,D.allPaths=F.allPaths,D.basenames=F.basenames,D.patterns=F.patterns,D}function trimForExclusions(F,w){return w.trimForExclusions&&F.endsWith("/**")?F.substr(0,F.length-2):F}function trivia1(F,w){return function(D,O){return typeof D=="string"&&D.endsWith(F)?w:null}}function trivia2(F,w){const D=`/${F}`,O=`\\${F}`,W=function(K,q){return typeof K!="string"?null:q?q===F?w:null:K===F||K.endsWith(D)||K.endsWith(O)?w:null},U=[F];return W.basenames=U,W.patterns=[w],W.allBasenames=U,W}function trivia3(F,w){const D=aggregateBasenameMatches(F.slice(1,-1).split(",").map(q=>parsePattern(q,w)).filter(q=>q!==NULL),F),O=D.length;if(!O)return NULL;if(O===1)return D[0];const W=function(q,G){for(let Q=0,Y=D.length;Q<Y;Q++)if(D[Q](q,G))return F;return null},U=D.find(q=>!!q.allBasenames);U&&(W.allBasenames=U.allBasenames);const K=D.reduce((q,G)=>G.allPaths?q.concat(G.allPaths):q,[]);return K.length&&(W.allPaths=K),W}function trivia4and5(F,w,D){const O=sep===posix.sep,W=O?F:F.replace(ALL_FORWARD_SLASHES,sep),U=sep+W,K=posix.sep+F;let q;return D?q=function(G,Q){return typeof G=="string"&&(G===W||G.endsWith(U)||!O&&(G===F||G.endsWith(K)))?w:null}:q=function(G,Q){return typeof G=="string"&&(G===W||!O&&G===F)?w:null},q.allPaths=[(D?"*/":"./")+F],q}function toRegExp(F){try{const w=new RegExp(`^${parseRegExp(F)}$`);return function(D){return w.lastIndex=0,typeof D=="string"&&w.test(D)?F:null}}catch{return NULL}}function match(F,w,D){return!F||typeof w!="string"?!1:parse(F)(w,void 0,D)}function parse(F,w={}){if(!F)return FALSE;if(typeof F=="string"||isRelativePattern(F)){const D=parsePattern(F,w);if(D===NULL)return FALSE;const O=function(W,U){return!!D(W,U)};return D.allBasenames&&(O.allBasenames=D.allBasenames),D.allPaths&&(O.allPaths=D.allPaths),O}return parsedExpression(F,w)}function isRelativePattern(F){const w=F;return w?typeof w.base=="string"&&typeof w.pattern=="string":!1}function parsedExpression(F,w){const D=aggregateBasenameMatches(Object.getOwnPropertyNames(F).map(q=>parseExpressionPattern(q,F[q],w)).filter(q=>q!==NULL)),O=D.length;if(!O)return NULL;if(!D.some(q=>!!q.requiresSiblings)){if(O===1)return D[0];const q=function(Y,X){let J;for(let te=0,ie=D.length;te<ie;te++){const se=D[te](Y,X);if(typeof se=="string")return se;isThenable$1(se)&&(J||(J=[]),J.push(se))}return J?(async()=>{for(const te of J){const ie=await te;if(typeof ie=="string")return ie}return null})():null},G=D.find(Y=>!!Y.allBasenames);G&&(q.allBasenames=G.allBasenames);const Q=D.reduce((Y,X)=>X.allPaths?Y.concat(X.allPaths):Y,[]);return Q.length&&(q.allPaths=Q),q}const W=function(q,G,Q){let Y,X;for(let J=0,te=D.length;J<te;J++){const ie=D[J];ie.requiresSiblings&&Q&&(G||(G=basename$1(q)),Y||(Y=G.substr(0,G.length-extname$1(q).length)));const se=ie(q,G,Y,Q);if(typeof se=="string")return se;isThenable$1(se)&&(X||(X=[]),X.push(se))}return X?(async()=>{for(const J of X){const te=await J;if(typeof te=="string")return te}return null})():null},U=D.find(q=>!!q.allBasenames);U&&(W.allBasenames=U.allBasenames);const K=D.reduce((q,G)=>G.allPaths?q.concat(G.allPaths):q,[]);return K.length&&(W.allPaths=K),W}function parseExpressionPattern(F,w,D){if(w===!1)return NULL;const O=parsePattern(F,D);if(O===NULL)return NULL;if(typeof w=="boolean")return O;if(w){const W=w.when;if(typeof W=="string"){const U=(K,q,G,Q)=>{if(!Q||!O(K,q))return null;const Y=W.replace("$(basename)",()=>G),X=Q(Y);return isThenable$1(X)?X.then(J=>J?F:null):X?F:null};return U.requiresSiblings=!0,U}}return O}function aggregateBasenameMatches(F,w){const D=F.filter(q=>!!q.basenames);if(D.length<2)return F;const O=D.reduce((q,G)=>{const Q=G.basenames;return Q?q.concat(Q):q},[]);let W;if(w){W=[];for(let q=0,G=O.length;q<G;q++)W.push(w)}else W=D.reduce((q,G)=>{const Q=G.patterns;return Q?q.concat(Q):q},[]);const U=function(q,G){if(typeof q!="string")return null;if(!G){let Y;for(Y=q.length;Y>0;Y--){const X=q.charCodeAt(Y-1);if(X===47||X===92)break}G=q.substr(Y)}const Q=O.indexOf(G);return Q!==-1?W[Q]:null};U.basenames=O,U.patterns=W,U.allBasenames=O;const K=F.filter(q=>!q.basenames);return K.push(U),K}function score(F,w,D,O,W,U){if(Array.isArray(F)){let K=0;for(const q of F){const G=score(q,w,D,O,W,U);if(G===10)return G;G>K&&(K=G)}return K}else{if(typeof F=="string")return O?F==="*"?5:F===D?10:0:0;if(F){const{language:K,pattern:q,scheme:G,hasAccessToAllModels:Q,notebookType:Y}=F;if(!O&&!Q)return 0;Y&&W&&(w=W);let X=0;if(G)if(G===w.scheme)X=10;else if(G==="*")X=5;else return 0;if(K)if(K===D)X=10;else if(K==="*")X=Math.max(X,5);else return 0;if(Y)if(Y===U)X=10;else if(Y==="*"&&U!==void 0)X=Math.max(X,5);else return 0;if(q){let J;if(typeof q=="string"?J=q:J={...q,base:normalize(q.base)},J===w.fsPath||match(J,w.fsPath))X=10;else return 0}return X}else return 0}}function isExclusive(F){return typeof F=="string"?!1:Array.isArray(F)?F.every(isExclusive):!!F.exclusive}class MatchCandidate{constructor(w,D,O,W,U){this.uri=w,this.languageId=D,this.notebookUri=O,this.notebookType=W,this.recursive=U}equals(w){return this.notebookType===w.notebookType&&this.languageId===w.languageId&&this.uri.toString()===w.uri.toString()&&this.notebookUri?.toString()===w.notebookUri?.toString()&&this.recursive===w.recursive}}class LanguageFeatureRegistry{constructor(w){this._notebookInfoResolver=w,this._clock=0,this._entries=[],this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event}register(w,D){let O={selector:w,provider:D,_score:-1,_time:this._clock++};return this._entries.push(O),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),toDisposable(()=>{if(O){const W=this._entries.indexOf(O);W>=0&&(this._entries.splice(W,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),O=void 0)}})}has(w){return this.all(w).length>0}all(w){if(!w)return[];this._updateScores(w,!1);const D=[];for(const O of this._entries)O._score>0&&D.push(O.provider);return D}ordered(w,D=!1){const O=[];return this._orderedForEach(w,D,W=>O.push(W.provider)),O}orderedGroups(w){const D=[];let O,W;return this._orderedForEach(w,!1,U=>{O&&W===U._score?O.push(U.provider):(W=U._score,O=[U.provider],D.push(O))}),D}_orderedForEach(w,D,O){this._updateScores(w,D);for(const W of this._entries)W._score>0&&O(W)}_updateScores(w,D){const O=this._notebookInfoResolver?.(w.uri),W=O?new MatchCandidate(w.uri,w.getLanguageId(),O.uri,O.type,D):new MatchCandidate(w.uri,w.getLanguageId(),void 0,void 0,D);if(!this._lastCandidate?.equals(W)){this._lastCandidate=W;for(const U of this._entries)if(U._score=score(U.selector,W.uri,W.languageId,shouldSynchronizeModel(w),W.notebookUri,W.notebookType),isExclusive(U.selector)&&U._score>0)if(D)U._score=0;else{for(const K of this._entries)K._score=0;U._score=1e3;break}this._entries.sort(LanguageFeatureRegistry._compareByScoreAndTime)}}static _compareByScoreAndTime(w,D){return w._score<D._score?1:w._score>D._score?-1:isBuiltinSelector(w.selector)&&!isBuiltinSelector(D.selector)?1:!isBuiltinSelector(w.selector)&&isBuiltinSelector(D.selector)?-1:w._time<D._time?1:w._time>D._time?-1:0}}function isBuiltinSelector(F){return typeof F=="string"?!1:Array.isArray(F)?F.some(isBuiltinSelector):!!F.isBuiltin}class LanguageFeaturesService{constructor(){this.referenceProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.renameProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.newSymbolNamesProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.codeActionProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.definitionProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.typeDefinitionProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.declarationProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.implementationProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentSymbolProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.inlayHintsProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.colorProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.codeLensProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentFormattingEditProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentRangeFormattingEditProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.onTypeFormattingEditProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.signatureHelpProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.hoverProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentHighlightProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.multiDocumentHighlightProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.selectionRangeProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.foldingRangeProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.linkProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.inlineCompletionsProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.inlineEditProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.completionProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.linkedEditingRangeProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentSemanticTokensProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentDropEditProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentPasteEditProvider=new LanguageFeatureRegistry(this._score.bind(this))}_score(w){return this._notebookTypeResolver?.(w)}}registerSingleton(ILanguageFeaturesService,LanguageFeaturesService,1);var __decorate$B=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$z=function(F,w){return function(D,O){w(D,O,F)}};const IHoverService=createDecorator("hoverService");let WorkbenchHoverDelegate=class extends Disposable{get delay(){return this.isInstantlyHovering()?0:this._delay}constructor(w,D,O={},W,U){super(),this.placement=w,this.instantHover=D,this.overrideOptions=O,this.configurationService=W,this.hoverService=U,this.lastHoverHideTime=0,this.timeLimit=200,this.hoverDisposables=this._register(new DisposableStore),this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(K=>{K.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}showHover(w,D){const O=typeof this.overrideOptions=="function"?this.overrideOptions(w,D):this.overrideOptions;this.hoverDisposables.clear();const W=isHTMLElement(w.target)?[w.target]:w.target.targetElements;for(const K of W)this.hoverDisposables.add(addStandardDisposableListener(K,"keydown",q=>{q.equals(9)&&this.hoverService.hideHover()}));const U=isHTMLElement(w.content)?void 0:w.content.toString();return this.hoverService.showHover({...w,...O,persistence:{hideOnKeyDown:!0,...O.persistence},id:U,appearance:{...w.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...O.appearance}},D)}isInstantlyHovering(){return this.instantHover&&Date.now()-this.lastHoverHideTime<this.timeLimit}onDidHideHover(){this.hoverDisposables.clear(),this.instantHover&&(this.lastHoverHideTime=Date.now())}};WorkbenchHoverDelegate=__decorate$B([__param$z(3,IConfigurationService),__param$z(4,IHoverService)],WorkbenchHoverDelegate);const $$5=$$8;let HoverWidget$1=class extends Disposable{constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new DomScrollableElement(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}};class HoverAction extends Disposable{static render(w,D,O){return new HoverAction(w,D,O)}constructor(w,D,O){super(),this.actionLabel=D.label,this.actionKeybindingLabel=O,this.actionContainer=append$1(w,$$5("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=append$1(this.actionContainer,$$5("a.action")),this.action.setAttribute("role","button"),D.iconClass&&append$1(this.action,$$5(`span.icon.${D.iconClass}`));const W=append$1(this.action,$$5("span"));W.textContent=O?`${D.label} (${O})`:D.label,this._store.add(new ClickAction(this.actionContainer,D.run)),this._store.add(new KeyDownAction(this.actionContainer,D.run,[3,10])),this.setEnabled(!0)}setEnabled(w){w?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}function getHoverAccessibleViewHint(F,w){return F&&w?localize("acessibleViewHint","Inspect this in the accessible view with {0}.",w):F?localize("acessibleViewHintNoKbOpen","Inspect this in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding."):""}class ClickAction extends Disposable{constructor(w,D){super(),this._register(addDisposableListener(w,EventType$1.CLICK,O=>{O.stopPropagation(),O.preventDefault(),D(w)}))}}class KeyDownAction extends Disposable{constructor(w,D,O){super(),this._register(addDisposableListener(w,EventType$1.KEY_DOWN,W=>{const U=new StandardKeyboardEvent(W);O.some(K=>U.equals(K))&&(W.stopPropagation(),W.preventDefault(),D(w))}))}}var __decorate$A=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$y=function(F,w){return function(D,O){w(D,O,F)}};const $$4=$$8;let HoverWidget=class extends Widget$1{get _targetWindow(){return getWindow(this._target.targetElements[0])}get _targetDocumentElement(){return getWindow(this._target.targetElements[0]).document.documentElement}get isDisposed(){return this._isDisposed}get isMouseIn(){return this._lockMouseTracker.isMouseIn}get domNode(){return this._hover.containerDomNode}get onDispose(){return this._onDispose.event}get onRequestLayout(){return this._onRequestLayout.event}get anchor(){return this._hoverPosition===2?0:1}get x(){return this._x}get y(){return this._y}get isLocked(){return this._isLocked}set isLocked(w){this._isLocked!==w&&(this._isLocked=w,this._hoverContainer.classList.toggle("locked",this._isLocked))}constructor(w,D,O,W,U,K){super(),this._keybindingService=D,this._configurationService=O,this._openerService=W,this._instantiationService=U,this._accessibilityService=K,this._messageListeners=new DisposableStore,this._isDisposed=!1,this._forcePosition=!1,this._x=0,this._y=0,this._isLocked=!1,this._enableFocusTraps=!1,this._addedFocusTrap=!1,this._onDispose=this._register(new Emitter$1),this._onRequestLayout=this._register(new Emitter$1),this._linkHandler=w.linkHandler||(J=>openLinkFromMarkdown(this._openerService,J,isMarkdownString(w.content)?w.content.isTrusted:void 0)),this._target="targetElements"in w.target?w.target:new ElementHoverTarget(w.target),this._hoverPointer=w.appearance?.showPointer?$$4("div.workbench-hover-pointer"):void 0,this._hover=this._register(new HoverWidget$1),this._hover.containerDomNode.classList.add("workbench-hover","fadeIn"),w.appearance?.compact&&this._hover.containerDomNode.classList.add("workbench-hover","compact"),w.appearance?.skipFadeInAnimation&&this._hover.containerDomNode.classList.add("skip-fade-in"),w.additionalClasses&&this._hover.containerDomNode.classList.add(...w.additionalClasses),w.position?.forcePosition&&(this._forcePosition=!0),w.trapFocus&&(this._enableFocusTraps=!0),this._hoverPosition=w.position?.hoverPosition??3,this.onmousedown(this._hover.containerDomNode,J=>J.stopPropagation()),this.onkeydown(this._hover.containerDomNode,J=>{J.equals(9)&&this.dispose()}),this._register(addDisposableListener(this._targetWindow,"blur",()=>this.dispose()));const q=$$4("div.hover-row.markdown-hover"),G=$$4("div.hover-contents");if(typeof w.content=="string")G.textContent=w.content,G.style.whiteSpace="pre-wrap";else if(isHTMLElement(w.content))G.appendChild(w.content),G.classList.add("html-hover-contents");else{const J=w.content,te=this._instantiationService.createInstance(MarkdownRenderer,{codeBlockFontFamily:this._configurationService.getValue("editor").fontFamily||EDITOR_FONT_DEFAULTS.fontFamily}),{element:ie}=te.render(J,{actionHandler:{callback:se=>this._linkHandler(se),disposables:this._messageListeners},asyncRenderCallback:()=>{G.classList.add("code-hover-contents"),this.layout(),this._onRequestLayout.fire()}});G.appendChild(ie)}if(q.appendChild(G),this._hover.contentsDomNode.appendChild(q),w.actions&&w.actions.length>0){const J=$$4("div.hover-row.status-bar"),te=$$4("div.actions");w.actions.forEach(ie=>{const se=this._keybindingService.lookupKeybinding(ie.commandId),re=se?se.getLabel():null;HoverAction.render(te,{label:ie.label,commandId:ie.commandId,run:ae=>{ie.run(ae),this.dispose()},iconClass:ie.iconClass},re)}),J.appendChild(te),this._hover.containerDomNode.appendChild(J)}this._hoverContainer=$$4("div.workbench-hover-container"),this._hoverPointer&&this._hoverContainer.appendChild(this._hoverPointer),this._hoverContainer.appendChild(this._hover.containerDomNode);let Q;if(w.actions&&w.actions.length>0?Q=!1:w.persistence?.hideOnHover===void 0?Q=typeof w.content=="string"||isMarkdownString(w.content)&&!w.content.value.includes("](")&&!w.content.value.includes("</a>"):Q=w.persistence.hideOnHover,w.appearance?.showHoverHint){const J=$$4("div.hover-row.status-bar"),te=$$4("div.info");te.textContent=localize("hoverhint","Hold {0} key to mouse over",isMacintosh?"Option":"Alt"),J.appendChild(te),this._hover.containerDomNode.appendChild(J)}const Y=[...this._target.targetElements];Q||Y.push(this._hoverContainer);const X=this._register(new CompositeMouseTracker(Y));if(this._register(X.onMouseOut(()=>{this._isLocked||this.dispose()})),Q){const J=[...this._target.targetElements,this._hoverContainer];this._lockMouseTracker=this._register(new CompositeMouseTracker(J)),this._register(this._lockMouseTracker.onMouseOut(()=>{this._isLocked||this.dispose()}))}else this._lockMouseTracker=X}addFocusTrap(){if(!this._enableFocusTraps||this._addedFocusTrap)return;this._addedFocusTrap=!0;const w=this._hover.containerDomNode,D=this.findLastFocusableChild(this._hover.containerDomNode);if(D){const O=prepend$1(this._hoverContainer,$$4("div")),W=append$1(this._hoverContainer,$$4("div"));O.tabIndex=0,W.tabIndex=0,this._register(addDisposableListener(W,"focus",U=>{w.focus(),U.preventDefault()})),this._register(addDisposableListener(O,"focus",U=>{D.focus(),U.preventDefault()}))}}findLastFocusableChild(w){if(w.hasChildNodes())for(let D=0;D<w.childNodes.length;D++){const O=w.childNodes.item(w.childNodes.length-D-1);if(O.nodeType===O.ELEMENT_NODE){const U=O;if(typeof U.tabIndex=="number"&&U.tabIndex>=0)return U}const W=this.findLastFocusableChild(O);if(W)return W}}render(w){w.appendChild(this._hoverContainer);const O=this._hoverContainer.contains(this._hoverContainer.ownerDocument.activeElement)&&getHoverAccessibleViewHint(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),this._keybindingService.lookupKeybinding("editor.action.accessibleView")?.getAriaLabel());O&&status(O),this.layout(),this.addFocusTrap()}layout(){this._hover.containerDomNode.classList.remove("right-aligned"),this._hover.contentsDomNode.style.maxHeight="";const w=Y=>{const X=getDomNodeZoomLevel(Y),J=Y.getBoundingClientRect();return{top:J.top*X,bottom:J.bottom*X,right:J.right*X,left:J.left*X}},D=this._target.targetElements.map(Y=>w(Y)),{top:O,right:W,bottom:U,left:K}=D[0],q=W-K,G=U-O,Q={top:O,right:W,bottom:U,left:K,width:q,height:G,center:{x:K+q/2,y:O+G/2}};if(this.adjustHorizontalHoverPosition(Q),this.adjustVerticalHoverPosition(Q),this.adjustHoverMaxHeight(Q),this._hoverContainer.style.padding="",this._hoverContainer.style.margin="",this._hoverPointer){switch(this._hoverPosition){case 1:Q.left+=3,Q.right+=3,this._hoverContainer.style.paddingLeft="3px",this._hoverContainer.style.marginLeft="-3px";break;case 0:Q.left-=3,Q.right-=3,this._hoverContainer.style.paddingRight="3px",this._hoverContainer.style.marginRight="-3px";break;case 2:Q.top+=3,Q.bottom+=3,this._hoverContainer.style.paddingTop="3px",this._hoverContainer.style.marginTop="-3px";break;case 3:Q.top-=3,Q.bottom-=3,this._hoverContainer.style.paddingBottom="3px",this._hoverContainer.style.marginBottom="-3px";break}Q.center.x=Q.left+q/2,Q.center.y=Q.top+G/2}this.computeXCordinate(Q),this.computeYCordinate(Q),this._hoverPointer&&(this._hoverPointer.classList.remove("top"),this._hoverPointer.classList.remove("left"),this._hoverPointer.classList.remove("right"),this._hoverPointer.classList.remove("bottom"),this.setHoverPointerPosition(Q)),this._hover.onContentsChanged()}computeXCordinate(w){const D=this._hover.containerDomNode.clientWidth+2;this._target.x!==void 0?this._x=this._target.x:this._hoverPosition===1?this._x=w.right:this._hoverPosition===0?this._x=w.left-D:(this._hoverPointer?this._x=w.center.x-this._hover.containerDomNode.clientWidth/2:this._x=w.left,this._x+D>=this._targetDocumentElement.clientWidth&&(this._hover.containerDomNode.classList.add("right-aligned"),this._x=Math.max(this._targetDocumentElement.clientWidth-D-2,this._targetDocumentElement.clientLeft))),this._x<this._targetDocumentElement.clientLeft&&(this._x=w.left+2)}computeYCordinate(w){this._target.y!==void 0?this._y=this._target.y:this._hoverPosition===3?this._y=w.top:this._hoverPosition===2?this._y=w.bottom-2:this._hoverPointer?this._y=w.center.y+this._hover.containerDomNode.clientHeight/2:this._y=w.bottom,this._y>this._targetWindow.innerHeight&&(this._y=w.bottom)}adjustHorizontalHoverPosition(w){if(this._target.x!==void 0)return;const D=this._hoverPointer?3:0;if(this._forcePosition){const O=D+2;this._hoverPosition===1?this._hover.containerDomNode.style.maxWidth=`${this._targetDocumentElement.clientWidth-w.right-O}px`:this._hoverPosition===0&&(this._hover.containerDomNode.style.maxWidth=`${w.left-O}px`);return}this._hoverPosition===1?this._targetDocumentElement.clientWidth-w.right<this._hover.containerDomNode.clientWidth+D&&(w.left>=this._hover.containerDomNode.clientWidth+D?this._hoverPosition=0:this._hoverPosition=2):this._hoverPosition===0&&(w.left<this._hover.containerDomNode.clientWidth+D&&(this._targetDocumentElement.clientWidth-w.right>=this._hover.containerDomNode.clientWidth+D?this._hoverPosition=1:this._hoverPosition=2),w.left-this._hover.containerDomNode.clientWidth-D<=this._targetDocumentElement.clientLeft&&(this._hoverPosition=1))}adjustVerticalHoverPosition(w){if(this._target.y!==void 0||this._forcePosition)return;const D=this._hoverPointer?3:0;this._hoverPosition===3?w.top-this._hover.containerDomNode.clientHeight-D<0&&(this._hoverPosition=2):this._hoverPosition===2&&w.bottom+this._hover.containerDomNode.clientHeight+D>this._targetWindow.innerHeight&&(this._hoverPosition=3)}adjustHoverMaxHeight(w){let D=this._targetWindow.innerHeight/2;if(this._forcePosition){const O=(this._hoverPointer?3:0)+2;this._hoverPosition===3?D=Math.min(D,w.top-O):this._hoverPosition===2&&(D=Math.min(D,this._targetWindow.innerHeight-w.bottom-O))}if(this._hover.containerDomNode.style.maxHeight=`${D}px`,this._hover.contentsDomNode.clientHeight<this._hover.contentsDomNode.scrollHeight){const O=`${this._hover.scrollbar.options.verticalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingRight!==O&&(this._hover.contentsDomNode.style.paddingRight=O)}}setHoverPointerPosition(w){if(this._hoverPointer)switch(this._hoverPosition){case 0:case 1:{this._hoverPointer.classList.add(this._hoverPosition===0?"right":"left");const D=this._hover.containerDomNode.clientHeight;D>w.height?this._hoverPointer.style.top=`${w.center.y-(this._y-D)-3}px`:this._hoverPointer.style.top=`${Math.round(D/2)-3}px`;break}case 3:case 2:{this._hoverPointer.classList.add(this._hoverPosition===3?"bottom":"top");const D=this._hover.containerDomNode.clientWidth;let O=Math.round(D/2)-3;const W=this._x+O;(W<w.left||W>w.right)&&(O=w.center.x-this._x-3),this._hoverPointer.style.left=`${O}px`;break}}}focus(){this._hover.containerDomNode.focus()}dispose(){this._isDisposed||(this._onDispose.fire(),this._hoverContainer.remove(),this._messageListeners.dispose(),this._target.dispose(),super.dispose()),this._isDisposed=!0}};HoverWidget=__decorate$A([__param$y(1,IKeybindingService),__param$y(2,IConfigurationService),__param$y(3,IOpenerService),__param$y(4,IInstantiationService),__param$y(5,IAccessibilityService)],HoverWidget);class CompositeMouseTracker extends Widget$1{get onMouseOut(){return this._onMouseOut.event}get isMouseIn(){return this._isMouseIn}constructor(w){super(),this._elements=w,this._isMouseIn=!0,this._onMouseOut=this._register(new Emitter$1),this._elements.forEach(D=>this.onmouseover(D,()=>this._onTargetMouseOver(D))),this._elements.forEach(D=>this.onmouseleave(D,()=>this._onTargetMouseLeave(D)))}_onTargetMouseOver(w){this._isMouseIn=!0,this._clearEvaluateMouseStateTimeout(w)}_onTargetMouseLeave(w){this._isMouseIn=!1,this._evaluateMouseState(w)}_evaluateMouseState(w){this._clearEvaluateMouseStateTimeout(w),this._mouseTimeout=getWindow(w).setTimeout(()=>this._fireIfMouseOutside(),0)}_clearEvaluateMouseStateTimeout(w){this._mouseTimeout&&(getWindow(w).clearTimeout(this._mouseTimeout),this._mouseTimeout=void 0)}_fireIfMouseOutside(){this._isMouseIn||this._onMouseOut.fire()}}class ElementHoverTarget{constructor(w){this._element=w,this.targetElements=[this._element]}dispose(){}}function isAnchor(F){const w=F;return!!w&&typeof w.x=="number"&&typeof w.y=="number"}var LayoutAnchorMode;(function(F){F[F.AVOID=0]="AVOID",F[F.ALIGN=1]="ALIGN"})(LayoutAnchorMode||(LayoutAnchorMode={}));function layout(F,w,D){const O=D.mode===LayoutAnchorMode.ALIGN?D.offset:D.offset+D.size,W=D.mode===LayoutAnchorMode.ALIGN?D.offset+D.size:D.offset;return D.position===0?w<=F-O?O:w<=W?W-w:Math.max(F-w,0):w<=W?W-w:w<=F-O?O:0}class ContextView extends Disposable{static{this.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"]}static{this.BUBBLE_DOWN_EVENTS=["click"]}constructor(w,D){super(),this.container=null,this.useFixedPosition=!1,this.useShadowDOM=!1,this.delegate=null,this.toDisposeOnClean=Disposable.None,this.toDisposeOnSetContainer=Disposable.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=$$8(".context-view"),hide(this.view),this.setContainer(w,D),this._register(toDisposable(()=>this.setContainer(null,1)))}setContainer(w,D){this.useFixedPosition=D!==1;const O=this.useShadowDOM;if(this.useShadowDOM=D===3,!(w===this.container&&O===this.useShadowDOM)&&(this.container&&(this.toDisposeOnSetContainer.dispose(),this.view.remove(),this.shadowRoot&&(this.shadowRoot=null,this.shadowRootHostElement?.remove(),this.shadowRootHostElement=null),this.container=null),w)){if(this.container=w,this.useShadowDOM){this.shadowRootHostElement=$$8(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const U=document.createElement("style");U.textContent=SHADOW_ROOT_CSS,this.shadowRoot.appendChild(U),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild($$8("slot"))}else this.container.appendChild(this.view);const W=new DisposableStore;ContextView.BUBBLE_UP_EVENTS.forEach(U=>{W.add(addStandardDisposableListener(this.container,U,K=>{this.onDOMEvent(K,!1)}))}),ContextView.BUBBLE_DOWN_EVENTS.forEach(U=>{W.add(addStandardDisposableListener(this.container,U,K=>{this.onDOMEvent(K,!0)},!0))}),this.toDisposeOnSetContainer=W}}show(w){this.isVisible()&&this.hide(),clearNode(this.view),this.view.className="context-view monaco-component",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex=`${2575+(w.layer??0)}`,this.view.style.position=this.useFixedPosition?"fixed":"absolute",show(this.view),this.toDisposeOnClean=w.render(this.view)||Disposable.None,this.delegate=w,this.doLayout(),this.delegate.focus?.()}getViewElement(){return this.view}layout(){if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(isIOS&&BrowserFeatures.pointerEvents)){this.hide();return}this.delegate?.layout?.(),this.doLayout()}}doLayout(){if(!this.isVisible())return;const w=this.delegate.getAnchor();let D;if(isHTMLElement(w)){const J=getDomNodePagePosition(w),te=getDomNodeZoomLevel(w);D={top:J.top*te,left:J.left*te,width:J.width*te,height:J.height*te}}else isAnchor(w)?D={top:w.y,left:w.x,width:w.width||1,height:w.height||2}:D={top:w.posy,left:w.posx,width:2,height:2};const O=getTotalWidth(this.view),W=getTotalHeight(this.view),U=this.delegate.anchorPosition||0,K=this.delegate.anchorAlignment||0,q=this.delegate.anchorAxisAlignment||0;let G,Q;const Y=getActiveWindow();if(q===0){const J={offset:D.top-Y.pageYOffset,size:D.height,position:U===0?0:1},te={offset:D.left,size:D.width,position:K===0?0:1,mode:LayoutAnchorMode.ALIGN};G=layout(Y.innerHeight,W,J)+Y.pageYOffset,Range$1.intersects({start:G,end:G+W},{start:J.offset,end:J.offset+J.size})&&(te.mode=LayoutAnchorMode.AVOID),Q=layout(Y.innerWidth,O,te)}else{const J={offset:D.left,size:D.width,position:K===0?0:1},te={offset:D.top,size:D.height,position:U===0?0:1,mode:LayoutAnchorMode.ALIGN};Q=layout(Y.innerWidth,O,J),Range$1.intersects({start:Q,end:Q+O},{start:J.offset,end:J.offset+J.size})&&(te.mode=LayoutAnchorMode.AVOID),G=layout(Y.innerHeight,W,te)+Y.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(U===0?"bottom":"top"),this.view.classList.add(K===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const X=getDomNodePagePosition(this.container);this.view.style.top=`${G-(this.useFixedPosition?getDomNodePagePosition(this.view).top:X.top)}px`,this.view.style.left=`${Q-(this.useFixedPosition?getDomNodePagePosition(this.view).left:X.left)}px`,this.view.style.width="initial"}hide(w){const D=this.delegate;this.delegate=null,D?.onHide&&D.onHide(w),this.toDisposeOnClean.dispose(),hide(this.view)}isVisible(){return!!this.delegate}onDOMEvent(w,D){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(w,getWindow(w).document.activeElement):D&&!isAncestor$1(w.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}}const SHADOW_ROOT_CSS=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;var __decorate$z=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$x=function(F,w){return function(D,O){w(D,O,F)}};let ContextViewHandler=class extends Disposable{constructor(w){super(),this.layoutService=w,this.contextView=this._register(new ContextView(this.layoutService.mainContainer,1)),this.layout(),this._register(w.onDidLayoutContainer(()=>this.layout()))}showContextView(w,D,O){let W;D?D===this.layoutService.getContainer(getWindow(D))?W=1:O?W=3:W=2:W=1,this.contextView.setContainer(D??this.layoutService.activeContainer,W),this.contextView.show(w);const U={close:()=>{this.openContextView===U&&this.hideContextView()}};return this.openContextView=U,U}layout(){this.contextView.layout()}hideContextView(w){this.contextView.hide(w),this.openContextView=void 0}};ContextViewHandler=__decorate$z([__param$x(0,ILayoutService)],ContextViewHandler);class ContextViewService extends ContextViewHandler{getContextViewElement(){return this.contextView.getViewElement()}}class ManagedHoverWidget{constructor(w,D,O){this.hoverDelegate=w,this.target=D,this.fadeInAnimation=O}async update(w,D,O){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let W;if(w===void 0||isString$1(w)||isHTMLElement(w))W=w;else if(!isFunction(w.markdown))W=w.markdown??w.markdownNotSupportedFallback;else{this._hoverWidget||this.show(localize("iconLabel.loading","Loading..."),D,O),this._cancellationTokenSource=new CancellationTokenSource$1;const U=this._cancellationTokenSource.token;if(W=await w.markdown(U),W===void 0&&(W=w.markdownNotSupportedFallback),this.isDisposed||U.isCancellationRequested)return}this.show(W,D,O)}show(w,D,O){const W=this._hoverWidget;if(this.hasContent(w)){const U={content:w,target:this.target,actions:O?.actions,linkHandler:O?.linkHandler,trapFocus:O?.trapFocus,appearance:{showPointer:this.hoverDelegate.placement==="element",skipFadeInAnimation:!this.fadeInAnimation||!!W,showHoverHint:O?.appearance?.showHoverHint},position:{hoverPosition:2}};this._hoverWidget=this.hoverDelegate.showHover(U,D)}W?.dispose()}hasContent(w){return w?isMarkdownString(w)?!!w.value:!0:!1}get isDisposed(){return this._hoverWidget?.isDisposed}dispose(){this._hoverWidget?.dispose(),this._cancellationTokenSource?.dispose(!0),this._cancellationTokenSource=void 0}}var __decorate$y=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$w=function(F,w){return function(D,O){w(D,O,F)}};let HoverService=class extends Disposable{constructor(w,D,O,W,U){super(),this._instantiationService=w,this._keybindingService=O,this._layoutService=W,this._accessibilityService=U,this._managedHovers=new Map,D.onDidShowContextMenu(()=>this.hideHover()),this._contextViewHandler=this._register(new ContextViewHandler(this._layoutService))}showHover(w,D,O){if(getHoverOptionsIdentity(this._currentHoverOptions)===getHoverOptionsIdentity(w)||this._currentHover&&this._currentHoverOptions?.persistence?.sticky)return;this._currentHoverOptions=w,this._lastHoverOptions=w;const W=w.trapFocus||this._accessibilityService.isScreenReaderOptimized(),U=getActiveElement();O||(W&&U?U.classList.contains("monaco-hover")||(this._lastFocusedElementBeforeOpen=U):this._lastFocusedElementBeforeOpen=void 0);const K=new DisposableStore,q=this._instantiationService.createInstance(HoverWidget,w);if(w.persistence?.sticky&&(q.isLocked=!0),q.onDispose(()=>{this._currentHover?.domNode&&isAncestorOfActiveElement(this._currentHover.domNode)&&this._lastFocusedElementBeforeOpen?.focus(),this._currentHoverOptions===w&&(this._currentHoverOptions=void 0),K.dispose()},void 0,K),!w.container){const G=isHTMLElement(w.target)?w.target:w.target.targetElements[0];w.container=this._layoutService.getContainer(getWindow(G))}if(this._contextViewHandler.showContextView(new HoverContextViewDelegate(q,D),w.container),q.onRequestLayout(()=>this._contextViewHandler.layout(),void 0,K),w.persistence?.sticky)K.add(addDisposableListener(getWindow(w.container).document,EventType$1.MOUSE_DOWN,G=>{isAncestor$1(G.target,q.domNode)||this.doHideHover()}));else{if("targetElements"in w.target)for(const Q of w.target.targetElements)K.add(addDisposableListener(Q,EventType$1.CLICK,()=>this.hideHover()));else K.add(addDisposableListener(w.target,EventType$1.CLICK,()=>this.hideHover()));const G=getActiveElement();if(G){const Q=getWindow(G).document;K.add(addDisposableListener(G,EventType$1.KEY_DOWN,Y=>this._keyDown(Y,q,!!w.persistence?.hideOnKeyDown))),K.add(addDisposableListener(Q,EventType$1.KEY_DOWN,Y=>this._keyDown(Y,q,!!w.persistence?.hideOnKeyDown))),K.add(addDisposableListener(G,EventType$1.KEY_UP,Y=>this._keyUp(Y,q))),K.add(addDisposableListener(Q,EventType$1.KEY_UP,Y=>this._keyUp(Y,q)))}}if("IntersectionObserver"in mainWindow){const G=new IntersectionObserver(Y=>this._intersectionChange(Y,q),{threshold:0}),Q="targetElements"in w.target?w.target.targetElements[0]:w.target;G.observe(Q),K.add(toDisposable(()=>G.disconnect()))}return this._currentHover=q,q}hideHover(){this._currentHover?.isLocked||!this._currentHoverOptions||this.doHideHover()}doHideHover(){this._currentHover=void 0,this._currentHoverOptions=void 0,this._contextViewHandler.hideContextView()}_intersectionChange(w,D){w[w.length-1].isIntersecting||D.dispose()}showAndFocusLastHover(){this._lastHoverOptions&&this.showHover(this._lastHoverOptions,!0,!0)}_keyDown(w,D,O){if(w.key==="Alt"){D.isLocked=!0;return}const W=new StandardKeyboardEvent(w);this._keybindingService.resolveKeyboardEvent(W).getSingleModifierDispatchChords().some(K=>!!K)||this._keybindingService.softDispatch(W,W.target).kind!==0||O&&(!this._currentHoverOptions?.trapFocus||w.key!=="Tab")&&(this.hideHover(),this._lastFocusedElementBeforeOpen?.focus())}_keyUp(w,D){w.key==="Alt"&&(D.isLocked=!1,D.isMouseIn||(this.hideHover(),this._lastFocusedElementBeforeOpen?.focus()))}setupManagedHover(w,D,O,W){D.setAttribute("custom-hover","true"),D.title!==""&&(console.warn("HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute."),console.trace("Stack trace:",D.title),D.title="");let U,K;const q=(de,oe)=>{const ue=K!==void 0;de&&(K?.dispose(),K=void 0),oe&&(U?.dispose(),U=void 0),ue&&(w.onDidHideHover?.(),K=void 0)},G=(de,oe,ue,pe)=>new TimeoutTimer(async()=>{(!K||K.isDisposed)&&(K=new ManagedHoverWidget(w,ue||D,de>0),await K.update(typeof O=="function"?O():O,oe,{...W,trapFocus:pe}))},de);let Q=!1;const Y=addDisposableListener(D,EventType$1.MOUSE_DOWN,()=>{Q=!0,q(!0,!0)},!0),X=addDisposableListener(D,EventType$1.MOUSE_UP,()=>{Q=!1},!0),J=addDisposableListener(D,EventType$1.MOUSE_LEAVE,de=>{Q=!1,q(!1,de.fromElement===D)},!0),te=de=>{if(U)return;const oe=new DisposableStore,ue={targetElements:[D],dispose:()=>{}};if(w.placement===void 0||w.placement==="mouse"){const pe=fe=>{ue.x=fe.x+10,isHTMLElement(fe.target)&&getHoverTargetElement(fe.target,D)!==D&&q(!0,!0)};oe.add(addDisposableListener(D,EventType$1.MOUSE_MOVE,pe,!0))}U=oe,!(isHTMLElement(de.target)&&getHoverTargetElement(de.target,D)!==D)&&oe.add(G(w.delay,!1,ue))},ie=addDisposableListener(D,EventType$1.MOUSE_OVER,te,!0),se=()=>{if(Q||U)return;const de={targetElements:[D],dispose:()=>{}},oe=new DisposableStore,ue=()=>q(!0,!0);oe.add(addDisposableListener(D,EventType$1.BLUR,ue,!0)),oe.add(G(w.delay,!1,de)),U=oe};let re;const ae=D.tagName.toLowerCase();ae!=="input"&&ae!=="textarea"&&(re=addDisposableListener(D,EventType$1.FOCUS,se,!0));const le={show:de=>{q(!1,!0),G(0,de,void 0,de)},hide:()=>{q(!0,!0)},update:async(de,oe)=>{O=de,await K?.update(O,void 0,oe)},dispose:()=>{this._managedHovers.delete(D),ie.dispose(),J.dispose(),Y.dispose(),X.dispose(),re?.dispose(),q(!0,!0)}};return this._managedHovers.set(D,le),le}showManagedHover(w){const D=this._managedHovers.get(w);D&&D.show(!0)}dispose(){this._managedHovers.forEach(w=>w.dispose()),super.dispose()}};HoverService=__decorate$y([__param$w(0,IInstantiationService),__param$w(1,IContextMenuService),__param$w(2,IKeybindingService),__param$w(3,ILayoutService),__param$w(4,IAccessibilityService)],HoverService);function getHoverOptionsIdentity(F){if(F!==void 0)return F?.id??F}class HoverContextViewDelegate{get anchorPosition(){return this._hover.anchor}constructor(w,D=!1){this._hover=w,this._focus=D,this.layer=1}render(w){return this._hover.render(w),this._focus&&this._hover.focus(),this._hover}getAnchor(){return{x:this._hover.x,y:this._hover.y}}layout(){this._hover.layout()}}function getHoverTargetElement(F,w){for(w=w??getWindow(F).document.body;!F.hasAttribute("custom-hover")&&F!==w;)F=F.parentElement;return F}registerSingleton(IHoverService,HoverService,1);registerThemingParticipant((F,w)=>{const D=F.getColor(editorHoverBorder);D&&(w.addRule(`.monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${D.transparent(.5)}; }`),w.addRule(`.monaco-workbench .workbench-hover hr { border-top: 1px solid ${D.transparent(.5)}; }`))});const IBulkEditService=createDecorator("IWorkspaceEditService");class ResourceEdit{constructor(w){this.metadata=w}static convert(w){return w.edits.map(D=>{if(ResourceTextEdit.is(D))return ResourceTextEdit.lift(D);if(ResourceFileEdit.is(D))return ResourceFileEdit.lift(D);throw new Error("Unsupported edit")})}}class ResourceTextEdit extends ResourceEdit{static is(w){return w instanceof ResourceTextEdit?!0:isObject$1(w)&&URI.isUri(w.resource)&&isObject$1(w.textEdit)}static lift(w){return w instanceof ResourceTextEdit?w:new ResourceTextEdit(w.resource,w.textEdit,w.versionId,w.metadata)}constructor(w,D,O=void 0,W){super(W),this.resource=w,this.textEdit=D,this.versionId=O}}class ResourceFileEdit extends ResourceEdit{static is(w){return w instanceof ResourceFileEdit?!0:isObject$1(w)&&(!!w.newResource||!!w.oldResource)}static lift(w){return w instanceof ResourceFileEdit?w:new ResourceFileEdit(w.oldResource,w.newResource,w.options,w.metadata)}constructor(w,D,O={},W){super(W),this.oldResource=w,this.newResource=D,this.options=O}}const diffEditorDefaultOptions={enableSplitViewResizing:!0,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1},editorConfigurationBaseNode=Object.freeze({id:"editor",order:5,type:"object",title:localize("editorConfigurationTitle","Editor"),scope:5}),editorConfiguration={...editorConfigurationBaseNode,properties:{"editor.tabSize":{type:"number",default:EDITOR_MODEL_DEFAULTS.tabSize,minimum:1,markdownDescription:localize("tabSize","The number of spaces a tab is equal to. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.indentSize":{anyOf:[{type:"string",enum:["tabSize"]},{type:"number",minimum:1}],default:"tabSize",markdownDescription:localize("indentSize",'The number of spaces used for indentation or `"tabSize"` to use the value from `#editor.tabSize#`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.')},"editor.insertSpaces":{type:"boolean",default:EDITOR_MODEL_DEFAULTS.insertSpaces,markdownDescription:localize("insertSpaces","Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.detectIndentation":{type:"boolean",default:EDITOR_MODEL_DEFAULTS.detectIndentation,markdownDescription:localize("detectIndentation","Controls whether {0} and {1} will be automatically detected when a file is opened based on the file contents.","`#editor.tabSize#`","`#editor.insertSpaces#`")},"editor.trimAutoWhitespace":{type:"boolean",default:EDITOR_MODEL_DEFAULTS.trimAutoWhitespace,description:localize("trimAutoWhitespace","Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:EDITOR_MODEL_DEFAULTS.largeFileOptimizations,description:localize("largeFileOptimizations","Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{enum:["off","currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[localize("wordBasedSuggestions.off","Turn off Word Based Suggestions."),localize("wordBasedSuggestions.currentDocument","Only suggest words from the active document."),localize("wordBasedSuggestions.matchingDocuments","Suggest words from all open documents of the same language."),localize("wordBasedSuggestions.allDocuments","Suggest words from all open documents.")],description:localize("wordBasedSuggestions","Controls whether completions should be computed based on words in the document and from which documents they are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[localize("semanticHighlighting.true","Semantic highlighting enabled for all color themes."),localize("semanticHighlighting.false","Semantic highlighting disabled for all color themes."),localize("semanticHighlighting.configuredByTheme","Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:localize("semanticHighlighting.enabled","Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:localize("stablePeek","Keep peek editors open even when double-clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:localize("maxTokenizationLineLength","Lines above this length will not be tokenized for performance reasons")},"editor.experimental.asyncTokenization":{type:"boolean",default:!0,description:localize("editor.experimental.asyncTokenization","Controls whether the tokenization should happen asynchronously on a web worker."),tags:["experimental"]},"editor.experimental.asyncTokenizationLogging":{type:"boolean",default:!1,description:localize("editor.experimental.asyncTokenizationLogging","Controls whether async tokenization should be logged. For debugging only.")},"editor.experimental.asyncTokenizationVerification":{type:"boolean",default:!1,description:localize("editor.experimental.asyncTokenizationVerification","Controls whether async tokenization should be verified against legacy background tokenization. Might slow down tokenization. For debugging only."),tags:["experimental"]},"editor.experimental.treeSitterTelemetry":{type:"boolean",default:!1,markdownDescription:localize("editor.experimental.treeSitterTelemetry","Controls whether tree sitter parsing should be turned on and telemetry collected. Setting `editor.experimental.preferTreeSitter` for specific languages will take precedence."),tags:["experimental"]},"editor.language.brackets":{type:["array","null"],default:null,description:localize("schema.brackets","Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:localize("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:localize("schema.closeBracket","The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:["array","null"],default:null,description:localize("schema.colorizedBracketPairs","Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:localize("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:localize("schema.closeBracket","The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:diffEditorDefaultOptions.maxComputationTime,description:localize("maxComputationTime","Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:diffEditorDefaultOptions.maxFileSize,description:localize("maxFileSize","Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:diffEditorDefaultOptions.renderSideBySide,description:localize("sideBySide","Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.renderSideBySideInlineBreakpoint":{type:"number",default:diffEditorDefaultOptions.renderSideBySideInlineBreakpoint,description:localize("renderSideBySideInlineBreakpoint","If the diff editor width is smaller than this value, the inline view is used.")},"diffEditor.useInlineViewWhenSpaceIsLimited":{type:"boolean",default:diffEditorDefaultOptions.useInlineViewWhenSpaceIsLimited,description:localize("useInlineViewWhenSpaceIsLimited","If enabled and the editor width is too small, the inline view is used.")},"diffEditor.renderMarginRevertIcon":{type:"boolean",default:diffEditorDefaultOptions.renderMarginRevertIcon,description:localize("renderMarginRevertIcon","When enabled, the diff editor shows arrows in its glyph margin to revert changes.")},"diffEditor.renderGutterMenu":{type:"boolean",default:diffEditorDefaultOptions.renderGutterMenu,description:localize("renderGutterMenu","When enabled, the diff editor shows a special gutter for revert and stage actions.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:diffEditorDefaultOptions.ignoreTrimWhitespace,description:localize("ignoreTrimWhitespace","When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:diffEditorDefaultOptions.renderIndicators,description:localize("renderIndicators","Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:diffEditorDefaultOptions.diffCodeLens,description:localize("codeLens","Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:diffEditorDefaultOptions.diffWordWrap,markdownEnumDescriptions:[localize("wordWrap.off","Lines will never wrap."),localize("wordWrap.on","Lines will wrap at the viewport width."),localize("wordWrap.inherit","Lines will wrap according to the {0} setting.","`#editor.wordWrap#`")]},"diffEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:diffEditorDefaultOptions.diffAlgorithm,markdownEnumDescriptions:[localize("diffAlgorithm.legacy","Uses the legacy diffing algorithm."),localize("diffAlgorithm.advanced","Uses the advanced diffing algorithm.")],tags:["experimental"]},"diffEditor.hideUnchangedRegions.enabled":{type:"boolean",default:diffEditorDefaultOptions.hideUnchangedRegions.enabled,markdownDescription:localize("hideUnchangedRegions.enabled","Controls whether the diff editor shows unchanged regions.")},"diffEditor.hideUnchangedRegions.revealLineCount":{type:"integer",default:diffEditorDefaultOptions.hideUnchangedRegions.revealLineCount,markdownDescription:localize("hideUnchangedRegions.revealLineCount","Controls how many lines are used for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.minimumLineCount":{type:"integer",default:diffEditorDefaultOptions.hideUnchangedRegions.minimumLineCount,markdownDescription:localize("hideUnchangedRegions.minimumLineCount","Controls how many lines are used as a minimum for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.contextLineCount":{type:"integer",default:diffEditorDefaultOptions.hideUnchangedRegions.contextLineCount,markdownDescription:localize("hideUnchangedRegions.contextLineCount","Controls how many lines are used as context when comparing unchanged regions."),minimum:1},"diffEditor.experimental.showMoves":{type:"boolean",default:diffEditorDefaultOptions.experimental.showMoves,markdownDescription:localize("showMoves","Controls whether the diff editor should show detected code moves.")},"diffEditor.experimental.showEmptyDecorations":{type:"boolean",default:diffEditorDefaultOptions.experimental.showEmptyDecorations,description:localize("showEmptyDecorations","Controls whether the diff editor shows empty decorations to see where characters got inserted or deleted.")},"diffEditor.experimental.useTrueInlineView":{type:"boolean",default:diffEditorDefaultOptions.experimental.useTrueInlineView,description:localize("useTrueInlineView","If enabled and the editor uses the inline view, word changes are rendered inline.")}}};function isConfigurationPropertySchema(F){return typeof F.type<"u"||typeof F.anyOf<"u"}for(const F of editorOptionsRegistry){const w=F.schema;if(typeof w<"u")if(isConfigurationPropertySchema(w))editorConfiguration.properties[`editor.${F.name}`]=w;else for(const D in w)Object.hasOwnProperty.call(w,D)&&(editorConfiguration.properties[D]=w[D])}let cachedEditorConfigurationKeys=null;function getEditorConfigurationKeys(){return cachedEditorConfigurationKeys===null&&(cachedEditorConfigurationKeys=Object.create(null),Object.keys(editorConfiguration.properties).forEach(F=>{cachedEditorConfigurationKeys[F]=!0})),cachedEditorConfigurationKeys}function isEditorConfigurationKey(F){return getEditorConfigurationKeys()[`editor.${F}`]||!1}function isDiffEditorConfigurationKey(F){return getEditorConfigurationKeys()[`diffEditor.${F}`]||!1}const configurationRegistry$1=Registry.as(Extensions$5.Configuration);configurationRegistry$1.registerConfiguration(editorConfiguration);function freeze(F){return Object.isFrozen(F)?F:deepFreeze(F)}class ConfigurationModel{static createEmptyModel(w){return new ConfigurationModel({},[],[],void 0,w)}constructor(w,D,O,W,U){this._contents=w,this._keys=D,this._overrides=O,this.raw=W,this.logService=U,this.overrideConfigurations=new Map}get rawConfiguration(){if(!this._rawConfiguration)if(this.raw?.length){const w=this.raw.map(D=>{if(D instanceof ConfigurationModel)return D;const O=new ConfigurationModelParser("",this.logService);return O.parseRaw(D),O.configurationModel});this._rawConfiguration=w.reduce((D,O)=>O===D?O:D.merge(O),w[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(w){return w?getConfigurationValue(this.contents,w):this.contents}inspect(w,D){const O=this;return{get value(){return freeze(O.rawConfiguration.getValue(w))},get override(){return D?freeze(O.rawConfiguration.getOverrideValue(w,D)):void 0},get merged(){return freeze(D?O.rawConfiguration.override(D).getValue(w):O.rawConfiguration.getValue(w))},get overrides(){const W=[];for(const{contents:U,identifiers:K,keys:q}of O.rawConfiguration.overrides){const G=new ConfigurationModel(U,q,[],void 0,O.logService).getValue(w);G!==void 0&&W.push({identifiers:K,value:G})}return W.length?freeze(W):void 0}}}getOverrideValue(w,D){const O=this.getContentsForOverrideIdentifer(D);return O?w?getConfigurationValue(O,w):O:void 0}override(w){let D=this.overrideConfigurations.get(w);return D||(D=this.createOverrideConfigurationModel(w),this.overrideConfigurations.set(w,D)),D}merge(...w){const D=deepClone(this.contents),O=deepClone(this.overrides),W=[...this.keys],U=this.raw?.length?[...this.raw]:[this];for(const K of w)if(U.push(...K.raw?.length?K.raw:[K]),!K.isEmpty()){this.mergeContents(D,K.contents);for(const q of K.overrides){const[G]=O.filter(Q=>equals$1(Q.identifiers,q.identifiers));G?(this.mergeContents(G.contents,q.contents),G.keys.push(...q.keys),G.keys=distinct(G.keys)):O.push(deepClone(q))}for(const q of K.keys)W.indexOf(q)===-1&&W.push(q)}return new ConfigurationModel(D,W,O,U.every(K=>K instanceof ConfigurationModel)?void 0:U,this.logService)}createOverrideConfigurationModel(w){const D=this.getContentsForOverrideIdentifer(w);if(!D||typeof D!="object"||!Object.keys(D).length)return this;const O={};for(const W of distinct([...Object.keys(this.contents),...Object.keys(D)])){let U=this.contents[W];const K=D[W];K&&(typeof U=="object"&&typeof K=="object"?(U=deepClone(U),this.mergeContents(U,K)):U=K),O[W]=U}return new ConfigurationModel(O,this.keys,this.overrides,void 0,this.logService)}mergeContents(w,D){for(const O of Object.keys(D)){if(O in w&&isObject$1(w[O])&&isObject$1(D[O])){this.mergeContents(w[O],D[O]);continue}w[O]=deepClone(D[O])}}getContentsForOverrideIdentifer(w){let D=null,O=null;const W=U=>{U&&(O?this.mergeContents(O,U):O=deepClone(U))};for(const U of this.overrides)U.identifiers.length===1&&U.identifiers[0]===w?D=U.contents:U.identifiers.includes(w)&&W(U.contents);return W(D),O}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(w,D){this.updateValue(w,D,!1)}removeValue(w){const D=this.keys.indexOf(w);D!==-1&&(this.keys.splice(D,1),removeFromValueTree(this.contents,w),OVERRIDE_PROPERTY_REGEX.test(w)&&this.overrides.splice(this.overrides.findIndex(O=>equals$1(O.identifiers,overrideIdentifiersFromKey(w))),1))}updateValue(w,D,O){if(addToValueTree(this.contents,w,D,W=>this.logService.error(W)),O=O||this.keys.indexOf(w)===-1,O&&this.keys.push(w),OVERRIDE_PROPERTY_REGEX.test(w)){const W=overrideIdentifiersFromKey(w),U={identifiers:W,keys:Object.keys(this.contents[w]),contents:toValuesTree(this.contents[w],q=>this.logService.error(q))},K=this.overrides.findIndex(q=>equals$1(q.identifiers,W));K!==-1?this.overrides[K]=U:this.overrides.push(U)}}}class ConfigurationModelParser{constructor(w,D){this._name=w,this.logService=D,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[]}get configurationModel(){return this._configurationModel||ConfigurationModel.createEmptyModel(this.logService)}parseRaw(w,D){this._raw=w;const{contents:O,keys:W,overrides:U,restricted:K,hasExcludedProperties:q}=this.doParseRaw(w,D);this._configurationModel=new ConfigurationModel(O,W,U,q?[w]:void 0,this.logService),this._restrictedConfigurations=K||[]}doParseRaw(w,D){const O=Registry.as(Extensions$5.Configuration).getConfigurationProperties(),W=this.filter(w,O,!0,D);w=W.raw;const U=toValuesTree(w,G=>this.logService.error(`Conflict in settings file ${this._name}: ${G}`)),K=Object.keys(w),q=this.toOverrides(w,G=>this.logService.error(`Conflict in settings file ${this._name}: ${G}`));return{contents:U,keys:K,overrides:q,restricted:W.restricted,hasExcludedProperties:W.hasExcludedProperties}}filter(w,D,O,W){let U=!1;if(!W?.scopes&&!W?.skipRestricted&&!W?.exclude?.length)return{raw:w,restricted:[],hasExcludedProperties:U};const K={},q=[];for(const G in w)if(OVERRIDE_PROPERTY_REGEX.test(G)&&O){const Q=this.filter(w[G],D,!1,W);K[G]=Q.raw,U=U||Q.hasExcludedProperties,q.push(...Q.restricted)}else{const Q=D[G],Y=Q?typeof Q.scope<"u"?Q.scope:3:void 0;Q?.restricted&&q.push(G),!W.exclude?.includes(G)&&(W.include?.includes(G)||(Y===void 0||W.scopes===void 0||W.scopes.includes(Y))&&!(W.skipRestricted&&Q?.restricted))?K[G]=w[G]:U=!0}return{raw:K,restricted:q,hasExcludedProperties:U}}toOverrides(w,D){const O=[];for(const W of Object.keys(w))if(OVERRIDE_PROPERTY_REGEX.test(W)){const U={};for(const K in w[W])U[K]=w[W][K];O.push({identifiers:overrideIdentifiersFromKey(W),keys:Object.keys(U),contents:toValuesTree(U,D)})}return O}}class ConfigurationInspectValue{constructor(w,D,O,W,U,K,q,G,Q,Y,X,J,te){this.key=w,this.overrides=D,this._value=O,this.overrideIdentifiers=W,this.defaultConfiguration=U,this.policyConfiguration=K,this.applicationConfiguration=q,this.userConfiguration=G,this.localUserConfiguration=Q,this.remoteUserConfiguration=Y,this.workspaceConfiguration=X,this.folderConfigurationModel=J,this.memoryConfigurationModel=te}toInspectValue(w){return w?.value!==void 0||w?.override!==void 0||w?.overrides!==void 0?w:void 0}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get user(){return this.toInspectValue(this.userInspectValue)}}class Configuration{constructor(w,D,O,W,U,K,q,G,Q,Y){this._defaultConfiguration=w,this._policyConfiguration=D,this._applicationConfiguration=O,this._localUserConfiguration=W,this._remoteUserConfiguration=U,this._workspaceConfiguration=K,this._folderConfigurations=q,this._memoryConfiguration=G,this._memoryConfigurationByResource=Q,this.logService=Y,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new ResourceMap,this._userConfiguration=null}getValue(w,D,O){return this.getConsolidatedConfigurationModel(w,D,O).getValue(w)}updateValue(w,D,O={}){let W;O.resource?(W=this._memoryConfigurationByResource.get(O.resource),W||(W=ConfigurationModel.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(O.resource,W))):W=this._memoryConfiguration,D===void 0?W.removeValue(w):W.setValue(w,D),O.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(w,D,O){const W=this.getConsolidatedConfigurationModel(w,D,O),U=this.getFolderConfigurationModelForResource(D.resource,O),K=D.resource?this._memoryConfigurationByResource.get(D.resource)||this._memoryConfiguration:this._memoryConfiguration,q=new Set;for(const G of W.overrides)for(const Q of G.identifiers)W.getOverrideValue(w,Q)!==void 0&&q.add(Q);return new ConfigurationInspectValue(w,D,W.getValue(w),q.size?[...q]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,O?this._workspaceConfiguration:void 0,U||void 0,K)}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(w,D,O){let W=this.getConsolidatedConfigurationModelForResource(D,O);return D.overrideIdentifier&&(W=W.override(D.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(w)!==void 0&&(W=W.merge(this._policyConfiguration)),W}getConsolidatedConfigurationModelForResource({resource:w},D){let O=this.getWorkspaceConsolidatedConfiguration();if(D&&w){const W=D.getFolder(w);W&&(O=this.getFolderConsolidatedConfiguration(W.uri)||O);const U=this._memoryConfigurationByResource.get(w);U&&(O=O.merge(U))}return O}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(w){let D=this._foldersConsolidatedConfigurations.get(w);if(!D){const O=this.getWorkspaceConsolidatedConfiguration(),W=this._folderConfigurations.get(w);W?(D=O.merge(W),this._foldersConsolidatedConfigurations.set(w,D)):D=O}return D}getFolderConfigurationModelForResource(w,D){if(D&&w){const O=D.getFolder(w);if(O)return this._folderConfigurations.get(O.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((w,D)=>{const{contents:O,overrides:W,keys:U}=this._folderConfigurations.get(D);return w.push([D,{contents:O,overrides:W,keys:U}]),w},[])}}static parse(w,D){const O=this.parseConfigurationModel(w.defaults,D),W=this.parseConfigurationModel(w.policy,D),U=this.parseConfigurationModel(w.application,D),K=this.parseConfigurationModel(w.user,D),q=this.parseConfigurationModel(w.workspace,D),G=w.folders.reduce((Q,Y)=>(Q.set(URI.revive(Y[0]),this.parseConfigurationModel(Y[1],D)),Q),new ResourceMap);return new Configuration(O,W,U,K,ConfigurationModel.createEmptyModel(D),q,G,ConfigurationModel.createEmptyModel(D),new ResourceMap,D)}static parseConfigurationModel(w,D){return new ConfigurationModel(w.contents,w.keys,w.overrides,void 0,D)}}class ConfigurationChangeEvent{constructor(w,D,O,W,U){this.change=w,this.previous=D,this.currentConfiguraiton=O,this.currentWorkspace=W,this.logService=U,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const K of w.keys)this.affectedKeys.add(K);for(const[,K]of w.overrides)for(const q of K)this.affectedKeys.add(q);this._affectsConfigStr=this._marker;for(const K of this.affectedKeys)this._affectsConfigStr+=K+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=Configuration.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(w,D){const O=this._marker+w,W=this._affectsConfigStr.indexOf(O);if(W<0)return!1;const U=W+O.length;if(U>=this._affectsConfigStr.length)return!1;const K=this._affectsConfigStr.charCodeAt(U);if(K!==this._markerCode1&&K!==this._markerCode2)return!1;if(D){const q=this.previousConfiguration?this.previousConfiguration.getValue(w,D,this.previous?.workspace):void 0,G=this.currentConfiguraiton.getValue(w,D,this.currentWorkspace);return!equals(q,G)}return!0}}const NoMatchingKb={kind:0},MoreChordsNeeded={kind:1};function KbFound(F,w,D){return{kind:2,commandId:F,commandArgs:w,isBubble:D}}class KeybindingResolver{constructor(w,D,O){this._log=O,this._defaultKeybindings=w,this._defaultBoundCommands=new Map;for(const W of w){const U=W.command;U&&U.charAt(0)!=="-"&&this._defaultBoundCommands.set(U,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=KeybindingResolver.handleRemovals([].concat(w).concat(D));for(let W=0,U=this._keybindings.length;W<U;W++){const K=this._keybindings[W];if(K.chords.length===0)continue;const q=K.when?.substituteConstants();q&&q.type===0||this._addKeyPress(K.chords[0],K)}}static _isTargetedForRemoval(w,D,O){if(D){for(let W=0;W<D.length;W++)if(D[W]!==w.chords[W])return!1}return!(O&&O.type!==1&&(!w.when||!expressionsAreEqualWithConstantSubstitution(O,w.when)))}static handleRemovals(w){const D=new Map;for(let W=0,U=w.length;W<U;W++){const K=w[W];if(K.command&&K.command.charAt(0)==="-"){const q=K.command.substring(1);D.has(q)?D.get(q).push(K):D.set(q,[K])}}if(D.size===0)return w;const O=[];for(let W=0,U=w.length;W<U;W++){const K=w[W];if(!K.command||K.command.length===0){O.push(K);continue}if(K.command.charAt(0)==="-")continue;const q=D.get(K.command);if(!q||!K.isDefault){O.push(K);continue}let G=!1;for(const Q of q){const Y=Q.when;if(this._isTargetedForRemoval(K,Q.chords,Y)){G=!0;break}}if(!G){O.push(K);continue}}return O}_addKeyPress(w,D){const O=this._map.get(w);if(typeof O>"u"){this._map.set(w,[D]),this._addToLookupMap(D);return}for(let W=O.length-1;W>=0;W--){const U=O[W];if(U.command===D.command)continue;let K=!0;for(let q=1;q<U.chords.length&&q<D.chords.length;q++)if(U.chords[q]!==D.chords[q]){K=!1;break}K&&KeybindingResolver.whenIsEntirelyIncluded(U.when,D.when)&&this._removeFromLookupMap(U)}O.push(D),this._addToLookupMap(D)}_addToLookupMap(w){if(!w.command)return;let D=this._lookupMap.get(w.command);typeof D>"u"?(D=[w],this._lookupMap.set(w.command,D)):D.push(w)}_removeFromLookupMap(w){if(!w.command)return;const D=this._lookupMap.get(w.command);if(!(typeof D>"u")){for(let O=0,W=D.length;O<W;O++)if(D[O]===w){D.splice(O,1);return}}}static whenIsEntirelyIncluded(w,D){return!D||D.type===1?!0:!w||w.type===1?!1:implies(w,D)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(w,D){const O=this._lookupMap.get(w);if(typeof O>"u"||O.length===0)return null;if(O.length===1)return O[0];for(let W=O.length-1;W>=0;W--){const U=O[W];if(D.contextMatchesRules(U.when))return U}return O[O.length-1]}resolve(w,D,O){const W=[...D,O];this._log(`| Resolving ${W}`);const U=this._map.get(W[0]);if(U===void 0)return this._log("\\ No keybinding entries."),NoMatchingKb;let K=null;if(W.length<2)K=U;else{K=[];for(let G=0,Q=U.length;G<Q;G++){const Y=U[G];if(W.length>Y.chords.length)continue;let X=!0;for(let J=1;J<W.length;J++)if(Y.chords[J]!==W[J]){X=!1;break}X&&K.push(Y)}}const q=this._findCommand(w,K);return q?W.length<q.chords.length?(this._log(`\\ From ${K.length} keybinding entries, awaiting ${q.chords.length-W.length} more chord(s), when: ${printWhenExplanation(q.when)}, source: ${printSourceExplanation(q)}.`),MoreChordsNeeded):(this._log(`\\ From ${K.length} keybinding entries, matched ${q.command}, when: ${printWhenExplanation(q.when)}, source: ${printSourceExplanation(q)}.`),KbFound(q.command,q.commandArgs,q.bubble)):(this._log(`\\ From ${K.length} keybinding entries, no when clauses matched the context.`),NoMatchingKb)}_findCommand(w,D){for(let O=D.length-1;O>=0;O--){const W=D[O];if(KeybindingResolver._contextMatchesRules(w,W.when))return W}return null}static _contextMatchesRules(w,D){return D?D.evaluate(w):!0}}function printWhenExplanation(F){return F?`${F.serialize()}`:"no when condition"}function printSourceExplanation(F){return F.extensionId?F.isBuiltinExtension?`built-in extension ${F.extensionId}`:`user extension ${F.extensionId}`:F.isDefault?"built-in":"user"}const HIGH_FREQ_COMMANDS=/^(cursor|delete|undo|redo|tab|editor\.action\.clipboard)/;class AbstractKeybindingService extends Disposable{get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:Event$1.None}get inChordMode(){return this._currentChords.length>0}constructor(w,D,O,W,U){super(),this._contextKeyService=w,this._commandService=D,this._telemetryService=O,this._notificationService=W,this._logService=U,this._onDidUpdateKeybindings=this._register(new Emitter$1),this._currentChords=[],this._currentChordChecker=new IntervalTimer,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=KeybindingModifierSet.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new TimeoutTimer,this._currentlyDispatchingCommandId=null,this._logging=!1}dispose(){super.dispose()}_log(w){this._logging&&this._logService.info(`[KeybindingService]: ${w}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(w,D){const O=this._getResolver().lookupPrimaryKeybinding(w,D||this._contextKeyService);if(O)return O.resolvedKeybinding}dispatchEvent(w,D){return this._dispatch(w,D)}softDispatch(w,D){this._log("/ Soft dispatching keyboard event");const O=this.resolveKeyboardEvent(w);if(O.hasMultipleChords())return console.warn("keyboard event should not be mapped to multiple chords"),NoMatchingKb;const[W]=O.getDispatchChords();if(W===null)return this._log("\\ Keyboard event cannot be dispatched"),NoMatchingKb;const U=this._contextKeyService.getContext(D),K=this._currentChords.map(({keypress:q})=>q);return this._getResolver().resolve(U,K,W)}_scheduleLeaveChordMode(){const w=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-w>5e3&&this._leaveChordMode()},500)}_expectAnotherChord(w,D){switch(this._currentChords.push({keypress:w,label:D}),this._currentChords.length){case 0:throw illegalState("impossible");case 1:this._currentChordStatusMessage=this._notificationService.status(localize("first.chord","({0}) was pressed. Waiting for second key of chord...",D));break;default:{const O=this._currentChords.map(({label:W})=>W).join(", ");this._currentChordStatusMessage=this._notificationService.status(localize("next.chord","({0}) was pressed. Waiting for next key of chord...",O))}}this._scheduleLeaveChordMode(),IME.enabled&&IME.disable()}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChords=[],IME.enable()}_dispatch(w,D){return this._doDispatch(this.resolveKeyboardEvent(w),D,!1)}_singleModifierDispatch(w,D){const O=this.resolveKeyboardEvent(w),[W]=O.getSingleModifierDispatchChords();if(W)return this._ignoreSingleModifiers.has(W)?(this._log(`+ Ignoring single modifier ${W} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=KeybindingModifierSet.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=KeybindingModifierSet.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${W}.`),this._currentSingleModifier=W,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):W===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${W} ${W}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(O,D,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${W}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[U]=O.getChords();return this._ignoreSingleModifiers=new KeybindingModifierSet(U),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(w,D,O=!1){let W=!1;if(w.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),!1;let U=null,K=null;if(O){const[Y]=w.getSingleModifierDispatchChords();U=Y,K=Y?[Y]:[]}else[U]=w.getDispatchChords(),K=this._currentChords.map(({keypress:Y})=>Y);if(U===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),W;const q=this._contextKeyService.getContext(D),G=w.getLabel(),Q=this._getResolver().resolve(q,K,U);switch(Q.kind){case 0:{if(this._logService.trace("KeybindingService#dispatch",G,"[ No matching keybinding ]"),this.inChordMode){const Y=this._currentChords.map(({label:X})=>X).join(", ");this._log(`+ Leaving multi-chord mode: Nothing bound to "${Y}, ${G}".`),this._notificationService.status(localize("missing.chord","The key combination ({0}, {1}) is not a command.",Y,G),{hideAfter:10*1e3}),this._leaveChordMode(),W=!0}return W}case 1:return this._logService.trace("KeybindingService#dispatch",G,"[ Several keybindings match - more chords needed ]"),W=!0,this._expectAnotherChord(U,G),this._log(this._currentChords.length===1?"+ Entering multi-chord mode...":"+ Continuing multi-chord mode..."),W;case 2:{if(this._logService.trace("KeybindingService#dispatch",G,`[ Will dispatch command ${Q.commandId} ]`),Q.commandId===null||Q.commandId===""){if(this.inChordMode){const Y=this._currentChords.map(({label:X})=>X).join(", ");this._log(`+ Leaving chord mode: Nothing bound to "${Y}, ${G}".`),this._notificationService.status(localize("missing.chord","The key combination ({0}, {1}) is not a command.",Y,G),{hideAfter:10*1e3}),this._leaveChordMode(),W=!0}}else{this.inChordMode&&this._leaveChordMode(),Q.isBubble||(W=!0),this._log(`+ Invoking command ${Q.commandId}.`),this._currentlyDispatchingCommandId=Q.commandId;try{typeof Q.commandArgs>"u"?this._commandService.executeCommand(Q.commandId).then(void 0,Y=>this._notificationService.warn(Y)):this._commandService.executeCommand(Q.commandId,Q.commandArgs).then(void 0,Y=>this._notificationService.warn(Y))}finally{this._currentlyDispatchingCommandId=null}HIGH_FREQ_COMMANDS.test(Q.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:Q.commandId,from:"keybinding",detail:w.getUserSettingsLabel()??void 0})}return W}}}mightProducePrintableCharacter(w){return w.ctrlKey||w.metaKey?!1:w.keyCode>=31&&w.keyCode<=56||w.keyCode>=21&&w.keyCode<=30}}class KeybindingModifierSet{static{this.EMPTY=new KeybindingModifierSet(null)}constructor(w){this._ctrlKey=w?w.ctrlKey:!1,this._shiftKey=w?w.shiftKey:!1,this._altKey=w?w.altKey:!1,this._metaKey=w?w.metaKey:!1}has(w){switch(w){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}}class ResolvedKeybindingItem{constructor(w,D,O,W,U,K,q){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=w,this.chords=w?toEmptyArrayIfContainsNull(w.getDispatchChords()):[],w&&this.chords.length===0&&(this.chords=toEmptyArrayIfContainsNull(w.getSingleModifierDispatchChords())),this.bubble=D?D.charCodeAt(0)===94:!1,this.command=this.bubble?D.substr(1):D,this.commandArgs=O,this.when=W,this.isDefault=U,this.extensionId=K,this.isBuiltinExtension=q}}function toEmptyArrayIfContainsNull(F){const w=[];for(let D=0,O=F.length;D<O;D++){const W=F[D];if(!W)return[];w.push(W)}return w}class BaseResolvedKeybinding extends ResolvedKeybinding{constructor(w,D){if(super(),D.length===0)throw illegalArgument("chords");this._os=w,this._chords=D}getLabel(){return UILabelProvider.toLabel(this._os,this._chords,w=>this._getLabel(w))}getAriaLabel(){return AriaLabelProvider.toLabel(this._os,this._chords,w=>this._getAriaLabel(w))}getElectronAccelerator(){return this._chords.length>1||this._chords[0].isDuplicateModifierCase()?null:ElectronAcceleratorLabelProvider.toLabel(this._os,this._chords,w=>this._getElectronAccelerator(w))}getUserSettingsLabel(){return UserSettingsLabelProvider.toLabel(this._os,this._chords,w=>this._getUserSettingsLabel(w))}hasMultipleChords(){return this._chords.length>1}getChords(){return this._chords.map(w=>this._getChord(w))}_getChord(w){return new ResolvedChord(w.ctrlKey,w.shiftKey,w.altKey,w.metaKey,this._getLabel(w),this._getAriaLabel(w))}getDispatchChords(){return this._chords.map(w=>this._getChordDispatch(w))}getSingleModifierDispatchChords(){return this._chords.map(w=>this._getSingleModifierChordDispatch(w))}}class USLayoutResolvedKeybinding extends BaseResolvedKeybinding{constructor(w,D){super(D,w)}_keyCodeToUILabel(w){if(this._os===2)switch(w){case 15:return"←";case 16:return"↑";case 17:return"→";case 18:return"↓"}return KeyCodeUtils.toString(w)}_getLabel(w){return w.isDuplicateModifierCase()?"":this._keyCodeToUILabel(w.keyCode)}_getAriaLabel(w){return w.isDuplicateModifierCase()?"":KeyCodeUtils.toString(w.keyCode)}_getElectronAccelerator(w){return KeyCodeUtils.toElectronAccelerator(w.keyCode)}_getUserSettingsLabel(w){if(w.isDuplicateModifierCase())return"";const D=KeyCodeUtils.toUserSettingsUS(w.keyCode);return D&&D.toLowerCase()}_getChordDispatch(w){return USLayoutResolvedKeybinding.getDispatchStr(w)}static getDispatchStr(w){if(w.isModifierKey())return null;let D="";return w.ctrlKey&&(D+="ctrl+"),w.shiftKey&&(D+="shift+"),w.altKey&&(D+="alt+"),w.metaKey&&(D+="meta+"),D+=KeyCodeUtils.toString(w.keyCode),D}_getSingleModifierChordDispatch(w){return w.keyCode===5&&!w.shiftKey&&!w.altKey&&!w.metaKey?"ctrl":w.keyCode===4&&!w.ctrlKey&&!w.altKey&&!w.metaKey?"shift":w.keyCode===6&&!w.ctrlKey&&!w.shiftKey&&!w.metaKey?"alt":w.keyCode===57&&!w.ctrlKey&&!w.shiftKey&&!w.altKey?"meta":null}static _scanCodeToKeyCode(w){const D=IMMUTABLE_CODE_TO_KEY_CODE[w];if(D!==-1)return D;switch(w){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 88;case 52:return 86;case 53:return 92;case 54:return 94;case 55:return 93;case 56:return 0;case 57:return 85;case 58:return 95;case 59:return 91;case 60:return 87;case 61:return 89;case 62:return 90;case 106:return 97}return 0}static _toKeyCodeChord(w){if(!w)return null;if(w instanceof KeyCodeChord)return w;const D=this._scanCodeToKeyCode(w.scanCode);return D===0?null:new KeyCodeChord(w.ctrlKey,w.shiftKey,w.altKey,w.metaKey,D)}static resolveKeybinding(w,D){const O=toEmptyArrayIfContainsNull(w.chords.map(W=>this._toKeyCodeChord(W)));return O.length>0?[new USLayoutResolvedKeybinding(O,D)]:[]}}const IProgressService=createDecorator("progressService");class Progress{static{this.None=Object.freeze({report(){}})}constructor(w){this.callback=w}report(w){this._value=w,this.callback(this._value)}}const IEditorProgressService=createDecorator("editorProgressService");var InspectTokensNLS;(function(F){F.inspectTokensAction=localize("inspectTokens","Developer: Inspect Tokens")})(InspectTokensNLS||(InspectTokensNLS={}));var GoToLineNLS;(function(F){F.gotoLineActionLabel=localize("gotoLineActionLabel","Go to Line/Column...")})(GoToLineNLS||(GoToLineNLS={}));var QuickHelpNLS;(function(F){F.helpQuickAccessActionLabel=localize("helpQuickAccess","Show all Quick Access Providers")})(QuickHelpNLS||(QuickHelpNLS={}));var QuickCommandNLS;(function(F){F.quickCommandActionLabel=localize("quickCommandActionLabel","Command Palette"),F.quickCommandHelp=localize("quickCommandActionHelp","Show And Run Commands")})(QuickCommandNLS||(QuickCommandNLS={}));var QuickOutlineNLS;(function(F){F.quickOutlineActionLabel=localize("quickOutlineActionLabel","Go to Symbol..."),F.quickOutlineByCategoryActionLabel=localize("quickOutlineByCategoryActionLabel","Go to Symbol by Category...")})(QuickOutlineNLS||(QuickOutlineNLS={}));var StandaloneCodeEditorNLS;(function(F){F.editorViewAccessibleLabel=localize("editorViewAccessibleLabel","Editor content")})(StandaloneCodeEditorNLS||(StandaloneCodeEditorNLS={}));var ToggleHighContrastNLS;(function(F){F.toggleHighContrast=localize("toggleHighContrast","Toggle High Contrast Theme")})(ToggleHighContrastNLS||(ToggleHighContrastNLS={}));var StandaloneServicesNLS;(function(F){F.bulkEditServiceSummary=localize("bulkEditServiceSummary","Made {0} edits in {1} files")})(StandaloneServicesNLS||(StandaloneServicesNLS={}));const IWorkspaceTrustManagementService=createDecorator("workspaceTrustManagementService");let registeredAssociations=[],nonUserRegisteredAssociations=[],userRegisteredAssociations=[];function registerPlatformLanguageAssociation(F,w=!1){_registerLanguageAssociation(F,!1,w)}function _registerLanguageAssociation(F,w,D){const O=toLanguageAssociationItem(F,w);registeredAssociations.push(O),O.userConfigured?userRegisteredAssociations.push(O):nonUserRegisteredAssociations.push(O),D&&!O.userConfigured&&registeredAssociations.forEach(W=>{W.mime===O.mime||W.userConfigured||(O.extension&&W.extension===O.extension&&console.warn(`Overwriting extension <<${O.extension}>> to now point to mime <<${O.mime}>>`),O.filename&&W.filename===O.filename&&console.warn(`Overwriting filename <<${O.filename}>> to now point to mime <<${O.mime}>>`),O.filepattern&&W.filepattern===O.filepattern&&console.warn(`Overwriting filepattern <<${O.filepattern}>> to now point to mime <<${O.mime}>>`),O.firstline&&W.firstline===O.firstline&&console.warn(`Overwriting firstline <<${O.firstline}>> to now point to mime <<${O.mime}>>`))})}function toLanguageAssociationItem(F,w){return{id:F.id,mime:F.mime,filename:F.filename,extension:F.extension,filepattern:F.filepattern,firstline:F.firstline,userConfigured:w,filenameLowercase:F.filename?F.filename.toLowerCase():void 0,extensionLowercase:F.extension?F.extension.toLowerCase():void 0,filepatternLowercase:F.filepattern?parse(F.filepattern.toLowerCase()):void 0,filepatternOnPath:F.filepattern?F.filepattern.indexOf(posix.sep)>=0:!1}}function clearPlatformLanguageAssociations(){registeredAssociations=registeredAssociations.filter(F=>F.userConfigured),nonUserRegisteredAssociations=[]}function getLanguageIds(F,w){return getAssociations(F,w).map(D=>D.id)}function getAssociations(F,w){let D;if(F)switch(F.scheme){case Schemas.file:D=F.fsPath;break;case Schemas.data:{D=DataUri.parseMetaData(F).get(DataUri.META_DATA_LABEL);break}case Schemas.vscodeNotebookCell:D=void 0;break;default:D=F.path}if(!D)return[{id:"unknown",mime:Mimes.unknown}];D=D.toLowerCase();const O=basename$1(D),W=getAssociationByPath(D,O,userRegisteredAssociations);if(W)return[W,{id:PLAINTEXT_LANGUAGE_ID,mime:Mimes.text}];const U=getAssociationByPath(D,O,nonUserRegisteredAssociations);if(U)return[U,{id:PLAINTEXT_LANGUAGE_ID,mime:Mimes.text}];if(w){const K=getAssociationByFirstline(w);if(K)return[K,{id:PLAINTEXT_LANGUAGE_ID,mime:Mimes.text}]}return[{id:"unknown",mime:Mimes.unknown}]}function getAssociationByPath(F,w,D){let O,W,U;for(let K=D.length-1;K>=0;K--){const q=D[K];if(w===q.filenameLowercase){O=q;break}if(q.filepattern&&(!W||q.filepattern.length>W.filepattern.length)){const G=q.filepatternOnPath?F:w;q.filepatternLowercase?.(G)&&(W=q)}q.extension&&(!U||q.extension.length>U.extension.length)&&w.endsWith(q.extensionLowercase)&&(U=q)}if(O)return O;if(W)return W;if(U)return U}function getAssociationByFirstline(F){if(startsWithUTF8BOM(F)&&(F=F.substr(1)),F.length>0)for(let w=registeredAssociations.length-1;w>=0;w--){const D=registeredAssociations[w];if(!D.firstline)continue;const O=F.match(D.firstline);if(O&&O.length>0)return D}}const hasOwnProperty=Object.prototype.hasOwnProperty,NULL_LANGUAGE_ID="vs.editor.nullLanguage";class LanguageIdCodec{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(NULL_LANGUAGE_ID,0),this._register(PLAINTEXT_LANGUAGE_ID,1),this._nextLanguageId=2}_register(w,D){this._languageIdToLanguage[D]=w,this._languageToLanguageId.set(w,D)}register(w){if(this._languageToLanguageId.has(w))return;const D=this._nextLanguageId++;this._register(w,D)}encodeLanguageId(w){return this._languageToLanguageId.get(w)||0}decodeLanguageId(w){return this._languageIdToLanguage[w]||NULL_LANGUAGE_ID}}class LanguagesRegistry extends Disposable{static{this.instanceCount=0}constructor(w=!0,D=!1){super(),this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,LanguagesRegistry.instanceCount++,this._warnOnOverwrite=D,this.languageIdCodec=new LanguageIdCodec,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},w&&(this._initializeFromRegistry(),this._register(ModesRegistry.onDidChangeLanguages(O=>{this._initializeFromRegistry()})))}dispose(){LanguagesRegistry.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},clearPlatformLanguageAssociations();const w=[].concat(ModesRegistry.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(w)}_registerLanguages(w){for(const D of w)this._registerLanguage(D);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(D=>{const O=this._languages[D];O.name&&(this._nameMap[O.name]=O.identifier),O.aliases.forEach(W=>{this._lowercaseNameMap[W.toLowerCase()]=O.identifier}),O.mimetypes.forEach(W=>{this._mimeTypesMap[W]=O.identifier})}),Registry.as(Extensions$5.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(w){const D=w.id;let O;hasOwnProperty.call(this._languages,D)?O=this._languages[D]:(this.languageIdCodec.register(D),O={identifier:D,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[D]=O),this._mergeLanguage(O,w)}_mergeLanguage(w,D){const O=D.id;let W=null;if(Array.isArray(D.mimetypes)&&D.mimetypes.length>0&&(w.mimetypes.push(...D.mimetypes),W=D.mimetypes[0]),W||(W=`text/x-${O}`,w.mimetypes.push(W)),Array.isArray(D.extensions)){D.configuration?w.extensions=D.extensions.concat(w.extensions):w.extensions=w.extensions.concat(D.extensions);for(const q of D.extensions)registerPlatformLanguageAssociation({id:O,mime:W,extension:q},this._warnOnOverwrite)}if(Array.isArray(D.filenames))for(const q of D.filenames)registerPlatformLanguageAssociation({id:O,mime:W,filename:q},this._warnOnOverwrite),w.filenames.push(q);if(Array.isArray(D.filenamePatterns))for(const q of D.filenamePatterns)registerPlatformLanguageAssociation({id:O,mime:W,filepattern:q},this._warnOnOverwrite);if(typeof D.firstLine=="string"&&D.firstLine.length>0){let q=D.firstLine;q.charAt(0)!=="^"&&(q="^"+q);try{const G=new RegExp(q);regExpLeadsToEndlessLoop(G)||registerPlatformLanguageAssociation({id:O,mime:W,firstline:G},this._warnOnOverwrite)}catch(G){console.warn(`[${D.id}]: Invalid regular expression \`${q}\`: `,G)}}w.aliases.push(O);let U=null;if(typeof D.aliases<"u"&&Array.isArray(D.aliases)&&(D.aliases.length===0?U=[null]:U=D.aliases),U!==null)for(const q of U)!q||q.length===0||w.aliases.push(q);const K=U!==null&&U.length>0;if(!(K&&U[0]===null)){const q=(K?U[0]:null)||O;(K||!w.name)&&(w.name=q)}D.configuration&&w.configurationFiles.push(D.configuration),D.icon&&w.icons.push(D.icon)}isRegisteredLanguageId(w){return w?hasOwnProperty.call(this._languages,w):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(w){const D=w.toLowerCase();return hasOwnProperty.call(this._lowercaseNameMap,D)?this._lowercaseNameMap[D]:null}getLanguageIdByMimeType(w){return w&&hasOwnProperty.call(this._mimeTypesMap,w)?this._mimeTypesMap[w]:null}guessLanguageIdByFilepathOrFirstLine(w,D){return!w&&!D?[]:getLanguageIds(w,D)}}class LanguageService extends Disposable{static{this.instanceCount=0}constructor(w=!1){super(),this._onDidRequestBasicLanguageFeatures=this._register(new Emitter$1),this.onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event,this._onDidRequestRichLanguageFeatures=this._register(new Emitter$1),this.onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event,this._onDidChange=this._register(new Emitter$1({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,this._requestedBasicLanguages=new Set,this._requestedRichLanguages=new Set,LanguageService.instanceCount++,this._registry=this._register(new LanguagesRegistry(!0,w)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){LanguageService.instanceCount--,super.dispose()}isRegisteredLanguageId(w){return this._registry.isRegisteredLanguageId(w)}getLanguageIdByLanguageName(w){return this._registry.getLanguageIdByLanguageName(w)}getLanguageIdByMimeType(w){return this._registry.getLanguageIdByMimeType(w)}guessLanguageIdByFilepathOrFirstLine(w,D){const O=this._registry.guessLanguageIdByFilepathOrFirstLine(w,D);return firstOrDefault(O,null)}createById(w){return new LanguageSelection(this.onDidChange,()=>this._createAndGetLanguageIdentifier(w))}createByFilepathOrFirstLine(w,D){return new LanguageSelection(this.onDidChange,()=>{const O=this.guessLanguageIdByFilepathOrFirstLine(w,D);return this._createAndGetLanguageIdentifier(O)})}_createAndGetLanguageIdentifier(w){return(!w||!this.isRegisteredLanguageId(w))&&(w=PLAINTEXT_LANGUAGE_ID),w}requestBasicLanguageFeatures(w){this._requestedBasicLanguages.has(w)||(this._requestedBasicLanguages.add(w),this._onDidRequestBasicLanguageFeatures.fire(w))}requestRichLanguageFeatures(w){this._requestedRichLanguages.has(w)||(this._requestedRichLanguages.add(w),this.requestBasicLanguageFeatures(w),TokenizationRegistry.getOrCreate(w),this._onDidRequestRichLanguageFeatures.fire(w))}}class LanguageSelection{constructor(w,D){this._value=observableFromEvent(this,w,()=>D()),this.onDidChange=Event$1.fromObservable(this._value)}get languageId(){return this._value.get()}}const MENU_MNEMONIC_REGEX=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,MENU_ESCAPED_MNEMONIC_REGEX=/(&amp;)?(&amp;)([^\s&])/g;var HorizontalDirection;(function(F){F[F.Right=0]="Right",F[F.Left=1]="Left"})(HorizontalDirection||(HorizontalDirection={}));var VerticalDirection;(function(F){F[F.Above=0]="Above",F[F.Below=1]="Below"})(VerticalDirection||(VerticalDirection={}));class Menu extends ActionBar{constructor(w,D,O,W){w.classList.add("monaco-menu-container"),w.setAttribute("role","presentation");const U=document.createElement("div");U.classList.add("monaco-menu"),U.setAttribute("role","presentation"),super(U,{orientation:1,actionViewItemProvider:Q=>this.doGetActionViewItem(Q,O,K),context:O.context,actionRunner:O.actionRunner,ariaLabel:O.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...isMacintosh||isLinux?[10]:[]],keyDown:!0}}),this.menuStyles=W,this.menuElement=U,this.actionsList.tabIndex=0,this.initializeOrUpdateStyleSheet(w,W),this._register(Gesture.addTarget(U)),this._register(addDisposableListener(U,EventType$1.KEY_DOWN,Q=>{new StandardKeyboardEvent(Q).equals(2)&&Q.preventDefault()})),O.enableMnemonics&&this._register(addDisposableListener(U,EventType$1.KEY_DOWN,Q=>{const Y=Q.key.toLocaleLowerCase();if(this.mnemonics.has(Y)){EventHelper.stop(Q,!0);const X=this.mnemonics.get(Y);if(X.length===1&&(X[0]instanceof SubmenuMenuActionViewItem&&X[0].container&&this.focusItemByElement(X[0].container),X[0].onClick(Q)),X.length>1){const J=X.shift();J&&J.container&&(this.focusItemByElement(J.container),X.push(J)),this.mnemonics.set(Y,X)}}})),isLinux&&this._register(addDisposableListener(U,EventType$1.KEY_DOWN,Q=>{const Y=new StandardKeyboardEvent(Q);Y.equals(14)||Y.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),EventHelper.stop(Q,!0)):(Y.equals(13)||Y.equals(12))&&(this.focusedItem=0,this.focusPrevious(),EventHelper.stop(Q,!0))})),this._register(addDisposableListener(this.domNode,EventType$1.MOUSE_OUT,Q=>{const Y=Q.relatedTarget;isAncestor$1(Y,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),Q.stopPropagation())})),this._register(addDisposableListener(this.actionsList,EventType$1.MOUSE_OVER,Q=>{let Y=Q.target;if(!(!Y||!isAncestor$1(Y,this.actionsList)||Y===this.actionsList)){for(;Y.parentElement!==this.actionsList&&Y.parentElement!==null;)Y=Y.parentElement;if(Y.classList.contains("action-item")){const X=this.focusedItem;this.setFocusedItem(Y),X!==this.focusedItem&&this.updateFocus()}}})),this._register(Gesture.addTarget(this.actionsList)),this._register(addDisposableListener(this.actionsList,EventType.Tap,Q=>{let Y=Q.initialTarget;if(!(!Y||!isAncestor$1(Y,this.actionsList)||Y===this.actionsList)){for(;Y.parentElement!==this.actionsList&&Y.parentElement!==null;)Y=Y.parentElement;if(Y.classList.contains("action-item")){const X=this.focusedItem;this.setFocusedItem(Y),X!==this.focusedItem&&this.updateFocus()}}}));const K={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new DomScrollableElement(U,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const q=this.scrollableElement.getDomNode();q.style.position="",this.styleScrollElement(q,W),this._register(addDisposableListener(U,EventType.Change,Q=>{EventHelper.stop(Q,!0);const Y=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:Y-Q.translationY})})),this._register(addDisposableListener(q,EventType$1.MOUSE_UP,Q=>{Q.preventDefault()}));const G=getWindow(w);U.style.maxHeight=`${Math.max(10,G.innerHeight-w.getBoundingClientRect().top-35)}px`,D=D.filter((Q,Y)=>O.submenuIds?.has(Q.id)?(console.warn(`Found submenu cycle: ${Q.id}`),!1):!(Q instanceof Separator&&(Y===D.length-1||Y===0||D[Y-1]instanceof Separator))),this.push(D,{icon:!0,label:!0,isMenu:!0}),w.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(Q=>!(Q instanceof MenuSeparatorActionViewItem)).forEach((Q,Y,X)=>{Q.updatePositionInSet(Y+1,X.length)})}initializeOrUpdateStyleSheet(w,D){this.styleSheet||(isInShadowDOM(w)?this.styleSheet=createStyleSheet(w):(Menu.globalStyleSheet||(Menu.globalStyleSheet=createStyleSheet()),this.styleSheet=Menu.globalStyleSheet)),this.styleSheet.textContent=getMenuWidgetCSS(D,isInShadowDOM(w))}styleScrollElement(w,D){const O=D.foregroundColor??"",W=D.backgroundColor??"",U=D.borderColor?`1px solid ${D.borderColor}`:"",K="5px",q=D.shadowColor?`0 2px 8px ${D.shadowColor}`:"";w.style.outline=U,w.style.borderRadius=K,w.style.color=O,w.style.backgroundColor=W,w.style.boxShadow=q}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(w){const D=this.focusedItem;this.setFocusedItem(w),D!==this.focusedItem&&this.updateFocus()}setFocusedItem(w){for(let D=0;D<this.actionsList.children.length;D++){const O=this.actionsList.children[D];if(w===O){this.focusedItem=D;break}}}updateFocus(w){super.updateFocus(w,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(w,D,O){if(w instanceof Separator)return new MenuSeparatorActionViewItem(D.context,w,{icon:!0},this.menuStyles);if(w instanceof SubmenuAction){const W=new SubmenuMenuActionViewItem(w,w.actions,O,{...D,submenuIds:new Set([...D.submenuIds||[],w.id])},this.menuStyles);if(D.enableMnemonics){const U=W.getMnemonic();if(U&&W.isEnabled()){let K=[];this.mnemonics.has(U)&&(K=this.mnemonics.get(U)),K.push(W),this.mnemonics.set(U,K)}}return W}else{const W={enableMnemonics:D.enableMnemonics,useEventAsContext:D.useEventAsContext};if(D.getKeyBinding){const K=D.getKeyBinding(w);if(K){const q=K.getLabel();q&&(W.keybinding=q)}}const U=new BaseMenuActionViewItem(D.context,w,W,this.menuStyles);if(D.enableMnemonics){const K=U.getMnemonic();if(K&&U.isEnabled()){let q=[];this.mnemonics.has(K)&&(q=this.mnemonics.get(K)),q.push(U),this.mnemonics.set(K,q)}}return U}}}class BaseMenuActionViewItem extends BaseActionViewItem{constructor(w,D,O,W){if(O.isMenu=!0,super(D,D,O),this.menuStyle=W,this.options=O,this.options.icon=O.icon!==void 0?O.icon:!1,this.options.label=O.label!==void 0?O.label:!0,this.cssClass="",this.options.label&&O.enableMnemonics){const U=this.action.label;if(U){const K=MENU_MNEMONIC_REGEX.exec(U);K&&(this.mnemonic=(K[1]?K[1]:K[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new RunOnceScheduler(()=>{this.element&&(this._register(addDisposableListener(this.element,EventType$1.MOUSE_UP,U=>{if(EventHelper.stop(U,!0),isFirefox$1){if(new StandardMouseEvent(getWindow(this.element),U).rightButton)return;this.onClick(U)}else setTimeout(()=>{this.onClick(U)},0)})),this._register(addDisposableListener(this.element,EventType$1.CONTEXT_MENU,U=>{EventHelper.stop(U,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(w){super.render(w),this.element&&(this.container=w,this.item=append$1(this.element,$$8("a.action-menu-item")),this._action.id===Separator.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=append$1(this.item,$$8("span.menu-item-check"+ThemeIcon.asCSSSelector(Codicon.menuSelection))),this.check.setAttribute("role","none"),this.label=append$1(this.item,$$8("span.action-label")),this.options.label&&this.options.keybinding&&(append$1(this.item,$$8("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){super.focus(),this.item?.focus(),this.applyStyle()}updatePositionInSet(w,D){this.item&&(this.item.setAttribute("aria-posinset",`${w}`),this.item.setAttribute("aria-setsize",`${D}`))}updateLabel(){if(this.label&&this.options.label){clearNode(this.label);let w=stripIcons(this.action.label);if(w){const D=cleanMnemonic(w);this.options.enableMnemonics||(w=D),this.label.setAttribute("aria-label",D.replace(/&&/g,"&"));const O=MENU_MNEMONIC_REGEX.exec(w);if(O){w=escape(w),MENU_ESCAPED_MNEMONIC_REGEX.lastIndex=0;let W=MENU_ESCAPED_MNEMONIC_REGEX.exec(w);for(;W&&W[1];)W=MENU_ESCAPED_MNEMONIC_REGEX.exec(w);const U=K=>K.replace(/&amp;&amp;/g,"&amp;");W?this.label.append(ltrim(U(w.substr(0,W.index))," "),$$8("u",{"aria-hidden":"true"},W[3]),rtrim(U(w.substr(W.index+W[0].length))," ")):this.label.innerText=U(w).trim(),this.item?.setAttribute("aria-keyshortcuts",(O[1]?O[1]:O[3]).toLocaleLowerCase())}else this.label.innerText=w.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const w=this.action.checked;this.item.classList.toggle("checked",!!w),w!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",w?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){const w=this.element&&this.element.classList.contains("focused"),D=w&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,O=w&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,W=w&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",U=w&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=D??"",this.item.style.backgroundColor=O??"",this.item.style.outline=W,this.item.style.outlineOffset=U),this.check&&(this.check.style.color=D??"")}}class SubmenuMenuActionViewItem extends BaseMenuActionViewItem{constructor(w,D,O,W,U){super(w,w,W,U),this.submenuActions=D,this.parentData=O,this.submenuOptions=W,this.mysubmenu=null,this.submenuDisposables=this._register(new DisposableStore),this.mouseOver=!1,this.expandDirection=W&&W.expandDirection!==void 0?W.expandDirection:{horizontal:HorizontalDirection.Right,vertical:VerticalDirection.Below},this.showScheduler=new RunOnceScheduler(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new RunOnceScheduler(()=>{this.element&&!isAncestor$1(getActiveElement(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(w){super.render(w),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=append$1(this.item,$$8("span.submenu-indicator"+ThemeIcon.asCSSSelector(Codicon.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(addDisposableListener(this.element,EventType$1.KEY_UP,D=>{const O=new StandardKeyboardEvent(D);(O.equals(17)||O.equals(3))&&(EventHelper.stop(D,!0),this.createSubmenu(!0))})),this._register(addDisposableListener(this.element,EventType$1.KEY_DOWN,D=>{const O=new StandardKeyboardEvent(D);getActiveElement()===this.item&&(O.equals(17)||O.equals(3))&&EventHelper.stop(D,!0)})),this._register(addDisposableListener(this.element,EventType$1.MOUSE_OVER,D=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(addDisposableListener(this.element,EventType$1.MOUSE_LEAVE,D=>{this.mouseOver=!1})),this._register(addDisposableListener(this.element,EventType$1.FOCUS_OUT,D=>{this.element&&!isAncestor$1(getActiveElement(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}onClick(w){EventHelper.stop(w,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(w){if(this.parentData.submenu&&(w||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(w,D,O,W){const U={top:0,left:0};return U.left=layout(w.width,D.width,{position:W.horizontal===HorizontalDirection.Right?0:1,offset:O.left,size:O.width}),U.left>=O.left&&U.left<O.left+O.width&&(O.left+10+D.width<=w.width&&(U.left=O.left+10),O.top+=10,O.height=0),U.top=layout(w.height,D.height,{position:0,offset:O.top,size:0}),U.top+D.height===O.top&&U.top+O.height+D.height<=w.height&&(U.top+=O.height),U}createSubmenu(w=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=append$1(this.element,$$8("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const D=getWindow(this.parentData.parent.domNode).getComputedStyle(this.parentData.parent.domNode),O=parseFloat(D.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new Menu(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new EmptySubmenuAction],this.submenuOptions,this.menuStyle);const W=this.element.getBoundingClientRect(),U={top:W.top-O,left:W.left,height:W.height+2*O,width:W.width},K=this.submenuContainer.getBoundingClientRect(),q=getWindow(this.element),{top:G,left:Q}=this.calculateSubmenuMenuLayout(new Dimension(q.innerWidth,q.innerHeight),Dimension.lift(K),U,this.expandDirection);this.submenuContainer.style.left=`${Q-K.left}px`,this.submenuContainer.style.top=`${G-K.top}px`,this.submenuDisposables.add(addDisposableListener(this.submenuContainer,EventType$1.KEY_UP,Y=>{new StandardKeyboardEvent(Y).equals(15)&&(EventHelper.stop(Y,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(addDisposableListener(this.submenuContainer,EventType$1.KEY_DOWN,Y=>{new StandardKeyboardEvent(Y).equals(15)&&EventHelper.stop(Y,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(w),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(w){this.item&&this.item?.setAttribute("aria-expanded",w)}applyStyle(){super.applyStyle();const D=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=D??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class MenuSeparatorActionViewItem extends ActionViewItem{constructor(w,D,O,W){super(w,D,O),this.menuStyles=W}render(w){super.render(w),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}}function cleanMnemonic(F){const w=MENU_MNEMONIC_REGEX,D=w.exec(F);if(!D)return F;const O=!D[1];return F.replace(w,O?"$2$3":"").trim()}function formatRule(F){const w=getCodiconFontCharacters()[F.id];return`.codicon-${F.id}:before { content: '\\${w.toString(16)}'; }`}function getMenuWidgetCSS(F,w){let D=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${formatRule(Codicon.menuSelection)}
${formatRule(Codicon.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
	max-height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(w){D+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
		`;const O=F.scrollbarShadow;O&&(D+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${O} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${O} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${O} 6px 6px 6px -6px inset;
				}
			`);const W=F.scrollbarSliderBackground;W&&(D+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${W};
				}
			`);const U=F.scrollbarSliderHoverBackground;U&&(D+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${U};
				}
			`);const K=F.scrollbarSliderActiveBackground;K&&(D+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${K};
				}
			`)}return D}class ContextMenuHandler{constructor(w,D,O,W){this.contextViewService=w,this.telemetryService=D,this.notificationService=O,this.keybindingService=W,this.focusToReturn=null,this.lastContainer=null,this.block=null,this.blockDisposable=null,this.options={blockMouse:!0}}configure(w){this.options=w}showContextMenu(w){const D=w.getActions();if(!D.length)return;this.focusToReturn=getActiveElement();let O;const W=isHTMLElement(w.domForShadowRoot)?w.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>w.getAnchor(),canRelayout:!1,anchorAlignment:w.anchorAlignment,anchorAxisAlignment:w.anchorAxisAlignment,render:U=>{this.lastContainer=U;const K=w.getMenuClassName?w.getMenuClassName():"";K&&(U.className+=" "+K),this.options.blockMouse&&(this.block=U.appendChild($$8(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",this.blockDisposable?.dispose(),this.blockDisposable=addDisposableListener(this.block,EventType$1.MOUSE_DOWN,Y=>Y.stopPropagation()));const q=new DisposableStore,G=w.actionRunner||new ActionRunner;G.onWillRun(Y=>this.onActionRun(Y,!w.skipTelemetry),this,q),G.onDidRun(this.onDidActionRun,this,q),O=new Menu(U,D,{actionViewItemProvider:w.getActionViewItem,context:w.getActionsContext?w.getActionsContext():null,actionRunner:G,getKeyBinding:w.getKeyBinding?w.getKeyBinding:Y=>this.keybindingService.lookupKeybinding(Y.id)},defaultMenuStyles),O.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,q),O.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,q);const Q=getWindow(U);return q.add(addDisposableListener(Q,EventType$1.BLUR,()=>this.contextViewService.hideContextView(!0))),q.add(addDisposableListener(Q,EventType$1.MOUSE_DOWN,Y=>{if(Y.defaultPrevented)return;const X=new StandardMouseEvent(Q,Y);let J=X.target;if(!X.rightButton){for(;J;){if(J===U)return;J=J.parentElement}this.contextViewService.hideContextView(!0)}})),combinedDisposable(q,O)},focus:()=>{O?.focus(!!w.autoSelectFirstItem)},onHide:U=>{w.onHide?.(!!U),this.block&&(this.block.remove(),this.block=null),this.blockDisposable?.dispose(),this.blockDisposable=null,this.lastContainer&&(getActiveElement()===this.lastContainer||isAncestor$1(getActiveElement(),this.lastContainer))&&this.focusToReturn?.focus(),this.lastContainer=null}},W,!!W)}onActionRun(w,D){D&&this.telemetryService.publicLog2("workbenchActionExecuted",{id:w.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1)}onDidActionRun(w){w.error&&!isCancellationError(w.error)&&this.notificationService.error(w.error)}}var __decorate$x=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$v=function(F,w){return function(D,O){w(D,O,F)}};let ContextMenuService=class extends Disposable{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new ContextMenuHandler(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(w,D,O,W,U,K){super(),this.telemetryService=w,this.notificationService=D,this.contextViewService=O,this.keybindingService=W,this.menuService=U,this.contextKeyService=K,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new Emitter$1),this.onDidShowContextMenu=this._onDidShowContextMenu.event,this._onDidHideContextMenu=this._store.add(new Emitter$1)}configure(w){this.contextMenuHandler.configure(w)}showContextMenu(w){w=ContextMenuMenuDelegate.transform(w,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu({...w,onHide:D=>{w.onHide?.(D),this._onDidHideContextMenu.fire()}}),ModifierKeyEmitter.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};ContextMenuService=__decorate$x([__param$v(0,ITelemetryService),__param$v(1,INotificationService),__param$v(2,IContextViewService),__param$v(3,IKeybindingService),__param$v(4,IMenuService),__param$v(5,IContextKeyService)],ContextMenuService);var ContextMenuMenuDelegate;(function(F){function w(O){return O&&O.menuId instanceof MenuId}function D(O,W,U){if(!w(O))return O;const{menuId:K,menuActionOptions:q,contextKeyService:G}=O;return{...O,getActions:()=>{const Q=[];if(K){const Y=W.getMenuActions(K,G??U,q);createAndFillInContextMenuActions(Y,Q)}return O.getActions?Separator.join(O.getActions(),Q):Q}}}F.transform=D})(ContextMenuMenuDelegate||(ContextMenuMenuDelegate={}));var EditorOpenSource;(function(F){F[F.API=0]="API",F[F.USER=1]="USER"})(EditorOpenSource||(EditorOpenSource={}));var __decorate$w=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$u=function(F,w){return function(D,O){w(D,O,F)}};let CommandOpener=class{constructor(w){this._commandService=w}async open(w,D){if(!matchesScheme(w,Schemas.command))return!1;if(!D?.allowCommands||(typeof w=="string"&&(w=URI.parse(w)),Array.isArray(D.allowCommands)&&!D.allowCommands.includes(w.path)))return!0;let O=[];try{O=parse$1(decodeURIComponent(w.query))}catch{try{O=parse$1(w.query)}catch{}}return Array.isArray(O)||(O=[O]),await this._commandService.executeCommand(w.path,...O),!0}};CommandOpener=__decorate$w([__param$u(0,ICommandService)],CommandOpener);let EditorOpener=class{constructor(w){this._editorService=w}async open(w,D){typeof w=="string"&&(w=URI.parse(w));const{selection:O,uri:W}=extractSelection(w);return w=W,w.scheme===Schemas.file&&(w=normalizePath(w)),await this._editorService.openCodeEditor({resource:w,options:{selection:O,source:D?.fromUserGesture?EditorOpenSource.USER:EditorOpenSource.API,...D?.editorOptions}},this._editorService.getFocusedCodeEditor(),D?.openToSide),!0}};EditorOpener=__decorate$w([__param$u(0,ICodeEditorService)],EditorOpener);let OpenerService=class{constructor(w,D){this._openers=new LinkedList,this._validators=new LinkedList,this._resolvers=new LinkedList,this._resolvedUriTargets=new ResourceMap(O=>O.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new LinkedList,this._defaultExternalOpener={openExternal:async O=>(matchesSomeScheme(O,Schemas.http,Schemas.https)?windowOpenNoOpener(O):mainWindow.location.href=O,!0)},this._openers.push({open:async(O,W)=>W?.openExternal||matchesSomeScheme(O,Schemas.mailto,Schemas.http,Schemas.https,Schemas.vsls)?(await this._doOpenExternal(O,W),!0):!1}),this._openers.push(new CommandOpener(D)),this._openers.push(new EditorOpener(w))}registerOpener(w){return{dispose:this._openers.unshift(w)}}async open(w,D){const O=typeof w=="string"?URI.parse(w):w,W=this._resolvedUriTargets.get(O)??w;for(const U of this._validators)if(!await U.shouldOpen(W,D))return!1;for(const U of this._openers)if(await U.open(w,D))return!0;return!1}async resolveExternalUri(w,D){for(const O of this._resolvers)try{const W=await O.resolveExternalUri(w,D);if(W)return this._resolvedUriTargets.has(W.resolved)||this._resolvedUriTargets.set(W.resolved,w),W}catch{}throw new Error("Could not resolve external URI: "+w.toString())}async _doOpenExternal(w,D){const O=typeof w=="string"?URI.parse(w):w;let W;try{W=(await this.resolveExternalUri(O,D)).resolved}catch{W=O}let U;if(typeof w=="string"&&O.toString()===W.toString()?U=w:U=encodeURI(W.toString(!0)),D?.allowContributedOpeners){const K=typeof D?.allowContributedOpeners=="string"?D?.allowContributedOpeners:void 0;for(const q of this._externalOpeners)if(await q.openExternal(U,{sourceUri:O,preferredOpenerId:K},CancellationToken.None))return!0}return this._defaultExternalOpener.openExternal(U,{sourceUri:O},CancellationToken.None)}dispose(){this._validators.clear()}};OpenerService=__decorate$w([__param$u(0,ICodeEditorService),__param$u(1,ICommandService)],OpenerService);var MarkerSeverity$1;(function(F){F[F.Hint=1]="Hint",F[F.Info=2]="Info",F[F.Warning=4]="Warning",F[F.Error=8]="Error"})(MarkerSeverity$1||(MarkerSeverity$1={}));(function(F){function w(K,q){return q-K}F.compare=w;const D=Object.create(null);D[F.Error]=localize("sev.error","Error"),D[F.Warning]=localize("sev.warning","Warning"),D[F.Info]=localize("sev.info","Info");function O(K){return D[K]||""}F.toString=O;function W(K){switch(K){case Severity$2.Error:return F.Error;case Severity$2.Warning:return F.Warning;case Severity$2.Info:return F.Info;case Severity$2.Ignore:return F.Hint}}F.fromSeverity=W;function U(K){switch(K){case F.Error:return Severity$2.Error;case F.Warning:return Severity$2.Warning;case F.Info:return Severity$2.Info;case F.Hint:return Severity$2.Ignore}}F.toSeverity=U})(MarkerSeverity$1||(MarkerSeverity$1={}));var IMarkerData;(function(F){const w="";function D(W){return O(W,!0)}F.makeKey=D;function O(W,U){const K=[w];return W.source?K.push(W.source.replace("¦","\\¦")):K.push(w),W.code?typeof W.code=="string"?K.push(W.code.replace("¦","\\¦")):K.push(W.code.value.replace("¦","\\¦")):K.push(w),W.severity!==void 0&&W.severity!==null?K.push(MarkerSeverity$1.toString(W.severity)):K.push(w),W.message&&U?K.push(W.message.replace("¦","\\¦")):K.push(w),W.startLineNumber!==void 0&&W.startLineNumber!==null?K.push(W.startLineNumber.toString()):K.push(w),W.startColumn!==void 0&&W.startColumn!==null?K.push(W.startColumn.toString()):K.push(w),W.endLineNumber!==void 0&&W.endLineNumber!==null?K.push(W.endLineNumber.toString()):K.push(w),W.endColumn!==void 0&&W.endColumn!==null?K.push(W.endColumn.toString()):K.push(w),K.push(w),K.join("¦")}F.makeKeyOptionalMessage=O})(IMarkerData||(IMarkerData={}));const IMarkerService=createDecorator("markerService");function diffSets(F,w){const D=[],O=[];for(const W of F)w.has(W)||D.push(W);for(const W of w)F.has(W)||O.push(W);return{removed:D,added:O}}function intersection(F,w){const D=new Set;for(const O of w)F.has(O)&&D.add(O);return D}var __decorate$v=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$t=function(F,w){return function(D,O){w(D,O,F)}};let MarkerDecorationsService=class extends Disposable{constructor(w,D){super(),this._markerService=D,this._onDidChangeMarker=this._register(new Emitter$1),this._markerDecorations=new ResourceMap,w.getModels().forEach(O=>this._onModelAdded(O)),this._register(w.onModelAdded(this._onModelAdded,this)),this._register(w.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(w=>w.dispose()),this._markerDecorations.clear()}getMarker(w,D){const O=this._markerDecorations.get(w);return O&&O.getMarker(D)||null}_handleMarkerChange(w){w.forEach(D=>{const O=this._markerDecorations.get(D);O&&this._updateDecorations(O)})}_onModelAdded(w){const D=new MarkerDecorations(w);this._markerDecorations.set(w.uri,D),this._updateDecorations(D)}_onModelRemoved(w){const D=this._markerDecorations.get(w.uri);D&&(D.dispose(),this._markerDecorations.delete(w.uri)),(w.uri.scheme===Schemas.inMemory||w.uri.scheme===Schemas.internal||w.uri.scheme===Schemas.vscode)&&this._markerService?.read({resource:w.uri}).map(O=>O.owner).forEach(O=>this._markerService.remove(O,[w.uri]))}_updateDecorations(w){const D=this._markerService.read({resource:w.model.uri,take:500});w.update(D)&&this._onDidChangeMarker.fire(w.model)}};MarkerDecorationsService=__decorate$v([__param$t(0,IModelService),__param$t(1,IMarkerService)],MarkerDecorationsService);class MarkerDecorations extends Disposable{constructor(w){super(),this.model=w,this._map=new BidirectionalMap,this._register(toDisposable(()=>{this.model.deltaDecorations([...this._map.values()],[]),this._map.clear()}))}update(w){const{added:D,removed:O}=diffSets(new Set(this._map.keys()),new Set(w));if(D.length===0&&O.length===0)return!1;const W=O.map(q=>this._map.get(q)),U=D.map(q=>({range:this._createDecorationRange(this.model,q),options:this._createDecorationOption(q)})),K=this.model.deltaDecorations(W,U);for(const q of O)this._map.delete(q);for(let q=0;q<K.length;q++)this._map.set(D[q],K[q]);return!0}getMarker(w){return this._map.getKey(w.id)}_createDecorationRange(w,D){let O=Range$2.lift(D);if(D.severity===MarkerSeverity$1.Hint&&!this._hasMarkerTag(D,1)&&!this._hasMarkerTag(D,2)&&(O=O.setEndPosition(O.startLineNumber,O.startColumn+2)),O=w.validateRange(O),O.isEmpty()){const W=w.getLineLastNonWhitespaceColumn(O.startLineNumber)||w.getLineMaxColumn(O.startLineNumber);if(W===1||O.endColumn>=W)return O;const U=w.getWordAtPosition(O.getStartPosition());U&&(O=new Range$2(O.startLineNumber,U.startColumn,O.endLineNumber,U.endColumn))}else if(D.endColumn===Number.MAX_VALUE&&D.startColumn===1&&O.startLineNumber===O.endLineNumber){const W=w.getLineFirstNonWhitespaceColumn(D.startLineNumber);W<O.endColumn&&(O=new Range$2(O.startLineNumber,W,O.endLineNumber,O.endColumn),D.startColumn=W)}return O}_createDecorationOption(w){let D,O,W,U,K;switch(w.severity){case MarkerSeverity$1.Hint:this._hasMarkerTag(w,2)?D=void 0:this._hasMarkerTag(w,1)?D="squiggly-unnecessary":D="squiggly-hint",W=0;break;case MarkerSeverity$1.Info:D="squiggly-info",O=themeColorFromId(overviewRulerInfo),W=10,K={color:themeColorFromId(minimapInfo),position:1};break;case MarkerSeverity$1.Warning:D="squiggly-warning",O=themeColorFromId(overviewRulerWarning),W=20,K={color:themeColorFromId(minimapWarning),position:1};break;case MarkerSeverity$1.Error:default:D="squiggly-error",O=themeColorFromId(overviewRulerError),W=30,K={color:themeColorFromId(minimapError),position:1};break}return w.tags&&(w.tags.indexOf(1)!==-1&&(U="squiggly-inline-unnecessary"),w.tags.indexOf(2)!==-1&&(U="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:D,showIfCollapsed:!0,overviewRuler:{color:O,position:OverviewRulerLane$1.Right},minimap:K,zIndex:W,inlineClassName:U}}_hasMarkerTag(w,D){return w.tags?w.tags.indexOf(D)>=0:!1}}var __decorate$u=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$s=function(F,w){return function(D,O){w(D,O,F)}},ModelService_1;function MODEL_ID(F){return F.toString()}class ModelData{constructor(w,D,O){this.model=w,this._modelEventListeners=new DisposableStore,this.model=w,this._modelEventListeners.add(w.onWillDispose(()=>D(w))),this._modelEventListeners.add(w.onDidChangeLanguage(W=>O(w,W)))}dispose(){this._modelEventListeners.dispose()}}const DEFAULT_EOL=isLinux||isMacintosh?1:2;class DisposedModelInfo{constructor(w,D,O,W,U,K,q,G){this.uri=w,this.initialUndoRedoSnapshot=D,this.time=O,this.sharesUndoRedoStack=W,this.heapSize=U,this.sha1=K,this.versionId=q,this.alternativeVersionId=G}}let ModelService=class extends Disposable{static{ModelService_1=this}static{this.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20*1024*1024}constructor(w,D,O,W){super(),this._configurationService=w,this._resourcePropertiesService=D,this._undoRedoService=O,this._instantiationService=W,this._onModelAdded=this._register(new Emitter$1),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new Emitter$1),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new Emitter$1),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._register(this._configurationService.onDidChangeConfiguration(U=>this._updateModelOptions(U))),this._updateModelOptions(void 0)}static _readModelOptions(w,D){let O=EDITOR_MODEL_DEFAULTS.tabSize;if(w.editor&&typeof w.editor.tabSize<"u"){const J=parseInt(w.editor.tabSize,10);isNaN(J)||(O=J),O<1&&(O=1)}let W="tabSize";if(w.editor&&typeof w.editor.indentSize<"u"&&w.editor.indentSize!=="tabSize"){const J=parseInt(w.editor.indentSize,10);isNaN(J)||(W=Math.max(J,1))}let U=EDITOR_MODEL_DEFAULTS.insertSpaces;w.editor&&typeof w.editor.insertSpaces<"u"&&(U=w.editor.insertSpaces==="false"?!1:!!w.editor.insertSpaces);let K=DEFAULT_EOL;const q=w.eol;q===`\r
`?K=2:q===`
`&&(K=1);let G=EDITOR_MODEL_DEFAULTS.trimAutoWhitespace;w.editor&&typeof w.editor.trimAutoWhitespace<"u"&&(G=w.editor.trimAutoWhitespace==="false"?!1:!!w.editor.trimAutoWhitespace);let Q=EDITOR_MODEL_DEFAULTS.detectIndentation;w.editor&&typeof w.editor.detectIndentation<"u"&&(Q=w.editor.detectIndentation==="false"?!1:!!w.editor.detectIndentation);let Y=EDITOR_MODEL_DEFAULTS.largeFileOptimizations;w.editor&&typeof w.editor.largeFileOptimizations<"u"&&(Y=w.editor.largeFileOptimizations==="false"?!1:!!w.editor.largeFileOptimizations);let X=EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions;return w.editor?.bracketPairColorization&&typeof w.editor.bracketPairColorization=="object"&&(X={enabled:!!w.editor.bracketPairColorization.enabled,independentColorPoolPerBracketType:!!w.editor.bracketPairColorization.independentColorPoolPerBracketType}),{isForSimpleWidget:D,tabSize:O,indentSize:W,insertSpaces:U,detectIndentation:Q,defaultEOL:K,trimAutoWhitespace:G,largeFileOptimizations:Y,bracketPairColorizationOptions:X}}_getEOL(w,D){if(w)return this._resourcePropertiesService.getEOL(w,D);const O=this._configurationService.getValue("files.eol",{overrideIdentifier:D});return O&&typeof O=="string"&&O!=="auto"?O:OS===3||OS===2?`
`:`\r
`}_shouldRestoreUndoStack(){const w=this._configurationService.getValue("files.restoreUndoStack");return typeof w=="boolean"?w:!0}getCreationOptions(w,D,O){const W=typeof w=="string"?w:w.languageId;let U=this._modelCreationOptionsByLanguageAndResource[W+D];if(!U){const K=this._configurationService.getValue("editor",{overrideIdentifier:W,resource:D}),q=this._getEOL(D,W);U=ModelService_1._readModelOptions({editor:K,eol:q},O),this._modelCreationOptionsByLanguageAndResource[W+D]=U}return U}_updateModelOptions(w){const D=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const O=Object.keys(this._models);for(let W=0,U=O.length;W<U;W++){const K=O[W],q=this._models[K],G=q.model.getLanguageId(),Q=q.model.uri;if(w&&!w.affectsConfiguration("editor",{overrideIdentifier:G,resource:Q})&&!w.affectsConfiguration("files.eol",{overrideIdentifier:G,resource:Q}))continue;const Y=D[G+Q],X=this.getCreationOptions(G,Q,q.model.isForSimpleWidget);ModelService_1._setModelOptionsForModel(q.model,X,Y)}}static _setModelOptionsForModel(w,D,O){O&&O.defaultEOL!==D.defaultEOL&&w.getLineCount()===1&&w.setEOL(D.defaultEOL===1?0:1),!(O&&O.detectIndentation===D.detectIndentation&&O.insertSpaces===D.insertSpaces&&O.tabSize===D.tabSize&&O.indentSize===D.indentSize&&O.trimAutoWhitespace===D.trimAutoWhitespace&&equals(O.bracketPairColorizationOptions,D.bracketPairColorizationOptions))&&(D.detectIndentation?(w.detectIndentation(D.insertSpaces,D.tabSize),w.updateOptions({trimAutoWhitespace:D.trimAutoWhitespace,bracketColorizationOptions:D.bracketPairColorizationOptions})):w.updateOptions({insertSpaces:D.insertSpaces,tabSize:D.tabSize,indentSize:D.indentSize,trimAutoWhitespace:D.trimAutoWhitespace,bracketColorizationOptions:D.bracketPairColorizationOptions}))}_insertDisposedModel(w){this._disposedModels.set(MODEL_ID(w.uri),w),this._disposedModelsHeapSize+=w.heapSize}_removeDisposedModel(w){const D=this._disposedModels.get(MODEL_ID(w));return D&&(this._disposedModelsHeapSize-=D.heapSize),this._disposedModels.delete(MODEL_ID(w)),D}_ensureDisposedModelsHeapSize(w){if(this._disposedModelsHeapSize>w){const D=[];for(this._disposedModels.forEach(O=>{O.sharesUndoRedoStack||D.push(O)}),D.sort((O,W)=>O.time-W.time);D.length>0&&this._disposedModelsHeapSize>w;){const O=D.shift();this._removeDisposedModel(O.uri),O.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(O.initialUndoRedoSnapshot)}}}_createModelData(w,D,O,W){const U=this.getCreationOptions(D,O,W),K=this._instantiationService.createInstance(TextModel,w,D,U,O);if(O&&this._disposedModels.has(MODEL_ID(O))){const Q=this._removeDisposedModel(O),Y=this._undoRedoService.getElements(O),X=this._getSHA1Computer(),J=X.canComputeSHA1(K)?X.computeSHA1(K)===Q.sha1:!1;if(J||Q.sharesUndoRedoStack){for(const te of Y.past)isEditStackElement(te)&&te.matchesResource(O)&&te.setModel(K);for(const te of Y.future)isEditStackElement(te)&&te.matchesResource(O)&&te.setModel(K);this._undoRedoService.setElementsValidFlag(O,!0,te=>isEditStackElement(te)&&te.matchesResource(O)),J&&(K._overwriteVersionId(Q.versionId),K._overwriteAlternativeVersionId(Q.alternativeVersionId),K._overwriteInitialUndoRedoSnapshot(Q.initialUndoRedoSnapshot))}else Q.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(Q.initialUndoRedoSnapshot)}const q=MODEL_ID(K.uri);if(this._models[q])throw new Error("ModelService: Cannot add model because it already exists!");const G=new ModelData(K,Q=>this._onWillDispose(Q),(Q,Y)=>this._onDidChangeLanguage(Q,Y));return this._models[q]=G,G}createModel(w,D,O,W=!1){let U;return D?U=this._createModelData(w,D,O,W):U=this._createModelData(w,PLAINTEXT_LANGUAGE_ID,O,W),this._onModelAdded.fire(U.model),U.model}getModels(){const w=[],D=Object.keys(this._models);for(let O=0,W=D.length;O<W;O++){const U=D[O];w.push(this._models[U].model)}return w}getModel(w){const D=MODEL_ID(w),O=this._models[D];return O?O.model:null}_schemaShouldMaintainUndoRedoElements(w){return w.scheme===Schemas.file||w.scheme===Schemas.vscodeRemote||w.scheme===Schemas.vscodeUserData||w.scheme===Schemas.vscodeNotebookCell||w.scheme==="fake-fs"}_onWillDispose(w){const D=MODEL_ID(w.uri),O=this._models[D],W=this._undoRedoService.getUriComparisonKey(w.uri)!==w.uri.toString();let U=!1,K=0;if(W||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(w.uri)){const Q=this._undoRedoService.getElements(w.uri);if(Q.past.length>0||Q.future.length>0){for(const Y of Q.past)isEditStackElement(Y)&&Y.matchesResource(w.uri)&&(U=!0,K+=Y.heapSize(w.uri),Y.setModel(w.uri));for(const Y of Q.future)isEditStackElement(Y)&&Y.matchesResource(w.uri)&&(U=!0,K+=Y.heapSize(w.uri),Y.setModel(w.uri))}}const q=ModelService_1.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK,G=this._getSHA1Computer();if(U)if(!W&&(K>q||!G.canComputeSHA1(w))){const Q=O.model.getInitialUndoRedoSnapshot();Q!==null&&this._undoRedoService.restoreSnapshot(Q)}else this._ensureDisposedModelsHeapSize(q-K),this._undoRedoService.setElementsValidFlag(w.uri,!1,Q=>isEditStackElement(Q)&&Q.matchesResource(w.uri)),this._insertDisposedModel(new DisposedModelInfo(w.uri,O.model.getInitialUndoRedoSnapshot(),Date.now(),W,K,G.computeSHA1(w),w.getVersionId(),w.getAlternativeVersionId()));else if(!W){const Q=O.model.getInitialUndoRedoSnapshot();Q!==null&&this._undoRedoService.restoreSnapshot(Q)}delete this._models[D],O.dispose(),delete this._modelCreationOptionsByLanguageAndResource[w.getLanguageId()+w.uri],this._onModelRemoved.fire(w)}_onDidChangeLanguage(w,D){const O=D.oldLanguage,W=w.getLanguageId(),U=this.getCreationOptions(O,w.uri,w.isForSimpleWidget),K=this.getCreationOptions(W,w.uri,w.isForSimpleWidget);ModelService_1._setModelOptionsForModel(w,K,U),this._onModelModeChanged.fire({model:w,oldLanguageId:O})}_getSHA1Computer(){return new DefaultModelSHA1Computer}};ModelService=ModelService_1=__decorate$u([__param$s(0,IConfigurationService),__param$s(1,ITextResourcePropertiesService),__param$s(2,IUndoRedoService),__param$s(3,IInstantiationService)],ModelService);class DefaultModelSHA1Computer{static{this.MAX_MODEL_SIZE=10*1024*1024}canComputeSHA1(w){return w.getValueLength()<=DefaultModelSHA1Computer.MAX_MODEL_SIZE}computeSHA1(w){const D=new StringSHA1,O=w.createSnapshot();let W;for(;W=O.read();)D.update(W);return D.digest()}}var DefaultQuickAccessFilterValue;(function(F){F[F.PRESERVE=0]="PRESERVE",F[F.LAST=1]="LAST"})(DefaultQuickAccessFilterValue||(DefaultQuickAccessFilterValue={}));const Extensions={Quickaccess:"workbench.contributions.quickaccess"};class QuickAccessRegistry{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(w){return w.prefix.length===0?this.defaultProvider=w:this.providers.push(w),this.providers.sort((D,O)=>O.prefix.length-D.prefix.length),toDisposable(()=>{this.providers.splice(this.providers.indexOf(w),1),this.defaultProvider===w&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return coalesce([this.defaultProvider,...this.providers])}getQuickAccessProvider(w){return w&&this.providers.find(O=>w.startsWith(O.prefix))||void 0||this.defaultProvider}}Registry.add(Extensions.Quickaccess,new QuickAccessRegistry);const NO_KEY_MODS={ctrlCmd:!1,alt:!1};var QuickInputHideReason;(function(F){F[F.Blur=1]="Blur",F[F.Gesture=2]="Gesture",F[F.Other=3]="Other"})(QuickInputHideReason||(QuickInputHideReason={}));var ItemActivation;(function(F){F[F.NONE=0]="NONE",F[F.FIRST=1]="FIRST",F[F.SECOND=2]="SECOND",F[F.LAST=3]="LAST"})(ItemActivation||(ItemActivation={}));var QuickPickFocus;(function(F){F[F.First=1]="First",F[F.Second=2]="Second",F[F.Last=3]="Last",F[F.Next=4]="Next",F[F.Previous=5]="Previous",F[F.NextPage=6]="NextPage",F[F.PreviousPage=7]="PreviousPage",F[F.NextSeparator=8]="NextSeparator",F[F.PreviousSeparator=9]="PreviousSeparator"})(QuickPickFocus||(QuickPickFocus={}));var QuickInputButtonLocation;(function(F){F[F.Title=1]="Title",F[F.Inline=2]="Inline"})(QuickInputButtonLocation||(QuickInputButtonLocation={}));const IQuickInputService=createDecorator("quickInputService");var __decorate$t=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$r=function(F,w){return function(D,O){w(D,O,F)}};let QuickAccessController=class extends Disposable{constructor(w,D){super(),this.quickInputService=w,this.instantiationService=D,this.registry=Registry.as(Extensions.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(w="",D){this.doShowOrPick(w,!1,D)}doShowOrPick(w,D,O){const[W,U]=this.getOrInstantiateProvider(w,O?.enabledProviderPrefixes),K=this.visibleQuickAccess,q=K?.descriptor;if(K&&U&&q===U){w!==U.prefix&&!O?.preserveValue&&(K.picker.value=w),this.adjustValueSelection(K.picker,U,O);return}if(U&&!O?.preserveValue){let ie;if(K&&q&&q!==U){const se=K.value.substr(q.prefix.length);se&&(ie=`${U.prefix}${se}`)}if(!ie){const se=W?.defaultFilterValue;se===DefaultQuickAccessFilterValue.LAST?ie=this.lastAcceptedPickerValues.get(U):typeof se=="string"&&(ie=`${U.prefix}${se}`)}typeof ie=="string"&&(w=ie)}const G=K?.picker?.valueSelection,Q=K?.picker?.value,Y=new DisposableStore,X=Y.add(this.quickInputService.createQuickPick({useSeparators:!0}));X.value=w,this.adjustValueSelection(X,U,O),X.placeholder=O?.placeholder??U?.placeholder,X.quickNavigate=O?.quickNavigateConfiguration,X.hideInput=!!X.quickNavigate&&!K,(typeof O?.itemActivation=="number"||O?.quickNavigateConfiguration)&&(X.itemActivation=O?.itemActivation??ItemActivation.SECOND),X.contextKey=U?.contextKey,X.filterValue=ie=>ie.substring(U?U.prefix.length:0);let J;D&&(J=new DeferredPromise,Y.add(Event$1.once(X.onWillAccept)(ie=>{ie.veto(),X.hide()}))),Y.add(this.registerPickerListeners(X,W,U,w,O));const te=Y.add(new CancellationTokenSource$1);if(W&&Y.add(W.provide(X,te.token,O?.providerOptions)),Event$1.once(X.onDidHide)(()=>{X.selectedItems.length===0&&te.cancel(),Y.dispose(),J?.complete(X.selectedItems.slice(0))}),X.show(),G&&Q===w&&(X.valueSelection=G),D)return J?.p}adjustValueSelection(w,D,O){let W;O?.preserveValue?W=[w.value.length,w.value.length]:W=[D?.prefix.length??0,w.value.length],w.valueSelection=W}registerPickerListeners(w,D,O,W,U){const K=new DisposableStore,q=this.visibleQuickAccess={picker:w,descriptor:O,value:W};return K.add(toDisposable(()=>{q===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),K.add(w.onDidChangeValue(G=>{const[Q]=this.getOrInstantiateProvider(G,U?.enabledProviderPrefixes);Q!==D?this.show(G,{enabledProviderPrefixes:U?.enabledProviderPrefixes,preserveValue:!0,providerOptions:U?.providerOptions}):q.value=G})),O&&K.add(w.onDidAccept(()=>{this.lastAcceptedPickerValues.set(O,w.value)})),K}getOrInstantiateProvider(w,D){const O=this.registry.getQuickAccessProvider(w);if(!O||D&&!D?.includes(O.prefix))return[void 0,void 0];let W=this.mapProviderToDescriptor.get(O);return W||(W=this.instantiationService.createInstance(O.ctor),this.mapProviderToDescriptor.set(O,W)),[W,O]}};QuickAccessController=__decorate$t([__param$r(0,IQuickInputService),__param$r(1,IInstantiationService)],QuickAccessController);var __decorate$s=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U};class LinkedText{constructor(w){this.nodes=w}toString(){return this.nodes.map(w=>typeof w=="string"?w:w.label).join("")}}__decorate$s([memoize],LinkedText.prototype,"toString",null);const LINK_REGEX=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function parseLinkedText(F){const w=[];let D=0,O;for(;O=LINK_REGEX.exec(F);){O.index-D>0&&w.push(F.substring(D,O.index));const[,W,U,,K]=O;K?w.push({label:W,href:U,title:K}):w.push({label:W,href:U}),D=O.index+O[0].length}return D<F.length&&w.push(F.substring(D)),new LinkedText(w)}const iconPathToClass={},iconClassGenerator=new IdGenerator("quick-input-button-icon-");function getIconClass(F){if(!F)return;let w;const D=F.dark.toString();return iconPathToClass[D]?w=iconPathToClass[D]:(w=iconClassGenerator.nextId(),createCSSRule(`.${w}, .hc-light .${w}`,`background-image: ${asCSSUrl(F.light||F.dark)}`),createCSSRule(`.vs-dark .${w}, .hc-black .${w}`,`background-image: ${asCSSUrl(F.dark)}`),iconPathToClass[D]=w),w}function quickInputButtonToAction(F,w,D){let O=F.iconClass||getIconClass(F.iconPath);return F.alwaysVisible&&(O=O?`${O} always-visible`:"always-visible"),{id:w,label:"",tooltip:F.tooltip||"",class:O,enabled:!0,run:D}}function renderQuickInputDescription(F,w,D){reset(w);const O=parseLinkedText(F);let W=0;for(const U of O.nodes)if(typeof U=="string")w.append(...renderLabelWithIcons(U));else{let K=U.title;!K&&U.href.startsWith("command:")?K=localize("executeCommand","Click to execute command '{0}'",U.href.substring(8)):K||(K=U.href);const q=$$8("a",{href:U.href,title:K,tabIndex:W++},U.label);q.style.textDecoration="underline";const G=te=>{isEventLike(te)&&EventHelper.stop(te,!0),D.callback(U.href)},Q=D.disposables.add(new DomEmitter(q,EventType$1.CLICK)).event,Y=D.disposables.add(new DomEmitter(q,EventType$1.KEY_DOWN)).event,X=Event$1.chain(Y,te=>te.filter(ie=>{const se=new StandardKeyboardEvent(ie);return se.equals(10)||se.equals(3)}));D.disposables.add(Gesture.addTarget(q));const J=D.disposables.add(new DomEmitter(q,EventType.Tap)).event;Event$1.any(Q,J,X)(G,null,D.disposables),w.appendChild(q)}}var __decorate$r=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$q=function(F,w){return function(D,O){w(D,O,F)}};const inQuickInputContextKeyValue="inQuickInput",InQuickInputContextKey=new RawContextKey(inQuickInputContextKeyValue,!1,localize("inQuickInput","Whether keyboard focus is inside the quick input control")),inQuickInputContext=ContextKeyExpr.has(inQuickInputContextKeyValue),quickInputTypeContextKeyValue="quickInputType",QuickInputTypeContextKey=new RawContextKey(quickInputTypeContextKeyValue,void 0,localize("quickInputType","The type of the currently visible quick input")),endOfQuickInputBoxContextKeyValue="cursorAtEndOfQuickInputBox",EndOfQuickInputBoxContextKey=new RawContextKey(endOfQuickInputBoxContextKeyValue,!1,localize("cursorAtEndOfQuickInputBox","Whether the cursor in the quick input is at the end of the input box")),endOfQuickInputBoxContext=ContextKeyExpr.has(endOfQuickInputBoxContextKeyValue),backButton={iconClass:ThemeIcon.asClassName(Codicon.quickInputBack),tooltip:localize("quickInput.back","Back")};class QuickInput extends Disposable{static{this.noPromptMessage=localize("inputModeEntry","Press 'Enter' to confirm your input or 'Escape' to cancel")}constructor(w){super(),this.ui=w,this._widgetUpdated=!1,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._leftButtons=[],this._rightButtons=[],this._inlineButtons=[],this.buttonsUpdated=!1,this._toggles=[],this.togglesUpdated=!1,this.noValidationMessage=QuickInput.noPromptMessage,this._severity=Severity$2.Ignore,this.onDidTriggerButtonEmitter=this._register(new Emitter$1),this.onDidHideEmitter=this._register(new Emitter$1),this.onWillHideEmitter=this._register(new Emitter$1),this.onDisposeEmitter=this._register(new Emitter$1),this.visibleDisposables=this._register(new DisposableStore),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(w){this._title=w,this.update()}get description(){return this._description}set description(w){this._description=w,this.update()}get step(){return this._steps}set step(w){this._steps=w,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(w){this._totalSteps=w,this.update()}get enabled(){return this._enabled}set enabled(w){this._enabled=w,this.update()}get contextKey(){return this._contextKey}set contextKey(w){this._contextKey=w,this.update()}get busy(){return this._busy}set busy(w){this._busy=w,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(w){const D=this._ignoreFocusOut!==w&&!isIOS;this._ignoreFocusOut=w&&!isIOS,D&&this.update()}get titleButtons(){return this._leftButtons.length?[...this._leftButtons,this._rightButtons]:this._rightButtons}get buttons(){return[...this._leftButtons,...this._rightButtons,...this._inlineButtons]}set buttons(w){this._leftButtons=w.filter(D=>D===backButton),this._rightButtons=w.filter(D=>D!==backButton&&D.location!==QuickInputButtonLocation.Inline),this._inlineButtons=w.filter(D=>D.location===QuickInputButtonLocation.Inline),this.buttonsUpdated=!0,this.update()}get toggles(){return this._toggles}set toggles(w){this._toggles=w??[],this.togglesUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(w){this._validationMessage=w,this.update()}get severity(){return this._severity}set severity(w){this._severity=w,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(w=>{this.buttons.indexOf(w)!==-1&&this.onDidTriggerButtonEmitter.fire(w)})),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.toggles.length&&(this.togglesUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(w=QuickInputHideReason.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:w})}willHide(w=QuickInputHideReason.Other){this.onWillHideEmitter.fire({reason:w})}update(){if(!this.visible)return;const w=this.getTitle();w&&this.ui.title.textContent!==w?this.ui.title.textContent=w:!w&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText=" ");const D=this.getDescription();if(this.ui.description1.textContent!==D&&(this.ui.description1.textContent=D),this.ui.description2.textContent!==D&&(this.ui.description2.textContent=D),this._widgetUpdated&&(this._widgetUpdated=!1,this._widget?reset(this.ui.widget,this._widget):reset(this.ui.widget)),this.busy&&!this.busyDelay&&(this.busyDelay=new TimeoutTimer,this.busyDelay.setIfNotSet(()=>{this.visible&&this.ui.progressBar.infinite()},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const W=this._leftButtons.map((q,G)=>quickInputButtonToAction(q,`id-${G}`,async()=>this.onDidTriggerButtonEmitter.fire(q)));this.ui.leftActionBar.push(W,{icon:!0,label:!1}),this.ui.rightActionBar.clear();const U=this._rightButtons.map((q,G)=>quickInputButtonToAction(q,`id-${G}`,async()=>this.onDidTriggerButtonEmitter.fire(q)));this.ui.rightActionBar.push(U,{icon:!0,label:!1}),this.ui.inlineActionBar.clear();const K=this._inlineButtons.map((q,G)=>quickInputButtonToAction(q,`id-${G}`,async()=>this.onDidTriggerButtonEmitter.fire(q)));this.ui.inlineActionBar.push(K,{icon:!0,label:!1})}if(this.togglesUpdated){this.togglesUpdated=!1;const W=this.toggles?.filter(U=>U instanceof Toggle)??[];this.ui.inputBox.toggles=W}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const O=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==O&&(this._lastValidationMessage=O,reset(this.ui.message),renderQuickInputDescription(O,this.ui.message,{callback:W=>{this.ui.linkOpenerDelegate(W)},disposables:this.visibleDisposables})),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?localize("quickInput.steps","{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(w){if(this.ui.inputBox.showDecoration(w),w!==Severity$2.Ignore){const D=this.ui.inputBox.stylesForType(w);this.ui.message.style.color=D.foreground?`${D.foreground}`:"",this.ui.message.style.backgroundColor=D.background?`${D.background}`:"",this.ui.message.style.border=D.border?`1px solid ${D.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}}class QuickPick extends QuickInput{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new Emitter$1),this.onWillAcceptEmitter=this._register(new Emitter$1),this.onDidAcceptEmitter=this._register(new Emitter$1),this.onDidCustomEmitter=this._register(new Emitter$1),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._keepScrollPosition=!1,this._itemActivation=ItemActivation.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new Emitter$1),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new Emitter$1),this.onDidTriggerItemButtonEmitter=this._register(new Emitter$1),this.onDidTriggerSeparatorButtonEmitter=this._register(new Emitter$1),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this._focusEventBufferer=new EventBufferer,this.type="quickPick",this.filterValue=w=>w,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event,this.onDidTriggerSeparatorButton=this.onDidTriggerSeparatorButtonEmitter.event}static{this.DEFAULT_ARIA_LABEL=localize("quickInputBox.ariaLabel","Type to narrow down results.")}get quickNavigate(){return this._quickNavigate}set quickNavigate(w){this._quickNavigate=w,this.update()}get value(){return this._value}set value(w){this.doSetValue(w)}doSetValue(w,D){this._value!==w&&(this._value=w,D||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(w){this._ariaLabel=w,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(w){this._placeholder=w,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(w){this.ui.list.scrollTop=w}set items(w){this._items=w,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(w){this._canSelectMany=w,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(w){this._canAcceptInBackground=w}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(w){this._matchOnDescription=w,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(w){this._matchOnDetail=w,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(w){this._matchOnLabel=w,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(w){this._matchOnLabelMode=w,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(w){this._sortByLabel=w,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(w){this._keepScrollPosition=w}get itemActivation(){return this._itemActivation}set itemActivation(w){this._itemActivation=w}get activeItems(){return this._activeItems}set activeItems(w){this._activeItems=w,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(w){this._selectedItems=w,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?NO_KEY_MODS:this.ui.keyMods}get valueSelection(){const w=this.ui.inputBox.getSelection();if(w)return[w.start,w.end]}set valueSelection(w){this._valueSelection=w,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(w){this._customButton=w,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(w){this._customButtonLabel=w,this.update()}get customHover(){return this._customButtonHover}set customHover(w){this._customButtonHover=w,this.update()}get ok(){return this._ok}set ok(w){this._ok=w,this.update()}get hideInput(){return!!this._hideInput}set hideInput(w){this._hideInput=w,this.update()}trySelectFirst(){this.canSelectMany||this.ui.list.focus(QuickPickFocus.First)}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(w=>{this.doSetValue(w,!0)})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this._focusEventBufferer.wrapEvent(this.ui.list.onDidChangeFocus,(w,D)=>D)(w=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&equals$1(w,this._activeItems,(D,O)=>D===O)||(this._activeItems=w,this.onDidChangeActiveEmitter.fire(w))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:w,event:D})=>{if(this.canSelectMany){w.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&equals$1(w,this._selectedItems,(O,W)=>O===W)||(this._selectedItems=w,this.onDidChangeSelectionEmitter.fire(w),w.length&&this.handleAccept(isMouseEvent(D)&&D.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(w=>{!this.canSelectMany||!this.visible||this.selectedItemsToConfirm!==this._selectedItems&&equals$1(w,this._selectedItems,(D,O)=>D===O)||(this._selectedItems=w,this.onDidChangeSelectionEmitter.fire(w))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(w=>this.onDidTriggerItemButtonEmitter.fire(w))),this.visibleDisposables.add(this.ui.list.onSeparatorButtonTriggered(w=>this.onDidTriggerSeparatorButtonEmitter.fire(w))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(w){let D=!1;this.onWillAcceptEmitter.fire({veto:()=>D=!0}),D||this.onDidAcceptEmitter.fire({inBackground:w})}registerQuickNavigation(){return addDisposableListener(this.ui.container,EventType$1.KEY_UP,w=>{if(this.canSelectMany||!this._quickNavigate)return;const D=new StandardKeyboardEvent(w),O=D.keyCode;this._quickNavigate.keybindings.some(K=>{const q=K.getChords();return q.length>1?!1:q[0].shiftKey&&O===4?!(D.ctrlKey||D.altKey||D.metaKey):!!(q[0].altKey&&O===6||q[0].ctrlKey&&O===5||q[0].metaKey&&O===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const w=this.keepScrollPosition?this.scrollTop:0,D=!!this.description,O={title:!!this.title||!!this.step||!!this.titleButtons.length,description:D,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!this._hideInput,progressBar:!this._hideInput||D,visibleCount:!0,count:this.canSelectMany&&!this._hideCountBadge,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(O),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let W=this.ariaLabel;!W&&O.inputBox&&(W=this.placeholder||QuickPick.DEFAULT_ARIA_LABEL,this.title&&(W+=` - ${this.title}`)),this.ui.list.ariaLabel!==W&&(this.ui.list.ariaLabel=W??null),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated&&(this.itemsUpdated=!1,this._focusEventBufferer.bufferEvents(()=>{switch(this.ui.list.setElements(this.items),this.ui.list.shouldLoop=!this.canSelectMany,this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this._itemActivation){case ItemActivation.NONE:this._itemActivation=ItemActivation.FIRST;break;case ItemActivation.SECOND:this.ui.list.focus(QuickPickFocus.Second),this._itemActivation=ItemActivation.FIRST;break;case ItemActivation.LAST:this.ui.list.focus(QuickPickFocus.Last),this._itemActivation=ItemActivation.FIRST;break;default:this.trySelectFirst();break}})),this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",O.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(QuickPickFocus.First)),this.keepScrollPosition&&(this.scrollTop=w)}focus(w){this.ui.list.focus(w),this.canSelectMany&&this.ui.list.domFocus()}accept(w){w&&!this._canAcceptInBackground||this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(w??!1))}}class InputBox extends QuickInput{constructor(){super(...arguments),this._value="",this.valueSelectionUpdated=!0,this._password=!1,this.onDidValueChangeEmitter=this._register(new Emitter$1),this.onDidAcceptEmitter=this._register(new Emitter$1),this.type="inputBox",this.onDidChangeValue=this.onDidValueChangeEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event}get value(){return this._value}set value(w){this._value=w||"",this.update()}get placeholder(){return this._placeholder}set placeholder(w){this._placeholder=w,this.update()}get password(){return this._password}set password(w){this._password=w,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(w=>{w!==this.value&&(this._value=w,this.onDidValueChangeEmitter.fire(w))})),this.visibleDisposables.add(this.ui.onDidAccept(()=>this.onDidAcceptEmitter.fire())),this.valueSelectionUpdated=!0),super.show()}update(){if(!this.visible)return;this.ui.container.classList.remove("hidden-input");const w={title:!!this.title||!!this.step||!!this.titleButtons.length,description:!!this.description||!!this.step,inputBox:!0,message:!0,progressBar:!0};this.ui.setVisibilities(w),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||""),this.ui.inputBox.password!==this.password&&(this.ui.inputBox.password=this.password)}}let QuickInputHoverDelegate=class extends WorkbenchHoverDelegate{constructor(w,D){super("element",!1,O=>this.getOverrideOptions(O),w,D)}getOverrideOptions(w){const D=(isHTMLElement(w.content)?w.content.textContent??"":typeof w.content=="string"?w.content:w.content.value).includes(`
`);return{persistence:{hideOnKeyDown:!1},appearance:{showHoverHint:D,skipFadeInAnimation:!0}}}};QuickInputHoverDelegate=__decorate$r([__param$q(0,IConfigurationService),__param$q(1,IHoverService)],QuickInputHoverDelegate);Color.white.toString(),Color.white.toString();class Button extends Disposable{get onDidClick(){return this._onDidClick.event}constructor(w,D){super(),this._label="",this._onDidClick=this._register(new Emitter$1),this._onDidEscape=this._register(new Emitter$1),this.options=D,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!D.secondary);const O=D.secondary?D.buttonSecondaryBackground:D.buttonBackground,W=D.secondary?D.buttonSecondaryForeground:D.buttonForeground;this._element.style.color=W||"",this._element.style.backgroundColor=O||"",D.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof D.title=="string"&&this.setTitle(D.title),typeof D.ariaLabel=="string"&&this._element.setAttribute("aria-label",D.ariaLabel),w.appendChild(this._element),this._register(Gesture.addTarget(this._element)),[EventType$1.CLICK,EventType.Tap].forEach(U=>{this._register(addDisposableListener(this._element,U,K=>{if(!this.enabled){EventHelper.stop(K);return}this._onDidClick.fire(K)}))}),this._register(addDisposableListener(this._element,EventType$1.KEY_DOWN,U=>{const K=new StandardKeyboardEvent(U);let q=!1;this.enabled&&(K.equals(3)||K.equals(10))?(this._onDidClick.fire(U),q=!0):K.equals(9)&&(this._onDidEscape.fire(U),this._element.blur(),q=!0),q&&EventHelper.stop(K,!0)})),this._register(addDisposableListener(this._element,EventType$1.MOUSE_OVER,U=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(addDisposableListener(this._element,EventType$1.MOUSE_OUT,U=>{this.updateBackground(!1)})),this.focusTracker=this._register(trackFocus(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(w){const D=[];for(let O of renderLabelWithIcons(w))if(typeof O=="string"){if(O=O.trim(),O==="")continue;const W=document.createElement("span");W.textContent=O,D.push(W)}else D.push(O);return D}updateBackground(w){let D;this.options.secondary?D=w?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:D=w?this.options.buttonHoverBackground:this.options.buttonBackground,D&&(this._element.style.backgroundColor=D)}get element(){return this._element}set label(w){if(this._label===w||isMarkdownString(this._label)&&isMarkdownString(w)&&markdownStringEqual(this._label,w))return;this._element.classList.add("monaco-text-button");const D=this.options.supportShortLabel?this._labelElement:this._element;if(isMarkdownString(w)){const W=renderMarkdown(w,{inline:!0});W.dispose();const U=W.element.querySelector("p")?.innerHTML;if(U){const K=sanitize$1(U,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});D.innerHTML=K}else reset(D)}else this.options.supportIcons?reset(D,...this.getContentElements(w)):D.textContent=w;let O="";typeof this.options.title=="string"?O=this.options.title:this.options.title&&(O=renderStringAsPlaintext(w)),this.setTitle(O),typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):this.options.ariaLabel&&this._element.setAttribute("aria-label",O),this._label=w}get label(){return this._label}set icon(w){this._element.classList.add(...ThemeIcon.asClassNameArray(w))}set enabled(w){w?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}setTitle(w){!this._hover&&w!==""?this._hover=this._register(getBaseLayerHoverDelegate().setupManagedHover(this.options.hoverDelegate??getDefaultHoverDelegate("mouse"),this._element,w)):this._hover&&this._hover.update(w)}}class CountBadge{constructor(w,D,O){this.options=D,this.styles=O,this.count=0,this.element=append$1(w,$$8(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(w){this.count=w,this.render()}setTitleFormat(w){this.titleFormat=w,this.render()}render(){this.element.textContent=format(this.countFormat,this.count),this.element.title=format(this.titleFormat,this.count),this.element.style.backgroundColor=this.styles.badgeBackground??"",this.element.style.color=this.styles.badgeForeground??"",this.styles.badgeBorder&&(this.element.style.border=`1px solid ${this.styles.badgeBorder}`)}}const CSS_DONE="done",CSS_ACTIVE="active",CSS_INFINITE="infinite",CSS_INFINITE_LONG_RUNNING="infinite-long-running",CSS_DISCRETE="discrete";class ProgressBar extends Disposable{static{this.LONG_RUNNING_INFINITE_THRESHOLD=1e4}constructor(w,D){super(),this.progressSignal=this._register(new MutableDisposable),this.workedVal=0,this.showDelayedScheduler=this._register(new RunOnceScheduler(()=>show(this.element),0)),this.longRunningScheduler=this._register(new RunOnceScheduler(()=>this.infiniteLongRunning(),ProgressBar.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(w,D)}create(w,D){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),w.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=D?.progressBarBackground||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(CSS_ACTIVE,CSS_INFINITE,CSS_INFINITE_LONG_RUNNING,CSS_DISCRETE),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel(),this.progressSignal.clear()}stop(){return this.doDone(!1)}doDone(w){return this.element.classList.add(CSS_DONE),this.element.classList.contains(CSS_INFINITE)?(this.bit.style.opacity="0",w?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",w?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(CSS_DISCRETE,CSS_DONE,CSS_INFINITE_LONG_RUNNING),this.element.classList.add(CSS_ACTIVE,CSS_INFINITE),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(CSS_INFINITE_LONG_RUNNING)}getContainer(){return this.element}}const $$3=$$8;class QuickInputBox extends Disposable{constructor(w,D,O){super(),this.parent=w,this.onKeyDown=U=>addStandardDisposableListener(this.findInput.inputBox.inputElement,EventType$1.KEY_DOWN,U),this.onDidChange=U=>this.findInput.onDidChange(U),this.container=append$1(this.parent,$$3(".quick-input-box")),this.findInput=this._register(new FindInput(this.container,void 0,{label:"",inputBoxStyles:D,toggleStyles:O}));const W=this.findInput.inputBox.inputElement;W.role="combobox",W.ariaHasPopup="menu",W.ariaAutoComplete="list",W.ariaExpanded="true"}get value(){return this.findInput.getValue()}set value(w){this.findInput.setValue(w)}select(w=null){this.findInput.inputBox.select(w)}getSelection(){return this.findInput.inputBox.getSelection()}isSelectionAtEnd(){return this.findInput.inputBox.isSelectionAtEnd()}get placeholder(){return this.findInput.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(w){this.findInput.inputBox.setPlaceHolder(w)}get password(){return this.findInput.inputBox.inputElement.type==="password"}set password(w){this.findInput.inputBox.inputElement.type=w?"password":"text"}set enabled(w){this.findInput.inputBox.inputElement.toggleAttribute("readonly",!w)}set toggles(w){this.findInput.setAdditionalToggles(w)}setAttribute(w,D){this.findInput.inputBox.inputElement.setAttribute(w,D)}showDecoration(w){w===Severity$2.Ignore?this.findInput.clearMessage():this.findInput.showMessage({type:w===Severity$2.Info?1:w===Severity$2.Warning?2:3,content:""})}stylesForType(w){return this.findInput.inputBox.stylesForType(w===Severity$2.Info?1:w===Severity$2.Warning?2:3)}setFocus(){this.findInput.focus()}layout(){this.findInput.inputBox.layout()}}class PagedRenderer{get templateId(){return this.renderer.templateId}constructor(w,D){this.renderer=w,this.modelProvider=D}renderTemplate(w){return{data:this.renderer.renderTemplate(w),disposable:Disposable.None}}renderElement(w,D,O,W){if(O.disposable?.dispose(),!O.data)return;const U=this.modelProvider();if(U.isResolved(w))return this.renderer.renderElement(U.get(w),w,O.data,W);const K=new CancellationTokenSource$1,q=U.resolve(w,K.token);O.disposable={dispose:()=>K.cancel()},this.renderer.renderPlaceholder(w,O.data),q.then(G=>this.renderer.renderElement(G,w,O.data,W))}disposeTemplate(w){w.disposable&&(w.disposable.dispose(),w.disposable=void 0),w.data&&(this.renderer.disposeTemplate(w.data),w.data=void 0)}}class PagedAccessibilityProvider{constructor(w,D){this.modelProvider=w,this.accessibilityProvider=D}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(w){const D=this.modelProvider();return D.isResolved(w)?this.accessibilityProvider.getAriaLabel(D.get(w)):null}}function fromPagedListOptions(F,w){return{...w,accessibilityProvider:w.accessibilityProvider&&new PagedAccessibilityProvider(F,w.accessibilityProvider)}}class PagedList{constructor(w,D,O,W,U={}){const K=()=>this.model,q=W.map(G=>new PagedRenderer(G,K));this.list=new List(w,D,O,q,fromPagedListOptions(K,U))}updateOptions(w){this.list.updateOptions(w)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return Event$1.map(this.list.onMouseDblClick,({element:w,index:D,browserEvent:O})=>({element:w===void 0?void 0:this._model.get(w),index:D,browserEvent:O}))}get onPointer(){return Event$1.map(this.list.onPointer,({element:w,index:D,browserEvent:O})=>({element:w===void 0?void 0:this._model.get(w),index:D,browserEvent:O}))}get onDidChangeSelection(){return Event$1.map(this.list.onDidChangeSelection,({elements:w,indexes:D,browserEvent:O})=>({elements:w.map(W=>this._model.get(W)),indexes:D,browserEvent:O}))}get model(){return this._model}set model(w){this._model=w,this.list.splice(0,this.list.length,range(w.length))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(w=>this.model.get(w))}style(w){this.list.style(w)}dispose(){this.list.dispose()}}const defaultStyles={separatorBorder:Color.transparent};class ViewItem{set size(w){this._size=w}get size(){return this._size}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(w,D){if(w!==this.visible){w?(this.size=clamp(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof D=="number"?D:this.size,this.size=0),this.container.classList.toggle("visible",w);try{this.view.setVisible?.(w)}catch(O){console.error("Splitview: Failed to set visible view"),console.error(O)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(w){this.container.style.pointerEvents=w?"":"none"}constructor(w,D,O,W){this.container=w,this.view=D,this.disposable=W,this._cachedVisibleSize=void 0,typeof O=="number"?(this._size=O,this._cachedVisibleSize=void 0,w.classList.add("visible")):(this._size=0,this._cachedVisibleSize=O.cachedVisibleSize)}layout(w,D){this.layoutContainer(w);try{this.view.layout(this.size,w,D)}catch(O){console.error("Splitview: Failed to layout view"),console.error(O)}}dispose(){this.disposable.dispose()}}class VerticalViewItem extends ViewItem{layoutContainer(w){this.container.style.top=`${w}px`,this.container.style.height=`${this.size}px`}}class HorizontalViewItem extends ViewItem{layoutContainer(w){this.container.style.left=`${w}px`,this.container.style.width=`${this.size}px`}}var State$2;(function(F){F[F.Idle=0]="Idle",F[F.Busy=1]="Busy"})(State$2||(State$2={}));var Sizing;(function(F){F.Distribute={type:"distribute"};function w(W){return{type:"split",index:W}}F.Split=w;function D(W){return{type:"auto",index:W}}F.Auto=D;function O(W){return{type:"invisible",cachedVisibleSize:W}}F.Invisible=O})(Sizing||(Sizing={}));class SplitView extends Disposable{get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(w){for(const D of this.sashItems)D.sash.orthogonalStartSash=w;this._orthogonalStartSash=w}set orthogonalEndSash(w){for(const D of this.sashItems)D.sash.orthogonalEndSash=w;this._orthogonalEndSash=w}set startSnappingEnabled(w){this._startSnappingEnabled!==w&&(this._startSnappingEnabled=w,this.updateSashEnablement())}set endSnappingEnabled(w){this._endSnappingEnabled!==w&&(this._endSnappingEnabled=w,this.updateSashEnablement())}constructor(w,D={}){super(),this.size=0,this._contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=State$2.Idle,this._onDidSashChange=this._register(new Emitter$1),this._onDidSashReset=this._register(new Emitter$1),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=D.orientation??0,this.inverseAltBehavior=D.inverseAltBehavior??!1,this.proportionalLayout=D.proportionalLayout??!0,this.getSashOrthogonalSize=D.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),w.appendChild(this.el),this.sashContainer=append$1(this.el,$$8(".sash-container")),this.viewContainer=$$8(".split-view-container"),this.scrollable=this._register(new Scrollable({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:W=>scheduleAtNextAnimationFrame(getWindow(this.el),W)})),this.scrollableElement=this._register(new SmoothScrollableElement(this.viewContainer,{vertical:this.orientation===0?D.scrollbarVisibility??1:2,horizontal:this.orientation===1?D.scrollbarVisibility??1:2},this.scrollable));const O=this._register(new DomEmitter(this.viewContainer,"scroll")).event;this._register(O(W=>{const U=this.scrollableElement.getScrollPosition(),K=Math.abs(this.viewContainer.scrollLeft-U.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,q=Math.abs(this.viewContainer.scrollTop-U.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(K!==void 0||q!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:K,scrollTop:q})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(W=>{W.scrollTopChanged&&(this.viewContainer.scrollTop=W.scrollTop),W.scrollLeftChanged&&(this.viewContainer.scrollLeft=W.scrollLeft)})),append$1(this.el,this.scrollableElement.getDomNode()),this.style(D.styles||defaultStyles),D.descriptor&&(this.size=D.descriptor.size,D.descriptor.views.forEach((W,U)=>{const K=isUndefined(W.visible)||W.visible?W.size:{type:"invisible",cachedVisibleSize:W.size},q=W.view;this.doAddView(q,K,U,!0)}),this._contentSize=this.viewItems.reduce((W,U)=>W+U.size,0),this.saveProportions())}style(w){w.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",w.separatorBorder.toString()))}addView(w,D,O=this.viewItems.length,W){this.doAddView(w,D,O,W)}layout(w,D){const O=Math.max(this.size,this._contentSize);if(this.size=w,this.layoutContext=D,this.proportions){let W=0;for(let U=0;U<this.viewItems.length;U++){const K=this.viewItems[U],q=this.proportions[U];typeof q=="number"?W+=q:w-=K.size}for(let U=0;U<this.viewItems.length;U++){const K=this.viewItems[U],q=this.proportions[U];typeof q=="number"&&W>0&&(K.size=clamp(Math.round(q*w/W),K.minimumSize,K.maximumSize))}}else{const W=range(this.viewItems.length),U=W.filter(q=>this.viewItems[q].priority===1),K=W.filter(q=>this.viewItems[q].priority===2);this.resize(this.viewItems.length-1,w-O,void 0,U,K)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(w=>w.proportionalLayout&&w.visible?w.size/this._contentSize:void 0))}onSashStart({sash:w,start:D,alt:O}){for(const q of this.viewItems)q.enabled=!1;const W=this.sashItems.findIndex(q=>q.sash===w),U=combinedDisposable(addDisposableListener(this.el.ownerDocument.body,"keydown",q=>K(this.sashDragState.current,q.altKey)),addDisposableListener(this.el.ownerDocument.body,"keyup",()=>K(this.sashDragState.current,!1))),K=(q,G)=>{const Q=this.viewItems.map(ie=>ie.size);let Y=Number.NEGATIVE_INFINITY,X=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(G=!G),G)if(W===this.sashItems.length-1){const se=this.viewItems[W];Y=(se.minimumSize-se.size)/2,X=(se.maximumSize-se.size)/2}else{const se=this.viewItems[W+1];Y=(se.size-se.maximumSize)/2,X=(se.size-se.minimumSize)/2}let J,te;if(!G){const ie=range(W,-1),se=range(W+1,this.viewItems.length),re=ie.reduce((Ce,we)=>Ce+(this.viewItems[we].minimumSize-Q[we]),0),ae=ie.reduce((Ce,we)=>Ce+(this.viewItems[we].viewMaximumSize-Q[we]),0),le=se.length===0?Number.POSITIVE_INFINITY:se.reduce((Ce,we)=>Ce+(Q[we]-this.viewItems[we].minimumSize),0),de=se.length===0?Number.NEGATIVE_INFINITY:se.reduce((Ce,we)=>Ce+(Q[we]-this.viewItems[we].viewMaximumSize),0),oe=Math.max(re,de),ue=Math.min(le,ae),pe=this.findFirstSnapIndex(ie),fe=this.findFirstSnapIndex(se);if(typeof pe=="number"){const Ce=this.viewItems[pe],we=Math.floor(Ce.viewMinimumSize/2);J={index:pe,limitDelta:Ce.visible?oe-we:oe+we,size:Ce.size}}if(typeof fe=="number"){const Ce=this.viewItems[fe],we=Math.floor(Ce.viewMinimumSize/2);te={index:fe,limitDelta:Ce.visible?ue+we:ue-we,size:Ce.size}}}this.sashDragState={start:q,current:q,index:W,sizes:Q,minDelta:Y,maxDelta:X,alt:G,snapBefore:J,snapAfter:te,disposable:U}};K(D,O)}onSashChange({current:w}){const{index:D,start:O,sizes:W,alt:U,minDelta:K,maxDelta:q,snapBefore:G,snapAfter:Q}=this.sashDragState;this.sashDragState.current=w;const Y=w-O,X=this.resize(D,Y,W,void 0,void 0,K,q,G,Q);if(U){const J=D===this.sashItems.length-1,te=this.viewItems.map(de=>de.size),ie=J?D:D+1,se=this.viewItems[ie],re=se.size-se.maximumSize,ae=se.size-se.minimumSize,le=J?D-1:D+1;this.resize(le,-X,te,void 0,void 0,re,ae)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(w){this._onDidSashChange.fire(w),this.sashDragState.disposable.dispose(),this.saveProportions();for(const D of this.viewItems)D.enabled=!0}onViewChange(w,D){const O=this.viewItems.indexOf(w);O<0||O>=this.viewItems.length||(D=typeof D=="number"?D:w.size,D=clamp(D,w.minimumSize,w.maximumSize),this.inverseAltBehavior&&O>0?(this.resize(O-1,Math.floor((w.size-D)/2)),this.distributeEmptySpace(),this.layoutViews()):(w.size=D,this.relayout([O],void 0)))}resizeView(w,D){if(!(w<0||w>=this.viewItems.length)){if(this.state!==State$2.Idle)throw new Error("Cant modify splitview");this.state=State$2.Busy;try{const O=range(this.viewItems.length).filter(q=>q!==w),W=[...O.filter(q=>this.viewItems[q].priority===1),w],U=O.filter(q=>this.viewItems[q].priority===2),K=this.viewItems[w];D=Math.round(D),D=clamp(D,K.minimumSize,Math.min(K.maximumSize,this.size)),K.size=D,this.relayout(W,U)}finally{this.state=State$2.Idle}}}distributeViewSizes(){const w=[];let D=0;for(const q of this.viewItems)q.maximumSize-q.minimumSize>0&&(w.push(q),D+=q.size);const O=Math.floor(D/w.length);for(const q of w)q.size=clamp(O,q.minimumSize,q.maximumSize);const W=range(this.viewItems.length),U=W.filter(q=>this.viewItems[q].priority===1),K=W.filter(q=>this.viewItems[q].priority===2);this.relayout(U,K)}getViewSize(w){return w<0||w>=this.viewItems.length?-1:this.viewItems[w].size}doAddView(w,D,O=this.viewItems.length,W){if(this.state!==State$2.Idle)throw new Error("Cant modify splitview");this.state=State$2.Busy;try{const U=$$8(".split-view-view");O===this.viewItems.length?this.viewContainer.appendChild(U):this.viewContainer.insertBefore(U,this.viewContainer.children.item(O));const K=w.onDidChange(J=>this.onViewChange(Y,J)),q=toDisposable(()=>U.remove()),G=combinedDisposable(K,q);let Q;typeof D=="number"?Q=D:(D.type==="auto"&&(this.areViewsDistributed()?D={type:"distribute"}:D={type:"split",index:D.index}),D.type==="split"?Q=this.getViewSize(D.index)/2:D.type==="invisible"?Q={cachedVisibleSize:D.cachedVisibleSize}:Q=w.minimumSize);const Y=this.orientation===0?new VerticalViewItem(U,w,Q,G):new HorizontalViewItem(U,w,Q,G);if(this.viewItems.splice(O,0,Y),this.viewItems.length>1){const J={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},te=this.orientation===0?new Sash(this.sashContainer,{getHorizontalSashTop:Ce=>this.getSashPosition(Ce),getHorizontalSashWidth:this.getSashOrthogonalSize},{...J,orientation:1}):new Sash(this.sashContainer,{getVerticalSashLeft:Ce=>this.getSashPosition(Ce),getVerticalSashHeight:this.getSashOrthogonalSize},{...J,orientation:0}),ie=this.orientation===0?Ce=>({sash:te,start:Ce.startY,current:Ce.currentY,alt:Ce.altKey}):Ce=>({sash:te,start:Ce.startX,current:Ce.currentX,alt:Ce.altKey}),re=Event$1.map(te.onDidStart,ie)(this.onSashStart,this),le=Event$1.map(te.onDidChange,ie)(this.onSashChange,this),oe=Event$1.map(te.onDidEnd,()=>this.sashItems.findIndex(Ce=>Ce.sash===te))(this.onSashEnd,this),ue=te.onDidReset(()=>{const Ce=this.sashItems.findIndex(Me=>Me.sash===te),we=range(Ce,-1),Oe=range(Ce+1,this.viewItems.length),Te=this.findFirstSnapIndex(we),Re=this.findFirstSnapIndex(Oe);typeof Te=="number"&&!this.viewItems[Te].visible||typeof Re=="number"&&!this.viewItems[Re].visible||this._onDidSashReset.fire(Ce)}),pe=combinedDisposable(re,le,oe,ue,te),fe={sash:te,disposable:pe};this.sashItems.splice(O-1,0,fe)}U.appendChild(w.element);let X;typeof D!="number"&&D.type==="split"&&(X=[D.index]),W||this.relayout([O],X),!W&&typeof D!="number"&&D.type==="distribute"&&this.distributeViewSizes()}finally{this.state=State$2.Idle}}relayout(w,D){const O=this.viewItems.reduce((W,U)=>W+U.size,0);this.resize(this.viewItems.length-1,this.size-O,void 0,w,D),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(w,D,O=this.viewItems.map(Y=>Y.size),W,U,K=Number.NEGATIVE_INFINITY,q=Number.POSITIVE_INFINITY,G,Q){if(w<0||w>=this.viewItems.length)return 0;const Y=range(w,-1),X=range(w+1,this.viewItems.length);if(U)for(const fe of U)pushToStart(Y,fe),pushToStart(X,fe);if(W)for(const fe of W)pushToEnd(Y,fe),pushToEnd(X,fe);const J=Y.map(fe=>this.viewItems[fe]),te=Y.map(fe=>O[fe]),ie=X.map(fe=>this.viewItems[fe]),se=X.map(fe=>O[fe]),re=Y.reduce((fe,Ce)=>fe+(this.viewItems[Ce].minimumSize-O[Ce]),0),ae=Y.reduce((fe,Ce)=>fe+(this.viewItems[Ce].maximumSize-O[Ce]),0),le=X.length===0?Number.POSITIVE_INFINITY:X.reduce((fe,Ce)=>fe+(O[Ce]-this.viewItems[Ce].minimumSize),0),de=X.length===0?Number.NEGATIVE_INFINITY:X.reduce((fe,Ce)=>fe+(O[Ce]-this.viewItems[Ce].maximumSize),0),oe=Math.max(re,de,K),ue=Math.min(le,ae,q);let pe=!1;if(G){const fe=this.viewItems[G.index],Ce=D>=G.limitDelta;pe=Ce!==fe.visible,fe.setVisible(Ce,G.size)}if(!pe&&Q){const fe=this.viewItems[Q.index],Ce=D<Q.limitDelta;pe=Ce!==fe.visible,fe.setVisible(Ce,Q.size)}if(pe)return this.resize(w,D,O,W,U,K,q);D=clamp(D,oe,ue);for(let fe=0,Ce=D;fe<J.length;fe++){const we=J[fe],Oe=clamp(te[fe]+Ce,we.minimumSize,we.maximumSize),Te=Oe-te[fe];Ce-=Te,we.size=Oe}for(let fe=0,Ce=D;fe<ie.length;fe++){const we=ie[fe],Oe=clamp(se[fe]-Ce,we.minimumSize,we.maximumSize),Te=Oe-se[fe];Ce+=Te,we.size=Oe}return D}distributeEmptySpace(w){const D=this.viewItems.reduce((q,G)=>q+G.size,0);let O=this.size-D;const W=range(this.viewItems.length-1,-1),U=W.filter(q=>this.viewItems[q].priority===1),K=W.filter(q=>this.viewItems[q].priority===2);for(const q of K)pushToStart(W,q);for(const q of U)pushToEnd(W,q);typeof w=="number"&&pushToEnd(W,w);for(let q=0;O!==0&&q<W.length;q++){const G=this.viewItems[W[q]],Q=clamp(G.size+O,G.minimumSize,G.maximumSize),Y=Q-G.size;O-=Y,G.size=Q}}layoutViews(){this._contentSize=this.viewItems.reduce((D,O)=>D+O.size,0);let w=0;for(const D of this.viewItems)D.layout(w,this.layoutContext),w+=D.size;this.sashItems.forEach(D=>D.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let w=!1;const D=this.viewItems.map(G=>w=G.size-G.minimumSize>0||w);w=!1;const O=this.viewItems.map(G=>w=G.maximumSize-G.size>0||w),W=[...this.viewItems].reverse();w=!1;const U=W.map(G=>w=G.size-G.minimumSize>0||w).reverse();w=!1;const K=W.map(G=>w=G.maximumSize-G.size>0||w).reverse();let q=0;for(let G=0;G<this.sashItems.length;G++){const{sash:Q}=this.sashItems[G],Y=this.viewItems[G];q+=Y.size;const X=!(D[G]&&K[G+1]),J=!(O[G]&&U[G+1]);if(X&&J){const te=range(G,-1),ie=range(G+1,this.viewItems.length),se=this.findFirstSnapIndex(te),re=this.findFirstSnapIndex(ie),ae=typeof se=="number"&&!this.viewItems[se].visible,le=typeof re=="number"&&!this.viewItems[re].visible;ae&&U[G]&&(q>0||this.startSnappingEnabled)?Q.state=1:le&&D[G]&&(q<this._contentSize||this.endSnappingEnabled)?Q.state=2:Q.state=0}else X&&!J?Q.state=1:!X&&J?Q.state=2:Q.state=3}}getSashPosition(w){let D=0;for(let O=0;O<this.sashItems.length;O++)if(D+=this.viewItems[O].size,this.sashItems[O].sash===w)return D;return 0}findFirstSnapIndex(w){for(const D of w){const O=this.viewItems[D];if(O.visible&&O.snap)return D}for(const D of w){const O=this.viewItems[D];if(O.visible&&O.maximumSize-O.minimumSize>0)return;if(!O.visible&&O.snap)return D}}areViewsDistributed(){let w,D;for(const O of this.viewItems)if(w=w===void 0?O.size:Math.min(w,O.size),D=D===void 0?O.size:Math.max(D,O.size),D-w>2)return!1;return!0}dispose(){this.sashDragState?.disposable.dispose(),dispose(this.viewItems),this.viewItems=[],this.sashItems.forEach(w=>w.disposable.dispose()),this.sashItems=[],super.dispose()}}class TableListRenderer{static{this.TemplateId="row"}constructor(w,D,O){this.columns=w,this.getColumnSize=O,this.templateId=TableListRenderer.TemplateId,this.renderedTemplates=new Set;const W=new Map(D.map(U=>[U.templateId,U]));this.renderers=[];for(const U of w){const K=W.get(U.templateId);if(!K)throw new Error(`Table cell renderer for template id ${U.templateId} not found.`);this.renderers.push(K)}}renderTemplate(w){const D=append$1(w,$$8(".monaco-table-tr")),O=[],W=[];for(let K=0;K<this.columns.length;K++){const q=this.renderers[K],G=append$1(D,$$8(".monaco-table-td",{"data-col-index":K}));G.style.width=`${this.getColumnSize(K)}px`,O.push(G),W.push(q.renderTemplate(G))}const U={container:w,cellContainers:O,cellTemplateData:W};return this.renderedTemplates.add(U),U}renderElement(w,D,O,W){for(let U=0;U<this.columns.length;U++){const q=this.columns[U].project(w);this.renderers[U].renderElement(q,D,O.cellTemplateData[U],W)}}disposeElement(w,D,O,W){for(let U=0;U<this.columns.length;U++){const K=this.renderers[U];if(K.disposeElement){const G=this.columns[U].project(w);K.disposeElement(G,D,O.cellTemplateData[U],W)}}}disposeTemplate(w){for(let D=0;D<this.columns.length;D++)this.renderers[D].disposeTemplate(w.cellTemplateData[D]);clearNode(w.container),this.renderedTemplates.delete(w)}layoutColumn(w,D){for(const{cellContainers:O}of this.renderedTemplates)O[w].style.width=`${D}px`}}function asListVirtualDelegate(F){return{getHeight(w){return F.getHeight(w)},getTemplateId(){return TableListRenderer.TemplateId}}}class ColumnHeader extends Disposable{get minimumSize(){return this.column.minimumWidth??120}get maximumSize(){return this.column.maximumWidth??Number.POSITIVE_INFINITY}get onDidChange(){return this.column.onDidChangeWidthConstraints??Event$1.None}constructor(w,D){super(),this.column=w,this.index=D,this._onDidLayout=new Emitter$1,this.onDidLayout=this._onDidLayout.event,this.element=$$8(".monaco-table-th",{"data-col-index":D},w.label),w.tooltip&&this._register(getBaseLayerHoverDelegate().setupManagedHover(getDefaultHoverDelegate("mouse"),this.element,w.tooltip))}layout(w){this._onDidLayout.fire([this.index,w])}}class Table{static{this.InstanceCount=0}get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get scrollTop(){return this.list.scrollTop}set scrollTop(w){this.list.scrollTop=w}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}constructor(w,D,O,W,U,K){this.virtualDelegate=O,this.columns=W,this.domId=`table_id_${++Table.InstanceCount}`,this.disposables=new DisposableStore,this.cachedWidth=0,this.cachedHeight=0,this.domNode=append$1(D,$$8(`.monaco-table.${this.domId}`));const q=W.map((Y,X)=>this.disposables.add(new ColumnHeader(Y,X))),G={size:q.reduce((Y,X)=>Y+X.column.weight,0),views:q.map(Y=>({size:Y.column.weight,view:Y}))};this.splitview=this.disposables.add(new SplitView(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:G})),this.splitview.el.style.height=`${O.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${O.headerRowHeight}px`;const Q=new TableListRenderer(W,U,Y=>this.splitview.getViewSize(Y));this.list=this.disposables.add(new List(w,this.domNode,asListVirtualDelegate(O),[Q],K)),Event$1.any(...q.map(Y=>Y.onDidLayout))(([Y,X])=>Q.layoutColumn(Y,X),null,this.disposables),this.splitview.onDidSashReset(Y=>{const X=W.reduce((te,ie)=>te+ie.weight,0),J=W[Y].weight/X*this.cachedWidth;this.splitview.resizeView(Y,J)},null,this.disposables),this.styleElement=createStyleSheet(this.domNode),this.style(unthemedListStyles)}updateOptions(w){this.list.updateOptions(w)}splice(w,D,O=[]){this.list.splice(w,D,O)}getHTMLElement(){return this.domNode}style(w){const D=[];D.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=D.join(`
`),this.list.style(w)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}}var ObjectTreeElementCollapseState;(function(F){F[F.Expanded=0]="Expanded",F[F.Collapsed=1]="Collapsed",F[F.PreserveOrExpanded=2]="PreserveOrExpanded",F[F.PreserveOrCollapsed=3]="PreserveOrCollapsed"})(ObjectTreeElementCollapseState||(ObjectTreeElementCollapseState={}));var TreeMouseEventTarget;(function(F){F[F.Unknown=0]="Unknown",F[F.Twistie=1]="Twistie",F[F.Element=2]="Element",F[F.Filter=3]="Filter"})(TreeMouseEventTarget||(TreeMouseEventTarget={}));class TreeError extends Error{constructor(w,D){super(`TreeError [${w}] ${D}`)}}class WeakMapper{constructor(w){this.fn=w,this._map=new WeakMap}map(w){let D=this._map.get(w);return D||(D=this.fn(w),this._map.set(w,D)),D}}function isFilterResult(F){return typeof F=="object"&&"visibility"in F&&"data"in F}function getVisibleState(F){switch(F){case!0:return 1;case!1:return 0;default:return F}}function isCollapsibleStateUpdate(F){return typeof F.collapsible=="boolean"}class IndexTreeModel{constructor(w,D,O,W={}){this.user=w,this.list=D,this.rootRef=[],this.eventBufferer=new EventBufferer,this._onDidChangeCollapseState=new Emitter$1,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new Emitter$1,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new Emitter$1,this.onDidSplice=this._onDidSplice.event,this.refilterDelayer=new Delayer(MicrotaskDelay),this.collapseByDefault=typeof W.collapseByDefault>"u"?!1:W.collapseByDefault,this.allowNonCollapsibleParents=W.allowNonCollapsibleParents??!1,this.filter=W.filter,this.autoExpandSingleChildren=typeof W.autoExpandSingleChildren>"u"?!1:W.autoExpandSingleChildren,this.root={parent:void 0,element:O,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(w,D,O=Iterable.empty(),W={}){if(w.length===0)throw new TreeError(this.user,"Invalid tree location");W.diffIdentityProvider?this.spliceSmart(W.diffIdentityProvider,w,D,O,W):this.spliceSimple(w,D,O,W)}spliceSmart(w,D,O,W=Iterable.empty(),U,K=U.diffDepth??0){const{parentNode:q}=this.getParentNodeWithListIndex(D);if(!q.lastDiffIds)return this.spliceSimple(D,O,W,U);const G=[...W],Q=D[D.length-1],Y=new LcsDiff({getElements:()=>q.lastDiffIds},{getElements:()=>[...q.children.slice(0,Q),...G,...q.children.slice(Q+O)].map(se=>w.getId(se.element).toString())}).ComputeDiff(!1);if(Y.quitEarly)return q.lastDiffIds=void 0,this.spliceSimple(D,O,G,U);const X=D.slice(0,-1),J=(se,re,ae)=>{if(K>0)for(let le=0;le<ae;le++)se--,re--,this.spliceSmart(w,[...X,se,0],Number.MAX_SAFE_INTEGER,G[re].children,U,K-1)};let te=Math.min(q.children.length,Q+O),ie=G.length;for(const se of Y.changes.sort((re,ae)=>ae.originalStart-re.originalStart))J(te,ie,te-(se.originalStart+se.originalLength)),te=se.originalStart,ie=se.modifiedStart-Q,this.spliceSimple([...X,te],se.originalLength,Iterable.slice(G,ie,ie+se.modifiedLength),U);J(te,ie,te)}spliceSimple(w,D,O=Iterable.empty(),{onDidCreateNode:W,onDidDeleteNode:U,diffIdentityProvider:K}){const{parentNode:q,listIndex:G,revealed:Q,visible:Y}=this.getParentNodeWithListIndex(w),X=[],J=Iterable.map(O,ue=>this.createTreeNode(ue,q,q.visible?1:0,Q,X,W)),te=w[w.length-1];let ie=0;for(let ue=te;ue>=0&&ue<q.children.length;ue--){const pe=q.children[ue];if(pe.visible){ie=pe.visibleChildIndex;break}}const se=[];let re=0,ae=0;for(const ue of J)se.push(ue),ae+=ue.renderNodeCount,ue.visible&&(ue.visibleChildIndex=ie+re++);const le=splice$1(q.children,te,D,se);K?q.lastDiffIds?splice$1(q.lastDiffIds,te,D,se.map(ue=>K.getId(ue.element).toString())):q.lastDiffIds=q.children.map(ue=>K.getId(ue.element).toString()):q.lastDiffIds=void 0;let de=0;for(const ue of le)ue.visible&&de++;if(de!==0)for(let ue=te+se.length;ue<q.children.length;ue++){const pe=q.children[ue];pe.visible&&(pe.visibleChildIndex-=de)}if(q.visibleChildrenCount+=re-de,Q&&Y){const ue=le.reduce((pe,fe)=>pe+(fe.visible?fe.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(q,ae-ue),this.list.splice(G,ue,X)}if(le.length>0&&U){const ue=pe=>{U(pe),pe.children.forEach(ue)};le.forEach(ue)}this._onDidSplice.fire({insertedNodes:se,deletedNodes:le});let oe=q;for(;oe;){if(oe.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}oe=oe.parent}}rerender(w){if(w.length===0)throw new TreeError(this.user,"Invalid tree location");const{node:D,listIndex:O,revealed:W}=this.getTreeNodeWithListIndex(w);D.visible&&W&&this.list.splice(O,1,[D])}has(w){return this.hasTreeNode(w)}getListIndex(w){const{listIndex:D,visible:O,revealed:W}=this.getTreeNodeWithListIndex(w);return O&&W?D:-1}getListRenderCount(w){return this.getTreeNode(w).renderNodeCount}isCollapsible(w){return this.getTreeNode(w).collapsible}setCollapsible(w,D){const O=this.getTreeNode(w);typeof D>"u"&&(D=!O.collapsible);const W={collapsible:D};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(w,W))}isCollapsed(w){return this.getTreeNode(w).collapsed}setCollapsed(w,D,O){const W=this.getTreeNode(w);typeof D>"u"&&(D=!W.collapsed);const U={collapsed:D,recursive:O||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(w,U))}_setCollapseState(w,D){const{node:O,listIndex:W,revealed:U}=this.getTreeNodeWithListIndex(w),K=this._setListNodeCollapseState(O,W,U,D);if(O!==this.root&&this.autoExpandSingleChildren&&K&&!isCollapsibleStateUpdate(D)&&O.collapsible&&!O.collapsed&&!D.recursive){let q=-1;for(let G=0;G<O.children.length;G++)if(O.children[G].visible)if(q>-1){q=-1;break}else q=G;q>-1&&this._setCollapseState([...w,q],D)}return K}_setListNodeCollapseState(w,D,O,W){const U=this._setNodeCollapseState(w,W,!1);if(!O||!w.visible||!U)return U;const K=w.renderNodeCount,q=this.updateNodeAfterCollapseChange(w),G=K-(D===-1?0:1);return this.list.splice(D+1,G,q.slice(1)),U}_setNodeCollapseState(w,D,O){let W;if(w===this.root?W=!1:(isCollapsibleStateUpdate(D)?(W=w.collapsible!==D.collapsible,w.collapsible=D.collapsible):w.collapsible?(W=w.collapsed!==D.collapsed,w.collapsed=D.collapsed):W=!1,W&&this._onDidChangeCollapseState.fire({node:w,deep:O})),!isCollapsibleStateUpdate(D)&&D.recursive)for(const U of w.children)W=this._setNodeCollapseState(U,D,!0)||W;return W}expandTo(w){this.eventBufferer.bufferEvents(()=>{let D=this.getTreeNode(w);for(;D.parent;)D=D.parent,w=w.slice(0,w.length-1),D.collapsed&&this._setCollapseState(w,{collapsed:!1,recursive:!1})})}refilter(){const w=this.root.renderNodeCount,D=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,w,D),this.refilterDelayer.cancel()}createTreeNode(w,D,O,W,U,K){const q={parent:D,element:w.element,children:[],depth:D.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof w.collapsible=="boolean"?w.collapsible:typeof w.collapsed<"u",collapsed:typeof w.collapsed>"u"?this.collapseByDefault:w.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},G=this._filterNode(q,O);q.visibility=G,W&&U.push(q);const Q=w.children||Iterable.empty(),Y=W&&G!==0&&!q.collapsed;let X=0,J=1;for(const te of Q){const ie=this.createTreeNode(te,q,G,Y,U,K);q.children.push(ie),J+=ie.renderNodeCount,ie.visible&&(ie.visibleChildIndex=X++)}return this.allowNonCollapsibleParents||(q.collapsible=q.collapsible||q.children.length>0),q.visibleChildrenCount=X,q.visible=G===2?X>0:G===1,q.visible?q.collapsed||(q.renderNodeCount=J):(q.renderNodeCount=0,W&&U.pop()),K?.(q),q}updateNodeAfterCollapseChange(w){const D=w.renderNodeCount,O=[];return this._updateNodeAfterCollapseChange(w,O),this._updateAncestorsRenderNodeCount(w.parent,O.length-D),O}_updateNodeAfterCollapseChange(w,D){if(w.visible===!1)return 0;if(D.push(w),w.renderNodeCount=1,!w.collapsed)for(const O of w.children)w.renderNodeCount+=this._updateNodeAfterCollapseChange(O,D);return this._onDidChangeRenderNodeCount.fire(w),w.renderNodeCount}updateNodeAfterFilterChange(w){const D=w.renderNodeCount,O=[];return this._updateNodeAfterFilterChange(w,w.visible?1:0,O),this._updateAncestorsRenderNodeCount(w.parent,O.length-D),O}_updateNodeAfterFilterChange(w,D,O,W=!0){let U;if(w!==this.root){if(U=this._filterNode(w,D),U===0)return w.visible=!1,w.renderNodeCount=0,!1;W&&O.push(w)}const K=O.length;w.renderNodeCount=w===this.root?0:1;let q=!1;if(!w.collapsed||U!==0){let G=0;for(const Q of w.children)q=this._updateNodeAfterFilterChange(Q,U,O,W&&!w.collapsed)||q,Q.visible&&(Q.visibleChildIndex=G++);w.visibleChildrenCount=G}else w.visibleChildrenCount=0;return w!==this.root&&(w.visible=U===2?q:U===1,w.visibility=U),w.visible?w.collapsed||(w.renderNodeCount+=O.length-K):(w.renderNodeCount=0,W&&O.pop()),this._onDidChangeRenderNodeCount.fire(w),w.visible}_updateAncestorsRenderNodeCount(w,D){if(D!==0)for(;w;)w.renderNodeCount+=D,this._onDidChangeRenderNodeCount.fire(w),w=w.parent}_filterNode(w,D){const O=this.filter?this.filter.filter(w.element,D):1;return typeof O=="boolean"?(w.filterData=void 0,O?1:0):isFilterResult(O)?(w.filterData=O.data,getVisibleState(O.visibility)):(w.filterData=void 0,getVisibleState(O))}hasTreeNode(w,D=this.root){if(!w||w.length===0)return!0;const[O,...W]=w;return O<0||O>D.children.length?!1:this.hasTreeNode(W,D.children[O])}getTreeNode(w,D=this.root){if(!w||w.length===0)return D;const[O,...W]=w;if(O<0||O>D.children.length)throw new TreeError(this.user,"Invalid tree location");return this.getTreeNode(W,D.children[O])}getTreeNodeWithListIndex(w){if(w.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:D,listIndex:O,revealed:W,visible:U}=this.getParentNodeWithListIndex(w),K=w[w.length-1];if(K<0||K>D.children.length)throw new TreeError(this.user,"Invalid tree location");const q=D.children[K];return{node:q,listIndex:O,revealed:W,visible:U&&q.visible}}getParentNodeWithListIndex(w,D=this.root,O=0,W=!0,U=!0){const[K,...q]=w;if(K<0||K>D.children.length)throw new TreeError(this.user,"Invalid tree location");for(let G=0;G<K;G++)O+=D.children[G].renderNodeCount;return W=W&&!D.collapsed,U=U&&D.visible,q.length===0?{parentNode:D,listIndex:O,revealed:W,visible:U}:this.getParentNodeWithListIndex(q,D.children[K],O+1,W,U)}getNode(w=[]){return this.getTreeNode(w)}getNodeLocation(w){const D=[];let O=w;for(;O.parent;)D.push(O.parent.children.indexOf(O)),O=O.parent;return D.reverse()}getParentNodeLocation(w){if(w.length!==0)return w.length===1?[]:tail2(w)[0]}getFirstElementChild(w){const D=this.getTreeNode(w);if(D.children.length!==0)return D.children[0].element}}class TreeElementsDragAndDropData extends ElementsDragAndDropData{constructor(w){super(w.elements.map(D=>D.element)),this.data=w}}function asTreeDragAndDropData(F){return F instanceof ElementsDragAndDropData?new TreeElementsDragAndDropData(F):F}class TreeNodeListDragAndDrop{constructor(w,D){this.modelProvider=w,this.dnd=D,this.autoExpandDisposable=Disposable.None,this.disposables=new DisposableStore}getDragURI(w){return this.dnd.getDragURI(w.element)}getDragLabel(w,D){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(w.map(O=>O.element),D)}onDragStart(w,D){this.dnd.onDragStart?.(asTreeDragAndDropData(w),D)}onDragOver(w,D,O,W,U,K=!0){const q=this.dnd.onDragOver(asTreeDragAndDropData(w),D&&D.element,O,W,U),G=this.autoExpandNode!==D;if(G&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=D),typeof D>"u")return q;if(G&&typeof q!="boolean"&&q.autoExpand&&(this.autoExpandDisposable=disposableTimeout(()=>{const te=this.modelProvider(),ie=te.getNodeLocation(D);te.isCollapsed(ie)&&te.setCollapsed(ie,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof q=="boolean"||!q.accept||typeof q.bubble>"u"||q.feedback){if(!K){const te=typeof q=="boolean"?q:q.accept,ie=typeof q=="boolean"?void 0:q.effect;return{accept:te,effect:ie,feedback:[O]}}return q}if(q.bubble===1){const te=this.modelProvider(),ie=te.getNodeLocation(D),se=te.getParentNodeLocation(ie),re=te.getNode(se),ae=se&&te.getListIndex(se);return this.onDragOver(w,re,ae,W,U,!1)}const Q=this.modelProvider(),Y=Q.getNodeLocation(D),X=Q.getListIndex(Y),J=Q.getListRenderCount(Y);return{...q,feedback:range(X,X+J)}}drop(w,D,O,W,U){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(asTreeDragAndDropData(w),D&&D.element,O,W,U)}onDragEnd(w){this.dnd.onDragEnd?.(w)}dispose(){this.disposables.dispose(),this.dnd.dispose()}}function asListOptions(F,w){return w&&{...w,identityProvider:w.identityProvider&&{getId(D){return w.identityProvider.getId(D.element)}},dnd:w.dnd&&new TreeNodeListDragAndDrop(F,w.dnd),multipleSelectionController:w.multipleSelectionController&&{isSelectionSingleChangeEvent(D){return w.multipleSelectionController.isSelectionSingleChangeEvent({...D,element:D.element})},isSelectionRangeChangeEvent(D){return w.multipleSelectionController.isSelectionRangeChangeEvent({...D,element:D.element})}},accessibilityProvider:w.accessibilityProvider&&{...w.accessibilityProvider,getSetSize(D){const O=F(),W=O.getNodeLocation(D),U=O.getParentNodeLocation(W);return O.getNode(U).visibleChildrenCount},getPosInSet(D){return D.visibleChildIndex+1},isChecked:w.accessibilityProvider&&w.accessibilityProvider.isChecked?D=>w.accessibilityProvider.isChecked(D.element):void 0,getRole:w.accessibilityProvider&&w.accessibilityProvider.getRole?D=>w.accessibilityProvider.getRole(D.element):()=>"treeitem",getAriaLabel(D){return w.accessibilityProvider.getAriaLabel(D.element)},getWidgetAriaLabel(){return w.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:w.accessibilityProvider&&w.accessibilityProvider.getWidgetRole?()=>w.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:w.accessibilityProvider&&w.accessibilityProvider.getAriaLevel?D=>w.accessibilityProvider.getAriaLevel(D.element):D=>D.depth,getActiveDescendantId:w.accessibilityProvider.getActiveDescendantId&&(D=>w.accessibilityProvider.getActiveDescendantId(D.element))},keyboardNavigationLabelProvider:w.keyboardNavigationLabelProvider&&{...w.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(D){return w.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(D.element)}}}}class ComposedTreeDelegate{constructor(w){this.delegate=w}getHeight(w){return this.delegate.getHeight(w.element)}getTemplateId(w){return this.delegate.getTemplateId(w.element)}hasDynamicHeight(w){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(w.element)}setDynamicHeight(w,D){this.delegate.setDynamicHeight?.(w.element,D)}}var RenderIndentGuides;(function(F){F.None="none",F.OnHover="onHover",F.Always="always"})(RenderIndentGuides||(RenderIndentGuides={}));class EventCollection{get elements(){return this._elements}constructor(w,D=[]){this._elements=D,this.disposables=new DisposableStore,this.onDidChange=Event$1.forEach(w,O=>this._elements=O,this.disposables)}dispose(){this.disposables.dispose()}}class TreeRenderer{static{this.DefaultIndent=8}constructor(w,D,O,W,U,K={}){this.renderer=w,this.modelProvider=D,this.activeNodes=W,this.renderedIndentGuides=U,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=TreeRenderer.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.activeIndentNodes=new Set,this.indentGuidesDisposable=Disposable.None,this.disposables=new DisposableStore,this.templateId=w.templateId,this.updateOptions(K),Event$1.map(O,q=>q.node)(this.onDidChangeNodeTwistieState,this,this.disposables),w.onDidChangeTwistieState?.(this.onDidChangeTwistieState,this,this.disposables)}updateOptions(w={}){if(typeof w.indent<"u"){const D=clamp(w.indent,0,40);if(D!==this.indent){this.indent=D;for(const[O,W]of this.renderedNodes)this.renderTreeElement(O,W)}}if(typeof w.renderIndentGuides<"u"){const D=w.renderIndentGuides!==RenderIndentGuides.None;if(D!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=D;for(const[O,W]of this.renderedNodes)this._renderIndentGuides(O,W);if(this.indentGuidesDisposable.dispose(),D){const O=new DisposableStore;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,O),this.indentGuidesDisposable=O,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof w.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=w.hideTwistiesOfChildlessElements)}renderTemplate(w){const D=append$1(w,$$8(".monaco-tl-row")),O=append$1(D,$$8(".monaco-tl-indent")),W=append$1(D,$$8(".monaco-tl-twistie")),U=append$1(D,$$8(".monaco-tl-contents")),K=this.renderer.renderTemplate(U);return{container:w,indent:O,twistie:W,indentGuidesDisposable:Disposable.None,templateData:K}}renderElement(w,D,O,W){this.renderedNodes.set(w,O),this.renderedElements.set(w.element,w),this.renderTreeElement(w,O),this.renderer.renderElement(w,D,O.templateData,W)}disposeElement(w,D,O,W){O.indentGuidesDisposable.dispose(),this.renderer.disposeElement?.(w,D,O.templateData,W),typeof W=="number"&&(this.renderedNodes.delete(w),this.renderedElements.delete(w.element))}disposeTemplate(w){this.renderer.disposeTemplate(w.templateData)}onDidChangeTwistieState(w){const D=this.renderedElements.get(w);D&&this.onDidChangeNodeTwistieState(D)}onDidChangeNodeTwistieState(w){const D=this.renderedNodes.get(w);D&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(w,D))}renderTreeElement(w,D){const O=TreeRenderer.DefaultIndent+(w.depth-1)*this.indent;D.twistie.style.paddingLeft=`${O}px`,D.indent.style.width=`${O+this.indent-16}px`,w.collapsible?D.container.setAttribute("aria-expanded",String(!w.collapsed)):D.container.removeAttribute("aria-expanded"),D.twistie.classList.remove(...ThemeIcon.asClassNameArray(Codicon.treeItemExpanded));let W=!1;this.renderer.renderTwistie&&(W=this.renderer.renderTwistie(w.element,D.twistie)),w.collapsible&&(!this.hideTwistiesOfChildlessElements||w.visibleChildrenCount>0)?(W||D.twistie.classList.add(...ThemeIcon.asClassNameArray(Codicon.treeItemExpanded)),D.twistie.classList.add("collapsible"),D.twistie.classList.toggle("collapsed",w.collapsed)):D.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(w,D)}_renderIndentGuides(w,D){if(clearNode(D.indent),D.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const O=new DisposableStore,W=this.modelProvider();for(;;){const U=W.getNodeLocation(w),K=W.getParentNodeLocation(U);if(!K)break;const q=W.getNode(K),G=$$8(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(q)&&G.classList.add("active"),D.indent.childElementCount===0?D.indent.appendChild(G):D.indent.insertBefore(G,D.indent.firstElementChild),this.renderedIndentGuides.add(q,G),O.add(toDisposable(()=>this.renderedIndentGuides.delete(q,G))),w=q}D.indentGuidesDisposable=O}_onDidChangeActiveNodes(w){if(!this.shouldRenderIndentGuides)return;const D=new Set,O=this.modelProvider();w.forEach(W=>{const U=O.getNodeLocation(W);try{const K=O.getParentNodeLocation(U);W.collapsible&&W.children.length>0&&!W.collapsed?D.add(W):K&&D.add(O.getNode(K))}catch{}}),this.activeIndentNodes.forEach(W=>{D.has(W)||this.renderedIndentGuides.forEach(W,U=>U.classList.remove("active"))}),D.forEach(W=>{this.activeIndentNodes.has(W)||this.renderedIndentGuides.forEach(W,U=>U.classList.add("active"))}),this.activeIndentNodes=D}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),dispose(this.disposables)}}class FindFilter{get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}constructor(w,D,O){this.tree=w,this.keyboardNavigationLabelProvider=D,this._filter=O,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new DisposableStore,w.onWillRefilter(this.reset,this,this.disposables)}filter(w,D){let O=1;if(this._filter){const K=this._filter.filter(w,D);if(typeof K=="boolean"?O=K?1:0:isFilterResult(K)?O=getVisibleState(K.visibility):O=K,O===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:FuzzyScore.Default,visibility:O};const W=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(w),U=Array.isArray(W)?W:[W];for(const K of U){const q=K&&K.toString();if(typeof q>"u")return{data:FuzzyScore.Default,visibility:O};let G;if(this.tree.findMatchType===TreeFindMatchType.Contiguous){const Q=q.toLowerCase().indexOf(this._lowercasePattern);if(Q>-1){G=[Number.MAX_SAFE_INTEGER,0];for(let Y=this._lowercasePattern.length;Y>0;Y--)G.push(Q+Y-1)}}else G=fuzzyScore(this._pattern,this._lowercasePattern,0,q,q.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(G)return this._matchCount++,U.length===1?{data:G,visibility:O}:{data:{label:q,score:G},visibility:O}}return this.tree.findMode===TreeFindMode.Filter?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(w):2:{data:FuzzyScore.Default,visibility:O}}reset(){this._totalCount=0,this._matchCount=0}dispose(){dispose(this.disposables)}}var TreeFindMode;(function(F){F[F.Highlight=0]="Highlight",F[F.Filter=1]="Filter"})(TreeFindMode||(TreeFindMode={}));var TreeFindMatchType;(function(F){F[F.Fuzzy=0]="Fuzzy",F[F.Contiguous=1]="Contiguous"})(TreeFindMatchType||(TreeFindMatchType={}));class FindController{get pattern(){return this._pattern}get mode(){return this._mode}set mode(w){w!==this._mode&&(this._mode=w,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(w))}get matchType(){return this._matchType}set matchType(w){w!==this._matchType&&(this._matchType=w,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(w))}constructor(w,D,O,W,U,K={}){this.tree=w,this.view=O,this.filter=W,this.contextViewProvider=U,this.options=K,this._pattern="",this.width=0,this._onDidChangeMode=new Emitter$1,this.onDidChangeMode=this._onDidChangeMode.event,this._onDidChangeMatchType=new Emitter$1,this.onDidChangeMatchType=this._onDidChangeMatchType.event,this._onDidChangePattern=new Emitter$1,this._onDidChangeOpenState=new Emitter$1,this.onDidChangeOpenState=this._onDidChangeOpenState.event,this.enabledDisposables=new DisposableStore,this.disposables=new DisposableStore,this._mode=w.options.defaultFindMode??TreeFindMode.Highlight,this._matchType=w.options.defaultFindMatchType??TreeFindMatchType.Fuzzy,D.onDidSplice(this.onDidSpliceModel,this,this.disposables)}updateOptions(w={}){w.defaultFindMode!==void 0&&(this.mode=w.defaultFindMode),w.defaultFindMatchType!==void 0&&(this.matchType=w.defaultFindMatchType)}onDidSpliceModel(){!this.widget||this.pattern.length===0||(this.tree.refilter(),this.render())}render(){const w=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&w?(alert(localize("replFindNoResults","No results")),this.tree.options.showNotFoundMessage??!0?this.widget?.showMessage({type:2,content:localize("not found","No elements found.")}):this.widget?.showMessage({type:2})):(this.widget?.clearMessage(),this.pattern&&alert(localize("replFindResults","{0} results",this.filter.matchCount)))}shouldAllowFocus(w){return!this.widget||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!FuzzyScore.isDefault(w.filterData)}layout(w){this.width=w,this.widget?.layout(w)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}}function stickyScrollNodeStateEquals(F,w){return F.position===w.position&&stickyScrollNodeEquals(F,w)}function stickyScrollNodeEquals(F,w){return F.node.element===w.node.element&&F.startIndex===w.startIndex&&F.height===w.height&&F.endIndex===w.endIndex}class StickyScrollState{constructor(w=[]){this.stickyNodes=w}get count(){return this.stickyNodes.length}equal(w){return equals$1(this.stickyNodes,w.stickyNodes,stickyScrollNodeStateEquals)}lastNodePartiallyVisible(){if(this.count===0)return!1;const w=this.stickyNodes[this.count-1];if(this.count===1)return w.position!==0;const D=this.stickyNodes[this.count-2];return D.position+D.height!==w.position}animationStateChanged(w){if(!equals$1(this.stickyNodes,w.stickyNodes,stickyScrollNodeEquals)||this.count===0)return!1;const D=this.stickyNodes[this.count-1],O=w.stickyNodes[w.count-1];return D.position!==O.position}}class DefaultStickyScrollDelegate{constrainStickyScrollNodes(w,D,O){for(let W=0;W<w.length;W++){const U=w[W];if(U.position+U.height>O||W>=D)return w.slice(0,W)}return w}}class StickyScrollController extends Disposable{constructor(w,D,O,W,U,K={}){super(),this.tree=w,this.model=D,this.view=O,this.treeDelegate=U,this.maxWidgetViewRatio=.4;const q=this.validateStickySettings(K);this.stickyScrollMaxItemCount=q.stickyScrollMaxItemCount,this.stickyScrollDelegate=K.stickyScrollDelegate??new DefaultStickyScrollDelegate,this._widget=this._register(new StickyScrollWidget(O.getScrollableElement(),O,w,W,U,K.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(O.onDidScroll(()=>this.update())),this._register(O.onDidChangeContentHeight(()=>this.update())),this._register(w.onDidChangeCollapseState(()=>this.update())),this.update()}get height(){return this._widget.height}getNodeAtHeight(w){let D;if(w===0?D=this.view.firstVisibleIndex:D=this.view.indexAt(w+this.view.scrollTop),!(D<0||D>=this.view.length))return this.view.element(D)}update(){const w=this.getNodeAtHeight(0);if(!w||this.tree.scrollTop===0){this._widget.setState(void 0);return}const D=this.findStickyState(w);this._widget.setState(D)}findStickyState(w){const D=[];let O=w,W=0,U=this.getNextStickyNode(O,void 0,W);for(;U&&(D.push(U),W+=U.height,!(D.length<=this.stickyScrollMaxItemCount&&(O=this.getNextVisibleNode(U),!O)));)U=this.getNextStickyNode(O,U.node,W);const K=this.constrainStickyNodes(D);return K.length?new StickyScrollState(K):void 0}getNextVisibleNode(w){return this.getNodeAtHeight(w.position+w.height)}getNextStickyNode(w,D,O){const W=this.getAncestorUnderPrevious(w,D);if(W&&!(W===w&&(!this.nodeIsUncollapsedParent(w)||this.nodeTopAlignsWithStickyNodesBottom(w,O))))return this.createStickyScrollNode(W,O)}nodeTopAlignsWithStickyNodesBottom(w,D){const O=this.getNodeIndex(w),W=this.view.getElementTop(O),U=D;return this.view.scrollTop===W-U}createStickyScrollNode(w,D){const O=this.treeDelegate.getHeight(w),{startIndex:W,endIndex:U}=this.getNodeRange(w),K=this.calculateStickyNodePosition(U,D,O);return{node:w,position:K,height:O,startIndex:W,endIndex:U}}getAncestorUnderPrevious(w,D=void 0){let O=w,W=this.getParentNode(O);for(;W;){if(W===D)return O;O=W,W=this.getParentNode(O)}if(D===void 0)return O}calculateStickyNodePosition(w,D,O){let W=this.view.getRelativeTop(w);if(W===null&&this.view.firstVisibleIndex===w&&w+1<this.view.length){const Q=this.treeDelegate.getHeight(this.view.element(w)),Y=this.view.getRelativeTop(w+1);W=Y?Y-Q/this.view.renderHeight:null}if(W===null)return D;const U=this.view.element(w),K=this.treeDelegate.getHeight(U),G=W*this.view.renderHeight+K;return D+O>G&&D<=G?G-O:D}constrainStickyNodes(w){if(w.length===0)return[];const D=this.view.renderHeight*this.maxWidgetViewRatio,O=w[w.length-1];if(w.length<=this.stickyScrollMaxItemCount&&O.position+O.height<=D)return w;const W=this.stickyScrollDelegate.constrainStickyScrollNodes(w,this.stickyScrollMaxItemCount,D);if(!W.length)return[];const U=W[W.length-1];if(W.length>this.stickyScrollMaxItemCount||U.position+U.height>D)throw new Error("stickyScrollDelegate violates constraints");return W}getParentNode(w){const D=this.model.getNodeLocation(w),O=this.model.getParentNodeLocation(D);return O?this.model.getNode(O):void 0}nodeIsUncollapsedParent(w){const D=this.model.getNodeLocation(w);return this.model.getListRenderCount(D)>1}getNodeIndex(w){const D=this.model.getNodeLocation(w);return this.model.getListIndex(D)}getNodeRange(w){const D=this.model.getNodeLocation(w),O=this.model.getListIndex(D);if(O<0)throw new Error("Node not found in tree");const W=this.model.getListRenderCount(D),U=O+W-1;return{startIndex:O,endIndex:U}}nodePositionTopBelowWidget(w){const D=[];let O=this.getParentNode(w);for(;O;)D.push(O),O=this.getParentNode(O);let W=0;for(let U=0;U<D.length&&U<this.stickyScrollMaxItemCount;U++)W+=this.treeDelegate.getHeight(D[U]);return W}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(w={}){if(!w.stickyScrollMaxItemCount)return;const D=this.validateStickySettings(w);this.stickyScrollMaxItemCount!==D.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=D.stickyScrollMaxItemCount,this.update())}validateStickySettings(w){let D=7;return typeof w.stickyScrollMaxItemCount=="number"&&(D=Math.max(w.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:D}}}class StickyScrollWidget{constructor(w,D,O,W,U,K){this.view=D,this.tree=O,this.treeRenderers=W,this.treeDelegate=U,this.accessibilityProvider=K,this._previousElements=[],this._previousStateDisposables=new DisposableStore,this._rootDomNode=$$8(".monaco-tree-sticky-container.empty"),w.appendChild(this._rootDomNode);const q=$$8(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(q),this.stickyScrollFocus=new StickyScrollFocus(this._rootDomNode,D),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}get height(){if(!this._previousState)return 0;const w=this._previousState.stickyNodes[this._previousState.count-1];return w.position+w.height}setState(w){const D=!!this._previousState&&this._previousState.count>0,O=!!w&&w.count>0;if(!D&&!O||D&&O&&this._previousState.equal(w))return;if(D!==O&&this.setVisible(O),!O){this._previousState=void 0,this._previousElements=[],this._previousStateDisposables.clear();return}const W=w.stickyNodes[w.count-1];if(this._previousState&&w.animationStateChanged(this._previousState))this._previousElements[this._previousState.count-1].style.top=`${W.position}px`;else{this._previousStateDisposables.clear();const U=Array(w.count);for(let K=w.count-1;K>=0;K--){const q=w.stickyNodes[K],{element:G,disposable:Q}=this.createElement(q,K,w.count);U[K]=G,this._rootDomNode.appendChild(G),this._previousStateDisposables.add(Q)}this.stickyScrollFocus.updateElements(U,w),this._previousElements=U}this._previousState=w,this._rootDomNode.style.height=`${W.position+W.height}px`}createElement(w,D,O){const W=w.startIndex,U=document.createElement("div");U.style.top=`${w.position}px`,this.tree.options.setRowHeight!==!1&&(U.style.height=`${w.height}px`),this.tree.options.setRowLineHeight!==!1&&(U.style.lineHeight=`${w.height}px`),U.classList.add("monaco-tree-sticky-row"),U.classList.add("monaco-list-row"),U.setAttribute("data-index",`${W}`),U.setAttribute("data-parity",W%2===0?"even":"odd"),U.setAttribute("id",this.view.getElementID(W));const K=this.setAccessibilityAttributes(U,w.node.element,D,O),q=this.treeDelegate.getTemplateId(w.node),G=this.treeRenderers.find(J=>J.templateId===q);if(!G)throw new Error(`No renderer found for template id ${q}`);let Q=w.node;Q===this.tree.getNode(this.tree.getNodeLocation(w.node))&&(Q=new Proxy(w.node,{}));const Y=G.renderTemplate(U);G.renderElement(Q,w.startIndex,Y,w.height);const X=toDisposable(()=>{K.dispose(),G.disposeElement(Q,w.startIndex,Y,w.height),G.disposeTemplate(Y),U.remove()});return{element:U,disposable:X}}setAccessibilityAttributes(w,D,O,W){if(!this.accessibilityProvider)return Disposable.None;this.accessibilityProvider.getSetSize&&w.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(D,O,W))),this.accessibilityProvider.getPosInSet&&w.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(D,O))),this.accessibilityProvider.getRole&&w.setAttribute("role",this.accessibilityProvider.getRole(D)??"treeitem");const U=this.accessibilityProvider.getAriaLabel(D),K=U&&typeof U!="string"?U:constObservable(U),q=autorun(Q=>{const Y=Q.readObservable(K);Y?w.setAttribute("aria-label",Y):w.removeAttribute("aria-label")});typeof U=="string"||U&&w.setAttribute("aria-label",U.get());const G=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(D);return typeof G=="number"&&w.setAttribute("aria-level",`${G}`),w.setAttribute("aria-selected",String(!1)),q}setVisible(w){this._rootDomNode.classList.toggle("empty",!w),w||this.stickyScrollFocus.updateElements([],void 0)}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}}class StickyScrollFocus extends Disposable{get domHasFocus(){return this._domHasFocus}set domHasFocus(w){w!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(w),this._domHasFocus=w)}constructor(w,D){super(),this.container=w,this.view=D,this.focusedIndex=-1,this.elements=[],this._onDidChangeHasFocus=new Emitter$1,this.onDidChangeHasFocus=this._onDidChangeHasFocus.event,this._onContextMenu=new Emitter$1,this.onContextMenu=this._onContextMenu.event,this._domHasFocus=!1,this._register(addDisposableListener(this.container,"focus",()=>this.onFocus())),this._register(addDisposableListener(this.container,"blur",()=>this.onBlur())),this._register(this.view.onDidFocus(()=>this.toggleStickyScrollFocused(!1))),this._register(this.view.onKeyDown(O=>this.onKeyDown(O))),this._register(this.view.onMouseDown(O=>this.onMouseDown(O))),this._register(this.view.onContextMenu(O=>this.handleContextMenu(O)))}handleContextMenu(w){const D=w.browserEvent.target;if(!isStickyScrollContainer(D)&&!isStickyScrollElement(D)){this.focusedLast()&&this.view.domFocus();return}if(!isKeyboardEvent(w.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");const K=this.state.stickyNodes.findIndex(q=>q.node.element===w.element?.element);if(K===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");this.container.focus(),this.setFocus(K);return}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");const W=this.state.stickyNodes[this.focusedIndex].node.element,U=this.elements[this.focusedIndex];this._onContextMenu.fire({element:W,anchor:U,browserEvent:w.browserEvent,isStickyScroll:!0})}onKeyDown(w){if(this.domHasFocus&&this.state){if(w.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),w.preventDefault(),w.stopPropagation();else if(w.key==="ArrowDown"||w.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){const D=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([D]),this.scrollNodeUnderWidget(D,this.state)}else this.setFocusedElement(this.focusedIndex+1);w.preventDefault(),w.stopPropagation()}}}onMouseDown(w){const D=w.browserEvent.target;!isStickyScrollContainer(D)&&!isStickyScrollElement(D)||(w.browserEvent.preventDefault(),w.browserEvent.stopPropagation())}updateElements(w,D){if(D&&D.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(D&&D.count!==w.length)throw new Error("Sticky scroll focus received illigel state");const O=this.focusedIndex;if(this.removeFocus(),this.elements=w,this.state=D,D){const W=clamp(O,0,D.count-1);this.setFocus(W)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=D?0:-1}setFocusedElement(w){const D=this.state;if(!D)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(w),!(w<D.count-1)&&D.lastNodePartiallyVisible()){const O=D.stickyNodes[w];this.scrollNodeUnderWidget(O.endIndex+1,D)}}scrollNodeUnderWidget(w,D){const O=D.stickyNodes[D.count-1],W=D.count>1?D.stickyNodes[D.count-2]:void 0,U=this.view.getElementTop(w),K=W?W.position+W.height+O.height:O.height;this.view.scrollTop=U-K}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return this.state?this.view.getHTMLElement().classList.contains("sticky-scroll-focused"):!1}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(w){if(0>w)throw new Error("addFocus() can not remove focus");if(!this.state&&w>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&w>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");const D=this.focusedIndex;D>=0&&this.toggleElementFocus(this.elements[D],!1),w>=0&&this.toggleElementFocus(this.elements[w],!0),this.focusedIndex=w}toggleElementFocus(w,D){this.toggleElementActiveFocus(w,D&&this.domHasFocus),this.toggleElementPassiveFocus(w,D)}toggleCurrentElementActiveFocus(w){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],w)}toggleElementActiveFocus(w,D){w.classList.toggle("focused",D)}toggleElementPassiveFocus(w,D){w.classList.toggle("passive-focused",D)}toggleStickyScrollFocused(w){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",w)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}}function asTreeMouseEvent$1(F){let w=TreeMouseEventTarget.Unknown;return hasParentWithClass(F.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?w=TreeMouseEventTarget.Twistie:hasParentWithClass(F.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?w=TreeMouseEventTarget.Element:hasParentWithClass(F.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(w=TreeMouseEventTarget.Filter),{browserEvent:F.browserEvent,element:F.element?F.element.element:null,target:w}}function asTreeContextMenuEvent(F){const w=isStickyScrollContainer(F.browserEvent.target);return{element:F.element?F.element.element:null,browserEvent:F.browserEvent,anchor:F.anchor,isStickyScroll:w}}function dfs$1(F,w){w(F),F.children.forEach(D=>dfs$1(D,w))}class Trait{get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}constructor(w,D){this.getFirstViewElementWithTrait=w,this.identityProvider=D,this.nodes=[],this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event}set(w,D){!D?.__forceEvent&&equals$1(this.nodes,w)||this._set(w,!1,D)}_set(w,D,O){if(this.nodes=[...w],this.elements=void 0,this._nodeSet=void 0,!D){const W=this;this._onDidChange.fire({get elements(){return W.get()},browserEvent:O})}}get(){return this.elements||(this.elements=this.nodes.map(w=>w.element)),[...this.elements]}getNodes(){return this.nodes}has(w){return this.nodeSet.has(w)}onDidModelSplice({insertedNodes:w,deletedNodes:D}){if(!this.identityProvider){const G=this.createNodeSet(),Q=Y=>G.delete(Y);D.forEach(Y=>dfs$1(Y,Q)),this.set([...G.values()]);return}const O=new Set,W=G=>O.add(this.identityProvider.getId(G.element).toString());D.forEach(G=>dfs$1(G,W));const U=new Map,K=G=>U.set(this.identityProvider.getId(G.element).toString(),G);w.forEach(G=>dfs$1(G,K));const q=[];for(const G of this.nodes){const Q=this.identityProvider.getId(G.element).toString();if(!O.has(Q))q.push(G);else{const X=U.get(Q);X&&X.visible&&q.push(X)}}if(this.nodes.length>0&&q.length===0){const G=this.getFirstViewElementWithTrait();G&&q.push(G)}this._set(q,!0)}createNodeSet(){const w=new Set;for(const D of this.nodes)w.add(D);return w}}class TreeNodeListMouseController extends MouseController{constructor(w,D,O){super(w),this.tree=D,this.stickyScrollProvider=O}onViewPointer(w){if(isButton(w.browserEvent.target)||isInputElement(w.browserEvent.target)||isMonacoEditor(w.browserEvent.target)||w.browserEvent.isHandledByList)return;const D=w.element;if(!D)return super.onViewPointer(w);if(this.isSelectionRangeChangeEvent(w)||this.isSelectionSingleChangeEvent(w))return super.onViewPointer(w);const O=w.browserEvent.target,W=O.classList.contains("monaco-tl-twistie")||O.classList.contains("monaco-icon-label")&&O.classList.contains("folder-icon")&&w.browserEvent.offsetX<16,U=isStickyScrollElement(w.browserEvent.target);let K=!1;if(U?K=!0:typeof this.tree.expandOnlyOnTwistieClick=="function"?K=this.tree.expandOnlyOnTwistieClick(D.element):K=!!this.tree.expandOnlyOnTwistieClick,U)this.handleStickyScrollMouseEvent(w,D);else{if(K&&!W&&w.browserEvent.detail!==2)return super.onViewPointer(w);if(!this.tree.expandOnDoubleClick&&w.browserEvent.detail===2)return super.onViewPointer(w)}if(D.collapsible&&(!U||W)){const q=this.tree.getNodeLocation(D),G=w.browserEvent.altKey;if(this.tree.setFocus([q]),this.tree.toggleCollapsed(q,G),W){w.browserEvent.isHandledByList=!0;return}}U||super.onViewPointer(w)}handleStickyScrollMouseEvent(w,D){if(isMonacoCustomToggle(w.browserEvent.target)||isActionItem(w.browserEvent.target))return;const O=this.stickyScrollProvider();if(!O)throw new Error("Sticky scroll controller not found");const W=this.list.indexOf(D),U=this.list.getElementTop(W),K=O.nodePositionTopBelowWidget(D);this.tree.scrollTop=U-K,this.list.domFocus(),this.list.setFocus([W]),this.list.setSelection([W])}onDoubleClick(w){w.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||w.browserEvent.isHandledByList||super.onDoubleClick(w)}onMouseDown(w){const D=w.browserEvent.target;if(!isStickyScrollContainer(D)&&!isStickyScrollElement(D)){super.onMouseDown(w);return}}onContextMenu(w){const D=w.browserEvent.target;if(!isStickyScrollContainer(D)&&!isStickyScrollElement(D)){super.onContextMenu(w);return}}}class TreeNodeList extends List{constructor(w,D,O,W,U,K,q,G){super(w,D,O,W,G),this.focusTrait=U,this.selectionTrait=K,this.anchorTrait=q}createMouseController(w){return new TreeNodeListMouseController(this,w.tree,w.stickyScrollProvider)}splice(w,D,O=[]){if(super.splice(w,D,O),O.length===0)return;const W=[],U=[];let K;O.forEach((q,G)=>{this.focusTrait.has(q)&&W.push(w+G),this.selectionTrait.has(q)&&U.push(w+G),this.anchorTrait.has(q)&&(K=w+G)}),W.length>0&&super.setFocus(distinct([...super.getFocus(),...W])),U.length>0&&super.setSelection(distinct([...super.getSelection(),...U])),typeof K=="number"&&super.setAnchor(K)}setFocus(w,D,O=!1){super.setFocus(w,D),O||this.focusTrait.set(w.map(W=>this.element(W)),D)}setSelection(w,D,O=!1){super.setSelection(w,D),O||this.selectionTrait.set(w.map(W=>this.element(W)),D)}setAnchor(w,D=!1){super.setAnchor(w),D||(typeof w>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(w)]))}}class AbstractTree{get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return Event$1.filter(Event$1.map(this.view.onMouseDblClick,asTreeMouseEvent$1),w=>w.target!==TreeMouseEventTarget.Filter)}get onMouseOver(){return Event$1.map(this.view.onMouseOver,asTreeMouseEvent$1)}get onMouseOut(){return Event$1.map(this.view.onMouseOut,asTreeMouseEvent$1)}get onContextMenu(){return Event$1.any(Event$1.filter(Event$1.map(this.view.onContextMenu,asTreeContextMenuEvent),w=>!w.isStickyScroll),this.stickyScrollController?.onContextMenu??Event$1.None)}get onPointer(){return Event$1.map(this.view.onPointer,asTreeMouseEvent$1)}get onKeyDown(){return this.view.onKeyDown}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return Event$1.signal(this.model.onDidSplice)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get findMode(){return this.findController?.mode??TreeFindMode.Highlight}set findMode(w){this.findController&&(this.findController.mode=w)}get findMatchType(){return this.findController?.matchType??TreeFindMatchType.Fuzzy}set findMatchType(w){this.findController&&(this.findController.matchType=w)}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}constructor(w,D,O,W,U={}){this._user=w,this._options=U,this.eventBufferer=new EventBufferer,this.onDidChangeFindOpenState=Event$1.None,this.onDidChangeStickyScrollFocused=Event$1.None,this.disposables=new DisposableStore,this._onWillRefilter=new Emitter$1,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new Emitter$1,this.treeDelegate=new ComposedTreeDelegate(O);const K=new Relay,q=new Relay,G=this.disposables.add(new EventCollection(q.event)),Q=new SetMap;this.renderers=W.map(ie=>new TreeRenderer(ie,()=>this.model,K.event,G,Q,U));for(const ie of this.renderers)this.disposables.add(ie);let Y;U.keyboardNavigationLabelProvider&&(Y=new FindFilter(this,U.keyboardNavigationLabelProvider,U.filter),U={...U,filter:Y},this.disposables.add(Y)),this.focus=new Trait(()=>this.view.getFocusedElements()[0],U.identityProvider),this.selection=new Trait(()=>this.view.getSelectedElements()[0],U.identityProvider),this.anchor=new Trait(()=>this.view.getAnchorElement(),U.identityProvider),this.view=new TreeNodeList(w,D,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...asListOptions(()=>this.model,U),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.model=this.createModel(w,this.view,U),K.input=this.model.onDidChangeCollapseState;const X=Event$1.forEach(this.model.onDidSplice,ie=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(ie),this.selection.onDidModelSplice(ie)})},this.disposables);X(()=>null,null,this.disposables);const J=this.disposables.add(new Emitter$1),te=this.disposables.add(new Delayer(0));if(this.disposables.add(Event$1.any(X,this.focus.onDidChange,this.selection.onDidChange)(()=>{te.trigger(()=>{const ie=new Set;for(const se of this.focus.getNodes())ie.add(se);for(const se of this.selection.getNodes())ie.add(se);J.fire([...ie.values()])})})),q.input=J.event,U.keyboardSupport!==!1){const ie=Event$1.chain(this.view.onKeyDown,se=>se.filter(re=>!isInputElement(re.target)).map(re=>new StandardKeyboardEvent(re)));Event$1.chain(ie,se=>se.filter(re=>re.keyCode===15))(this.onLeftArrow,this,this.disposables),Event$1.chain(ie,se=>se.filter(re=>re.keyCode===17))(this.onRightArrow,this,this.disposables),Event$1.chain(ie,se=>se.filter(re=>re.keyCode===10))(this.onSpace,this,this.disposables)}if((U.findWidgetEnabled??!0)&&U.keyboardNavigationLabelProvider&&U.contextViewProvider){const ie=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new FindController(this,this.model,this.view,Y,U.contextViewProvider,ie),this.focusNavigationFilter=se=>this.findController.shouldAllowFocus(se),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindMode=Event$1.None,this.onDidChangeFindMatchType=Event$1.None;U.enableStickyScroll&&(this.stickyScrollController=new StickyScrollController(this,this.model,this.view,this.renderers,this.treeDelegate,U),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=createStyleSheet(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===RenderIndentGuides.Always)}updateOptions(w={}){this._options={...this._options,...w};for(const D of this.renderers)D.updateOptions(w);this.view.updateOptions(this._options),this.findController?.updateOptions(w),this.updateStickyScroll(w),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===RenderIndentGuides.Always)}get options(){return this._options}updateStickyScroll(w){!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new StickyScrollController(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=Event$1.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),this.stickyScrollController?.updateOptions(w)}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(w){this.view.scrollTop=w}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(w){this.view.ariaLabel=w}domFocus(){this.stickyScrollController?.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}layout(w,D){this.view.layout(w,D),isNumber$1(D)&&this.findController?.layout(D)}style(w){const D=`.${this.view.domId}`,O=[];w.treeIndentGuidesStroke&&(O.push(`.monaco-list${D}:hover .monaco-tl-indent > .indent-guide, .monaco-list${D}.always .monaco-tl-indent > .indent-guide  { border-color: ${w.treeInactiveIndentGuidesStroke}; }`),O.push(`.monaco-list${D} .monaco-tl-indent > .indent-guide.active { border-color: ${w.treeIndentGuidesStroke}; }`));const W=w.treeStickyScrollBackground??w.listBackground;W&&(O.push(`.monaco-list${D} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${W}; }`),O.push(`.monaco-list${D} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${W}; }`)),w.treeStickyScrollBorder&&O.push(`.monaco-list${D} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${w.treeStickyScrollBorder}; }`),w.treeStickyScrollShadow&&O.push(`.monaco-list${D} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${w.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),w.listFocusForeground&&(O.push(`.monaco-list${D}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${w.listFocusForeground}; }`),O.push(`.monaco-list${D}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));const U=asCssValueWithDefault(w.listFocusAndSelectionOutline,asCssValueWithDefault(w.listSelectionOutline,w.listFocusOutline??""));U&&(O.push(`.monaco-list${D}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${U}; outline-offset: -1px;}`),O.push(`.monaco-list${D}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),w.listFocusOutline&&(O.push(`.monaco-list${D}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${w.listFocusOutline}; outline-offset: -1px; }`),O.push(`.monaco-list${D}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),O.push(`.monaco-workbench.context-menu-visible .monaco-list${D}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${w.listFocusOutline}; outline-offset: -1px; }`),O.push(`.monaco-workbench.context-menu-visible .monaco-list${D}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),O.push(`.monaco-workbench.context-menu-visible .monaco-list${D}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=O.join(`
`),this.view.style(w)}getParentElement(w){const D=this.model.getParentNodeLocation(w);return this.model.getNode(D).element}getFirstElementChild(w){return this.model.getFirstElementChild(w)}getNode(w){return this.model.getNode(w)}getNodeLocation(w){return this.model.getNodeLocation(w)}collapse(w,D=!1){return this.model.setCollapsed(w,!0,D)}expand(w,D=!1){return this.model.setCollapsed(w,!1,D)}toggleCollapsed(w,D=!1){return this.model.setCollapsed(w,void 0,D)}isCollapsible(w){return this.model.isCollapsible(w)}setCollapsible(w,D){return this.model.setCollapsible(w,D)}isCollapsed(w){return this.model.isCollapsed(w)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(w,D){this.eventBufferer.bufferEvents(()=>{const O=w.map(U=>this.model.getNode(U));this.selection.set(O,D);const W=w.map(U=>this.model.getListIndex(U)).filter(U=>U>-1);this.view.setSelection(W,D,!0)})}getSelection(){return this.selection.get()}setFocus(w,D){this.eventBufferer.bufferEvents(()=>{const O=w.map(U=>this.model.getNode(U));this.focus.set(O,D);const W=w.map(U=>this.model.getListIndex(U)).filter(U=>U>-1);this.view.setFocus(W,D,!0)})}focusNext(w=1,D=!1,O,W=isKeyboardEvent(O)&&O.altKey?void 0:this.focusNavigationFilter){this.view.focusNext(w,D,O,W)}focusPrevious(w=1,D=!1,O,W=isKeyboardEvent(O)&&O.altKey?void 0:this.focusNavigationFilter){this.view.focusPrevious(w,D,O,W)}focusNextPage(w,D=isKeyboardEvent(w)&&w.altKey?void 0:this.focusNavigationFilter){return this.view.focusNextPage(w,D)}focusPreviousPage(w,D=isKeyboardEvent(w)&&w.altKey?void 0:this.focusNavigationFilter){return this.view.focusPreviousPage(w,D,()=>this.stickyScrollController?.height??0)}focusLast(w,D=isKeyboardEvent(w)&&w.altKey?void 0:this.focusNavigationFilter){this.view.focusLast(w,D)}focusFirst(w,D=isKeyboardEvent(w)&&w.altKey?void 0:this.focusNavigationFilter){this.view.focusFirst(w,D)}getFocus(){return this.focus.get()}reveal(w,D){this.model.expandTo(w);const O=this.model.getListIndex(w);if(O!==-1)if(!this.stickyScrollController)this.view.reveal(O,D);else{const W=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(w));this.view.reveal(O,D,W)}}onLeftArrow(w){w.preventDefault(),w.stopPropagation();const D=this.view.getFocusedElements();if(D.length===0)return;const O=D[0],W=this.model.getNodeLocation(O);if(!this.model.setCollapsed(W,!0)){const K=this.model.getParentNodeLocation(W);if(!K)return;const q=this.model.getListIndex(K);this.view.reveal(q),this.view.setFocus([q])}}onRightArrow(w){w.preventDefault(),w.stopPropagation();const D=this.view.getFocusedElements();if(D.length===0)return;const O=D[0],W=this.model.getNodeLocation(O);if(!this.model.setCollapsed(W,!1)){if(!O.children.some(G=>G.visible))return;const[K]=this.view.getFocus(),q=K+1;this.view.reveal(q),this.view.setFocus([q])}}onSpace(w){w.preventDefault(),w.stopPropagation();const D=this.view.getFocusedElements();if(D.length===0)return;const O=D[0],W=this.model.getNodeLocation(O),U=w.browserEvent.altKey;this.model.setCollapsed(W,void 0,U)}dispose(){dispose(this.disposables),this.stickyScrollController?.dispose(),this.view.dispose()}}class ObjectTreeModel{constructor(w,D,O={}){this.user=w,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new IndexTreeModel(w,D,null,O),this.onDidSplice=this.model.onDidSplice,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,O.sorter&&(this.sorter={compare(W,U){return O.sorter.compare(W.element,U.element)}}),this.identityProvider=O.identityProvider}setChildren(w,D=Iterable.empty(),O={}){const W=this.getElementLocation(w);this._setChildren(W,this.preserveCollapseState(D),O)}_setChildren(w,D=Iterable.empty(),O){const W=new Set,U=new Set,K=G=>{if(G.element===null)return;const Q=G;if(W.add(Q.element),this.nodes.set(Q.element,Q),this.identityProvider){const Y=this.identityProvider.getId(Q.element).toString();U.add(Y),this.nodesByIdentity.set(Y,Q)}O.onDidCreateNode?.(Q)},q=G=>{if(G.element===null)return;const Q=G;if(W.has(Q.element)||this.nodes.delete(Q.element),this.identityProvider){const Y=this.identityProvider.getId(Q.element).toString();U.has(Y)||this.nodesByIdentity.delete(Y)}O.onDidDeleteNode?.(Q)};this.model.splice([...w,0],Number.MAX_VALUE,D,{...O,onDidCreateNode:K,onDidDeleteNode:q})}preserveCollapseState(w=Iterable.empty()){return this.sorter&&(w=[...w].sort(this.sorter.compare.bind(this.sorter))),Iterable.map(w,D=>{let O=this.nodes.get(D.element);if(!O&&this.identityProvider){const K=this.identityProvider.getId(D.element).toString();O=this.nodesByIdentity.get(K)}if(!O){let K;return typeof D.collapsed>"u"?K=void 0:D.collapsed===ObjectTreeElementCollapseState.Collapsed||D.collapsed===ObjectTreeElementCollapseState.PreserveOrCollapsed?K=!0:D.collapsed===ObjectTreeElementCollapseState.Expanded||D.collapsed===ObjectTreeElementCollapseState.PreserveOrExpanded?K=!1:K=!!D.collapsed,{...D,children:this.preserveCollapseState(D.children),collapsed:K}}const W=typeof D.collapsible=="boolean"?D.collapsible:O.collapsible;let U;return typeof D.collapsed>"u"||D.collapsed===ObjectTreeElementCollapseState.PreserveOrCollapsed||D.collapsed===ObjectTreeElementCollapseState.PreserveOrExpanded?U=O.collapsed:D.collapsed===ObjectTreeElementCollapseState.Collapsed?U=!0:D.collapsed===ObjectTreeElementCollapseState.Expanded?U=!1:U=!!D.collapsed,{...D,collapsible:W,collapsed:U,children:this.preserveCollapseState(D.children)}})}rerender(w){const D=this.getElementLocation(w);this.model.rerender(D)}getFirstElementChild(w=null){const D=this.getElementLocation(w);return this.model.getFirstElementChild(D)}has(w){return this.nodes.has(w)}getListIndex(w){const D=this.getElementLocation(w);return this.model.getListIndex(D)}getListRenderCount(w){const D=this.getElementLocation(w);return this.model.getListRenderCount(D)}isCollapsible(w){const D=this.getElementLocation(w);return this.model.isCollapsible(D)}setCollapsible(w,D){const O=this.getElementLocation(w);return this.model.setCollapsible(O,D)}isCollapsed(w){const D=this.getElementLocation(w);return this.model.isCollapsed(D)}setCollapsed(w,D,O){const W=this.getElementLocation(w);return this.model.setCollapsed(W,D,O)}expandTo(w){const D=this.getElementLocation(w);this.model.expandTo(D)}refilter(){this.model.refilter()}getNode(w=null){if(w===null)return this.model.getNode(this.model.rootRef);const D=this.nodes.get(w);if(!D)throw new TreeError(this.user,`Tree element not found: ${w}`);return D}getNodeLocation(w){return w.element}getParentNodeLocation(w){if(w===null)throw new TreeError(this.user,"Invalid getParentNodeLocation call");const D=this.nodes.get(w);if(!D)throw new TreeError(this.user,`Tree element not found: ${w}`);const O=this.model.getNodeLocation(D),W=this.model.getParentNodeLocation(O);return this.model.getNode(W).element}getElementLocation(w){if(w===null)return[];const D=this.nodes.get(w);if(!D)throw new TreeError(this.user,`Tree element not found: ${w}`);return this.model.getNodeLocation(D)}}function noCompress(F){const w=[F.element],D=F.incompressible||!1;return{element:{elements:w,incompressible:D},children:Iterable.map(Iterable.from(F.children),noCompress),collapsible:F.collapsible,collapsed:F.collapsed}}function compress(F){const w=[F.element],D=F.incompressible||!1;let O,W;for(;[W,O]=Iterable.consume(Iterable.from(F.children),2),!(W.length!==1||W[0].incompressible);)F=W[0],w.push(F.element);return{element:{elements:w,incompressible:D},children:Iterable.map(Iterable.concat(W,O),compress),collapsible:F.collapsible,collapsed:F.collapsed}}function _decompress(F,w=0){let D;return w<F.element.elements.length-1?D=[_decompress(F,w+1)]:D=Iterable.map(Iterable.from(F.children),O=>_decompress(O,0)),w===0&&F.element.incompressible?{element:F.element.elements[w],children:D,incompressible:!0,collapsible:F.collapsible,collapsed:F.collapsed}:{element:F.element.elements[w],children:D,collapsible:F.collapsible,collapsed:F.collapsed}}function decompress(F){return _decompress(F,0)}function splice(F,w,D){return F.element===w?{...F,children:D}:{...F,children:Iterable.map(Iterable.from(F.children),O=>splice(O,w,D))}}const wrapIdentityProvider=F=>({getId(w){return w.elements.map(D=>F.getId(D).toString()).join("\0")}});class CompressedObjectTreeModel{get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}constructor(w,D,O={}){this.user=w,this.rootRef=null,this.nodes=new Map,this.model=new ObjectTreeModel(w,D,O),this.enabled=typeof O.compressionEnabled>"u"?!0:O.compressionEnabled,this.identityProvider=O.identityProvider}setChildren(w,D=Iterable.empty(),O){const W=O.diffIdentityProvider&&wrapIdentityProvider(O.diffIdentityProvider);if(w===null){const ie=Iterable.map(D,this.enabled?compress:noCompress);this._setChildren(null,ie,{diffIdentityProvider:W,diffDepth:1/0});return}const U=this.nodes.get(w);if(!U)throw new TreeError(this.user,"Unknown compressed tree node");const K=this.model.getNode(U),q=this.model.getParentNodeLocation(U),G=this.model.getNode(q),Q=decompress(K),Y=splice(Q,w,D),X=(this.enabled?compress:noCompress)(Y),J=O.diffIdentityProvider?(ie,se)=>O.diffIdentityProvider.getId(ie)===O.diffIdentityProvider.getId(se):void 0;if(equals$1(X.element.elements,K.element.elements,J)){this._setChildren(U,X.children||Iterable.empty(),{diffIdentityProvider:W,diffDepth:1});return}const te=G.children.map(ie=>ie===K?X:ie);this._setChildren(G.element,te,{diffIdentityProvider:W,diffDepth:K.depth-G.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(w){if(w===this.enabled)return;this.enabled=w;const O=this.model.getNode().children,W=Iterable.map(O,decompress),U=Iterable.map(W,w?compress:noCompress);this._setChildren(null,U,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(w,D,O){const W=new Set,U=q=>{for(const G of q.element.elements)W.add(G),this.nodes.set(G,q.element)},K=q=>{for(const G of q.element.elements)W.has(G)||this.nodes.delete(G)};this.model.setChildren(w,D,{...O,onDidCreateNode:U,onDidDeleteNode:K})}has(w){return this.nodes.has(w)}getListIndex(w){const D=this.getCompressedNode(w);return this.model.getListIndex(D)}getListRenderCount(w){const D=this.getCompressedNode(w);return this.model.getListRenderCount(D)}getNode(w){if(typeof w>"u")return this.model.getNode();const D=this.getCompressedNode(w);return this.model.getNode(D)}getNodeLocation(w){const D=this.model.getNodeLocation(w);return D===null?null:D.elements[D.elements.length-1]}getParentNodeLocation(w){const D=this.getCompressedNode(w),O=this.model.getParentNodeLocation(D);return O===null?null:O.elements[O.elements.length-1]}getFirstElementChild(w){const D=this.getCompressedNode(w);return this.model.getFirstElementChild(D)}isCollapsible(w){const D=this.getCompressedNode(w);return this.model.isCollapsible(D)}setCollapsible(w,D){const O=this.getCompressedNode(w);return this.model.setCollapsible(O,D)}isCollapsed(w){const D=this.getCompressedNode(w);return this.model.isCollapsed(D)}setCollapsed(w,D,O){const W=this.getCompressedNode(w);return this.model.setCollapsed(W,D,O)}expandTo(w){const D=this.getCompressedNode(w);this.model.expandTo(D)}rerender(w){const D=this.getCompressedNode(w);this.model.rerender(D)}refilter(){this.model.refilter()}getCompressedNode(w){if(w===null)return null;const D=this.nodes.get(w);if(!D)throw new TreeError(this.user,`Tree element not found: ${w}`);return D}}const DefaultElementMapper=F=>F[F.length-1];class CompressedTreeNodeWrapper{get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(w=>new CompressedTreeNodeWrapper(this.unwrapper,w))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(w,D){this.unwrapper=w,this.node=D}}function mapList(F,w){return{splice(D,O,W){w.splice(D,O,W.map(U=>F.map(U)))},updateElementHeight(D,O){w.updateElementHeight(D,O)}}}function mapOptions(F,w){return{...w,identityProvider:w.identityProvider&&{getId(D){return w.identityProvider.getId(F(D))}},sorter:w.sorter&&{compare(D,O){return w.sorter.compare(D.elements[0],O.elements[0])}},filter:w.filter&&{filter(D,O){return w.filter.filter(F(D),O)}}}}class CompressibleObjectTreeModel{get onDidSplice(){return Event$1.map(this.model.onDidSplice,({insertedNodes:w,deletedNodes:D})=>({insertedNodes:w.map(O=>this.nodeMapper.map(O)),deletedNodes:D.map(O=>this.nodeMapper.map(O))}))}get onDidChangeCollapseState(){return Event$1.map(this.model.onDidChangeCollapseState,({node:w,deep:D})=>({node:this.nodeMapper.map(w),deep:D}))}get onDidChangeRenderNodeCount(){return Event$1.map(this.model.onDidChangeRenderNodeCount,w=>this.nodeMapper.map(w))}constructor(w,D,O={}){this.rootRef=null,this.elementMapper=O.elementMapper||DefaultElementMapper;const W=U=>this.elementMapper(U.elements);this.nodeMapper=new WeakMapper(U=>new CompressedTreeNodeWrapper(W,U)),this.model=new CompressedObjectTreeModel(w,mapList(this.nodeMapper,D),mapOptions(W,O))}setChildren(w,D=Iterable.empty(),O={}){this.model.setChildren(w,D,O)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(w){this.model.setCompressionEnabled(w)}has(w){return this.model.has(w)}getListIndex(w){return this.model.getListIndex(w)}getListRenderCount(w){return this.model.getListRenderCount(w)}getNode(w){return this.nodeMapper.map(this.model.getNode(w))}getNodeLocation(w){return w.element}getParentNodeLocation(w){return this.model.getParentNodeLocation(w)}getFirstElementChild(w){const D=this.model.getFirstElementChild(w);return D===null||typeof D>"u"?D:this.elementMapper(D.elements)}isCollapsible(w){return this.model.isCollapsible(w)}setCollapsible(w,D){return this.model.setCollapsible(w,D)}isCollapsed(w){return this.model.isCollapsed(w)}setCollapsed(w,D,O){return this.model.setCollapsed(w,D,O)}expandTo(w){return this.model.expandTo(w)}rerender(w){return this.model.rerender(w)}refilter(){return this.model.refilter()}getCompressedTreeNode(w=null){return this.model.getNode(w)}}var __decorate$q=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U};class ObjectTree extends AbstractTree{get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}constructor(w,D,O,W,U={}){super(w,D,O,W,U),this.user=w}setChildren(w,D=Iterable.empty(),O){this.model.setChildren(w,D,O)}rerender(w){if(w===void 0){this.view.rerender();return}this.model.rerender(w)}hasElement(w){return this.model.has(w)}createModel(w,D,O){return new ObjectTreeModel(w,D,O)}}class CompressibleRenderer{get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}constructor(w,D,O){this._compressedTreeNodeProvider=w,this.stickyScrollDelegate=D,this.renderer=O,this.templateId=O.templateId,O.onDidChangeTwistieState&&(this.onDidChangeTwistieState=O.onDidChangeTwistieState)}renderTemplate(w){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(w)}}renderElement(w,D,O,W){let U=this.stickyScrollDelegate.getCompressedNode(w);U||(U=this.compressedTreeNodeProvider.getCompressedTreeNode(w.element)),U.element.elements.length===1?(O.compressedTreeNode=void 0,this.renderer.renderElement(w,D,O.data,W)):(O.compressedTreeNode=U,this.renderer.renderCompressedElements(U,D,O.data,W))}disposeElement(w,D,O,W){O.compressedTreeNode?this.renderer.disposeCompressedElements?.(O.compressedTreeNode,D,O.data,W):this.renderer.disposeElement?.(w,D,O.data,W)}disposeTemplate(w){this.renderer.disposeTemplate(w.data)}renderTwistie(w,D){return this.renderer.renderTwistie?this.renderer.renderTwistie(w,D):!1}}__decorate$q([memoize],CompressibleRenderer.prototype,"compressedTreeNodeProvider",null);class CompressibleStickyScrollDelegate{constructor(w){this.modelProvider=w,this.compressedStickyNodes=new Map}getCompressedNode(w){return this.compressedStickyNodes.get(w)}constrainStickyScrollNodes(w,D,O){if(this.compressedStickyNodes.clear(),w.length===0)return[];for(let W=0;W<w.length;W++){const U=w[W],K=U.position+U.height;if(W+1<w.length&&K+w[W+1].height>O||W>=D-1&&D<w.length){const G=w.slice(0,W),Q=w.slice(W),Y=this.compressStickyNodes(Q);return[...G,Y]}}return w}compressStickyNodes(w){if(w.length===0)throw new Error("Can't compress empty sticky nodes");const D=this.modelProvider();if(!D.isCompressionEnabled())return w[0];const O=[];for(let Q=0;Q<w.length;Q++){const Y=w[Q],X=D.getCompressedTreeNode(Y.node.element);if(X.element){if(Q!==0&&X.element.incompressible)break;O.push(...X.element.elements)}}if(O.length<2)return w[0];const W=w[w.length-1],U={elements:O,incompressible:!1},K={...W.node,children:[],element:U},q=new Proxy(w[0].node,{}),G={node:q,startIndex:w[0].startIndex,endIndex:W.endIndex,position:w[0].position,height:w[0].height};return this.compressedStickyNodes.set(q,K),G}}function asObjectTreeOptions$1(F,w){return w&&{...w,keyboardNavigationLabelProvider:w.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(D){let O;try{O=F().getCompressedTreeNode(D)}catch{return w.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(D)}return O.element.elements.length===1?w.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(D):w.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(O.element.elements)}}}}class CompressibleObjectTree extends ObjectTree{constructor(w,D,O,W,U={}){const K=()=>this,q=new CompressibleStickyScrollDelegate(()=>this.model),G=W.map(Q=>new CompressibleRenderer(K,q,Q));super(w,D,O,G,{...asObjectTreeOptions$1(K,U),stickyScrollDelegate:q})}setChildren(w,D=Iterable.empty(),O){this.model.setChildren(w,D,O)}createModel(w,D,O){return new CompressibleObjectTreeModel(w,D,O)}updateOptions(w={}){super.updateOptions(w),typeof w.compressionEnabled<"u"&&this.model.setCompressionEnabled(w.compressionEnabled)}getCompressedTreeNode(w=null){return this.model.getCompressedTreeNode(w)}}function createAsyncDataTreeNode(F){return{...F,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function isAncestor(F,w){return w.parent?w.parent===F?!0:isAncestor(F,w.parent):!1}function intersects(F,w){return F===w||isAncestor(F,w)||isAncestor(w,F)}class AsyncDataTreeNodeWrapper{get element(){return this.node.element.element}get children(){return this.node.children.map(w=>new AsyncDataTreeNodeWrapper(w))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(w){this.node=w}}class AsyncDataTreeRenderer{constructor(w,D,O){this.renderer=w,this.nodeMapper=D,this.onDidChangeTwistieState=O,this.renderedNodes=new Map,this.templateId=w.templateId}renderTemplate(w){return{templateData:this.renderer.renderTemplate(w)}}renderElement(w,D,O,W){this.renderer.renderElement(this.nodeMapper.map(w),D,O.templateData,W)}renderTwistie(w,D){return w.slow?(D.classList.add(...ThemeIcon.asClassNameArray(Codicon.treeItemLoading)),!0):(D.classList.remove(...ThemeIcon.asClassNameArray(Codicon.treeItemLoading)),!1)}disposeElement(w,D,O,W){this.renderer.disposeElement?.(this.nodeMapper.map(w),D,O.templateData,W)}disposeTemplate(w){this.renderer.disposeTemplate(w.templateData)}dispose(){this.renderedNodes.clear()}}function asTreeEvent(F){return{browserEvent:F.browserEvent,elements:F.elements.map(w=>w.element)}}function asTreeMouseEvent(F){return{browserEvent:F.browserEvent,element:F.element&&F.element.element,target:F.target}}class AsyncDataTreeElementsDragAndDropData extends ElementsDragAndDropData{constructor(w){super(w.elements.map(D=>D.element)),this.data=w}}function asAsyncDataTreeDragAndDropData(F){return F instanceof ElementsDragAndDropData?new AsyncDataTreeElementsDragAndDropData(F):F}class AsyncDataTreeNodeListDragAndDrop{constructor(w){this.dnd=w}getDragURI(w){return this.dnd.getDragURI(w.element)}getDragLabel(w,D){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(w.map(O=>O.element),D)}onDragStart(w,D){this.dnd.onDragStart?.(asAsyncDataTreeDragAndDropData(w),D)}onDragOver(w,D,O,W,U,K=!0){return this.dnd.onDragOver(asAsyncDataTreeDragAndDropData(w),D&&D.element,O,W,U)}drop(w,D,O,W,U){this.dnd.drop(asAsyncDataTreeDragAndDropData(w),D&&D.element,O,W,U)}onDragEnd(w){this.dnd.onDragEnd?.(w)}dispose(){this.dnd.dispose()}}function asObjectTreeOptions(F){return F&&{...F,collapseByDefault:!0,identityProvider:F.identityProvider&&{getId(w){return F.identityProvider.getId(w.element)}},dnd:F.dnd&&new AsyncDataTreeNodeListDragAndDrop(F.dnd),multipleSelectionController:F.multipleSelectionController&&{isSelectionSingleChangeEvent(w){return F.multipleSelectionController.isSelectionSingleChangeEvent({...w,element:w.element})},isSelectionRangeChangeEvent(w){return F.multipleSelectionController.isSelectionRangeChangeEvent({...w,element:w.element})}},accessibilityProvider:F.accessibilityProvider&&{...F.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:F.accessibilityProvider.getRole?w=>F.accessibilityProvider.getRole(w.element):()=>"treeitem",isChecked:F.accessibilityProvider.isChecked?w=>!!F.accessibilityProvider?.isChecked(w.element):void 0,getAriaLabel(w){return F.accessibilityProvider.getAriaLabel(w.element)},getWidgetAriaLabel(){return F.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:F.accessibilityProvider.getWidgetRole?()=>F.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:F.accessibilityProvider.getAriaLevel&&(w=>F.accessibilityProvider.getAriaLevel(w.element)),getActiveDescendantId:F.accessibilityProvider.getActiveDescendantId&&(w=>F.accessibilityProvider.getActiveDescendantId(w.element))},filter:F.filter&&{filter(w,D){return F.filter.filter(w.element,D)}},keyboardNavigationLabelProvider:F.keyboardNavigationLabelProvider&&{...F.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(w){return F.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(w.element)}},sorter:void 0,expandOnlyOnTwistieClick:typeof F.expandOnlyOnTwistieClick>"u"?void 0:typeof F.expandOnlyOnTwistieClick!="function"?F.expandOnlyOnTwistieClick:w=>F.expandOnlyOnTwistieClick(w.element),defaultFindVisibility:w=>w.hasChildren&&w.stale?1:typeof F.defaultFindVisibility=="number"?F.defaultFindVisibility:typeof F.defaultFindVisibility>"u"?2:F.defaultFindVisibility(w.element)}}function dfs(F,w){w(F),F.children.forEach(D=>dfs(D,w))}class AsyncDataTree{get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return Event$1.map(this.tree.onDidChangeFocus,asTreeEvent)}get onDidChangeSelection(){return Event$1.map(this.tree.onDidChangeSelection,asTreeEvent)}get onMouseDblClick(){return Event$1.map(this.tree.onMouseDblClick,asTreeMouseEvent)}get onPointer(){return Event$1.map(this.tree.onPointer,asTreeMouseEvent)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get onDidDispose(){return this.tree.onDidDispose}constructor(w,D,O,W,U,K={}){this.user=w,this.dataSource=U,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new Emitter$1,this._onDidChangeNodeSlowState=new Emitter$1,this.nodeMapper=new WeakMapper(q=>new AsyncDataTreeNodeWrapper(q)),this.disposables=new DisposableStore,this.identityProvider=K.identityProvider,this.autoExpandSingleChildren=typeof K.autoExpandSingleChildren>"u"?!1:K.autoExpandSingleChildren,this.sorter=K.sorter,this.getDefaultCollapseState=q=>K.collapseByDefault?K.collapseByDefault(q)?ObjectTreeElementCollapseState.PreserveOrCollapsed:ObjectTreeElementCollapseState.PreserveOrExpanded:void 0,this.tree=this.createTree(w,D,O,W,K),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType,this.root=createAsyncDataTreeNode({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}createTree(w,D,O,W,U){const K=new ComposedTreeDelegate(O),q=W.map(Q=>new AsyncDataTreeRenderer(Q,this.nodeMapper,this._onDidChangeNodeSlowState.event)),G=asObjectTreeOptions(U)||{};return new ObjectTree(w,D,K,q,G)}updateOptions(w={}){this.tree.updateOptions(w)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(w){this.tree.scrollTop=w}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}domFocus(){this.tree.domFocus()}layout(w,D){this.tree.layout(w,D)}style(w){this.tree.style(w)}getInput(){return this.root.element}async setInput(w,D){this.refreshPromises.forEach(W=>W.cancel()),this.refreshPromises.clear(),this.root.element=w;const O=D&&{viewState:D,focus:[],selection:[]};await this._updateChildren(w,!0,!1,O),O&&(this.tree.setFocus(O.focus),this.tree.setSelection(O.selection)),D&&typeof D.scrollTop=="number"&&(this.scrollTop=D.scrollTop)}async _updateChildren(w=this.root.element,D=!0,O=!1,W,U){if(typeof this.root.element>"u")throw new TreeError(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await Event$1.toPromise(this._onDidRender.event));const K=this.getDataNode(w);if(await this.refreshAndRenderNode(K,D,W,U),O)try{this.tree.rerender(K)}catch{}}rerender(w){if(w===void 0||w===this.root.element){this.tree.rerender();return}const D=this.getDataNode(w);this.tree.rerender(D)}getNode(w=this.root.element){const D=this.getDataNode(w),O=this.tree.getNode(D===this.root?null:D);return this.nodeMapper.map(O)}collapse(w,D=!1){const O=this.getDataNode(w);return this.tree.collapse(O===this.root?null:O,D)}async expand(w,D=!1){if(typeof this.root.element>"u")throw new TreeError(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await Event$1.toPromise(this._onDidRender.event));const O=this.getDataNode(w);if(this.tree.hasElement(O)&&!this.tree.isCollapsible(O)||(O.refreshPromise&&(await this.root.refreshPromise,await Event$1.toPromise(this._onDidRender.event)),O!==this.root&&!O.refreshPromise&&!this.tree.isCollapsed(O)))return!1;const W=this.tree.expand(O===this.root?null:O,D);return O.refreshPromise&&(await this.root.refreshPromise,await Event$1.toPromise(this._onDidRender.event)),W}setSelection(w,D){const O=w.map(W=>this.getDataNode(W));this.tree.setSelection(O,D)}getSelection(){return this.tree.getSelection().map(D=>D.element)}setFocus(w,D){const O=w.map(W=>this.getDataNode(W));this.tree.setFocus(O,D)}getFocus(){return this.tree.getFocus().map(D=>D.element)}reveal(w,D){this.tree.reveal(this.getDataNode(w),D)}getParentElement(w){const D=this.tree.getParentElement(this.getDataNode(w));return D&&D.element}getFirstElementChild(w=this.root.element){const D=this.getDataNode(w),O=this.tree.getFirstElementChild(D===this.root?null:D);return O&&O.element}getDataNode(w){const D=this.nodes.get(w===this.root.element?null:w);if(!D)throw new TreeError(this.user,`Data tree node not found: ${w}`);return D}async refreshAndRenderNode(w,D,O,W){await this.refreshNode(w,D,O),!this.disposables.isDisposed&&this.render(w,O,W)}async refreshNode(w,D,O){let W;if(this.subTreeRefreshPromises.forEach((U,K)=>{!W&&intersects(K,w)&&(W=U.then(()=>this.refreshNode(w,D,O)))}),W)return W;if(w!==this.root&&this.tree.getNode(w).collapsed){w.hasChildren=!!this.dataSource.hasChildren(w.element),w.stale=!0,this.setChildren(w,[],D,O);return}return this.doRefreshSubTree(w,D,O)}async doRefreshSubTree(w,D,O){let W;w.refreshPromise=new Promise(U=>W=U),this.subTreeRefreshPromises.set(w,w.refreshPromise),w.refreshPromise.finally(()=>{w.refreshPromise=void 0,this.subTreeRefreshPromises.delete(w)});try{const U=await this.doRefreshNode(w,D,O);w.stale=!1,await Promises.settled(U.map(K=>this.doRefreshSubTree(K,D,O)))}finally{W()}}async doRefreshNode(w,D,O){w.hasChildren=!!this.dataSource.hasChildren(w.element);let W;if(!w.hasChildren)W=Promise.resolve(Iterable.empty());else{const U=this.doGetChildren(w);if(isIterable(U))W=Promise.resolve(U);else{const K=timeout(800);K.then(()=>{w.slow=!0,this._onDidChangeNodeSlowState.fire(w)},q=>null),W=U.finally(()=>K.cancel())}}try{const U=await W;return this.setChildren(w,U,D,O)}catch(U){if(w!==this.root&&this.tree.hasElement(w)&&this.tree.collapse(w),isCancellationError(U))return[];throw U}finally{w.slow&&(w.slow=!1,this._onDidChangeNodeSlowState.fire(w))}}doGetChildren(w){let D=this.refreshPromises.get(w);if(D)return D;const O=this.dataSource.getChildren(w.element);return isIterable(O)?this.processChildren(O):(D=createCancelablePromise(async()=>this.processChildren(await O)),this.refreshPromises.set(w,D),D.finally(()=>{this.refreshPromises.delete(w)}))}_onDidChangeCollapseState({node:w,deep:D}){w.element!==null&&!w.collapsed&&w.element.stale&&(D?this.collapse(w.element.element):this.refreshAndRenderNode(w.element,!1).catch(onUnexpectedError))}setChildren(w,D,O,W){const U=[...D];if(w.children.length===0&&U.length===0)return[];const K=new Map,q=new Map;for(const Y of w.children)K.set(Y.element,Y),this.identityProvider&&q.set(Y.id,{node:Y,collapsed:this.tree.hasElement(Y)&&this.tree.isCollapsed(Y)});const G=[],Q=U.map(Y=>{const X=!!this.dataSource.hasChildren(Y);if(!this.identityProvider){const se=createAsyncDataTreeNode({element:Y,parent:w,hasChildren:X,defaultCollapseState:this.getDefaultCollapseState(Y)});return X&&se.defaultCollapseState===ObjectTreeElementCollapseState.PreserveOrExpanded&&G.push(se),se}const J=this.identityProvider.getId(Y).toString(),te=q.get(J);if(te){const se=te.node;return K.delete(se.element),this.nodes.delete(se.element),this.nodes.set(Y,se),se.element=Y,se.hasChildren=X,O?te.collapsed?(se.children.forEach(re=>dfs(re,ae=>this.nodes.delete(ae.element))),se.children.splice(0,se.children.length),se.stale=!0):G.push(se):X&&!te.collapsed&&G.push(se),se}const ie=createAsyncDataTreeNode({element:Y,parent:w,id:J,hasChildren:X,defaultCollapseState:this.getDefaultCollapseState(Y)});return W&&W.viewState.focus&&W.viewState.focus.indexOf(J)>-1&&W.focus.push(ie),W&&W.viewState.selection&&W.viewState.selection.indexOf(J)>-1&&W.selection.push(ie),(W&&W.viewState.expanded&&W.viewState.expanded.indexOf(J)>-1||X&&ie.defaultCollapseState===ObjectTreeElementCollapseState.PreserveOrExpanded)&&G.push(ie),ie});for(const Y of K.values())dfs(Y,X=>this.nodes.delete(X.element));for(const Y of Q)this.nodes.set(Y.element,Y);return w.children.splice(0,w.children.length,...Q),w!==this.root&&this.autoExpandSingleChildren&&Q.length===1&&G.length===0&&(Q[0].forceExpanded=!0,G.push(Q[0])),G}render(w,D,O){const W=w.children.map(K=>this.asTreeElement(K,D)),U=O&&{...O,diffIdentityProvider:O.diffIdentityProvider&&{getId(K){return O.diffIdentityProvider.getId(K.element)}}};this.tree.setChildren(w===this.root?null:w,W,U),w!==this.root&&this.tree.setCollapsible(w,w.hasChildren),this._onDidRender.fire()}asTreeElement(w,D){if(w.stale)return{element:w,collapsible:w.hasChildren,collapsed:!0};let O;return D&&D.viewState.expanded&&w.id&&D.viewState.expanded.indexOf(w.id)>-1?O=!1:w.forceExpanded?(O=!1,w.forceExpanded=!1):O=w.defaultCollapseState,{element:w,children:w.hasChildren?Iterable.map(w.children,W=>this.asTreeElement(W,D)):[],collapsible:w.hasChildren,collapsed:O}}processChildren(w){return this.sorter&&(w=[...w].sort(this.sorter.compare.bind(this.sorter))),w}dispose(){this.disposables.dispose(),this.tree.dispose()}}class CompressibleAsyncDataTreeNodeWrapper{get element(){return{elements:this.node.element.elements.map(w=>w.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(w=>new CompressibleAsyncDataTreeNodeWrapper(w))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(w){this.node=w}}class CompressibleAsyncDataTreeRenderer{constructor(w,D,O,W){this.renderer=w,this.nodeMapper=D,this.compressibleNodeMapperProvider=O,this.onDidChangeTwistieState=W,this.renderedNodes=new Map,this.disposables=[],this.templateId=w.templateId}renderTemplate(w){return{templateData:this.renderer.renderTemplate(w)}}renderElement(w,D,O,W){this.renderer.renderElement(this.nodeMapper.map(w),D,O.templateData,W)}renderCompressedElements(w,D,O,W){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(w),D,O.templateData,W)}renderTwistie(w,D){return w.slow?(D.classList.add(...ThemeIcon.asClassNameArray(Codicon.treeItemLoading)),!0):(D.classList.remove(...ThemeIcon.asClassNameArray(Codicon.treeItemLoading)),!1)}disposeElement(w,D,O,W){this.renderer.disposeElement?.(this.nodeMapper.map(w),D,O.templateData,W)}disposeCompressedElements(w,D,O,W){this.renderer.disposeCompressedElements?.(this.compressibleNodeMapperProvider().map(w),D,O.templateData,W)}disposeTemplate(w){this.renderer.disposeTemplate(w.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=dispose(this.disposables)}}function asCompressibleObjectTreeOptions(F){const w=F&&asObjectTreeOptions(F);return w&&{...w,keyboardNavigationLabelProvider:w.keyboardNavigationLabelProvider&&{...w.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel(D){return F.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(D.map(O=>O.element))}}}}class CompressibleAsyncDataTree extends AsyncDataTree{constructor(w,D,O,W,U,K,q={}){super(w,D,O,U,K,q),this.compressionDelegate=W,this.compressibleNodeMapper=new WeakMapper(G=>new CompressibleAsyncDataTreeNodeWrapper(G)),this.filter=q.filter}createTree(w,D,O,W,U){const K=new ComposedTreeDelegate(O),q=W.map(Q=>new CompressibleAsyncDataTreeRenderer(Q,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),G=asCompressibleObjectTreeOptions(U)||{};return new CompressibleObjectTree(w,D,K,q,G)}asTreeElement(w,D){return{incompressible:this.compressionDelegate.isIncompressible(w.element),...super.asTreeElement(w,D)}}updateOptions(w={}){this.tree.updateOptions(w)}render(w,D,O){if(!this.identityProvider)return super.render(w,D);const W=te=>this.identityProvider.getId(te).toString(),U=te=>{const ie=new Set;for(const se of te){const re=this.tree.getCompressedTreeNode(se===this.root?null:se);if(re.element)for(const ae of re.element.elements)ie.add(W(ae.element))}return ie},K=U(this.tree.getSelection()),q=U(this.tree.getFocus());super.render(w,D,O);const G=this.getSelection();let Q=!1;const Y=this.getFocus();let X=!1;const J=te=>{const ie=te.element;if(ie)for(let se=0;se<ie.elements.length;se++){const re=W(ie.elements[se].element),ae=ie.elements[ie.elements.length-1].element;K.has(re)&&G.indexOf(ae)===-1&&(G.push(ae),Q=!0),q.has(re)&&Y.indexOf(ae)===-1&&(Y.push(ae),X=!0)}te.children.forEach(J)};J(this.tree.getCompressedTreeNode(w===this.root?null:w)),Q&&this.setSelection(G),X&&this.setFocus(Y)}processChildren(w){return this.filter&&(w=Iterable.filter(w,D=>{const O=this.filter.filter(D,1),W=getVisibility(O);if(W===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return W===1})),super.processChildren(w)}}function getVisibility(F){return typeof F=="boolean"?F?1:0:isFilterResult(F)?getVisibleState(F.visibility):getVisibleState(F)}class DataTree extends AbstractTree{constructor(w,D,O,W,U,K={}){super(w,D,O,W,K),this.user=w,this.dataSource=U,this.identityProvider=K.identityProvider}createModel(w,D,O){return new ObjectTreeModel(w,D,O)}}new RawContextKey("isMac",isMacintosh,localize("isMac","Whether the operating system is macOS"));new RawContextKey("isLinux",isLinux,localize("isLinux","Whether the operating system is Linux"));new RawContextKey("isWindows",isWindows,localize("isWindows","Whether the operating system is Windows"));new RawContextKey("isWeb",isWeb,localize("isWeb","Whether the platform is a web browser"));new RawContextKey("isMacNative",isMacintosh&&!isWeb,localize("isMacNative","Whether the operating system is macOS on a non-browser platform"));new RawContextKey("isIOS",isIOS,localize("isIOS","Whether the operating system is iOS"));new RawContextKey("isMobile",isMobile,localize("isMobile","Whether the platform is a mobile web browser"));new RawContextKey("isDevelopment",!1,!0);new RawContextKey("productQualityType","",localize("productQualityType","Quality type of VS Code"));const InputFocusedContextKey="inputFocus",InputFocusedContext=new RawContextKey(InputFocusedContextKey,!1,localize("inputFocus","Whether keyboard focus is inside an input box"));var __decorate$p=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$p=function(F,w){return function(D,O){w(D,O,F)}};const IListService=createDecorator("listService");class ListService{get lastFocusedList(){return this._lastFocusedWidget}constructor(){this.disposables=new DisposableStore,this.lists=[],this._lastFocusedWidget=void 0,this._hasCreatedStyleController=!1}setLastFocusedList(w){w!==this._lastFocusedWidget&&(this._lastFocusedWidget?.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=w,this._lastFocusedWidget?.getHTMLElement().classList.add("last-focused"))}register(w,D){if(this._hasCreatedStyleController||(this._hasCreatedStyleController=!0,new DefaultStyleController(createStyleSheet(),"").style(defaultListStyles)),this.lists.some(W=>W.widget===w))throw new Error("Cannot register the same widget multiple times");const O={widget:w,extraContextKeys:D};return this.lists.push(O),isActiveElement(w.getHTMLElement())&&this.setLastFocusedList(w),combinedDisposable(w.onDidFocus(()=>this.setLastFocusedList(w)),toDisposable(()=>this.lists.splice(this.lists.indexOf(O),1)),w.onDidDispose(()=>{this.lists=this.lists.filter(W=>W!==O),this._lastFocusedWidget===w&&this.setLastFocusedList(void 0)}))}dispose(){this.disposables.dispose()}}const RawWorkbenchListScrollAtBoundaryContextKey=new RawContextKey("listScrollAtBoundary","none");ContextKeyExpr.or(RawWorkbenchListScrollAtBoundaryContextKey.isEqualTo("top"),RawWorkbenchListScrollAtBoundaryContextKey.isEqualTo("both"));ContextKeyExpr.or(RawWorkbenchListScrollAtBoundaryContextKey.isEqualTo("bottom"),RawWorkbenchListScrollAtBoundaryContextKey.isEqualTo("both"));const RawWorkbenchListFocusContextKey=new RawContextKey("listFocus",!0),WorkbenchTreeStickyScrollFocused=new RawContextKey("treestickyScrollFocused",!1),WorkbenchListSupportsMultiSelectContextKey=new RawContextKey("listSupportsMultiselect",!0);ContextKeyExpr.and(RawWorkbenchListFocusContextKey,ContextKeyExpr.not(InputFocusedContextKey),WorkbenchTreeStickyScrollFocused.negate());const WorkbenchListHasSelectionOrFocus=new RawContextKey("listHasSelectionOrFocus",!1),WorkbenchListDoubleSelection=new RawContextKey("listDoubleSelection",!1),WorkbenchListMultiSelection=new RawContextKey("listMultiSelection",!1),WorkbenchListSelectionNavigation=new RawContextKey("listSelectionNavigation",!1),WorkbenchListSupportsFind=new RawContextKey("listSupportsFind",!0),WorkbenchTreeElementCanCollapse=new RawContextKey("treeElementCanCollapse",!1),WorkbenchTreeElementHasParent=new RawContextKey("treeElementHasParent",!1),WorkbenchTreeElementCanExpand=new RawContextKey("treeElementCanExpand",!1),WorkbenchTreeElementHasChild=new RawContextKey("treeElementHasChild",!1),WorkbenchTreeFindOpen=new RawContextKey("treeFindOpen",!1),WorkbenchListTypeNavigationModeKey="listTypeNavigationMode",WorkbenchListAutomaticKeyboardNavigationLegacyKey="listAutomaticKeyboardNavigation";function createScopedContextKeyService(F,w){const D=F.createScoped(w.getHTMLElement());return RawWorkbenchListFocusContextKey.bindTo(D),D}function createScrollObserver(F,w){const D=RawWorkbenchListScrollAtBoundaryContextKey.bindTo(F),O=()=>{const W=w.scrollTop===0,U=w.scrollHeight-w.renderHeight-w.scrollTop<1;W&&U?D.set("both"):W?D.set("top"):U?D.set("bottom"):D.set("none")};return O(),w.onDidScroll(O)}const multiSelectModifierSettingKey="workbench.list.multiSelectModifier",openModeSettingKey="workbench.list.openMode",horizontalScrollingKey="workbench.list.horizontalScrolling",defaultFindModeSettingKey="workbench.list.defaultFindMode",typeNavigationModeSettingKey="workbench.list.typeNavigationMode",keyboardNavigationSettingKey="workbench.list.keyboardNavigation",scrollByPageKey="workbench.list.scrollByPage",defaultFindMatchTypeSettingKey="workbench.list.defaultFindMatchType",treeIndentKey="workbench.tree.indent",treeRenderIndentGuidesKey="workbench.tree.renderIndentGuides",listSmoothScrolling="workbench.list.smoothScrolling",mouseWheelScrollSensitivityKey="workbench.list.mouseWheelScrollSensitivity",fastScrollSensitivityKey="workbench.list.fastScrollSensitivity",treeExpandMode="workbench.tree.expandMode",treeStickyScroll="workbench.tree.enableStickyScroll",treeStickyScrollMaxElements="workbench.tree.stickyScrollMaxItemCount";function useAltAsMultipleSelectionModifier(F){return F.getValue(multiSelectModifierSettingKey)==="alt"}class MultipleSelectionController extends Disposable{constructor(w){super(),this.configurationService=w,this.useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(w),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(w=>{w.affectsConfiguration(multiSelectModifierSettingKey)&&(this.useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(this.configurationService))}))}isSelectionSingleChangeEvent(w){return this.useAltAsMultipleSelectionModifier?w.browserEvent.altKey:isSelectionSingleChangeEvent(w)}isSelectionRangeChangeEvent(w){return isSelectionRangeChangeEvent(w)}}function toWorkbenchListOptions(F,w){const D=F.get(IConfigurationService),O=F.get(IKeybindingService),W=new DisposableStore;return[{...w,keyboardNavigationDelegate:{mightProducePrintableCharacter(K){return O.mightProducePrintableCharacter(K)}},smoothScrolling:!!D.getValue(listSmoothScrolling),mouseWheelScrollSensitivity:D.getValue(mouseWheelScrollSensitivityKey),fastScrollSensitivity:D.getValue(fastScrollSensitivityKey),multipleSelectionController:w.multipleSelectionController??W.add(new MultipleSelectionController(D)),keyboardNavigationEventFilter:createKeyboardNavigationEventFilter(O),scrollByPage:!!D.getValue(scrollByPageKey)},W]}let WorkbenchList=class extends List{constructor(w,D,O,W,U,K,q,G,Q){const Y=typeof U.horizontalScrolling<"u"?U.horizontalScrolling:!!G.getValue(horizontalScrollingKey),[X,J]=Q.invokeFunction(toWorkbenchListOptions,U);super(w,D,O,W,{keyboardSupport:!1,...X,horizontalScrolling:Y}),this.disposables.add(J),this.contextKeyService=createScopedContextKeyService(K,this),this.disposables.add(createScrollObserver(this.contextKeyService,this)),this.listSupportsMultiSelect=WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(U.multipleSelectionSupport!==!1),WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(!!U.selectionNavigation),this.listHasSelectionOrFocus=WorkbenchListHasSelectionOrFocus.bindTo(this.contextKeyService),this.listDoubleSelection=WorkbenchListDoubleSelection.bindTo(this.contextKeyService),this.listMultiSelection=WorkbenchListMultiSelection.bindTo(this.contextKeyService),this.horizontalScrolling=U.horizontalScrolling,this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(G),this.disposables.add(this.contextKeyService),this.disposables.add(q.register(this)),this.updateStyles(U.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const ie=this.getSelection(),se=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(ie.length>0||se.length>0),this.listMultiSelection.set(ie.length>1),this.listDoubleSelection.set(ie.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const ie=this.getSelection(),se=this.getFocus();this.listHasSelectionOrFocus.set(ie.length>0||se.length>0)})),this.disposables.add(G.onDidChangeConfiguration(ie=>{ie.affectsConfiguration(multiSelectModifierSettingKey)&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(G));let se={};if(ie.affectsConfiguration(horizontalScrollingKey)&&this.horizontalScrolling===void 0){const re=!!G.getValue(horizontalScrollingKey);se={...se,horizontalScrolling:re}}if(ie.affectsConfiguration(scrollByPageKey)){const re=!!G.getValue(scrollByPageKey);se={...se,scrollByPage:re}}if(ie.affectsConfiguration(listSmoothScrolling)){const re=!!G.getValue(listSmoothScrolling);se={...se,smoothScrolling:re}}if(ie.affectsConfiguration(mouseWheelScrollSensitivityKey)){const re=G.getValue(mouseWheelScrollSensitivityKey);se={...se,mouseWheelScrollSensitivity:re}}if(ie.affectsConfiguration(fastScrollSensitivityKey)){const re=G.getValue(fastScrollSensitivityKey);se={...se,fastScrollSensitivity:re}}Object.keys(se).length>0&&this.updateOptions(se)})),this.navigator=new ListResourceNavigator(this,{configurationService:G,...U}),this.disposables.add(this.navigator)}updateOptions(w){super.updateOptions(w),w.overrideStyles!==void 0&&this.updateStyles(w.overrideStyles),w.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!w.multipleSelectionSupport)}updateStyles(w){this.style(w?getListStyles(w):defaultListStyles)}};WorkbenchList=__decorate$p([__param$p(5,IContextKeyService),__param$p(6,IListService),__param$p(7,IConfigurationService),__param$p(8,IInstantiationService)],WorkbenchList);let WorkbenchPagedList=class extends PagedList{constructor(w,D,O,W,U,K,q,G,Q){const Y=typeof U.horizontalScrolling<"u"?U.horizontalScrolling:!!G.getValue(horizontalScrollingKey),[X,J]=Q.invokeFunction(toWorkbenchListOptions,U);super(w,D,O,W,{keyboardSupport:!1,...X,horizontalScrolling:Y}),this.disposables=new DisposableStore,this.disposables.add(J),this.contextKeyService=createScopedContextKeyService(K,this),this.disposables.add(createScrollObserver(this.contextKeyService,this.widget)),this.horizontalScrolling=U.horizontalScrolling,this.listSupportsMultiSelect=WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(U.multipleSelectionSupport!==!1),WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(!!U.selectionNavigation),this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(G),this.disposables.add(this.contextKeyService),this.disposables.add(q.register(this)),this.updateStyles(U.overrideStyles),this.disposables.add(G.onDidChangeConfiguration(ie=>{ie.affectsConfiguration(multiSelectModifierSettingKey)&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(G));let se={};if(ie.affectsConfiguration(horizontalScrollingKey)&&this.horizontalScrolling===void 0){const re=!!G.getValue(horizontalScrollingKey);se={...se,horizontalScrolling:re}}if(ie.affectsConfiguration(scrollByPageKey)){const re=!!G.getValue(scrollByPageKey);se={...se,scrollByPage:re}}if(ie.affectsConfiguration(listSmoothScrolling)){const re=!!G.getValue(listSmoothScrolling);se={...se,smoothScrolling:re}}if(ie.affectsConfiguration(mouseWheelScrollSensitivityKey)){const re=G.getValue(mouseWheelScrollSensitivityKey);se={...se,mouseWheelScrollSensitivity:re}}if(ie.affectsConfiguration(fastScrollSensitivityKey)){const re=G.getValue(fastScrollSensitivityKey);se={...se,fastScrollSensitivity:re}}Object.keys(se).length>0&&this.updateOptions(se)})),this.navigator=new ListResourceNavigator(this,{configurationService:G,...U}),this.disposables.add(this.navigator)}updateOptions(w){super.updateOptions(w),w.overrideStyles!==void 0&&this.updateStyles(w.overrideStyles),w.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!w.multipleSelectionSupport)}updateStyles(w){this.style(w?getListStyles(w):defaultListStyles)}dispose(){this.disposables.dispose(),super.dispose()}};WorkbenchPagedList=__decorate$p([__param$p(5,IContextKeyService),__param$p(6,IListService),__param$p(7,IConfigurationService),__param$p(8,IInstantiationService)],WorkbenchPagedList);let WorkbenchTable=class extends Table{constructor(w,D,O,W,U,K,q,G,Q,Y){const X=typeof K.horizontalScrolling<"u"?K.horizontalScrolling:!!Q.getValue(horizontalScrollingKey),[J,te]=Y.invokeFunction(toWorkbenchListOptions,K);super(w,D,O,W,U,{keyboardSupport:!1,...J,horizontalScrolling:X}),this.disposables.add(te),this.contextKeyService=createScopedContextKeyService(q,this),this.disposables.add(createScrollObserver(this.contextKeyService,this)),this.listSupportsMultiSelect=WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(K.multipleSelectionSupport!==!1),WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(!!K.selectionNavigation),this.listHasSelectionOrFocus=WorkbenchListHasSelectionOrFocus.bindTo(this.contextKeyService),this.listDoubleSelection=WorkbenchListDoubleSelection.bindTo(this.contextKeyService),this.listMultiSelection=WorkbenchListMultiSelection.bindTo(this.contextKeyService),this.horizontalScrolling=K.horizontalScrolling,this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(Q),this.disposables.add(this.contextKeyService),this.disposables.add(G.register(this)),this.updateStyles(K.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const se=this.getSelection(),re=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(se.length>0||re.length>0),this.listMultiSelection.set(se.length>1),this.listDoubleSelection.set(se.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const se=this.getSelection(),re=this.getFocus();this.listHasSelectionOrFocus.set(se.length>0||re.length>0)})),this.disposables.add(Q.onDidChangeConfiguration(se=>{se.affectsConfiguration(multiSelectModifierSettingKey)&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(Q));let re={};if(se.affectsConfiguration(horizontalScrollingKey)&&this.horizontalScrolling===void 0){const ae=!!Q.getValue(horizontalScrollingKey);re={...re,horizontalScrolling:ae}}if(se.affectsConfiguration(scrollByPageKey)){const ae=!!Q.getValue(scrollByPageKey);re={...re,scrollByPage:ae}}if(se.affectsConfiguration(listSmoothScrolling)){const ae=!!Q.getValue(listSmoothScrolling);re={...re,smoothScrolling:ae}}if(se.affectsConfiguration(mouseWheelScrollSensitivityKey)){const ae=Q.getValue(mouseWheelScrollSensitivityKey);re={...re,mouseWheelScrollSensitivity:ae}}if(se.affectsConfiguration(fastScrollSensitivityKey)){const ae=Q.getValue(fastScrollSensitivityKey);re={...re,fastScrollSensitivity:ae}}Object.keys(re).length>0&&this.updateOptions(re)})),this.navigator=new TableResourceNavigator(this,{configurationService:Q,...K}),this.disposables.add(this.navigator)}updateOptions(w){super.updateOptions(w),w.overrideStyles!==void 0&&this.updateStyles(w.overrideStyles),w.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!w.multipleSelectionSupport)}updateStyles(w){this.style(w?getListStyles(w):defaultListStyles)}dispose(){this.disposables.dispose(),super.dispose()}};WorkbenchTable=__decorate$p([__param$p(6,IContextKeyService),__param$p(7,IListService),__param$p(8,IConfigurationService),__param$p(9,IInstantiationService)],WorkbenchTable);class ResourceNavigator extends Disposable{constructor(w,D){super(),this.widget=w,this._onDidOpen=this._register(new Emitter$1),this.onDidOpen=this._onDidOpen.event,this._register(Event$1.filter(this.widget.onDidChangeSelection,O=>isKeyboardEvent(O.browserEvent))(O=>this.onSelectionFromKeyboard(O))),this._register(this.widget.onPointer(O=>this.onPointer(O.element,O.browserEvent))),this._register(this.widget.onMouseDblClick(O=>this.onMouseDblClick(O.element,O.browserEvent))),typeof D?.openOnSingleClick!="boolean"&&D?.configurationService?(this.openOnSingleClick=D?.configurationService.getValue(openModeSettingKey)!=="doubleClick",this._register(D?.configurationService.onDidChangeConfiguration(O=>{O.affectsConfiguration(openModeSettingKey)&&(this.openOnSingleClick=D?.configurationService.getValue(openModeSettingKey)!=="doubleClick")}))):this.openOnSingleClick=D?.openOnSingleClick??!0}onSelectionFromKeyboard(w){if(w.elements.length!==1)return;const D=w.browserEvent,O=typeof D.preserveFocus=="boolean"?D.preserveFocus:!0,W=typeof D.pinned=="boolean"?D.pinned:!O;this._open(this.getSelectedElement(),O,W,!1,w.browserEvent)}onPointer(w,D){if(!this.openOnSingleClick||D.detail===2)return;const W=D.button===1,U=!0,K=W,q=D.ctrlKey||D.metaKey||D.altKey;this._open(w,U,K,q,D)}onMouseDblClick(w,D){if(!D)return;const O=D.target;if(O.classList.contains("monaco-tl-twistie")||O.classList.contains("monaco-icon-label")&&O.classList.contains("folder-icon")&&D.offsetX<16)return;const U=!1,K=!0,q=D.ctrlKey||D.metaKey||D.altKey;this._open(w,U,K,q,D)}_open(w,D,O,W,U){w&&this._onDidOpen.fire({editorOptions:{preserveFocus:D,pinned:O,revealIfVisible:!0},sideBySide:W,element:w,browserEvent:U})}}class ListResourceNavigator extends ResourceNavigator{constructor(w,D){super(w,D),this.widget=w}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class TableResourceNavigator extends ResourceNavigator{constructor(w,D){super(w,D)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class TreeResourceNavigator extends ResourceNavigator{constructor(w,D){super(w,D)}getSelectedElement(){return this.widget.getSelection()[0]??void 0}}function createKeyboardNavigationEventFilter(F){let w=!1;return D=>{if(D.toKeyCodeChord().isModifierKey())return!1;if(w)return w=!1,!1;const O=F.softDispatch(D,D.target);return O.kind===1?(w=!0,!1):(w=!1,O.kind===0)}}let WorkbenchObjectTree=class extends ObjectTree{constructor(w,D,O,W,U,K,q,G,Q){const{options:Y,getTypeNavigationMode:X,disposable:J}=K.invokeFunction(workbenchTreeDataPreamble,U);super(w,D,O,W,Y),this.disposables.add(J),this.internals=new WorkbenchTreeInternals(this,U,X,U.overrideStyles,q,G,Q),this.disposables.add(this.internals)}updateOptions(w){super.updateOptions(w),this.internals.updateOptions(w)}};WorkbenchObjectTree=__decorate$p([__param$p(5,IInstantiationService),__param$p(6,IContextKeyService),__param$p(7,IListService),__param$p(8,IConfigurationService)],WorkbenchObjectTree);let WorkbenchCompressibleObjectTree=class extends CompressibleObjectTree{constructor(w,D,O,W,U,K,q,G,Q){const{options:Y,getTypeNavigationMode:X,disposable:J}=K.invokeFunction(workbenchTreeDataPreamble,U);super(w,D,O,W,Y),this.disposables.add(J),this.internals=new WorkbenchTreeInternals(this,U,X,U.overrideStyles,q,G,Q),this.disposables.add(this.internals)}updateOptions(w={}){super.updateOptions(w),w.overrideStyles&&this.internals.updateStyleOverrides(w.overrideStyles),this.internals.updateOptions(w)}};WorkbenchCompressibleObjectTree=__decorate$p([__param$p(5,IInstantiationService),__param$p(6,IContextKeyService),__param$p(7,IListService),__param$p(8,IConfigurationService)],WorkbenchCompressibleObjectTree);let WorkbenchDataTree=class extends DataTree{constructor(w,D,O,W,U,K,q,G,Q,Y){const{options:X,getTypeNavigationMode:J,disposable:te}=q.invokeFunction(workbenchTreeDataPreamble,K);super(w,D,O,W,U,X),this.disposables.add(te),this.internals=new WorkbenchTreeInternals(this,K,J,K.overrideStyles,G,Q,Y),this.disposables.add(this.internals)}updateOptions(w={}){super.updateOptions(w),w.overrideStyles!==void 0&&this.internals.updateStyleOverrides(w.overrideStyles),this.internals.updateOptions(w)}};WorkbenchDataTree=__decorate$p([__param$p(6,IInstantiationService),__param$p(7,IContextKeyService),__param$p(8,IListService),__param$p(9,IConfigurationService)],WorkbenchDataTree);let WorkbenchAsyncDataTree=class extends AsyncDataTree{get onDidOpen(){return this.internals.onDidOpen}constructor(w,D,O,W,U,K,q,G,Q,Y){const{options:X,getTypeNavigationMode:J,disposable:te}=q.invokeFunction(workbenchTreeDataPreamble,K);super(w,D,O,W,U,X),this.disposables.add(te),this.internals=new WorkbenchTreeInternals(this,K,J,K.overrideStyles,G,Q,Y),this.disposables.add(this.internals)}updateOptions(w={}){super.updateOptions(w),w.overrideStyles&&this.internals.updateStyleOverrides(w.overrideStyles),this.internals.updateOptions(w)}};WorkbenchAsyncDataTree=__decorate$p([__param$p(6,IInstantiationService),__param$p(7,IContextKeyService),__param$p(8,IListService),__param$p(9,IConfigurationService)],WorkbenchAsyncDataTree);let WorkbenchCompressibleAsyncDataTree=class extends CompressibleAsyncDataTree{constructor(w,D,O,W,U,K,q,G,Q,Y,X){const{options:J,getTypeNavigationMode:te,disposable:ie}=G.invokeFunction(workbenchTreeDataPreamble,q);super(w,D,O,W,U,K,J),this.disposables.add(ie),this.internals=new WorkbenchTreeInternals(this,q,te,q.overrideStyles,Q,Y,X),this.disposables.add(this.internals)}updateOptions(w){super.updateOptions(w),this.internals.updateOptions(w)}};WorkbenchCompressibleAsyncDataTree=__decorate$p([__param$p(7,IInstantiationService),__param$p(8,IContextKeyService),__param$p(9,IListService),__param$p(10,IConfigurationService)],WorkbenchCompressibleAsyncDataTree);function getDefaultTreeFindMode(F){const w=F.getValue(defaultFindModeSettingKey);if(w==="highlight")return TreeFindMode.Highlight;if(w==="filter")return TreeFindMode.Filter;const D=F.getValue(keyboardNavigationSettingKey);if(D==="simple"||D==="highlight")return TreeFindMode.Highlight;if(D==="filter")return TreeFindMode.Filter}function getDefaultTreeFindMatchType(F){const w=F.getValue(defaultFindMatchTypeSettingKey);if(w==="fuzzy")return TreeFindMatchType.Fuzzy;if(w==="contiguous")return TreeFindMatchType.Contiguous}function workbenchTreeDataPreamble(F,w){const D=F.get(IConfigurationService),O=F.get(IContextViewService),W=F.get(IContextKeyService),U=F.get(IInstantiationService),K=()=>{const J=W.getContextKeyValue(WorkbenchListTypeNavigationModeKey);if(J==="automatic")return TypeNavigationMode.Automatic;if(J==="trigger"||W.getContextKeyValue(WorkbenchListAutomaticKeyboardNavigationLegacyKey)===!1)return TypeNavigationMode.Trigger;const ie=D.getValue(typeNavigationModeSettingKey);if(ie==="automatic")return TypeNavigationMode.Automatic;if(ie==="trigger")return TypeNavigationMode.Trigger},q=w.horizontalScrolling!==void 0?w.horizontalScrolling:!!D.getValue(horizontalScrollingKey),[G,Q]=U.invokeFunction(toWorkbenchListOptions,w),Y=w.paddingBottom,X=w.renderIndentGuides!==void 0?w.renderIndentGuides:D.getValue(treeRenderIndentGuidesKey);return{getTypeNavigationMode:K,disposable:Q,options:{keyboardSupport:!1,...G,indent:typeof D.getValue(treeIndentKey)=="number"?D.getValue(treeIndentKey):void 0,renderIndentGuides:X,smoothScrolling:!!D.getValue(listSmoothScrolling),defaultFindMode:getDefaultTreeFindMode(D),defaultFindMatchType:getDefaultTreeFindMatchType(D),horizontalScrolling:q,scrollByPage:!!D.getValue(scrollByPageKey),paddingBottom:Y,hideTwistiesOfChildlessElements:w.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:w.expandOnlyOnTwistieClick??D.getValue(treeExpandMode)==="doubleClick",contextViewProvider:O,findWidgetStyles:defaultFindWidgetStyles,enableStickyScroll:!!D.getValue(treeStickyScroll),stickyScrollMaxItemCount:Number(D.getValue(treeStickyScrollMaxElements))}}}let WorkbenchTreeInternals=class{get onDidOpen(){return this.navigator.onDidOpen}constructor(w,D,O,W,U,K,q){this.tree=w,this.disposables=[],this.contextKeyService=createScopedContextKeyService(U,w),this.disposables.push(createScrollObserver(this.contextKeyService,w)),this.listSupportsMultiSelect=WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(D.multipleSelectionSupport!==!1),WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(!!D.selectionNavigation),this.listSupportFindWidget=WorkbenchListSupportsFind.bindTo(this.contextKeyService),this.listSupportFindWidget.set(D.findWidgetEnabled??!0),this.hasSelectionOrFocus=WorkbenchListHasSelectionOrFocus.bindTo(this.contextKeyService),this.hasDoubleSelection=WorkbenchListDoubleSelection.bindTo(this.contextKeyService),this.hasMultiSelection=WorkbenchListMultiSelection.bindTo(this.contextKeyService),this.treeElementCanCollapse=WorkbenchTreeElementCanCollapse.bindTo(this.contextKeyService),this.treeElementHasParent=WorkbenchTreeElementHasParent.bindTo(this.contextKeyService),this.treeElementCanExpand=WorkbenchTreeElementCanExpand.bindTo(this.contextKeyService),this.treeElementHasChild=WorkbenchTreeElementHasChild.bindTo(this.contextKeyService),this.treeFindOpen=WorkbenchTreeFindOpen.bindTo(this.contextKeyService),this.treeStickyScrollFocused=WorkbenchTreeStickyScrollFocused.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(q),this.updateStyleOverrides(W);const Q=()=>{const X=w.getFocus()[0];if(!X)return;const J=w.getNode(X);this.treeElementCanCollapse.set(J.collapsible&&!J.collapsed),this.treeElementHasParent.set(!!w.getParentElement(X)),this.treeElementCanExpand.set(J.collapsible&&J.collapsed),this.treeElementHasChild.set(!!w.getFirstElementChild(X))},Y=new Set;Y.add(WorkbenchListTypeNavigationModeKey),Y.add(WorkbenchListAutomaticKeyboardNavigationLegacyKey),this.disposables.push(this.contextKeyService,K.register(w),w.onDidChangeSelection(()=>{const X=w.getSelection(),J=w.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(X.length>0||J.length>0),this.hasMultiSelection.set(X.length>1),this.hasDoubleSelection.set(X.length===2)})}),w.onDidChangeFocus(()=>{const X=w.getSelection(),J=w.getFocus();this.hasSelectionOrFocus.set(X.length>0||J.length>0),Q()}),w.onDidChangeCollapseState(Q),w.onDidChangeModel(Q),w.onDidChangeFindOpenState(X=>this.treeFindOpen.set(X)),w.onDidChangeStickyScrollFocused(X=>this.treeStickyScrollFocused.set(X)),q.onDidChangeConfiguration(X=>{let J={};if(X.affectsConfiguration(multiSelectModifierSettingKey)&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(q)),X.affectsConfiguration(treeIndentKey)){const te=q.getValue(treeIndentKey);J={...J,indent:te}}if(X.affectsConfiguration(treeRenderIndentGuidesKey)&&D.renderIndentGuides===void 0){const te=q.getValue(treeRenderIndentGuidesKey);J={...J,renderIndentGuides:te}}if(X.affectsConfiguration(listSmoothScrolling)){const te=!!q.getValue(listSmoothScrolling);J={...J,smoothScrolling:te}}if(X.affectsConfiguration(defaultFindModeSettingKey)||X.affectsConfiguration(keyboardNavigationSettingKey)){const te=getDefaultTreeFindMode(q);J={...J,defaultFindMode:te}}if(X.affectsConfiguration(typeNavigationModeSettingKey)||X.affectsConfiguration(keyboardNavigationSettingKey)){const te=O();J={...J,typeNavigationMode:te}}if(X.affectsConfiguration(defaultFindMatchTypeSettingKey)){const te=getDefaultTreeFindMatchType(q);J={...J,defaultFindMatchType:te}}if(X.affectsConfiguration(horizontalScrollingKey)&&D.horizontalScrolling===void 0){const te=!!q.getValue(horizontalScrollingKey);J={...J,horizontalScrolling:te}}if(X.affectsConfiguration(scrollByPageKey)){const te=!!q.getValue(scrollByPageKey);J={...J,scrollByPage:te}}if(X.affectsConfiguration(treeExpandMode)&&D.expandOnlyOnTwistieClick===void 0&&(J={...J,expandOnlyOnTwistieClick:q.getValue(treeExpandMode)==="doubleClick"}),X.affectsConfiguration(treeStickyScroll)){const te=q.getValue(treeStickyScroll);J={...J,enableStickyScroll:te}}if(X.affectsConfiguration(treeStickyScrollMaxElements)){const te=Math.max(1,q.getValue(treeStickyScrollMaxElements));J={...J,stickyScrollMaxItemCount:te}}if(X.affectsConfiguration(mouseWheelScrollSensitivityKey)){const te=q.getValue(mouseWheelScrollSensitivityKey);J={...J,mouseWheelScrollSensitivity:te}}if(X.affectsConfiguration(fastScrollSensitivityKey)){const te=q.getValue(fastScrollSensitivityKey);J={...J,fastScrollSensitivity:te}}Object.keys(J).length>0&&w.updateOptions(J)}),this.contextKeyService.onDidChangeContext(X=>{X.affectsSome(Y)&&w.updateOptions({typeNavigationMode:O()})})),this.navigator=new TreeResourceNavigator(w,{configurationService:q,...D}),this.disposables.push(this.navigator)}updateOptions(w){w.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!w.multipleSelectionSupport)}updateStyleOverrides(w){this.tree.style(w?getListStyles(w):defaultListStyles)}dispose(){this.disposables=dispose(this.disposables)}};WorkbenchTreeInternals=__decorate$p([__param$p(4,IContextKeyService),__param$p(5,IListService),__param$p(6,IConfigurationService)],WorkbenchTreeInternals);const configurationRegistry=Registry.as(Extensions$5.Configuration);configurationRegistry.registerConfiguration({id:"workbench",order:7,title:localize("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[multiSelectModifierSettingKey]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[localize("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),localize("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:localize({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[openModeSettingKey]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:localize({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[horizontalScrollingKey]:{type:"boolean",default:!1,description:localize("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[scrollByPageKey]:{type:"boolean",default:!1,description:localize("list.scrollByPage","Controls whether clicks in the scrollbar scroll page by page.")},[treeIndentKey]:{type:"number",default:8,minimum:4,maximum:40,description:localize("tree indent setting","Controls tree indentation in pixels.")},[treeRenderIndentGuidesKey]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:localize("render tree indent guides","Controls whether the tree should render indent guides.")},[listSmoothScrolling]:{type:"boolean",default:!1,description:localize("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[mouseWheelScrollSensitivityKey]:{type:"number",default:1,markdownDescription:localize("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[fastScrollSensitivityKey]:{type:"number",default:5,markdownDescription:localize("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[defaultFindModeSettingKey]:{type:"string",enum:["highlight","filter"],enumDescriptions:[localize("defaultFindModeSettingKey.highlight","Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),localize("defaultFindModeSettingKey.filter","Filter elements when searching.")],default:"highlight",description:localize("defaultFindModeSettingKey","Controls the default find mode for lists and trees in the workbench.")},[keyboardNavigationSettingKey]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[localize("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),localize("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),localize("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:localize("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:localize("keyboardNavigationSettingKeyDeprecated","Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[defaultFindMatchTypeSettingKey]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[localize("defaultFindMatchTypeSettingKey.fuzzy","Use fuzzy matching when searching."),localize("defaultFindMatchTypeSettingKey.contiguous","Use contiguous matching when searching.")],default:"fuzzy",description:localize("defaultFindMatchTypeSettingKey","Controls the type of matching used when searching lists and trees in the workbench.")},[treeExpandMode]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:localize("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[treeStickyScroll]:{type:"boolean",default:!0,description:localize("sticky scroll","Controls whether sticky scrolling is enabled in trees.")},[treeStickyScrollMaxElements]:{type:"number",minimum:1,default:7,markdownDescription:localize("sticky scroll maximum items","Controls the number of sticky elements displayed in the tree when {0} is enabled.","`#workbench.tree.enableStickyScroll#`")},[typeNavigationModeSettingKey]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:localize("typeNavigationMode2","Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});const $$2=$$8;class KeybindingLabel extends Disposable{constructor(w,D,O){super(),this.os=D,this.keyElements=new Set,this.options=O||Object.create(null);const W=this.options.keybindingLabelForeground;this.domNode=append$1(w,$$2(".monaco-keybinding")),W&&(this.domNode.style.color=W),this.hover=this._register(getBaseLayerHoverDelegate().setupManagedHover(getDefaultHoverDelegate("mouse"),this.domNode,"")),this.didEverRender=!1,w.appendChild(this.domNode)}get element(){return this.domNode}set(w,D){this.didEverRender&&this.keybinding===w&&KeybindingLabel.areSame(this.matches,D)||(this.keybinding=w,this.matches=D,this.render())}render(){if(this.clear(),this.keybinding){const w=this.keybinding.getChords();w[0]&&this.renderChord(this.domNode,w[0],this.matches?this.matches.firstPart:null);for(let O=1;O<w.length;O++)append$1(this.domNode,$$2("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,w[O],this.matches?this.matches.chordPart:null);const D=this.options.disableTitle??!1?void 0:this.keybinding.getAriaLabel()||void 0;this.hover.update(D),this.domNode.setAttribute("aria-label",D||"")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){clearNode(this.domNode),this.keyElements.clear()}renderChord(w,D,O){const W=UILabelProvider.modifierLabels[this.os];D.ctrlKey&&this.renderKey(w,W.ctrlKey,!!O?.ctrlKey,W.separator),D.shiftKey&&this.renderKey(w,W.shiftKey,!!O?.shiftKey,W.separator),D.altKey&&this.renderKey(w,W.altKey,!!O?.altKey,W.separator),D.metaKey&&this.renderKey(w,W.metaKey,!!O?.metaKey,W.separator);const U=D.keyLabel;U&&this.renderKey(w,U,!!O?.keyCode,"")}renderKey(w,D,O,W){append$1(w,this.createKeyElement(D,O?".highlight":"")),W&&append$1(w,$$2("span.monaco-keybinding-key-separator",void 0,W))}renderUnbound(w){append$1(w,this.createKeyElement(localize("unbound","Unbound")))}createKeyElement(w,D=""){const O=$$2("span.monaco-keybinding-key"+D,void 0,w);return this.keyElements.add(O),this.options.keybindingLabelBackground&&(O.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(O.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(O.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(O.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),O}static areSame(w,D){return w===D||!w&&!D?!0:!!w&&!!D&&equals(w.firstPart,D.firstPart)&&equals(w.chordPart,D.chordPart)}}const intlFileNameCollatorBaseNumeric=new Lazy(()=>{const F=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:F,collatorIsNumeric:F.resolvedOptions().numeric}});function compareFileNames(F,w,D=!1){const O=F||"",W=w||"",U=intlFileNameCollatorBaseNumeric.value.collator.compare(O,W);return intlFileNameCollatorBaseNumeric.value.collatorIsNumeric&&U===0&&O!==W?O<W?-1:1:U}function compareAnything(F,w,D){const O=F.toLowerCase(),W=w.toLowerCase(),U=compareByPrefix(F,w,D);if(U)return U;const K=O.endsWith(D),q=W.endsWith(D);if(K!==q)return K?-1:1;const G=compareFileNames(O,W);return G!==0?G:O.localeCompare(W)}function compareByPrefix(F,w,D){const O=F.toLowerCase(),W=w.toLowerCase(),U=O.startsWith(D),K=W.startsWith(D);if(U!==K)return U?-1:1;if(U&&K){if(O.length<W.length)return-1;if(O.length>W.length)return 1}return 0}var __decorate$o=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$o=function(F,w){return function(D,O){w(D,O,F)}},QuickPickItemElementRenderer_1;const $$1=$$8;class BaseQuickPickItemElement{constructor(w,D,O){this.index=w,this.hasCheckbox=D,this._hidden=!1,this._init=new Lazy(()=>{const W=O.label??"",U=parseLabelWithIcons(W).text.trim(),K=O.ariaLabel||[W,this.saneDescription,this.saneDetail].map(q=>getCodiconAriaLabel(q)).filter(q=>!!q).join(", ");return{saneLabel:W,saneSortLabel:U,saneAriaLabel:K}}),this._saneDescription=O.description,this._saneTooltip=O.tooltip}get saneLabel(){return this._init.value.saneLabel}get saneSortLabel(){return this._init.value.saneSortLabel}get saneAriaLabel(){return this._init.value.saneAriaLabel}get element(){return this._element}set element(w){this._element=w}get hidden(){return this._hidden}set hidden(w){this._hidden=w}get saneDescription(){return this._saneDescription}set saneDescription(w){this._saneDescription=w}get saneDetail(){return this._saneDetail}set saneDetail(w){this._saneDetail=w}get saneTooltip(){return this._saneTooltip}set saneTooltip(w){this._saneTooltip=w}get labelHighlights(){return this._labelHighlights}set labelHighlights(w){this._labelHighlights=w}get descriptionHighlights(){return this._descriptionHighlights}set descriptionHighlights(w){this._descriptionHighlights=w}get detailHighlights(){return this._detailHighlights}set detailHighlights(w){this._detailHighlights=w}}class QuickPickItemElement extends BaseQuickPickItemElement{constructor(w,D,O,W,U,K){super(w,D,U),this.fireButtonTriggered=O,this._onChecked=W,this.item=U,this._separator=K,this._checked=!1,this.onChecked=D?Event$1.map(Event$1.filter(this._onChecked.event,q=>q.element===this),q=>q.checked):Event$1.None,this._saneDetail=U.detail,this._labelHighlights=U.highlights?.label,this._descriptionHighlights=U.highlights?.description,this._detailHighlights=U.highlights?.detail}get separator(){return this._separator}set separator(w){this._separator=w}get checked(){return this._checked}set checked(w){w!==this._checked&&(this._checked=w,this._onChecked.fire({element:this,checked:w}))}get checkboxDisabled(){return!!this.item.disabled}}var QuickPickSeparatorFocusReason;(function(F){F[F.NONE=0]="NONE",F[F.MOUSE_HOVER=1]="MOUSE_HOVER",F[F.ACTIVE_ITEM=2]="ACTIVE_ITEM"})(QuickPickSeparatorFocusReason||(QuickPickSeparatorFocusReason={}));class QuickPickSeparatorElement extends BaseQuickPickItemElement{constructor(w,D,O){super(w,!1,O),this.fireSeparatorButtonTriggered=D,this.separator=O,this.children=new Array,this.focusInsideSeparator=QuickPickSeparatorFocusReason.NONE}}class QuickInputItemDelegate{getHeight(w){return w instanceof QuickPickSeparatorElement?30:w.saneDetail?44:22}getTemplateId(w){return w instanceof QuickPickItemElement?QuickPickItemElementRenderer.ID:QuickPickSeparatorElementRenderer.ID}}class QuickInputAccessibilityProvider{getWidgetAriaLabel(){return localize("quickInput","Quick Input")}getAriaLabel(w){return w.separator?.label?`${w.saneAriaLabel}, ${w.separator.label}`:w.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(w){return w.hasCheckbox?"checkbox":"option"}isChecked(w){if(!(!w.hasCheckbox||!(w instanceof QuickPickItemElement)))return{get value(){return w.checked},onDidChange:D=>w.onChecked(()=>D())}}}class BaseQuickInputListRenderer{constructor(w){this.hoverDelegate=w}renderTemplate(w){const D=Object.create(null);D.toDisposeElement=new DisposableStore,D.toDisposeTemplate=new DisposableStore,D.entry=append$1(w,$$1(".quick-input-list-entry"));const O=append$1(D.entry,$$1("label.quick-input-list-label"));D.toDisposeTemplate.add(addStandardDisposableListener(O,EventType$1.CLICK,Q=>{D.checkbox.offsetParent||Q.preventDefault()})),D.checkbox=append$1(O,$$1("input.quick-input-list-checkbox")),D.checkbox.type="checkbox";const W=append$1(O,$$1(".quick-input-list-rows")),U=append$1(W,$$1(".quick-input-list-row")),K=append$1(W,$$1(".quick-input-list-row"));D.label=new IconLabel(U,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),D.toDisposeTemplate.add(D.label),D.icon=prepend$1(D.label.element,$$1(".quick-input-list-icon"));const q=append$1(U,$$1(".quick-input-list-entry-keybinding"));D.keybinding=new KeybindingLabel(q,OS),D.toDisposeTemplate.add(D.keybinding);const G=append$1(K,$$1(".quick-input-list-label-meta"));return D.detail=new IconLabel(G,{supportHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),D.toDisposeTemplate.add(D.detail),D.separator=append$1(D.entry,$$1(".quick-input-list-separator")),D.actionBar=new ActionBar(D.entry,this.hoverDelegate?{hoverDelegate:this.hoverDelegate}:void 0),D.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),D.toDisposeTemplate.add(D.actionBar),D}disposeTemplate(w){w.toDisposeElement.dispose(),w.toDisposeTemplate.dispose()}disposeElement(w,D,O){O.toDisposeElement.clear(),O.actionBar.clear()}}let QuickPickItemElementRenderer=class extends BaseQuickInputListRenderer{static{QuickPickItemElementRenderer_1=this}static{this.ID="quickpickitem"}constructor(w,D){super(w),this.themeService=D,this._itemsWithSeparatorsFrequency=new Map}get templateId(){return QuickPickItemElementRenderer_1.ID}renderTemplate(w){const D=super.renderTemplate(w);return D.toDisposeTemplate.add(addStandardDisposableListener(D.checkbox,EventType$1.CHANGE,O=>{D.element.checked=D.checkbox.checked})),D}renderElement(w,D,O){const W=w.element;O.element=W,W.element=O.entry??void 0;const U=W.item;O.checkbox.checked=W.checked,O.toDisposeElement.add(W.onChecked(J=>O.checkbox.checked=J)),O.checkbox.disabled=W.checkboxDisabled;const{labelHighlights:K,descriptionHighlights:q,detailHighlights:G}=W;if(U.iconPath){const J=isDark(this.themeService.getColorTheme().type)?U.iconPath.dark:U.iconPath.light??U.iconPath.dark,te=URI.revive(J);O.icon.className="quick-input-list-icon",O.icon.style.backgroundImage=asCSSUrl(te)}else O.icon.style.backgroundImage="",O.icon.className=U.iconClass?`quick-input-list-icon ${U.iconClass}`:"";let Q;!W.saneTooltip&&W.saneDescription&&(Q={markdown:{value:W.saneDescription,supportThemeIcons:!0},markdownNotSupportedFallback:W.saneDescription});const Y={matches:K||[],descriptionTitle:Q,descriptionMatches:q||[],labelEscapeNewLines:!0};if(Y.extraClasses=U.iconClasses,Y.italic=U.italic,Y.strikethrough=U.strikethrough,O.entry.classList.remove("quick-input-list-separator-as-item"),O.label.setLabel(W.saneLabel,W.saneDescription,Y),O.keybinding.set(U.keybinding),W.saneDetail){let J;W.saneTooltip||(J={markdown:{value:W.saneDetail,supportThemeIcons:!0},markdownNotSupportedFallback:W.saneDetail}),O.detail.element.style.display="",O.detail.setLabel(W.saneDetail,void 0,{matches:G,title:J,labelEscapeNewLines:!0})}else O.detail.element.style.display="none";W.separator?.label?(O.separator.textContent=W.separator.label,O.separator.style.display="",this.addItemWithSeparator(W)):O.separator.style.display="none",O.entry.classList.toggle("quick-input-list-separator-border",!!W.separator);const X=U.buttons;X&&X.length?(O.actionBar.push(X.map((J,te)=>quickInputButtonToAction(J,`id-${te}`,()=>W.fireButtonTriggered({button:J,item:W.item}))),{icon:!0,label:!1}),O.entry.classList.add("has-actions")):O.entry.classList.remove("has-actions")}disposeElement(w,D,O){this.removeItemWithSeparator(w.element),super.disposeElement(w,D,O)}isItemWithSeparatorVisible(w){return this._itemsWithSeparatorsFrequency.has(w)}addItemWithSeparator(w){this._itemsWithSeparatorsFrequency.set(w,(this._itemsWithSeparatorsFrequency.get(w)||0)+1)}removeItemWithSeparator(w){const D=this._itemsWithSeparatorsFrequency.get(w)||0;D>1?this._itemsWithSeparatorsFrequency.set(w,D-1):this._itemsWithSeparatorsFrequency.delete(w)}};QuickPickItemElementRenderer=QuickPickItemElementRenderer_1=__decorate$o([__param$o(1,IThemeService)],QuickPickItemElementRenderer);class QuickPickSeparatorElementRenderer extends BaseQuickInputListRenderer{constructor(){super(...arguments),this._visibleSeparatorsFrequency=new Map}static{this.ID="quickpickseparator"}get templateId(){return QuickPickSeparatorElementRenderer.ID}get visibleSeparators(){return[...this._visibleSeparatorsFrequency.keys()]}isSeparatorVisible(w){return this._visibleSeparatorsFrequency.has(w)}renderTemplate(w){const D=super.renderTemplate(w);return D.checkbox.style.display="none",D}renderElement(w,D,O){const W=w.element;O.element=W,W.element=O.entry??void 0,W.element.classList.toggle("focus-inside",!!W.focusInsideSeparator);const U=W.separator,{labelHighlights:K,descriptionHighlights:q,detailHighlights:G}=W;O.icon.style.backgroundImage="",O.icon.className="";let Q;!W.saneTooltip&&W.saneDescription&&(Q={markdown:{value:W.saneDescription,supportThemeIcons:!0},markdownNotSupportedFallback:W.saneDescription});const Y={matches:K||[],descriptionTitle:Q,descriptionMatches:q||[],labelEscapeNewLines:!0};if(O.entry.classList.add("quick-input-list-separator-as-item"),O.label.setLabel(W.saneLabel,W.saneDescription,Y),W.saneDetail){let J;W.saneTooltip||(J={markdown:{value:W.saneDetail,supportThemeIcons:!0},markdownNotSupportedFallback:W.saneDetail}),O.detail.element.style.display="",O.detail.setLabel(W.saneDetail,void 0,{matches:G,title:J,labelEscapeNewLines:!0})}else O.detail.element.style.display="none";O.separator.style.display="none",O.entry.classList.add("quick-input-list-separator-border");const X=U.buttons;X&&X.length?(O.actionBar.push(X.map((J,te)=>quickInputButtonToAction(J,`id-${te}`,()=>W.fireSeparatorButtonTriggered({button:J,separator:W.separator}))),{icon:!0,label:!1}),O.entry.classList.add("has-actions")):O.entry.classList.remove("has-actions"),this.addSeparator(W)}disposeElement(w,D,O){this.removeSeparator(w.element),this.isSeparatorVisible(w.element)||w.element.element?.classList.remove("focus-inside"),super.disposeElement(w,D,O)}addSeparator(w){this._visibleSeparatorsFrequency.set(w,(this._visibleSeparatorsFrequency.get(w)||0)+1)}removeSeparator(w){const D=this._visibleSeparatorsFrequency.get(w)||0;D>1?this._visibleSeparatorsFrequency.set(w,D-1):this._visibleSeparatorsFrequency.delete(w)}}let QuickInputTree=class extends Disposable{constructor(w,D,O,W,U,K){super(),this.parent=w,this.hoverDelegate=D,this.linkOpenerDelegate=O,this.accessibilityService=K,this._onKeyDown=new Emitter$1,this._onLeave=new Emitter$1,this.onLeave=this._onLeave.event,this._visibleCountObservable=observableValue("VisibleCount",0),this.onChangedVisibleCount=Event$1.fromObservable(this._visibleCountObservable,this._store),this._allVisibleCheckedObservable=observableValue("AllVisibleChecked",!1),this.onChangedAllVisibleChecked=Event$1.fromObservable(this._allVisibleCheckedObservable,this._store),this._checkedCountObservable=observableValue("CheckedCount",0),this.onChangedCheckedCount=Event$1.fromObservable(this._checkedCountObservable,this._store),this._checkedElementsObservable=observableValueOpts({equalsFn:equals$1},new Array),this.onChangedCheckedElements=Event$1.fromObservable(this._checkedElementsObservable,this._store),this._onButtonTriggered=new Emitter$1,this.onButtonTriggered=this._onButtonTriggered.event,this._onSeparatorButtonTriggered=new Emitter$1,this.onSeparatorButtonTriggered=this._onSeparatorButtonTriggered.event,this._elementChecked=new Emitter$1,this._elementCheckedEventBufferer=new EventBufferer,this._hasCheckboxes=!1,this._inputElements=new Array,this._elementTree=new Array,this._itemElements=new Array,this._elementDisposable=this._register(new DisposableStore),this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._shouldLoop=!0,this._container=append$1(this.parent,$$1(".quick-input-list")),this._separatorRenderer=new QuickPickSeparatorElementRenderer(D),this._itemRenderer=U.createInstance(QuickPickItemElementRenderer,D),this._tree=this._register(U.createInstance(WorkbenchObjectTree,"QuickInput",this._container,new QuickInputItemDelegate,[this._itemRenderer,this._separatorRenderer],{filter:{filter(q){return q.hidden?0:q instanceof QuickPickSeparatorElement?2:1}},sorter:{compare:(q,G)=>{if(!this.sortByLabel||!this._lastQueryString)return 0;const Q=this._lastQueryString.toLowerCase();return compareEntries(q,G,Q)}},accessibilityProvider:new QuickInputAccessibilityProvider,setRowLineHeight:!1,multipleSelectionSupport:!1,hideTwistiesOfChildlessElements:!0,renderIndentGuides:RenderIndentGuides.None,findWidgetEnabled:!1,indent:0,horizontalScrolling:!1,allowNonCollapsibleParents:!0,alwaysConsumeMouseWheel:!0})),this._tree.getHTMLElement().id=W,this._registerListeners()}get onDidChangeFocus(){return Event$1.map(this._tree.onDidChangeFocus,w=>w.elements.filter(D=>D instanceof QuickPickItemElement).map(D=>D.item),this._store)}get onDidChangeSelection(){return Event$1.map(this._tree.onDidChangeSelection,w=>({items:w.elements.filter(D=>D instanceof QuickPickItemElement).map(D=>D.item),event:w.browserEvent}),this._store)}get displayed(){return this._container.style.display!=="none"}set displayed(w){this._container.style.display=w?"":"none"}get scrollTop(){return this._tree.scrollTop}set scrollTop(w){this._tree.scrollTop=w}get ariaLabel(){return this._tree.ariaLabel}set ariaLabel(w){this._tree.ariaLabel=w??""}set enabled(w){this._tree.getHTMLElement().style.pointerEvents=w?"":"none"}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(w){this._matchOnDescription=w}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(w){this._matchOnDetail=w}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(w){this._matchOnLabel=w}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(w){this._matchOnLabelMode=w}get sortByLabel(){return this._sortByLabel}set sortByLabel(w){this._sortByLabel=w}get shouldLoop(){return this._shouldLoop}set shouldLoop(w){this._shouldLoop=w}_registerListeners(){this._registerOnKeyDown(),this._registerOnContainerClick(),this._registerOnMouseMiddleClick(),this._registerOnTreeModelChanged(),this._registerOnElementChecked(),this._registerOnContextMenu(),this._registerHoverListeners(),this._registerSelectionChangeListener(),this._registerSeparatorActionShowingListeners()}_registerOnKeyDown(){this._register(this._tree.onKeyDown(w=>{const D=new StandardKeyboardEvent(w);switch(D.keyCode){case 10:this.toggleCheckbox();break}this._onKeyDown.fire(D)}))}_registerOnContainerClick(){this._register(addDisposableListener(this._container,EventType$1.CLICK,w=>{(w.x||w.y)&&this._onLeave.fire()}))}_registerOnMouseMiddleClick(){this._register(addDisposableListener(this._container,EventType$1.AUXCLICK,w=>{w.button===1&&this._onLeave.fire()}))}_registerOnTreeModelChanged(){this._register(this._tree.onDidChangeModel(()=>{const w=this._itemElements.filter(D=>!D.hidden).length;this._visibleCountObservable.set(w,void 0),this._hasCheckboxes&&this._updateCheckedObservables()}))}_registerOnElementChecked(){this._register(this._elementCheckedEventBufferer.wrapEvent(this._elementChecked.event,(w,D)=>D)(w=>this._updateCheckedObservables()))}_registerOnContextMenu(){this._register(this._tree.onContextMenu(w=>{w.element&&(w.browserEvent.preventDefault(),this._tree.setSelection([w.element]))}))}_registerHoverListeners(){const w=this._register(new ThrottledDelayer(this.hoverDelegate.delay));this._register(this._tree.onMouseOver(async D=>{if(isHTMLAnchorElement(D.browserEvent.target)){w.cancel();return}if(!(!isHTMLAnchorElement(D.browserEvent.relatedTarget)&&isAncestor$1(D.browserEvent.relatedTarget,D.element?.element)))try{await w.trigger(async()=>{D.element instanceof QuickPickItemElement&&this.showHover(D.element)})}catch(O){if(!isCancellationError(O))throw O}})),this._register(this._tree.onMouseOut(D=>{isAncestor$1(D.browserEvent.relatedTarget,D.element?.element)||w.cancel()}))}_registerSeparatorActionShowingListeners(){this._register(this._tree.onDidChangeFocus(w=>{const D=w.elements[0]?this._tree.getParentElement(w.elements[0]):null;for(const O of this._separatorRenderer.visibleSeparators){const W=O===D;!!(O.focusInsideSeparator&QuickPickSeparatorFocusReason.ACTIVE_ITEM)!==W&&(W?O.focusInsideSeparator|=QuickPickSeparatorFocusReason.ACTIVE_ITEM:O.focusInsideSeparator&=~QuickPickSeparatorFocusReason.ACTIVE_ITEM,this._tree.rerender(O))}})),this._register(this._tree.onMouseOver(w=>{const D=w.element?this._tree.getParentElement(w.element):null;for(const O of this._separatorRenderer.visibleSeparators){if(O!==D)continue;!!(O.focusInsideSeparator&QuickPickSeparatorFocusReason.MOUSE_HOVER)||(O.focusInsideSeparator|=QuickPickSeparatorFocusReason.MOUSE_HOVER,this._tree.rerender(O))}})),this._register(this._tree.onMouseOut(w=>{const D=w.element?this._tree.getParentElement(w.element):null;for(const O of this._separatorRenderer.visibleSeparators){if(O!==D)continue;!!(O.focusInsideSeparator&QuickPickSeparatorFocusReason.MOUSE_HOVER)&&(O.focusInsideSeparator&=~QuickPickSeparatorFocusReason.MOUSE_HOVER,this._tree.rerender(O))}}))}_registerSelectionChangeListener(){this._register(this._tree.onDidChangeSelection(w=>{const D=w.elements.filter(O=>O instanceof QuickPickItemElement);D.length!==w.elements.length&&(w.elements.length===1&&w.elements[0]instanceof QuickPickSeparatorElement&&(this._tree.setFocus([w.elements[0].children[0]]),this._tree.reveal(w.elements[0],0)),this._tree.setSelection(D))}))}setAllVisibleChecked(w){this._elementCheckedEventBufferer.bufferEvents(()=>{this._itemElements.forEach(D=>{!D.hidden&&!D.checkboxDisabled&&(D.checked=w)})})}setElements(w){this._elementDisposable.clear(),this._lastQueryString=void 0,this._inputElements=w,this._hasCheckboxes=this.parent.classList.contains("show-checkboxes");let D;this._itemElements=new Array,this._elementTree=w.reduce((O,W,U)=>{let K;if(W.type==="separator"){if(!W.buttons)return O;D=new QuickPickSeparatorElement(U,q=>this._onSeparatorButtonTriggered.fire(q),W),K=D}else{const q=U>0?w[U-1]:void 0;let G;q&&q.type==="separator"&&!q.buttons&&(D=void 0,G=q);const Q=new QuickPickItemElement(U,this._hasCheckboxes,Y=>this._onButtonTriggered.fire(Y),this._elementChecked,W,G);if(this._itemElements.push(Q),D)return D.children.push(Q),O;K=Q}return O.push(K),O},new Array),this._setElementsToTree(this._elementTree),this.accessibilityService.isScreenReaderOptimized()&&setTimeout(()=>{const O=this._tree.getHTMLElement().querySelector(".monaco-list-row.focused"),W=O?.parentNode;if(O&&W){const U=O.nextSibling;O.remove(),W.insertBefore(O,U)}},0)}setFocusedElements(w){const D=w.map(O=>this._itemElements.find(W=>W.item===O)).filter(O=>!!O).filter(O=>!O.hidden);if(this._tree.setFocus(D),w.length>0){const O=this._tree.getFocus()[0];O&&this._tree.reveal(O)}}getActiveDescendant(){return this._tree.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(w){const D=w.map(O=>this._itemElements.find(W=>W.item===O)).filter(O=>!!O);this._tree.setSelection(D)}getCheckedElements(){return this._itemElements.filter(w=>w.checked).map(w=>w.item)}setCheckedElements(w){this._elementCheckedEventBufferer.bufferEvents(()=>{const D=new Set;for(const O of w)D.add(O);for(const O of this._itemElements)O.checked=D.has(O.item)})}focus(w){if(this._itemElements.length)switch(w===QuickPickFocus.Second&&this._itemElements.length<2&&(w=QuickPickFocus.First),w){case QuickPickFocus.First:this._tree.scrollTop=0,this._tree.focusFirst(void 0,D=>D.element instanceof QuickPickItemElement);break;case QuickPickFocus.Second:{this._tree.scrollTop=0;let D=!1;this._tree.focusFirst(void 0,O=>O.element instanceof QuickPickItemElement?D?!0:(D=!D,!1):!1);break}case QuickPickFocus.Last:this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,D=>D.element instanceof QuickPickItemElement);break;case QuickPickFocus.Next:{const D=this._tree.getFocus();this._tree.focusNext(void 0,this._shouldLoop,void 0,W=>W.element instanceof QuickPickItemElement?(this._tree.reveal(W.element),!0):!1);const O=this._tree.getFocus();D.length&&D[0]===O[0]&&D[0]===this._itemElements[this._itemElements.length-1]&&this._onLeave.fire();break}case QuickPickFocus.Previous:{const D=this._tree.getFocus();this._tree.focusPrevious(void 0,this._shouldLoop,void 0,W=>{if(!(W.element instanceof QuickPickItemElement))return!1;const U=this._tree.getParentElement(W.element);return U===null||U.children[0]!==W.element?this._tree.reveal(W.element):this._tree.reveal(U),!0});const O=this._tree.getFocus();D.length&&D[0]===O[0]&&D[0]===this._itemElements[0]&&this._onLeave.fire();break}case QuickPickFocus.NextPage:this._tree.focusNextPage(void 0,D=>D.element instanceof QuickPickItemElement?(this._tree.reveal(D.element),!0):!1);break;case QuickPickFocus.PreviousPage:this._tree.focusPreviousPage(void 0,D=>{if(!(D.element instanceof QuickPickItemElement))return!1;const O=this._tree.getParentElement(D.element);return O===null||O.children[0]!==D.element?this._tree.reveal(D.element):this._tree.reveal(O),!0});break;case QuickPickFocus.NextSeparator:{let D=!1;const O=this._tree.getFocus()[0];this._tree.focusNext(void 0,!0,void 0,U=>{if(D)return!0;if(U.element instanceof QuickPickSeparatorElement)D=!0,this._separatorRenderer.isSeparatorVisible(U.element)?this._tree.reveal(U.element.children[0]):this._tree.reveal(U.element,0);else if(U.element instanceof QuickPickItemElement){if(U.element.separator)return this._itemRenderer.isItemWithSeparatorVisible(U.element)?this._tree.reveal(U.element):this._tree.reveal(U.element,0),!0;if(U.element===this._elementTree[0])return this._tree.reveal(U.element,0),!0}return!1});const W=this._tree.getFocus()[0];O===W&&(this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,U=>U.element instanceof QuickPickItemElement));break}case QuickPickFocus.PreviousSeparator:{let D,O=!!this._tree.getFocus()[0]?.separator;this._tree.focusPrevious(void 0,!0,void 0,W=>{if(W.element instanceof QuickPickSeparatorElement)O?D||(this._separatorRenderer.isSeparatorVisible(W.element)?this._tree.reveal(W.element):this._tree.reveal(W.element,0),D=W.element.children[0]):O=!0;else if(W.element instanceof QuickPickItemElement&&!D){if(W.element.separator)this._itemRenderer.isItemWithSeparatorVisible(W.element)?this._tree.reveal(W.element):this._tree.reveal(W.element,0),D=W.element;else if(W.element===this._elementTree[0])return this._tree.reveal(W.element,0),!0}return!1}),D&&this._tree.setFocus([D]);break}}}clearFocus(){this._tree.setFocus([])}domFocus(){this._tree.domFocus()}layout(w){this._tree.getHTMLElement().style.maxHeight=w?`${Math.floor(w/44)*44+6}px`:"",this._tree.layout()}filter(w){if(this._lastQueryString=w,!(this._sortByLabel||this._matchOnLabel||this._matchOnDescription||this._matchOnDetail))return this._tree.layout(),!1;const D=w;if(w=w.trim(),!w||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this._itemElements.forEach(O=>{O.labelHighlights=void 0,O.descriptionHighlights=void 0,O.detailHighlights=void 0,O.hidden=!1;const W=O.index&&this._inputElements[O.index-1];O.item&&(O.separator=W&&W.type==="separator"&&!W.buttons?W:void 0)});else{let O;this._itemElements.forEach(W=>{let U;this.matchOnLabelMode==="fuzzy"?U=this.matchOnLabel?matchesFuzzyIconAware(w,parseLabelWithIcons(W.saneLabel))??void 0:void 0:U=this.matchOnLabel?matchesContiguousIconAware(D,parseLabelWithIcons(W.saneLabel))??void 0:void 0;const K=this.matchOnDescription?matchesFuzzyIconAware(w,parseLabelWithIcons(W.saneDescription||""))??void 0:void 0,q=this.matchOnDetail?matchesFuzzyIconAware(w,parseLabelWithIcons(W.saneDetail||""))??void 0:void 0;if(U||K||q?(W.labelHighlights=U,W.descriptionHighlights=K,W.detailHighlights=q,W.hidden=!1):(W.labelHighlights=void 0,W.descriptionHighlights=void 0,W.detailHighlights=void 0,W.hidden=W.item?!W.item.alwaysShow:!0),W.item?W.separator=void 0:W.separator&&(W.hidden=!0),!this.sortByLabel){const G=W.index&&this._inputElements[W.index-1]||void 0;G?.type==="separator"&&!G.buttons&&(O=G),O&&!W.hidden&&(W.separator=O,O=void 0)}})}return this._setElementsToTree(this._sortByLabel&&w?this._itemElements:this._elementTree),this._tree.layout(),!0}toggleCheckbox(){this._elementCheckedEventBufferer.bufferEvents(()=>{const w=this._tree.getFocus().filter(O=>O instanceof QuickPickItemElement),D=this._allVisibleChecked(w);for(const O of w)O.checkboxDisabled||(O.checked=!D)})}style(w){this._tree.style(w)}toggleHover(){const w=this._tree.getFocus()[0];if(!w?.saneTooltip||!(w instanceof QuickPickItemElement))return;if(this._lastHover&&!this._lastHover.isDisposed){this._lastHover.dispose();return}this.showHover(w);const D=new DisposableStore;D.add(this._tree.onDidChangeFocus(O=>{O.elements[0]instanceof QuickPickItemElement&&this.showHover(O.elements[0])})),this._lastHover&&D.add(this._lastHover),this._elementDisposable.add(D)}_setElementsToTree(w){const D=new Array;for(const O of w)O instanceof QuickPickSeparatorElement?D.push({element:O,collapsible:!1,collapsed:!1,children:O.children.map(W=>({element:W,collapsible:!1,collapsed:!1}))}):D.push({element:O,collapsible:!1,collapsed:!1});this._tree.setChildren(null,D)}_allVisibleChecked(w,D=!0){for(let O=0,W=w.length;O<W;O++){const U=w[O];if(!U.hidden)if(U.checked)D=!0;else return!1}return D}_updateCheckedObservables(){transaction(w=>{this._allVisibleCheckedObservable.set(this._allVisibleChecked(this._itemElements,!1),w);const D=this._itemElements.filter(O=>O.checked).length;this._checkedCountObservable.set(D,w),this._checkedElementsObservable.set(this.getCheckedElements(),w)})}showHover(w){this._lastHover&&!this._lastHover.isDisposed&&(this.hoverDelegate.onDidHideHover?.(),this._lastHover?.dispose()),!(!w.element||!w.saneTooltip)&&(this._lastHover=this.hoverDelegate.showHover({content:w.saneTooltip,target:w.element,linkHandler:D=>{this.linkOpenerDelegate(D)},appearance:{showPointer:!0},container:this._container,position:{hoverPosition:1}},!1))}};__decorate$o([memoize],QuickInputTree.prototype,"onDidChangeFocus",null);__decorate$o([memoize],QuickInputTree.prototype,"onDidChangeSelection",null);QuickInputTree=__decorate$o([__param$o(4,IInstantiationService),__param$o(5,IAccessibilityService)],QuickInputTree);function matchesContiguousIconAware(F,w){const{text:D,iconOffsets:O}=w;if(!O||O.length===0)return matchesContiguous(F,D);const W=ltrim(D," "),U=D.length-W.length,K=matchesContiguous(F,W);if(K)for(const q of K){const G=O[q.start+U]+U;q.start+=G,q.end+=G}return K}function matchesContiguous(F,w){const D=w.toLowerCase().indexOf(F.toLowerCase());return D!==-1?[{start:D,end:D+F.length}]:null}function compareEntries(F,w,D){const O=F.labelHighlights||[],W=w.labelHighlights||[];return O.length&&!W.length?-1:!O.length&&W.length?1:O.length===0&&W.length===0?0:compareAnything(F.saneSortLabel,w.saneSortLabel,D)}const defaultCommandAndKeybindingRule={weight:200,when:ContextKeyExpr.and(ContextKeyExpr.equals(quickInputTypeContextKeyValue,"quickPick"),inQuickInputContext),metadata:{description:localize("quickPick","Used while in the context of the quick pick. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")}};function registerQuickPickCommandAndKeybindingRule(F,w={}){KeybindingsRegistry.registerCommandAndKeybindingRule({...defaultCommandAndKeybindingRule,...F,secondary:getSecondary(F.primary,F.secondary??[],w)})}const ctrlKeyMod=isMacintosh?256:2048;function getSecondary(F,w,D={}){return D.withAltMod&&w.push(512+F),D.withCtrlMod&&(w.push(ctrlKeyMod+F),D.withAltMod&&w.push(512+ctrlKeyMod+F)),D.withCmdMod&&isMacintosh&&(w.push(2048+F),D.withCtrlMod&&w.push(2304+F),D.withAltMod&&(w.push(2560+F),D.withCtrlMod&&w.push(2816+F))),w}function focusHandler(F,w){return D=>{const O=D.get(IQuickInputService).currentQuickInput;if(O)return w&&O.quickNavigate?O.focus(w):O.focus(F)}}registerQuickPickCommandAndKeybindingRule({id:"quickInput.pageNext",primary:12,handler:focusHandler(QuickPickFocus.NextPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});registerQuickPickCommandAndKeybindingRule({id:"quickInput.pagePrevious",primary:11,handler:focusHandler(QuickPickFocus.PreviousPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});registerQuickPickCommandAndKeybindingRule({id:"quickInput.first",primary:ctrlKeyMod+14,handler:focusHandler(QuickPickFocus.First)},{withAltMod:!0,withCmdMod:!0});registerQuickPickCommandAndKeybindingRule({id:"quickInput.last",primary:ctrlKeyMod+13,handler:focusHandler(QuickPickFocus.Last)},{withAltMod:!0,withCmdMod:!0});registerQuickPickCommandAndKeybindingRule({id:"quickInput.next",primary:18,handler:focusHandler(QuickPickFocus.Next)},{withCtrlMod:!0});registerQuickPickCommandAndKeybindingRule({id:"quickInput.previous",primary:16,handler:focusHandler(QuickPickFocus.Previous)},{withCtrlMod:!0});const nextSeparatorFallbackDesc=localize("quickInput.nextSeparatorWithQuickAccessFallback","If we're in quick access mode, this will navigate to the next item. If we are not in quick access mode, this will navigate to the next separator."),prevSeparatorFallbackDesc=localize("quickInput.previousSeparatorWithQuickAccessFallback","If we're in quick access mode, this will navigate to the previous item. If we are not in quick access mode, this will navigate to the previous separator.");isMacintosh?(registerQuickPickCommandAndKeybindingRule({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:2066,handler:focusHandler(QuickPickFocus.NextSeparator,QuickPickFocus.Next),metadata:{description:nextSeparatorFallbackDesc}}),registerQuickPickCommandAndKeybindingRule({id:"quickInput.nextSeparator",primary:2578,secondary:[2322],handler:focusHandler(QuickPickFocus.NextSeparator)},{withCtrlMod:!0}),registerQuickPickCommandAndKeybindingRule({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:2064,handler:focusHandler(QuickPickFocus.PreviousSeparator,QuickPickFocus.Previous),metadata:{description:prevSeparatorFallbackDesc}}),registerQuickPickCommandAndKeybindingRule({id:"quickInput.previousSeparator",primary:2576,secondary:[2320],handler:focusHandler(QuickPickFocus.PreviousSeparator)},{withCtrlMod:!0})):(registerQuickPickCommandAndKeybindingRule({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:530,handler:focusHandler(QuickPickFocus.NextSeparator,QuickPickFocus.Next),metadata:{description:nextSeparatorFallbackDesc}}),registerQuickPickCommandAndKeybindingRule({id:"quickInput.nextSeparator",primary:2578,handler:focusHandler(QuickPickFocus.NextSeparator)}),registerQuickPickCommandAndKeybindingRule({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:528,handler:focusHandler(QuickPickFocus.PreviousSeparator,QuickPickFocus.Previous),metadata:{description:prevSeparatorFallbackDesc}}),registerQuickPickCommandAndKeybindingRule({id:"quickInput.previousSeparator",primary:2576,handler:focusHandler(QuickPickFocus.PreviousSeparator)}));registerQuickPickCommandAndKeybindingRule({id:"quickInput.acceptInBackground",when:ContextKeyExpr.and(defaultCommandAndKeybindingRule.when,ContextKeyExpr.or(InputFocusedContext.negate(),endOfQuickInputBoxContext)),primary:17,weight:250,handler:F=>{F.get(IQuickInputService).currentQuickInput?.accept(!0)}},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});var __decorate$n=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$n=function(F,w){return function(D,O){w(D,O,F)}},QuickInputController_1;const $=$$8;let QuickInputController=class extends Disposable{static{QuickInputController_1=this}static{this.MAX_WIDTH=600}get currentQuickInput(){return this.controller??void 0}get container(){return this._container}constructor(w,D,O,W){super(),this.options=w,this.layoutService=D,this.instantiationService=O,this.contextKeyService=W,this.enabled=!0,this.onDidAcceptEmitter=this._register(new Emitter$1),this.onDidCustomEmitter=this._register(new Emitter$1),this.onDidTriggerButtonEmitter=this._register(new Emitter$1),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new Emitter$1),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new Emitter$1),this.onHide=this.onHideEmitter.event,this.inQuickInputContext=InQuickInputContextKey.bindTo(this.contextKeyService),this.quickInputTypeContext=QuickInputTypeContextKey.bindTo(this.contextKeyService),this.endOfQuickInputBoxContext=EndOfQuickInputBoxContextKey.bindTo(this.contextKeyService),this.idPrefix=w.idPrefix,this._container=w.container,this.styles=w.styles,this._register(Event$1.runAndSubscribe(onDidRegisterWindow,({window:U,disposables:K})=>this.registerKeyModsListeners(U,K),{window:mainWindow,disposables:this._store})),this._register(onWillUnregisterWindow(U=>{this.ui&&getWindow(this.ui.container)===U&&(this.reparentUI(this.layoutService.mainContainer),this.layout(this.layoutService.mainContainerDimension,this.layoutService.mainContainerOffset.quickPickTop))}))}registerKeyModsListeners(w,D){const O=W=>{this.keyMods.ctrlCmd=W.ctrlKey||W.metaKey,this.keyMods.alt=W.altKey};for(const W of[EventType$1.KEY_DOWN,EventType$1.KEY_UP,EventType$1.MOUSE_DOWN])D.add(addDisposableListener(w,W,O,!0))}getUI(w){if(this.ui)return w&&getWindow(this._container)!==getWindow(this.layoutService.activeContainer)&&(this.reparentUI(this.layoutService.activeContainer),this.layout(this.layoutService.activeContainerDimension,this.layoutService.activeContainerOffset.quickPickTop)),this.ui;const D=append$1(this._container,$(".quick-input-widget.show-file-icons"));D.tabIndex=-1,D.style.display="none";const O=createStyleSheet(D),W=append$1(D,$(".quick-input-titlebar")),U=this._register(new ActionBar(W,{hoverDelegate:this.options.hoverDelegate}));U.domNode.classList.add("quick-input-left-action-bar");const K=append$1(W,$(".quick-input-title")),q=this._register(new ActionBar(W,{hoverDelegate:this.options.hoverDelegate}));q.domNode.classList.add("quick-input-right-action-bar");const G=append$1(D,$(".quick-input-header")),Q=append$1(G,$("input.quick-input-check-all"));Q.type="checkbox",Q.setAttribute("aria-label",localize("quickInput.checkAll","Toggle all checkboxes")),this._register(addStandardDisposableListener(Q,EventType$1.CHANGE,Ne=>{const ze=Q.checked;Re.setAllVisibleChecked(ze)})),this._register(addDisposableListener(Q,EventType$1.CLICK,Ne=>{(Ne.x||Ne.y)&&te.setFocus()}));const Y=append$1(G,$(".quick-input-description")),X=append$1(G,$(".quick-input-and-message")),J=append$1(X,$(".quick-input-filter")),te=this._register(new QuickInputBox(J,this.styles.inputBox,this.styles.toggle));te.setAttribute("aria-describedby",`${this.idPrefix}message`);const ie=append$1(J,$(".quick-input-visible-count"));ie.setAttribute("aria-live","polite"),ie.setAttribute("aria-atomic","true");const se=new CountBadge(ie,{countFormat:localize({key:"quickInput.visibleCount",comment:["This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers."]},"{0} Results")},this.styles.countBadge),re=append$1(J,$(".quick-input-count"));re.setAttribute("aria-live","polite");const ae=new CountBadge(re,{countFormat:localize({key:"quickInput.countSelected",comment:["This tells the user how many items are selected in a list of items to select from. The items can be anything."]},"{0} Selected")},this.styles.countBadge),le=this._register(new ActionBar(G,{hoverDelegate:this.options.hoverDelegate}));le.domNode.classList.add("quick-input-inline-action-bar");const de=append$1(G,$(".quick-input-action")),oe=this._register(new Button(de,this.styles.button));oe.label=localize("ok","OK"),this._register(oe.onDidClick(Ne=>{this.onDidAcceptEmitter.fire()}));const ue=append$1(G,$(".quick-input-action")),pe=this._register(new Button(ue,{...this.styles.button,supportIcons:!0}));pe.label=localize("custom","Custom"),this._register(pe.onDidClick(Ne=>{this.onDidCustomEmitter.fire()}));const fe=append$1(X,$(`#${this.idPrefix}message.quick-input-message`)),Ce=this._register(new ProgressBar(D,this.styles.progressBar));Ce.getContainer().classList.add("quick-input-progress");const we=append$1(D,$(".quick-input-html-widget"));we.tabIndex=-1;const Oe=append$1(D,$(".quick-input-description")),Te=this.idPrefix+"list",Re=this._register(this.instantiationService.createInstance(QuickInputTree,D,this.options.hoverDelegate,this.options.linkOpenerDelegate,Te));te.setAttribute("aria-controls",Te),this._register(Re.onDidChangeFocus(()=>{te.setAttribute("aria-activedescendant",Re.getActiveDescendant()??"")})),this._register(Re.onChangedAllVisibleChecked(Ne=>{Q.checked=Ne})),this._register(Re.onChangedVisibleCount(Ne=>{se.setCount(Ne)})),this._register(Re.onChangedCheckedCount(Ne=>{ae.setCount(Ne)})),this._register(Re.onLeave(()=>{setTimeout(()=>{this.controller&&(te.setFocus(),this.controller instanceof QuickPick&&this.controller.canSelectMany&&Re.clearFocus())},0)}));const Me=trackFocus(D);return this._register(Me),this._register(addDisposableListener(D,EventType$1.FOCUS,Ne=>{const ze=this.getUI();if(isAncestor$1(Ne.relatedTarget,ze.inputContainer)){const Qe=ze.inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==Qe&&this.endOfQuickInputBoxContext.set(Qe)}isAncestor$1(Ne.relatedTarget,ze.container)||(this.inQuickInputContext.set(!0),this.previousFocusElement=isHTMLElement(Ne.relatedTarget)?Ne.relatedTarget:void 0)},!0)),this._register(Me.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(QuickInputHideReason.Blur),this.inQuickInputContext.set(!1),this.endOfQuickInputBoxContext.set(!1),this.previousFocusElement=void 0})),this._register(te.onKeyDown(Ne=>{const ze=this.getUI().inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==ze&&this.endOfQuickInputBoxContext.set(ze)})),this._register(addDisposableListener(D,EventType$1.FOCUS,Ne=>{te.setFocus()})),this._register(addStandardDisposableListener(D,EventType$1.KEY_DOWN,Ne=>{if(!isAncestor$1(Ne.target,we))switch(Ne.keyCode){case 3:EventHelper.stop(Ne,!0),this.enabled&&this.onDidAcceptEmitter.fire();break;case 9:EventHelper.stop(Ne,!0),this.hide(QuickInputHideReason.Gesture);break;case 2:if(!Ne.altKey&&!Ne.ctrlKey&&!Ne.metaKey){const ze=[".quick-input-list .monaco-action-bar .always-visible",".quick-input-list-entry:hover .monaco-action-bar",".monaco-list-row.focused .monaco-action-bar"];if(D.classList.contains("show-checkboxes")?ze.push("input"):ze.push("input[type=text]"),this.getUI().list.displayed&&ze.push(".monaco-list"),this.getUI().message&&ze.push(".quick-input-message a"),this.getUI().widget){if(isAncestor$1(Ne.target,this.getUI().widget))break;ze.push(".quick-input-html-widget")}const Qe=D.querySelectorAll(ze.join(", "));Ne.shiftKey&&Ne.target===Qe[0]?(EventHelper.stop(Ne,!0),Re.clearFocus()):!Ne.shiftKey&&isAncestor$1(Ne.target,Qe[Qe.length-1])&&(EventHelper.stop(Ne,!0),Qe[0].focus())}break;case 10:Ne.ctrlKey&&(EventHelper.stop(Ne,!0),this.getUI().list.toggleHover());break}})),this.ui={container:D,styleSheet:O,leftActionBar:U,titleBar:W,title:K,description1:Oe,description2:Y,widget:we,rightActionBar:q,inlineActionBar:le,checkAll:Q,inputContainer:X,filterContainer:J,inputBox:te,visibleCountContainer:ie,visibleCount:se,countContainer:re,count:ae,okContainer:de,ok:oe,message:fe,customButtonContainer:ue,customButton:pe,list:Re,progressBar:Ce,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,show:Ne=>this.show(Ne),hide:()=>this.hide(),setVisibilities:Ne=>this.setVisibilities(Ne),setEnabled:Ne=>this.setEnabled(Ne),setContextKey:Ne=>this.options.setContextKey(Ne),linkOpenerDelegate:Ne=>this.options.linkOpenerDelegate(Ne)},this.updateStyles(),this.ui}reparentUI(w){this.ui&&(this._container=w,append$1(this._container,this.ui.container))}pick(w,D={},O=CancellationToken.None){return new Promise((W,U)=>{let K=Y=>{K=W,D.onKeyMods?.(q.keyMods),W(Y)};if(O.isCancellationRequested){K(void 0);return}const q=this.createQuickPick({useSeparators:!0});let G;const Q=[q,q.onDidAccept(()=>{if(q.canSelectMany)K(q.selectedItems.slice()),q.hide();else{const Y=q.activeItems[0];Y&&(K(Y),q.hide())}}),q.onDidChangeActive(Y=>{const X=Y[0];X&&D.onDidFocus&&D.onDidFocus(X)}),q.onDidChangeSelection(Y=>{if(!q.canSelectMany){const X=Y[0];X&&(K(X),q.hide())}}),q.onDidTriggerItemButton(Y=>D.onDidTriggerItemButton&&D.onDidTriggerItemButton({...Y,removeItem:()=>{const X=q.items.indexOf(Y.item);if(X!==-1){const J=q.items.slice(),te=J.splice(X,1),ie=q.activeItems.filter(re=>re!==te[0]),se=q.keepScrollPosition;q.keepScrollPosition=!0,q.items=J,ie&&(q.activeItems=ie),q.keepScrollPosition=se}}})),q.onDidTriggerSeparatorButton(Y=>D.onDidTriggerSeparatorButton?.(Y)),q.onDidChangeValue(Y=>{G&&!Y&&(q.activeItems.length!==1||q.activeItems[0]!==G)&&(q.activeItems=[G])}),O.onCancellationRequested(()=>{q.hide()}),q.onDidHide(()=>{dispose(Q),K(void 0)})];q.title=D.title,D.value&&(q.value=D.value),q.canSelectMany=!!D.canPickMany,q.placeholder=D.placeHolder,q.ignoreFocusOut=!!D.ignoreFocusLost,q.matchOnDescription=!!D.matchOnDescription,q.matchOnDetail=!!D.matchOnDetail,q.matchOnLabel=D.matchOnLabel===void 0||D.matchOnLabel,q.quickNavigate=D.quickNavigate,q.hideInput=!!D.hideInput,q.contextKey=D.contextKey,q.busy=!0,Promise.all([w,D.activeItem]).then(([Y,X])=>{G=X,q.busy=!1,q.items=Y,q.canSelectMany&&(q.selectedItems=Y.filter(J=>J.type!=="separator"&&J.picked)),G&&(q.activeItems=[G])}),q.show(),Promise.resolve(w).then(void 0,Y=>{U(Y),q.hide()})})}createQuickPick(w={useSeparators:!1}){const D=this.getUI(!0);return new QuickPick(D)}createInputBox(){const w=this.getUI(!0);return new InputBox(w)}show(w){const D=this.getUI(!0);this.onShowEmitter.fire();const O=this.controller;this.controller=w,O?.didHide(),this.setEnabled(!0),D.leftActionBar.clear(),D.title.textContent="",D.description1.textContent="",D.description2.textContent="",reset(D.widget),D.rightActionBar.clear(),D.inlineActionBar.clear(),D.checkAll.checked=!1,D.inputBox.placeholder="",D.inputBox.password=!1,D.inputBox.showDecoration(Severity$2.Ignore),D.visibleCount.setCount(0),D.count.setCount(0),reset(D.message),D.progressBar.stop(),D.list.setElements([]),D.list.matchOnDescription=!1,D.list.matchOnDetail=!1,D.list.matchOnLabel=!0,D.list.sortByLabel=!0,D.ignoreFocusOut=!1,D.inputBox.toggles=void 0;const W=this.options.backKeybindingLabel();backButton.tooltip=W?localize("quickInput.backWithKeybinding","Back ({0})",W):localize("quickInput.back","Back"),D.container.style.display="",this.updateLayout(),D.inputBox.setFocus(),this.quickInputTypeContext.set(w.type)}isVisible(){return!!this.ui&&this.ui.container.style.display!=="none"}setVisibilities(w){const D=this.getUI();D.title.style.display=w.title?"":"none",D.description1.style.display=w.description&&(w.inputBox||w.checkAll)?"":"none",D.description2.style.display=w.description&&!(w.inputBox||w.checkAll)?"":"none",D.checkAll.style.display=w.checkAll?"":"none",D.inputContainer.style.display=w.inputBox?"":"none",D.filterContainer.style.display=w.inputBox?"":"none",D.visibleCountContainer.style.display=w.visibleCount?"":"none",D.countContainer.style.display=w.count?"":"none",D.okContainer.style.display=w.ok?"":"none",D.customButtonContainer.style.display=w.customButton?"":"none",D.message.style.display=w.message?"":"none",D.progressBar.getContainer().style.display=w.progressBar?"":"none",D.list.displayed=!!w.list,D.container.classList.toggle("show-checkboxes",!!w.checkBox),D.container.classList.toggle("hidden-input",!w.inputBox&&!w.description),this.updateLayout()}setEnabled(w){if(w!==this.enabled){this.enabled=w;for(const D of this.getUI().leftActionBar.viewItems)D.action.enabled=w;for(const D of this.getUI().rightActionBar.viewItems)D.action.enabled=w;this.getUI().checkAll.disabled=!w,this.getUI().inputBox.enabled=w,this.getUI().ok.enabled=w,this.getUI().list.enabled=w}}hide(w){const D=this.controller;if(!D)return;D.willHide(w);const O=this.ui?.container,W=O&&!isAncestorOfActiveElement(O);if(this.controller=null,this.onHideEmitter.fire(),O&&(O.style.display="none"),!W){let U=this.previousFocusElement;for(;U&&!U.offsetParent;)U=U.parentElement??void 0;U?.offsetParent?(U.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}D.didHide(w)}layout(w,D){this.dimension=w,this.titleBarOffset=D,this.updateLayout()}updateLayout(){if(this.ui&&this.isVisible()){this.ui.container.style.top=`${this.titleBarOffset}px`;const w=this.ui.container.style,D=Math.min(this.dimension.width*.62,QuickInputController_1.MAX_WIDTH);w.width=D+"px",w.marginLeft="-"+D/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(w){this.styles=w,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:w,quickInputBackground:D,quickInputForeground:O,widgetBorder:W,widgetShadow:U}=this.styles.widget;this.ui.titleBar.style.backgroundColor=w??"",this.ui.container.style.backgroundColor=D??"",this.ui.container.style.color=O??"",this.ui.container.style.border=W?`1px solid ${W}`:"",this.ui.container.style.boxShadow=U?`0 0 8px 2px ${U}`:"",this.ui.list.style(this.styles.list);const K=[];this.styles.pickerGroup.pickerGroupBorder&&K.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.pickerGroup.pickerGroupBorder}; }`),this.styles.pickerGroup.pickerGroupForeground&&K.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),this.styles.pickerGroup.pickerGroupForeground&&K.push(".quick-input-list .quick-input-list-separator-as-item { color: var(--vscode-descriptionForeground); }"),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(K.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&K.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&K.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&K.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&K.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&K.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),K.push("}"));const q=K.join(`
`);q!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=q)}}};QuickInputController=QuickInputController_1=__decorate$n([__param$n(1,ILayoutService),__param$n(2,IInstantiationService),__param$n(3,IContextKeyService)],QuickInputController);var __decorate$m=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$m=function(F,w){return function(D,O){w(D,O,F)}};let QuickInputService=class extends Themable{get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get currentQuickInput(){return this.controller.currentQuickInput}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(QuickAccessController))),this._quickAccess}constructor(w,D,O,W,U){super(O),this.instantiationService=w,this.contextKeyService=D,this.layoutService=W,this.configurationService=U,this._onShow=this._register(new Emitter$1),this._onHide=this._register(new Emitter$1),this.contexts=new Map}createController(w=this.layoutService,D){const O={idPrefix:"quickInput_",container:w.activeContainer,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:U=>this.setContextKey(U),linkOpenerDelegate:U=>{this.instantiationService.invokeFunction(K=>{K.get(IOpenerService).open(U,{allowCommands:!0,fromUserGesture:!0})})},returnFocus:()=>w.focus(),styles:this.computeStyles(),hoverDelegate:this._register(this.instantiationService.createInstance(QuickInputHoverDelegate))},W=this._register(this.instantiationService.createInstance(QuickInputController,{...O,...D}));return W.layout(w.activeContainerDimension,w.activeContainerOffset.quickPickTop),this._register(w.onDidLayoutActiveContainer(U=>{getWindow(w.activeContainer)===getWindow(W.container)&&W.layout(U,w.activeContainerOffset.quickPickTop)})),this._register(w.onDidChangeActiveContainer(()=>{W.isVisible()||W.layout(w.activeContainerDimension,w.activeContainerOffset.quickPickTop)})),this._register(W.onShow(()=>{this.resetContextKeys(),this._onShow.fire()})),this._register(W.onHide(()=>{this.resetContextKeys(),this._onHide.fire()})),W}setContextKey(w){let D;w&&(D=this.contexts.get(w),D||(D=new RawContextKey(w,!1).bindTo(this.contextKeyService),this.contexts.set(w,D))),!(D&&D.get())&&(this.resetContextKeys(),D?.set(!0))}resetContextKeys(){this.contexts.forEach(w=>{w.get()&&w.reset()})}pick(w,D,O=CancellationToken.None){return this.controller.pick(w,D,O)}createQuickPick(w={useSeparators:!1}){return this.controller.createQuickPick(w)}createInputBox(){return this.controller.createInputBox()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:asCssVariable(quickInputBackground),quickInputForeground:asCssVariable(quickInputForeground),quickInputTitleBackground:asCssVariable(quickInputTitleBackground),widgetBorder:asCssVariable(widgetBorder),widgetShadow:asCssVariable(widgetShadow)},inputBox:defaultInputBoxStyles,toggle:defaultToggleStyles,countBadge:defaultCountBadgeStyles,button:defaultButtonStyles,progressBar:defaultProgressBarStyles,keybindingLabel:defaultKeybindingLabelStyles,list:getListStyles({listBackground:quickInputBackground,listFocusBackground:quickInputListFocusBackground,listFocusForeground:quickInputListFocusForeground,listInactiveFocusForeground:quickInputListFocusForeground,listInactiveSelectionIconForeground:quickInputListFocusIconForeground,listInactiveFocusBackground:quickInputListFocusBackground,listFocusOutline:activeContrastBorder,listInactiveFocusOutline:activeContrastBorder}),pickerGroup:{pickerGroupBorder:asCssVariable(pickerGroupBorder),pickerGroupForeground:asCssVariable(pickerGroupForeground)}}}};QuickInputService=__decorate$m([__param$m(0,IInstantiationService),__param$m(1,IContextKeyService),__param$m(2,IThemeService),__param$m(3,ILayoutService),__param$m(4,IConfigurationService)],QuickInputService);var __decorate$l=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$l=function(F,w){return function(D,O){w(D,O,F)}};let EditorScopedQuickInputService=class extends QuickInputService{constructor(w,D,O,W,U,K){super(D,O,W,new EditorScopedLayoutService(w.getContainerDomNode(),U),K),this.host=void 0;const q=QuickInputEditorContribution.get(w);if(q){const G=q.widget;this.host={_serviceBrand:void 0,get mainContainer(){return G.getDomNode()},getContainer(){return G.getDomNode()},whenContainerStylesLoaded(){},get containers(){return[G.getDomNode()]},get activeContainer(){return G.getDomNode()},get mainContainerDimension(){return w.getLayoutInfo()},get activeContainerDimension(){return w.getLayoutInfo()},get onDidLayoutMainContainer(){return w.onDidLayoutChange},get onDidLayoutActiveContainer(){return w.onDidLayoutChange},get onDidLayoutContainer(){return Event$1.map(w.onDidLayoutChange,Q=>({container:G.getDomNode(),dimension:Q}))},get onDidChangeActiveContainer(){return Event$1.None},get onDidAddContainer(){return Event$1.None},get mainContainerOffset(){return{top:0,quickPickTop:0}},get activeContainerOffset(){return{top:0,quickPickTop:0}},focus:()=>w.focus()}}else this.host=void 0}createController(){return super.createController(this.host)}};EditorScopedQuickInputService=__decorate$l([__param$l(1,IInstantiationService),__param$l(2,IContextKeyService),__param$l(3,IThemeService),__param$l(4,ICodeEditorService),__param$l(5,IConfigurationService)],EditorScopedQuickInputService);let StandaloneQuickInputService=class{get activeService(){const w=this.codeEditorService.getFocusedCodeEditor();if(!w)throw new Error("Quick input service needs a focused editor to work.");let D=this.mapEditorToService.get(w);if(!D){const O=D=this.instantiationService.createInstance(EditorScopedQuickInputService,w);this.mapEditorToService.set(w,D),createSingleCallFunction(w.onDidDispose)(()=>{O.dispose(),this.mapEditorToService.delete(w)})}return D}get currentQuickInput(){return this.activeService.currentQuickInput}get quickAccess(){return this.activeService.quickAccess}constructor(w,D){this.instantiationService=w,this.codeEditorService=D,this.mapEditorToService=new Map}pick(w,D,O=CancellationToken.None){return this.activeService.pick(w,D,O)}createQuickPick(w={useSeparators:!1}){return this.activeService.createQuickPick(w)}createInputBox(){return this.activeService.createInputBox()}};StandaloneQuickInputService=__decorate$l([__param$l(0,IInstantiationService),__param$l(1,ICodeEditorService)],StandaloneQuickInputService);class QuickInputEditorContribution{static{this.ID="editor.controller.quickInput"}static get(w){return w.getContribution(QuickInputEditorContribution.ID)}constructor(w){this.editor=w,this.widget=new QuickInputEditorWidget(this.editor)}dispose(){this.widget.dispose()}}class QuickInputEditorWidget{static{this.ID="editor.contrib.quickInputWidget"}constructor(w){this.codeEditor=w,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return QuickInputEditorWidget.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}}registerEditorContribution(QuickInputEditorContribution.ID,QuickInputEditorContribution,4);class ParsedTokenThemeRule{constructor(w,D,O,W,U){this._parsedThemeRuleBrand=void 0,this.token=w,this.index=D,this.fontStyle=O,this.foreground=W,this.background=U}}function parseTokenTheme(F){if(!F||!Array.isArray(F))return[];const w=[];let D=0;for(let O=0,W=F.length;O<W;O++){const U=F[O];let K=-1;if(typeof U.fontStyle=="string"){K=0;const Q=U.fontStyle.split(" ");for(let Y=0,X=Q.length;Y<X;Y++)switch(Q[Y]){case"italic":K=K|1;break;case"bold":K=K|2;break;case"underline":K=K|4;break;case"strikethrough":K=K|8;break}}let q=null;typeof U.foreground=="string"&&(q=U.foreground);let G=null;typeof U.background=="string"&&(G=U.background),w[D++]=new ParsedTokenThemeRule(U.token||"",O,K,q,G)}return w}function resolveParsedTokenThemeRules(F,w){F.sort((Y,X)=>{const J=strcmp(Y.token,X.token);return J!==0?J:Y.index-X.index});let D=0,O="000000",W="ffffff";for(;F.length>=1&&F[0].token==="";){const Y=F.shift();Y.fontStyle!==-1&&(D=Y.fontStyle),Y.foreground!==null&&(O=Y.foreground),Y.background!==null&&(W=Y.background)}const U=new ColorMap;for(const Y of w)U.getId(Y);const K=U.getId(O),q=U.getId(W),G=new ThemeTrieElementRule(D,K,q),Q=new ThemeTrieElement(G);for(let Y=0,X=F.length;Y<X;Y++){const J=F[Y];Q.insert(J.token,J.fontStyle,U.getId(J.foreground),U.getId(J.background))}return new TokenTheme(U,Q)}const colorRegExp=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class ColorMap{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(w){if(w===null)return 0;const D=w.match(colorRegExp);if(!D)throw new Error("Illegal value for token color: "+w);w=D[1].toUpperCase();let O=this._color2id.get(w);return O||(O=++this._lastColorId,this._color2id.set(w,O),this._id2color[O]=Color.fromHex("#"+w),O)}getColorMap(){return this._id2color.slice(0)}}class TokenTheme{static createFromRawTokenTheme(w,D){return this.createFromParsedTokenTheme(parseTokenTheme(w),D)}static createFromParsedTokenTheme(w,D){return resolveParsedTokenThemeRules(w,D)}constructor(w,D){this._colorMap=w,this._root=D,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}_match(w){return this._root.match(w)}match(w,D){let O=this._cache.get(D);if(typeof O>"u"){const W=this._match(D),U=toStandardTokenType(D);O=(W.metadata|U<<8)>>>0,this._cache.set(D,O)}return(O|w<<0)>>>0}}const STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|regexp)\b/;function toStandardTokenType(F){const w=F.match(STANDARD_TOKEN_TYPE_REGEXP);if(!w)return 0;switch(w[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function strcmp(F,w){return F<w?-1:F>w?1:0}class ThemeTrieElementRule{constructor(w,D,O){this._themeTrieElementRuleBrand=void 0,this._fontStyle=w,this._foreground=D,this._background=O,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new ThemeTrieElementRule(this._fontStyle,this._foreground,this._background)}acceptOverwrite(w,D,O){w!==-1&&(this._fontStyle=w),D!==0&&(this._foreground=D),O!==0&&(this._background=O),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class ThemeTrieElement{constructor(w){this._themeTrieElementBrand=void 0,this._mainRule=w,this._children=new Map}match(w){if(w==="")return this._mainRule;const D=w.indexOf(".");let O,W;D===-1?(O=w,W=""):(O=w.substring(0,D),W=w.substring(D+1));const U=this._children.get(O);return typeof U<"u"?U.match(W):this._mainRule}insert(w,D,O,W){if(w===""){this._mainRule.acceptOverwrite(D,O,W);return}const U=w.indexOf(".");let K,q;U===-1?(K=w,q=""):(K=w.substring(0,U),q=w.substring(U+1));let G=this._children.get(K);typeof G>"u"&&(G=new ThemeTrieElement(this._mainRule.clone()),this._children.set(K,G)),G.insert(q,D,O,W)}}function generateTokensCSSForColorMap(F){const w=[];for(let D=1,O=F.length;D<O;D++){const W=F[D];w[D]=`.mtk${D} { color: ${W}; }`}return w.push(".mtki { font-style: italic; }"),w.push(".mtkb { font-weight: bold; }"),w.push(".mtku { text-decoration: underline; text-underline-position: under; }"),w.push(".mtks { text-decoration: line-through; }"),w.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),w.join(`
`)}const vs={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[editorBackground]:"#FFFFFE",[editorForeground]:"#000000",[editorInactiveSelection]:"#E5EBF1",[editorIndentGuide1]:"#D3D3D3",[editorActiveIndentGuide1]:"#939393",[editorSelectionHighlight]:"#ADD6FF4D"}},vs_dark={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[editorBackground]:"#1E1E1E",[editorForeground]:"#D4D4D4",[editorInactiveSelection]:"#3A3D41",[editorIndentGuide1]:"#404040",[editorActiveIndentGuide1]:"#707070",[editorSelectionHighlight]:"#ADD6FF26"}},hc_black={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[editorBackground]:"#000000",[editorForeground]:"#FFFFFF",[editorIndentGuide1]:"#FFFFFF",[editorActiveIndentGuide1]:"#FFFFFF"}},hc_light={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[editorBackground]:"#FFFFFF",[editorForeground]:"#292929",[editorIndentGuide1]:"#292929",[editorActiveIndentGuide1]:"#292929"}};function getIconsStyleSheet(F){const w=new DisposableStore,D=w.add(new Emitter$1),O=getIconRegistry();return w.add(O.onDidChange(()=>D.fire())),F&&w.add(F.onDidProductIconThemeChange(()=>D.fire())),{dispose:()=>w.dispose(),onDidChange:D.event,getCSS(){const W=F?F.getProductIconTheme():new UnthemedProductIconTheme,U={},K=[],q=[];for(const G of O.getIcons()){const Q=W.getIcon(G);if(!Q)continue;const Y=Q.font,X=`--vscode-icon-${G.id}-font-family`,J=`--vscode-icon-${G.id}-content`;Y?(U[Y.id]=Y.definition,q.push(`${X}: ${asCSSPropertyValue(Y.id)};`,`${J}: '${Q.fontCharacter}';`),K.push(`.codicon-${G.id}:before { content: '${Q.fontCharacter}'; font-family: ${asCSSPropertyValue(Y.id)}; }`)):(q.push(`${J}: '${Q.fontCharacter}'; ${X}: 'codicon';`),K.push(`.codicon-${G.id}:before { content: '${Q.fontCharacter}'; }`))}for(const G in U){const Q=U[G],Y=Q.weight?`font-weight: ${Q.weight};`:"",X=Q.style?`font-style: ${Q.style};`:"",J=Q.src.map(te=>`${asCSSUrl(te.location)} format('${te.format}')`).join(", ");K.push(`@font-face { src: ${J}; font-family: ${asCSSPropertyValue(G)};${Y}${X} font-display: block; }`)}return K.push(`:root { ${q.join(" ")} }`),K.join(`
`)}}}class UnthemedProductIconTheme{getIcon(w){const D=getIconRegistry();let O=w.defaults;for(;ThemeIcon.isThemeIcon(O);){const W=D.getIcon(O.id);if(!W)return;O=W.defaults}return O}}const VS_LIGHT_THEME_NAME="vs",VS_DARK_THEME_NAME="vs-dark",HC_BLACK_THEME_NAME="hc-black",HC_LIGHT_THEME_NAME="hc-light",colorRegistry=Registry.as(Extensions$3.ColorContribution),themingRegistry=Registry.as(Extensions$2.ThemingContribution);class StandaloneTheme{constructor(w,D){this.semanticHighlighting=!1,this.themeData=D;const O=D.base;w.length>0?(isBuiltinTheme(w)?this.id=w:this.id=O+" "+w,this.themeName=w):(this.id=O,this.themeName=O),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const w=new Map;for(const D in this.themeData.colors)w.set(D,Color.fromHex(this.themeData.colors[D]));if(this.themeData.inherit){const D=getBuiltinRules(this.themeData.base);for(const O in D.colors)w.has(O)||w.set(O,Color.fromHex(D.colors[O]))}this.colors=w}return this.colors}getColor(w,D){const O=this.getColors().get(w);if(O)return O;if(D!==!1)return this.getDefault(w)}getDefault(w){let D=this.defaultColors[w];return D||(D=colorRegistry.resolveDefaultColor(w,this),this.defaultColors[w]=D,D)}defines(w){return this.getColors().has(w)}get type(){switch(this.base){case VS_LIGHT_THEME_NAME:return ColorScheme.LIGHT;case HC_BLACK_THEME_NAME:return ColorScheme.HIGH_CONTRAST_DARK;case HC_LIGHT_THEME_NAME:return ColorScheme.HIGH_CONTRAST_LIGHT;default:return ColorScheme.DARK}}get tokenTheme(){if(!this._tokenTheme){let w=[],D=[];if(this.themeData.inherit){const U=getBuiltinRules(this.themeData.base);w=U.rules,U.encodedTokensColors&&(D=U.encodedTokensColors)}const O=this.themeData.colors["editor.foreground"],W=this.themeData.colors["editor.background"];if(O||W){const U={token:""};O&&(U.foreground=O),W&&(U.background=W),w.push(U)}w=w.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(D=this.themeData.encodedTokensColors),this._tokenTheme=TokenTheme.createFromRawTokenTheme(w,D)}return this._tokenTheme}getTokenStyleMetadata(w,D,O){const U=this.tokenTheme._match([w].concat(D).join(".")).metadata,K=TokenMetadata.getForeground(U),q=TokenMetadata.getFontStyle(U);return{foreground:K,italic:!!(q&1),bold:!!(q&2),underline:!!(q&4),strikethrough:!!(q&8)}}}function isBuiltinTheme(F){return F===VS_LIGHT_THEME_NAME||F===VS_DARK_THEME_NAME||F===HC_BLACK_THEME_NAME||F===HC_LIGHT_THEME_NAME}function getBuiltinRules(F){switch(F){case VS_LIGHT_THEME_NAME:return vs;case VS_DARK_THEME_NAME:return vs_dark;case HC_BLACK_THEME_NAME:return hc_black;case HC_LIGHT_THEME_NAME:return hc_light}}function newBuiltInTheme(F){const w=getBuiltinRules(F);return new StandaloneTheme(F,w)}class StandaloneThemeService extends Disposable{constructor(){super(),this._onColorThemeChange=this._register(new Emitter$1),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new Emitter$1),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new UnthemedProductIconTheme,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(VS_LIGHT_THEME_NAME,newBuiltInTheme(VS_LIGHT_THEME_NAME)),this._knownThemes.set(VS_DARK_THEME_NAME,newBuiltInTheme(VS_DARK_THEME_NAME)),this._knownThemes.set(HC_BLACK_THEME_NAME,newBuiltInTheme(HC_BLACK_THEME_NAME)),this._knownThemes.set(HC_LIGHT_THEME_NAME,newBuiltInTheme(HC_LIGHT_THEME_NAME));const w=this._register(getIconsStyleSheet(this));this._codiconCSS=w.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(VS_LIGHT_THEME_NAME),this._onOSSchemeChanged(),this._register(w.onDidChange(()=>{this._codiconCSS=w.getCSS(),this._updateCSS()})),addMatchMediaChangeListener(mainWindow,"(forced-colors: active)",()=>{this._onOSSchemeChanged()})}registerEditorContainer(w){return isInShadowDOM(w)?this._registerShadowDomContainer(w):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=createStyleSheet(void 0,w=>{w.className="monaco-colors",w.textContent=this._allCSS}),this._styleElements.push(this._globalStyleElement)),Disposable.None}_registerShadowDomContainer(w){const D=createStyleSheet(w,O=>{O.className="monaco-colors",O.textContent=this._allCSS});return this._styleElements.push(D),{dispose:()=>{for(let O=0;O<this._styleElements.length;O++)if(this._styleElements[O]===D){this._styleElements.splice(O,1);return}}}}defineTheme(w,D){if(!/^[a-z0-9\-]+$/i.test(w))throw new Error("Illegal theme name!");if(!isBuiltinTheme(D.base)&&!isBuiltinTheme(w))throw new Error("Illegal theme base!");this._knownThemes.set(w,new StandaloneTheme(w,D)),isBuiltinTheme(w)&&this._knownThemes.forEach(O=>{O.base===w&&O.notifyBaseUpdated()}),this._theme.themeName===w&&this.setTheme(w)}getColorTheme(){return this._theme}setColorMapOverride(w){this._colorMapOverride=w,this._updateThemeOrColorMap()}setTheme(w){let D;this._knownThemes.has(w)?D=this._knownThemes.get(w):D=this._knownThemes.get(VS_LIGHT_THEME_NAME),this._updateActualTheme(D)}_updateActualTheme(w){!w||this._theme===w||(this._theme=w,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const w=mainWindow.matchMedia("(forced-colors: active)").matches;if(w!==isHighContrast(this._theme.type)){let D;isDark(this._theme.type)?D=w?HC_BLACK_THEME_NAME:VS_DARK_THEME_NAME:D=w?HC_LIGHT_THEME_NAME:VS_LIGHT_THEME_NAME,this._updateActualTheme(this._knownThemes.get(D))}}}setAutoDetectHighContrast(w){this._autoDetectHighContrast=w,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const w=[],D={},O={addRule:K=>{D[K]||(w.push(K),D[K]=!0)}};themingRegistry.getThemingParticipants().forEach(K=>K(this._theme,O,this._environment));const W=[];for(const K of colorRegistry.getColors()){const q=this._theme.getColor(K.id,!0);q&&W.push(`${asCssVariableName(K.id)}: ${q.toString()};`)}O.addRule(`.monaco-editor, .monaco-diff-editor, .monaco-component { ${W.join(`
`)} }`);const U=this._colorMapOverride||this._theme.tokenTheme.getColorMap();O.addRule(generateTokensCSSForColorMap(U)),this._themeCSS=w.join(`
`),this._updateCSS(),TokenizationRegistry.setColorMap(U),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(w=>w.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}const IStandaloneThemeService=createDecorator("themeService");var __decorate$k=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$k=function(F,w){return function(D,O){w(D,O,F)}};let AccessibilityService=class extends Disposable{constructor(w,D,O){super(),this._contextKeyService=w,this._layoutService=D,this._configurationService=O,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new Emitter$1,this._onDidChangeReducedMotion=new Emitter$1,this._onDidChangeLinkUnderline=new Emitter$1,this._accessibilityModeEnabledContext=CONTEXT_ACCESSIBILITY_MODE_ENABLED.bindTo(this._contextKeyService);const W=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(K=>{K.affectsConfiguration("editor.accessibilitySupport")&&(W(),this._onDidChangeScreenReaderOptimized.fire()),K.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())})),W(),this._register(this.onDidChangeScreenReaderOptimized(()=>W()));const U=mainWindow.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=U.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._linkUnderlinesEnabled=this._configurationService.getValue("accessibility.underlineLinks"),this.initReducedMotionListeners(U),this.initLinkUnderlineListeners()}initReducedMotionListeners(w){this._register(addDisposableListener(w,"change",()=>{this._systemMotionReduced=w.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()}));const D=()=>{const O=this.isMotionReduced();this._layoutService.mainContainer.classList.toggle("reduce-motion",O),this._layoutService.mainContainer.classList.toggle("enable-motion",!O)};D(),this._register(this.onDidChangeReducedMotion(()=>D()))}initLinkUnderlineListeners(){this._register(this._configurationService.onDidChangeConfiguration(D=>{if(D.affectsConfiguration("accessibility.underlineLinks")){const O=this._configurationService.getValue("accessibility.underlineLinks");this._linkUnderlinesEnabled=O,this._onDidChangeLinkUnderline.fire()}}));const w=()=>{const D=this._linkUnderlinesEnabled;this._layoutService.mainContainer.classList.toggle("underline-links",D)};w(),this._register(this.onDidChangeLinkUnderlines(()=>w()))}onDidChangeLinkUnderlines(w){return this._onDidChangeLinkUnderline.event(w)}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const w=this._configurationService.getValue("editor.accessibilitySupport");return w==="on"||w==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const w=this._configMotionReduced;return w==="on"||w==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};AccessibilityService=__decorate$k([__param$k(0,IContextKeyService),__param$k(1,ILayoutService),__param$k(2,IConfigurationService)],AccessibilityService);var __decorate$j=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$j=function(F,w){return function(D,O){w(D,O,F)}},PersistedMenuHideState_1,MenuInfo_1;let MenuService=class{constructor(w,D,O){this._commandService=w,this._keybindingService=D,this._hiddenStates=new PersistedMenuHideState(O)}createMenu(w,D,O){return new MenuImpl(w,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...O},this._commandService,this._keybindingService,D)}getMenuActions(w,D,O){const W=new MenuImpl(w,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...O},this._commandService,this._keybindingService,D),U=W.getActions(O);return W.dispose(),U}resetHiddenStates(w){this._hiddenStates.reset(w)}};MenuService=__decorate$j([__param$j(0,ICommandService),__param$j(1,IKeybindingService),__param$j(2,IStorageService)],MenuService);let PersistedMenuHideState=class{static{PersistedMenuHideState_1=this}static{this._key="menu.hiddenCommands"}constructor(w){this._storageService=w,this._disposables=new DisposableStore,this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event,this._ignoreChangeEvent=!1,this._hiddenByDefaultCache=new Map;try{const D=w.get(PersistedMenuHideState_1._key,0,"{}");this._data=JSON.parse(D)}catch{this._data=Object.create(null)}this._disposables.add(w.onDidChangeValue(0,PersistedMenuHideState_1._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{const D=w.get(PersistedMenuHideState_1._key,0,"{}");this._data=JSON.parse(D)}catch(D){console.log("FAILED to read storage after UPDATE",D)}this._onDidChange.fire()}))}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(w,D){return this._hiddenByDefaultCache.get(`${w.id}/${D}`)??!1}setDefaultState(w,D,O){this._hiddenByDefaultCache.set(`${w.id}/${D}`,O)}isHidden(w,D){const O=this._isHiddenByDefault(w,D),W=this._data[w.id]?.includes(D)??!1;return O?!W:W}updateHidden(w,D,O){this._isHiddenByDefault(w,D)&&(O=!O);const U=this._data[w.id];if(O)U?U.indexOf(D)<0&&U.push(D):this._data[w.id]=[D];else if(U){const K=U.indexOf(D);K>=0&&removeFastWithoutKeepingOrder(U,K),U.length===0&&delete this._data[w.id]}this._persist()}reset(w){if(w===void 0)this._data=Object.create(null),this._persist();else{for(const{id:D}of w)this._data[D]&&delete this._data[D];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;const w=JSON.stringify(this._data);this._storageService.store(PersistedMenuHideState_1._key,w,0,0)}finally{this._ignoreChangeEvent=!1}}};PersistedMenuHideState=PersistedMenuHideState_1=__decorate$j([__param$j(0,IStorageService)],PersistedMenuHideState);class MenuInfoSnapshot{constructor(w,D){this._id=w,this._collectContextKeysForSubmenus=D,this._menuGroups=[],this._allMenuIds=new Set,this._structureContextKeys=new Set,this._preconditionContextKeys=new Set,this._toggledContextKeys=new Set,this.refresh()}get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();const w=this._sort(MenuRegistry.getMenuItems(this._id));let D;for(const O of w){const W=O.group||"";(!D||D[0]!==W)&&(D=[W,[]],this._menuGroups.push(D)),D[1].push(O),this._collectContextKeysAndSubmenuIds(O)}this._allMenuIds.add(this._id)}_sort(w){return w}_collectContextKeysAndSubmenuIds(w){if(MenuInfoSnapshot._fillInKbExprKeys(w.when,this._structureContextKeys),isIMenuItem(w)){if(w.command.precondition&&MenuInfoSnapshot._fillInKbExprKeys(w.command.precondition,this._preconditionContextKeys),w.command.toggled){const D=w.command.toggled.condition||w.command.toggled;MenuInfoSnapshot._fillInKbExprKeys(D,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(MenuRegistry.getMenuItems(w.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(w.submenu))}static _fillInKbExprKeys(w,D){if(w)for(const O of w.keys())D.add(O)}}let MenuInfo=MenuInfo_1=class extends MenuInfoSnapshot{constructor(w,D,O,W,U,K){super(w,O),this._hiddenStates=D,this._commandService=W,this._keybindingService=U,this._contextKeyService=K,this.refresh()}createActionGroups(w){const D=[];for(const O of this._menuGroups){const[W,U]=O;let K;for(const q of U)if(this._contextKeyService.contextMatchesRules(q.when)){const G=isIMenuItem(q);G&&this._hiddenStates.setDefaultState(this._id,q.command.id,!!q.isHiddenByDefault);const Q=createMenuHide(this._id,G?q.command:q,this._hiddenStates);if(G){const Y=createConfigureKeybindingAction(this._commandService,this._keybindingService,q.command.id,q.when);(K??=[]).push(new MenuItemAction(q.command,q.alt,w,Q,Y,this._contextKeyService,this._commandService))}else{const Y=new MenuInfo_1(q.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(w),X=Separator.join(...Y.map(J=>J[1]));X.length>0&&(K??=[]).push(new SubmenuItemAction(q,Q,X))}}K&&K.length>0&&D.push([W,K])}return D}_sort(w){return w.sort(MenuInfo_1._compareMenuItems)}static _compareMenuItems(w,D){const O=w.group,W=D.group;if(O!==W){if(O){if(!W)return-1}else return 1;if(O==="navigation")return-1;if(W==="navigation")return 1;const q=O.localeCompare(W);if(q!==0)return q}const U=w.order||0,K=D.order||0;return U<K?-1:U>K?1:MenuInfo_1._compareTitles(isIMenuItem(w)?w.command.title:w.title,isIMenuItem(D)?D.command.title:D.title)}static _compareTitles(w,D){const O=typeof w=="string"?w:w.original,W=typeof D=="string"?D:D.original;return O.localeCompare(W)}};MenuInfo=MenuInfo_1=__decorate$j([__param$j(3,ICommandService),__param$j(4,IKeybindingService),__param$j(5,IContextKeyService)],MenuInfo);let MenuImpl=class{constructor(w,D,O,W,U,K){this._disposables=new DisposableStore,this._menuInfo=new MenuInfo(w,D,O.emitEventsForSubmenuChanges,W,U,K);const q=new RunOnceScheduler(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},O.eventDebounceDelay);this._disposables.add(q),this._disposables.add(MenuRegistry.onDidChangeMenu(X=>{for(const J of this._menuInfo.allMenuIds)if(X.has(J)){q.schedule();break}}));const G=this._disposables.add(new DisposableStore),Q=X=>{let J=!1,te=!1,ie=!1;for(const se of X)if(J=J||se.isStructuralChange,te=te||se.isEnablementChange,ie=ie||se.isToggleChange,J&&te&&ie)break;return{menu:this,isStructuralChange:J,isEnablementChange:te,isToggleChange:ie}},Y=()=>{G.add(K.onDidChangeContext(X=>{const J=X.affectsSome(this._menuInfo.structureContextKeys),te=X.affectsSome(this._menuInfo.preconditionContextKeys),ie=X.affectsSome(this._menuInfo.toggledContextKeys);(J||te||ie)&&this._onDidChange.fire({menu:this,isStructuralChange:J,isEnablementChange:te,isToggleChange:ie})})),G.add(D.onDidChange(X=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new DebounceEmitter({onWillAddFirstListener:Y,onDidRemoveLastListener:G.clear.bind(G),delay:O.eventDebounceDelay,merge:Q}),this.onDidChange=this._onDidChange.event}getActions(w){return this._menuInfo.createActionGroups(w)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};MenuImpl=__decorate$j([__param$j(3,ICommandService),__param$j(4,IKeybindingService),__param$j(5,IContextKeyService)],MenuImpl);function createMenuHide(F,w,D){const O=isISubmenuItem(w)?w.submenu.id:w.id,W=typeof w.title=="string"?w.title:w.title.value,U=toAction({id:`hide/${F.id}/${O}`,label:localize("hide.label","Hide '{0}'",W),run(){D.updateHidden(F,O,!0)}}),K=toAction({id:`toggle/${F.id}/${O}`,label:W,get checked(){return!D.isHidden(F,O)},run(){D.updateHidden(F,O,!!this.checked)}});return{hide:U,toggle:K,get isHidden(){return!K.checked}}}function createConfigureKeybindingAction(F,w,D,O=void 0,W=!0){return toAction({id:`configureKeybinding/${D}`,label:localize("configure keybinding","Configure Keybinding"),enabled:W,run(){const K=!!!w.lookupKeybinding(D)&&O?O.serialize():void 0;F.executeCommand("workbench.action.openGlobalKeybindings",`@command:${D}`+(K?` +when:${K}`:""))}})}var __decorate$i=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$i=function(F,w){return function(D,O){w(D,O,F)}},BrowserClipboardService_1;const vscodeResourcesMime="application/vnd.code.resources";let BrowserClipboardService=class extends Disposable{static{BrowserClipboardService_1=this}constructor(w,D){super(),this.layoutService=w,this.logService=D,this.mapTextToType=new Map,this.findText="",this.resources=[],this.resourcesStateHash=void 0,(isSafari$1||isWebkitWebView)&&this.installWebKitWriteTextWorkaround(),this._register(Event$1.runAndSubscribe(onDidRegisterWindow,({window:O,disposables:W})=>{W.add(addDisposableListener(O.document,"copy",()=>this.clearResourcesState()))},{window:mainWindow,disposables:this._store}))}installWebKitWriteTextWorkaround(){const w=()=>{const D=new DeferredPromise;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=D,getActiveWindow().navigator.clipboard.write([new ClipboardItem({"text/plain":D.p})]).catch(async O=>{(!(O instanceof Error)||O.name!=="NotAllowedError"||!D.isRejected)&&this.logService.error(O)})};this._register(Event$1.runAndSubscribe(this.layoutService.onDidAddContainer,({container:D,disposables:O})=>{O.add(addDisposableListener(D,"click",w)),O.add(addDisposableListener(D,"keydown",w))},{container:this.layoutService.mainContainer,disposables:this._store}))}async writeText(w,D){if(this.clearResourcesState(),D){this.mapTextToType.set(D,w);return}if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(w);try{return await getActiveWindow().navigator.clipboard.writeText(w)}catch(O){console.error(O)}this.fallbackWriteText(w)}fallbackWriteText(w){const D=getActiveDocument(),O=D.activeElement,W=D.body.appendChild($$8("textarea",{"aria-hidden":!0}));W.style.height="1px",W.style.width="1px",W.style.position="absolute",W.value=w,W.focus(),W.select(),D.execCommand("copy"),isHTMLElement(O)&&O.focus(),W.remove()}async readText(w){if(w)return this.mapTextToType.get(w)||"";try{return await getActiveWindow().navigator.clipboard.readText()}catch(D){console.error(D)}return""}async readFindText(){return this.findText}async writeFindText(w){this.findText=w}static{this.MAX_RESOURCE_STATE_SOURCE_LENGTH=1e3}async readResources(){try{const D=await getActiveWindow().navigator.clipboard.read();for(const O of D)if(O.types.includes(`web ${vscodeResourcesMime}`)){const W=await O.getType(`web ${vscodeResourcesMime}`);return JSON.parse(await W.text()).map(K=>URI.from(K))}}catch{}const w=await this.computeResourcesStateHash();return this.resourcesStateHash!==w&&this.clearResourcesState(),this.resources}async computeResourcesStateHash(){if(this.resources.length===0)return;const w=await this.readText();return hash(w.substring(0,BrowserClipboardService_1.MAX_RESOURCE_STATE_SOURCE_LENGTH))}clearInternalState(){this.clearResourcesState()}clearResourcesState(){this.resources=[],this.resourcesStateHash=void 0}};BrowserClipboardService=BrowserClipboardService_1=__decorate$i([__param$i(0,ILayoutService),__param$i(1,ILogService)],BrowserClipboardService);var __decorate$h=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$h=function(F,w){return function(D,O){w(D,O,F)}};const KEYBINDING_CONTEXT_ATTR="data-keybinding-context";class Context{constructor(w,D){this._id=w,this._parent=D,this._value=Object.create(null),this._value._contextId=w}get value(){return{...this._value}}setValue(w,D){return this._value[w]!==D?(this._value[w]=D,!0):!1}removeValue(w){return w in this._value?(delete this._value[w],!0):!1}getValue(w){const D=this._value[w];return typeof D>"u"&&this._parent?this._parent.getValue(w):D}}class NullContext extends Context{static{this.INSTANCE=new NullContext}constructor(){super(-1,null)}setValue(w,D){return!1}removeValue(w){return!1}getValue(w){}}class ConfigAwareContextValuesContainer extends Context{static{this._keyPrefix="config."}constructor(w,D,O){super(w,null),this._configurationService=D,this._values=TernarySearchTree.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(W=>{if(W.source===7){const U=Array.from(this._values,([K])=>K);this._values.clear(),O.fire(new ArrayContextKeyChangeEvent(U))}else{const U=[];for(const K of W.affectedKeys){const q=`config.${K}`,G=this._values.findSuperstr(q);G!==void 0&&(U.push(...Iterable.map(G,([Q])=>Q)),this._values.deleteSuperstr(q)),this._values.has(q)&&(U.push(q),this._values.delete(q))}O.fire(new ArrayContextKeyChangeEvent(U))}})}dispose(){this._listener.dispose()}getValue(w){if(w.indexOf(ConfigAwareContextValuesContainer._keyPrefix)!==0)return super.getValue(w);if(this._values.has(w))return this._values.get(w);const D=w.substr(ConfigAwareContextValuesContainer._keyPrefix.length),O=this._configurationService.getValue(D);let W;switch(typeof O){case"number":case"boolean":case"string":W=O;break;default:Array.isArray(O)?W=JSON.stringify(O):W=O}return this._values.set(w,W),W}setValue(w,D){return super.setValue(w,D)}removeValue(w){return super.removeValue(w)}}class ContextKey{constructor(w,D,O){this._service=w,this._key=D,this._defaultValue=O,this.reset()}set(w){this._service.setContext(this._key,w)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class SimpleContextKeyChangeEvent{constructor(w){this.key=w}affectsSome(w){return w.has(this.key)}allKeysContainedIn(w){return this.affectsSome(w)}}class ArrayContextKeyChangeEvent{constructor(w){this.keys=w}affectsSome(w){for(const D of this.keys)if(w.has(D))return!0;return!1}allKeysContainedIn(w){return this.keys.every(D=>w.has(D))}}class CompositeContextKeyChangeEvent{constructor(w){this.events=w}affectsSome(w){for(const D of this.events)if(D.affectsSome(w))return!0;return!1}allKeysContainedIn(w){return this.events.every(D=>D.allKeysContainedIn(w))}}function allEventKeysInContext(F,w){return F.allKeysContainedIn(new Set(Object.keys(w)))}class AbstractContextKeyService extends Disposable{constructor(w){super(),this._onDidChangeContext=this._register(new PauseableEmitter({merge:D=>new CompositeContextKeyChangeEvent(D)})),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=w}createKey(w,D){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new ContextKey(this,w,D)}bufferChangeEvents(w){this._onDidChangeContext.pause();try{w()}finally{this._onDidChangeContext.resume()}}createScoped(w){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new ScopedContextKeyService(this,w)}contextMatchesRules(w){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const D=this.getContextValuesContainer(this._myContextId);return w?w.evaluate(D):!0}getContextKeyValue(w){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(w)}setContext(w,D){if(this._isDisposed)return;const O=this.getContextValuesContainer(this._myContextId);O&&O.setValue(w,D)&&this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(w))}removeContext(w){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(w)&&this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(w))}getContext(w){return this._isDisposed?NullContext.INSTANCE:this.getContextValuesContainer(findContextAttr(w))}dispose(){super.dispose(),this._isDisposed=!0}}let ContextKeyService=class extends AbstractContextKeyService{constructor(w){super(0),this._contexts=new Map,this._lastContextId=0;const D=this._register(new ConfigAwareContextValuesContainer(this._myContextId,w,this._onDidChangeContext));this._contexts.set(this._myContextId,D)}getContextValuesContainer(w){return this._isDisposed?NullContext.INSTANCE:this._contexts.get(w)||NullContext.INSTANCE}createChildContext(w=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const D=++this._lastContextId;return this._contexts.set(D,new Context(D,this.getContextValuesContainer(w))),D}disposeContext(w){this._isDisposed||this._contexts.delete(w)}};ContextKeyService=__decorate$h([__param$h(0,IConfigurationService)],ContextKeyService);class ScopedContextKeyService extends AbstractContextKeyService{constructor(w,D){if(super(w.createChildContext()),this._parentChangeListener=this._register(new MutableDisposable),this._parent=w,this._updateParentChangeListener(),this._domNode=D,this._domNode.hasAttribute(KEYBINDING_CONTEXT_ATTR)){let O="";this._domNode.classList&&(O=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${O?": "+O:""}`)}this._domNode.setAttribute(KEYBINDING_CONTEXT_ATTR,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(w=>{const O=this._parent.getContextValuesContainer(this._myContextId).value;allEventKeysInContext(w,O)||this._onDidChangeContext.fire(w)})}dispose(){this._isDisposed||(this._parent.disposeContext(this._myContextId),this._domNode.removeAttribute(KEYBINDING_CONTEXT_ATTR),super.dispose())}getContextValuesContainer(w){return this._isDisposed?NullContext.INSTANCE:this._parent.getContextValuesContainer(w)}createChildContext(w=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(w)}disposeContext(w){this._isDisposed||this._parent.disposeContext(w)}}function findContextAttr(F){for(;F;){if(F.hasAttribute(KEYBINDING_CONTEXT_ATTR)){const w=F.getAttribute(KEYBINDING_CONTEXT_ATTR);return w?parseInt(w,10):NaN}F=F.parentElement}return 0}function setContext(F,w,D){F.get(IContextKeyService).createKey(String(w),stringifyURIs(D))}function stringifyURIs(F){return cloneAndChange(F,w=>{if(typeof w=="object"&&w.$mid===1)return URI.revive(w).toString();if(w instanceof URI)return w.toString()})}CommandsRegistry.registerCommand("_setContext",setContext);CommandsRegistry.registerCommand({id:"getContextKeyInfo",handler(){return[...RawContextKey.all()].sort((F,w)=>F.key.localeCompare(w.key))},metadata:{description:localize("getContextKeyInfo","A command that returns information about context keys"),args:[]}});CommandsRegistry.registerCommand("_generateContextKeyInfo",function(){const F=[],w=new Set;for(const D of RawContextKey.all())w.has(D.key)||(w.add(D.key),F.push(D));F.sort((D,O)=>D.key.localeCompare(O.key)),console.log(JSON.stringify(F,void 0,2))});let Node$1=class{constructor(w,D){this.key=w,this.data=D,this.incoming=new Map,this.outgoing=new Map}};class Graph{constructor(w){this._hashFn=w,this._nodes=new Map}roots(){const w=[];for(const D of this._nodes.values())D.outgoing.size===0&&w.push(D);return w}insertEdge(w,D){const O=this.lookupOrInsertNode(w),W=this.lookupOrInsertNode(D);O.outgoing.set(W.key,W),W.incoming.set(O.key,O)}removeNode(w){const D=this._hashFn(w);this._nodes.delete(D);for(const O of this._nodes.values())O.outgoing.delete(D),O.incoming.delete(D)}lookupOrInsertNode(w){const D=this._hashFn(w);let O=this._nodes.get(D);return O||(O=new Node$1(D,w),this._nodes.set(D,O)),O}isEmpty(){return this._nodes.size===0}toString(){const w=[];for(const[D,O]of this._nodes)w.push(`${D}
	(-> incoming)[${[...O.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...O.outgoing.keys()].join(",")}]
`);return w.join(`
`)}findCycleSlow(){for(const[w,D]of this._nodes){const O=new Set([w]),W=this._findCycle(D,O);if(W)return W}}_findCycle(w,D){for(const[O,W]of w.outgoing){if(D.has(O))return[...D,O].join(" -> ");D.add(O);const U=this._findCycle(W,D);if(U)return U;D.delete(O)}}}const _enableAllTracing=!1;class CyclicDependencyError extends Error{constructor(w){super("cyclic dependency between services"),this.message=w.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${w.toString()}`}}class InstantiationService{constructor(w=new ServiceCollection,D=!1,O,W=_enableAllTracing){this._services=w,this._strict=D,this._parent=O,this._enableTracing=W,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(IInstantiationService,this),this._globalGraph=W?O?._globalGraph??new Graph(U=>U):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,dispose(this._children),this._children.clear();for(const w of this._servicesToMaybeDispose)isDisposable(w)&&w.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(w,D){this._throwIfDisposed();const O=this,W=new class extends InstantiationService{dispose(){O._children.delete(W),super.dispose()}}(w,this._strict,this,this._enableTracing);return this._children.add(W),D?.add(W),W}invokeFunction(w,...D){this._throwIfDisposed();const O=Trace.traceInvocation(this._enableTracing,w);let W=!1;try{return w({get:K=>{if(W)throw illegalState("service accessor is only valid during the invocation of its target method");const q=this._getOrCreateServiceInstance(K,O);if(!q)throw new Error(`[invokeFunction] unknown service '${K}'`);return q}},...D)}finally{W=!0,O.stop()}}createInstance(w,...D){this._throwIfDisposed();let O,W;return w instanceof SyncDescriptor?(O=Trace.traceCreation(this._enableTracing,w.ctor),W=this._createInstance(w.ctor,w.staticArguments.concat(D),O)):(O=Trace.traceCreation(this._enableTracing,w),W=this._createInstance(w,D,O)),O.stop(),W}_createInstance(w,D=[],O){const W=_util.getServiceDependencies(w).sort((q,G)=>q.index-G.index),U=[];for(const q of W){const G=this._getOrCreateServiceInstance(q.id,O);G||this._throwIfStrict(`[createInstance] ${w.name} depends on UNKNOWN service ${q.id}.`,!1),U.push(G)}const K=W.length>0?W[0].index:D.length;if(D.length!==K){console.trace(`[createInstance] First service dependency of ${w.name} at position ${K+1} conflicts with ${D.length} static arguments`);const q=K-D.length;q>0?D=D.concat(new Array(q)):D=D.slice(0,K)}return Reflect.construct(w,D.concat(U))}_setCreatedServiceInstance(w,D){if(this._services.get(w)instanceof SyncDescriptor)this._services.set(w,D);else if(this._parent)this._parent._setCreatedServiceInstance(w,D);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(w){const D=this._services.get(w);return!D&&this._parent?this._parent._getServiceInstanceOrDescriptor(w):D}_getOrCreateServiceInstance(w,D){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(w));const O=this._getServiceInstanceOrDescriptor(w);return O instanceof SyncDescriptor?this._safeCreateAndCacheServiceInstance(w,O,D.branch(w,!0)):(D.branch(w,!1),O)}_safeCreateAndCacheServiceInstance(w,D,O){if(this._activeInstantiations.has(w))throw new Error(`illegal state - RECURSIVELY instantiating service '${w}'`);this._activeInstantiations.add(w);try{return this._createAndCacheServiceInstance(w,D,O)}finally{this._activeInstantiations.delete(w)}}_createAndCacheServiceInstance(w,D,O){const W=new Graph(G=>G.id.toString());let U=0;const K=[{id:w,desc:D,_trace:O}],q=new Set;for(;K.length;){const G=K.pop();if(!q.has(String(G.id))){if(q.add(String(G.id)),W.lookupOrInsertNode(G),U++>1e3)throw new CyclicDependencyError(W);for(const Q of _util.getServiceDependencies(G.desc.ctor)){const Y=this._getServiceInstanceOrDescriptor(Q.id);if(Y||this._throwIfStrict(`[createInstance] ${w} depends on ${Q.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(G.id),String(Q.id)),Y instanceof SyncDescriptor){const X={id:Q.id,desc:Y,_trace:G._trace.branch(Q.id,!0)};W.insertEdge(G,X),K.push(X)}}}}for(;;){const G=W.roots();if(G.length===0){if(!W.isEmpty())throw new CyclicDependencyError(W);break}for(const{data:Q}of G){if(this._getServiceInstanceOrDescriptor(Q.id)instanceof SyncDescriptor){const X=this._createServiceInstanceWithOwner(Q.id,Q.desc.ctor,Q.desc.staticArguments,Q.desc.supportsDelayedInstantiation,Q._trace);this._setCreatedServiceInstance(Q.id,X)}W.removeNode(Q)}}return this._getServiceInstanceOrDescriptor(w)}_createServiceInstanceWithOwner(w,D,O=[],W,U){if(this._services.get(w)instanceof SyncDescriptor)return this._createServiceInstance(w,D,O,W,U,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(w,D,O,W,U);throw new Error(`illegalState - creating UNKNOWN service instance ${D.name}`)}_createServiceInstance(w,D,O=[],W,U,K){if(W){const q=new InstantiationService(void 0,this._strict,this,this._enableTracing);q._globalGraphImplicitDependency=String(w);const G=new Map,Q=new GlobalIdleValue(()=>{const Y=q._createInstance(D,O,U);for(const[X,J]of G){const te=Y[X];if(typeof te=="function")for(const ie of J)ie.disposable=te.apply(Y,ie.listener)}return G.clear(),K.add(Y),Y});return new Proxy(Object.create(null),{get(Y,X){if(!Q.isInitialized&&typeof X=="string"&&(X.startsWith("onDid")||X.startsWith("onWill"))){let ie=G.get(X);return ie||(ie=new LinkedList,G.set(X,ie)),(re,ae,le)=>{if(Q.isInitialized)return Q.value[X](re,ae,le);{const de={listener:[re,ae,le],disposable:void 0},oe=ie.push(de);return toDisposable(()=>{oe(),de.disposable?.dispose()})}}}if(X in Y)return Y[X];const J=Q.value;let te=J[X];return typeof te!="function"||(te=te.bind(J),Y[X]=te),te},set(Y,X,J){return Q.value[X]=J,!0},getPrototypeOf(Y){return D.prototype}})}else{const q=this._createInstance(D,O,U);return K.add(q),q}}_throwIfStrict(w,D){if(D&&console.warn(w),this._strict)throw new Error(w)}}class Trace{static{this.all=new Set}static{this._None=new class extends Trace{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(w,D){return w?new Trace(2,D.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):Trace._None}static traceCreation(w,D){return w?new Trace(1,D.name):Trace._None}static{this._totals=0}constructor(w,D){this.type=w,this.name=D,this._start=Date.now(),this._dep=[]}branch(w,D){const O=new Trace(3,w.toString());return this._dep.push([w,D,O]),O}stop(){const w=Date.now()-this._start;Trace._totals+=w;let D=!1;function O(U,K){const q=[],G=new Array(U+1).join("	");for(const[Q,Y,X]of K._dep)if(Y&&X){D=!0,q.push(`${G}CREATES -> ${Q}`);const J=O(U+1,X);J&&q.push(J)}else q.push(`${G}uses -> ${Q}`);return q.join(`
`)}const W=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${O(1,this)}`,`DONE, took ${w.toFixed(2)}ms (grand total ${Trace._totals.toFixed(2)}ms)`];(w>2||D)&&Trace.all.add(W.join(`
`))}}const unsupportedSchemas=new Set([Schemas.inMemory,Schemas.vscodeSourceControl,Schemas.walkThrough,Schemas.walkThroughSnippet,Schemas.vscodeChatCodeBlock]);class DoubleResourceMap{constructor(){this._byResource=new ResourceMap,this._byOwner=new Map}set(w,D,O){let W=this._byResource.get(w);W||(W=new Map,this._byResource.set(w,W)),W.set(D,O);let U=this._byOwner.get(D);U||(U=new ResourceMap,this._byOwner.set(D,U)),U.set(w,O)}get(w,D){return this._byResource.get(w)?.get(D)}delete(w,D){let O=!1,W=!1;const U=this._byResource.get(w);U&&(O=U.delete(D));const K=this._byOwner.get(D);if(K&&(W=K.delete(w)),O!==W)throw new Error("illegal state");return O&&W}values(w){return typeof w=="string"?this._byOwner.get(w)?.values()??Iterable.empty():URI.isUri(w)?this._byResource.get(w)?.values()??Iterable.empty():Iterable.map(Iterable.concat(...this._byOwner.values()),D=>D[1])}}class MarkerStats{constructor(w){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new ResourceMap,this._service=w,this._subscription=w.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(w){for(const D of w){const O=this._data.get(D);O&&this._substract(O);const W=this._resourceStats(D);this._add(W),this._data.set(D,W)}}_resourceStats(w){const D={errors:0,warnings:0,infos:0,unknowns:0};if(unsupportedSchemas.has(w.scheme))return D;for(const{severity:O}of this._service.read({resource:w}))O===MarkerSeverity$1.Error?D.errors+=1:O===MarkerSeverity$1.Warning?D.warnings+=1:O===MarkerSeverity$1.Info?D.infos+=1:D.unknowns+=1;return D}_substract(w){this.errors-=w.errors,this.warnings-=w.warnings,this.infos-=w.infos,this.unknowns-=w.unknowns}_add(w){this.errors+=w.errors,this.warnings+=w.warnings,this.infos+=w.infos,this.unknowns+=w.unknowns}}class MarkerService{constructor(){this._onMarkerChanged=new DebounceEmitter({delay:0,merge:MarkerService._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new DoubleResourceMap,this._stats=new MarkerStats(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(w,D){for(const O of D||[])this.changeOne(w,O,[])}changeOne(w,D,O){if(isFalsyOrEmpty(O))this._data.delete(D,w)&&this._onMarkerChanged.fire([D]);else{const W=[];for(const U of O){const K=MarkerService._toMarker(w,D,U);K&&W.push(K)}this._data.set(D,w,W),this._onMarkerChanged.fire([D])}}static _toMarker(w,D,O){let{code:W,severity:U,message:K,source:q,startLineNumber:G,startColumn:Q,endLineNumber:Y,endColumn:X,relatedInformation:J,tags:te}=O;if(K)return G=G>0?G:1,Q=Q>0?Q:1,Y=Y>=G?Y:G,X=X>0?X:Q,{resource:D,owner:w,code:W,severity:U,message:K,source:q,startLineNumber:G,startColumn:Q,endLineNumber:Y,endColumn:X,relatedInformation:J,tags:te}}changeAll(w,D){const O=[],W=this._data.values(w);if(W)for(const U of W){const K=Iterable.first(U);K&&(O.push(K.resource),this._data.delete(K.resource,w))}if(isNonEmptyArray(D)){const U=new ResourceMap;for(const{resource:K,marker:q}of D){const G=MarkerService._toMarker(w,K,q);if(!G)continue;const Q=U.get(K);Q?Q.push(G):(U.set(K,[G]),O.push(K))}for(const[K,q]of U)this._data.set(K,w,q)}O.length>0&&this._onMarkerChanged.fire(O)}read(w=Object.create(null)){let{owner:D,resource:O,severities:W,take:U}=w;if((!U||U<0)&&(U=-1),D&&O){const K=this._data.get(O,D);if(K){const q=[];for(const G of K)if(MarkerService._accept(G,W)){const Q=q.push(G);if(U>0&&Q===U)break}return q}else return[]}else if(!D&&!O){const K=[];for(const q of this._data.values())for(const G of q)if(MarkerService._accept(G,W)){const Q=K.push(G);if(U>0&&Q===U)return K}return K}else{const K=this._data.values(O??D),q=[];for(const G of K)for(const Q of G)if(MarkerService._accept(Q,W)){const Y=q.push(Q);if(U>0&&Y===U)return q}return q}}static _accept(w,D){return D===void 0||(D&w.severity)===w.severity}static _merge(w){const D=new ResourceMap;for(const O of w)for(const W of O)D.set(W,!0);return Array.from(D.keys())}}class DefaultConfiguration extends Disposable{get configurationModel(){return this._configurationModel}constructor(w){super(),this.logService=w,this._configurationModel=ConfigurationModel.createEmptyModel(this.logService)}reload(){return this.resetConfigurationModel(),this.configurationModel}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=ConfigurationModel.createEmptyModel(this.logService);const w=Registry.as(Extensions$5.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(w),w)}updateConfigurationModel(w,D){const O=this.getConfigurationDefaultOverrides();for(const W of w){const U=O[W],K=D[W];U!==void 0?this._configurationModel.setValue(W,U):K?this._configurationModel.setValue(W,K.default):this._configurationModel.removeValue(W)}}}const IAccessibilitySignalService=createDecorator("accessibilitySignalService");class Sound{static register(w){return new Sound(w.fileName)}static{this.error=Sound.register({fileName:"error.mp3"})}static{this.warning=Sound.register({fileName:"warning.mp3"})}static{this.success=Sound.register({fileName:"success.mp3"})}static{this.foldedArea=Sound.register({fileName:"foldedAreas.mp3"})}static{this.break=Sound.register({fileName:"break.mp3"})}static{this.quickFixes=Sound.register({fileName:"quickFixes.mp3"})}static{this.taskCompleted=Sound.register({fileName:"taskCompleted.mp3"})}static{this.taskFailed=Sound.register({fileName:"taskFailed.mp3"})}static{this.terminalBell=Sound.register({fileName:"terminalBell.mp3"})}static{this.diffLineInserted=Sound.register({fileName:"diffLineInserted.mp3"})}static{this.diffLineDeleted=Sound.register({fileName:"diffLineDeleted.mp3"})}static{this.diffLineModified=Sound.register({fileName:"diffLineModified.mp3"})}static{this.chatRequestSent=Sound.register({fileName:"chatRequestSent.mp3"})}static{this.chatResponseReceived1=Sound.register({fileName:"chatResponseReceived1.mp3"})}static{this.chatResponseReceived2=Sound.register({fileName:"chatResponseReceived2.mp3"})}static{this.chatResponseReceived3=Sound.register({fileName:"chatResponseReceived3.mp3"})}static{this.chatResponseReceived4=Sound.register({fileName:"chatResponseReceived4.mp3"})}static{this.clear=Sound.register({fileName:"clear.mp3"})}static{this.save=Sound.register({fileName:"save.mp3"})}static{this.format=Sound.register({fileName:"format.mp3"})}static{this.voiceRecordingStarted=Sound.register({fileName:"voiceRecordingStarted.mp3"})}static{this.voiceRecordingStopped=Sound.register({fileName:"voiceRecordingStopped.mp3"})}static{this.progress=Sound.register({fileName:"progress.mp3"})}constructor(w){this.fileName=w}}class SoundSource{constructor(w){this.randomOneOf=w}}class AccessibilitySignal{constructor(w,D,O,W,U,K){this.sound=w,this.name=D,this.legacySoundSettingsKey=O,this.settingsKey=W,this.legacyAnnouncementSettingsKey=U,this.announcementMessage=K}static{this._signals=new Set}static register(w){const D=new SoundSource("randomOneOf"in w.sound?w.sound.randomOneOf:[w.sound]),O=new AccessibilitySignal(D,w.name,w.legacySoundSettingsKey,w.settingsKey,w.legacyAnnouncementSettingsKey,w.announcementMessage);return AccessibilitySignal._signals.add(O),O}static{this.errorAtPosition=AccessibilitySignal.register({name:localize("accessibilitySignals.positionHasError.name","Error at Position"),sound:Sound.error,announcementMessage:localize("accessibility.signals.positionHasError","Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"})}static{this.warningAtPosition=AccessibilitySignal.register({name:localize("accessibilitySignals.positionHasWarning.name","Warning at Position"),sound:Sound.warning,announcementMessage:localize("accessibility.signals.positionHasWarning","Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"})}static{this.errorOnLine=AccessibilitySignal.register({name:localize("accessibilitySignals.lineHasError.name","Error on Line"),sound:Sound.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:localize("accessibility.signals.lineHasError","Error on Line"),settingsKey:"accessibility.signals.lineHasError"})}static{this.warningOnLine=AccessibilitySignal.register({name:localize("accessibilitySignals.lineHasWarning.name","Warning on Line"),sound:Sound.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:localize("accessibility.signals.lineHasWarning","Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"})}static{this.foldedArea=AccessibilitySignal.register({name:localize("accessibilitySignals.lineHasFoldedArea.name","Folded Area on Line"),sound:Sound.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:localize("accessibility.signals.lineHasFoldedArea","Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"})}static{this.break=AccessibilitySignal.register({name:localize("accessibilitySignals.lineHasBreakpoint.name","Breakpoint on Line"),sound:Sound.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:localize("accessibility.signals.lineHasBreakpoint","Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"})}static{this.inlineSuggestion=AccessibilitySignal.register({name:localize("accessibilitySignals.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:Sound.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"})}static{this.terminalQuickFix=AccessibilitySignal.register({name:localize("accessibilitySignals.terminalQuickFix.name","Terminal Quick Fix"),sound:Sound.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:localize("accessibility.signals.terminalQuickFix","Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"})}static{this.onDebugBreak=AccessibilitySignal.register({name:localize("accessibilitySignals.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:Sound.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:localize("accessibility.signals.onDebugBreak","Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"})}static{this.noInlayHints=AccessibilitySignal.register({name:localize("accessibilitySignals.noInlayHints","No Inlay Hints on Line"),sound:Sound.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:localize("accessibility.signals.noInlayHints","No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"})}static{this.taskCompleted=AccessibilitySignal.register({name:localize("accessibilitySignals.taskCompleted","Task Completed"),sound:Sound.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:localize("accessibility.signals.taskCompleted","Task Completed"),settingsKey:"accessibility.signals.taskCompleted"})}static{this.taskFailed=AccessibilitySignal.register({name:localize("accessibilitySignals.taskFailed","Task Failed"),sound:Sound.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:localize("accessibility.signals.taskFailed","Task Failed"),settingsKey:"accessibility.signals.taskFailed"})}static{this.terminalCommandFailed=AccessibilitySignal.register({name:localize("accessibilitySignals.terminalCommandFailed","Terminal Command Failed"),sound:Sound.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:localize("accessibility.signals.terminalCommandFailed","Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"})}static{this.terminalCommandSucceeded=AccessibilitySignal.register({name:localize("accessibilitySignals.terminalCommandSucceeded","Terminal Command Succeeded"),sound:Sound.success,announcementMessage:localize("accessibility.signals.terminalCommandSucceeded","Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"})}static{this.terminalBell=AccessibilitySignal.register({name:localize("accessibilitySignals.terminalBell","Terminal Bell"),sound:Sound.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:localize("accessibility.signals.terminalBell","Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"})}static{this.notebookCellCompleted=AccessibilitySignal.register({name:localize("accessibilitySignals.notebookCellCompleted","Notebook Cell Completed"),sound:Sound.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:localize("accessibility.signals.notebookCellCompleted","Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"})}static{this.notebookCellFailed=AccessibilitySignal.register({name:localize("accessibilitySignals.notebookCellFailed","Notebook Cell Failed"),sound:Sound.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:localize("accessibility.signals.notebookCellFailed","Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"})}static{this.diffLineInserted=AccessibilitySignal.register({name:localize("accessibilitySignals.diffLineInserted","Diff Line Inserted"),sound:Sound.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"})}static{this.diffLineDeleted=AccessibilitySignal.register({name:localize("accessibilitySignals.diffLineDeleted","Diff Line Deleted"),sound:Sound.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"})}static{this.diffLineModified=AccessibilitySignal.register({name:localize("accessibilitySignals.diffLineModified","Diff Line Modified"),sound:Sound.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"})}static{this.chatRequestSent=AccessibilitySignal.register({name:localize("accessibilitySignals.chatRequestSent","Chat Request Sent"),sound:Sound.chatRequestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:localize("accessibility.signals.chatRequestSent","Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"})}static{this.chatResponseReceived=AccessibilitySignal.register({name:localize("accessibilitySignals.chatResponseReceived","Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[Sound.chatResponseReceived1,Sound.chatResponseReceived2,Sound.chatResponseReceived3,Sound.chatResponseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"})}static{this.progress=AccessibilitySignal.register({name:localize("accessibilitySignals.progress","Progress"),sound:Sound.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:localize("accessibility.signals.progress","Progress"),settingsKey:"accessibility.signals.progress"})}static{this.clear=AccessibilitySignal.register({name:localize("accessibilitySignals.clear","Clear"),sound:Sound.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:localize("accessibility.signals.clear","Clear"),settingsKey:"accessibility.signals.clear"})}static{this.save=AccessibilitySignal.register({name:localize("accessibilitySignals.save","Save"),sound:Sound.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:localize("accessibility.signals.save","Save"),settingsKey:"accessibility.signals.save"})}static{this.format=AccessibilitySignal.register({name:localize("accessibilitySignals.format","Format"),sound:Sound.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:localize("accessibility.signals.format","Format"),settingsKey:"accessibility.signals.format"})}static{this.voiceRecordingStarted=AccessibilitySignal.register({name:localize("accessibilitySignals.voiceRecordingStarted","Voice Recording Started"),sound:Sound.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"})}static{this.voiceRecordingStopped=AccessibilitySignal.register({name:localize("accessibilitySignals.voiceRecordingStopped","Voice Recording Stopped"),sound:Sound.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"})}}class LogService extends Disposable{constructor(w,D=[]){super(),this.logger=new MultiplexLogger([w,...D]),this._register(w.onDidChangeLogLevel(O=>this.setLevel(O)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(w){this.logger.setLevel(w)}getLevel(){return this.logger.getLevel()}trace(w,...D){this.logger.trace(w,...D)}debug(w,...D){this.logger.debug(w,...D)}info(w,...D){this.logger.info(w,...D)}warn(w,...D){this.logger.warn(w,...D)}error(w,...D){this.logger.error(w,...D)}}const editorFeatures=[];function getEditorFeatures(){return editorFeatures.slice(0)}class StandaloneTreeSitterParserService{getParseResult(w){}}var __decorate$g=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$g=function(F,w){return function(D,O){w(D,O,F)}};class SimpleModel{constructor(w){this.disposed=!1,this.model=w,this._onWillDispose=new Emitter$1}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let StandaloneTextModelService=class{constructor(w){this.modelService=w}createModelReference(w){const D=this.modelService.getModel(w);return D?Promise.resolve(new ImmortalReference(new SimpleModel(D))):Promise.reject(new Error("Model not found"))}};StandaloneTextModelService=__decorate$g([__param$g(0,IModelService)],StandaloneTextModelService);class StandaloneEditorProgressService{static{this.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}}}show(){return StandaloneEditorProgressService.NULL_PROGRESS_RUNNER}async showWhile(w,D){await w}}class StandaloneProgressService{withProgress(w,D,O){return D({report:()=>{}})}}class StandaloneEnvironmentService{constructor(){this.isExtensionDevelopment=!1,this.isBuilt=!1}}class StandaloneDialogService{async confirm(w){return{confirmed:this.doConfirm(w.message,w.detail),checkboxChecked:!1}}doConfirm(w,D){let O=w;return D&&(O=O+`

`+D),mainWindow.confirm(O)}async prompt(w){let D;if(this.doConfirm(w.message,w.detail)){const W=[...w.buttons??[]];w.cancelButton&&typeof w.cancelButton!="string"&&typeof w.cancelButton!="boolean"&&W.push(w.cancelButton),D=await W[0]?.run({checkboxChecked:!1})}return{result:D}}async error(w,D){await this.prompt({type:Severity$2.Error,message:w,detail:D})}}class StandaloneNotificationService{static{this.NO_OP=new NoOpNotification}info(w){return this.notify({severity:Severity$2.Info,message:w})}warn(w){return this.notify({severity:Severity$2.Warning,message:w})}error(w){return this.notify({severity:Severity$2.Error,message:w})}notify(w){switch(w.severity){case Severity$2.Error:console.error(w.message);break;case Severity$2.Warning:console.warn(w.message);break;default:console.log(w.message);break}return StandaloneNotificationService.NO_OP}prompt(w,D,O,W){return StandaloneNotificationService.NO_OP}status(w,D){return Disposable.None}}let StandaloneCommandService=class{constructor(w){this._onWillExecuteCommand=new Emitter$1,this._onDidExecuteCommand=new Emitter$1,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=w}executeCommand(w,...D){const O=CommandsRegistry.getCommand(w);if(!O)return Promise.reject(new Error(`command '${w}' not found`));try{this._onWillExecuteCommand.fire({commandId:w,args:D});const W=this._instantiationService.invokeFunction.apply(this._instantiationService,[O.handler,...D]);return this._onDidExecuteCommand.fire({commandId:w,args:D}),Promise.resolve(W)}catch(W){return Promise.reject(W)}}};StandaloneCommandService=__decorate$g([__param$g(0,IInstantiationService)],StandaloneCommandService);let StandaloneKeybindingService=class extends AbstractKeybindingService{constructor(w,D,O,W,U,K){super(w,D,O,W,U),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const q=te=>{const ie=new DisposableStore;ie.add(addDisposableListener(te,EventType$1.KEY_DOWN,se=>{const re=new StandardKeyboardEvent(se);this._dispatch(re,re.target)&&(re.preventDefault(),re.stopPropagation())})),ie.add(addDisposableListener(te,EventType$1.KEY_UP,se=>{const re=new StandardKeyboardEvent(se);this._singleModifierDispatch(re,re.target)&&re.preventDefault()})),this._domNodeListeners.push(new DomNodeListeners(te,ie))},G=te=>{for(let ie=0;ie<this._domNodeListeners.length;ie++){const se=this._domNodeListeners[ie];se.domNode===te&&(this._domNodeListeners.splice(ie,1),se.dispose())}},Q=te=>{te.getOption(61)||q(te.getContainerDomNode())},Y=te=>{te.getOption(61)||G(te.getContainerDomNode())};this._register(K.onCodeEditorAdd(Q)),this._register(K.onCodeEditorRemove(Y)),K.listCodeEditors().forEach(Q);const X=te=>{q(te.getContainerDomNode())},J=te=>{G(te.getContainerDomNode())};this._register(K.onDiffEditorAdd(X)),this._register(K.onDiffEditorRemove(J)),K.listDiffEditors().forEach(X)}addDynamicKeybinding(w,D,O,W){return combinedDisposable(CommandsRegistry.registerCommand(w,O),this.addDynamicKeybindings([{keybinding:D,command:w,when:W}]))}addDynamicKeybindings(w){const D=w.map(O=>({keybinding:decodeKeybinding(O.keybinding,OS),command:O.command??null,commandArgs:O.commandArgs,when:O.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}));return this._dynamicKeybindings=this._dynamicKeybindings.concat(D),this.updateResolver(),toDisposable(()=>{for(let O=0;O<this._dynamicKeybindings.length;O++)if(this._dynamicKeybindings[O]===D[0]){this._dynamicKeybindings.splice(O,D.length),this.updateResolver();return}})}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const w=this._toNormalizedKeybindingItems(KeybindingsRegistry.getDefaultKeybindings(),!0),D=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new KeybindingResolver(w,D,O=>this._log(O))}return this._cachedResolver}_documentHasFocus(){return mainWindow.document.hasFocus()}_toNormalizedKeybindingItems(w,D){const O=[];let W=0;for(const U of w){const K=U.when||void 0,q=U.keybinding;if(!q)O[W++]=new ResolvedKeybindingItem(void 0,U.command,U.commandArgs,K,D,null,!1);else{const G=USLayoutResolvedKeybinding.resolveKeybinding(q,OS);for(const Q of G)O[W++]=new ResolvedKeybindingItem(Q,U.command,U.commandArgs,K,D,null,!1)}}return O}resolveKeyboardEvent(w){const D=new KeyCodeChord(w.ctrlKey,w.shiftKey,w.altKey,w.metaKey,w.keyCode);return new USLayoutResolvedKeybinding([D],OS)}};StandaloneKeybindingService=__decorate$g([__param$g(0,IContextKeyService),__param$g(1,ICommandService),__param$g(2,ITelemetryService),__param$g(3,INotificationService),__param$g(4,ILogService),__param$g(5,ICodeEditorService)],StandaloneKeybindingService);class DomNodeListeners extends Disposable{constructor(w,D){super(),this.domNode=w,this._register(D)}}function isConfigurationOverrides(F){return F&&typeof F=="object"&&(!F.overrideIdentifier||typeof F.overrideIdentifier=="string")&&(!F.resource||F.resource instanceof URI)}let StandaloneConfigurationService=class{constructor(w){this.logService=w,this._onDidChangeConfiguration=new Emitter$1,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;const D=new DefaultConfiguration(w);this._configuration=new Configuration(D.reload(),ConfigurationModel.createEmptyModel(w),ConfigurationModel.createEmptyModel(w),ConfigurationModel.createEmptyModel(w),ConfigurationModel.createEmptyModel(w),ConfigurationModel.createEmptyModel(w),new ResourceMap,ConfigurationModel.createEmptyModel(w),new ResourceMap,w),D.dispose()}getValue(w,D){const O=typeof w=="string"?w:void 0,W=isConfigurationOverrides(w)?w:isConfigurationOverrides(D)?D:{};return this._configuration.getValue(O,W,void 0)}updateValues(w){const D={data:this._configuration.toData()},O=[];for(const W of w){const[U,K]=W;this.getValue(U)!==K&&(this._configuration.updateValue(U,K),O.push(U))}if(O.length>0){const W=new ConfigurationChangeEvent({keys:O,overrides:[]},D,this._configuration,void 0,this.logService);W.source=8,this._onDidChangeConfiguration.fire(W)}return Promise.resolve()}updateValue(w,D,O,W){return this.updateValues([[w,D]])}inspect(w,D={}){return this._configuration.inspect(w,D,void 0)}};StandaloneConfigurationService=__decorate$g([__param$g(0,ILogService)],StandaloneConfigurationService);let StandaloneResourceConfigurationService=class{constructor(w,D,O){this.configurationService=w,this.modelService=D,this.languageService=O,this._onDidChangeConfiguration=new Emitter$1,this.configurationService.onDidChangeConfiguration(W=>{this._onDidChangeConfiguration.fire({affectedKeys:W.affectedKeys,affectsConfiguration:(U,K)=>W.affectsConfiguration(K)})})}getValue(w,D,O){const W=Position$1.isIPosition(D)?D:null,U=W?typeof O=="string"?O:void 0:typeof D=="string"?D:void 0,K=w?this.getLanguage(w,W):void 0;return typeof U>"u"?this.configurationService.getValue({resource:w,overrideIdentifier:K}):this.configurationService.getValue(U,{resource:w,overrideIdentifier:K})}getLanguage(w,D){const O=this.modelService.getModel(w);return O?D?O.getLanguageIdAtPosition(D.lineNumber,D.column):O.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(w)}};StandaloneResourceConfigurationService=__decorate$g([__param$g(0,IConfigurationService),__param$g(1,IModelService),__param$g(2,ILanguageService)],StandaloneResourceConfigurationService);let StandaloneResourcePropertiesService=class{constructor(w){this.configurationService=w}getEOL(w,D){const O=this.configurationService.getValue("files.eol",{overrideIdentifier:D,resource:w});return O&&typeof O=="string"&&O!=="auto"?O:isLinux||isMacintosh?`
`:`\r
`}};StandaloneResourcePropertiesService=__decorate$g([__param$g(0,IConfigurationService)],StandaloneResourcePropertiesService);class StandaloneTelemetryService{publicLog2(){}}class StandaloneWorkspaceContextService{static{this.SCHEME="inmemory"}constructor(){const w=URI.from({scheme:StandaloneWorkspaceContextService.SCHEME,authority:"model",path:"/"});this.workspace={id:STANDALONE_EDITOR_WORKSPACE_ID,folders:[new WorkspaceFolder({uri:w,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(w){return w&&w.scheme===StandaloneWorkspaceContextService.SCHEME?this.workspace.folders[0]:null}}function updateConfigurationService(F,w,D){if(!w||!(F instanceof StandaloneConfigurationService))return;const O=[];Object.keys(w).forEach(W=>{isEditorConfigurationKey(W)&&O.push([`editor.${W}`,w[W]]),D&&isDiffEditorConfigurationKey(W)&&O.push([`diffEditor.${W}`,w[W]])}),O.length>0&&F.updateValues(O)}let StandaloneBulkEditService=class{constructor(w){this._modelService=w}hasPreviewHandler(){return!1}async apply(w,D){const O=Array.isArray(w)?w:ResourceEdit.convert(w),W=new Map;for(const q of O){if(!(q instanceof ResourceTextEdit))throw new Error("bad edit - only text edits are supported");const G=this._modelService.getModel(q.resource);if(!G)throw new Error("bad edit - model not found");if(typeof q.versionId=="number"&&G.getVersionId()!==q.versionId)throw new Error("bad state - model changed in the meantime");let Q=W.get(G);Q||(Q=[],W.set(G,Q)),Q.push(EditOperation.replaceMove(Range$2.lift(q.textEdit.range),q.textEdit.text))}let U=0,K=0;for(const[q,G]of W)q.pushStackElement(),q.pushEditOperations([],G,()=>[]),q.pushStackElement(),K+=1,U+=G.length;return{ariaSummary:format(StandaloneServicesNLS.bulkEditServiceSummary,U,K),isApplied:U>0}}};StandaloneBulkEditService=__decorate$g([__param$g(0,IModelService)],StandaloneBulkEditService);class StandaloneUriLabelService{getUriLabel(w,D){return w.scheme==="file"?w.fsPath:w.path}getUriBasenameLabel(w){return basename(w)}}let StandaloneContextViewService=class extends ContextViewService{constructor(w,D){super(w),this._codeEditorService=D}showContextView(w,D,O){if(!D){const W=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();W&&(D=W.getContainerDomNode())}return super.showContextView(w,D,O)}};StandaloneContextViewService=__decorate$g([__param$g(0,ILayoutService),__param$g(1,ICodeEditorService)],StandaloneContextViewService);class StandaloneWorkspaceTrustManagementService{constructor(){this._neverEmitter=new Emitter$1,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class StandaloneLanguageService extends LanguageService{constructor(){super()}}class StandaloneLogService extends LogService{constructor(){super(new ConsoleLogger)}}let StandaloneContextMenuService=class extends ContextMenuService{constructor(w,D,O,W,U,K){super(w,D,O,W,U,K),this.configure({blockMouse:!1})}};StandaloneContextMenuService=__decorate$g([__param$g(0,ITelemetryService),__param$g(1,INotificationService),__param$g(2,IContextViewService),__param$g(3,IKeybindingService),__param$g(4,IMenuService),__param$g(5,IContextKeyService)],StandaloneContextMenuService);const standaloneEditorWorkerDescriptor={amdModuleId:"vs/editor/common/services/editorSimpleWorker",esmModuleLocation:void 0,label:"editorWorkerService"};let StandaloneEditorWorkerService=class extends EditorWorkerService{constructor(w,D,O,W,U){super(standaloneEditorWorkerDescriptor,w,D,O,W,U)}};StandaloneEditorWorkerService=__decorate$g([__param$g(0,IModelService),__param$g(1,ITextResourceConfigurationService),__param$g(2,ILogService),__param$g(3,ILanguageConfigurationService),__param$g(4,ILanguageFeaturesService)],StandaloneEditorWorkerService);class StandaloneAccessbilitySignalService{async playSignal(w,D){}}registerSingleton(ILogService,StandaloneLogService,0);registerSingleton(IConfigurationService,StandaloneConfigurationService,0);registerSingleton(ITextResourceConfigurationService,StandaloneResourceConfigurationService,0);registerSingleton(ITextResourcePropertiesService,StandaloneResourcePropertiesService,0);registerSingleton(IWorkspaceContextService,StandaloneWorkspaceContextService,0);registerSingleton(ILabelService,StandaloneUriLabelService,0);registerSingleton(ITelemetryService,StandaloneTelemetryService,0);registerSingleton(IDialogService,StandaloneDialogService,0);registerSingleton(IEnvironmentService,StandaloneEnvironmentService,0);registerSingleton(INotificationService,StandaloneNotificationService,0);registerSingleton(IMarkerService,MarkerService,0);registerSingleton(ILanguageService,StandaloneLanguageService,0);registerSingleton(IStandaloneThemeService,StandaloneThemeService,0);registerSingleton(IModelService,ModelService,0);registerSingleton(IMarkerDecorationsService,MarkerDecorationsService,0);registerSingleton(IContextKeyService,ContextKeyService,0);registerSingleton(IProgressService,StandaloneProgressService,0);registerSingleton(IEditorProgressService,StandaloneEditorProgressService,0);registerSingleton(IStorageService,InMemoryStorageService,0);registerSingleton(IEditorWorkerService,StandaloneEditorWorkerService,0);registerSingleton(IBulkEditService,StandaloneBulkEditService,0);registerSingleton(IWorkspaceTrustManagementService,StandaloneWorkspaceTrustManagementService,0);registerSingleton(ITextModelService,StandaloneTextModelService,0);registerSingleton(IAccessibilityService,AccessibilityService,0);registerSingleton(IListService,ListService,0);registerSingleton(ICommandService,StandaloneCommandService,0);registerSingleton(IKeybindingService,StandaloneKeybindingService,0);registerSingleton(IQuickInputService,StandaloneQuickInputService,0);registerSingleton(IContextViewService,StandaloneContextViewService,0);registerSingleton(IOpenerService,OpenerService,0);registerSingleton(IClipboardService,BrowserClipboardService,0);registerSingleton(IContextMenuService,StandaloneContextMenuService,0);registerSingleton(IMenuService,MenuService,0);registerSingleton(IAccessibilitySignalService,StandaloneAccessbilitySignalService,0);registerSingleton(ITreeSitterParserService,StandaloneTreeSitterParserService,0);var StandaloneServices;(function(F){const w=new ServiceCollection;for(const[G,Q]of getSingletonServiceDescriptors())w.set(G,Q);const D=new InstantiationService(w,!0);w.set(IInstantiationService,D);function O(G){W||K({});const Q=w.get(G);if(!Q)throw new Error("Missing service "+G);return Q instanceof SyncDescriptor?D.invokeFunction(Y=>Y.get(G)):Q}F.get=O;let W=!1;const U=new Emitter$1;function K(G){if(W)return D;W=!0;for(const[Y,X]of getSingletonServiceDescriptors())w.get(Y)||w.set(Y,X);for(const Y in G)if(G.hasOwnProperty(Y)){const X=createDecorator(Y);w.get(X)instanceof SyncDescriptor&&w.set(X,G[Y])}const Q=getEditorFeatures();for(const Y of Q)try{D.createInstance(Y)}catch(X){onUnexpectedError(X)}return U.fire(),D}F.initialize=K;function q(G){if(W)return G();const Q=new DisposableStore,Y=Q.add(U.event(()=>{Y.dispose(),Q.add(G())}));return Q}F.withServices=q})(StandaloneServices||(StandaloneServices={}));function createWebWorker$1(F,w){return new MonacoWebWorkerImpl(F,w)}class MonacoWebWorkerImpl extends EditorWorkerClient{constructor(w,D){const O={amdModuleId:standaloneEditorWorkerDescriptor.amdModuleId,esmModuleLocation:standaloneEditorWorkerDescriptor.esmModuleLocation,label:D.label};super(O,D.keepIdleModels||!1,w),this._foreignModuleId=D.moduleId,this._foreignModuleCreateData=D.createData||null,this._foreignModuleHost=D.host||null,this._foreignProxy=null}fhr(w,D){if(!this._foreignModuleHost||typeof this._foreignModuleHost[w]!="function")return Promise.reject(new Error("Missing method "+w+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[w].apply(this._foreignModuleHost,D))}catch(O){return Promise.reject(O)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then(w=>{const D=this._foreignModuleHost?getAllMethodNames(this._foreignModuleHost):[];return w.$loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,D).then(O=>{this._foreignModuleCreateData=null;const W=(q,G)=>w.$fmr(q,G),U=(q,G)=>function(){const Q=Array.prototype.slice.call(arguments,0);return G(q,Q)},K={};for(const q of O)K[q]=U(q,W);return K})})),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(w){return this.workerWithSyncedResources(w).then(D=>this.getProxy())}}function isFuzzyActionArr(F){return Array.isArray(F)}function isFuzzyAction(F){return!isFuzzyActionArr(F)}function isString(F){return typeof F=="string"}function isIAction(F){return!isString(F)}function empty(F){return!F}function fixCase(F,w){return F.ignoreCase&&w?w.toLowerCase():w}function sanitize(F){return F.replace(/[&<>'"_]/g,"-")}function log(F,w){console.log(`${F.languageId}: ${w}`)}function createError(F,w){return new Error(`${F.languageId}: ${w}`)}function substituteMatches(F,w,D,O,W){const U=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let K=null;return w.replace(U,function(q,G,Q,Y,X,J,te,ie,se){return empty(Q)?empty(Y)?!empty(X)&&X<O.length?fixCase(F,O[X]):!empty(te)&&F&&typeof F[te]=="string"?F[te]:(K===null&&(K=W.split("."),K.unshift(W)),!empty(J)&&J<K.length?fixCase(F,K[J]):""):fixCase(F,D):"$"})}function substituteMatchesRe(F,w,D){const O=/\$[sS](\d\d?)/g;let W=null;return w.replace(O,function(U,K){return W===null&&(W=D.split("."),W.unshift(D)),!empty(K)&&K<W.length?fixCase(F,W[K]):""})}function findRules(F,w){let D=w;for(;D&&D.length>0;){const O=F.tokenizer[D];if(O)return O;const W=D.lastIndexOf(".");W<0?D=null:D=D.substr(0,W)}return null}function stateExists(F,w){let D=w;for(;D&&D.length>0;){if(F.stateNames[D])return!0;const W=D.lastIndexOf(".");W<0?D=null:D=D.substr(0,W)}return!1}var __decorate$f=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$f=function(F,w){return function(D,O){w(D,O,F)}},MonarchTokenizer_1;const CACHE_STACK_DEPTH=5;class MonarchStackElementFactory{static{this._INSTANCE=new MonarchStackElementFactory(CACHE_STACK_DEPTH)}static create(w,D){return this._INSTANCE.create(w,D)}constructor(w){this._maxCacheDepth=w,this._entries=Object.create(null)}create(w,D){if(w!==null&&w.depth>=this._maxCacheDepth)return new MonarchStackElement(w,D);let O=MonarchStackElement.getStackElementId(w);O.length>0&&(O+="|"),O+=D;let W=this._entries[O];return W||(W=new MonarchStackElement(w,D),this._entries[O]=W,W)}}class MonarchStackElement{constructor(w,D){this.parent=w,this.state=D,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(w){let D="";for(;w!==null;)D.length>0&&(D+="|"),D+=w.state,w=w.parent;return D}static _equals(w,D){for(;w!==null&&D!==null;){if(w===D)return!0;if(w.state!==D.state)return!1;w=w.parent,D=D.parent}return w===null&&D===null}equals(w){return MonarchStackElement._equals(this,w)}push(w){return MonarchStackElementFactory.create(this,w)}pop(){return this.parent}popall(){let w=this;for(;w.parent;)w=w.parent;return w}switchTo(w){return MonarchStackElementFactory.create(this.parent,w)}}class EmbeddedLanguageData{constructor(w,D){this.languageId=w,this.state=D}equals(w){return this.languageId===w.languageId&&this.state.equals(w.state)}clone(){return this.state.clone()===this.state?this:new EmbeddedLanguageData(this.languageId,this.state)}}class MonarchLineStateFactory{static{this._INSTANCE=new MonarchLineStateFactory(CACHE_STACK_DEPTH)}static create(w,D){return this._INSTANCE.create(w,D)}constructor(w){this._maxCacheDepth=w,this._entries=Object.create(null)}create(w,D){if(D!==null)return new MonarchLineState(w,D);if(w!==null&&w.depth>=this._maxCacheDepth)return new MonarchLineState(w,D);const O=MonarchStackElement.getStackElementId(w);let W=this._entries[O];return W||(W=new MonarchLineState(w,null),this._entries[O]=W,W)}}class MonarchLineState{constructor(w,D){this.stack=w,this.embeddedLanguageData=D}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:MonarchLineStateFactory.create(this.stack,this.embeddedLanguageData)}equals(w){return!(w instanceof MonarchLineState)||!this.stack.equals(w.stack)?!1:this.embeddedLanguageData===null&&w.embeddedLanguageData===null?!0:this.embeddedLanguageData===null||w.embeddedLanguageData===null?!1:this.embeddedLanguageData.equals(w.embeddedLanguageData)}}class MonarchClassicTokensCollector{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(w){this._languageId=w}emit(w,D){this._lastTokenType===D&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=D,this._lastTokenLanguage=this._languageId,this._tokens.push(new Token$1(w,D,this._languageId)))}nestedLanguageTokenize(w,D,O,W){const U=O.languageId,K=O.state,q=TokenizationRegistry.get(U);if(!q)return this.enterLanguage(U),this.emit(W,""),K;const G=q.tokenize(w,D,K);if(W!==0)for(const Q of G.tokens)this._tokens.push(new Token$1(Q.offset+W,Q.type,Q.language));else this._tokens=this._tokens.concat(G.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,G.endState}finalize(w){return new TokenizationResult(this._tokens,w)}}class MonarchModernTokensCollector{constructor(w,D){this._languageService=w,this._theme=D,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(w){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(w)}emit(w,D){const O=this._theme.match(this._currentLanguageId,D)|1024;this._lastTokenMetadata!==O&&(this._lastTokenMetadata=O,this._tokens.push(w),this._tokens.push(O))}static _merge(w,D,O){const W=w!==null?w.length:0,U=D.length,K=O!==null?O.length:0;if(W===0&&U===0&&K===0)return new Uint32Array(0);if(W===0&&U===0)return O;if(U===0&&K===0)return w;const q=new Uint32Array(W+U+K);w!==null&&q.set(w);for(let G=0;G<U;G++)q[W+G]=D[G];return O!==null&&q.set(O,W+U),q}nestedLanguageTokenize(w,D,O,W){const U=O.languageId,K=O.state,q=TokenizationRegistry.get(U);if(!q)return this.enterLanguage(U),this.emit(W,""),K;const G=q.tokenizeEncoded(w,D,K);if(W!==0)for(let Q=0,Y=G.tokens.length;Q<Y;Q+=2)G.tokens[Q]+=W;return this._prependTokens=MonarchModernTokensCollector._merge(this._prependTokens,this._tokens,G.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,G.endState}finalize(w){return new EncodedTokenizationResult(MonarchModernTokensCollector._merge(this._prependTokens,this._tokens,null),w)}}let MonarchTokenizer=MonarchTokenizer_1=class extends Disposable{constructor(w,D,O,W,U){super(),this._configurationService=U,this._languageService=w,this._standaloneThemeService=D,this._languageId=O,this._lexer=W,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let K=!1;this._register(TokenizationRegistry.onDidChange(q=>{if(K)return;let G=!1;for(let Q=0,Y=q.changedLanguages.length;Q<Y;Q++){const X=q.changedLanguages[Q];if(this._embeddedLanguages[X]){G=!0;break}}G&&(K=!0,TokenizationRegistry.handleChange([this._languageId]),K=!1)})),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._register(this._configurationService.onDidChangeConfiguration(q=>{q.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))}))}getLoadStatus(){const w=[];for(const D in this._embeddedLanguages){const O=TokenizationRegistry.get(D);if(O){if(O instanceof MonarchTokenizer_1){const W=O.getLoadStatus();W.loaded===!1&&w.push(W.promise)}continue}TokenizationRegistry.isResolved(D)||w.push(TokenizationRegistry.getOrCreate(D))}return w.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(w).then(D=>{})}}getInitialState(){const w=MonarchStackElementFactory.create(null,this._lexer.start);return MonarchLineStateFactory.create(w,null)}tokenize(w,D,O){if(w.length>=this._maxTokenizationLineLength)return nullTokenize(this._languageId,O);const W=new MonarchClassicTokensCollector,U=this._tokenize(w,D,O,W);return W.finalize(U)}tokenizeEncoded(w,D,O){if(w.length>=this._maxTokenizationLineLength)return nullTokenizeEncoded(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),O);const W=new MonarchModernTokensCollector(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),U=this._tokenize(w,D,O,W);return W.finalize(U)}_tokenize(w,D,O,W){return O.embeddedLanguageData?this._nestedTokenize(w,D,O,0,W):this._myTokenize(w,D,O,0,W)}_findLeavingNestedLanguageOffset(w,D){let O=this._lexer.tokenizer[D.stack.state];if(!O&&(O=findRules(this._lexer,D.stack.state),!O))throw createError(this._lexer,"tokenizer state is not defined: "+D.stack.state);let W=-1,U=!1;for(const K of O){if(!isIAction(K.action)||K.action.nextEmbedded!=="@pop")continue;U=!0;let q=K.resolveRegex(D.stack.state);const G=q.source;if(G.substr(0,4)==="^(?:"&&G.substr(G.length-1,1)===")"){const Y=(q.ignoreCase?"i":"")+(q.unicode?"u":"");q=new RegExp(G.substr(4,G.length-5),Y)}const Q=w.search(q);Q===-1||Q!==0&&K.matchOnlyAtLineStart||(W===-1||Q<W)&&(W=Q)}if(!U)throw createError(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+D.stack.state);return W}_nestedTokenize(w,D,O,W,U){const K=this._findLeavingNestedLanguageOffset(w,O);if(K===-1){const Q=U.nestedLanguageTokenize(w,D,O.embeddedLanguageData,W);return MonarchLineStateFactory.create(O.stack,new EmbeddedLanguageData(O.embeddedLanguageData.languageId,Q))}const q=w.substring(0,K);q.length>0&&U.nestedLanguageTokenize(q,!1,O.embeddedLanguageData,W);const G=w.substring(K);return this._myTokenize(G,D,O,W+K,U)}_safeRuleName(w){return w?w.name:"(unknown)"}_myTokenize(w,D,O,W,U){U.enterLanguage(this._languageId);const K=w.length,q=D&&this._lexer.includeLF?w+`
`:w,G=q.length;let Q=O.embeddedLanguageData,Y=O.stack,X=0,J=null,te=!0;for(;te||X<G;){const ie=X,se=Y.depth,re=J?J.groups.length:0,ae=Y.state;let le=null,de=null,oe=null,ue=null,pe=null;if(J){le=J.matches;const we=J.groups.shift();de=we.matched,oe=we.action,ue=J.rule,J.groups.length===0&&(J=null)}else{if(!te&&X>=G)break;te=!1;let we=this._lexer.tokenizer[ae];if(!we&&(we=findRules(this._lexer,ae),!we))throw createError(this._lexer,"tokenizer state is not defined: "+ae);const Oe=q.substr(X);for(const Te of we)if((X===0||!Te.matchOnlyAtLineStart)&&(le=Oe.match(Te.resolveRegex(ae)),le)){de=le[0],oe=Te.action;break}}if(le||(le=[""],de=""),oe||(X<G&&(le=[q.charAt(X)],de=le[0]),oe=this._lexer.defaultToken),de===null)break;for(X+=de.length;isFuzzyAction(oe)&&isIAction(oe)&&oe.test;)oe=oe.test(de,le,ae,X===G);let fe=null;if(typeof oe=="string"||Array.isArray(oe))fe=oe;else if(oe.group)fe=oe.group;else if(oe.token!==null&&oe.token!==void 0){if(oe.tokenSubst?fe=substituteMatches(this._lexer,oe.token,de,le,ae):fe=oe.token,oe.nextEmbedded)if(oe.nextEmbedded==="@pop"){if(!Q)throw createError(this._lexer,"cannot pop embedded language if not inside one");Q=null}else{if(Q)throw createError(this._lexer,"cannot enter embedded language from within an embedded language");pe=substituteMatches(this._lexer,oe.nextEmbedded,de,le,ae)}if(oe.goBack&&(X=Math.max(0,X-oe.goBack)),oe.switchTo&&typeof oe.switchTo=="string"){let we=substituteMatches(this._lexer,oe.switchTo,de,le,ae);if(we[0]==="@"&&(we=we.substr(1)),findRules(this._lexer,we))Y=Y.switchTo(we);else throw createError(this._lexer,"trying to switch to a state '"+we+"' that is undefined in rule: "+this._safeRuleName(ue))}else{if(oe.transform&&typeof oe.transform=="function")throw createError(this._lexer,"action.transform not supported");if(oe.next)if(oe.next==="@push"){if(Y.depth>=this._lexer.maxStack)throw createError(this._lexer,"maximum tokenizer stack size reached: ["+Y.state+","+Y.parent.state+",...]");Y=Y.push(ae)}else if(oe.next==="@pop"){if(Y.depth<=1)throw createError(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(ue));Y=Y.pop()}else if(oe.next==="@popall")Y=Y.popall();else{let we=substituteMatches(this._lexer,oe.next,de,le,ae);if(we[0]==="@"&&(we=we.substr(1)),findRules(this._lexer,we))Y=Y.push(we);else throw createError(this._lexer,"trying to set a next state '"+we+"' that is undefined in rule: "+this._safeRuleName(ue))}}oe.log&&typeof oe.log=="string"&&log(this._lexer,this._lexer.languageId+": "+substituteMatches(this._lexer,oe.log,de,le,ae))}if(fe===null)throw createError(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(ue));const Ce=we=>{const Oe=this._languageService.getLanguageIdByLanguageName(we)||this._languageService.getLanguageIdByMimeType(we)||we,Te=this._getNestedEmbeddedLanguageData(Oe);if(X<G){const Re=w.substr(X);return this._nestedTokenize(Re,D,MonarchLineStateFactory.create(Y,Te),W+X,U)}else return MonarchLineStateFactory.create(Y,Te)};if(Array.isArray(fe)){if(J&&J.groups.length>0)throw createError(this._lexer,"groups cannot be nested: "+this._safeRuleName(ue));if(le.length!==fe.length+1)throw createError(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(ue));let we=0;for(let Oe=1;Oe<le.length;Oe++)we+=le[Oe].length;if(we!==de.length)throw createError(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(ue));J={rule:ue,matches:le,groups:[]};for(let Oe=0;Oe<fe.length;Oe++)J.groups[Oe]={action:fe[Oe],matched:le[Oe+1]};X-=de.length;continue}else{if(fe==="@rematch"&&(X-=de.length,de="",le=null,fe="",pe!==null))return Ce(pe);if(de.length===0){if(G===0||se!==Y.depth||ae!==Y.state||(J?J.groups.length:0)!==re)continue;throw createError(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(ue))}let we=null;if(isString(fe)&&fe.indexOf("@brackets")===0){const Oe=fe.substr(9),Te=findBracket(this._lexer,de);if(!Te)throw createError(this._lexer,"@brackets token returned but no bracket defined as: "+de);we=sanitize(Te.token+Oe)}else{const Oe=fe===""?"":fe+this._lexer.tokenPostfix;we=sanitize(Oe)}ie<K&&U.emit(ie+W,we)}if(pe!==null)return Ce(pe)}return MonarchLineStateFactory.create(Y,Q)}_getNestedEmbeddedLanguageData(w){if(!this._languageService.isRegisteredLanguageId(w))return new EmbeddedLanguageData(w,NullState);w!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(w),TokenizationRegistry.getOrCreate(w),this._embeddedLanguages[w]=!0);const D=TokenizationRegistry.get(w);return D?new EmbeddedLanguageData(w,D.getInitialState()):new EmbeddedLanguageData(w,NullState)}};MonarchTokenizer=MonarchTokenizer_1=__decorate$f([__param$f(4,IConfigurationService)],MonarchTokenizer);function findBracket(F,w){if(!w)return null;w=fixCase(F,w);const D=F.brackets;for(const O of D){if(O.open===w)return{token:O.token,bracketType:1};if(O.close===w)return{token:O.token,bracketType:-1}}return null}const ttPolicy$1=createTrustedTypesPolicy("standaloneColorizer",{createHTML:F=>F});class Colorizer{static colorizeElement(w,D,O,W){W=W||{};const U=W.theme||"vs",K=W.mimeType||O.getAttribute("lang")||O.getAttribute("data-lang");if(!K)return console.error("Mode not detected"),Promise.resolve();const q=D.getLanguageIdByMimeType(K)||K;w.setTheme(U);const G=O.firstChild?O.firstChild.nodeValue:"";O.className+=" "+U;const Q=Y=>{const X=ttPolicy$1?.createHTML(Y)??Y;O.innerHTML=X};return this.colorize(D,G||"",q,W).then(Q,Y=>console.error(Y))}static async colorize(w,D,O,W){const U=w.languageIdCodec;let K=4;W&&typeof W.tabSize=="number"&&(K=W.tabSize),startsWithUTF8BOM(D)&&(D=D.substr(1));const q=splitLines(D);if(!w.isRegisteredLanguageId(O))return _fakeColorize(q,K,U);const G=await TokenizationRegistry.getOrCreate(O);return G?_colorize(q,K,G,U):_fakeColorize(q,K,U)}static colorizeLine(w,D,O,W,U=4){const K=ViewLineRenderingData.isBasicASCII(w,D),q=ViewLineRenderingData.containsRTL(w,K,O);return renderViewLine2(new RenderLineInput(!1,!0,w,!1,K,q,0,W,[],U,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(w,D,O=4){const W=w.getLineContent(D);w.tokenization.forceTokenization(D);const K=w.tokenization.getLineTokens(D).inflate();return this.colorizeLine(W,w.mightContainNonBasicASCII(),w.mightContainRTL(),K,O)}}function _colorize(F,w,D,O){return new Promise((W,U)=>{const K=()=>{const q=_actualColorize(F,w,D,O);if(D instanceof MonarchTokenizer){const G=D.getLoadStatus();if(G.loaded===!1){G.promise.then(K,U);return}}W(q)};K()})}function _fakeColorize(F,w,D){let O=[];const U=new Uint32Array(2);U[0]=0,U[1]=33587200;for(let K=0,q=F.length;K<q;K++){const G=F[K];U[0]=G.length;const Q=new LineTokens(U,G,D),Y=ViewLineRenderingData.isBasicASCII(G,!0),X=ViewLineRenderingData.containsRTL(G,Y,!0),J=renderViewLine2(new RenderLineInput(!1,!0,G,!1,Y,X,0,Q,[],w,0,0,0,0,-1,"none",!1,!1,null));O=O.concat(J.html),O.push("<br/>")}return O.join("")}function _actualColorize(F,w,D,O){let W=[],U=D.getInitialState();for(let K=0,q=F.length;K<q;K++){const G=F[K],Q=D.tokenizeEncoded(G,!0,U);LineTokens.convertToEndOffset(Q.tokens,G.length);const Y=new LineTokens(Q.tokens,G,O),X=ViewLineRenderingData.isBasicASCII(G,!0),J=ViewLineRenderingData.containsRTL(G,X,!0),te=renderViewLine2(new RenderLineInput(!1,!0,G,!1,X,J,0,Y.inflate(),[],w,0,0,0,0,-1,"none",!1,!1,null));W=W.concat(te.html),W.push("<br/>"),U=Q.endState}return W.join("")}function joinCombine(F,w,D,O){if(F.length===0)return w;if(w.length===0)return F;const W=[];let U=0,K=0;for(;U<F.length&&K<w.length;){const q=F[U],G=w[K],Q=D(q),Y=D(G);Q<Y?(W.push(q),U++):Q>Y?(W.push(G),K++):(W.push(O(q,G)),U++,K++)}for(;U<F.length;)W.push(F[U]),U++;for(;K<w.length;)W.push(w[K]),K++;return W}function applyObservableDecorations(F,w){const D=new DisposableStore,O=F.createDecorationsCollection();return D.add(autorunOpts({debugName:()=>`Apply decorations from ${w.debugName}`},W=>{const U=w.read(W);O.set(U)})),D.add({dispose:()=>{O.clear()}}),D}function appendRemoveOnDispose(F,w){return F.appendChild(w),toDisposable(()=>{w.remove()})}function prependRemoveOnDispose(F,w){return F.prepend(w),toDisposable(()=>{w.remove()})}class ObservableElementSizeObserver extends Disposable{get width(){return this._width}get height(){return this._height}get automaticLayout(){return this._automaticLayout}constructor(w,D){super(),this._automaticLayout=!1,this.elementSizeObserver=this._register(new ElementSizeObserver(w,D)),this._width=observableValue(this,this.elementSizeObserver.getWidth()),this._height=observableValue(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(O=>transaction(W=>{this._width.set(this.elementSizeObserver.getWidth(),W),this._height.set(this.elementSizeObserver.getHeight(),W)})))}observe(w){this.elementSizeObserver.observe(w)}setAutomaticLayout(w){this._automaticLayout=w,w?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function animatedObservable(F,w,D){let O=w.get(),W=O,U=O;const K=observableValue("animatedValue",O);let q=-1;const G=300;let Q;D.add(autorunHandleChanges({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(X,J)=>(X.didChange(w)&&(J.animate=J.animate||X.change),!0)},(X,J)=>{Q!==void 0&&(F.cancelAnimationFrame(Q),Q=void 0),W=U,O=w.read(X),q=Date.now()-(J.animate?0:G),Y()}));function Y(){const X=Date.now()-q;U=Math.floor(easeOutExpo(X,W,O-W,G)),X<G?Q=F.requestAnimationFrame(Y):U=O,K.set(U,void 0)}return K}function easeOutExpo(F,w,D,O){return F===O?w+D:D*(-Math.pow(2,-10*F/O)+1)+w}class ViewZoneOverlayWidget extends Disposable{constructor(w,D,O){super(),this._register(new ManagedOverlayWidget(w,O)),this._register(applyStyle(O,{height:D.actualHeight,top:D.actualTop}))}}class PlaceholderViewZone{get afterLineNumber(){return this._afterLineNumber.get()}constructor(w,D){this._afterLineNumber=w,this.heightInPx=D,this.domNode=document.createElement("div"),this._actualTop=observableValue(this,void 0),this._actualHeight=observableValue(this,void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=O=>{this._actualTop.set(O,void 0)},this.onComputedHeight=O=>{this._actualHeight.set(O,void 0)}}}class ManagedOverlayWidget{static{this._counter=0}constructor(w,D){this._editor=w,this._domElement=D,this._overlayWidgetId=`managedOverlayWidget-${ManagedOverlayWidget._counter++}`,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}}function applyStyle(F,w){return autorun(D=>{for(let[O,W]of Object.entries(w))W&&typeof W=="object"&&"read"in W&&(W=W.read(D)),typeof W=="number"&&(W=`${W}px`),O=O.replace(/[A-Z]/g,U=>"-"+U.toLowerCase()),F.style[O]=W})}function applyViewZones(F,w,D,O){const W=new DisposableStore,U=[];return W.add(autorunWithStore((K,q)=>{const G=w.read(K),Q=new Map,Y=new Map;D&&D(!0),F.changeViewZones(X=>{for(const J of U)X.removeZone(J),O?.delete(J);U.length=0;for(const J of G){const te=X.addZone(J);J.setZoneId&&J.setZoneId(te),U.push(te),O?.add(te),Q.set(J,te)}}),D&&D(!1),q.add(autorunHandleChanges({createEmptyChangeSummary(){return{zoneIds:[]}},handleChange(X,J){const te=Y.get(X.changedObservable);return te!==void 0&&J.zoneIds.push(te),!0}},(X,J)=>{for(const te of G)te.onChange&&(Y.set(te.onChange,Q.get(te)),te.onChange.read(X));D&&D(!0),F.changeViewZones(te=>{for(const ie of J.zoneIds)te.layoutZone(ie)}),D&&D(!1)}))})),W.add({dispose(){D&&D(!0),F.changeViewZones(K=>{for(const q of U)K.removeZone(q)}),O?.clear(),D&&D(!1)}}),W}function translatePosition(F,w){const D=findLast(w,W=>W.original.startLineNumber<=F.lineNumber);if(!D)return Range$2.fromPositions(F);if(D.original.endLineNumberExclusive<=F.lineNumber){const W=F.lineNumber-D.original.endLineNumberExclusive+D.modified.endLineNumberExclusive;return Range$2.fromPositions(new Position$1(W,F.column))}if(!D.innerChanges)return Range$2.fromPositions(new Position$1(D.modified.startLineNumber,1));const O=findLast(D.innerChanges,W=>W.originalRange.getStartPosition().isBeforeOrEqual(F));if(!O){const W=F.lineNumber-D.original.startLineNumber+D.modified.startLineNumber;return Range$2.fromPositions(new Position$1(W,F.column))}if(O.originalRange.containsPosition(F))return O.modifiedRange;{const W=lengthBetweenPositions(O.originalRange.getEndPosition(),F);return Range$2.fromPositions(W.addToPosition(O.modifiedRange.getEndPosition()))}}function lengthBetweenPositions(F,w){return F.lineNumber===w.lineNumber?new TextLength(0,w.column-F.column):new TextLength(w.lineNumber-F.lineNumber,w.column-1)}function filterWithPrevious(F,w){let D;return F.filter(O=>{const W=w(O,D);return D=O,W})}class RefCounted{static create(w,D=void 0){return new BaseRefCounted(w,w,D)}static createWithDisposable(w,D,O=void 0){const W=new DisposableStore;return W.add(D),W.add(w),new BaseRefCounted(w,W,O)}}class BaseRefCounted extends RefCounted{constructor(w,D,O){super(),this.object=w,this._disposable=D,this._debugOwner=O,this._refCount=1,this._isDisposed=!1,this._owners=[],O&&this._addOwner(O)}_addOwner(w){w&&this._owners.push(w)}createNewRef(w){return this._refCount++,w&&this._addOwner(w),new ClonedRefCounted(this,w)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(w){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),w){const D=this._owners.indexOf(w);D!==-1&&this._owners.splice(D,1)}}}class ClonedRefCounted extends RefCounted{constructor(w,D){super(),this._base=w,this._debugOwner=D,this._isDisposed=!1}get object(){return this._base.object}createNewRef(w){return this._base.createNewRef(w)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}}var __decorate$e=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$e=function(F,w){return function(D,O){w(D,O,F)}};const accessibleDiffViewerInsertIcon=registerIcon("diff-review-insert",Codicon.add,localize("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),accessibleDiffViewerRemoveIcon=registerIcon("diff-review-remove",Codicon.remove,localize("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),accessibleDiffViewerCloseIcon=registerIcon("diff-review-close",Codicon.close,localize("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer."));let AccessibleDiffViewer=class extends Disposable{static{this._ttPolicy=createTrustedTypesPolicy("diffReview",{createHTML:w=>w})}constructor(w,D,O,W,U,K,q,G,Q){super(),this._parentNode=w,this._visible=D,this._setVisible=O,this._canClose=W,this._width=U,this._height=K,this._diffs=q,this._models=G,this._instantiationService=Q,this._state=derivedWithStore(this,(Y,X)=>{const J=this._visible.read(Y);if(this._parentNode.style.visibility=J?"visible":"hidden",!J)return null;const te=X.add(this._instantiationService.createInstance(ViewModel,this._diffs,this._models,this._setVisible,this._canClose)),ie=X.add(this._instantiationService.createInstance(View,this._parentNode,te,this._width,this._height,this._models));return{model:te,view:ie}}).recomputeInitiallyAndOnChange(this._store)}next(){transaction(w=>{const D=this._visible.get();this._setVisible(!0,w),D&&this._state.get().model.nextGroup(w)})}prev(){transaction(w=>{this._setVisible(!0,w),this._state.get().model.previousGroup(w)})}close(){transaction(w=>{this._setVisible(!1,w)})}};AccessibleDiffViewer=__decorate$e([__param$e(8,IInstantiationService)],AccessibleDiffViewer);let ViewModel=class extends Disposable{constructor(w,D,O,W,U){super(),this._diffs=w,this._models=D,this._setVisible=O,this.canClose=W,this._accessibilitySignalService=U,this._groups=observableValue(this,[]),this._currentGroupIdx=observableValue(this,0),this._currentElementIdx=observableValue(this,0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map((K,q)=>this._groups.read(q)[K]),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map((K,q)=>this.currentGroup.read(q)?.lines[K]),this._register(autorun(K=>{const q=this._diffs.read(K);if(!q){this._groups.set([],void 0);return}const G=computeViewElementGroups(q,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());transaction(Q=>{const Y=this._models.getModifiedPosition();if(Y){const X=G.findIndex(J=>Y?.lineNumber<J.range.modified.endLineNumberExclusive);X!==-1&&this._currentGroupIdx.set(X,Q)}this._groups.set(G,Q)})})),this._register(autorun(K=>{const q=this.currentElement.read(K);q?.type===LineType.Deleted?this._accessibilitySignalService.playSignal(AccessibilitySignal.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):q?.type===LineType.Added&&this._accessibilitySignalService.playSignal(AccessibilitySignal.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(autorun(K=>{const q=this.currentElement.read(K);if(q&&q.type!==LineType.Header){const G=q.modifiedLineNumber??q.diff.modified.startLineNumber;this._models.modifiedSetSelection(Range$2.fromPositions(new Position$1(G,1)))}}))}_goToGroupDelta(w,D){const O=this.groups.get();!O||O.length<=1||subtransaction(D,W=>{this._currentGroupIdx.set(OffsetRange.ofLength(O.length).clipCyclic(this._currentGroupIdx.get()+w),W),this._currentElementIdx.set(0,W)})}nextGroup(w){this._goToGroupDelta(1,w)}previousGroup(w){this._goToGroupDelta(-1,w)}_goToLineDelta(w){const D=this.currentGroup.get();!D||D.lines.length<=1||transaction(O=>{this._currentElementIdx.set(OffsetRange.ofLength(D.lines.length).clip(this._currentElementIdx.get()+w),O)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(w){const D=this.currentGroup.get();if(!D)return;const O=D.lines.indexOf(w);O!==-1&&transaction(W=>{this._currentElementIdx.set(O,W)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);const w=this.currentElement.get();w&&(w.type===LineType.Deleted?this._models.originalReveal(Range$2.fromPositions(new Position$1(w.originalLineNumber,1))):this._models.modifiedReveal(w.type!==LineType.Header?Range$2.fromPositions(new Position$1(w.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};ViewModel=__decorate$e([__param$e(4,IAccessibilitySignalService)],ViewModel);const viewElementGroupLineMargin=3;function computeViewElementGroups(F,w,D){const O=[];for(const W of groupAdjacentBy(F,(U,K)=>K.modified.startLineNumber-U.modified.endLineNumberExclusive<2*viewElementGroupLineMargin)){const U=[];U.push(new HeaderViewElement);const K=new LineRange$1(Math.max(1,W[0].original.startLineNumber-viewElementGroupLineMargin),Math.min(W[W.length-1].original.endLineNumberExclusive+viewElementGroupLineMargin,w+1)),q=new LineRange$1(Math.max(1,W[0].modified.startLineNumber-viewElementGroupLineMargin),Math.min(W[W.length-1].modified.endLineNumberExclusive+viewElementGroupLineMargin,D+1));forEachAdjacent(W,(Y,X)=>{const J=new LineRange$1(Y?Y.original.endLineNumberExclusive:K.startLineNumber,X?X.original.startLineNumber:K.endLineNumberExclusive),te=new LineRange$1(Y?Y.modified.endLineNumberExclusive:q.startLineNumber,X?X.modified.startLineNumber:q.endLineNumberExclusive);J.forEach(ie=>{U.push(new UnchangedLineViewElement(ie,te.startLineNumber+(ie-J.startLineNumber)))}),X&&(X.original.forEach(ie=>{U.push(new DeletedLineViewElement(X,ie))}),X.modified.forEach(ie=>{U.push(new AddedLineViewElement(X,ie))}))});const G=W[0].modified.join(W[W.length-1].modified),Q=W[0].original.join(W[W.length-1].original);O.push(new ViewElementGroup(new LineRangeMapping(G,Q),U))}return O}var LineType;(function(F){F[F.Header=0]="Header",F[F.Unchanged=1]="Unchanged",F[F.Deleted=2]="Deleted",F[F.Added=3]="Added"})(LineType||(LineType={}));class ViewElementGroup{constructor(w,D){this.range=w,this.lines=D}}class HeaderViewElement{constructor(){this.type=LineType.Header}}class DeletedLineViewElement{constructor(w,D){this.diff=w,this.originalLineNumber=D,this.type=LineType.Deleted,this.modifiedLineNumber=void 0}}class AddedLineViewElement{constructor(w,D){this.diff=w,this.modifiedLineNumber=D,this.type=LineType.Added,this.originalLineNumber=void 0}}class UnchangedLineViewElement{constructor(w,D){this.originalLineNumber=w,this.modifiedLineNumber=D,this.type=LineType.Unchanged}}let View=class extends Disposable{constructor(w,D,O,W,U,K){super(),this._element=w,this._model=D,this._width=O,this._height=W,this._models=U,this._languageService=K,this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";const q=document.createElement("div");q.className="diff-review-actions",this._actionBar=this._register(new ActionBar(q)),this._register(autorun(G=>{this._actionBar.clear(),this._model.canClose.read(G)&&this._actionBar.push(new Action("diffreview.close",localize("label.close","Close"),"close-diff-review "+ThemeIcon.asClassName(accessibleDiffViewerCloseIcon),!0,async()=>D.close()),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new DomScrollableElement(this._content,{})),reset(this.domNode,this._scrollbar.getDomNode(),q),this._register(autorun(G=>{this._height.read(G),this._width.read(G),this._scrollbar.scanDomNode()})),this._register(toDisposable(()=>{reset(this.domNode)})),this._register(applyStyle(this.domNode,{width:this._width,height:this._height})),this._register(applyStyle(this._content,{width:this._width,height:this._height})),this._register(autorunWithStore((G,Q)=>{this._model.currentGroup.read(G),this._render(Q)})),this._register(addStandardDisposableListener(this.domNode,"keydown",G=>{(G.equals(18)||G.equals(2066)||G.equals(530))&&(G.preventDefault(),this._model.goToNextLine()),(G.equals(16)||G.equals(2064)||G.equals(528))&&(G.preventDefault(),this._model.goToPreviousLine()),(G.equals(9)||G.equals(2057)||G.equals(521)||G.equals(1033))&&(G.preventDefault(),this._model.close()),(G.equals(10)||G.equals(3))&&(G.preventDefault(),this._model.revealCurrentElementInEditor())}))}_render(w){const D=this._models.getOriginalOptions(),O=this._models.getModifiedOptions(),W=document.createElement("div");W.className="diff-review-table",W.setAttribute("role","list"),W.setAttribute("aria-label",localize("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),applyFontInfo(W,O.get(50)),reset(this._content,W);const U=this._models.getOriginalModel(),K=this._models.getModifiedModel();if(!U||!K)return;const q=U.getOptions(),G=K.getOptions(),Q=O.get(67),Y=this._model.currentGroup.get();for(const X of Y?.lines||[]){if(!Y)break;let J;if(X.type===LineType.Header){const ie=document.createElement("div");ie.className="diff-review-row",ie.setAttribute("role","listitem");const se=Y.range,re=this._model.currentGroupIndex.get(),ae=this._model.groups.get().length,le=pe=>pe===0?localize("no_lines_changed","no lines changed"):pe===1?localize("one_line_changed","1 line changed"):localize("more_lines_changed","{0} lines changed",pe),de=le(se.original.length),oe=le(se.modified.length);ie.setAttribute("aria-label",localize({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",re+1,ae,se.original.startLineNumber,de,se.modified.startLineNumber,oe));const ue=document.createElement("div");ue.className="diff-review-cell diff-review-summary",ue.appendChild(document.createTextNode(`${re+1}/${ae}: @@ -${se.original.startLineNumber},${se.original.length} +${se.modified.startLineNumber},${se.modified.length} @@`)),ie.appendChild(ue),J=ie}else J=this._createRow(X,Q,this._width.get(),D,U,q,O,K,G);W.appendChild(J);const te=derived(ie=>this._model.currentElement.read(ie)===X);w.add(autorun(ie=>{const se=te.read(ie);J.tabIndex=se?0:-1,se&&J.focus()})),w.add(addDisposableListener(J,"focus",()=>{this._model.goToLine(X)}))}this._scrollbar.scanDomNode()}_createRow(w,D,O,W,U,K,q,G,Q){const Y=W.get(146),X=Y.glyphMarginWidth+Y.lineNumbersWidth,J=q.get(146),te=10+J.glyphMarginWidth+J.lineNumbersWidth;let ie="diff-review-row",se="";const re="diff-review-spacer";let ae=null;switch(w.type){case LineType.Added:ie="diff-review-row line-insert",se=" char-insert",ae=accessibleDiffViewerInsertIcon;break;case LineType.Deleted:ie="diff-review-row line-delete",se=" char-delete",ae=accessibleDiffViewerRemoveIcon;break}const le=document.createElement("div");le.style.minWidth=O+"px",le.className=ie,le.setAttribute("role","listitem"),le.ariaLevel="";const de=document.createElement("div");de.className="diff-review-cell",de.style.height=`${D}px`,le.appendChild(de);const oe=document.createElement("span");oe.style.width=X+"px",oe.style.minWidth=X+"px",oe.className="diff-review-line-number"+se,w.originalLineNumber!==void 0?oe.appendChild(document.createTextNode(String(w.originalLineNumber))):oe.innerText=" ",de.appendChild(oe);const ue=document.createElement("span");ue.style.width=te+"px",ue.style.minWidth=te+"px",ue.style.paddingRight="10px",ue.className="diff-review-line-number"+se,w.modifiedLineNumber!==void 0?ue.appendChild(document.createTextNode(String(w.modifiedLineNumber))):ue.innerText=" ",de.appendChild(ue);const pe=document.createElement("span");if(pe.className=re,ae){const we=document.createElement("span");we.className=ThemeIcon.asClassName(ae),we.innerText="  ",pe.appendChild(we)}else pe.innerText="  ";de.appendChild(pe);let fe;if(w.modifiedLineNumber!==void 0){let we=this._getLineHtml(G,q,Q.tabSize,w.modifiedLineNumber,this._languageService.languageIdCodec);AccessibleDiffViewer._ttPolicy&&(we=AccessibleDiffViewer._ttPolicy.createHTML(we)),de.insertAdjacentHTML("beforeend",we),fe=G.getLineContent(w.modifiedLineNumber)}else{let we=this._getLineHtml(U,W,K.tabSize,w.originalLineNumber,this._languageService.languageIdCodec);AccessibleDiffViewer._ttPolicy&&(we=AccessibleDiffViewer._ttPolicy.createHTML(we)),de.insertAdjacentHTML("beforeend",we),fe=U.getLineContent(w.originalLineNumber)}fe.length===0&&(fe=localize("blankLine","blank"));let Ce="";switch(w.type){case LineType.Unchanged:w.originalLineNumber===w.modifiedLineNumber?Ce=localize({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",fe,w.originalLineNumber):Ce=localize("equalLine","{0} original line {1} modified line {2}",fe,w.originalLineNumber,w.modifiedLineNumber);break;case LineType.Added:Ce=localize("insertLine","+ {0} modified line {1}",fe,w.modifiedLineNumber);break;case LineType.Deleted:Ce=localize("deleteLine","- {0} original line {1}",fe,w.originalLineNumber);break}return le.setAttribute("aria-label",Ce),le}_getLineHtml(w,D,O,W,U){const K=w.getLineContent(W),q=D.get(50),G=LineTokens.createEmpty(K,U),Q=ViewLineRenderingData.isBasicASCII(K,w.mightContainNonBasicASCII()),Y=ViewLineRenderingData.containsRTL(K,Q,w.mightContainRTL());return renderViewLine2(new RenderLineInput(q.isMonospace&&!D.get(33),q.canUseHalfwidthRightwardsArrow,K,!1,Q,Y,0,G,[],O,0,q.spaceWidth,q.middotWidth,q.wsmiddotWidth,D.get(118),D.get(100),D.get(95),D.get(51)!==EditorFontLigatures.OFF,null)).html}};View=__decorate$e([__param$e(5,ILanguageService)],View);class AccessibleDiffViewerModelFromEditors{constructor(w){this.editors=w}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(w){this.editors.original.revealRange(w),this.editors.original.setSelection(w),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(w){w&&(this.editors.modified.revealRange(w),this.editors.modified.setSelection(w)),this.editors.modified.focus()}modifiedSetSelection(w){this.editors.modified.setSelection(w)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}}registerColor("diffEditor.move.border","#8b8b8b9c",localize("diffEditor.move.border","The border color for text that got moved in the diff editor."));registerColor("diffEditor.moveActive.border","#FFA500",localize("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor."));registerColor("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},localize("diffEditor.unchangedRegionShadow","The color of the shadow around unchanged region widgets."));const diffInsertIcon=registerIcon("diff-insert",Codicon.add,localize("diffInsertIcon","Line decoration for inserts in the diff editor.")),diffRemoveIcon=registerIcon("diff-remove",Codicon.remove,localize("diffRemoveIcon","Line decoration for removals in the diff editor.")),diffLineAddDecorationBackgroundWithIndicator=ModelDecorationOptions.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+ThemeIcon.asClassName(diffInsertIcon),marginClassName:"gutter-insert"}),diffLineDeleteDecorationBackgroundWithIndicator=ModelDecorationOptions.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+ThemeIcon.asClassName(diffRemoveIcon),marginClassName:"gutter-delete"}),diffLineAddDecorationBackground=ModelDecorationOptions.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),diffLineDeleteDecorationBackground=ModelDecorationOptions.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),diffAddDecoration=ModelDecorationOptions.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),diffWholeLineAddDecoration=ModelDecorationOptions.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),diffAddDecorationEmpty=ModelDecorationOptions.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),diffDeleteDecoration=ModelDecorationOptions.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),diffWholeLineDeleteDecoration=ModelDecorationOptions.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),diffDeleteDecorationEmpty=ModelDecorationOptions.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});var __decorate$d=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$d=function(F,w){return function(D,O){w(D,O,F)}},WorkerBasedDocumentDiffProvider_1;const IDiffProviderFactoryService=createDecorator("diffProviderFactoryService");let WorkerBasedDiffProviderFactoryService=class{constructor(w){this.instantiationService=w}createDiffProvider(w){return this.instantiationService.createInstance(WorkerBasedDocumentDiffProvider,w)}};WorkerBasedDiffProviderFactoryService=__decorate$d([__param$d(0,IInstantiationService)],WorkerBasedDiffProviderFactoryService);registerSingleton(IDiffProviderFactoryService,WorkerBasedDiffProviderFactoryService,1);let WorkerBasedDocumentDiffProvider=class{static{WorkerBasedDocumentDiffProvider_1=this}static{this.diffCache=new Map}constructor(w,D,O){this.editorWorkerService=D,this.telemetryService=O,this.onDidChangeEventEmitter=new Emitter$1,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(w)}dispose(){this.diffAlgorithmOnDidChangeSubscription?.dispose()}async computeDiff(w,D,O,W){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(w,D,O,W);if(w.isDisposed()||D.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(w.getLineCount()===1&&w.getLineMaxColumn(1)===1)return D.getLineCount()===1&&D.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new DetailedLineRangeMapping(new LineRange$1(1,2),new LineRange$1(1,D.getLineCount()+1),[new RangeMapping(w.getFullModelRange(),D.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const U=JSON.stringify([w.uri.toString(),D.uri.toString()]),K=JSON.stringify([w.id,D.id,w.getAlternativeVersionId(),D.getAlternativeVersionId(),JSON.stringify(O)]),q=WorkerBasedDocumentDiffProvider_1.diffCache.get(U);if(q&&q.context===K)return q.result;const G=StopWatch.create(),Q=await this.editorWorkerService.computeDiff(w.uri,D.uri,O,this.diffAlgorithm),Y=G.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:Y,timedOut:Q?.quitEarly??!0,detectedMoves:O.computeMoves?Q?.moves.length??0:-1}),W.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!Q)throw new Error("no diff result available");return WorkerBasedDocumentDiffProvider_1.diffCache.size>10&&WorkerBasedDocumentDiffProvider_1.diffCache.delete(WorkerBasedDocumentDiffProvider_1.diffCache.keys().next().value),WorkerBasedDocumentDiffProvider_1.diffCache.set(U,{result:Q,context:K}),Q}setOptions(w){let D=!1;w.diffAlgorithm&&this.diffAlgorithm!==w.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription?.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=w.diffAlgorithm,typeof w.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=w.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),D=!0),D&&this.onDidChangeEventEmitter.fire()}};WorkerBasedDocumentDiffProvider=WorkerBasedDocumentDiffProvider_1=__decorate$d([__param$d(1,IEditorWorkerService),__param$d(2,ITelemetryService)],WorkerBasedDocumentDiffProvider);function isHotReloadEnabled(){return env&&!!env.VSCODE_DEV}function registerHotReloadHandler(F){if(isHotReloadEnabled()){const w=registerGlobalHotReloadHandler();return w.add(F),{dispose(){w.delete(F)}}}else return{dispose(){}}}function registerGlobalHotReloadHandler(){hotReloadHandlers||(hotReloadHandlers=new Set);const F=globalThis;return F.$hotReload_applyNewExports||(F.$hotReload_applyNewExports=w=>{const D={config:{mode:void 0},...w},O=[];for(const W of hotReloadHandlers){const U=W(D);U&&O.push(U)}if(O.length>0)return W=>{let U=!1;for(const K of O)K(W)&&(U=!0);return U}}),hotReloadHandlers}let hotReloadHandlers;isHotReloadEnabled()&&registerHotReloadHandler(({oldExports:F,newSrc:w,config:D})=>{if(D.mode==="patch-prototype")return O=>{for(const W in O){const U=O[W];if(console.log(`[hot-reload] Patching prototype methods of '${W}'`,{exportedItem:U}),typeof U=="function"&&U.prototype){const K=F[W];if(K){for(const q of Object.getOwnPropertyNames(U.prototype)){const G=Object.getOwnPropertyDescriptor(U.prototype,q),Q=Object.getOwnPropertyDescriptor(K.prototype,q);G?.value?.toString()!==Q?.value?.toString()&&console.log(`[hot-reload] Patching prototype method '${W}.${q}'`),Object.defineProperty(K.prototype,q,G)}O[W]=K}}}return!0}});function readHotReloadableExport(F,w){return observeHotReloadableExports([F],w),F}function observeHotReloadableExports(F,w){isHotReloadEnabled()&&observableSignalFromEvent("reload",O=>registerHotReloadHandler(({oldExports:W})=>{if([...Object.values(W)].some(U=>F.includes(U)))return U=>(O(void 0),!0)})).read(w)}var __decorate$c=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$c=function(F,w){return function(D,O){w(D,O,F)}};let DiffEditorViewModel=class extends Disposable{setActiveMovedText(w){this._activeMovedText.set(w,void 0)}constructor(w,D,O){super(),this.model=w,this._options=D,this._diffProviderFactoryService=O,this._isDiffUpToDate=observableValue(this,!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=observableValue(this,void 0),this.diff=this._diff,this._unchangedRegions=observableValue(this,void 0),this.unchangedRegions=derived(this,q=>this._options.hideUnchangedRegions.read(q)?this._unchangedRegions.read(q)?.regions??[]:(transaction(G=>{for(const Q of this._unchangedRegions.get()?.regions||[])Q.collapseAll(G)}),[])),this.movedTextToCompare=observableValue(this,void 0),this._activeMovedText=observableValue(this,void 0),this._hoveredMovedText=observableValue(this,void 0),this.activeMovedText=derived(this,q=>this.movedTextToCompare.read(q)??this._hoveredMovedText.read(q)??this._activeMovedText.read(q)),this._cancellationTokenSource=new CancellationTokenSource$1,this._diffProvider=derived(this,q=>{const G=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(q)}),Q=observableSignalFromEvent("onDidChange",G.onDidChange);return{diffProvider:G,onChangeSignal:Q}}),this._register(toDisposable(()=>this._cancellationTokenSource.cancel()));const W=observableSignal("contentChangedSignal"),U=this._register(new RunOnceScheduler(()=>W.trigger(void 0),200));this._register(autorun(q=>{const G=this._unchangedRegions.read(q);if(!G||G.regions.some(ie=>ie.isDragged.read(q)))return;const Q=G.originalDecorationIds.map(ie=>w.original.getDecorationRange(ie)).map(ie=>ie?LineRange$1.fromRangeInclusive(ie):void 0),Y=G.modifiedDecorationIds.map(ie=>w.modified.getDecorationRange(ie)).map(ie=>ie?LineRange$1.fromRangeInclusive(ie):void 0),X=G.regions.map((ie,se)=>!Q[se]||!Y[se]?void 0:new UnchangedRegion(Q[se].startLineNumber,Y[se].startLineNumber,Q[se].length,ie.visibleLineCountTop.read(q),ie.visibleLineCountBottom.read(q))).filter(isDefined),J=[];let te=!1;for(const ie of groupAdjacentBy(X,(se,re)=>se.getHiddenModifiedRange(q).endLineNumberExclusive===re.getHiddenModifiedRange(q).startLineNumber))if(ie.length>1){te=!0;const se=ie.reduce((ae,le)=>ae+le.lineCount,0),re=new UnchangedRegion(ie[0].originalLineNumber,ie[0].modifiedLineNumber,se,ie[0].visibleLineCountTop.get(),ie[ie.length-1].visibleLineCountBottom.get());J.push(re)}else J.push(ie[0]);if(te){const ie=w.original.deltaDecorations(G.originalDecorationIds,J.map(re=>({range:re.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),se=w.modified.deltaDecorations(G.modifiedDecorationIds,J.map(re=>({range:re.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));transaction(re=>{this._unchangedRegions.set({regions:J,originalDecorationIds:ie,modifiedDecorationIds:se},re)})}}));const K=(q,G,Q)=>{const Y=UnchangedRegion.fromDiffs(q.changes,w.original.getLineCount(),w.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(Q),this._options.hideUnchangedRegionsContextLineCount.read(Q));let X;const J=this._unchangedRegions.get();if(J){const re=J.originalDecorationIds.map(oe=>w.original.getDecorationRange(oe)).map(oe=>oe?LineRange$1.fromRangeInclusive(oe):void 0),ae=J.modifiedDecorationIds.map(oe=>w.modified.getDecorationRange(oe)).map(oe=>oe?LineRange$1.fromRangeInclusive(oe):void 0);let de=filterWithPrevious(J.regions.map((oe,ue)=>{if(!re[ue]||!ae[ue])return;const pe=re[ue].length;return new UnchangedRegion(re[ue].startLineNumber,ae[ue].startLineNumber,pe,Math.min(oe.visibleLineCountTop.get(),pe),Math.min(oe.visibleLineCountBottom.get(),pe-oe.visibleLineCountTop.get()))}).filter(isDefined),(oe,ue)=>!ue||oe.modifiedLineNumber>=ue.modifiedLineNumber+ue.lineCount&&oe.originalLineNumber>=ue.originalLineNumber+ue.lineCount).map(oe=>new LineRangeMapping(oe.getHiddenOriginalRange(Q),oe.getHiddenModifiedRange(Q)));de=LineRangeMapping.clip(de,LineRange$1.ofLength(1,w.original.getLineCount()),LineRange$1.ofLength(1,w.modified.getLineCount())),X=LineRangeMapping.inverse(de,w.original.getLineCount(),w.modified.getLineCount())}const te=[];if(X)for(const re of Y){const ae=X.filter(le=>le.original.intersectsStrict(re.originalUnchangedRange)&&le.modified.intersectsStrict(re.modifiedUnchangedRange));te.push(...re.setVisibleRanges(ae,G))}else te.push(...Y);const ie=w.original.deltaDecorations(J?.originalDecorationIds||[],te.map(re=>({range:re.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),se=w.modified.deltaDecorations(J?.modifiedDecorationIds||[],te.map(re=>({range:re.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:te,originalDecorationIds:ie,modifiedDecorationIds:se},G)};this._register(w.modified.onDidChangeContent(q=>{if(this._diff.get()){const Q=TextEditInfo.fromModelContentChanges(q.changes);this._lastDiff,w.original,w.modified}this._isDiffUpToDate.set(!1,void 0),U.schedule()})),this._register(w.original.onDidChangeContent(q=>{if(this._diff.get()){const Q=TextEditInfo.fromModelContentChanges(q.changes);this._lastDiff,w.original,w.modified}this._isDiffUpToDate.set(!1,void 0),U.schedule()})),this._register(autorunWithStore(async(q,G)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(q),this._options.hideUnchangedRegionsContextLineCount.read(q),U.cancel(),W.read(q);const Q=this._diffProvider.read(q);Q.onChangeSignal.read(q),readHotReloadableExport(DefaultLinesDiffComputer,q),readHotReloadableExport(optimizeSequenceDiffs,q),this._isDiffUpToDate.set(!1,void 0);let Y=[];G.add(w.original.onDidChangeContent(te=>{const ie=TextEditInfo.fromModelContentChanges(te.changes);Y=combineTextEditInfos(Y,ie)}));let X=[];G.add(w.modified.onDidChangeContent(te=>{const ie=TextEditInfo.fromModelContentChanges(te.changes);X=combineTextEditInfos(X,ie)}));let J=await Q.diffProvider.computeDiff(w.original,w.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(q),maxComputationTimeMs:this._options.maxComputationTimeMs.read(q),computeMoves:this._options.showMoves.read(q)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||w.original.isDisposed()||w.modified.isDisposed()||(J=normalizeDocumentDiff(J,w.original,w.modified),J=(w.original,w.modified,void 0)??J,J=(w.original,w.modified,void 0)??J,transaction(te=>{K(J,te),this._lastDiff=J;const ie=DiffState.fromDiffResult(J);this._diff.set(ie,te),this._isDiffUpToDate.set(!0,te);const se=this.movedTextToCompare.get();this.movedTextToCompare.set(se?this._lastDiff.moves.find(re=>re.lineRangeMapping.modified.intersect(se.lineRangeMapping.modified)):void 0,te)}))}))}ensureModifiedLineIsVisible(w,D,O){if(this.diff.get()?.mappings.length===0)return;const W=this._unchangedRegions.get()?.regions||[];for(const U of W)if(U.getHiddenModifiedRange(void 0).contains(w)){U.showModifiedLine(w,D,O);return}}ensureOriginalLineIsVisible(w,D,O){if(this.diff.get()?.mappings.length===0)return;const W=this._unchangedRegions.get()?.regions||[];for(const U of W)if(U.getHiddenOriginalRange(void 0).contains(w)){U.showOriginalLine(w,D,O);return}}async waitForDiff(){await waitForState(this.isDiffUpToDate,w=>w)}serializeState(){return{collapsedRegions:this._unchangedRegions.get()?.regions.map(D=>({range:D.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(w){const D=w.collapsedRegions?.map(W=>LineRange$1.deserialize(W.range)),O=this._unchangedRegions.get();!O||!D||transaction(W=>{for(const U of O.regions)for(const K of D)if(U.modifiedUnchangedRange.intersect(K)){U.setHiddenModifiedRange(K,W);break}})}};DiffEditorViewModel=__decorate$c([__param$c(2,IDiffProviderFactoryService)],DiffEditorViewModel);function normalizeDocumentDiff(F,w,D){return{changes:F.changes.map(O=>new DetailedLineRangeMapping(O.original,O.modified,O.innerChanges?O.innerChanges.map(W=>normalizeRangeMapping(W,w,D)):void 0)),moves:F.moves,identical:F.identical,quitEarly:F.quitEarly}}function normalizeRangeMapping(F,w,D){let O=F.originalRange,W=F.modifiedRange;return O.startColumn===1&&W.startColumn===1&&(O.endColumn!==1||W.endColumn!==1)&&O.endColumn===w.getLineMaxColumn(O.endLineNumber)&&W.endColumn===D.getLineMaxColumn(W.endLineNumber)&&O.endLineNumber<w.getLineCount()&&W.endLineNumber<D.getLineCount()&&(O=O.setEndPosition(O.endLineNumber+1,1),W=W.setEndPosition(W.endLineNumber+1,1)),new RangeMapping(O,W)}class DiffState{static fromDiffResult(w){return new DiffState(w.changes.map(D=>new DiffMapping(D)),w.moves||[],w.identical,w.quitEarly)}constructor(w,D,O,W){this.mappings=w,this.movedTexts=D,this.identical=O,this.quitEarly=W}}class DiffMapping{constructor(w){this.lineRangeMapping=w}}class UnchangedRegion{static fromDiffs(w,D,O,W,U){const K=DetailedLineRangeMapping.inverse(w,D,O),q=[];for(const G of K){let Q=G.original.startLineNumber,Y=G.modified.startLineNumber,X=G.original.length;const J=Q===1&&Y===1,te=Q+X===D+1&&Y+X===O+1;(J||te)&&X>=U+W?(J&&!te&&(X-=U),te&&!J&&(Q+=U,Y+=U,X-=U),q.push(new UnchangedRegion(Q,Y,X,0,0))):X>=U*2+W&&(Q+=U,Y+=U,X-=U*2,q.push(new UnchangedRegion(Q,Y,X,0,0)))}return q}get originalUnchangedRange(){return LineRange$1.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return LineRange$1.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(w,D,O,W,U){this.originalLineNumber=w,this.modifiedLineNumber=D,this.lineCount=O,this._visibleLineCountTop=observableValue(this,0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=observableValue(this,0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=derived(this,G=>this.visibleLineCountTop.read(G)+this.visibleLineCountBottom.read(G)===this.lineCount&&!this.isDragged.read(G)),this.isDragged=observableValue(this,void 0);const K=Math.max(Math.min(W,this.lineCount),0),q=Math.max(Math.min(U,this.lineCount-W),0);softAssert(W===K),softAssert(U===q),this._visibleLineCountTop.set(K,void 0),this._visibleLineCountBottom.set(q,void 0)}setVisibleRanges(w,D){const O=[],W=new LineRangeSet(w.map(G=>G.modified)).subtractFrom(this.modifiedUnchangedRange);let U=this.originalLineNumber,K=this.modifiedLineNumber;const q=this.modifiedLineNumber+this.lineCount;if(W.ranges.length===0)this.showAll(D),O.push(this);else{let G=0;for(const Q of W.ranges){const Y=G===W.ranges.length-1;G++;const X=(Y?q:Q.endLineNumberExclusive)-K,J=new UnchangedRegion(U,K,X,0,0);J.setHiddenModifiedRange(Q,D),O.push(J),U=J.originalUnchangedRange.endLineNumberExclusive,K=J.modifiedUnchangedRange.endLineNumberExclusive}}return O}shouldHideControls(w){return this._shouldHideControls.read(w)}getHiddenOriginalRange(w){return LineRange$1.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(w),this.lineCount-this._visibleLineCountTop.read(w)-this._visibleLineCountBottom.read(w))}getHiddenModifiedRange(w){return LineRange$1.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(w),this.lineCount-this._visibleLineCountTop.read(w)-this._visibleLineCountBottom.read(w))}setHiddenModifiedRange(w,D){const O=w.startLineNumber-this.modifiedLineNumber,W=this.modifiedLineNumber+this.lineCount-w.endLineNumberExclusive;this.setState(O,W,D)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(w=10,D){const O=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+w,O),D)}showMoreBelow(w=10,D){const O=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+w,O),D)}showAll(w){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),w)}showModifiedLine(w,D,O){const W=w+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),U=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-w;D===0&&W<U||D===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+W,O):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+U,O)}showOriginalLine(w,D,O){const W=w-this.originalLineNumber,U=this.originalLineNumber+this.lineCount-w;D===0&&W<U||D===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+U-W,this.getMaxVisibleLineCountTop()),O):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+W-U,this.getMaxVisibleLineCountBottom()),O)}collapseAll(w){this._visibleLineCountTop.set(0,w),this._visibleLineCountBottom.set(0,w)}setState(w,D,O){w=Math.max(Math.min(w,this.lineCount),0),D=Math.max(Math.min(D,this.lineCount-w),0),this._visibleLineCountTop.set(w,O),this._visibleLineCountBottom.set(D,O)}}function applyOriginalEdits(F,w,D,O){}function applyModifiedEdits(F,w,D,O){}class InlineDiffDeletedCodeMargin extends Disposable{get visibility(){return this._visibility}set visibility(w){this._visibility!==w&&(this._visibility=w,this._diffActions.style.visibility=w?"visible":"hidden")}constructor(w,D,O,W,U,K,q,G,Q){super(),this._getViewZoneId=w,this._marginDomNode=D,this._modifiedEditor=O,this._diff=W,this._editor=U,this._viewLineCounts=K,this._originalTextModel=q,this._contextMenuService=G,this._clipboardService=Q,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=ThemeIcon.asClassName(Codicon.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const Y=this._modifiedEditor.getOption(67);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${Y}px`,this._diffActions.style.lineHeight=`${Y}px`,this._marginDomNode.appendChild(this._diffActions);let X=0;const J=O.getOption(128)&&!isIOS,te=(ie,se)=>{this._contextMenuService.showContextMenu({domForShadowRoot:J?O.getDomNode()??void 0:void 0,getAnchor:()=>({x:ie,y:se}),getActions:()=>{const re=[],ae=W.modified.isEmpty;return re.push(new Action("diff.clipboard.copyDeletedContent",ae?W.original.length>1?localize("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):localize("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):W.original.length>1?localize("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):localize("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,async()=>{const de=this._originalTextModel.getValueInRange(W.original.toExclusiveRange());await this._clipboardService.writeText(de)})),W.original.length>1&&re.push(new Action("diff.clipboard.copyDeletedLineContent",ae?localize("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",W.original.startLineNumber+X):localize("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",W.original.startLineNumber+X),void 0,!0,async()=>{let de=this._originalTextModel.getLineContent(W.original.startLineNumber+X);de===""&&(de=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(de)})),O.getOption(92)||re.push(new Action("diff.inline.revertChange",localize("diff.inline.revertChange.label","Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),re},autoSelectFirstItem:!0})};this._register(addStandardDisposableListener(this._diffActions,"mousedown",ie=>{if(!ie.leftButton)return;const{top:se,height:re}=getDomNodePagePosition(this._diffActions),ae=Math.floor(Y/3);ie.preventDefault(),te(ie.posx,se+re+ae)})),this._register(O.onMouseMove(ie=>{(ie.target.type===8||ie.target.type===5)&&ie.target.detail.viewZoneId===this._getViewZoneId()?(X=this._updateLightBulbPosition(this._marginDomNode,ie.event.browserEvent.y,Y),this.visibility=!0):this.visibility=!1})),this._register(O.onMouseDown(ie=>{ie.event.leftButton&&(ie.target.type===8||ie.target.type===5)&&ie.target.detail.viewZoneId===this._getViewZoneId()&&(ie.event.preventDefault(),X=this._updateLightBulbPosition(this._marginDomNode,ie.event.browserEvent.y,Y),te(ie.event.posx,ie.event.posy+Y))}))}_updateLightBulbPosition(w,D,O){const{top:W}=getDomNodePagePosition(w),U=D-W,K=Math.floor(U/O),q=K*O;if(this._diffActions.style.top=`${q}px`,this._viewLineCounts){let G=0;for(let Q=0;Q<this._viewLineCounts.length;Q++)if(G+=this._viewLineCounts[Q],K<G)return Q}return K}}const ttPolicy=createTrustedTypesPolicy("diffEditorWidget",{createHTML:F=>F});function renderLines(F,w,D,O){applyFontInfo(O,w.fontInfo);const W=D.length>0,U=new StringBuilder(1e4);let K=0,q=0;const G=[];for(let J=0;J<F.lineTokens.length;J++){const te=J+1,ie=F.lineTokens[J],se=F.lineBreakData[J],re=LineDecoration.filter(D,te,1,Number.MAX_SAFE_INTEGER);if(se){let ae=0;for(const le of se.breakOffsets){const de=ie.sliceAndInflate(ae,le,0);K=Math.max(K,renderOriginalLine(q,de,LineDecoration.extractWrapped(re,ae,le),W,F.mightContainNonBasicASCII,F.mightContainRTL,w,U)),q++,ae=le}G.push(se.breakOffsets.length)}else G.push(1),K=Math.max(K,renderOriginalLine(q,ie,re,W,F.mightContainNonBasicASCII,F.mightContainRTL,w,U)),q++}K+=w.scrollBeyondLastColumn;const Q=U.build(),Y=ttPolicy?ttPolicy.createHTML(Q):Q;O.innerHTML=Y;const X=K*w.typicalHalfwidthCharacterWidth;return{heightInLines:q,minWidthInPx:X,viewLineCounts:G}}class LineSource{constructor(w,D,O,W){this.lineTokens=w,this.lineBreakData=D,this.mightContainNonBasicASCII=O,this.mightContainRTL=W}}class RenderOptions{static fromEditor(w){const D=w.getOptions(),O=D.get(50),W=D.get(146);return new RenderOptions(w.getModel()?.getOptions().tabSize||0,O,D.get(33),O.typicalHalfwidthCharacterWidth,D.get(105),D.get(67),W.decorationsWidth,D.get(118),D.get(100),D.get(95),D.get(51))}constructor(w,D,O,W,U,K,q,G,Q,Y,X){this.tabSize=w,this.fontInfo=D,this.disableMonospaceOptimizations=O,this.typicalHalfwidthCharacterWidth=W,this.scrollBeyondLastColumn=U,this.lineHeight=K,this.lineDecorationsWidth=q,this.stopRenderingLineAfter=G,this.renderWhitespace=Q,this.renderControlCharacters=Y,this.fontLigatures=X}}function renderOriginalLine(F,w,D,O,W,U,K,q){q.appendString('<div class="view-line'),O||q.appendString(" char-delete"),q.appendString('" style="top:'),q.appendString(String(F*K.lineHeight)),q.appendString('px;width:1000000px;">');const G=w.getLineContent(),Q=ViewLineRenderingData.isBasicASCII(G,W),Y=ViewLineRenderingData.containsRTL(G,Q,U),X=renderViewLine(new RenderLineInput(K.fontInfo.isMonospace&&!K.disableMonospaceOptimizations,K.fontInfo.canUseHalfwidthRightwardsArrow,G,!1,Q,Y,0,w,D,K.tabSize,0,K.fontInfo.spaceWidth,K.fontInfo.middotWidth,K.fontInfo.wsmiddotWidth,K.stopRenderingLineAfter,K.renderWhitespace,K.renderControlCharacters,K.fontLigatures!==EditorFontLigatures.OFF,null),q);return q.appendString("</div>"),X.characterMapping.getHorizontalOffset(X.characterMapping.length)}var __decorate$b=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$b=function(F,w){return function(D,O){w(D,O,F)}};let DiffEditorViewZones=class extends Disposable{constructor(w,D,O,W,U,K,q,G,Q,Y){super(),this._targetWindow=w,this._editors=D,this._diffModel=O,this._options=W,this._diffEditorWidget=U,this._canIgnoreViewZoneUpdateEvent=K,this._origViewZonesToIgnore=q,this._modViewZonesToIgnore=G,this._clipboardService=Q,this._contextMenuService=Y,this._originalTopPadding=observableValue(this,0),this._originalScrollOffset=observableValue(this,0),this._originalScrollOffsetAnimated=animatedObservable(this._targetWindow,this._originalScrollOffset,this._store),this._modifiedTopPadding=observableValue(this,0),this._modifiedScrollOffset=observableValue(this,0),this._modifiedScrollOffsetAnimated=animatedObservable(this._targetWindow,this._modifiedScrollOffset,this._store);const X=observableValue("invalidateAlignmentsState",0),J=this._register(new RunOnceScheduler(()=>{X.set(X.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(de=>{this._canIgnoreViewZoneUpdateEvent()||J.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(de=>{this._canIgnoreViewZoneUpdateEvent()||J.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(de=>{(de.hasChanged(147)||de.hasChanged(67))&&J.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(de=>{(de.hasChanged(147)||de.hasChanged(67))&&J.schedule()}));const te=this._diffModel.map(de=>de?observableFromEvent(this,de.model.original.onDidChangeTokens,()=>de.model.original.tokenization.backgroundTokenizationState===2):void 0).map((de,oe)=>de?.read(oe)),ie=derived(de=>{const oe=this._diffModel.read(de),ue=oe?.diff.read(de);if(!oe||!ue)return null;X.read(de);const fe=this._options.renderSideBySide.read(de);return computeRangeAlignment(this._editors.original,this._editors.modified,ue.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,fe)}),se=derived(de=>{const oe=this._diffModel.read(de)?.movedTextToCompare.read(de);if(!oe)return null;X.read(de);const ue=oe.changes.map(pe=>new DiffMapping(pe));return computeRangeAlignment(this._editors.original,this._editors.modified,ue,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function re(){const de=document.createElement("div");return de.className="diagonal-fill",de}const ae=this._register(new DisposableStore);this.viewZones=derivedWithStore(this,(de,oe)=>{ae.clear();const ue=ie.read(de)||[],pe=[],fe=[],Ce=this._modifiedTopPadding.read(de);Ce>0&&fe.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:Ce,showInHiddenAreas:!0,suppressMouseDown:!0});const we=this._originalTopPadding.read(de);we>0&&pe.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:we,showInHiddenAreas:!0,suppressMouseDown:!0});const Oe=this._options.renderSideBySide.read(de),Te=Oe?void 0:this._editors.modified._getViewModel()?.createLineBreaksComputer();if(Te){const st=this._editors.original.getModel();for(const lt of ue)if(lt.diff)for(let Tt=lt.originalRange.startLineNumber;Tt<lt.originalRange.endLineNumberExclusive;Tt++){if(Tt>st.getLineCount())return{orig:pe,mod:fe};Te?.addRequest(st.getLineContent(Tt),null,null)}}const Re=Te?.finalize()??[];let Me=0;const Ne=this._editors.modified.getOption(67),ze=this._diffModel.read(de)?.movedTextToCompare.read(de),Qe=this._editors.original.getModel()?.mightContainNonBasicASCII()??!1,Ye=this._editors.original.getModel()?.mightContainRTL()??!1,Je=RenderOptions.fromEditor(this._editors.modified);for(const st of ue)if(st.diff&&!Oe&&(!this._options.useTrueInlineDiffRendering.read(de)||!allowsTrueInlineDiffRendering(st.diff))){if(!st.originalRange.isEmpty){te.read(de);const Tt=document.createElement("div");Tt.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");const Ke=this._editors.original.getModel();if(st.originalRange.endLineNumberExclusive-1>Ke.getLineCount())return{orig:pe,mod:fe};const je=new LineSource(st.originalRange.mapToLineArray(Ct=>Ke.tokenization.getLineTokens(Ct)),st.originalRange.mapToLineArray(Ct=>Re[Me++]),Qe,Ye),et=[];for(const Ct of st.diff.innerChanges||[])et.push(new InlineDecoration(Ct.originalRange.delta(-(st.diff.original.startLineNumber-1)),diffDeleteDecoration.className,0));const mt=renderLines(je,Je,et,Tt),Mt=document.createElement("div");if(Mt.className="inline-deleted-margin-view-zone",applyFontInfo(Mt,Je.fontInfo),this._options.renderIndicators.read(de))for(let Ct=0;Ct<mt.heightInLines;Ct++){const Nt=document.createElement("div");Nt.className=`delete-sign ${ThemeIcon.asClassName(diffRemoveIcon)}`,Nt.setAttribute("style",`position:absolute;top:${Ct*Ne}px;width:${Je.lineDecorationsWidth}px;height:${Ne}px;right:0;`),Mt.appendChild(Nt)}let Et;ae.add(new InlineDiffDeletedCodeMargin(()=>assertIsDefined(Et),Mt,this._editors.modified,st.diff,this._diffEditorWidget,mt.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let Ct=0;Ct<mt.viewLineCounts.length;Ct++){const Nt=mt.viewLineCounts[Ct];Nt>1&&pe.push({afterLineNumber:st.originalRange.startLineNumber+Ct,domNode:re(),heightInPx:(Nt-1)*Ne,showInHiddenAreas:!0,suppressMouseDown:!0})}fe.push({afterLineNumber:st.modifiedRange.startLineNumber-1,domNode:Tt,heightInPx:mt.heightInLines*Ne,minWidthInPx:mt.minWidthInPx,marginDomNode:Mt,setZoneId(Ct){Et=Ct},showInHiddenAreas:!0,suppressMouseDown:!0})}const lt=document.createElement("div");lt.className="gutter-delete",pe.push({afterLineNumber:st.originalRange.endLineNumberExclusive-1,domNode:re(),heightInPx:st.modifiedHeightInPx,marginDomNode:lt,showInHiddenAreas:!0,suppressMouseDown:!0})}else{const lt=st.modifiedHeightInPx-st.originalHeightInPx;if(lt>0){if(ze?.lineRangeMapping.original.delta(-1).deltaLength(2).contains(st.originalRange.endLineNumberExclusive-1))continue;pe.push({afterLineNumber:st.originalRange.endLineNumberExclusive-1,domNode:re(),heightInPx:lt,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let Tt=function(){const je=document.createElement("div");return je.className="arrow-revert-change "+ThemeIcon.asClassName(Codicon.arrowRight),oe.add(addDisposableListener(je,"mousedown",et=>et.stopPropagation())),oe.add(addDisposableListener(je,"click",et=>{et.stopPropagation(),U.revert(st.diff)})),$$8("div",{},je)};var at=Tt;if(ze?.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(st.modifiedRange.endLineNumberExclusive-1))continue;let Ke;st.diff&&st.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(de)&&(Ke=Tt()),fe.push({afterLineNumber:st.modifiedRange.endLineNumberExclusive-1,domNode:re(),heightInPx:-lt,marginDomNode:Ke,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(const st of se.read(de)??[]){if(!ze?.lineRangeMapping.original.intersect(st.originalRange)||!ze?.lineRangeMapping.modified.intersect(st.modifiedRange))continue;const lt=st.modifiedHeightInPx-st.originalHeightInPx;lt>0?pe.push({afterLineNumber:st.originalRange.endLineNumberExclusive-1,domNode:re(),heightInPx:lt,showInHiddenAreas:!0,suppressMouseDown:!0}):fe.push({afterLineNumber:st.modifiedRange.endLineNumberExclusive-1,domNode:re(),heightInPx:-lt,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:pe,mod:fe}});let le=!1;this._register(this._editors.original.onDidScrollChange(de=>{de.scrollLeftChanged&&!le&&(le=!0,this._editors.modified.setScrollLeft(de.scrollLeft),le=!1)})),this._register(this._editors.modified.onDidScrollChange(de=>{de.scrollLeftChanged&&!le&&(le=!0,this._editors.original.setScrollLeft(de.scrollLeft),le=!1)})),this._originalScrollTop=observableFromEvent(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=observableFromEvent(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(autorun(de=>{const oe=this._originalScrollTop.read(de)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(de))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(de));oe!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(oe,1)})),this._register(autorun(de=>{const oe=this._modifiedScrollTop.read(de)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(de))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(de));oe!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(oe,1)})),this._register(autorun(de=>{const oe=this._diffModel.read(de)?.movedTextToCompare.read(de);let ue=0;if(oe){const pe=this._editors.original.getTopForLineNumber(oe.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();ue=this._editors.modified.getTopForLineNumber(oe.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-pe}ue>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(ue,void 0)):ue<0?(this._modifiedTopPadding.set(-ue,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-ue,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+ue,void 0,!0)}))}};DiffEditorViewZones=__decorate$b([__param$b(8,IClipboardService),__param$b(9,IContextMenuService)],DiffEditorViewZones);function computeRangeAlignment(F,w,D,O,W,U){const K=new ArrayQueue(getAdditionalLineHeights(F,O)),q=new ArrayQueue(getAdditionalLineHeights(w,W)),G=F.getOption(67),Q=w.getOption(67),Y=[];let X=0,J=0;function te(se,re){for(;;){let ae=K.peek(),le=q.peek();if(ae&&ae.lineNumber>=se&&(ae=void 0),le&&le.lineNumber>=re&&(le=void 0),!ae&&!le)break;const de=ae?ae.lineNumber-X:Number.MAX_VALUE,oe=le?le.lineNumber-J:Number.MAX_VALUE;de<oe?(K.dequeue(),le={lineNumber:ae.lineNumber-X+J,heightInPx:0}):de>oe?(q.dequeue(),ae={lineNumber:le.lineNumber-J+X,heightInPx:0}):(K.dequeue(),q.dequeue()),Y.push({originalRange:LineRange$1.ofLength(ae.lineNumber,1),modifiedRange:LineRange$1.ofLength(le.lineNumber,1),originalHeightInPx:G+ae.heightInPx,modifiedHeightInPx:Q+le.heightInPx,diff:void 0})}}for(const se of D){let oe=function(ue,pe,fe=!1){if(ue<de||pe<le)return;if(ae)ae=!1;else if(!fe&&(ue===de||pe===le))return;const Ce=new LineRange$1(de,ue),we=new LineRange$1(le,pe);if(Ce.isEmpty&&we.isEmpty)return;const Oe=K.takeWhile(Re=>Re.lineNumber<ue)?.reduce((Re,Me)=>Re+Me.heightInPx,0)??0,Te=q.takeWhile(Re=>Re.lineNumber<pe)?.reduce((Re,Me)=>Re+Me.heightInPx,0)??0;Y.push({originalRange:Ce,modifiedRange:we,originalHeightInPx:Ce.length*G+Oe,modifiedHeightInPx:we.length*Q+Te,diff:se.lineRangeMapping}),de=ue,le=pe};var ie=oe;const re=se.lineRangeMapping;te(re.original.startLineNumber,re.modified.startLineNumber);let ae=!0,le=re.modified.startLineNumber,de=re.original.startLineNumber;if(U)for(const ue of re.innerChanges||[]){ue.originalRange.startColumn>1&&ue.modifiedRange.startColumn>1&&oe(ue.originalRange.startLineNumber,ue.modifiedRange.startLineNumber);const pe=F.getModel(),fe=ue.originalRange.endLineNumber<=pe.getLineCount()?pe.getLineMaxColumn(ue.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;ue.originalRange.endColumn<fe&&oe(ue.originalRange.endLineNumber,ue.modifiedRange.endLineNumber)}oe(re.original.endLineNumberExclusive,re.modified.endLineNumberExclusive,!0),X=re.original.endLineNumberExclusive,J=re.modified.endLineNumberExclusive}return te(Number.MAX_VALUE,Number.MAX_VALUE),Y}function getAdditionalLineHeights(F,w){const D=[],O=[],W=F.getOption(147).wrappingColumn!==-1,U=F._getViewModel().coordinatesConverter,K=F.getOption(67);if(W)for(let G=1;G<=F.getModel().getLineCount();G++){const Q=U.getModelLineViewLineCount(G);Q>1&&O.push({lineNumber:G,heightInPx:K*(Q-1)})}for(const G of F.getWhitespaces()){if(w.has(G.id))continue;const Q=G.afterLineNumber===0?0:U.convertViewPositionToModelPosition(new Position$1(G.afterLineNumber,1)).lineNumber;D.push({lineNumber:Q,heightInPx:G.height})}return joinCombine(D,O,G=>G.lineNumber,(G,Q)=>({lineNumber:G.lineNumber,heightInPx:G.heightInPx+Q.heightInPx}))}function allowsTrueInlineDiffRendering(F){return F.innerChanges?F.innerChanges.every(w=>rangeIsSingleLine(w.modifiedRange)&&rangeIsSingleLine(w.originalRange)||w.originalRange.equalsRange(new Range$2(1,1,1,1))):!1}function rangeIsSingleLine(F){return F.startLineNumber===F.endLineNumber}class MovedBlocksLinesFeature extends Disposable{static{this.movedCodeBlockPadding=4}constructor(w,D,O,W,U){super(),this._rootElement=w,this._diffModel=D,this._originalEditorLayoutInfo=O,this._modifiedEditorLayoutInfo=W,this._editors=U,this._originalScrollTop=observableFromEvent(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=observableFromEvent(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._viewZonesChanged=observableSignalFromEvent("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this.width=observableValue(this,0),this._modifiedViewZonesChangedSignal=observableSignalFromEvent("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this._originalViewZonesChangedSignal=observableSignalFromEvent("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones),this._state=derivedWithStore(this,(Y,X)=>{this._element.replaceChildren();const J=this._diffModel.read(Y),te=J?.diff.read(Y)?.movedTexts;if(!te||te.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(Y);const ie=this._originalEditorLayoutInfo.read(Y),se=this._modifiedEditorLayoutInfo.read(Y);if(!ie||!se){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(Y),this._originalViewZonesChangedSignal.read(Y);const re=te.map(fe=>{function Ce(Ye,Je){const at=Je.getTopForLineNumber(Ye.startLineNumber,!0),st=Je.getTopForLineNumber(Ye.endLineNumberExclusive,!0);return(at+st)/2}const we=Ce(fe.lineRangeMapping.original,this._editors.original),Oe=this._originalScrollTop.read(Y),Te=Ce(fe.lineRangeMapping.modified,this._editors.modified),Re=this._modifiedScrollTop.read(Y),Me=we-Oe,Ne=Te-Re,ze=Math.min(we,Te),Qe=Math.max(we,Te);return{range:new OffsetRange(ze,Qe),from:Me,to:Ne,fromWithoutScroll:we,toWithoutScroll:Te,move:fe}});re.sort(tieBreakComparators(compareBy(fe=>fe.fromWithoutScroll>fe.toWithoutScroll,booleanComparator),compareBy(fe=>fe.fromWithoutScroll>fe.toWithoutScroll?fe.fromWithoutScroll:-fe.toWithoutScroll,numberComparator)));const ae=LinesLayout.compute(re.map(fe=>fe.range)),le=10,de=ie.verticalScrollbarWidth,oe=(ae.getTrackCount()-1)*10+le*2,ue=de+oe+(se.contentLeft-MovedBlocksLinesFeature.movedCodeBlockPadding);let pe=0;for(const fe of re){const Ce=ae.getTrack(pe),we=de+le+Ce*10,Oe=15,Te=15,Re=ue,Me=se.glyphMarginWidth+se.lineNumbersWidth,Ne=18,ze=document.createElementNS("http://www.w3.org/2000/svg","rect");ze.classList.add("arrow-rectangle"),ze.setAttribute("x",`${Re-Me}`),ze.setAttribute("y",`${fe.to-Ne/2}`),ze.setAttribute("width",`${Me}`),ze.setAttribute("height",`${Ne}`),this._element.appendChild(ze);const Qe=document.createElementNS("http://www.w3.org/2000/svg","g"),Ye=document.createElementNS("http://www.w3.org/2000/svg","path");Ye.setAttribute("d",`M 0 ${fe.from} L ${we} ${fe.from} L ${we} ${fe.to} L ${Re-Te} ${fe.to}`),Ye.setAttribute("fill","none"),Qe.appendChild(Ye);const Je=document.createElementNS("http://www.w3.org/2000/svg","polygon");Je.classList.add("arrow"),X.add(autorun(at=>{Ye.classList.toggle("currentMove",fe.move===J.activeMovedText.read(at)),Je.classList.toggle("currentMove",fe.move===J.activeMovedText.read(at))})),Je.setAttribute("points",`${Re-Te},${fe.to-Oe/2} ${Re},${fe.to} ${Re-Te},${fe.to+Oe/2}`),Qe.appendChild(Je),this._element.appendChild(Qe),pe++}this.width.set(oe,void 0)}),this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(toDisposable(()=>this._element.remove())),this._register(autorun(Y=>{const X=this._originalEditorLayoutInfo.read(Y),J=this._modifiedEditorLayoutInfo.read(Y);!X||!J||(this._element.style.left=`${X.width-X.verticalScrollbarWidth}px`,this._element.style.height=`${X.height}px`,this._element.style.width=`${X.verticalScrollbarWidth+X.contentLeft-MovedBlocksLinesFeature.movedCodeBlockPadding+this.width.read(Y)}px`)})),this._register(recomputeInitiallyAndOnChange(this._state));const K=derived(Y=>{const J=this._diffModel.read(Y)?.diff.read(Y);return J?J.movedTexts.map(te=>({move:te,original:new PlaceholderViewZone(constObservable(te.lineRangeMapping.original.startLineNumber-1),18),modified:new PlaceholderViewZone(constObservable(te.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(applyViewZones(this._editors.original,K.map(Y=>Y.map(X=>X.original)))),this._register(applyViewZones(this._editors.modified,K.map(Y=>Y.map(X=>X.modified)))),this._register(autorunWithStore((Y,X)=>{const J=K.read(Y);for(const te of J)X.add(new MovedBlockOverlayWidget(this._editors.original,te.original,te.move,"original",this._diffModel.get())),X.add(new MovedBlockOverlayWidget(this._editors.modified,te.modified,te.move,"modified",this._diffModel.get()))}));const q=observableSignalFromEvent("original.onDidFocusEditorWidget",Y=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>Y(void 0),0))),G=observableSignalFromEvent("modified.onDidFocusEditorWidget",Y=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>Y(void 0),0)));let Q="modified";this._register(autorunHandleChanges({createEmptyChangeSummary:()=>{},handleChange:(Y,X)=>(Y.didChange(q)&&(Q="original"),Y.didChange(G)&&(Q="modified"),!0)},Y=>{q.read(Y),G.read(Y);const X=this._diffModel.read(Y);if(!X)return;const J=X.diff.read(Y);let te;if(J&&Q==="original"){const ie=this._editors.originalCursor.read(Y);ie&&(te=J.movedTexts.find(se=>se.lineRangeMapping.original.contains(ie.lineNumber)))}if(J&&Q==="modified"){const ie=this._editors.modifiedCursor.read(Y);ie&&(te=J.movedTexts.find(se=>se.lineRangeMapping.modified.contains(ie.lineNumber)))}te!==X.movedTextToCompare.get()&&X.movedTextToCompare.set(void 0,void 0),X.setActiveMovedText(te)}))}}class LinesLayout{static compute(w){const D=[],O=[];for(const W of w){let U=D.findIndex(K=>!K.intersectsStrict(W));U===-1&&(D.length>=6?U=findMaxIdx(D,compareBy(q=>q.intersectWithRangeLength(W),numberComparator)):(U=D.length,D.push(new OffsetRangeSet))),D[U].addRange(W),O.push(U)}return new LinesLayout(D.length,O)}constructor(w,D){this._trackCount=w,this.trackPerLineIdx=D}getTrack(w){return this.trackPerLineIdx[w]}getTrackCount(){return this._trackCount}}class MovedBlockOverlayWidget extends ViewZoneOverlayWidget{constructor(w,D,O,W,U){const K=h$1("div.diff-hidden-lines-widget");super(w,D,K.root),this._editor=w,this._move=O,this._kind=W,this._diffModel=U,this._nodes=h$1("div.diff-moved-code-block",{style:{marginRight:"4px"}},[h$1("div.text-content@textContent"),h$1("div.action-bar@actionBar")]),K.root.appendChild(this._nodes.root);const q=observableFromEvent(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(applyStyle(this._nodes.root,{paddingRight:q.map(J=>J.verticalScrollbarWidth)}));let G;O.changes.length>0?G=this._kind==="original"?localize("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):localize("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):G=this._kind==="original"?localize("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):localize("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);const Q=this._register(new ActionBar(this._nodes.actionBar,{highlightToggledItems:!0})),Y=new Action("",G,"",!1);Q.push(Y,{icon:!1,label:!0});const X=new Action("","Compare",ThemeIcon.asClassName(Codicon.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===O?void 0:this._move,void 0)});this._register(autorun(J=>{const te=this._diffModel.movedTextToCompare.read(J)===O;X.checked=te})),Q.push(X,{icon:!1,label:!0})}}class DiffEditorDecorations extends Disposable{constructor(w,D,O,W){super(),this._editors=w,this._diffModel=D,this._options=O,this._decorations=derived(this,U=>{const K=this._diffModel.read(U),q=K?.diff.read(U);if(!q)return null;const G=this._diffModel.read(U).movedTextToCompare.read(U),Q=this._options.renderIndicators.read(U),Y=this._options.showEmptyDecorations.read(U),X=[],J=[];if(!G)for(const ie of q.mappings)if(ie.lineRangeMapping.original.isEmpty||X.push({range:ie.lineRangeMapping.original.toInclusiveRange(),options:Q?diffLineDeleteDecorationBackgroundWithIndicator:diffLineDeleteDecorationBackground}),ie.lineRangeMapping.modified.isEmpty||J.push({range:ie.lineRangeMapping.modified.toInclusiveRange(),options:Q?diffLineAddDecorationBackgroundWithIndicator:diffLineAddDecorationBackground}),ie.lineRangeMapping.modified.isEmpty||ie.lineRangeMapping.original.isEmpty)ie.lineRangeMapping.original.isEmpty||X.push({range:ie.lineRangeMapping.original.toInclusiveRange(),options:diffWholeLineDeleteDecoration}),ie.lineRangeMapping.modified.isEmpty||J.push({range:ie.lineRangeMapping.modified.toInclusiveRange(),options:diffWholeLineAddDecoration});else{const se=this._options.useTrueInlineDiffRendering.read(U)&&allowsTrueInlineDiffRendering(ie.lineRangeMapping);for(const re of ie.lineRangeMapping.innerChanges||[])if(ie.lineRangeMapping.original.contains(re.originalRange.startLineNumber)&&X.push({range:re.originalRange,options:re.originalRange.isEmpty()&&Y?diffDeleteDecorationEmpty:diffDeleteDecoration}),ie.lineRangeMapping.modified.contains(re.modifiedRange.startLineNumber)&&J.push({range:re.modifiedRange,options:re.modifiedRange.isEmpty()&&Y&&!se?diffAddDecorationEmpty:diffAddDecoration}),se){const ae=K.model.original.getValueInRange(re.originalRange);J.push({range:re.modifiedRange,options:{description:"deleted-text",before:{content:ae,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(G)for(const ie of G.changes){const se=ie.original.toInclusiveRange();se&&X.push({range:se,options:Q?diffLineDeleteDecorationBackgroundWithIndicator:diffLineDeleteDecorationBackground});const re=ie.modified.toInclusiveRange();re&&J.push({range:re,options:Q?diffLineAddDecorationBackgroundWithIndicator:diffLineAddDecorationBackground});for(const ae of ie.innerChanges||[])X.push({range:ae.originalRange,options:diffDeleteDecoration}),J.push({range:ae.modifiedRange,options:diffAddDecoration})}const te=this._diffModel.read(U).activeMovedText.read(U);for(const ie of q.movedTexts)X.push({range:ie.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(ie===te?" currentMove":""),blockPadding:[MovedBlocksLinesFeature.movedCodeBlockPadding,0,MovedBlocksLinesFeature.movedCodeBlockPadding,MovedBlocksLinesFeature.movedCodeBlockPadding]}}),J.push({range:ie.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(ie===te?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:X,modifiedDecorations:J}}),this._register(applyObservableDecorations(this._editors.original,this._decorations.map(U=>U?.originalDecorations||[]))),this._register(applyObservableDecorations(this._editors.modified,this._decorations.map(U=>U?.modifiedDecorations||[])))}}class SashLayout{resetSash(){this._sashRatio.set(void 0,void 0)}constructor(w,D){this._options=w,this.dimensions=D,this.sashLeft=derivedWithSetter(this,O=>{const W=this._sashRatio.read(O)??this._options.splitViewDefaultRatio.read(O);return this._computeSashLeft(W,O)},(O,W)=>{const U=this.dimensions.width.get();this._sashRatio.set(O/U,W)}),this._sashRatio=observableValue(this,void 0)}_computeSashLeft(w,D){const O=this.dimensions.width.read(D),W=Math.floor(this._options.splitViewDefaultRatio.read(D)*O),U=this._options.enableSplitViewResizing.read(D)?Math.floor(w*O):W,K=100;return O<=K*2?W:U<K?K:U>O-K?O-K:U}}class DiffEditorSash extends Disposable{constructor(w,D,O,W,U,K){super(),this._domNode=w,this._dimensions=D,this._enabled=O,this._boundarySashes=W,this.sashLeft=U,this._resetSash=K,this._sash=this._register(new Sash(this._domNode,{getVerticalSashTop:q=>0,getVerticalSashLeft:q=>this.sashLeft.get(),getVerticalSashHeight:q=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(q=>{this.sashLeft.set(this._startSashPosition+(q.currentX-q.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register(autorun(q=>{const G=this._boundarySashes.read(q);G&&(this._sash.orthogonalEndSash=G.bottom)})),this._register(autorun(q=>{const G=this._enabled.read(q);this._sash.state=G?3:0,this.sashLeft.read(q),this._dimensions.height.read(q),this._sash.layout()}))}}class EditorGutter extends Disposable{constructor(w,D,O){super(),this._editor=w,this._domNode=D,this.itemProvider=O,this.scrollTop=observableFromEvent(this,this._editor.onDidScrollChange,K=>this._editor.getScrollTop()),this.isScrollTopZero=this.scrollTop.map(K=>K===0),this.modelAttached=observableFromEvent(this,this._editor.onDidChangeModel,K=>this._editor.hasModel()),this.editorOnDidChangeViewZones=observableSignalFromEvent("onDidChangeViewZones",this._editor.onDidChangeViewZones),this.editorOnDidContentSizeChange=observableSignalFromEvent("onDidContentSizeChange",this._editor.onDidContentSizeChange),this.domNodeSizeChanged=observableSignal("domNodeSizeChanged"),this.views=new Map,this._domNode.className="gutter monaco-editor";const W=this._domNode.appendChild(h$1("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),U=new ResizeObserver(()=>{transaction(K=>{this.domNodeSizeChanged.trigger(K)})});U.observe(this._domNode),this._register(toDisposable(()=>U.disconnect())),this._register(autorun(K=>{W.className=this.isScrollTopZero.read(K)?"":"scroll-decoration"})),this._register(autorun(K=>this.render(K)))}dispose(){super.dispose(),reset(this._domNode)}render(w){if(!this.modelAttached.read(w))return;this.domNodeSizeChanged.read(w),this.editorOnDidChangeViewZones.read(w),this.editorOnDidContentSizeChange.read(w);const D=this.scrollTop.read(w),O=this._editor.getVisibleRanges(),W=new Set(this.views.keys()),U=OffsetRange.ofStartAndLength(0,this._domNode.clientHeight);if(!U.isEmpty)for(const K of O){const q=new LineRange$1(K.startLineNumber,K.endLineNumber+1),G=this.itemProvider.getIntersectingGutterItems(q,w);transaction(Q=>{for(const Y of G){if(!Y.range.intersect(q))continue;W.delete(Y.id);let X=this.views.get(Y.id);if(X)X.item.set(Y,Q);else{const se=document.createElement("div");this._domNode.appendChild(se);const re=observableValue("item",Y),ae=this.itemProvider.createView(re,se);X=new ManagedGutterItemView(re,ae,se),this.views.set(Y.id,X)}const J=Y.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(Y.range.startLineNumber,!0)-D:this._editor.getBottomForLineNumber(Y.range.startLineNumber-1,!1)-D,ie=(Y.range.endLineNumberExclusive===1?Math.max(J,this._editor.getTopForLineNumber(Y.range.startLineNumber,!1)-D):Math.max(J,this._editor.getBottomForLineNumber(Y.range.endLineNumberExclusive-1,!0)-D))-J;X.domNode.style.top=`${J}px`,X.domNode.style.height=`${ie}px`,X.gutterItemView.layout(OffsetRange.ofStartAndLength(J,ie),U)}})}for(const K of W){const q=this.views.get(K);q.gutterItemView.dispose(),q.domNode.remove(),this.views.delete(K)}}}class ManagedGutterItemView{constructor(w,D,O){this.item=w,this.gutterItemView=D,this.domNode=O}}class ActionRunnerWithContext extends ActionRunner{constructor(w){super(),this._getContext=w}runAction(w,D){const O=this._getContext();return super.runAction(w,O)}}class TextModelText extends AbstractText{constructor(w){super(),this._textModel=w}getValueOfRange(w){return this._textModel.getValueInRange(w)}get length(){const w=this._textModel.getLineCount(),D=this._textModel.getLineLength(w);return new TextLength(w-1,D)}}class ToolBar extends Disposable{constructor(w,D,O={orientation:0}){super(),this.submenuActionViewItems=[],this.hasSecondaryActions=!1,this._onDidChangeDropdownVisibility=this._register(new EventMultiplexer),this.onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event,this.disposables=this._register(new DisposableStore),O.hoverDelegate=O.hoverDelegate??this._register(createInstantHoverDelegate()),this.options=O,this.toggleMenuAction=this._register(new ToggleMenuAction(()=>this.toggleMenuActionViewItem?.show(),O.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",w.appendChild(this.element),this.actionBar=this._register(new ActionBar(this.element,{orientation:O.orientation,ariaLabel:O.ariaLabel,actionRunner:O.actionRunner,allowContextMenu:O.allowContextMenu,highlightToggledItems:O.highlightToggledItems,hoverDelegate:O.hoverDelegate,actionViewItemProvider:(W,U)=>{if(W.id===ToggleMenuAction.ID)return this.toggleMenuActionViewItem=new DropdownMenuActionViewItem(W,W.menuActions,D,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:ThemeIcon.asClassNameArray(O.moreIcon??Codicon.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(O.actionViewItemProvider){const K=O.actionViewItemProvider(W,U);if(K)return K}if(W instanceof SubmenuAction){const K=new DropdownMenuActionViewItem(W,W.actions,D,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:W.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return K.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(K),this.disposables.add(this._onDidChangeDropdownVisibility.add(K.onDidChangeVisibility)),K}}}))}set actionRunner(w){this.actionBar.actionRunner=w}get actionRunner(){return this.actionBar.actionRunner}getElement(){return this.element}getItemAction(w){return this.actionBar.getAction(w)}setActions(w,D){this.clear();const O=w?w.slice(0):[];this.hasSecondaryActions=!!(D&&D.length>0),this.hasSecondaryActions&&D&&(this.toggleMenuAction.menuActions=D.slice(0),O.push(this.toggleMenuAction)),O.forEach(W=>{this.actionBar.push(W,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(W)})})}getKeybindingLabel(w){return this.options.getKeyBinding?.(w)?.getLabel()??void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}}class ToggleMenuAction extends Action{static{this.ID="toolbar.toggle.more"}constructor(w,D){D=D||localize("moreActions","More Actions..."),super(ToggleMenuAction.ID,D,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=w}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(w){this._menuActions=w}}var __decorate$a=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$a=function(F,w){return function(D,O){w(D,O,F)}};let WorkbenchToolBar=class extends ToolBar{constructor(w,D,O,W,U,K,q,G){super(w,U,{getKeyBinding:Y=>K.lookupKeybinding(Y.id)??void 0,...D,allowContextMenu:!0,skipTelemetry:typeof D?.telemetrySource=="string"}),this._options=D,this._menuService=O,this._contextKeyService=W,this._contextMenuService=U,this._keybindingService=K,this._commandService=q,this._sessionDisposables=this._store.add(new DisposableStore);const Q=D?.telemetrySource;Q&&this._store.add(this.actionBar.onDidRun(Y=>G.publicLog2("workbenchActionExecuted",{id:Y.action.id,from:Q})))}setActions(w,D=[],O){this._sessionDisposables.clear();const W=w.slice(),U=D.slice(),K=[];let q=0;const G=[];let Q=!1;if(this._options?.hiddenItemStrategy!==-1)for(let Y=0;Y<W.length;Y++){const X=W[Y];!(X instanceof MenuItemAction)&&!(X instanceof SubmenuItemAction)||X.hideActions&&(K.push(X.hideActions.toggle),X.hideActions.toggle.checked&&q++,X.hideActions.isHidden&&(Q=!0,W[Y]=void 0,this._options?.hiddenItemStrategy!==0&&(G[Y]=X)))}if(this._options?.overflowBehavior!==void 0){const Y=intersection(new Set(this._options.overflowBehavior.exempted),Iterable.map(W,te=>te?.id)),X=this._options.overflowBehavior.maxItems-Y.size;let J=0;for(let te=0;te<W.length;te++){const ie=W[te];ie&&(J++,!Y.has(ie.id)&&J>=X&&(W[te]=void 0,G[te]=ie))}}coalesceInPlace(W),coalesceInPlace(G),super.setActions(W,Separator.join(G,U)),(K.length>0||W.length>0)&&this._sessionDisposables.add(addDisposableListener(this.getElement(),"contextmenu",Y=>{const X=new StandardMouseEvent(getWindow(this.getElement()),Y),J=this.getItemAction(X.target);if(!J)return;X.preventDefault(),X.stopPropagation();const te=[];if(J instanceof MenuItemAction&&J.menuKeybinding)te.push(J.menuKeybinding);else if(!(J instanceof SubmenuItemAction||J instanceof ToggleMenuAction)){const se=!!this._keybindingService.lookupKeybinding(J.id);te.push(createConfigureKeybindingAction(this._commandService,this._keybindingService,J.id,void 0,se))}if(K.length>0){let se=!1;if(q===1&&this._options?.hiddenItemStrategy===0){se=!0;for(let re=0;re<K.length;re++)if(K[re].checked){K[re]=toAction({id:J.id,label:J.label,checked:!0,enabled:!1,run(){}});break}}if(!se&&(J instanceof MenuItemAction||J instanceof SubmenuItemAction)){if(!J.hideActions)return;te.push(J.hideActions.hide)}else te.push(toAction({id:"label",label:localize("hide","Hide"),enabled:!1,run(){}}))}const ie=Separator.join(te,K);this._options?.resetMenu&&!O&&(O=[this._options.resetMenu]),Q&&O&&(ie.push(new Separator),ie.push(toAction({id:"resetThisMenu",label:localize("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(O)}))),ie.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>X,getActions:()=>ie,menuId:this._options?.contextMenu,menuActionOptions:{renderShortTitle:!0,...this._options?.menuOptions},skipTelemetry:typeof this._options?.telemetrySource=="string",contextKeyService:this._contextKeyService})}))}};WorkbenchToolBar=__decorate$a([__param$a(2,IMenuService),__param$a(3,IContextKeyService),__param$a(4,IContextMenuService),__param$a(5,IKeybindingService),__param$a(6,ICommandService),__param$a(7,ITelemetryService)],WorkbenchToolBar);let MenuWorkbenchToolBar=class extends WorkbenchToolBar{constructor(w,D,O,W,U,K,q,G,Q){super(w,{resetMenu:D,...O},W,U,K,q,G,Q),this._onDidChangeMenuItems=this._store.add(new Emitter$1),this.onDidChangeMenuItems=this._onDidChangeMenuItems.event;const Y=this._store.add(W.createMenu(D,U,{emitEventsForSubmenuChanges:!0})),X=()=>{const J=[],te=[];createAndFillInActionBarActions(Y,O?.menuOptions,{primary:J,secondary:te},O?.toolbarOptions?.primaryGroup,O?.toolbarOptions?.shouldInlineSubmenu,O?.toolbarOptions?.useSeparatorsInPrimaryActions),w.classList.toggle("has-no-actions",J.length===0&&te.length===0),super.setActions(J,te)};this._store.add(Y.onDidChange(()=>{X(),this._onDidChangeMenuItems.fire(this)})),X()}setActions(){throw new BugIndicatingError("This toolbar is populated from a menu.")}};MenuWorkbenchToolBar=__decorate$a([__param$a(3,IMenuService),__param$a(4,IContextKeyService),__param$a(5,IContextMenuService),__param$a(6,IKeybindingService),__param$a(7,ICommandService),__param$a(8,ITelemetryService)],MenuWorkbenchToolBar);var __decorate$9=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$9=function(F,w){return function(D,O){w(D,O,F)}};const emptyArr$1=[],width=35;let DiffEditorGutter=class extends Disposable{constructor(w,D,O,W,U,K,q,G,Q){super(),this._diffModel=D,this._editors=O,this._options=W,this._sashLayout=U,this._boundarySashes=K,this._instantiationService=q,this._contextKeyService=G,this._menuService=Q,this._menu=this._register(this._menuService.createMenu(MenuId.DiffEditorHunkToolbar,this._contextKeyService)),this._actions=observableFromEvent(this,this._menu.onDidChange,()=>this._menu.getActions()),this._hasActions=this._actions.map(Y=>Y.length>0),this._showSash=derived(this,Y=>this._options.renderSideBySide.read(Y)&&this._hasActions.read(Y)),this.width=derived(this,Y=>this._hasActions.read(Y)?width:0),this.elements=h$1("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:width+"px"}},[]),this._currentDiff=derived(this,Y=>{const X=this._diffModel.read(Y);if(!X)return;const J=X.diff.read(Y)?.mappings,te=this._editors.modifiedCursor.read(Y);if(te)return J?.find(ie=>ie.lineRangeMapping.modified.contains(te.lineNumber))}),this._selectedDiffs=derived(this,Y=>{const J=this._diffModel.read(Y)?.diff.read(Y);if(!J)return emptyArr$1;const te=this._editors.modifiedSelections.read(Y);if(te.every(ae=>ae.isEmpty()))return emptyArr$1;const ie=new LineRangeSet(te.map(ae=>LineRange$1.fromRangeInclusive(ae))),re=J.mappings.filter(ae=>ae.lineRangeMapping.innerChanges&&ie.intersects(ae.lineRangeMapping.modified)).map(ae=>({mapping:ae,rangeMappings:ae.lineRangeMapping.innerChanges.filter(le=>te.some(de=>Range$2.areIntersecting(le.modifiedRange,de)))}));return re.length===0||re.every(ae=>ae.rangeMappings.length===0)?emptyArr$1:re}),this._register(prependRemoveOnDispose(w,this.elements.root)),this._register(addDisposableListener(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(applyStyle(this.elements.root,{display:this._hasActions.map(Y=>Y?"block":"none")})),derivedDisposable(this,Y=>this._showSash.read(Y)?new DiffEditorSash(w,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,derivedWithSetter(this,J=>this._sashLayout.sashLeft.read(J)-width,(J,te)=>this._sashLayout.sashLeft.set(J+width,te)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store),this._register(new EditorGutter(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(Y,X)=>{const J=this._diffModel.read(X);if(!J)return[];const te=J.diff.read(X);if(!te)return[];const ie=this._selectedDiffs.read(X);if(ie.length>0){const re=DetailedLineRangeMapping.fromRangeMappings(ie.flatMap(ae=>ae.rangeMappings));return[new DiffGutterItem(re,!0,MenuId.DiffEditorSelectionToolbar,void 0,J.model.original.uri,J.model.modified.uri)]}const se=this._currentDiff.read(X);return te.mappings.map(re=>new DiffGutterItem(re.lineRangeMapping.withInnerChangesFromLineRanges(),re.lineRangeMapping===se?.lineRangeMapping,MenuId.DiffEditorHunkToolbar,void 0,J.model.original.uri,J.model.modified.uri))},createView:(Y,X)=>this._instantiationService.createInstance(DiffToolBar,Y,X,this)})),this._register(addDisposableListener(this.elements.gutter,EventType$1.MOUSE_WHEEL,Y=>{this._editors.modified.getOption(104).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(Y)},{passive:!1}))}computeStagedValue(w){const D=w.innerChanges??[],O=new TextModelText(this._editors.modifiedModel.get()),W=new TextModelText(this._editors.original.getModel());return new TextEdit(D.map(q=>q.toTextEdit(O))).apply(W)}layout(w){this.elements.gutter.style.left=w+"px"}};DiffEditorGutter=__decorate$9([__param$9(6,IInstantiationService),__param$9(7,IContextKeyService),__param$9(8,IMenuService)],DiffEditorGutter);class DiffGutterItem{constructor(w,D,O,W,U,K){this.mapping=w,this.showAlways=D,this.menuId=O,this.rangeOverride=W,this.originalUri=U,this.modifiedUri=K}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}}let DiffToolBar=class extends Disposable{constructor(w,D,O,W){super(),this._item=w,this._elements=h$1("div.gutterItem",{style:{height:"20px",width:"34px"}},[h$1("div.background@background",{},[]),h$1("div.buttons@buttons",{},[])]),this._showAlways=this._item.map(this,K=>K.showAlways),this._menuId=this._item.map(this,K=>K.menuId),this._isSmall=observableValue(this,!1),this._lastItemRange=void 0,this._lastViewRange=void 0;const U=this._register(W.createInstance(WorkbenchHoverDelegate,"element",!0,{position:{hoverPosition:1}}));this._register(appendRemoveOnDispose(D,this._elements.root)),this._register(autorun(K=>{const q=this._showAlways.read(K);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",q),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register(autorunWithStore((K,q)=>{this._elements.buttons.replaceChildren();const G=q.add(W.createInstance(MenuWorkbenchToolBar,this._elements.buttons,this._menuId.read(K),{orientation:1,hoverDelegate:U,toolbarOptions:{primaryGroup:Q=>Q.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(K)?1:3},hiddenItemStrategy:0,actionRunner:new ActionRunnerWithContext(()=>{const Q=this._item.get(),Y=Q.mapping;return{mapping:Y,originalWithModifiedChanges:O.computeStagedValue(Y),originalUri:Q.originalUri,modifiedUri:Q.modifiedUri}}),menuOptions:{shouldForwardArgs:!0}}));q.add(G.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}layout(w,D){this._lastItemRange=w,this._lastViewRange=D;let O=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&w.length<30,void 0),O=this._elements.buttons.clientHeight;const W=w.length/2-O/2,U=O;let K=w.start+W;const q=OffsetRange.tryCreate(U,D.endExclusive-U-O),G=OffsetRange.tryCreate(w.start+U,w.endExclusive-O-U);G&&q&&G.start<G.endExclusive&&(K=q.clip(K),K=G.clip(K)),this._elements.buttons.style.top=`${K-w.start}px`}};DiffToolBar=__decorate$9([__param$9(3,IInstantiationService)],DiffToolBar);function observableCodeEditor(F){return ObservableCodeEditor.get(F)}class ObservableCodeEditor extends Disposable{static{this._map=new Map}static get(w){let D=ObservableCodeEditor._map.get(w);if(!D){D=new ObservableCodeEditor(w),ObservableCodeEditor._map.set(w,D);const O=w.onDidDispose(()=>{const W=ObservableCodeEditor._map.get(w);W&&(ObservableCodeEditor._map.delete(w),W.dispose(),O.dispose())})}return D}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new TransactionImpl(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){const w=this._currentTransaction;this._currentTransaction=void 0,w.finish()}}constructor(w){super(),this.editor=w,this._updateCounter=0,this._currentTransaction=void 0,this._model=observableValue(this,this.editor.getModel()),this.model=this._model,this.isReadonly=observableFromEvent(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(92)),this._versionId=observableValueOpts({owner:this,lazy:!0},this.editor.getModel()?.getVersionId()??null),this.versionId=this._versionId,this._selections=observableValueOpts({owner:this,equalsFn:equalsIfDefined(itemsEquals(Selection$1.selectionsEqual)),lazy:!0},this.editor.getSelections()??null),this.selections=this._selections,this.isFocused=observableFromEvent(this,D=>{const O=this.editor.onDidFocusEditorWidget(D),W=this.editor.onDidBlurEditorWidget(D);return{dispose(){O.dispose(),W.dispose()}}},()=>this.editor.hasWidgetFocus()),this.value=derivedWithSetter(this,D=>(this.versionId.read(D),this.model.read(D)?.getValue()??""),(D,O)=>{const W=this.model.get();W!==null&&D!==W.getValue()&&W.setValue(D)}),this.valueIsEmpty=derived(this,D=>(this.versionId.read(D),this.editor.getModel()?.getValueLength()===0)),this.cursorSelection=derivedOpts({owner:this,equalsFn:equalsIfDefined(Selection$1.selectionsEqual)},D=>this.selections.read(D)?.[0]??null),this.onDidType=observableSignal(this),this.scrollTop=observableFromEvent(this.editor.onDidScrollChange,()=>this.editor.getScrollTop()),this.scrollLeft=observableFromEvent(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft()),this.layoutInfo=observableFromEvent(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo()),this.layoutInfoContentLeft=this.layoutInfo.map(D=>D.contentLeft),this.layoutInfoDecorationsLeft=this.layoutInfo.map(D=>D.decorationsLeft),this.contentWidth=observableFromEvent(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth()),this._overlayWidgetCounter=0,this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(D=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,D)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(D=>{this._beginUpdate();try{this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,D),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(D=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,D),this._forceUpdate()}finally{this._endUpdate()}}))}forceUpdate(w){this._beginUpdate();try{return this._forceUpdate(),w?w(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}getOption(w){return observableFromEvent(this,D=>this.editor.onDidChangeConfiguration(O=>{O.hasChanged(w)&&D(void 0)}),()=>this.editor.getOption(w))}setDecorations(w){const D=new DisposableStore,O=this.editor.createDecorationsCollection();return D.add(autorunOpts({owner:this,debugName:()=>`Apply decorations from ${w.debugName}`},W=>{const U=w.read(W);O.set(U)})),D.add({dispose:()=>{O.clear()}}),D}createOverlayWidget(w){const D="observableOverlayWidget"+this._overlayWidgetCounter++,O={getDomNode:()=>w.domNode,getPosition:()=>w.position.get(),getId:()=>D,allowEditorOverflow:w.allowEditorOverflow,getMinContentWidthInPx:()=>w.minContentWidthInPx.get()};this.editor.addOverlayWidget(O);const W=autorun(U=>{w.position.read(U),w.minContentWidthInPx.read(U),this.editor.layoutOverlayWidget(O)});return toDisposable(()=>{W.dispose(),this.editor.removeOverlayWidget(O)})}}var __decorate$8=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$8=function(F,w){return function(D,O){w(D,O,F)}},HideUnchangedRegionsFeature_1;let HideUnchangedRegionsFeature=class extends Disposable{static{HideUnchangedRegionsFeature_1=this}static{this._breadcrumbsSourceFactory=observableValue(HideUnchangedRegionsFeature_1,()=>({dispose(){},getBreadcrumbItems(w,D){return[]}}))}static setBreadcrumbsSourceFactory(w){this._breadcrumbsSourceFactory.set(w,void 0)}get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}constructor(w,D,O,W){super(),this._editors=w,this._diffModel=D,this._options=O,this._instantiationService=W,this._modifiedOutlineSource=derivedDisposable(this,G=>{const Q=this._editors.modifiedModel.read(G),Y=HideUnchangedRegionsFeature_1._breadcrumbsSourceFactory.read(G);return!Q||!Y?void 0:Y(Q,this._instantiationService)}),this._isUpdatingHiddenAreas=!1,this._register(this._editors.original.onDidChangeCursorPosition(G=>{if(G.reason===1)return;const Q=this._diffModel.get();transaction(Y=>{for(const X of this._editors.original.getSelections()||[])Q?.ensureOriginalLineIsVisible(X.getStartPosition().lineNumber,0,Y),Q?.ensureOriginalLineIsVisible(X.getEndPosition().lineNumber,0,Y)})})),this._register(this._editors.modified.onDidChangeCursorPosition(G=>{if(G.reason===1)return;const Q=this._diffModel.get();transaction(Y=>{for(const X of this._editors.modified.getSelections()||[])Q?.ensureModifiedLineIsVisible(X.getStartPosition().lineNumber,0,Y),Q?.ensureModifiedLineIsVisible(X.getEndPosition().lineNumber,0,Y)})}));const U=this._diffModel.map((G,Q)=>{const Y=G?.unchangedRegions.read(Q)??[];return Y.length===1&&Y[0].modifiedLineNumber===1&&Y[0].lineCount===this._editors.modifiedModel.read(Q)?.getLineCount()?[]:Y});this.viewZones=derivedWithStore(this,(G,Q)=>{const Y=this._modifiedOutlineSource.read(G);if(!Y)return{origViewZones:[],modViewZones:[]};const X=[],J=[],te=this._options.renderSideBySide.read(G),ie=this._options.compactMode.read(G),se=U.read(G);for(let re=0;re<se.length;re++){const ae=se[re];if(!ae.shouldHideControls(G)&&!(ie&&(re===0||re===se.length-1)))if(ie){{const le=derived(this,oe=>ae.getHiddenOriginalRange(oe).startLineNumber-1),de=new PlaceholderViewZone(le,12);X.push(de),Q.add(new CompactCollapsedCodeOverlayWidget(this._editors.original,de,ae,!te))}{const le=derived(this,oe=>ae.getHiddenModifiedRange(oe).startLineNumber-1),de=new PlaceholderViewZone(le,12);J.push(de),Q.add(new CompactCollapsedCodeOverlayWidget(this._editors.modified,de,ae))}}else{{const le=derived(this,oe=>ae.getHiddenOriginalRange(oe).startLineNumber-1),de=new PlaceholderViewZone(le,24);X.push(de),Q.add(new CollapsedCodeOverlayWidget(this._editors.original,de,ae,ae.originalUnchangedRange,!te,Y,oe=>this._diffModel.get().ensureModifiedLineIsVisible(oe,2,void 0),this._options))}{const le=derived(this,oe=>ae.getHiddenModifiedRange(oe).startLineNumber-1),de=new PlaceholderViewZone(le,24);J.push(de),Q.add(new CollapsedCodeOverlayWidget(this._editors.modified,de,ae,ae.modifiedUnchangedRange,!1,Y,oe=>this._diffModel.get().ensureModifiedLineIsVisible(oe,2,void 0),this._options))}}}return{origViewZones:X,modViewZones:J}});const K={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},q={description:"Fold Unchanged",glyphMarginHoverMessage:new MarkdownString(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(localize("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+ThemeIcon.asClassName(Codicon.fold),zIndex:10001};this._register(applyObservableDecorations(this._editors.original,derived(this,G=>{const Q=U.read(G),Y=Q.map(X=>({range:X.originalUnchangedRange.toInclusiveRange(),options:K}));for(const X of Q)X.shouldHideControls(G)&&Y.push({range:Range$2.fromPositions(new Position$1(X.originalLineNumber,1)),options:q});return Y}))),this._register(applyObservableDecorations(this._editors.modified,derived(this,G=>{const Q=U.read(G),Y=Q.map(X=>({range:X.modifiedUnchangedRange.toInclusiveRange(),options:K}));for(const X of Q)X.shouldHideControls(G)&&Y.push({range:LineRange$1.ofLength(X.modifiedLineNumber,1).toInclusiveRange(),options:q});return Y}))),this._register(autorun(G=>{const Q=U.read(G);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(Q.map(Y=>Y.getHiddenOriginalRange(G).toInclusiveRange()).filter(isDefined)),this._editors.modified.setHiddenAreas(Q.map(Y=>Y.getHiddenModifiedRange(G).toInclusiveRange()).filter(isDefined))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(G=>{if(!G.event.rightButton&&G.target.position&&G.target.element?.className.includes("fold-unchanged")){const Q=G.target.position.lineNumber,Y=this._diffModel.get();if(!Y)return;const X=Y.unchangedRegions.get().find(J=>J.modifiedUnchangedRange.includes(Q));if(!X)return;X.collapseAll(void 0),G.event.stopPropagation(),G.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(G=>{if(!G.event.rightButton&&G.target.position&&G.target.element?.className.includes("fold-unchanged")){const Q=G.target.position.lineNumber,Y=this._diffModel.get();if(!Y)return;const X=Y.unchangedRegions.get().find(J=>J.originalUnchangedRange.includes(Q));if(!X)return;X.collapseAll(void 0),G.event.stopPropagation(),G.event.preventDefault()}}))}};HideUnchangedRegionsFeature=HideUnchangedRegionsFeature_1=__decorate$8([__param$8(3,IInstantiationService)],HideUnchangedRegionsFeature);class CompactCollapsedCodeOverlayWidget extends ViewZoneOverlayWidget{constructor(w,D,O,W=!1){const U=h$1("div.diff-hidden-lines-widget");super(w,D,U.root),this._unchangedRegion=O,this._hide=W,this._nodes=h$1("div.diff-hidden-lines-compact",[h$1("div.line-left",[]),h$1("div.text@text",[]),h$1("div.line-right",[])]),U.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register(autorun(K=>{if(!this._hide){const q=this._unchangedRegion.getHiddenModifiedRange(K).length,G=localize("hiddenLines","{0} hidden lines",q);this._nodes.text.innerText=G}}))}}class CollapsedCodeOverlayWidget extends ViewZoneOverlayWidget{constructor(w,D,O,W,U,K,q,G){const Q=h$1("div.diff-hidden-lines-widget");super(w,D,Q.root),this._editor=w,this._unchangedRegion=O,this._unchangedRegionRange=W,this._hide=U,this._modifiedOutlineSource=K,this._revealModifiedHiddenLine=q,this._options=G,this._nodes=h$1("div.diff-hidden-lines",[h$1("div.top@top",{title:localize("diff.hiddenLines.top","Click or drag to show more above")}),h$1("div.center@content",{style:{display:"flex"}},[h$1("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[$$8("a",{title:localize("showUnchangedRegion","Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...renderLabelWithIcons("$(unfold)"))]),h$1("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),h$1("div.bottom@bottom",{title:localize("diff.bottom","Click or drag to show more below"),role:"button"})]),Q.root.appendChild(this._nodes.root),this._hide?reset(this._nodes.first):this._register(applyStyle(this._nodes.first,{width:observableCodeEditor(this._editor).layoutInfoContentLeft})),this._register(autorun(X=>{const J=this._unchangedRegion.visibleLineCountTop.read(X)+this._unchangedRegion.visibleLineCountBottom.read(X)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!J),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(X)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(X)>0),this._nodes.top.classList.toggle("canMoveBottom",!J);const te=this._unchangedRegion.isDragged.read(X),ie=this._editor.getDomNode();ie&&(ie.classList.toggle("draggingUnchangedRegion",!!te),te==="top"?(ie.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(X)>0),ie.classList.toggle("canMoveBottom",!J)):te==="bottom"?(ie.classList.toggle("canMoveTop",!J),ie.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(X)>0)):(ie.classList.toggle("canMoveTop",!1),ie.classList.toggle("canMoveBottom",!1)))}));const Y=this._editor;this._register(addDisposableListener(this._nodes.top,"mousedown",X=>{if(X.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),X.preventDefault();const J=X.clientY;let te=!1;const ie=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);const se=getWindow(this._nodes.top),re=addDisposableListener(se,"mousemove",le=>{const oe=le.clientY-J;te=te||Math.abs(oe)>2;const ue=Math.round(oe/Y.getOption(67)),pe=Math.max(0,Math.min(ie+ue,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(pe,void 0)}),ae=addDisposableListener(se,"mouseup",le=>{te||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),re.dispose(),ae.dispose()})})),this._register(addDisposableListener(this._nodes.bottom,"mousedown",X=>{if(X.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),X.preventDefault();const J=X.clientY;let te=!1;const ie=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);const se=getWindow(this._nodes.bottom),re=addDisposableListener(se,"mousemove",le=>{const oe=le.clientY-J;te=te||Math.abs(oe)>2;const ue=Math.round(oe/Y.getOption(67)),pe=Math.max(0,Math.min(ie-ue,this._unchangedRegion.getMaxVisibleLineCountBottom())),fe=this._unchangedRegionRange.endLineNumberExclusive>Y.getModel().getLineCount()?Y.getContentHeight():Y.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(pe,void 0);const Ce=this._unchangedRegionRange.endLineNumberExclusive>Y.getModel().getLineCount()?Y.getContentHeight():Y.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);Y.setScrollTop(Y.getScrollTop()+(Ce-fe))}),ae=addDisposableListener(se,"mouseup",le=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!te){const de=Y.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);const oe=Y.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);Y.setScrollTop(Y.getScrollTop()+(oe-de))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),re.dispose(),ae.dispose()})})),this._register(autorun(X=>{const J=[];if(!this._hide){const te=O.getHiddenModifiedRange(X).length,ie=localize("hiddenLines","{0} hidden lines",te),se=$$8("span",{title:localize("diff.hiddenLines.expandAll","Double click to unfold")},ie);se.addEventListener("dblclick",le=>{le.button===0&&(le.preventDefault(),this._unchangedRegion.showAll(void 0))}),J.push(se);const re=this._unchangedRegion.getHiddenModifiedRange(X),ae=this._modifiedOutlineSource.getBreadcrumbItems(re,X);if(ae.length>0){J.push($$8("span",void 0,"  |  "));for(let le=0;le<ae.length;le++){const de=ae[le],oe=SymbolKinds.toIcon(de.kind),ue=h$1("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[renderIcon(oe)," ",de.name,...le===ae.length-1?[]:[renderIcon(Codicon.chevronRight)]]).root;J.push(ue),ue.onclick=()=>{this._revealModifiedHiddenLine(de.startLineNumber)}}}}reset(this._nodes.others,...J)}))}}var __decorate$7=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$7=function(F,w){return function(D,O){w(D,O,F)}},OverviewRulerFeature_1;let OverviewRulerFeature=class extends Disposable{static{OverviewRulerFeature_1=this}static{this.ONE_OVERVIEW_WIDTH=15}static{this.ENTIRE_DIFF_OVERVIEW_WIDTH=this.ONE_OVERVIEW_WIDTH*2}constructor(w,D,O,W,U,K,q){super(),this._editors=w,this._rootElement=D,this._diffModel=O,this._rootWidth=W,this._rootHeight=U,this._modifiedEditorLayoutInfo=K,this._themeService=q,this.width=OverviewRulerFeature_1.ENTIRE_DIFF_OVERVIEW_WIDTH;const G=observableFromEvent(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),Q=derived(J=>{const te=G.read(J),ie=te.getColor(diffOverviewRulerInserted)||(te.getColor(diffInserted)||defaultInsertColor).transparent(2),se=te.getColor(diffOverviewRulerRemoved)||(te.getColor(diffRemoved)||defaultRemoveColor).transparent(2);return{insertColor:ie,removeColor:se}}),Y=createFastDomNode(document.createElement("div"));Y.setClassName("diffViewport"),Y.setPosition("absolute");const X=h$1("div.diffOverview",{style:{position:"absolute",top:"0px",width:OverviewRulerFeature_1.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(appendRemoveOnDispose(X,Y.domNode)),this._register(addStandardDisposableListener(X,EventType$1.POINTER_DOWN,J=>{this._editors.modified.delegateVerticalScrollbarPointerDown(J)})),this._register(addDisposableListener(X,EventType$1.MOUSE_WHEEL,J=>{this._editors.modified.delegateScrollFromMouseWheelEvent(J)},{passive:!1})),this._register(appendRemoveOnDispose(this._rootElement,X)),this._register(autorunWithStore((J,te)=>{const ie=this._diffModel.read(J),se=this._editors.original.createOverviewRuler("original diffOverviewRuler");se&&(te.add(se),te.add(appendRemoveOnDispose(X,se.getDomNode())));const re=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(re&&(te.add(re),te.add(appendRemoveOnDispose(X,re.getDomNode()))),!se||!re)return;const ae=observableSignalFromEvent("viewZoneChanged",this._editors.original.onDidChangeViewZones),le=observableSignalFromEvent("viewZoneChanged",this._editors.modified.onDidChangeViewZones),de=observableSignalFromEvent("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),oe=observableSignalFromEvent("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);te.add(autorun(ue=>{ae.read(ue),le.read(ue),de.read(ue),oe.read(ue);const pe=Q.read(ue),fe=ie?.diff.read(ue)?.mappings;function Ce(Te,Re,Me){const Ne=Me._getViewModel();return Ne?Te.filter(ze=>ze.length>0).map(ze=>{const Qe=Ne.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(ze.startLineNumber,1)),Ye=Ne.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(ze.endLineNumberExclusive,1)),Je=Ye.lineNumber-Qe.lineNumber;return new OverviewRulerZone(Qe.lineNumber,Ye.lineNumber,Je,Re.toString())}):[]}const we=Ce((fe||[]).map(Te=>Te.lineRangeMapping.original),pe.removeColor,this._editors.original),Oe=Ce((fe||[]).map(Te=>Te.lineRangeMapping.modified),pe.insertColor,this._editors.modified);se?.setZones(we),re?.setZones(Oe)})),te.add(autorun(ue=>{const pe=this._rootHeight.read(ue),fe=this._rootWidth.read(ue),Ce=this._modifiedEditorLayoutInfo.read(ue);if(Ce){const we=OverviewRulerFeature_1.ENTIRE_DIFF_OVERVIEW_WIDTH-2*OverviewRulerFeature_1.ONE_OVERVIEW_WIDTH;se.setLayout({top:0,height:pe,right:we+OverviewRulerFeature_1.ONE_OVERVIEW_WIDTH,width:OverviewRulerFeature_1.ONE_OVERVIEW_WIDTH}),re.setLayout({top:0,height:pe,right:0,width:OverviewRulerFeature_1.ONE_OVERVIEW_WIDTH});const Oe=this._editors.modifiedScrollTop.read(ue),Te=this._editors.modifiedScrollHeight.read(ue),Re=this._editors.modified.getOption(104),Me=new ScrollbarState(Re.verticalHasArrows?Re.arrowSize:0,Re.verticalScrollbarSize,0,Ce.height,Te,Oe);Y.setTop(Me.getSliderPosition()),Y.setHeight(Me.getSliderSize())}else Y.setTop(0),Y.setHeight(0);X.style.height=pe+"px",X.style.left=fe-OverviewRulerFeature_1.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",Y.setWidth(OverviewRulerFeature_1.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}};OverviewRulerFeature=OverviewRulerFeature_1=__decorate$7([__param$7(6,IThemeService)],OverviewRulerFeature);const emptyArr=[];class RevertButtonsFeature extends Disposable{constructor(w,D,O,W){super(),this._editors=w,this._diffModel=D,this._options=O,this._widget=W,this._selectedDiffs=derived(this,U=>{const q=this._diffModel.read(U)?.diff.read(U);if(!q)return emptyArr;const G=this._editors.modifiedSelections.read(U);if(G.every(J=>J.isEmpty()))return emptyArr;const Q=new LineRangeSet(G.map(J=>LineRange$1.fromRangeInclusive(J))),X=q.mappings.filter(J=>J.lineRangeMapping.innerChanges&&Q.intersects(J.lineRangeMapping.modified)).map(J=>({mapping:J,rangeMappings:J.lineRangeMapping.innerChanges.filter(te=>G.some(ie=>Range$2.areIntersecting(te.modifiedRange,ie)))}));return X.length===0||X.every(J=>J.rangeMappings.length===0)?emptyArr:X}),this._register(autorunWithStore((U,K)=>{if(!this._options.shouldRenderOldRevertArrows.read(U))return;const q=this._diffModel.read(U),G=q?.diff.read(U);if(!q||!G||q.movedTextToCompare.read(U))return;const Q=[],Y=this._selectedDiffs.read(U),X=new Set(Y.map(J=>J.mapping));if(Y.length>0){const J=this._editors.modifiedSelections.read(U),te=K.add(new RevertButton(J[J.length-1].positionLineNumber,this._widget,Y.flatMap(ie=>ie.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(te),Q.push(te)}for(const J of G.mappings)if(!X.has(J)&&!J.lineRangeMapping.modified.isEmpty&&J.lineRangeMapping.innerChanges){const te=K.add(new RevertButton(J.lineRangeMapping.modified.startLineNumber,this._widget,J.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(te),Q.push(te)}K.add(toDisposable(()=>{for(const J of Q)this._editors.modified.removeGlyphMarginWidget(J)}))}))}}class RevertButton extends Disposable{static{this.counter=0}getId(){return this._id}constructor(w,D,O,W){super(),this._lineNumber=w,this._widget=D,this._diffs=O,this._revertSelection=W,this._id=`revertButton${RevertButton.counter++}`,this._domNode=h$1("div.revertButton",{title:this._revertSelection?localize("revertSelectedChanges","Revert Selected Changes"):localize("revertChange","Revert Change")},[renderIcon(Codicon.arrowRight)]).root,this._register(addDisposableListener(this._domNode,EventType$1.MOUSE_DOWN,U=>{U.button!==2&&(U.stopPropagation(),U.preventDefault())})),this._register(addDisposableListener(this._domNode,EventType$1.MOUSE_UP,U=>{U.stopPropagation(),U.preventDefault()})),this._register(addDisposableListener(this._domNode,EventType$1.CLICK,U=>{this._diffs instanceof LineRangeMapping?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),U.stopPropagation(),U.preventDefault()}))}getDomNode(){return this._domNode}getPosition(){return{lane:GlyphMarginLane$1.Right,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}}function bindContextKey(F,w,D){const O=F.bindTo(w);return autorunOpts({debugName:()=>`Set Context Key "${F.key}"`},W=>{O.set(D(W))})}var __decorate$6=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$6=function(F,w){return function(D,O){w(D,O,F)}};let DiffEditorEditors=class extends Disposable{get onDidContentSizeChange(){return this._onDidContentSizeChange.event}constructor(w,D,O,W,U,K,q){super(),this.originalEditorElement=w,this.modifiedEditorElement=D,this._options=O,this._argCodeEditorWidgetOptions=W,this._createInnerEditor=U,this._instantiationService=K,this._keybindingService=q,this.original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{})),this.modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{})),this._onDidContentSizeChange=this._register(new Emitter$1),this.modifiedScrollTop=observableFromEvent(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop()),this.modifiedScrollHeight=observableFromEvent(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight()),this.modifiedObs=observableCodeEditor(this.modified),this.originalObs=observableCodeEditor(this.original),this.modifiedModel=this.modifiedObs.model,this.modifiedSelections=observableFromEvent(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]),this.modifiedCursor=derivedOpts({owner:this,equalsFn:Position$1.equals},G=>this.modifiedSelections.read(G)[0]?.getPosition()??new Position$1(1,1)),this.originalCursor=observableFromEvent(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new Position$1(1,1)),this._argCodeEditorWidgetOptions=null,this._register(autorunHandleChanges({createEmptyChangeSummary:()=>({}),handleChange:(G,Q)=>(G.didChange(O.editorOptions)&&Object.assign(Q,G.change.changedOptions),!0)},(G,Q)=>{O.editorOptions.read(G),this._options.renderSideBySide.read(G),this.modified.updateOptions(this._adjustOptionsForRightHandSide(G,Q)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(G,Q))}))}_createLeftHandSideEditor(w,D){const O=this._adjustOptionsForLeftHandSide(void 0,w),W=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,O,D);return W.setContextValue("isInDiffLeftEditor",!0),W}_createRightHandSideEditor(w,D){const O=this._adjustOptionsForRightHandSide(void 0,w),W=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,O,D);return W.setContextValue("isInDiffRightEditor",!0),W}_constructInnerEditor(w,D,O,W){const U=this._createInnerEditor(w,D,O,W);return this._register(U.onDidContentSizeChange(K=>{const q=this.original.getContentWidth()+this.modified.getContentWidth()+OverviewRulerFeature.ENTIRE_DIFF_OVERVIEW_WIDTH,G=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:G,contentWidth:q,contentHeightChanged:K.contentHeightChanged,contentWidthChanged:K.contentWidthChanged})})),U}_adjustOptionsForLeftHandSide(w,D){const O=this._adjustOptionsForSubEditor(D);return this._options.renderSideBySide.get()?(O.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},O.wordWrapOverride1=this._options.diffWordWrap.get()):(O.wordWrapOverride1="off",O.wordWrapOverride2="off",O.stickyScroll={enabled:!1},O.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),O.glyphMargin=this._options.renderSideBySide.get(),D.originalAriaLabel&&(O.ariaLabel=D.originalAriaLabel),O.ariaLabel=this._updateAriaLabel(O.ariaLabel),O.readOnly=!this._options.originalEditable.get(),O.dropIntoEditor={enabled:!O.readOnly},O.extraEditorClassName="original-in-monaco-diff-editor",O}_adjustOptionsForRightHandSide(w,D){const O=this._adjustOptionsForSubEditor(D);return D.modifiedAriaLabel&&(O.ariaLabel=D.modifiedAriaLabel),O.ariaLabel=this._updateAriaLabel(O.ariaLabel),O.wordWrapOverride1=this._options.diffWordWrap.get(),O.revealHorizontalRightPadding=EditorOptions.revealHorizontalRightPadding.defaultValue+OverviewRulerFeature.ENTIRE_DIFF_OVERVIEW_WIDTH,O.scrollbar.verticalHasArrows=!1,O.extraEditorClassName="modified-in-monaco-diff-editor",O}_adjustOptionsForSubEditor(w){const D={...w,dimension:{height:0,width:0}};return D.inDiffEditor=!0,D.automaticLayout=!1,D.scrollbar={...D.scrollbar||{}},D.folding=!1,D.codeLens=this._options.diffCodeLens.get(),D.fixedOverflowWidgets=!0,D.minimap={...D.minimap||{}},D.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?D.stickyScroll={enabled:!1}:D.stickyScroll=this._options.editorOptions.get().stickyScroll,D}_updateAriaLabel(w){w||(w="");const D=localize("diff-aria-navigation-tip"," use {0} to open the accessibility help.",this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp")?.getAriaLabel());return this._options.accessibilityVerbose.get()?w+D:w?w.replaceAll(D,""):""}};DiffEditorEditors=__decorate$6([__param$6(5,IInstantiationService),__param$6(6,IKeybindingService)],DiffEditorEditors);class DelegatingEditor extends Disposable{constructor(){super(...arguments),this._id=++DelegatingEditor.idCounter,this._onDidDispose=this._register(new Emitter$1),this.onDidDispose=this._onDidDispose.event}static{this.idCounter=0}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(w){return this._targetEditor.getVisibleColumnFromPosition(w)}getPosition(){return this._targetEditor.getPosition()}setPosition(w,D="api"){this._targetEditor.setPosition(w,D)}revealLine(w,D=0){this._targetEditor.revealLine(w,D)}revealLineInCenter(w,D=0){this._targetEditor.revealLineInCenter(w,D)}revealLineInCenterIfOutsideViewport(w,D=0){this._targetEditor.revealLineInCenterIfOutsideViewport(w,D)}revealLineNearTop(w,D=0){this._targetEditor.revealLineNearTop(w,D)}revealPosition(w,D=0){this._targetEditor.revealPosition(w,D)}revealPositionInCenter(w,D=0){this._targetEditor.revealPositionInCenter(w,D)}revealPositionInCenterIfOutsideViewport(w,D=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(w,D)}revealPositionNearTop(w,D=0){this._targetEditor.revealPositionNearTop(w,D)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(w,D="api"){this._targetEditor.setSelection(w,D)}setSelections(w,D="api"){this._targetEditor.setSelections(w,D)}revealLines(w,D,O=0){this._targetEditor.revealLines(w,D,O)}revealLinesInCenter(w,D,O=0){this._targetEditor.revealLinesInCenter(w,D,O)}revealLinesInCenterIfOutsideViewport(w,D,O=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(w,D,O)}revealLinesNearTop(w,D,O=0){this._targetEditor.revealLinesNearTop(w,D,O)}revealRange(w,D=0,O=!1,W=!0){this._targetEditor.revealRange(w,D,O,W)}revealRangeInCenter(w,D=0){this._targetEditor.revealRangeInCenter(w,D)}revealRangeInCenterIfOutsideViewport(w,D=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(w,D)}revealRangeNearTop(w,D=0){this._targetEditor.revealRangeNearTop(w,D)}revealRangeNearTopIfOutsideViewport(w,D=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(w,D)}revealRangeAtTop(w,D=0){this._targetEditor.revealRangeAtTop(w,D)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(w,D,O){this._targetEditor.trigger(w,D,O)}createDecorationsCollection(w){return this._targetEditor.createDecorationsCollection(w)}changeDecorations(w){return this._targetEditor.changeDecorations(w)}}var __decorate$5=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$5=function(F,w){return function(D,O){w(D,O,F)}};let DiffEditorOptions=class{get editorOptions(){return this._options}constructor(w,D){this._accessibilityService=D,this._diffEditorWidth=observableValue(this,0),this._screenReaderMode=observableFromEvent(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized()),this.couldShowInlineViewBecauseOfSize=derived(this,W=>this._options.read(W).renderSideBySide&&this._diffEditorWidth.read(W)<=this._options.read(W).renderSideBySideInlineBreakpoint),this.renderOverviewRuler=derived(this,W=>this._options.read(W).renderOverviewRuler),this.renderSideBySide=derived(this,W=>this.compactMode.read(W)&&this.shouldRenderInlineViewInSmartMode.read(W)?!1:this._options.read(W).renderSideBySide&&!(this._options.read(W).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(W)&&!this._screenReaderMode.read(W))),this.readOnly=derived(this,W=>this._options.read(W).readOnly),this.shouldRenderOldRevertArrows=derived(this,W=>!(!this._options.read(W).renderMarginRevertIcon||!this.renderSideBySide.read(W)||this.readOnly.read(W)||this.shouldRenderGutterMenu.read(W))),this.shouldRenderGutterMenu=derived(this,W=>this._options.read(W).renderGutterMenu),this.renderIndicators=derived(this,W=>this._options.read(W).renderIndicators),this.enableSplitViewResizing=derived(this,W=>this._options.read(W).enableSplitViewResizing),this.splitViewDefaultRatio=derived(this,W=>this._options.read(W).splitViewDefaultRatio),this.ignoreTrimWhitespace=derived(this,W=>this._options.read(W).ignoreTrimWhitespace),this.maxComputationTimeMs=derived(this,W=>this._options.read(W).maxComputationTime),this.showMoves=derived(this,W=>this._options.read(W).experimental.showMoves&&this.renderSideBySide.read(W)),this.isInEmbeddedEditor=derived(this,W=>this._options.read(W).isInEmbeddedEditor),this.diffWordWrap=derived(this,W=>this._options.read(W).diffWordWrap),this.originalEditable=derived(this,W=>this._options.read(W).originalEditable),this.diffCodeLens=derived(this,W=>this._options.read(W).diffCodeLens),this.accessibilityVerbose=derived(this,W=>this._options.read(W).accessibilityVerbose),this.diffAlgorithm=derived(this,W=>this._options.read(W).diffAlgorithm),this.showEmptyDecorations=derived(this,W=>this._options.read(W).experimental.showEmptyDecorations),this.onlyShowAccessibleDiffViewer=derived(this,W=>this._options.read(W).onlyShowAccessibleDiffViewer),this.compactMode=derived(this,W=>this._options.read(W).compactMode),this.trueInlineDiffRenderingEnabled=derived(this,W=>this._options.read(W).experimental.useTrueInlineView),this.useTrueInlineDiffRendering=derived(this,W=>!this.renderSideBySide.read(W)&&this.trueInlineDiffRenderingEnabled.read(W)),this.hideUnchangedRegions=derived(this,W=>this._options.read(W).hideUnchangedRegions.enabled),this.hideUnchangedRegionsRevealLineCount=derived(this,W=>this._options.read(W).hideUnchangedRegions.revealLineCount),this.hideUnchangedRegionsContextLineCount=derived(this,W=>this._options.read(W).hideUnchangedRegions.contextLineCount),this.hideUnchangedRegionsMinimumLineCount=derived(this,W=>this._options.read(W).hideUnchangedRegions.minimumLineCount),this._model=observableValue(this,void 0),this.shouldRenderInlineViewInSmartMode=this._model.map(this,W=>derivedConstOnceDefined(this,U=>{const K=W?.diff.read(U);return K?isSimpleDiff(K,this.trueInlineDiffRenderingEnabled.read(U)):void 0})).flatten().map(this,W=>!!W),this.inlineViewHideOriginalLineNumbers=this.compactMode;const O={...w,...validateDiffEditorOptions(w,diffEditorDefaultOptions)};this._options=observableValue(this,O)}updateOptions(w){const D=validateDiffEditorOptions(w,this._options.get()),O={...this._options.get(),...w,...D};this._options.set(O,void 0,{changedOptions:w})}setWidth(w){this._diffEditorWidth.set(w,void 0)}setModel(w){this._model.set(w,void 0)}};DiffEditorOptions=__decorate$5([__param$5(1,IAccessibilityService)],DiffEditorOptions);function isSimpleDiff(F,w){return F.mappings.every(D=>isInsertion(D.lineRangeMapping)||isDeletion(D.lineRangeMapping)||w&&allowsTrueInlineDiffRendering(D.lineRangeMapping))}function isInsertion(F){return F.original.length===0}function isDeletion(F){return F.modified.length===0}function validateDiffEditorOptions(F,w){return{enableSplitViewResizing:boolean(F.enableSplitViewResizing,w.enableSplitViewResizing),splitViewDefaultRatio:clampedFloat(F.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:boolean(F.renderSideBySide,w.renderSideBySide),renderMarginRevertIcon:boolean(F.renderMarginRevertIcon,w.renderMarginRevertIcon),maxComputationTime:clampedInt(F.maxComputationTime,w.maxComputationTime,0,1073741824),maxFileSize:clampedInt(F.maxFileSize,w.maxFileSize,0,1073741824),ignoreTrimWhitespace:boolean(F.ignoreTrimWhitespace,w.ignoreTrimWhitespace),renderIndicators:boolean(F.renderIndicators,w.renderIndicators),originalEditable:boolean(F.originalEditable,w.originalEditable),diffCodeLens:boolean(F.diffCodeLens,w.diffCodeLens),renderOverviewRuler:boolean(F.renderOverviewRuler,w.renderOverviewRuler),diffWordWrap:stringSet(F.diffWordWrap,w.diffWordWrap,["off","on","inherit"]),diffAlgorithm:stringSet(F.diffAlgorithm,w.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:boolean(F.accessibilityVerbose,w.accessibilityVerbose),experimental:{showMoves:boolean(F.experimental?.showMoves,w.experimental.showMoves),showEmptyDecorations:boolean(F.experimental?.showEmptyDecorations,w.experimental.showEmptyDecorations),useTrueInlineView:boolean(F.experimental?.useTrueInlineView,w.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:boolean(F.hideUnchangedRegions?.enabled??F.experimental?.collapseUnchangedRegions,w.hideUnchangedRegions.enabled),contextLineCount:clampedInt(F.hideUnchangedRegions?.contextLineCount,w.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:clampedInt(F.hideUnchangedRegions?.minimumLineCount,w.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:clampedInt(F.hideUnchangedRegions?.revealLineCount,w.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:boolean(F.isInEmbeddedEditor,w.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:boolean(F.onlyShowAccessibleDiffViewer,w.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:clampedInt(F.renderSideBySideInlineBreakpoint,w.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:boolean(F.useInlineViewWhenSpaceIsLimited,w.useInlineViewWhenSpaceIsLimited),renderGutterMenu:boolean(F.renderGutterMenu,w.renderGutterMenu),compactMode:boolean(F.compactMode,w.compactMode)}}var __decorate$4=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$4=function(F,w){return function(D,O){w(D,O,F)}};let DiffEditorWidget=class extends DelegatingEditor{get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}constructor(w,D,O,W,U,K,q,G){super(),this._domElement=w,this._parentContextKeyService=W,this._parentInstantiationService=U,this._accessibilitySignalService=q,this._editorProgressService=G,this.elements=h$1("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[h$1("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),h$1("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),h$1("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModelSrc=this._register(disposableObservableValue(this,void 0)),this._diffModel=derived(this,oe=>this._diffModelSrc.read(oe)?.object),this.onDidChangeModel=Event$1.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new ServiceCollection([IContextKeyService,this._contextKeyService]))),this._boundarySashes=observableValue(this,void 0),this._accessibleDiffViewerShouldBeVisible=observableValue(this,!1),this._accessibleDiffViewerVisible=derived(this,oe=>this._options.onlyShowAccessibleDiffViewer.read(oe)?!0:this._accessibleDiffViewerShouldBeVisible.read(oe)),this._movedBlocksLinesPart=observableValue(this,void 0),this._layoutInfo=derived(this,oe=>{const ue=this._rootSizeObserver.width.read(oe),pe=this._rootSizeObserver.height.read(oe);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=pe+"px";const fe=this._sash.read(oe),Ce=this._gutter.read(oe),we=Ce?.width.read(oe)??0,Oe=this._overviewRulerPart.read(oe)?.width??0;let Te,Re,Me,Ne,ze;if(!!fe){const Ye=fe.sashLeft.read(oe),Je=this._movedBlocksLinesPart.read(oe)?.width.read(oe)??0;Te=0,Re=Ye-we-Je,ze=Ye-we,Me=Ye,Ne=ue-Me-Oe}else{ze=0;const Ye=this._options.inlineViewHideOriginalLineNumbers.read(oe);Te=we,Ye?Re=0:Re=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(oe)),Me=we+Re,Ne=ue-Me-Oe}return this.elements.original.style.left=Te+"px",this.elements.original.style.width=Re+"px",this._editors.original.layout({width:Re,height:pe},!0),Ce?.layout(ze),this.elements.modified.style.left=Me+"px",this.elements.modified.style.width=Ne+"px",this._editors.modified.layout({width:Ne,height:pe},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}}),this._diffValue=this._diffModel.map((oe,ue)=>oe?.diff.read(ue)),this.onDidUpdateDiff=Event$1.fromObservableLight(this._diffValue),K.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(toDisposable(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new ObservableElementSizeObserver(this.elements.root,D.dimension)),this._rootSizeObserver.setAutomaticLayout(D.automaticLayout??!1),this._options=this._instantiationService.createInstance(DiffEditorOptions,D),this._register(autorun(oe=>{this._options.setWidth(this._rootSizeObserver.width.read(oe))})),this._contextKeyService.createKey(EditorContextKeys.isEmbeddedDiffEditor.key,!1),this._register(bindContextKey(EditorContextKeys.isEmbeddedDiffEditor,this._contextKeyService,oe=>this._options.isInEmbeddedEditor.read(oe))),this._register(bindContextKey(EditorContextKeys.comparingMovedCode,this._contextKeyService,oe=>!!this._diffModel.read(oe)?.movedTextToCompare.read(oe))),this._register(bindContextKey(EditorContextKeys.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,oe=>this._options.couldShowInlineViewBecauseOfSize.read(oe))),this._register(bindContextKey(EditorContextKeys.diffEditorInlineMode,this._contextKeyService,oe=>!this._options.renderSideBySide.read(oe))),this._register(bindContextKey(EditorContextKeys.hasChanges,this._contextKeyService,oe=>(this._diffModel.read(oe)?.diff.read(oe)?.mappings.length??0)>0)),this._editors=this._register(this._instantiationService.createInstance(DiffEditorEditors,this.elements.original,this.elements.modified,this._options,O,(oe,ue,pe,fe)=>this._createInnerEditor(oe,ue,pe,fe))),this._register(bindContextKey(EditorContextKeys.diffEditorOriginalWritable,this._contextKeyService,oe=>this._options.originalEditable.read(oe))),this._register(bindContextKey(EditorContextKeys.diffEditorModifiedWritable,this._contextKeyService,oe=>!this._options.readOnly.read(oe))),this._register(bindContextKey(EditorContextKeys.diffEditorOriginalUri,this._contextKeyService,oe=>this._diffModel.read(oe)?.model.original.uri.toString()??"")),this._register(bindContextKey(EditorContextKeys.diffEditorModifiedUri,this._contextKeyService,oe=>this._diffModel.read(oe)?.model.modified.uri.toString()??"")),this._overviewRulerPart=derivedDisposable(this,oe=>this._options.renderOverviewRuler.read(oe)?this._instantiationService.createInstance(readHotReloadableExport(OverviewRulerFeature,oe),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(ue=>ue.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);const Q={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((oe,ue)=>oe-(this._overviewRulerPart.read(ue)?.width??0))};this._sashLayout=new SashLayout(this._options,Q),this._sash=derivedDisposable(this,oe=>{const ue=this._options.renderSideBySide.read(oe);return this.elements.root.classList.toggle("side-by-side",ue),ue?new DiffEditorSash(this.elements.root,Q,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);const Y=derivedDisposable(this,oe=>this._instantiationService.createInstance(readHotReloadableExport(HideUnchangedRegionsFeature,oe),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);derivedDisposable(this,oe=>this._instantiationService.createInstance(readHotReloadableExport(DiffEditorDecorations,oe),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);const X=new Set,J=new Set;let te=!1;const ie=derivedDisposable(this,oe=>this._instantiationService.createInstance(readHotReloadableExport(DiffEditorViewZones,oe),getWindow(this._domElement),this._editors,this._diffModel,this._options,this,()=>te||Y.get().isUpdatingHiddenAreas,X,J)).recomputeInitiallyAndOnChange(this._store),se=derived(this,oe=>{const ue=ie.read(oe).viewZones.read(oe).orig,pe=Y.read(oe).viewZones.read(oe).origViewZones;return ue.concat(pe)}),re=derived(this,oe=>{const ue=ie.read(oe).viewZones.read(oe).mod,pe=Y.read(oe).viewZones.read(oe).modViewZones;return ue.concat(pe)});this._register(applyViewZones(this._editors.original,se,oe=>{te=oe},X));let ae;this._register(applyViewZones(this._editors.modified,re,oe=>{te=oe,te?ae=StableEditorScrollState.capture(this._editors.modified):(ae?.restore(this._editors.modified),ae=void 0)},J)),this._accessibleDiffViewer=derivedDisposable(this,oe=>this._instantiationService.createInstance(readHotReloadableExport(AccessibleDiffViewer,oe),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(ue,pe)=>this._accessibleDiffViewerShouldBeVisible.set(ue,pe),this._options.onlyShowAccessibleDiffViewer.map(ue=>!ue),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((ue,pe)=>ue?.diff.read(pe)?.mappings.map(fe=>fe.lineRangeMapping)),new AccessibleDiffViewerModelFromEditors(this._editors))).recomputeInitiallyAndOnChange(this._store);const le=this._accessibleDiffViewerVisible.map(oe=>oe?"hidden":"visible");this._register(applyStyle(this.elements.modified,{visibility:le})),this._register(applyStyle(this.elements.original,{visibility:le})),this._createDiffEditorContributions(),K.addDiffEditor(this),this._gutter=derivedDisposable(this,oe=>this._options.shouldRenderGutterMenu.read(oe)?this._instantiationService.createInstance(readHotReloadableExport(DiffEditorGutter,oe),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register(recomputeInitiallyAndOnChange(this._layoutInfo)),derivedDisposable(this,oe=>new(readHotReloadableExport(MovedBlocksLinesFeature,oe))(this.elements.root,this._diffModel,this._layoutInfo.map(ue=>ue.originalEditor),this._layoutInfo.map(ue=>ue.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,oe=>{this._movedBlocksLinesPart.set(oe,void 0)}),this._register(Event$1.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,oe=>this._handleCursorPositionChange(oe,!0))),this._register(Event$1.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,oe=>this._handleCursorPositionChange(oe,!1)));const de=this._diffModel.map(this,(oe,ue)=>{if(oe)return oe.diff.read(ue)===void 0&&!oe.isDiffUpToDate.read(ue)});this._register(autorunWithStore((oe,ue)=>{if(de.read(oe)===!0){const pe=this._editorProgressService.show(!0,1e3);ue.add(toDisposable(()=>pe.done()))}})),this._register(autorunWithStore((oe,ue)=>{ue.add(new(readHotReloadableExport(RevertButtonsFeature,oe))(this._editors,this._diffModel,this._options,this))})),this._register(autorunWithStore((oe,ue)=>{const pe=this._diffModel.read(oe);if(pe)for(const fe of[pe.model.original,pe.model.modified])ue.add(fe.onWillDispose(Ce=>{onUnexpectedError(new BugIndicatingError("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register(autorun(oe=>{this._options.setModel(this._diffModel.read(oe))}))}_createInnerEditor(w,D,O,W){return w.createInstance(CodeEditorWidget,D,O,W)}_createDiffEditorContributions(){const w=EditorExtensionsRegistry.getDiffEditorContributions();for(const D of w)try{this._register(this._instantiationService.createInstance(D.ctor,this))}catch(O){onUnexpectedError(O)}}get _targetEditor(){return this._editors.modified}getEditorType(){return EditorType.IDiffEditor}layout(w){this._rootSizeObserver.observe(w)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){const w=this._editors.original.saveViewState(),D=this._editors.modified.saveViewState();return{original:w,modified:D,modelState:this._diffModel.get()?.serializeState()}}restoreViewState(w){if(w&&w.original&&w.modified){const D=w;this._editors.original.restoreViewState(D.original),this._editors.modified.restoreViewState(D.modified),D.modelState&&this._diffModel.get()?.restoreSerializedState(D.modelState)}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(w){return this._instantiationService.createInstance(DiffEditorViewModel,w,this._options)}getModel(){return this._diffModel.get()?.model??null}setModel(w){const D=w?"model"in w?RefCounted.create(w).createNewRef(this):RefCounted.create(this.createViewModel(w),this):null;this.setDiffModel(D)}setDiffModel(w,D){const O=this._diffModel.get();!w&&O&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==w?.object&&subtransaction(D,W=>{const U=w?.object;observableFromEvent.batchEventsGlobally(W,()=>{this._editors.original.setModel(U?U.model.original:null),this._editors.modified.setModel(U?U.model.modified:null)});const K=this._diffModelSrc.get()?.createNewRef(this);this._diffModelSrc.set(w?.createNewRef(this),W),setTimeout(()=>{K?.dispose()},0)})}updateOptions(w){this._options.updateOptions(w)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){const w=this._diffModel.get()?.diff.get();return w?toLineChanges(w):null}revert(w){const D=this._diffModel.get();!D||!D.isDiffUpToDate.get()||this._editors.modified.executeEdits("diffEditor",[{range:w.modified.toExclusiveRange(),text:D.model.original.getValueInRange(w.original.toExclusiveRange())}])}revertRangeMappings(w){const D=this._diffModel.get();if(!D||!D.isDiffUpToDate.get())return;const O=w.map(W=>({range:W.modifiedRange,text:D.model.original.getValueInRange(W.originalRange)}));this._editors.modified.executeEdits("diffEditor",O)}_goTo(w){this._editors.modified.setPosition(new Position$1(w.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(w.lineRangeMapping.modified.toExclusiveRange())}goToDiff(w){const D=this._diffModel.get()?.diff.get()?.mappings;if(!D||D.length===0)return;const O=this._editors.modified.getPosition().lineNumber;let W;w==="next"?W=D.find(U=>U.lineRangeMapping.modified.startLineNumber>O)??D[0]:W=findLast(D,U=>U.lineRangeMapping.modified.startLineNumber<O)??D[D.length-1],this._goTo(W),W.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(AccessibilitySignal.diffLineDeleted,{source:"diffEditor.goToDiff"}):W.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(AccessibilitySignal.diffLineInserted,{source:"diffEditor.goToDiff"}):W&&this._accessibilitySignalService.playSignal(AccessibilitySignal.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){const w=this._diffModel.get();w&&this.waitForDiff().then(()=>{const D=w.diff.get()?.mappings;!D||D.length===0||this._goTo(D[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){const w=this._diffModel.get();w&&await w.waitForDiff()}mapToOtherSide(){const w=this._editors.modified.hasWidgetFocus(),D=w?this._editors.modified:this._editors.original,O=w?this._editors.original:this._editors.modified;let W;const U=D.getSelection();if(U){const K=this._diffModel.get()?.diff.get()?.mappings.map(q=>w?q.lineRangeMapping.flip():q.lineRangeMapping);if(K){const q=translatePosition(U.getStartPosition(),K),G=translatePosition(U.getEndPosition(),K);W=Range$2.plusRange(q,G)}}return{destination:O,destinationSelection:W}}switchSide(){const{destination:w,destinationSelection:D}=this.mapToOtherSide();w.focus(),D&&w.setSelection(D)}exitCompareMove(){const w=this._diffModel.get();w&&w.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){const w=this._diffModel.get()?.unchangedRegions.get();w&&transaction(D=>{for(const O of w)O.collapseAll(D)})}showAllUnchangedRegions(){const w=this._diffModel.get()?.unchangedRegions.get();w&&transaction(D=>{for(const O of w)O.showAll(D)})}_handleCursorPositionChange(w,D){if(w?.reason===3){const O=this._diffModel.get()?.diff.get()?.mappings.find(W=>D?W.lineRangeMapping.modified.contains(w.position.lineNumber):W.lineRangeMapping.original.contains(w.position.lineNumber));O?.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(AccessibilitySignal.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):O?.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(AccessibilitySignal.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):O&&this._accessibilitySignalService.playSignal(AccessibilitySignal.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};DiffEditorWidget=__decorate$4([__param$4(3,IContextKeyService),__param$4(4,IInstantiationService),__param$4(5,ICodeEditorService),__param$4(6,IAccessibilitySignalService),__param$4(7,IEditorProgressService)],DiffEditorWidget);function toLineChanges(F){return F.mappings.map(w=>{const D=w.lineRangeMapping;let O,W,U,K,q=D.innerChanges;return D.original.isEmpty?(O=D.original.startLineNumber-1,W=0,q=void 0):(O=D.original.startLineNumber,W=D.original.endLineNumberExclusive-1),D.modified.isEmpty?(U=D.modified.startLineNumber-1,K=0,q=void 0):(U=D.modified.startLineNumber,K=D.modified.endLineNumberExclusive-1),{originalStartLineNumber:O,originalEndLineNumber:W,modifiedStartLineNumber:U,modifiedEndLineNumber:K,charChanges:q?.map(G=>({originalStartLineNumber:G.originalRange.startLineNumber,originalStartColumn:G.originalRange.startColumn,originalEndLineNumber:G.originalRange.endLineNumber,originalEndColumn:G.originalRange.endColumn,modifiedStartLineNumber:G.modifiedRange.startLineNumber,modifiedStartColumn:G.modifiedRange.startColumn,modifiedEndLineNumber:G.modifiedRange.endLineNumber,modifiedEndColumn:G.modifiedRange.endColumn}))}})}var __decorate$3=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$3=function(F,w){return function(D,O){w(D,O,F)}};let LAST_GENERATED_COMMAND_ID=0,ariaDomNodeCreated=!1;function createAriaDomNode(F){if(!F){if(ariaDomNodeCreated)return;ariaDomNodeCreated=!0}setARIAContainer(F||mainWindow.document.body)}let StandaloneCodeEditor=class extends CodeEditorWidget{constructor(w,D,O,W,U,K,q,G,Q,Y,X,J,te){const ie={...D};ie.ariaLabel=ie.ariaLabel||StandaloneCodeEditorNLS.editorViewAccessibleLabel,super(w,ie,{},O,W,U,K,Q,Y,X,J,te),G instanceof StandaloneKeybindingService?this._standaloneKeybindingService=G:this._standaloneKeybindingService=null,createAriaDomNode(ie.ariaContainerElement),setHoverDelegateFactory((se,re)=>O.createInstance(WorkbenchHoverDelegate,se,re,{})),setBaseLayerHoverDelegate(q)}addCommand(w,D,O){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const W="DYNAMIC_"+ ++LAST_GENERATED_COMMAND_ID,U=ContextKeyExpr.deserialize(O);return this._standaloneKeybindingService.addDynamicKeybinding(W,w,D,U),W}createContextKey(w,D){return this._contextKeyService.createKey(w,D)}addAction(w){if(typeof w.id!="string"||typeof w.label!="string"||typeof w.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),Disposable.None;const D=w.id,O=w.label,W=ContextKeyExpr.and(ContextKeyExpr.equals("editorId",this.getId()),ContextKeyExpr.deserialize(w.precondition)),U=w.keybindings,K=ContextKeyExpr.and(W,ContextKeyExpr.deserialize(w.keybindingContext)),q=w.contextMenuGroupId||null,G=w.contextMenuOrder||0,Q=(te,...ie)=>Promise.resolve(w.run(this,...ie)),Y=new DisposableStore,X=this.getId()+":"+D;if(Y.add(CommandsRegistry.registerCommand(X,Q)),q){const te={command:{id:X,title:O},when:W,group:q,order:G};Y.add(MenuRegistry.appendMenuItem(MenuId.EditorContext,te))}if(Array.isArray(U))for(const te of U)Y.add(this._standaloneKeybindingService.addDynamicKeybinding(X,te,Q,K));const J=new InternalEditorAction(X,O,O,void 0,W,(...te)=>Promise.resolve(w.run(this,...te)),this._contextKeyService);return this._actions.set(D,J),Y.add(toDisposable(()=>{this._actions.delete(D)})),Y}_triggerCommand(w,D){if(this._codeEditorService instanceof StandaloneCodeEditorService)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(w,D)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(w,D)}};StandaloneCodeEditor=__decorate$3([__param$3(2,IInstantiationService),__param$3(3,ICodeEditorService),__param$3(4,ICommandService),__param$3(5,IContextKeyService),__param$3(6,IHoverService),__param$3(7,IKeybindingService),__param$3(8,IThemeService),__param$3(9,INotificationService),__param$3(10,IAccessibilityService),__param$3(11,ILanguageConfigurationService),__param$3(12,ILanguageFeaturesService)],StandaloneCodeEditor);let StandaloneEditor=class extends StandaloneCodeEditor{constructor(w,D,O,W,U,K,q,G,Q,Y,X,J,te,ie,se,re){const ae={...D};updateConfigurationService(X,ae,!1);const le=Q.registerEditorContainer(w);typeof ae.theme=="string"&&Q.setTheme(ae.theme),typeof ae.autoDetectHighContrast<"u"&&Q.setAutoDetectHighContrast(!!ae.autoDetectHighContrast);const de=ae.model;delete ae.model,super(w,ae,O,W,U,K,q,G,Q,Y,J,se,re),this._configurationService=X,this._standaloneThemeService=Q,this._register(le);let oe;if(typeof de>"u"){const ue=ie.getLanguageIdByMimeType(ae.language)||ae.language||PLAINTEXT_LANGUAGE_ID;oe=createTextModel(te,ie,ae.value||"",ue,void 0),this._ownsModel=!0}else oe=de,this._ownsModel=!1;if(this._attachModel(oe),oe){const ue={oldModelUrl:null,newModelUrl:oe.uri};this._onDidChangeModel.fire(ue)}}dispose(){super.dispose()}updateOptions(w){updateConfigurationService(this._configurationService,w,!1),typeof w.theme=="string"&&this._standaloneThemeService.setTheme(w.theme),typeof w.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!w.autoDetectHighContrast),super.updateOptions(w)}_postDetachModelCleanup(w){super._postDetachModelCleanup(w),w&&this._ownsModel&&(w.dispose(),this._ownsModel=!1)}};StandaloneEditor=__decorate$3([__param$3(2,IInstantiationService),__param$3(3,ICodeEditorService),__param$3(4,ICommandService),__param$3(5,IContextKeyService),__param$3(6,IHoverService),__param$3(7,IKeybindingService),__param$3(8,IStandaloneThemeService),__param$3(9,INotificationService),__param$3(10,IConfigurationService),__param$3(11,IAccessibilityService),__param$3(12,IModelService),__param$3(13,ILanguageService),__param$3(14,ILanguageConfigurationService),__param$3(15,ILanguageFeaturesService)],StandaloneEditor);let StandaloneDiffEditor2=class extends DiffEditorWidget{constructor(w,D,O,W,U,K,q,G,Q,Y,X,J){const te={...D};updateConfigurationService(G,te,!0);const ie=K.registerEditorContainer(w);typeof te.theme=="string"&&K.setTheme(te.theme),typeof te.autoDetectHighContrast<"u"&&K.setAutoDetectHighContrast(!!te.autoDetectHighContrast),super(w,te,{},W,O,U,J,Y),this._configurationService=G,this._standaloneThemeService=K,this._register(ie)}dispose(){super.dispose()}updateOptions(w){updateConfigurationService(this._configurationService,w,!0),typeof w.theme=="string"&&this._standaloneThemeService.setTheme(w.theme),typeof w.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!w.autoDetectHighContrast),super.updateOptions(w)}_createInnerEditor(w,D,O){return w.createInstance(StandaloneCodeEditor,D,O)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(w,D,O){return this.getModifiedEditor().addCommand(w,D,O)}createContextKey(w,D){return this.getModifiedEditor().createContextKey(w,D)}addAction(w){return this.getModifiedEditor().addAction(w)}};StandaloneDiffEditor2=__decorate$3([__param$3(2,IInstantiationService),__param$3(3,IContextKeyService),__param$3(4,ICodeEditorService),__param$3(5,IStandaloneThemeService),__param$3(6,INotificationService),__param$3(7,IConfigurationService),__param$3(8,IContextMenuService),__param$3(9,IEditorProgressService),__param$3(10,IClipboardService),__param$3(11,IAccessibilitySignalService)],StandaloneDiffEditor2);function createTextModel(F,w,D,O,W){if(D=D||"",!O){const U=D.indexOf(`
`);let K=D;return U!==-1&&(K=D.substring(0,U)),doCreateModel(F,D,w.createByFilepathOrFirstLine(W||null,K),W)}return doCreateModel(F,D,w.createById(O),W)}function doCreateModel(F,w,D,O){return F.createModel(w,D,O)}var __decorate$2=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$2=function(F,w){return function(D,O){w(D,O,F)}};class TemplateData{constructor(w,D){this.viewModel=w,this.deltaScrollVertical=D}getId(){return this.viewModel}}let DiffEditorItemTemplate=class extends Disposable{constructor(w,D,O,W,U){super(),this._container=w,this._overflowWidgetsDomNode=D,this._workbenchUIElementFactory=O,this._instantiationService=W,this._viewModel=observableValue(this,void 0),this._collapsed=derived(this,G=>this._viewModel.read(G)?.collapsed.read(G)),this._editorContentHeight=observableValue(this,500),this.contentHeight=derived(this,G=>(this._collapsed.read(G)?0:this._editorContentHeight.read(G))+this._outerEditorHeight),this._modifiedContentWidth=observableValue(this,0),this._modifiedWidth=observableValue(this,0),this._originalContentWidth=observableValue(this,0),this._originalWidth=observableValue(this,0),this.maxScroll=derived(this,G=>{const Q=this._modifiedContentWidth.read(G)-this._modifiedWidth.read(G),Y=this._originalContentWidth.read(G)-this._originalWidth.read(G);return Q>Y?{maxScroll:Q,width:this._modifiedWidth.read(G)}:{maxScroll:Y,width:this._originalWidth.read(G)}}),this._elements=h$1("div.multiDiffEntry",[h$1("div.header@header",[h$1("div.header-content",[h$1("div.collapse-button@collapseButton"),h$1("div.file-path",[h$1("div.title.modified.show-file-icons@primaryPath",[]),h$1("div.status.deleted@status",["R"]),h$1("div.title.original.show-file-icons@secondaryPath",[])]),h$1("div.actions@actions")])]),h$1("div.editorParent",[h$1("div.editorContainer@editor")])]),this.editor=this._register(this._instantiationService.createInstance(DiffEditorWidget,this._elements.editor,{overflowWidgetsDomNode:this._overflowWidgetsDomNode},{})),this.isModifedFocused=observableCodeEditor(this.editor.getModifiedEditor()).isFocused,this.isOriginalFocused=observableCodeEditor(this.editor.getOriginalEditor()).isFocused,this.isFocused=derived(this,G=>this.isModifedFocused.read(G)||this.isOriginalFocused.read(G)),this._resourceLabel=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.primaryPath)):void 0,this._resourceLabel2=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.secondaryPath)):void 0,this._dataStore=this._register(new DisposableStore),this._headerHeight=40,this._lastScrollTop=-1,this._isSettingScrollTop=!1;const K=new Button(this._elements.collapseButton,{});this._register(autorun(G=>{K.element.className="",K.icon=this._collapsed.read(G)?Codicon.chevronRight:Codicon.chevronDown})),this._register(K.onDidClick(()=>{this._viewModel.get()?.collapsed.set(!this._collapsed.get(),void 0)})),this._register(autorun(G=>{this._elements.editor.style.display=this._collapsed.read(G)?"none":"block"})),this._register(this.editor.getModifiedEditor().onDidLayoutChange(G=>{const Q=this.editor.getModifiedEditor().getLayoutInfo().contentWidth;this._modifiedWidth.set(Q,void 0)})),this._register(this.editor.getOriginalEditor().onDidLayoutChange(G=>{const Q=this.editor.getOriginalEditor().getLayoutInfo().contentWidth;this._originalWidth.set(Q,void 0)})),this._register(this.editor.onDidContentSizeChange(G=>{globalTransaction(Q=>{this._editorContentHeight.set(G.contentHeight,Q),this._modifiedContentWidth.set(this.editor.getModifiedEditor().getContentWidth(),Q),this._originalContentWidth.set(this.editor.getOriginalEditor().getContentWidth(),Q)})})),this._register(this.editor.getOriginalEditor().onDidScrollChange(G=>{if(this._isSettingScrollTop||!G.scrollTopChanged||!this._data)return;const Q=G.scrollTop-this._lastScrollTop;this._data.deltaScrollVertical(Q)})),this._register(autorun(G=>{const Q=this._viewModel.read(G)?.isActive.read(G);this._elements.root.classList.toggle("active",Q)})),this._container.appendChild(this._elements.root),this._outerEditorHeight=this._headerHeight,this._contextKeyService=this._register(U.createScoped(this._elements.actions));const q=this._register(this._instantiationService.createChild(new ServiceCollection([IContextKeyService,this._contextKeyService])));this._register(q.createInstance(MenuWorkbenchToolBar,this._elements.actions,MenuId.MultiDiffEditorFileToolbar,{actionRunner:this._register(new ActionRunnerWithContext(()=>this._viewModel.get()?.modifiedUri)),menuOptions:{shouldForwardArgs:!0},toolbarOptions:{primaryGroup:G=>G.startsWith("navigation")},actionViewItemProvider:(G,Q)=>createActionViewItem(q,G,Q)}))}setScrollLeft(w){this._modifiedContentWidth.get()-this._modifiedWidth.get()>this._originalContentWidth.get()-this._originalWidth.get()?this.editor.getModifiedEditor().setScrollLeft(w):this.editor.getOriginalEditor().setScrollLeft(w)}setData(w){this._data=w;function D(W){return{...W,scrollBeyondLastLine:!1,hideUnchangedRegions:{enabled:!0},scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1,useShadows:!1},renderOverviewRuler:!1,fixedOverflowWidgets:!0,overviewRulerBorder:!1}}if(!w){globalTransaction(W=>{this._viewModel.set(void 0,W),this.editor.setDiffModel(null,W),this._dataStore.clear()});return}const O=w.viewModel.documentDiffItem;if(globalTransaction(W=>{this._resourceLabel?.setUri(w.viewModel.modifiedUri??w.viewModel.originalUri,{strikethrough:w.viewModel.modifiedUri===void 0});let U=!1,K=!1,q=!1,G="";w.viewModel.modifiedUri&&w.viewModel.originalUri&&w.viewModel.modifiedUri.path!==w.viewModel.originalUri.path?(G="R",U=!0):w.viewModel.modifiedUri?w.viewModel.originalUri||(G="A",q=!0):(G="D",K=!0),this._elements.status.classList.toggle("renamed",U),this._elements.status.classList.toggle("deleted",K),this._elements.status.classList.toggle("added",q),this._elements.status.innerText=G,this._resourceLabel2?.setUri(U?w.viewModel.originalUri:void 0,{strikethrough:!0}),this._dataStore.clear(),this._viewModel.set(w.viewModel,W),this.editor.setDiffModel(w.viewModel.diffEditorViewModelRef,W),this.editor.updateOptions(D(O.options??{}))}),O.onOptionsDidChange&&this._dataStore.add(O.onOptionsDidChange(()=>{this.editor.updateOptions(D(O.options??{}))})),w.viewModel.isAlive.recomputeInitiallyAndOnChange(this._dataStore,W=>{W||this.setData(void 0)}),w.viewModel.documentDiffItem.contextKeys)for(const[W,U]of Object.entries(w.viewModel.documentDiffItem.contextKeys))this._contextKeyService.createKey(W,U)}render(w,D,O,W){this._elements.root.style.visibility="visible",this._elements.root.style.top=`${w.start}px`,this._elements.root.style.height=`${w.length}px`,this._elements.root.style.width=`${D}px`,this._elements.root.style.position="absolute";const U=w.length-this._headerHeight,K=Math.max(0,Math.min(W.start-w.start,U));this._elements.header.style.transform=`translateY(${K}px)`,globalTransaction(q=>{this.editor.layout({width:D-2*8-2*1,height:w.length-this._outerEditorHeight})});try{this._isSettingScrollTop=!0,this._lastScrollTop=O,this.editor.getOriginalEditor().setScrollTop(O)}finally{this._isSettingScrollTop=!1}this._elements.header.classList.toggle("shadow",K>0||O>0),this._elements.header.classList.toggle("collapsed",K===U)}hide(){this._elements.root.style.top="-100000px",this._elements.root.style.visibility="hidden"}};DiffEditorItemTemplate=__decorate$2([__param$2(3,IInstantiationService),__param$2(4,IContextKeyService)],DiffEditorItemTemplate);class ObjectPool{constructor(w){this._create=w,this._unused=new Set,this._used=new Set,this._itemData=new Map}getUnusedObj(w){let D;if(this._unused.size===0)D=this._create(w),this._itemData.set(D,w);else{const O=[...this._unused.values()];D=O.find(W=>this._itemData.get(W).getId()===w.getId())??O[0],this._unused.delete(D),this._itemData.set(D,w),D.setData(w)}return this._used.add(D),{object:D,dispose:()=>{this._used.delete(D),this._unused.size>5?D.dispose():this._unused.add(D)}}}dispose(){for(const w of this._used)w.dispose();for(const w of this._unused)w.dispose();this._used.clear(),this._unused.clear()}}var __decorate$1=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param$1=function(F,w){return function(D,O){w(D,O,F)}};let MultiDiffEditorWidgetImpl=class extends Disposable{constructor(w,D,O,W,U,K){super(),this._element=w,this._dimension=D,this._viewModel=O,this._workbenchUIElementFactory=W,this._parentContextKeyService=U,this._parentInstantiationService=K,this._scrollableElements=h$1("div.scrollContent",[h$1("div@content",{style:{overflow:"hidden"}}),h$1("div.monaco-editor@overflowWidgetsDomNode",{})]),this._scrollable=this._register(new Scrollable({forceIntegerValues:!1,scheduleAtNextAnimationFrame:G=>scheduleAtNextAnimationFrame(getWindow(this._element),G),smoothScrollDuration:100})),this._scrollableElement=this._register(new SmoothScrollableElement(this._scrollableElements.root,{vertical:1,horizontal:1,useShadows:!1},this._scrollable)),this._elements=h$1("div.monaco-component.multiDiffEditor",{},[h$1("div",{},[this._scrollableElement.getDomNode()]),h$1("div.placeholder@placeholder",{},[h$1("div",[localize("noChangedFiles","No Changed Files")])])]),this._sizeObserver=this._register(new ObservableElementSizeObserver(this._element,void 0)),this._objectPool=this._register(new ObjectPool(G=>{const Q=this._instantiationService.createInstance(DiffEditorItemTemplate,this._scrollableElements.content,this._scrollableElements.overflowWidgetsDomNode,this._workbenchUIElementFactory);return Q.setData(G),Q})),this.scrollTop=observableFromEvent(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollTop),this.scrollLeft=observableFromEvent(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollLeft),this._viewItemsInfo=derivedWithStore(this,(G,Q)=>{const Y=this._viewModel.read(G);if(!Y)return{items:[],getItem:ie=>{throw new BugIndicatingError}};const X=Y.items.read(G),J=new Map;return{items:X.map(ie=>{const se=Q.add(new VirtualizedViewItem(ie,this._objectPool,this.scrollLeft,ae=>{this._scrollableElement.setScrollPosition({scrollTop:this._scrollableElement.getScrollPosition().scrollTop+ae})})),re=this._lastDocStates?.[se.getKey()];return re&&transaction(ae=>{se.setViewState(re,ae)}),J.set(ie,se),se}),getItem:ie=>J.get(ie)}}),this._viewItems=this._viewItemsInfo.map(this,G=>G.items),this._spaceBetweenPx=0,this._totalHeight=this._viewItems.map(this,(G,Q)=>G.reduce((Y,X)=>Y+X.contentHeight.read(Q)+this._spaceBetweenPx,0)),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._element)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new ServiceCollection([IContextKeyService,this._contextKeyService]))),this._lastDocStates={},this._contextKeyService.createKey(EditorContextKeys.inMultiDiffEditor.key,!0),this._register(autorunWithStore((G,Q)=>{const Y=this._viewModel.read(G);if(Y&&Y.contextKeys)for(const[X,J]of Object.entries(Y.contextKeys)){const te=this._contextKeyService.createKey(X,void 0);te.set(J),Q.add(toDisposable(()=>te.reset()))}}));const q=this._parentContextKeyService.createKey(EditorContextKeys.multiDiffEditorAllCollapsed.key,!1);this._register(autorun(G=>{const Q=this._viewModel.read(G);if(Q){const Y=Q.items.read(G).every(X=>X.collapsed.read(G));q.set(Y)}})),this._register(autorun(G=>{const Q=this._dimension.read(G);this._sizeObserver.observe(Q)})),this._register(autorun(G=>{const Q=this._viewItems.read(G);this._elements.placeholder.classList.toggle("visible",Q.length===0)})),this._scrollableElements.content.style.position="relative",this._register(autorun(G=>{const Q=this._sizeObserver.height.read(G);this._scrollableElements.root.style.height=`${Q}px`;const Y=this._totalHeight.read(G);this._scrollableElements.content.style.height=`${Y}px`;const X=this._sizeObserver.width.read(G);let J=X;const te=this._viewItems.read(G),ie=findFirstMax(te,compareBy(se=>se.maxScroll.read(G).maxScroll,numberComparator));if(ie){const se=ie.maxScroll.read(G);J=X+se.maxScroll}this._scrollableElement.setScrollDimensions({width:X,height:Q,scrollHeight:Y,scrollWidth:J})})),w.replaceChildren(this._elements.root),this._register(toDisposable(()=>{w.replaceChildren()})),this._register(this._register(autorun(G=>{globalTransaction(Q=>{this.render(G)})})))}render(w){const D=this.scrollTop.read(w);let O=0,W=0,U=0;const K=this._sizeObserver.height.read(w),q=OffsetRange.ofStartAndLength(D,K),G=this._sizeObserver.width.read(w);for(const Q of this._viewItems.read(w)){const Y=Q.contentHeight.read(w),X=Math.min(Y,K),J=OffsetRange.ofStartAndLength(W,X),te=OffsetRange.ofStartAndLength(U,Y);if(te.isBefore(q))O-=Y-X,Q.hide();else if(te.isAfter(q))Q.hide();else{const ie=Math.max(0,Math.min(q.start-te.start,Y-X));O-=ie;const se=OffsetRange.ofStartAndLength(D+O,K);Q.render(J,ie,G,se)}W+=X+this._spaceBetweenPx,U+=Y+this._spaceBetweenPx}this._scrollableElements.content.style.transform=`translateY(${-(D+O)}px)`}};MultiDiffEditorWidgetImpl=__decorate$1([__param$1(4,IContextKeyService),__param$1(5,IInstantiationService)],MultiDiffEditorWidgetImpl);class VirtualizedViewItem extends Disposable{constructor(w,D,O,W){super(),this.viewModel=w,this._objectPool=D,this._scrollLeft=O,this._deltaScrollVertical=W,this._templateRef=this._register(disposableObservableValue(this,void 0)),this.contentHeight=derived(this,U=>this._templateRef.read(U)?.object.contentHeight?.read(U)??this.viewModel.lastTemplateData.read(U).contentHeight),this.maxScroll=derived(this,U=>this._templateRef.read(U)?.object.maxScroll.read(U)??{maxScroll:0,scrollWidth:0}),this.template=derived(this,U=>this._templateRef.read(U)?.object),this._isHidden=observableValue(this,!1),this._isFocused=derived(this,U=>this.template.read(U)?.isFocused.read(U)??!1),this.viewModel.setIsFocused(this._isFocused,void 0),this._register(autorun(U=>{const K=this._scrollLeft.read(U);this._templateRef.read(U)?.object.setScrollLeft(K)})),this._register(autorun(U=>{const K=this._templateRef.read(U);!K||!this._isHidden.read(U)||K.object.isFocused.read(U)||this._clear()}))}dispose(){this._clear(),super.dispose()}toString(){return`VirtualViewItem(${this.viewModel.documentDiffItem.modified?.uri.toString()})`}getKey(){return this.viewModel.getKey()}setViewState(w,D){this.viewModel.collapsed.set(w.collapsed,D),this._updateTemplateData(D);const O=this.viewModel.lastTemplateData.get(),W=w.selections?.map(Selection$1.liftSelection);this.viewModel.lastTemplateData.set({...O,selections:W},D);const U=this._templateRef.get();U&&W&&U.object.editor.setSelections(W)}_updateTemplateData(w){const D=this._templateRef.get();D&&this.viewModel.lastTemplateData.set({contentHeight:D.object.contentHeight.get(),selections:D.object.editor.getSelections()??void 0},w)}_clear(){const w=this._templateRef.get();w&&transaction(D=>{this._updateTemplateData(D),w.object.hide(),this._templateRef.set(void 0,D)})}hide(){this._isHidden.set(!0,void 0)}render(w,D,O,W){this._isHidden.set(!1,void 0);let U=this._templateRef.get();if(!U){U=this._objectPool.getUnusedObj(new TemplateData(this.viewModel,this._deltaScrollVertical)),this._templateRef.set(U,void 0);const K=this.viewModel.lastTemplateData.get().selections;K&&U.object.editor.setSelections(K)}U.object.render(w,O,D,W)}}registerColor("multiDiffEditor.headerBackground",{dark:"#262626",light:"tab.inactiveBackground",hcDark:"tab.inactiveBackground",hcLight:"tab.inactiveBackground"},localize("multiDiffEditor.headerBackground","The background color of the diff editor's header"));registerColor("multiDiffEditor.background",editorBackground,localize("multiDiffEditor.background","The background color of the multi file diff editor"));registerColor("multiDiffEditor.border",{dark:"sideBarSectionHeader.border",light:"#cccccc",hcDark:"sideBarSectionHeader.border",hcLight:"#cccccc"},localize("multiDiffEditor.border","The border color of the multi file diff editor"));var __decorate=function(F,w,D,O){var W=arguments.length,U=W<3?w:O===null?O=Object.getOwnPropertyDescriptor(w,D):O,K;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(F,w,D,O);else for(var q=F.length-1;q>=0;q--)(K=F[q])&&(U=(W<3?K(U):W>3?K(w,D,U):K(w,D))||U);return W>3&&U&&Object.defineProperty(w,D,U),U},__param=function(F,w){return function(D,O){w(D,O,F)}};let MultiDiffEditorWidget=class extends Disposable{constructor(w,D,O){super(),this._element=w,this._workbenchUIElementFactory=D,this._instantiationService=O,this._dimension=observableValue(this,void 0),this._viewModel=observableValue(this,void 0),this._widgetImpl=derivedWithStore(this,(W,U)=>(readHotReloadableExport(DiffEditorItemTemplate,W),U.add(this._instantiationService.createInstance(readHotReloadableExport(MultiDiffEditorWidgetImpl,W),this._element,this._dimension,this._viewModel,this._workbenchUIElementFactory)))),this._register(recomputeInitiallyAndOnChange(this._widgetImpl))}};MultiDiffEditorWidget=__decorate([__param(2,IInstantiationService)],MultiDiffEditorWidget);function create(F,w,D){return StandaloneServices.initialize(D||{}).createInstance(StandaloneEditor,F,w)}function onDidCreateEditor(F){return StandaloneServices.get(ICodeEditorService).onCodeEditorAdd(D=>{F(D)})}function onDidCreateDiffEditor(F){return StandaloneServices.get(ICodeEditorService).onDiffEditorAdd(D=>{F(D)})}function getEditors(){return StandaloneServices.get(ICodeEditorService).listCodeEditors()}function getDiffEditors(){return StandaloneServices.get(ICodeEditorService).listDiffEditors()}function createDiffEditor(F,w,D){return StandaloneServices.initialize(D||{}).createInstance(StandaloneDiffEditor2,F,w)}function createMultiFileDiffEditor(F,w){const D=StandaloneServices.initialize(w||{});return new MultiDiffEditorWidget(F,{},D)}function addCommand(F){if(typeof F.id!="string"||typeof F.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return CommandsRegistry.registerCommand(F.id,F.run)}function addEditorAction(F){if(typeof F.id!="string"||typeof F.label!="string"||typeof F.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const w=ContextKeyExpr.deserialize(F.precondition),D=(W,...U)=>EditorCommand.runEditorCommand(W,U,w,(K,q,G)=>Promise.resolve(F.run(q,...G))),O=new DisposableStore;if(O.add(CommandsRegistry.registerCommand(F.id,D)),F.contextMenuGroupId){const W={command:{id:F.id,title:F.label},when:w,group:F.contextMenuGroupId,order:F.contextMenuOrder||0};O.add(MenuRegistry.appendMenuItem(MenuId.EditorContext,W))}if(Array.isArray(F.keybindings)){const W=StandaloneServices.get(IKeybindingService);if(!(W instanceof StandaloneKeybindingService))console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService");else{const U=ContextKeyExpr.and(w,ContextKeyExpr.deserialize(F.keybindingContext));O.add(W.addDynamicKeybindings(F.keybindings.map(K=>({keybinding:K,command:F.id,when:U}))))}}return O}function addKeybindingRule(F){return addKeybindingRules([F])}function addKeybindingRules(F){const w=StandaloneServices.get(IKeybindingService);return w instanceof StandaloneKeybindingService?w.addDynamicKeybindings(F.map(D=>({keybinding:D.keybinding,command:D.command,commandArgs:D.commandArgs,when:ContextKeyExpr.deserialize(D.when)}))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),Disposable.None)}function createModel(F,w,D){const O=StandaloneServices.get(ILanguageService),W=O.getLanguageIdByMimeType(w)||w;return createTextModel(StandaloneServices.get(IModelService),O,F,W,D)}function setModelLanguage(F,w){const D=StandaloneServices.get(ILanguageService),O=D.getLanguageIdByMimeType(w)||w||PLAINTEXT_LANGUAGE_ID;F.setLanguage(D.createById(O))}function setModelMarkers(F,w,D){F&&StandaloneServices.get(IMarkerService).changeOne(w,F.uri,D)}function removeAllMarkers(F){StandaloneServices.get(IMarkerService).changeAll(F,[])}function getModelMarkers(F){return StandaloneServices.get(IMarkerService).read(F)}function onDidChangeMarkers(F){return StandaloneServices.get(IMarkerService).onMarkerChanged(F)}function getModel(F){return StandaloneServices.get(IModelService).getModel(F)}function getModels(){return StandaloneServices.get(IModelService).getModels()}function onDidCreateModel(F){return StandaloneServices.get(IModelService).onModelAdded(F)}function onWillDisposeModel(F){return StandaloneServices.get(IModelService).onModelRemoved(F)}function onDidChangeModelLanguage(F){return StandaloneServices.get(IModelService).onModelLanguageChanged(D=>{F({model:D.model,oldLanguage:D.oldLanguageId})})}function createWebWorker(F){return createWebWorker$1(StandaloneServices.get(IModelService),F)}function colorizeElement(F,w){const D=StandaloneServices.get(ILanguageService),O=StandaloneServices.get(IStandaloneThemeService);return Colorizer.colorizeElement(O,D,F,w).then(()=>{O.registerEditorContainer(F)})}function colorize(F,w,D){const O=StandaloneServices.get(ILanguageService);return StandaloneServices.get(IStandaloneThemeService).registerEditorContainer(mainWindow.document.body),Colorizer.colorize(O,F,w,D)}function colorizeModelLine(F,w,D=4){return StandaloneServices.get(IStandaloneThemeService).registerEditorContainer(mainWindow.document.body),Colorizer.colorizeModelLine(F,w,D)}function getSafeTokenizationSupport(F){const w=TokenizationRegistry.get(F);return w||{getInitialState:()=>NullState,tokenize:(D,O,W)=>nullTokenize(F,W)}}function tokenize(F,w){TokenizationRegistry.getOrCreate(w);const D=getSafeTokenizationSupport(w),O=splitLines(F),W=[];let U=D.getInitialState();for(let K=0,q=O.length;K<q;K++){const G=O[K],Q=D.tokenize(G,!0,U);W[K]=Q.tokens,U=Q.endState}return W}function defineTheme(F,w){StandaloneServices.get(IStandaloneThemeService).defineTheme(F,w)}function setTheme(F){StandaloneServices.get(IStandaloneThemeService).setTheme(F)}function remeasureFonts(){FontMeasurements.clearAllFontInfos()}function registerCommand(F,w){return CommandsRegistry.registerCommand({id:F,handler:w})}function registerLinkOpener(F){return StandaloneServices.get(IOpenerService).registerOpener({async open(D){return typeof D=="string"&&(D=URI.parse(D)),F.open(D)}})}function registerEditorOpener(F){return StandaloneServices.get(ICodeEditorService).registerCodeEditorOpenHandler(async(D,O,W)=>{if(!O)return null;const U=D.options?.selection;let K;return U&&typeof U.endLineNumber=="number"&&typeof U.endColumn=="number"?K=U:U&&(K={lineNumber:U.startLineNumber,column:U.startColumn}),await F.openCodeEditor(O,D.resource,K)?O:null})}function createMonacoEditorAPI(){return{create,getEditors,getDiffEditors,onDidCreateEditor,onDidCreateDiffEditor,createDiffEditor,addCommand,addEditorAction,addKeybindingRule,addKeybindingRules,createModel,setModelLanguage,setModelMarkers,getModelMarkers,removeAllMarkers,onDidChangeMarkers,getModels,getModel,onDidCreateModel,onWillDisposeModel,onDidChangeModelLanguage,createWebWorker,colorizeElement,colorize,colorizeModelLine,tokenize,defineTheme,setTheme,remeasureFonts,registerCommand,registerLinkOpener,registerEditorOpener,AccessibilitySupport,ContentWidgetPositionPreference,CursorChangeReason,DefaultEndOfLine,EditorAutoIndentStrategy,EditorOption,EndOfLinePreference,EndOfLineSequence,MinimapPosition,MinimapSectionHeaderStyle,MouseTargetType,OverlayWidgetPositionPreference,OverviewRulerLane,GlyphMarginLane,RenderLineNumbersType,RenderMinimap,ScrollbarVisibility,ScrollType,TextEditorCursorBlinkingStyle,TextEditorCursorStyle,TrackedRangeStickiness,WrappingIndent,InjectedTextCursorStops,PositionAffinity,ShowLightbulbIconMode,ConfigurationChangedEvent,BareFontInfo,FontInfo,TextModelResolvedOptions,FindMatch,ApplyUpdateResult,EditorZoom,createMultiFileDiffEditor,EditorType,EditorOptions}}function isArrayOf(F,w){if(!w||!Array.isArray(w))return!1;for(const D of w)if(!F(D))return!1;return!0}function bool$1(F,w){return typeof F=="boolean"?F:w}function string(F,w){return typeof F=="string"?F:w}function arrayToHash(F){const w={};for(const D of F)w[D]=!0;return w}function createKeywordMatcher(F,w=!1){w&&(F=F.map(function(O){return O.toLowerCase()}));const D=arrayToHash(F);return w?function(O){return D[O.toLowerCase()]!==void 0&&D.hasOwnProperty(O.toLowerCase())}:function(O){return D[O]!==void 0&&D.hasOwnProperty(O)}}function compileRegExp(F,w,D){w=w.replace(/@@/g,"");let O=0,W;do W=!1,w=w.replace(/@(\w+)/g,function(K,q){W=!0;let G="";if(typeof F[q]=="string")G=F[q];else if(F[q]&&F[q]instanceof RegExp)G=F[q].source;else throw F[q]===void 0?createError(F,"language definition does not contain attribute '"+q+"', used at: "+w):createError(F,"attribute reference '"+q+"' must be a string, used at: "+w);return empty(G)?"":"(?:"+G+")"}),O++;while(W&&O<5);w=w.replace(/\x01/g,"@");const U=(F.ignoreCase?"i":"")+(F.unicode?"u":"");if(D&&w.match(/\$[sS](\d\d?)/g)){let q=null,G=null;return Q=>(G&&q===Q||(q=Q,G=new RegExp(substituteMatchesRe(F,w,Q),U)),G)}return new RegExp(w,U)}function selectScrutinee(F,w,D,O){if(O<0)return F;if(O<w.length)return w[O];if(O>=100){O=O-100;const W=D.split(".");if(W.unshift(D),O<W.length)return W[O]}return null}function createGuard(F,w,D,O){let W=-1,U=D,K=D.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);K&&(K[3]&&(W=parseInt(K[3]),K[2]&&(W=W+100)),U=K[4]);let q="~",G=U;!U||U.length===0?(q="!=",G=""):/^\w*$/.test(G)?q="==":(K=U.match(/^(@|!@|~|!~|==|!=)(.*)$/),K&&(q=K[1],G=K[2]));let Q;if((q==="~"||q==="!~")&&/^(\w|\|)*$/.test(G)){const Y=createKeywordMatcher(G.split("|"),F.ignoreCase);Q=function(X){return q==="~"?Y(X):!Y(X)}}else if(q==="@"||q==="!@"){const Y=F[G];if(!Y)throw createError(F,"the @ match target '"+G+"' is not defined, in rule: "+w);if(!isArrayOf(function(J){return typeof J=="string"},Y))throw createError(F,"the @ match target '"+G+"' must be an array of strings, in rule: "+w);const X=createKeywordMatcher(Y,F.ignoreCase);Q=function(J){return q==="@"?X(J):!X(J)}}else if(q==="~"||q==="!~")if(G.indexOf("$")<0){const Y=compileRegExp(F,"^"+G+"$",!1);Q=function(X){return q==="~"?Y.test(X):!Y.test(X)}}else Q=function(Y,X,J,te){return compileRegExp(F,"^"+substituteMatches(F,G,X,J,te)+"$",!1).test(Y)};else if(G.indexOf("$")<0){const Y=fixCase(F,G);Q=function(X){return q==="=="?X===Y:X!==Y}}else{const Y=fixCase(F,G);Q=function(X,J,te,ie,se){const re=substituteMatches(F,Y,J,te,ie);return q==="=="?X===re:X!==re}}return W===-1?{name:D,value:O,test:function(Y,X,J,te){return Q(Y,Y,X,J,te)}}:{name:D,value:O,test:function(Y,X,J,te){const ie=selectScrutinee(Y,X,J,W);return Q(ie||"",Y,X,J,te)}}}function compileAction(F,w,D){if(D){if(typeof D=="string")return D;if(D.token||D.token===""){if(typeof D.token!="string")throw createError(F,"a 'token' attribute must be of type string, in rule: "+w);{const O={token:D.token};if(D.token.indexOf("$")>=0&&(O.tokenSubst=!0),typeof D.bracket=="string")if(D.bracket==="@open")O.bracket=1;else if(D.bracket==="@close")O.bracket=-1;else throw createError(F,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+w);if(D.next){if(typeof D.next!="string")throw createError(F,"the next state must be a string value in rule: "+w);{let W=D.next;if(!/^(@pop|@push|@popall)$/.test(W)&&(W[0]==="@"&&(W=W.substr(1)),W.indexOf("$")<0&&!stateExists(F,substituteMatches(F,W,"",[],""))))throw createError(F,"the next state '"+D.next+"' is not defined in rule: "+w);O.next=W}}return typeof D.goBack=="number"&&(O.goBack=D.goBack),typeof D.switchTo=="string"&&(O.switchTo=D.switchTo),typeof D.log=="string"&&(O.log=D.log),typeof D.nextEmbedded=="string"&&(O.nextEmbedded=D.nextEmbedded,F.usesEmbedded=!0),O}}else if(Array.isArray(D)){const O=[];for(let W=0,U=D.length;W<U;W++)O[W]=compileAction(F,w,D[W]);return{group:O}}else if(D.cases){const O=[];for(const U in D.cases)if(D.cases.hasOwnProperty(U)){const K=compileAction(F,w,D.cases[U]);U==="@default"||U==="@"||U===""?O.push({test:void 0,value:K,name:U}):U==="@eos"?O.push({test:function(q,G,Q,Y){return Y},value:K,name:U}):O.push(createGuard(F,w,U,K))}const W=F.defaultToken;return{test:function(U,K,q,G){for(const Q of O)if(!Q.test||Q.test(U,K,q,G))return Q.value;return W}}}else throw createError(F,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+w)}else return{token:""}}class Rule{constructor(w){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=w}setRegex(w,D){let O;if(typeof D=="string")O=D;else if(D instanceof RegExp)O=D.source;else throw createError(w,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=O.length>0&&O[0]==="^",this.name=this.name+": "+O,this.regex=compileRegExp(w,"^(?:"+(this.matchOnlyAtLineStart?O.substr(1):O)+")",!0)}setAction(w,D){this.action=compileAction(w,this.name,D)}resolveRegex(w){return this.regex instanceof RegExp?this.regex:this.regex(w)}}function compile(F,w){if(!w||typeof w!="object")throw new Error("Monarch: expecting a language definition object");const D={languageId:F,includeLF:bool$1(w.includeLF,!1),noThrow:!1,maxStack:100,start:typeof w.start=="string"?w.start:null,ignoreCase:bool$1(w.ignoreCase,!1),unicode:bool$1(w.unicode,!1),tokenPostfix:string(w.tokenPostfix,"."+F),defaultToken:string(w.defaultToken,"source"),usesEmbedded:!1,stateNames:{},tokenizer:{},brackets:[]},O=w;O.languageId=F,O.includeLF=D.includeLF,O.ignoreCase=D.ignoreCase,O.unicode=D.unicode,O.noThrow=D.noThrow,O.usesEmbedded=D.usesEmbedded,O.stateNames=w.tokenizer,O.defaultToken=D.defaultToken;function W(K,q,G){for(const Q of G){let Y=Q.include;if(Y){if(typeof Y!="string")throw createError(D,"an 'include' attribute must be a string at: "+K);if(Y[0]==="@"&&(Y=Y.substr(1)),!w.tokenizer[Y])throw createError(D,"include target '"+Y+"' is not defined at: "+K);W(K+"."+Y,q,w.tokenizer[Y])}else{const X=new Rule(K);if(Array.isArray(Q)&&Q.length>=1&&Q.length<=3)if(X.setRegex(O,Q[0]),Q.length>=3)if(typeof Q[1]=="string")X.setAction(O,{token:Q[1],next:Q[2]});else if(typeof Q[1]=="object"){const J=Q[1];J.next=Q[2],X.setAction(O,J)}else throw createError(D,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+K);else X.setAction(O,Q[1]);else{if(!Q.regex)throw createError(D,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+K);Q.name&&typeof Q.name=="string"&&(X.name=Q.name),Q.matchOnlyAtStart&&(X.matchOnlyAtLineStart=bool$1(Q.matchOnlyAtLineStart,!1)),X.setRegex(O,Q.regex),X.setAction(O,Q.action)}q.push(X)}}}if(!w.tokenizer||typeof w.tokenizer!="object")throw createError(D,"a language definition must define the 'tokenizer' attribute as an object");D.tokenizer=[];for(const K in w.tokenizer)if(w.tokenizer.hasOwnProperty(K)){D.start||(D.start=K);const q=w.tokenizer[K];D.tokenizer[K]=new Array,W("tokenizer."+K,D.tokenizer[K],q)}if(D.usesEmbedded=O.usesEmbedded,w.brackets){if(!Array.isArray(w.brackets))throw createError(D,"the 'brackets' attribute must be defined as an array")}else w.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const U=[];for(const K of w.brackets){let q=K;if(q&&Array.isArray(q)&&q.length===3&&(q={token:q[2],open:q[0],close:q[1]}),q.open===q.close)throw createError(D,"open and close brackets in a 'brackets' attribute must be different: "+q.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof q.open=="string"&&typeof q.token=="string"&&typeof q.close=="string")U.push({token:q.token+D.tokenPostfix,open:fixCase(D,q.open),close:fixCase(D,q.close)});else throw createError(D,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return D.brackets=U,D.noThrow=!0,D}function register(F){ModesRegistry.registerLanguage(F)}function getLanguages(){let F=[];return F=F.concat(ModesRegistry.getLanguages()),F}function getEncodedLanguageId(F){return StandaloneServices.get(ILanguageService).languageIdCodec.encodeLanguageId(F)}function onLanguage(F,w){return StandaloneServices.withServices(()=>{const O=StandaloneServices.get(ILanguageService).onDidRequestRichLanguageFeatures(W=>{W===F&&(O.dispose(),w())});return O})}function onLanguageEncountered(F,w){return StandaloneServices.withServices(()=>{const O=StandaloneServices.get(ILanguageService).onDidRequestBasicLanguageFeatures(W=>{W===F&&(O.dispose(),w())});return O})}function setLanguageConfiguration(F,w){if(!StandaloneServices.get(ILanguageService).isRegisteredLanguageId(F))throw new Error(`Cannot set configuration for unknown language ${F}`);return StandaloneServices.get(ILanguageConfigurationService).register(F,w,100)}class EncodedTokenizationSupportAdapter{constructor(w,D){this._languageId=w,this._actual=D}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(w,D,O){if(typeof this._actual.tokenize=="function")return TokenizationSupportAdapter.adaptTokenize(this._languageId,this._actual,w,O);throw new Error("Not supported!")}tokenizeEncoded(w,D,O){const W=this._actual.tokenizeEncoded(w,O);return new EncodedTokenizationResult(W.tokens,W.endState)}}class TokenizationSupportAdapter{constructor(w,D,O,W){this._languageId=w,this._actual=D,this._languageService=O,this._standaloneThemeService=W}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(w,D){const O=[];let W=0;for(let U=0,K=w.length;U<K;U++){const q=w[U];let G=q.startIndex;U===0?G=0:G<W&&(G=W),O[U]=new Token$1(G,q.scopes,D),W=G}return O}static adaptTokenize(w,D,O,W){const U=D.tokenize(O,W),K=TokenizationSupportAdapter._toClassicTokens(U.tokens,w);let q;return U.endState.equals(W)?q=W:q=U.endState,new TokenizationResult(K,q)}tokenize(w,D,O){return TokenizationSupportAdapter.adaptTokenize(this._languageId,this._actual,w,O)}_toBinaryTokens(w,D){const O=w.encodeLanguageId(this._languageId),W=this._standaloneThemeService.getColorTheme().tokenTheme,U=[];let K=0,q=0;for(let Q=0,Y=D.length;Q<Y;Q++){const X=D[Q],J=W.match(O,X.scopes)|1024;if(K>0&&U[K-1]===J)continue;let te=X.startIndex;Q===0?te=0:te<q&&(te=q),U[K++]=te,U[K++]=J,q=te}const G=new Uint32Array(K);for(let Q=0;Q<K;Q++)G[Q]=U[Q];return G}tokenizeEncoded(w,D,O){const W=this._actual.tokenize(w,O),U=this._toBinaryTokens(this._languageService.languageIdCodec,W.tokens);let K;return W.endState.equals(O)?K=O:K=W.endState,new EncodedTokenizationResult(U,K)}}function isATokensProvider(F){return typeof F.getInitialState=="function"}function isEncodedTokensProvider(F){return"tokenizeEncoded"in F}function isThenable(F){return F&&typeof F.then=="function"}function setColorMap(F){const w=StandaloneServices.get(IStandaloneThemeService);if(F){const D=[null];for(let O=1,W=F.length;O<W;O++)D[O]=Color.fromHex(F[O]);w.setColorMapOverride(D)}else w.setColorMapOverride(null)}function createTokenizationSupportAdapter(F,w){return isEncodedTokensProvider(w)?new EncodedTokenizationSupportAdapter(F,w):new TokenizationSupportAdapter(F,w,StandaloneServices.get(ILanguageService),StandaloneServices.get(IStandaloneThemeService))}function registerTokensProviderFactory(F,w){const D=new LazyTokenizationSupport(async()=>{const O=await Promise.resolve(w.create());return O?isATokensProvider(O)?createTokenizationSupportAdapter(F,O):new MonarchTokenizer(StandaloneServices.get(ILanguageService),StandaloneServices.get(IStandaloneThemeService),F,compile(F,O),StandaloneServices.get(IConfigurationService)):null});return TokenizationRegistry.registerFactory(F,D)}function setTokensProvider(F,w){if(!StandaloneServices.get(ILanguageService).isRegisteredLanguageId(F))throw new Error(`Cannot set tokens provider for unknown language ${F}`);return isThenable(w)?registerTokensProviderFactory(F,{create:()=>w}):TokenizationRegistry.register(F,createTokenizationSupportAdapter(F,w))}function setMonarchTokensProvider(F,w){const D=O=>new MonarchTokenizer(StandaloneServices.get(ILanguageService),StandaloneServices.get(IStandaloneThemeService),F,compile(F,O),StandaloneServices.get(IConfigurationService));return isThenable(w)?registerTokensProviderFactory(F,{create:()=>w}):TokenizationRegistry.register(F,D(w))}function registerReferenceProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).referenceProvider.register(F,w)}function registerRenameProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).renameProvider.register(F,w)}function registerNewSymbolNameProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).newSymbolNamesProvider.register(F,w)}function registerSignatureHelpProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).signatureHelpProvider.register(F,w)}function registerHoverProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).hoverProvider.register(F,{provideHover:async(O,W,U,K)=>{const q=O.getWordAtPosition(W);return Promise.resolve(w.provideHover(O,W,U,K)).then(G=>{if(G)return!G.range&&q&&(G.range=new Range$2(W.lineNumber,q.startColumn,W.lineNumber,q.endColumn)),G.range||(G.range=new Range$2(W.lineNumber,W.column,W.lineNumber,W.column)),G})}})}function registerDocumentSymbolProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).documentSymbolProvider.register(F,w)}function registerDocumentHighlightProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).documentHighlightProvider.register(F,w)}function registerLinkedEditingRangeProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).linkedEditingRangeProvider.register(F,w)}function registerDefinitionProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).definitionProvider.register(F,w)}function registerImplementationProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).implementationProvider.register(F,w)}function registerTypeDefinitionProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).typeDefinitionProvider.register(F,w)}function registerCodeLensProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).codeLensProvider.register(F,w)}function registerCodeActionProvider(F,w,D){return StandaloneServices.get(ILanguageFeaturesService).codeActionProvider.register(F,{providedCodeActionKinds:D?.providedCodeActionKinds,documentation:D?.documentation,provideCodeActions:(W,U,K,q)=>{const Q=StandaloneServices.get(IMarkerService).read({resource:W.uri}).filter(Y=>Range$2.areIntersectingOrTouching(Y,U));return w.provideCodeActions(W,U,{markers:Q,only:K.only,trigger:K.trigger},q)},resolveCodeAction:w.resolveCodeAction})}function registerDocumentFormattingEditProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).documentFormattingEditProvider.register(F,w)}function registerDocumentRangeFormattingEditProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).documentRangeFormattingEditProvider.register(F,w)}function registerOnTypeFormattingEditProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).onTypeFormattingEditProvider.register(F,w)}function registerLinkProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).linkProvider.register(F,w)}function registerCompletionItemProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).completionProvider.register(F,w)}function registerColorProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).colorProvider.register(F,w)}function registerFoldingRangeProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).foldingRangeProvider.register(F,w)}function registerDeclarationProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).declarationProvider.register(F,w)}function registerSelectionRangeProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).selectionRangeProvider.register(F,w)}function registerDocumentSemanticTokensProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).documentSemanticTokensProvider.register(F,w)}function registerDocumentRangeSemanticTokensProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).documentRangeSemanticTokensProvider.register(F,w)}function registerInlineCompletionsProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).inlineCompletionsProvider.register(F,w)}function registerInlineEditProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).inlineEditProvider.register(F,w)}function registerInlayHintsProvider(F,w){return StandaloneServices.get(ILanguageFeaturesService).inlayHintsProvider.register(F,w)}function createMonacoLanguagesAPI(){return{register,getLanguages,onLanguage,onLanguageEncountered,getEncodedLanguageId,setLanguageConfiguration,setColorMap,registerTokensProviderFactory,setTokensProvider,setMonarchTokensProvider,registerReferenceProvider,registerRenameProvider,registerNewSymbolNameProvider,registerCompletionItemProvider,registerSignatureHelpProvider,registerHoverProvider,registerDocumentSymbolProvider,registerDocumentHighlightProvider,registerLinkedEditingRangeProvider,registerDefinitionProvider,registerImplementationProvider,registerTypeDefinitionProvider,registerCodeLensProvider,registerCodeActionProvider,registerDocumentFormattingEditProvider,registerDocumentRangeFormattingEditProvider,registerOnTypeFormattingEditProvider,registerLinkProvider,registerColorProvider,registerFoldingRangeProvider,registerDeclarationProvider,registerSelectionRangeProvider,registerDocumentSemanticTokensProvider,registerDocumentRangeSemanticTokensProvider,registerInlineCompletionsProvider,registerInlineEditProvider,registerInlayHintsProvider,DocumentHighlightKind,CompletionItemKind,CompletionItemTag,CompletionItemInsertTextRule,SymbolKind,SymbolTag,IndentAction,CompletionTriggerKind,SignatureHelpTriggerKind,InlayHintKind,InlineCompletionTriggerKind,InlineEditTriggerKind,CodeActionTriggerType,NewSymbolNameTag,NewSymbolNameTriggerKind,PartialAcceptTriggerKind,HoverVerbosityAction,FoldingRangeKind,SelectedSuggestionInfo}}const IEditorCancellationTokens=createDecorator("IEditorCancelService"),ctxCancellableOperation=new RawContextKey("cancellableOperation",!1,localize("cancellableOperation","Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));registerSingleton(IEditorCancellationTokens,class{constructor(){this._tokens=new WeakMap}add(F,w){let D=this._tokens.get(F);D||(D=F.invokeWithinContext(W=>{const U=ctxCancellableOperation.bindTo(W.get(IContextKeyService)),K=new LinkedList;return{key:U,tokens:K}}),this._tokens.set(F,D));let O;return D.key.set(!0),O=D.tokens.push(w),()=>{O&&(O(),D.key.set(!D.tokens.isEmpty()),O=void 0)}}cancel(F){const w=this._tokens.get(F);if(!w)return;const D=w.tokens.pop();D&&(D.cancel(),w.key.set(!w.tokens.isEmpty()))}},1);registerEditorCommand(new class extends EditorCommand{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:ctxCancellableOperation})}runEditorCommand(F,w){F.get(IEditorCancellationTokens).cancel(w)}});class ExtensionIdentifier{constructor(w){this.value=w,this._lower=w.toLowerCase()}static toKey(w){return typeof w=="string"?w.toLowerCase():w._lower}}class ExtensionIdentifierSet{constructor(w){if(this._set=new Set,w)for(const D of w)this.add(D)}add(w){this._set.add(ExtensionIdentifier.toKey(w))}has(w){return this._set.has(ExtensionIdentifier.toKey(w))}}function getRealAndSyntheticDocumentFormattersOrdered(F,w,D){const O=[],W=new ExtensionIdentifierSet,U=F.ordered(D);for(const q of U)O.push(q),q.extensionId&&W.add(q.extensionId);const K=w.ordered(D);for(const q of K){if(q.extensionId){if(W.has(q.extensionId))continue;W.add(q.extensionId)}O.push({displayName:q.displayName,extensionId:q.extensionId,provideDocumentFormattingEdits(G,Q,Y){return q.provideDocumentRangeFormattingEdits(G,G.getFullModelRange(),Q,Y)}})}return O}class FormattingConflicts{static{this._selectors=new LinkedList}static setFormatterSelector(w){return{dispose:FormattingConflicts._selectors.unshift(w)}}static async select(w,D,O,W){if(w.length===0)return;const U=Iterable.first(FormattingConflicts._selectors);if(U)return await U(w,D,O,W)}}async function getDocumentRangeFormattingEditsUntilResult(F,w,D,O,W,U){const K=w.documentRangeFormattingEditProvider.ordered(D);for(const q of K){const G=await Promise.resolve(q.provideDocumentRangeFormattingEdits(D,O,W,U)).catch(onUnexpectedExternalError);if(isNonEmptyArray(G))return await F.computeMoreMinimalEdits(D.uri,G)}}async function getDocumentFormattingEditsUntilResult(F,w,D,O,W){const U=getRealAndSyntheticDocumentFormattersOrdered(w.documentFormattingEditProvider,w.documentRangeFormattingEditProvider,D);for(const K of U){const q=await Promise.resolve(K.provideDocumentFormattingEdits(D,O,W)).catch(onUnexpectedExternalError);if(isNonEmptyArray(q))return await F.computeMoreMinimalEdits(D.uri,q)}}function getOnTypeFormattingEdits(F,w,D,O,W,U,K){const q=w.onTypeFormattingEditProvider.ordered(D);return q.length===0||q[0].autoFormatTriggerCharacters.indexOf(W)<0?Promise.resolve(void 0):Promise.resolve(q[0].provideOnTypeFormattingEdits(D,O,W,U,K)).catch(onUnexpectedExternalError).then(G=>F.computeMoreMinimalEdits(D.uri,G))}CommandsRegistry.registerCommand("_executeFormatRangeProvider",async function(F,...w){const[D,O,W]=w;assertType(URI.isUri(D)),assertType(Range$2.isIRange(O));const U=F.get(ITextModelService),K=F.get(IEditorWorkerService),q=F.get(ILanguageFeaturesService),G=await U.createModelReference(D);try{return getDocumentRangeFormattingEditsUntilResult(K,q,G.object.textEditorModel,Range$2.lift(O),W,CancellationToken.None)}finally{G.dispose()}});CommandsRegistry.registerCommand("_executeFormatDocumentProvider",async function(F,...w){const[D,O]=w;assertType(URI.isUri(D));const W=F.get(ITextModelService),U=F.get(IEditorWorkerService),K=F.get(ILanguageFeaturesService),q=await W.createModelReference(D);try{return getDocumentFormattingEditsUntilResult(U,K,q.object.textEditorModel,O,CancellationToken.None)}finally{q.dispose()}});CommandsRegistry.registerCommand("_executeFormatOnTypeProvider",async function(F,...w){const[D,O,W,U]=w;assertType(URI.isUri(D)),assertType(Position$1.isIPosition(O)),assertType(typeof W=="string");const K=F.get(ITextModelService),q=F.get(IEditorWorkerService),G=F.get(ILanguageFeaturesService),Q=await K.createModelReference(D);try{return getOnTypeFormattingEdits(q,G,Q.object.textEditorModel,Position$1.lift(O),W,U,CancellationToken.None)}finally{Q.dispose()}});EditorOptions.wrappingIndent.defaultValue=0;EditorOptions.glyphMargin.defaultValue=!1;EditorOptions.autoIndent.defaultValue=3;EditorOptions.overviewRulerLanes.defaultValue=2;FormattingConflicts.setFormatterSelector((F,w,D)=>Promise.resolve(F[0]));const api=createMonacoBaseAPI();api.editor=createMonacoEditorAPI();api.languages=createMonacoLanguagesAPI();const CancellationTokenSource=api.CancellationTokenSource,Emitter=api.Emitter,KeyCode=api.KeyCode,KeyMod=api.KeyMod,Position=api.Position,Range=api.Range,Selection=api.Selection,SelectionDirection=api.SelectionDirection,MarkerSeverity=api.MarkerSeverity,MarkerTag=api.MarkerTag,Uri=api.Uri,Token=api.Token,editor=api.editor,languages=api.languages,monacoEnvironment=globalThis.MonacoEnvironment;(monacoEnvironment?.globalAPI||typeof define=="function"&&define.amd)&&(globalThis.monaco=api);typeof globalThis.require<"u"&&typeof globalThis.require.config=="function"&&globalThis.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const monaco=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource,Emitter,KeyCode,KeyMod,MarkerSeverity,MarkerTag,Position,Range,Selection,SelectionDirection,Token,Uri,editor,languages},Symbol.toStringTag,{value:"Module"}));var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(F){return F&&F.__esModule&&Object.prototype.hasOwnProperty.call(F,"default")?F.default:F}var lodash$1={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var lodash=lodash$1.exports,hasRequiredLodash;function requireLodash(){return hasRequiredLodash||(hasRequiredLodash=1,function(F,w){(function(){var D,O="4.17.21",W=200,U="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",K="Expected a function",q="Invalid `variable` option passed into `_.template`",G="__lodash_hash_undefined__",Q=500,Y="__lodash_placeholder__",X=1,J=2,te=4,ie=1,se=2,re=1,ae=2,le=4,de=8,oe=16,ue=32,pe=64,fe=128,Ce=256,we=512,Oe=30,Te="...",Re=800,Me=16,Ne=1,ze=2,Qe=3,Ye=1/0,Je=9007199254740991,at=17976931348623157e292,st=NaN,lt=4294967295,Tt=lt-1,Ke=lt>>>1,je=[["ary",fe],["bind",re],["bindKey",ae],["curry",de],["curryRight",oe],["flip",we],["partial",ue],["partialRight",pe],["rearg",Ce]],et="[object Arguments]",mt="[object Array]",Mt="[object AsyncFunction]",Et="[object Boolean]",Ct="[object Date]",Nt="[object DOMException]",zt="[object Error]",ii="[object Function]",Ci="[object GeneratorFunction]",ni="[object Map]",vi="[object Number]",hi="[object Null]",jt="[object Object]",zi="[object Promise]",Ki="[object Proxy]",pi="[object RegExp]",mi="[object Set]",kt="[object String]",ki="[object Symbol]",Ii="[object Undefined]",Jt="[object WeakMap]",_i="[object WeakSet]",Lt="[object ArrayBuffer]",St="[object DataView]",si="[object Float32Array]",Se="[object Float64Array]",ge="[object Int8Array]",_e="[object Int16Array]",ke="[object Int32Array]",Fe="[object Uint8Array]",qe="[object Uint8ClampedArray]",tt="[object Uint16Array]",It="[object Uint32Array]",wt=/\b__p \+= '';/g,Ht=/\b(__p \+=) '' \+/g,ri=/(__e\(.*?\)|\b__t\)) \+\n'';/g,qt=/&(?:amp|lt|gt|quot|#39);/g,di=/[&<>"']/g,Zi=RegExp(qt.source),On=RegExp(di.source),Pn=/<%-([\s\S]+?)%>/g,Cn=/<%([\s\S]+?)%>/g,xt=/<%=([\s\S]+?)%>/g,Ee=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xe=/^\w*$/,Ie=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pe=/[\\^$.*+?()[\]{}|]/g,$e=RegExp(Pe.source),Ge=/^\s+/,Xe=/\s/,ut=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,pt=/,? & /,$t=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Pt=/[()=,{}\[\]\/\s]/,Yt=/\\(\\)?/g,Xt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Si=/\w*$/,Pi=/^[-+]0x[0-9a-f]+$/i,yn=/^0b[01]+$/i,vt=/^\[object .+?Constructor\]$/,We=/^0o[0-7]+$/i,dt=/^(?:0|[1-9]\d*)$/,_t=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Zt=/($^)/,Ti=/['\n\r\u2028\u2029\\]/g,gi="\\ud800-\\udfff",Mi="\\u0300-\\u036f",qi="\\ufe20-\\ufe2f",En="\\u20d0-\\u20ff",Di=Mi+qi+En,Gn="\\u2700-\\u27bf",jn="a-z\\xdf-\\xf6\\xf8-\\xff",Nr="\\xac\\xb1\\xd7\\xf7",Rr="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ar="\\u2000-\\u206f",Mr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Xi="A-Z\\xc0-\\xd6\\xd8-\\xde",rs="\\ufe0e\\ufe0f",ws=Nr+Rr+Ar+Mr,os="['’]",Or="["+gi+"]",Fn="["+ws+"]",as="["+Di+"]",Ws="\\d+",zs="["+Gn+"]",Vs="["+jn+"]",Hs="[^"+gi+ws+Ws+Gn+jn+Xi+"]",he="\\ud83c[\\udffb-\\udfff]",be="(?:"+as+"|"+he+")",De="[^"+gi+"]",Ve="(?:\\ud83c[\\udde6-\\uddff]){2}",nt="[\\ud800-\\udbff][\\udc00-\\udfff]",gt="["+Xi+"]",Bt="\\u200d",ei="(?:"+Vs+"|"+Hs+")",Ni="(?:"+gt+"|"+Hs+")",yi="(?:"+os+"(?:d|ll|m|re|s|t|ve))?",Ko="(?:"+os+"(?:D|LL|M|RE|S|T|VE))?",qo=be+"?",Go="["+rs+"]?",nc="(?:"+Bt+"(?:"+[De,Ve,nt].join("|")+")"+Go+qo+")*",sc="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rc="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",jo=Go+qo+nc,oc="(?:"+[zs,Ve,nt].join("|")+")"+jo,ac="(?:"+[De+as+"?",as,Ve,nt,Or].join("|")+")",lc=RegExp(os,"g"),cc=RegExp(as,"g"),Pr=RegExp(he+"(?="+he+")|"+ac+jo,"g"),dc=RegExp([gt+"?"+Vs+"+"+yi+"(?="+[Fn,gt,"$"].join("|")+")",Ni+"+"+Ko+"(?="+[Fn,gt+ei,"$"].join("|")+")",gt+"?"+ei+"+"+yi,gt+"+"+Ko,rc,sc,Ws,oc].join("|"),"g"),uc=RegExp("["+Bt+gi+Di+rs+"]"),hc=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,gc=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],fc=-1,ui={};ui[si]=ui[Se]=ui[ge]=ui[_e]=ui[ke]=ui[Fe]=ui[qe]=ui[tt]=ui[It]=!0,ui[et]=ui[mt]=ui[Lt]=ui[Et]=ui[St]=ui[Ct]=ui[zt]=ui[ii]=ui[ni]=ui[vi]=ui[jt]=ui[pi]=ui[mi]=ui[kt]=ui[Jt]=!1;var ci={};ci[et]=ci[mt]=ci[Lt]=ci[St]=ci[Et]=ci[Ct]=ci[si]=ci[Se]=ci[ge]=ci[_e]=ci[ke]=ci[ni]=ci[vi]=ci[jt]=ci[pi]=ci[mi]=ci[kt]=ci[ki]=ci[Fe]=ci[qe]=ci[tt]=ci[It]=!0,ci[zt]=ci[ii]=ci[Jt]=!1;var pc={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},mc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_c={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},bc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Cc=parseFloat,vc=parseInt,Qo=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,Sc=typeof self=="object"&&self&&self.Object===Object&&self,Fi=Qo||Sc||Function("return this")(),Fr=w&&!w.nodeType&&w,Qn=Fr&&!0&&F&&!F.nodeType&&F,Yo=Qn&&Qn.exports===Fr,$r=Yo&&Qo.process,on=function(){try{var He=Qn&&Qn.require&&Qn.require("util").types;return He||$r&&$r.binding&&$r.binding("util")}catch{}}(),Zo=on&&on.isArrayBuffer,Xo=on&&on.isDate,Jo=on&&on.isMap,ea=on&&on.isRegExp,ta=on&&on.isSet,ia=on&&on.isTypedArray;function Ji(He,it,Ze){switch(Ze.length){case 0:return He.call(it);case 1:return He.call(it,Ze[0]);case 2:return He.call(it,Ze[0],Ze[1]);case 3:return He.call(it,Ze[0],Ze[1],Ze[2])}return He.apply(it,Ze)}function wc(He,it,Ze,bt){for(var Ot=-1,ti=He==null?0:He.length;++Ot<ti;){var Ri=He[Ot];it(bt,Ri,Ze(Ri),He)}return bt}function an(He,it){for(var Ze=-1,bt=He==null?0:He.length;++Ze<bt&&it(He[Ze],Ze,He)!==!1;);return He}function yc(He,it){for(var Ze=He==null?0:He.length;Ze--&&it(He[Ze],Ze,He)!==!1;);return He}function na(He,it){for(var Ze=-1,bt=He==null?0:He.length;++Ze<bt;)if(!it(He[Ze],Ze,He))return!1;return!0}function $n(He,it){for(var Ze=-1,bt=He==null?0:He.length,Ot=0,ti=[];++Ze<bt;){var Ri=He[Ze];it(Ri,Ze,He)&&(ti[Ot++]=Ri)}return ti}function Us(He,it){var Ze=He==null?0:He.length;return!!Ze&&ls(He,it,0)>-1}function Br(He,it,Ze){for(var bt=-1,Ot=He==null?0:He.length;++bt<Ot;)if(Ze(it,He[bt]))return!0;return!1}function fi(He,it){for(var Ze=-1,bt=He==null?0:He.length,Ot=Array(bt);++Ze<bt;)Ot[Ze]=it(He[Ze],Ze,He);return Ot}function Bn(He,it){for(var Ze=-1,bt=it.length,Ot=He.length;++Ze<bt;)He[Ot+Ze]=it[Ze];return He}function Wr(He,it,Ze,bt){var Ot=-1,ti=He==null?0:He.length;for(bt&&ti&&(Ze=He[++Ot]);++Ot<ti;)Ze=it(Ze,He[Ot],Ot,He);return Ze}function Ec(He,it,Ze,bt){var Ot=He==null?0:He.length;for(bt&&Ot&&(Ze=He[--Ot]);Ot--;)Ze=it(Ze,He[Ot],Ot,He);return Ze}function zr(He,it){for(var Ze=-1,bt=He==null?0:He.length;++Ze<bt;)if(it(He[Ze],Ze,He))return!0;return!1}var Lc=Vr("length");function xc(He){return He.split("")}function kc(He){return He.match($t)||[]}function sa(He,it,Ze){var bt;return Ze(He,function(Ot,ti,Ri){if(it(Ot,ti,Ri))return bt=ti,!1}),bt}function Ks(He,it,Ze,bt){for(var Ot=He.length,ti=Ze+(bt?1:-1);bt?ti--:++ti<Ot;)if(it(He[ti],ti,He))return ti;return-1}function ls(He,it,Ze){return it===it?Bc(He,it,Ze):Ks(He,ra,Ze)}function Ic(He,it,Ze,bt){for(var Ot=Ze-1,ti=He.length;++Ot<ti;)if(bt(He[Ot],it))return Ot;return-1}function ra(He){return He!==He}function oa(He,it){var Ze=He==null?0:He.length;return Ze?Ur(He,it)/Ze:st}function Vr(He){return function(it){return it==null?D:it[He]}}function Hr(He){return function(it){return He==null?D:He[it]}}function aa(He,it,Ze,bt,Ot){return Ot(He,function(ti,Ri,li){Ze=bt?(bt=!1,ti):it(Ze,ti,Ri,li)}),Ze}function Tc(He,it){var Ze=He.length;for(He.sort(it);Ze--;)He[Ze]=He[Ze].value;return He}function Ur(He,it){for(var Ze,bt=-1,Ot=He.length;++bt<Ot;){var ti=it(He[bt]);ti!==D&&(Ze=Ze===D?ti:Ze+ti)}return Ze}function Kr(He,it){for(var Ze=-1,bt=Array(He);++Ze<He;)bt[Ze]=it(Ze);return bt}function Dc(He,it){return fi(it,function(Ze){return[Ze,He[Ze]]})}function la(He){return He&&He.slice(0,ha(He)+1).replace(Ge,"")}function en(He){return function(it){return He(it)}}function qr(He,it){return fi(it,function(Ze){return He[Ze]})}function ys(He,it){return He.has(it)}function ca(He,it){for(var Ze=-1,bt=He.length;++Ze<bt&&ls(it,He[Ze],0)>-1;);return Ze}function da(He,it){for(var Ze=He.length;Ze--&&ls(it,He[Ze],0)>-1;);return Ze}function Nc(He,it){for(var Ze=He.length,bt=0;Ze--;)He[Ze]===it&&++bt;return bt}var Rc=Hr(pc),Ac=Hr(mc);function Mc(He){return"\\"+bc[He]}function Oc(He,it){return He==null?D:He[it]}function cs(He){return uc.test(He)}function Pc(He){return hc.test(He)}function Fc(He){for(var it,Ze=[];!(it=He.next()).done;)Ze.push(it.value);return Ze}function Gr(He){var it=-1,Ze=Array(He.size);return He.forEach(function(bt,Ot){Ze[++it]=[Ot,bt]}),Ze}function ua(He,it){return function(Ze){return He(it(Ze))}}function Wn(He,it){for(var Ze=-1,bt=He.length,Ot=0,ti=[];++Ze<bt;){var Ri=He[Ze];(Ri===it||Ri===Y)&&(He[Ze]=Y,ti[Ot++]=Ze)}return ti}function qs(He){var it=-1,Ze=Array(He.size);return He.forEach(function(bt){Ze[++it]=bt}),Ze}function $c(He){var it=-1,Ze=Array(He.size);return He.forEach(function(bt){Ze[++it]=[bt,bt]}),Ze}function Bc(He,it,Ze){for(var bt=Ze-1,Ot=He.length;++bt<Ot;)if(He[bt]===it)return bt;return-1}function Wc(He,it,Ze){for(var bt=Ze+1;bt--;)if(He[bt]===it)return bt;return bt}function ds(He){return cs(He)?Vc(He):Lc(He)}function pn(He){return cs(He)?Hc(He):xc(He)}function ha(He){for(var it=He.length;it--&&Xe.test(He.charAt(it)););return it}var zc=Hr(_c);function Vc(He){for(var it=Pr.lastIndex=0;Pr.test(He);)++it;return it}function Hc(He){return He.match(Pr)||[]}function Uc(He){return He.match(dc)||[]}var Kc=function He(it){it=it==null?Fi:us.defaults(Fi.Object(),it,us.pick(Fi,gc));var Ze=it.Array,bt=it.Date,Ot=it.Error,ti=it.Function,Ri=it.Math,li=it.Object,jr=it.RegExp,qc=it.String,ln=it.TypeError,Gs=Ze.prototype,Gc=ti.prototype,hs=li.prototype,js=it["__core-js_shared__"],Qs=Gc.toString,ai=hs.hasOwnProperty,jc=0,ga=function(){var ee=/[^.]+$/.exec(js&&js.keys&&js.keys.IE_PROTO||"");return ee?"Symbol(src)_1."+ee:""}(),Ys=hs.toString,Qc=Qs.call(li),Yc=Fi._,Zc=jr("^"+Qs.call(ai).replace(Pe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zs=Yo?it.Buffer:D,zn=it.Symbol,Xs=it.Uint8Array,fa=Zs?Zs.allocUnsafe:D,Js=ua(li.getPrototypeOf,li),pa=li.create,ma=hs.propertyIsEnumerable,er=Gs.splice,ba=zn?zn.isConcatSpreadable:D,Es=zn?zn.iterator:D,Yn=zn?zn.toStringTag:D,tr=function(){try{var ee=ts(li,"defineProperty");return ee({},"",{}),ee}catch{}}(),Xc=it.clearTimeout!==Fi.clearTimeout&&it.clearTimeout,Jc=bt&&bt.now!==Fi.Date.now&&bt.now,ed=it.setTimeout!==Fi.setTimeout&&it.setTimeout,ir=Ri.ceil,nr=Ri.floor,Qr=li.getOwnPropertySymbols,td=Zs?Zs.isBuffer:D,Ca=it.isFinite,id=Gs.join,nd=ua(li.keys,li),Ai=Ri.max,Bi=Ri.min,sd=bt.now,rd=it.parseInt,va=Ri.random,od=Gs.reverse,Yr=ts(it,"DataView"),Ls=ts(it,"Map"),Zr=ts(it,"Promise"),gs=ts(it,"Set"),xs=ts(it,"WeakMap"),ks=ts(li,"create"),sr=xs&&new xs,fs={},ad=is(Yr),ld=is(Ls),cd=is(Zr),dd=is(gs),ud=is(xs),rr=zn?zn.prototype:D,Is=rr?rr.valueOf:D,Sa=rr?rr.toString:D;function ye(ee){if(wi(ee)&&!Ft(ee)&&!(ee instanceof Gt)){if(ee instanceof cn)return ee;if(ai.call(ee,"__wrapped__"))return wl(ee)}return new cn(ee)}var ps=function(){function ee(){}return function(ne){if(!bi(ne))return{};if(pa)return pa(ne);ee.prototype=ne;var ce=new ee;return ee.prototype=D,ce}}();function ar(){}function cn(ee,ne){this.__wrapped__=ee,this.__actions__=[],this.__chain__=!!ne,this.__index__=0,this.__values__=D}ye.templateSettings={escape:Pn,evaluate:Cn,interpolate:xt,variable:"",imports:{_:ye}},ye.prototype=ar.prototype,ye.prototype.constructor=ye,cn.prototype=ps(ar.prototype),cn.prototype.constructor=cn;function Gt(ee){this.__wrapped__=ee,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=lt,this.__views__=[]}function hd(){var ee=new Gt(this.__wrapped__);return ee.__actions__=Gi(this.__actions__),ee.__dir__=this.__dir__,ee.__filtered__=this.__filtered__,ee.__iteratees__=Gi(this.__iteratees__),ee.__takeCount__=this.__takeCount__,ee.__views__=Gi(this.__views__),ee}function gd(){if(this.__filtered__){var ee=new Gt(this);ee.__dir__=-1,ee.__filtered__=!0}else ee=this.clone(),ee.__dir__*=-1;return ee}function fd(){var ee=this.__wrapped__.value(),ne=this.__dir__,ce=Ft(ee),me=ne<0,ve=ce?ee.length:0,Le=xu(0,ve,this.__views__),Ae=Le.start,Be=Le.end,Ue=Be-Ae,rt=me?Be:Ae-1,ot=this.__iteratees__,ct=ot.length,ft=0,yt=Bi(Ue,this.__takeCount__);if(!ce||!me&&ve==Ue&&yt==Ue)return Ka(ee,this.__actions__);var Rt=[];e:for(;Ue--&&ft<yt;){rt+=ne;for(var Vt=-1,At=ee[rt];++Vt<ct;){var Kt=ot[Vt],Qt=Kt.iteratee,sn=Kt.type,Ui=Qt(At);if(sn==ze)At=Ui;else if(!Ui){if(sn==Ne)continue e;break e}}Rt[ft++]=At}return Rt}Gt.prototype=ps(ar.prototype),Gt.prototype.constructor=Gt;function Zn(ee){var ne=-1,ce=ee==null?0:ee.length;for(this.clear();++ne<ce;){var me=ee[ne];this.set(me[0],me[1])}}function pd(){this.__data__=ks?ks(null):{},this.size=0}function md(ee){var ne=this.has(ee)&&delete this.__data__[ee];return this.size-=ne?1:0,ne}function _d(ee){var ne=this.__data__;if(ks){var ce=ne[ee];return ce===G?D:ce}return ai.call(ne,ee)?ne[ee]:D}function bd(ee){var ne=this.__data__;return ks?ne[ee]!==D:ai.call(ne,ee)}function Cd(ee,ne){var ce=this.__data__;return this.size+=this.has(ee)?0:1,ce[ee]=ks&&ne===D?G:ne,this}Zn.prototype.clear=pd,Zn.prototype.delete=md,Zn.prototype.get=_d,Zn.prototype.has=bd,Zn.prototype.set=Cd;function Ln(ee){var ne=-1,ce=ee==null?0:ee.length;for(this.clear();++ne<ce;){var me=ee[ne];this.set(me[0],me[1])}}function vd(){this.__data__=[],this.size=0}function Sd(ee){var ne=this.__data__,ce=lr(ne,ee);if(ce<0)return!1;var me=ne.length-1;return ce==me?ne.pop():er.call(ne,ce,1),--this.size,!0}function wd(ee){var ne=this.__data__,ce=lr(ne,ee);return ce<0?D:ne[ce][1]}function yd(ee){return lr(this.__data__,ee)>-1}function Ed(ee,ne){var ce=this.__data__,me=lr(ce,ee);return me<0?(++this.size,ce.push([ee,ne])):ce[me][1]=ne,this}Ln.prototype.clear=vd,Ln.prototype.delete=Sd,Ln.prototype.get=wd,Ln.prototype.has=yd,Ln.prototype.set=Ed;function xn(ee){var ne=-1,ce=ee==null?0:ee.length;for(this.clear();++ne<ce;){var me=ee[ne];this.set(me[0],me[1])}}function Ld(){this.size=0,this.__data__={hash:new Zn,map:new(Ls||Ln),string:new Zn}}function xd(ee){var ne=vr(this,ee).delete(ee);return this.size-=ne?1:0,ne}function kd(ee){return vr(this,ee).get(ee)}function Id(ee){return vr(this,ee).has(ee)}function Td(ee,ne){var ce=vr(this,ee),me=ce.size;return ce.set(ee,ne),this.size+=ce.size==me?0:1,this}xn.prototype.clear=Ld,xn.prototype.delete=xd,xn.prototype.get=kd,xn.prototype.has=Id,xn.prototype.set=Td;function Xn(ee){var ne=-1,ce=ee==null?0:ee.length;for(this.__data__=new xn;++ne<ce;)this.add(ee[ne])}function Dd(ee){return this.__data__.set(ee,G),this}function Nd(ee){return this.__data__.has(ee)}Xn.prototype.add=Xn.prototype.push=Dd,Xn.prototype.has=Nd;function mn(ee){var ne=this.__data__=new Ln(ee);this.size=ne.size}function Rd(){this.__data__=new Ln,this.size=0}function Ad(ee){var ne=this.__data__,ce=ne.delete(ee);return this.size=ne.size,ce}function Md(ee){return this.__data__.get(ee)}function Od(ee){return this.__data__.has(ee)}function Pd(ee,ne){var ce=this.__data__;if(ce instanceof Ln){var me=ce.__data__;if(!Ls||me.length<W-1)return me.push([ee,ne]),this.size=++ce.size,this;ce=this.__data__=new xn(me)}return ce.set(ee,ne),this.size=ce.size,this}mn.prototype.clear=Rd,mn.prototype.delete=Ad,mn.prototype.get=Md,mn.prototype.has=Od,mn.prototype.set=Pd;function wa(ee,ne){var ce=Ft(ee),me=!ce&&ns(ee),ve=!ce&&!me&&qn(ee),Le=!ce&&!me&&!ve&&Cs(ee),Ae=ce||me||ve||Le,Be=Ae?Kr(ee.length,qc):[],Ue=Be.length;for(var rt in ee)(ne||ai.call(ee,rt))&&!(Ae&&(rt=="length"||ve&&(rt=="offset"||rt=="parent")||Le&&(rt=="buffer"||rt=="byteLength"||rt=="byteOffset")||Dn(rt,Ue)))&&Be.push(rt);return Be}function ya(ee){var ne=ee.length;return ne?ee[lo(0,ne-1)]:D}function Fd(ee,ne){return Sr(Gi(ee),Jn(ne,0,ee.length))}function $d(ee){return Sr(Gi(ee))}function Xr(ee,ne,ce){(ce!==D&&!_n(ee[ne],ce)||ce===D&&!(ne in ee))&&kn(ee,ne,ce)}function Ts(ee,ne,ce){var me=ee[ne];(!(ai.call(ee,ne)&&_n(me,ce))||ce===D&&!(ne in ee))&&kn(ee,ne,ce)}function lr(ee,ne){for(var ce=ee.length;ce--;)if(_n(ee[ce][0],ne))return ce;return-1}function Bd(ee,ne,ce,me){return Vn(ee,function(ve,Le,Ae){ne(me,ve,ce(ve),Ae)}),me}function Ea(ee,ne){return ee&&Sn(ne,Oi(ne),ee)}function Wd(ee,ne){return ee&&Sn(ne,Qi(ne),ee)}function kn(ee,ne,ce){ne=="__proto__"&&tr?tr(ee,ne,{configurable:!0,enumerable:!0,value:ce,writable:!0}):ee[ne]=ce}function Jr(ee,ne){for(var ce=-1,me=ne.length,ve=Ze(me),Le=ee==null;++ce<me;)ve[ce]=Le?D:Mo(ee,ne[ce]);return ve}function Jn(ee,ne,ce){return ee===ee&&(ce!==D&&(ee=ee<=ce?ee:ce),ne!==D&&(ee=ee>=ne?ee:ne)),ee}function dn(ee,ne,ce,me,ve,Le){var Ae,Be=ne&X,Ue=ne&J,rt=ne&te;if(ce&&(Ae=ve?ce(ee,me,ve,Le):ce(ee)),Ae!==D)return Ae;if(!bi(ee))return ee;var ot=Ft(ee);if(ot){if(Ae=Iu(ee),!Be)return Gi(ee,Ae)}else{var ct=Wi(ee),ft=ct==ii||ct==Ci;if(qn(ee))return ja(ee,Be);if(ct==jt||ct==et||ft&&!ve){if(Ae=Ue||ft?{}:gl(ee),!Be)return Ue?_u(ee,Wd(Ae,ee)):mu(ee,Ea(Ae,ee))}else{if(!ci[ct])return ve?ee:{};Ae=Tu(ee,ct,Be)}}Le||(Le=new mn);var yt=Le.get(ee);if(yt)return yt;Le.set(ee,Ae),Vl(ee)?ee.forEach(function(At){Ae.add(dn(At,ne,ce,At,ee,Le))}):Wl(ee)&&ee.forEach(function(At,Kt){Ae.set(Kt,dn(At,ne,ce,Kt,ee,Le))});var Rt=rt?Ue?vo:Co:Ue?Qi:Oi,Vt=ot?D:Rt(ee);return an(Vt||ee,function(At,Kt){Vt&&(Kt=At,At=ee[Kt]),Ts(Ae,Kt,dn(At,ne,ce,Kt,ee,Le))}),Ae}function zd(ee){var ne=Oi(ee);return function(ce){return La(ce,ee,ne)}}function La(ee,ne,ce){var me=ce.length;if(ee==null)return!me;for(ee=li(ee);me--;){var ve=ce[me],Le=ne[ve],Ae=ee[ve];if(Ae===D&&!(ve in ee)||!Le(Ae))return!1}return!0}function xa(ee,ne,ce){if(typeof ee!="function")throw new ln(K);return Ps(function(){ee.apply(D,ce)},ne)}function Ds(ee,ne,ce,me){var ve=-1,Le=Us,Ae=!0,Be=ee.length,Ue=[],rt=ne.length;if(!Be)return Ue;ce&&(ne=fi(ne,en(ce))),me?(Le=Br,Ae=!1):ne.length>=W&&(Le=ys,Ae=!1,ne=new Xn(ne));e:for(;++ve<Be;){var ot=ee[ve],ct=ce==null?ot:ce(ot);if(ot=me||ot!==0?ot:0,Ae&&ct===ct){for(var ft=rt;ft--;)if(ne[ft]===ct)continue e;Ue.push(ot)}else Le(ne,ct,me)||Ue.push(ot)}return Ue}var Vn=Ja(vn),ka=Ja(to,!0);function Vd(ee,ne){var ce=!0;return Vn(ee,function(me,ve,Le){return ce=!!ne(me,ve,Le),ce}),ce}function cr(ee,ne,ce){for(var me=-1,ve=ee.length;++me<ve;){var Le=ee[me],Ae=ne(Le);if(Ae!=null&&(Be===D?Ae===Ae&&!nn(Ae):ce(Ae,Be)))var Be=Ae,Ue=Le}return Ue}function Hd(ee,ne,ce,me){var ve=ee.length;for(ce=Wt(ce),ce<0&&(ce=-ce>ve?0:ve+ce),me=me===D||me>ve?ve:Wt(me),me<0&&(me+=ve),me=ce>me?0:Ul(me);ce<me;)ee[ce++]=ne;return ee}function Ia(ee,ne){var ce=[];return Vn(ee,function(me,ve,Le){ne(me,ve,Le)&&ce.push(me)}),ce}function $i(ee,ne,ce,me,ve){var Le=-1,Ae=ee.length;for(ce||(ce=Nu),ve||(ve=[]);++Le<Ae;){var Be=ee[Le];ne>0&&ce(Be)?ne>1?$i(Be,ne-1,ce,me,ve):Bn(ve,Be):me||(ve[ve.length]=Be)}return ve}var eo=el(),Ta=el(!0);function vn(ee,ne){return ee&&eo(ee,ne,Oi)}function to(ee,ne){return ee&&Ta(ee,ne,Oi)}function dr(ee,ne){return $n(ne,function(ce){return Nn(ee[ce])})}function es(ee,ne){ne=Un(ne,ee);for(var ce=0,me=ne.length;ee!=null&&ce<me;)ee=ee[wn(ne[ce++])];return ce&&ce==me?ee:D}function Da(ee,ne,ce){var me=ne(ee);return Ft(ee)?me:Bn(me,ce(ee))}function Vi(ee){return ee==null?ee===D?Ii:hi:Yn&&Yn in li(ee)?Lu(ee):$u(ee)}function io(ee,ne){return ee>ne}function Ud(ee,ne){return ee!=null&&ai.call(ee,ne)}function Kd(ee,ne){return ee!=null&&ne in li(ee)}function qd(ee,ne,ce){return ee>=Bi(ne,ce)&&ee<Ai(ne,ce)}function no(ee,ne,ce){for(var me=ce?Br:Us,ve=ee[0].length,Le=ee.length,Ae=Le,Be=Ze(Le),Ue=1/0,rt=[];Ae--;){var ot=ee[Ae];Ae&&ne&&(ot=fi(ot,en(ne))),Ue=Bi(ot.length,Ue),Be[Ae]=!ce&&(ne||ve>=120&&ot.length>=120)?new Xn(Ae&&ot):D}ot=ee[0];var ct=-1,ft=Be[0];e:for(;++ct<ve&&rt.length<Ue;){var yt=ot[ct],Rt=ne?ne(yt):yt;if(yt=ce||yt!==0?yt:0,!(ft?ys(ft,Rt):me(rt,Rt,ce))){for(Ae=Le;--Ae;){var Vt=Be[Ae];if(!(Vt?ys(Vt,Rt):me(ee[Ae],Rt,ce)))continue e}ft&&ft.push(Rt),rt.push(yt)}}return rt}function Gd(ee,ne,ce,me){return vn(ee,function(ve,Le,Ae){ne(me,ce(ve),Le,Ae)}),me}function Ns(ee,ne,ce){ne=Un(ne,ee),ee=_l(ee,ne);var me=ee==null?ee:ee[wn(hn(ne))];return me==null?D:Ji(me,ee,ce)}function Na(ee){return wi(ee)&&Vi(ee)==et}function jd(ee){return wi(ee)&&Vi(ee)==Lt}function Qd(ee){return wi(ee)&&Vi(ee)==Ct}function Rs(ee,ne,ce,me,ve){return ee===ne?!0:ee==null||ne==null||!wi(ee)&&!wi(ne)?ee!==ee&&ne!==ne:Yd(ee,ne,ce,me,Rs,ve)}function Yd(ee,ne,ce,me,ve,Le){var Ae=Ft(ee),Be=Ft(ne),Ue=Ae?mt:Wi(ee),rt=Be?mt:Wi(ne);Ue=Ue==et?jt:Ue,rt=rt==et?jt:rt;var ot=Ue==jt,ct=rt==jt,ft=Ue==rt;if(ft&&qn(ee)){if(!qn(ne))return!1;Ae=!0,ot=!1}if(ft&&!ot)return Le||(Le=new mn),Ae||Cs(ee)?dl(ee,ne,ce,me,ve,Le):yu(ee,ne,Ue,ce,me,ve,Le);if(!(ce&ie)){var yt=ot&&ai.call(ee,"__wrapped__"),Rt=ct&&ai.call(ne,"__wrapped__");if(yt||Rt){var Vt=yt?ee.value():ee,At=Rt?ne.value():ne;return Le||(Le=new mn),ve(Vt,At,ce,me,Le)}}return ft?(Le||(Le=new mn),Eu(ee,ne,ce,me,ve,Le)):!1}function Zd(ee){return wi(ee)&&Wi(ee)==ni}function so(ee,ne,ce,me){var ve=ce.length,Le=ve,Ae=!me;if(ee==null)return!Le;for(ee=li(ee);ve--;){var Be=ce[ve];if(Ae&&Be[2]?Be[1]!==ee[Be[0]]:!(Be[0]in ee))return!1}for(;++ve<Le;){Be=ce[ve];var Ue=Be[0],rt=ee[Ue],ot=Be[1];if(Ae&&Be[2]){if(rt===D&&!(Ue in ee))return!1}else{var ct=new mn;if(me)var ft=me(rt,ot,Ue,ee,ne,ct);if(!(ft===D?Rs(ot,rt,ie|se,me,ct):ft))return!1}}return!0}function Ra(ee){if(!bi(ee)||Au(ee))return!1;var ne=Nn(ee)?Zc:vt;return ne.test(is(ee))}function Xd(ee){return wi(ee)&&Vi(ee)==pi}function Jd(ee){return wi(ee)&&Wi(ee)==mi}function eu(ee){return wi(ee)&&kr(ee.length)&&!!ui[Vi(ee)]}function Aa(ee){return typeof ee=="function"?ee:ee==null?Yi:typeof ee=="object"?Ft(ee)?Pa(ee[0],ee[1]):Oa(ee):tc(ee)}function ro(ee){if(!Os(ee))return nd(ee);var ne=[];for(var ce in li(ee))ai.call(ee,ce)&&ce!="constructor"&&ne.push(ce);return ne}function tu(ee){if(!bi(ee))return Fu(ee);var ne=Os(ee),ce=[];for(var me in ee)me=="constructor"&&(ne||!ai.call(ee,me))||ce.push(me);return ce}function oo(ee,ne){return ee<ne}function Ma(ee,ne){var ce=-1,me=ji(ee)?Ze(ee.length):[];return Vn(ee,function(ve,Le,Ae){me[++ce]=ne(ve,Le,Ae)}),me}function Oa(ee){var ne=wo(ee);return ne.length==1&&ne[0][2]?pl(ne[0][0],ne[0][1]):function(ce){return ce===ee||so(ce,ee,ne)}}function Pa(ee,ne){return Eo(ee)&&fl(ne)?pl(wn(ee),ne):function(ce){var me=Mo(ce,ee);return me===D&&me===ne?Oo(ce,ee):Rs(ne,me,ie|se)}}function ur(ee,ne,ce,me,ve){ee!==ne&&eo(ne,function(Le,Ae){if(ve||(ve=new mn),bi(Le))iu(ee,ne,Ae,ce,ur,me,ve);else{var Be=me?me(xo(ee,Ae),Le,Ae+"",ee,ne,ve):D;Be===D&&(Be=Le),Xr(ee,Ae,Be)}},Qi)}function iu(ee,ne,ce,me,ve,Le,Ae){var Be=xo(ee,ce),Ue=xo(ne,ce),rt=Ae.get(Ue);if(rt){Xr(ee,ce,rt);return}var ot=Le?Le(Be,Ue,ce+"",ee,ne,Ae):D,ct=ot===D;if(ct){var ft=Ft(Ue),yt=!ft&&qn(Ue),Rt=!ft&&!yt&&Cs(Ue);ot=Ue,ft||yt||Rt?Ft(Be)?ot=Be:Ei(Be)?ot=Gi(Be):yt?(ct=!1,ot=ja(Ue,!0)):Rt?(ct=!1,ot=Qa(Ue,!0)):ot=[]:Fs(Ue)||ns(Ue)?(ot=Be,ns(Be)?ot=Kl(Be):(!bi(Be)||Nn(Be))&&(ot=gl(Ue))):ct=!1}ct&&(Ae.set(Ue,ot),ve(ot,Ue,me,Le,Ae),Ae.delete(Ue)),Xr(ee,ce,ot)}function Fa(ee,ne){var ce=ee.length;if(ce)return ne+=ne<0?ce:0,Dn(ne,ce)?ee[ne]:D}function $a(ee,ne,ce){ne.length?ne=fi(ne,function(Le){return Ft(Le)?function(Ae){return es(Ae,Le.length===1?Le[0]:Le)}:Le}):ne=[Yi];var me=-1;ne=fi(ne,en(Dt()));var ve=Ma(ee,function(Le,Ae,Be){var Ue=fi(ne,function(rt){return rt(Le)});return{criteria:Ue,index:++me,value:Le}});return Tc(ve,function(Le,Ae){return pu(Le,Ae,ce)})}function nu(ee,ne){return Ba(ee,ne,function(ce,me){return Oo(ee,me)})}function Ba(ee,ne,ce){for(var me=-1,ve=ne.length,Le={};++me<ve;){var Ae=ne[me],Be=es(ee,Ae);ce(Be,Ae)&&As(Le,Un(Ae,ee),Be)}return Le}function su(ee){return function(ne){return es(ne,ee)}}function ao(ee,ne,ce,me){var ve=me?Ic:ls,Le=-1,Ae=ne.length,Be=ee;for(ee===ne&&(ne=Gi(ne)),ce&&(Be=fi(ee,en(ce)));++Le<Ae;)for(var Ue=0,rt=ne[Le],ot=ce?ce(rt):rt;(Ue=ve(Be,ot,Ue,me))>-1;)Be!==ee&&er.call(Be,Ue,1),er.call(ee,Ue,1);return ee}function Wa(ee,ne){for(var ce=ee?ne.length:0,me=ce-1;ce--;){var ve=ne[ce];if(ce==me||ve!==Le){var Le=ve;Dn(ve)?er.call(ee,ve,1):ho(ee,ve)}}return ee}function lo(ee,ne){return ee+nr(va()*(ne-ee+1))}function ru(ee,ne,ce,me){for(var ve=-1,Le=Ai(ir((ne-ee)/(ce||1)),0),Ae=Ze(Le);Le--;)Ae[me?Le:++ve]=ee,ee+=ce;return Ae}function co(ee,ne){var ce="";if(!ee||ne<1||ne>Je)return ce;do ne%2&&(ce+=ee),ne=nr(ne/2),ne&&(ee+=ee);while(ne);return ce}function Ut(ee,ne){return ko(ml(ee,ne,Yi),ee+"")}function ou(ee){return ya(Ss(ee))}function au(ee,ne){var ce=Ss(ee);return Sr(ce,Jn(ne,0,ce.length))}function As(ee,ne,ce,me){if(!bi(ee))return ee;ne=Un(ne,ee);for(var ve=-1,Le=ne.length,Ae=Le-1,Be=ee;Be!=null&&++ve<Le;){var Ue=wn(ne[ve]),rt=ce;if(Ue==="__proto__"||Ue==="constructor"||Ue==="prototype")return ee;if(ve!=Ae){var ot=Be[Ue];rt=me?me(ot,Ue,Be):D,rt===D&&(rt=bi(ot)?ot:Dn(ne[ve+1])?[]:{})}Ts(Be,Ue,rt),Be=Be[Ue]}return ee}var za=sr?function(ee,ne){return sr.set(ee,ne),ee}:Yi,lu=tr?function(ee,ne){return tr(ee,"toString",{configurable:!0,enumerable:!1,value:Fo(ne),writable:!0})}:Yi;function cu(ee){return Sr(Ss(ee))}function un(ee,ne,ce){var me=-1,ve=ee.length;ne<0&&(ne=-ne>ve?0:ve+ne),ce=ce>ve?ve:ce,ce<0&&(ce+=ve),ve=ne>ce?0:ce-ne>>>0,ne>>>=0;for(var Le=Ze(ve);++me<ve;)Le[me]=ee[me+ne];return Le}function du(ee,ne){var ce;return Vn(ee,function(me,ve,Le){return ce=ne(me,ve,Le),!ce}),!!ce}function hr(ee,ne,ce){var me=0,ve=ee==null?me:ee.length;if(typeof ne=="number"&&ne===ne&&ve<=Ke){for(;me<ve;){var Le=me+ve>>>1,Ae=ee[Le];Ae!==null&&!nn(Ae)&&(ce?Ae<=ne:Ae<ne)?me=Le+1:ve=Le}return ve}return uo(ee,ne,Yi,ce)}function uo(ee,ne,ce,me){var ve=0,Le=ee==null?0:ee.length;if(Le===0)return 0;ne=ce(ne);for(var Ae=ne!==ne,Be=ne===null,Ue=nn(ne),rt=ne===D;ve<Le;){var ot=nr((ve+Le)/2),ct=ce(ee[ot]),ft=ct!==D,yt=ct===null,Rt=ct===ct,Vt=nn(ct);if(Ae)var At=me||Rt;else rt?At=Rt&&(me||ft):Be?At=Rt&&ft&&(me||!yt):Ue?At=Rt&&ft&&!yt&&(me||!Vt):yt||Vt?At=!1:At=me?ct<=ne:ct<ne;At?ve=ot+1:Le=ot}return Bi(Le,Tt)}function Va(ee,ne){for(var ce=-1,me=ee.length,ve=0,Le=[];++ce<me;){var Ae=ee[ce],Be=ne?ne(Ae):Ae;if(!ce||!_n(Be,Ue)){var Ue=Be;Le[ve++]=Ae===0?0:Ae}}return Le}function Ha(ee){return typeof ee=="number"?ee:nn(ee)?st:+ee}function tn(ee){if(typeof ee=="string")return ee;if(Ft(ee))return fi(ee,tn)+"";if(nn(ee))return Sa?Sa.call(ee):"";var ne=ee+"";return ne=="0"&&1/ee==-1/0?"-0":ne}function Hn(ee,ne,ce){var me=-1,ve=Us,Le=ee.length,Ae=!0,Be=[],Ue=Be;if(ce)Ae=!1,ve=Br;else if(Le>=W){var rt=ne?null:Su(ee);if(rt)return qs(rt);Ae=!1,ve=ys,Ue=new Xn}else Ue=ne?[]:Be;e:for(;++me<Le;){var ot=ee[me],ct=ne?ne(ot):ot;if(ot=ce||ot!==0?ot:0,Ae&&ct===ct){for(var ft=Ue.length;ft--;)if(Ue[ft]===ct)continue e;ne&&Ue.push(ct),Be.push(ot)}else ve(Ue,ct,ce)||(Ue!==Be&&Ue.push(ct),Be.push(ot))}return Be}function ho(ee,ne){return ne=Un(ne,ee),ee=_l(ee,ne),ee==null||delete ee[wn(hn(ne))]}function Ua(ee,ne,ce,me){return As(ee,ne,ce(es(ee,ne)),me)}function gr(ee,ne,ce,me){for(var ve=ee.length,Le=me?ve:-1;(me?Le--:++Le<ve)&&ne(ee[Le],Le,ee););return ce?un(ee,me?0:Le,me?Le+1:ve):un(ee,me?Le+1:0,me?ve:Le)}function Ka(ee,ne){var ce=ee;return ce instanceof Gt&&(ce=ce.value()),Wr(ne,function(me,ve){return ve.func.apply(ve.thisArg,Bn([me],ve.args))},ce)}function go(ee,ne,ce){var me=ee.length;if(me<2)return me?Hn(ee[0]):[];for(var ve=-1,Le=Ze(me);++ve<me;)for(var Ae=ee[ve],Be=-1;++Be<me;)Be!=ve&&(Le[ve]=Ds(Le[ve]||Ae,ee[Be],ne,ce));return Hn($i(Le,1),ne,ce)}function qa(ee,ne,ce){for(var me=-1,ve=ee.length,Le=ne.length,Ae={};++me<ve;){var Be=me<Le?ne[me]:D;ce(Ae,ee[me],Be)}return Ae}function fo(ee){return Ei(ee)?ee:[]}function po(ee){return typeof ee=="function"?ee:Yi}function Un(ee,ne){return Ft(ee)?ee:Eo(ee,ne)?[ee]:Sl(oi(ee))}var uu=Ut;function Kn(ee,ne,ce){var me=ee.length;return ce=ce===D?me:ce,!ne&&ce>=me?ee:un(ee,ne,ce)}var Ga=Xc||function(ee){return Fi.clearTimeout(ee)};function ja(ee,ne){if(ne)return ee.slice();var ce=ee.length,me=fa?fa(ce):new ee.constructor(ce);return ee.copy(me),me}function mo(ee){var ne=new ee.constructor(ee.byteLength);return new Xs(ne).set(new Xs(ee)),ne}function hu(ee,ne){var ce=ne?mo(ee.buffer):ee.buffer;return new ee.constructor(ce,ee.byteOffset,ee.byteLength)}function gu(ee){var ne=new ee.constructor(ee.source,Si.exec(ee));return ne.lastIndex=ee.lastIndex,ne}function fu(ee){return Is?li(Is.call(ee)):{}}function Qa(ee,ne){var ce=ne?mo(ee.buffer):ee.buffer;return new ee.constructor(ce,ee.byteOffset,ee.length)}function Ya(ee,ne){if(ee!==ne){var ce=ee!==D,me=ee===null,ve=ee===ee,Le=nn(ee),Ae=ne!==D,Be=ne===null,Ue=ne===ne,rt=nn(ne);if(!Be&&!rt&&!Le&&ee>ne||Le&&Ae&&Ue&&!Be&&!rt||me&&Ae&&Ue||!ce&&Ue||!ve)return 1;if(!me&&!Le&&!rt&&ee<ne||rt&&ce&&ve&&!me&&!Le||Be&&ce&&ve||!Ae&&ve||!Ue)return-1}return 0}function pu(ee,ne,ce){for(var me=-1,ve=ee.criteria,Le=ne.criteria,Ae=ve.length,Be=ce.length;++me<Ae;){var Ue=Ya(ve[me],Le[me]);if(Ue){if(me>=Be)return Ue;var rt=ce[me];return Ue*(rt=="desc"?-1:1)}}return ee.index-ne.index}function Za(ee,ne,ce,me){for(var ve=-1,Le=ee.length,Ae=ce.length,Be=-1,Ue=ne.length,rt=Ai(Le-Ae,0),ot=Ze(Ue+rt),ct=!me;++Be<Ue;)ot[Be]=ne[Be];for(;++ve<Ae;)(ct||ve<Le)&&(ot[ce[ve]]=ee[ve]);for(;rt--;)ot[Be++]=ee[ve++];return ot}function Xa(ee,ne,ce,me){for(var ve=-1,Le=ee.length,Ae=-1,Be=ce.length,Ue=-1,rt=ne.length,ot=Ai(Le-Be,0),ct=Ze(ot+rt),ft=!me;++ve<ot;)ct[ve]=ee[ve];for(var yt=ve;++Ue<rt;)ct[yt+Ue]=ne[Ue];for(;++Ae<Be;)(ft||ve<Le)&&(ct[yt+ce[Ae]]=ee[ve++]);return ct}function Gi(ee,ne){var ce=-1,me=ee.length;for(ne||(ne=Ze(me));++ce<me;)ne[ce]=ee[ce];return ne}function Sn(ee,ne,ce,me){var ve=!ce;ce||(ce={});for(var Le=-1,Ae=ne.length;++Le<Ae;){var Be=ne[Le],Ue=me?me(ce[Be],ee[Be],Be,ce,ee):D;Ue===D&&(Ue=ee[Be]),ve?kn(ce,Be,Ue):Ts(ce,Be,Ue)}return ce}function mu(ee,ne){return Sn(ee,yo(ee),ne)}function _u(ee,ne){return Sn(ee,ul(ee),ne)}function fr(ee,ne){return function(ce,me){var ve=Ft(ce)?wc:Bd,Le=ne?ne():{};return ve(ce,ee,Dt(me,2),Le)}}function ms(ee){return Ut(function(ne,ce){var me=-1,ve=ce.length,Le=ve>1?ce[ve-1]:D,Ae=ve>2?ce[2]:D;for(Le=ee.length>3&&typeof Le=="function"?(ve--,Le):D,Ae&&Hi(ce[0],ce[1],Ae)&&(Le=ve<3?D:Le,ve=1),ne=li(ne);++me<ve;){var Be=ce[me];Be&&ee(ne,Be,me,Le)}return ne})}function Ja(ee,ne){return function(ce,me){if(ce==null)return ce;if(!ji(ce))return ee(ce,me);for(var ve=ce.length,Le=ne?ve:-1,Ae=li(ce);(ne?Le--:++Le<ve)&&me(Ae[Le],Le,Ae)!==!1;);return ce}}function el(ee){return function(ne,ce,me){for(var ve=-1,Le=li(ne),Ae=me(ne),Be=Ae.length;Be--;){var Ue=Ae[ee?Be:++ve];if(ce(Le[Ue],Ue,Le)===!1)break}return ne}}function bu(ee,ne,ce){var me=ne&re,ve=Ms(ee);function Le(){var Ae=this&&this!==Fi&&this instanceof Le?ve:ee;return Ae.apply(me?ce:this,arguments)}return Le}function tl(ee){return function(ne){ne=oi(ne);var ce=cs(ne)?pn(ne):D,me=ce?ce[0]:ne.charAt(0),ve=ce?Kn(ce,1).join(""):ne.slice(1);return me[ee]()+ve}}function _s(ee){return function(ne){return Wr(Jl(Xl(ne).replace(lc,"")),ee,"")}}function Ms(ee){return function(){var ne=arguments;switch(ne.length){case 0:return new ee;case 1:return new ee(ne[0]);case 2:return new ee(ne[0],ne[1]);case 3:return new ee(ne[0],ne[1],ne[2]);case 4:return new ee(ne[0],ne[1],ne[2],ne[3]);case 5:return new ee(ne[0],ne[1],ne[2],ne[3],ne[4]);case 6:return new ee(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5]);case 7:return new ee(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5],ne[6])}var ce=ps(ee.prototype),me=ee.apply(ce,ne);return bi(me)?me:ce}}function Cu(ee,ne,ce){var me=Ms(ee);function ve(){for(var Le=arguments.length,Ae=Ze(Le),Be=Le,Ue=bs(ve);Be--;)Ae[Be]=arguments[Be];var rt=Le<3&&Ae[0]!==Ue&&Ae[Le-1]!==Ue?[]:Wn(Ae,Ue);if(Le-=rt.length,Le<ce)return ol(ee,ne,pr,ve.placeholder,D,Ae,rt,D,D,ce-Le);var ot=this&&this!==Fi&&this instanceof ve?me:ee;return Ji(ot,this,Ae)}return ve}function il(ee){return function(ne,ce,me){var ve=li(ne);if(!ji(ne)){var Le=Dt(ce,3);ne=Oi(ne),ce=function(Be){return Le(ve[Be],Be,ve)}}var Ae=ee(ne,ce,me);return Ae>-1?ve[Le?ne[Ae]:Ae]:D}}function nl(ee){return Tn(function(ne){var ce=ne.length,me=ce,ve=cn.prototype.thru;for(ee&&ne.reverse();me--;){var Le=ne[me];if(typeof Le!="function")throw new ln(K);if(ve&&!Ae&&Cr(Le)=="wrapper")var Ae=new cn([],!0)}for(me=Ae?me:ce;++me<ce;){Le=ne[me];var Be=Cr(Le),Ue=Be=="wrapper"?So(Le):D;Ue&&Lo(Ue[0])&&Ue[1]==(fe|de|ue|Ce)&&!Ue[4].length&&Ue[9]==1?Ae=Ae[Cr(Ue[0])].apply(Ae,Ue[3]):Ae=Le.length==1&&Lo(Le)?Ae[Be]():Ae.thru(Le)}return function(){var rt=arguments,ot=rt[0];if(Ae&&rt.length==1&&Ft(ot))return Ae.plant(ot).value();for(var ct=0,ft=ce?ne[ct].apply(this,rt):ot;++ct<ce;)ft=ne[ct].call(this,ft);return ft}})}function pr(ee,ne,ce,me,ve,Le,Ae,Be,Ue,rt){var ot=ne&fe,ct=ne&re,ft=ne&ae,yt=ne&(de|oe),Rt=ne&we,Vt=ft?D:Ms(ee);function At(){for(var Kt=arguments.length,Qt=Ze(Kt),sn=Kt;sn--;)Qt[sn]=arguments[sn];if(yt)var Ui=bs(At),rn=Nc(Qt,Ui);if(me&&(Qt=Za(Qt,me,ve,yt)),Le&&(Qt=Xa(Qt,Le,Ae,yt)),Kt-=rn,yt&&Kt<rt){var Li=Wn(Qt,Ui);return ol(ee,ne,pr,At.placeholder,ce,Qt,Li,Be,Ue,rt-Kt)}var bn=ct?ce:this,An=ft?bn[ee]:ee;return Kt=Qt.length,Be?Qt=Bu(Qt,Be):Rt&&Kt>1&&Qt.reverse(),ot&&Ue<Kt&&(Qt.length=Ue),this&&this!==Fi&&this instanceof At&&(An=Vt||Ms(An)),An.apply(bn,Qt)}return At}function sl(ee,ne){return function(ce,me){return Gd(ce,ee,ne(me),{})}}function mr(ee,ne){return function(ce,me){var ve;if(ce===D&&me===D)return ne;if(ce!==D&&(ve=ce),me!==D){if(ve===D)return me;typeof ce=="string"||typeof me=="string"?(ce=tn(ce),me=tn(me)):(ce=Ha(ce),me=Ha(me)),ve=ee(ce,me)}return ve}}function _o(ee){return Tn(function(ne){return ne=fi(ne,en(Dt())),Ut(function(ce){var me=this;return ee(ne,function(ve){return Ji(ve,me,ce)})})})}function _r(ee,ne){ne=ne===D?" ":tn(ne);var ce=ne.length;if(ce<2)return ce?co(ne,ee):ne;var me=co(ne,ir(ee/ds(ne)));return cs(ne)?Kn(pn(me),0,ee).join(""):me.slice(0,ee)}function vu(ee,ne,ce,me){var ve=ne&re,Le=Ms(ee);function Ae(){for(var Be=-1,Ue=arguments.length,rt=-1,ot=me.length,ct=Ze(ot+Ue),ft=this&&this!==Fi&&this instanceof Ae?Le:ee;++rt<ot;)ct[rt]=me[rt];for(;Ue--;)ct[rt++]=arguments[++Be];return Ji(ft,ve?ce:this,ct)}return Ae}function rl(ee){return function(ne,ce,me){return me&&typeof me!="number"&&Hi(ne,ce,me)&&(ce=me=D),ne=Rn(ne),ce===D?(ce=ne,ne=0):ce=Rn(ce),me=me===D?ne<ce?1:-1:Rn(me),ru(ne,ce,me,ee)}}function br(ee){return function(ne,ce){return typeof ne=="string"&&typeof ce=="string"||(ne=gn(ne),ce=gn(ce)),ee(ne,ce)}}function ol(ee,ne,ce,me,ve,Le,Ae,Be,Ue,rt){var ot=ne&de,ct=ot?Ae:D,ft=ot?D:Ae,yt=ot?Le:D,Rt=ot?D:Le;ne|=ot?ue:pe,ne&=~(ot?pe:ue),ne&le||(ne&=-4);var Vt=[ee,ne,ve,yt,ct,Rt,ft,Be,Ue,rt],At=ce.apply(D,Vt);return Lo(ee)&&bl(At,Vt),At.placeholder=me,Cl(At,ee,ne)}function bo(ee){var ne=Ri[ee];return function(ce,me){if(ce=gn(ce),me=me==null?0:Bi(Wt(me),292),me&&Ca(ce)){var ve=(oi(ce)+"e").split("e"),Le=ne(ve[0]+"e"+(+ve[1]+me));return ve=(oi(Le)+"e").split("e"),+(ve[0]+"e"+(+ve[1]-me))}return ne(ce)}}var Su=gs&&1/qs(new gs([,-0]))[1]==Ye?function(ee){return new gs(ee)}:Wo;function al(ee){return function(ne){var ce=Wi(ne);return ce==ni?Gr(ne):ce==mi?$c(ne):Dc(ne,ee(ne))}}function In(ee,ne,ce,me,ve,Le,Ae,Be){var Ue=ne&ae;if(!Ue&&typeof ee!="function")throw new ln(K);var rt=me?me.length:0;if(rt||(ne&=-97,me=ve=D),Ae=Ae===D?Ae:Ai(Wt(Ae),0),Be=Be===D?Be:Wt(Be),rt-=ve?ve.length:0,ne&pe){var ot=me,ct=ve;me=ve=D}var ft=Ue?D:So(ee),yt=[ee,ne,ce,me,ve,ot,ct,Le,Ae,Be];if(ft&&Pu(yt,ft),ee=yt[0],ne=yt[1],ce=yt[2],me=yt[3],ve=yt[4],Be=yt[9]=yt[9]===D?Ue?0:ee.length:Ai(yt[9]-rt,0),!Be&&ne&(de|oe)&&(ne&=-25),!ne||ne==re)var Rt=bu(ee,ne,ce);else ne==de||ne==oe?Rt=Cu(ee,ne,Be):(ne==ue||ne==(re|ue))&&!ve.length?Rt=vu(ee,ne,ce,me):Rt=pr.apply(D,yt);var Vt=ft?za:bl;return Cl(Vt(Rt,yt),ee,ne)}function ll(ee,ne,ce,me){return ee===D||_n(ee,hs[ce])&&!ai.call(me,ce)?ne:ee}function cl(ee,ne,ce,me,ve,Le){return bi(ee)&&bi(ne)&&(Le.set(ne,ee),ur(ee,ne,D,cl,Le),Le.delete(ne)),ee}function wu(ee){return Fs(ee)?D:ee}function dl(ee,ne,ce,me,ve,Le){var Ae=ce&ie,Be=ee.length,Ue=ne.length;if(Be!=Ue&&!(Ae&&Ue>Be))return!1;var rt=Le.get(ee),ot=Le.get(ne);if(rt&&ot)return rt==ne&&ot==ee;var ct=-1,ft=!0,yt=ce&se?new Xn:D;for(Le.set(ee,ne),Le.set(ne,ee);++ct<Be;){var Rt=ee[ct],Vt=ne[ct];if(me)var At=Ae?me(Vt,Rt,ct,ne,ee,Le):me(Rt,Vt,ct,ee,ne,Le);if(At!==D){if(At)continue;ft=!1;break}if(yt){if(!zr(ne,function(Kt,Qt){if(!ys(yt,Qt)&&(Rt===Kt||ve(Rt,Kt,ce,me,Le)))return yt.push(Qt)})){ft=!1;break}}else if(!(Rt===Vt||ve(Rt,Vt,ce,me,Le))){ft=!1;break}}return Le.delete(ee),Le.delete(ne),ft}function yu(ee,ne,ce,me,ve,Le,Ae){switch(ce){case St:if(ee.byteLength!=ne.byteLength||ee.byteOffset!=ne.byteOffset)return!1;ee=ee.buffer,ne=ne.buffer;case Lt:return!(ee.byteLength!=ne.byteLength||!Le(new Xs(ee),new Xs(ne)));case Et:case Ct:case vi:return _n(+ee,+ne);case zt:return ee.name==ne.name&&ee.message==ne.message;case pi:case kt:return ee==ne+"";case ni:var Be=Gr;case mi:var Ue=me&ie;if(Be||(Be=qs),ee.size!=ne.size&&!Ue)return!1;var rt=Ae.get(ee);if(rt)return rt==ne;me|=se,Ae.set(ee,ne);var ot=dl(Be(ee),Be(ne),me,ve,Le,Ae);return Ae.delete(ee),ot;case ki:if(Is)return Is.call(ee)==Is.call(ne)}return!1}function Eu(ee,ne,ce,me,ve,Le){var Ae=ce&ie,Be=Co(ee),Ue=Be.length,rt=Co(ne),ot=rt.length;if(Ue!=ot&&!Ae)return!1;for(var ct=Ue;ct--;){var ft=Be[ct];if(!(Ae?ft in ne:ai.call(ne,ft)))return!1}var yt=Le.get(ee),Rt=Le.get(ne);if(yt&&Rt)return yt==ne&&Rt==ee;var Vt=!0;Le.set(ee,ne),Le.set(ne,ee);for(var At=Ae;++ct<Ue;){ft=Be[ct];var Kt=ee[ft],Qt=ne[ft];if(me)var sn=Ae?me(Qt,Kt,ft,ne,ee,Le):me(Kt,Qt,ft,ee,ne,Le);if(!(sn===D?Kt===Qt||ve(Kt,Qt,ce,me,Le):sn)){Vt=!1;break}At||(At=ft=="constructor")}if(Vt&&!At){var Ui=ee.constructor,rn=ne.constructor;Ui!=rn&&"constructor"in ee&&"constructor"in ne&&!(typeof Ui=="function"&&Ui instanceof Ui&&typeof rn=="function"&&rn instanceof rn)&&(Vt=!1)}return Le.delete(ee),Le.delete(ne),Vt}function Tn(ee){return ko(ml(ee,D,Ll),ee+"")}function Co(ee){return Da(ee,Oi,yo)}function vo(ee){return Da(ee,Qi,ul)}var So=sr?function(ee){return sr.get(ee)}:Wo;function Cr(ee){for(var ne=ee.name+"",ce=fs[ne],me=ai.call(fs,ne)?ce.length:0;me--;){var ve=ce[me],Le=ve.func;if(Le==null||Le==ee)return ve.name}return ne}function bs(ee){var ne=ai.call(ye,"placeholder")?ye:ee;return ne.placeholder}function Dt(){var ee=ye.iteratee||$o;return ee=ee===$o?Aa:ee,arguments.length?ee(arguments[0],arguments[1]):ee}function vr(ee,ne){var ce=ee.__data__;return Ru(ne)?ce[typeof ne=="string"?"string":"hash"]:ce.map}function wo(ee){for(var ne=Oi(ee),ce=ne.length;ce--;){var me=ne[ce],ve=ee[me];ne[ce]=[me,ve,fl(ve)]}return ne}function ts(ee,ne){var ce=Oc(ee,ne);return Ra(ce)?ce:D}function Lu(ee){var ne=ai.call(ee,Yn),ce=ee[Yn];try{ee[Yn]=D;var me=!0}catch{}var ve=Ys.call(ee);return me&&(ne?ee[Yn]=ce:delete ee[Yn]),ve}var yo=Qr?function(ee){return ee==null?[]:(ee=li(ee),$n(Qr(ee),function(ne){return ma.call(ee,ne)}))}:zo,ul=Qr?function(ee){for(var ne=[];ee;)Bn(ne,yo(ee)),ee=Js(ee);return ne}:zo,Wi=Vi;(Yr&&Wi(new Yr(new ArrayBuffer(1)))!=St||Ls&&Wi(new Ls)!=ni||Zr&&Wi(Zr.resolve())!=zi||gs&&Wi(new gs)!=mi||xs&&Wi(new xs)!=Jt)&&(Wi=function(ee){var ne=Vi(ee),ce=ne==jt?ee.constructor:D,me=ce?is(ce):"";if(me)switch(me){case ad:return St;case ld:return ni;case cd:return zi;case dd:return mi;case ud:return Jt}return ne});function xu(ee,ne,ce){for(var me=-1,ve=ce.length;++me<ve;){var Le=ce[me],Ae=Le.size;switch(Le.type){case"drop":ee+=Ae;break;case"dropRight":ne-=Ae;break;case"take":ne=Bi(ne,ee+Ae);break;case"takeRight":ee=Ai(ee,ne-Ae);break}}return{start:ee,end:ne}}function ku(ee){var ne=ee.match(ht);return ne?ne[1].split(pt):[]}function hl(ee,ne,ce){ne=Un(ne,ee);for(var me=-1,ve=ne.length,Le=!1;++me<ve;){var Ae=wn(ne[me]);if(!(Le=ee!=null&&ce(ee,Ae)))break;ee=ee[Ae]}return Le||++me!=ve?Le:(ve=ee==null?0:ee.length,!!ve&&kr(ve)&&Dn(Ae,ve)&&(Ft(ee)||ns(ee)))}function Iu(ee){var ne=ee.length,ce=new ee.constructor(ne);return ne&&typeof ee[0]=="string"&&ai.call(ee,"index")&&(ce.index=ee.index,ce.input=ee.input),ce}function gl(ee){return typeof ee.constructor=="function"&&!Os(ee)?ps(Js(ee)):{}}function Tu(ee,ne,ce){var me=ee.constructor;switch(ne){case Lt:return mo(ee);case Et:case Ct:return new me(+ee);case St:return hu(ee,ce);case si:case Se:case ge:case _e:case ke:case Fe:case qe:case tt:case It:return Qa(ee,ce);case ni:return new me;case vi:case kt:return new me(ee);case pi:return gu(ee);case mi:return new me;case ki:return fu(ee)}}function Du(ee,ne){var ce=ne.length;if(!ce)return ee;var me=ce-1;return ne[me]=(ce>1?"& ":"")+ne[me],ne=ne.join(ce>2?", ":" "),ee.replace(ut,`{
/* [wrapped with `+ne+`] */
`)}function Nu(ee){return Ft(ee)||ns(ee)||!!(ba&&ee&&ee[ba])}function Dn(ee,ne){var ce=typeof ee;return ne=ne??Je,!!ne&&(ce=="number"||ce!="symbol"&&dt.test(ee))&&ee>-1&&ee%1==0&&ee<ne}function Hi(ee,ne,ce){if(!bi(ce))return!1;var me=typeof ne;return(me=="number"?ji(ce)&&Dn(ne,ce.length):me=="string"&&ne in ce)?_n(ce[ne],ee):!1}function Eo(ee,ne){if(Ft(ee))return!1;var ce=typeof ee;return ce=="number"||ce=="symbol"||ce=="boolean"||ee==null||nn(ee)?!0:xe.test(ee)||!Ee.test(ee)||ne!=null&&ee in li(ne)}function Ru(ee){var ne=typeof ee;return ne=="string"||ne=="number"||ne=="symbol"||ne=="boolean"?ee!=="__proto__":ee===null}function Lo(ee){var ne=Cr(ee),ce=ye[ne];if(typeof ce!="function"||!(ne in Gt.prototype))return!1;if(ee===ce)return!0;var me=So(ce);return!!me&&ee===me[0]}function Au(ee){return!!ga&&ga in ee}var Mu=js?Nn:Vo;function Os(ee){var ne=ee&&ee.constructor,ce=typeof ne=="function"&&ne.prototype||hs;return ee===ce}function fl(ee){return ee===ee&&!bi(ee)}function pl(ee,ne){return function(ce){return ce==null?!1:ce[ee]===ne&&(ne!==D||ee in li(ce))}}function Ou(ee){var ne=Lr(ee,function(me){return ce.size===Q&&ce.clear(),me}),ce=ne.cache;return ne}function Pu(ee,ne){var ce=ee[1],me=ne[1],ve=ce|me,Le=ve<(re|ae|fe),Ae=me==fe&&ce==de||me==fe&&ce==Ce&&ee[7].length<=ne[8]||me==(fe|Ce)&&ne[7].length<=ne[8]&&ce==de;if(!(Le||Ae))return ee;me&re&&(ee[2]=ne[2],ve|=ce&re?0:le);var Be=ne[3];if(Be){var Ue=ee[3];ee[3]=Ue?Za(Ue,Be,ne[4]):Be,ee[4]=Ue?Wn(ee[3],Y):ne[4]}return Be=ne[5],Be&&(Ue=ee[5],ee[5]=Ue?Xa(Ue,Be,ne[6]):Be,ee[6]=Ue?Wn(ee[5],Y):ne[6]),Be=ne[7],Be&&(ee[7]=Be),me&fe&&(ee[8]=ee[8]==null?ne[8]:Bi(ee[8],ne[8])),ee[9]==null&&(ee[9]=ne[9]),ee[0]=ne[0],ee[1]=ve,ee}function Fu(ee){var ne=[];if(ee!=null)for(var ce in li(ee))ne.push(ce);return ne}function $u(ee){return Ys.call(ee)}function ml(ee,ne,ce){return ne=Ai(ne===D?ee.length-1:ne,0),function(){for(var me=arguments,ve=-1,Le=Ai(me.length-ne,0),Ae=Ze(Le);++ve<Le;)Ae[ve]=me[ne+ve];ve=-1;for(var Be=Ze(ne+1);++ve<ne;)Be[ve]=me[ve];return Be[ne]=ce(Ae),Ji(ee,this,Be)}}function _l(ee,ne){return ne.length<2?ee:es(ee,un(ne,0,-1))}function Bu(ee,ne){for(var ce=ee.length,me=Bi(ne.length,ce),ve=Gi(ee);me--;){var Le=ne[me];ee[me]=Dn(Le,ce)?ve[Le]:D}return ee}function xo(ee,ne){if(!(ne==="constructor"&&typeof ee[ne]=="function")&&ne!="__proto__")return ee[ne]}var bl=vl(za),Ps=ed||function(ee,ne){return Fi.setTimeout(ee,ne)},ko=vl(lu);function Cl(ee,ne,ce){var me=ne+"";return ko(ee,Du(me,Wu(ku(me),ce)))}function vl(ee){var ne=0,ce=0;return function(){var me=sd(),ve=Me-(me-ce);if(ce=me,ve>0){if(++ne>=Re)return arguments[0]}else ne=0;return ee.apply(D,arguments)}}function Sr(ee,ne){var ce=-1,me=ee.length,ve=me-1;for(ne=ne===D?me:ne;++ce<ne;){var Le=lo(ce,ve),Ae=ee[Le];ee[Le]=ee[ce],ee[ce]=Ae}return ee.length=ne,ee}var Sl=Ou(function(ee){var ne=[];return ee.charCodeAt(0)===46&&ne.push(""),ee.replace(Ie,function(ce,me,ve,Le){ne.push(ve?Le.replace(Yt,"$1"):me||ce)}),ne});function wn(ee){if(typeof ee=="string"||nn(ee))return ee;var ne=ee+"";return ne=="0"&&1/ee==-1/0?"-0":ne}function is(ee){if(ee!=null){try{return Qs.call(ee)}catch{}try{return ee+""}catch{}}return""}function Wu(ee,ne){return an(je,function(ce){var me="_."+ce[0];ne&ce[1]&&!Us(ee,me)&&ee.push(me)}),ee.sort()}function wl(ee){if(ee instanceof Gt)return ee.clone();var ne=new cn(ee.__wrapped__,ee.__chain__);return ne.__actions__=Gi(ee.__actions__),ne.__index__=ee.__index__,ne.__values__=ee.__values__,ne}function zu(ee,ne,ce){(ce?Hi(ee,ne,ce):ne===D)?ne=1:ne=Ai(Wt(ne),0);var me=ee==null?0:ee.length;if(!me||ne<1)return[];for(var ve=0,Le=0,Ae=Ze(ir(me/ne));ve<me;)Ae[Le++]=un(ee,ve,ve+=ne);return Ae}function Vu(ee){for(var ne=-1,ce=ee==null?0:ee.length,me=0,ve=[];++ne<ce;){var Le=ee[ne];Le&&(ve[me++]=Le)}return ve}function Hu(){var ee=arguments.length;if(!ee)return[];for(var ne=Ze(ee-1),ce=arguments[0],me=ee;me--;)ne[me-1]=arguments[me];return Bn(Ft(ce)?Gi(ce):[ce],$i(ne,1))}var Uu=Ut(function(ee,ne){return Ei(ee)?Ds(ee,$i(ne,1,Ei,!0)):[]}),Ku=Ut(function(ee,ne){var ce=hn(ne);return Ei(ce)&&(ce=D),Ei(ee)?Ds(ee,$i(ne,1,Ei,!0),Dt(ce,2)):[]}),qu=Ut(function(ee,ne){var ce=hn(ne);return Ei(ce)&&(ce=D),Ei(ee)?Ds(ee,$i(ne,1,Ei,!0),D,ce):[]});function Gu(ee,ne,ce){var me=ee==null?0:ee.length;return me?(ne=ce||ne===D?1:Wt(ne),un(ee,ne<0?0:ne,me)):[]}function ju(ee,ne,ce){var me=ee==null?0:ee.length;return me?(ne=ce||ne===D?1:Wt(ne),ne=me-ne,un(ee,0,ne<0?0:ne)):[]}function Qu(ee,ne){return ee&&ee.length?gr(ee,Dt(ne,3),!0,!0):[]}function Yu(ee,ne){return ee&&ee.length?gr(ee,Dt(ne,3),!0):[]}function Zu(ee,ne,ce,me){var ve=ee==null?0:ee.length;return ve?(ce&&typeof ce!="number"&&Hi(ee,ne,ce)&&(ce=0,me=ve),Hd(ee,ne,ce,me)):[]}function yl(ee,ne,ce){var me=ee==null?0:ee.length;if(!me)return-1;var ve=ce==null?0:Wt(ce);return ve<0&&(ve=Ai(me+ve,0)),Ks(ee,Dt(ne,3),ve)}function El(ee,ne,ce){var me=ee==null?0:ee.length;if(!me)return-1;var ve=me-1;return ce!==D&&(ve=Wt(ce),ve=ce<0?Ai(me+ve,0):Bi(ve,me-1)),Ks(ee,Dt(ne,3),ve,!0)}function Ll(ee){var ne=ee==null?0:ee.length;return ne?$i(ee,1):[]}function Xu(ee){var ne=ee==null?0:ee.length;return ne?$i(ee,Ye):[]}function Ju(ee,ne){var ce=ee==null?0:ee.length;return ce?(ne=ne===D?1:Wt(ne),$i(ee,ne)):[]}function eh(ee){for(var ne=-1,ce=ee==null?0:ee.length,me={};++ne<ce;){var ve=ee[ne];me[ve[0]]=ve[1]}return me}function xl(ee){return ee&&ee.length?ee[0]:D}function th(ee,ne,ce){var me=ee==null?0:ee.length;if(!me)return-1;var ve=ce==null?0:Wt(ce);return ve<0&&(ve=Ai(me+ve,0)),ls(ee,ne,ve)}function ih(ee){var ne=ee==null?0:ee.length;return ne?un(ee,0,-1):[]}var nh=Ut(function(ee){var ne=fi(ee,fo);return ne.length&&ne[0]===ee[0]?no(ne):[]}),sh=Ut(function(ee){var ne=hn(ee),ce=fi(ee,fo);return ne===hn(ce)?ne=D:ce.pop(),ce.length&&ce[0]===ee[0]?no(ce,Dt(ne,2)):[]}),rh=Ut(function(ee){var ne=hn(ee),ce=fi(ee,fo);return ne=typeof ne=="function"?ne:D,ne&&ce.pop(),ce.length&&ce[0]===ee[0]?no(ce,D,ne):[]});function oh(ee,ne){return ee==null?"":id.call(ee,ne)}function hn(ee){var ne=ee==null?0:ee.length;return ne?ee[ne-1]:D}function ah(ee,ne,ce){var me=ee==null?0:ee.length;if(!me)return-1;var ve=me;return ce!==D&&(ve=Wt(ce),ve=ve<0?Ai(me+ve,0):Bi(ve,me-1)),ne===ne?Wc(ee,ne,ve):Ks(ee,ra,ve,!0)}function lh(ee,ne){return ee&&ee.length?Fa(ee,Wt(ne)):D}var ch=Ut(kl);function kl(ee,ne){return ee&&ee.length&&ne&&ne.length?ao(ee,ne):ee}function dh(ee,ne,ce){return ee&&ee.length&&ne&&ne.length?ao(ee,ne,Dt(ce,2)):ee}function uh(ee,ne,ce){return ee&&ee.length&&ne&&ne.length?ao(ee,ne,D,ce):ee}var hh=Tn(function(ee,ne){var ce=ee==null?0:ee.length,me=Jr(ee,ne);return Wa(ee,fi(ne,function(ve){return Dn(ve,ce)?+ve:ve}).sort(Ya)),me});function gh(ee,ne){var ce=[];if(!(ee&&ee.length))return ce;var me=-1,ve=[],Le=ee.length;for(ne=Dt(ne,3);++me<Le;){var Ae=ee[me];ne(Ae,me,ee)&&(ce.push(Ae),ve.push(me))}return Wa(ee,ve),ce}function Io(ee){return ee==null?ee:od.call(ee)}function fh(ee,ne,ce){var me=ee==null?0:ee.length;return me?(ce&&typeof ce!="number"&&Hi(ee,ne,ce)?(ne=0,ce=me):(ne=ne==null?0:Wt(ne),ce=ce===D?me:Wt(ce)),un(ee,ne,ce)):[]}function ph(ee,ne){return hr(ee,ne)}function mh(ee,ne,ce){return uo(ee,ne,Dt(ce,2))}function _h(ee,ne){var ce=ee==null?0:ee.length;if(ce){var me=hr(ee,ne);if(me<ce&&_n(ee[me],ne))return me}return-1}function bh(ee,ne){return hr(ee,ne,!0)}function Ch(ee,ne,ce){return uo(ee,ne,Dt(ce,2),!0)}function vh(ee,ne){var ce=ee==null?0:ee.length;if(ce){var me=hr(ee,ne,!0)-1;if(_n(ee[me],ne))return me}return-1}function Sh(ee){return ee&&ee.length?Va(ee):[]}function wh(ee,ne){return ee&&ee.length?Va(ee,Dt(ne,2)):[]}function yh(ee){var ne=ee==null?0:ee.length;return ne?un(ee,1,ne):[]}function Eh(ee,ne,ce){return ee&&ee.length?(ne=ce||ne===D?1:Wt(ne),un(ee,0,ne<0?0:ne)):[]}function Lh(ee,ne,ce){var me=ee==null?0:ee.length;return me?(ne=ce||ne===D?1:Wt(ne),ne=me-ne,un(ee,ne<0?0:ne,me)):[]}function xh(ee,ne){return ee&&ee.length?gr(ee,Dt(ne,3),!1,!0):[]}function kh(ee,ne){return ee&&ee.length?gr(ee,Dt(ne,3)):[]}var Ih=Ut(function(ee){return Hn($i(ee,1,Ei,!0))}),Th=Ut(function(ee){var ne=hn(ee);return Ei(ne)&&(ne=D),Hn($i(ee,1,Ei,!0),Dt(ne,2))}),Dh=Ut(function(ee){var ne=hn(ee);return ne=typeof ne=="function"?ne:D,Hn($i(ee,1,Ei,!0),D,ne)});function Nh(ee){return ee&&ee.length?Hn(ee):[]}function Rh(ee,ne){return ee&&ee.length?Hn(ee,Dt(ne,2)):[]}function Ah(ee,ne){return ne=typeof ne=="function"?ne:D,ee&&ee.length?Hn(ee,D,ne):[]}function To(ee){if(!(ee&&ee.length))return[];var ne=0;return ee=$n(ee,function(ce){if(Ei(ce))return ne=Ai(ce.length,ne),!0}),Kr(ne,function(ce){return fi(ee,Vr(ce))})}function Il(ee,ne){if(!(ee&&ee.length))return[];var ce=To(ee);return ne==null?ce:fi(ce,function(me){return Ji(ne,D,me)})}var Mh=Ut(function(ee,ne){return Ei(ee)?Ds(ee,ne):[]}),Oh=Ut(function(ee){return go($n(ee,Ei))}),Ph=Ut(function(ee){var ne=hn(ee);return Ei(ne)&&(ne=D),go($n(ee,Ei),Dt(ne,2))}),Fh=Ut(function(ee){var ne=hn(ee);return ne=typeof ne=="function"?ne:D,go($n(ee,Ei),D,ne)}),$h=Ut(To);function Bh(ee,ne){return qa(ee||[],ne||[],Ts)}function Wh(ee,ne){return qa(ee||[],ne||[],As)}var zh=Ut(function(ee){var ne=ee.length,ce=ne>1?ee[ne-1]:D;return ce=typeof ce=="function"?(ee.pop(),ce):D,Il(ee,ce)});function Tl(ee){var ne=ye(ee);return ne.__chain__=!0,ne}function Vh(ee,ne){return ne(ee),ee}function wr(ee,ne){return ne(ee)}var Hh=Tn(function(ee){var ne=ee.length,ce=ne?ee[0]:0,me=this.__wrapped__,ve=function(Le){return Jr(Le,ee)};return ne>1||this.__actions__.length||!(me instanceof Gt)||!Dn(ce)?this.thru(ve):(me=me.slice(ce,+ce+(ne?1:0)),me.__actions__.push({func:wr,args:[ve],thisArg:D}),new cn(me,this.__chain__).thru(function(Le){return ne&&!Le.length&&Le.push(D),Le}))});function Uh(){return Tl(this)}function Kh(){return new cn(this.value(),this.__chain__)}function qh(){this.__values__===D&&(this.__values__=Hl(this.value()));var ee=this.__index__>=this.__values__.length,ne=ee?D:this.__values__[this.__index__++];return{done:ee,value:ne}}function Gh(){return this}function jh(ee){for(var ne,ce=this;ce instanceof ar;){var me=wl(ce);me.__index__=0,me.__values__=D,ne?ve.__wrapped__=me:ne=me;var ve=me;ce=ce.__wrapped__}return ve.__wrapped__=ee,ne}function Qh(){var ee=this.__wrapped__;if(ee instanceof Gt){var ne=ee;return this.__actions__.length&&(ne=new Gt(this)),ne=ne.reverse(),ne.__actions__.push({func:wr,args:[Io],thisArg:D}),new cn(ne,this.__chain__)}return this.thru(Io)}function Yh(){return Ka(this.__wrapped__,this.__actions__)}var Zh=fr(function(ee,ne,ce){ai.call(ee,ce)?++ee[ce]:kn(ee,ce,1)});function Xh(ee,ne,ce){var me=Ft(ee)?na:Vd;return ce&&Hi(ee,ne,ce)&&(ne=D),me(ee,Dt(ne,3))}function Jh(ee,ne){var ce=Ft(ee)?$n:Ia;return ce(ee,Dt(ne,3))}var eg=il(yl),tg=il(El);function ig(ee,ne){return $i(yr(ee,ne),1)}function ng(ee,ne){return $i(yr(ee,ne),Ye)}function sg(ee,ne,ce){return ce=ce===D?1:Wt(ce),$i(yr(ee,ne),ce)}function Dl(ee,ne){var ce=Ft(ee)?an:Vn;return ce(ee,Dt(ne,3))}function Nl(ee,ne){var ce=Ft(ee)?yc:ka;return ce(ee,Dt(ne,3))}var rg=fr(function(ee,ne,ce){ai.call(ee,ce)?ee[ce].push(ne):kn(ee,ce,[ne])});function og(ee,ne,ce,me){ee=ji(ee)?ee:Ss(ee),ce=ce&&!me?Wt(ce):0;var ve=ee.length;return ce<0&&(ce=Ai(ve+ce,0)),Ir(ee)?ce<=ve&&ee.indexOf(ne,ce)>-1:!!ve&&ls(ee,ne,ce)>-1}var ag=Ut(function(ee,ne,ce){var me=-1,ve=typeof ne=="function",Le=ji(ee)?Ze(ee.length):[];return Vn(ee,function(Ae){Le[++me]=ve?Ji(ne,Ae,ce):Ns(Ae,ne,ce)}),Le}),lg=fr(function(ee,ne,ce){kn(ee,ce,ne)});function yr(ee,ne){var ce=Ft(ee)?fi:Ma;return ce(ee,Dt(ne,3))}function cg(ee,ne,ce,me){return ee==null?[]:(Ft(ne)||(ne=ne==null?[]:[ne]),ce=me?D:ce,Ft(ce)||(ce=ce==null?[]:[ce]),$a(ee,ne,ce))}var dg=fr(function(ee,ne,ce){ee[ce?0:1].push(ne)},function(){return[[],[]]});function ug(ee,ne,ce){var me=Ft(ee)?Wr:aa,ve=arguments.length<3;return me(ee,Dt(ne,4),ce,ve,Vn)}function hg(ee,ne,ce){var me=Ft(ee)?Ec:aa,ve=arguments.length<3;return me(ee,Dt(ne,4),ce,ve,ka)}function gg(ee,ne){var ce=Ft(ee)?$n:Ia;return ce(ee,xr(Dt(ne,3)))}function fg(ee){var ne=Ft(ee)?ya:ou;return ne(ee)}function pg(ee,ne,ce){(ce?Hi(ee,ne,ce):ne===D)?ne=1:ne=Wt(ne);var me=Ft(ee)?Fd:au;return me(ee,ne)}function mg(ee){var ne=Ft(ee)?$d:cu;return ne(ee)}function _g(ee){if(ee==null)return 0;if(ji(ee))return Ir(ee)?ds(ee):ee.length;var ne=Wi(ee);return ne==ni||ne==mi?ee.size:ro(ee).length}function bg(ee,ne,ce){var me=Ft(ee)?zr:du;return ce&&Hi(ee,ne,ce)&&(ne=D),me(ee,Dt(ne,3))}var Cg=Ut(function(ee,ne){if(ee==null)return[];var ce=ne.length;return ce>1&&Hi(ee,ne[0],ne[1])?ne=[]:ce>2&&Hi(ne[0],ne[1],ne[2])&&(ne=[ne[0]]),$a(ee,$i(ne,1),[])}),Er=Jc||function(){return Fi.Date.now()};function vg(ee,ne){if(typeof ne!="function")throw new ln(K);return ee=Wt(ee),function(){if(--ee<1)return ne.apply(this,arguments)}}function Rl(ee,ne,ce){return ne=ce?D:ne,ne=ee&&ne==null?ee.length:ne,In(ee,fe,D,D,D,D,ne)}function Al(ee,ne){var ce;if(typeof ne!="function")throw new ln(K);return ee=Wt(ee),function(){return--ee>0&&(ce=ne.apply(this,arguments)),ee<=1&&(ne=D),ce}}var Do=Ut(function(ee,ne,ce){var me=re;if(ce.length){var ve=Wn(ce,bs(Do));me|=ue}return In(ee,me,ne,ce,ve)}),Ml=Ut(function(ee,ne,ce){var me=re|ae;if(ce.length){var ve=Wn(ce,bs(Ml));me|=ue}return In(ne,me,ee,ce,ve)});function Ol(ee,ne,ce){ne=ce?D:ne;var me=In(ee,de,D,D,D,D,D,ne);return me.placeholder=Ol.placeholder,me}function Pl(ee,ne,ce){ne=ce?D:ne;var me=In(ee,oe,D,D,D,D,D,ne);return me.placeholder=Pl.placeholder,me}function Fl(ee,ne,ce){var me,ve,Le,Ae,Be,Ue,rt=0,ot=!1,ct=!1,ft=!0;if(typeof ee!="function")throw new ln(K);ne=gn(ne)||0,bi(ce)&&(ot=!!ce.leading,ct="maxWait"in ce,Le=ct?Ai(gn(ce.maxWait)||0,ne):Le,ft="trailing"in ce?!!ce.trailing:ft);function yt(Li){var bn=me,An=ve;return me=ve=D,rt=Li,Ae=ee.apply(An,bn),Ae}function Rt(Li){return rt=Li,Be=Ps(Kt,ne),ot?yt(Li):Ae}function Vt(Li){var bn=Li-Ue,An=Li-rt,ic=ne-bn;return ct?Bi(ic,Le-An):ic}function At(Li){var bn=Li-Ue,An=Li-rt;return Ue===D||bn>=ne||bn<0||ct&&An>=Le}function Kt(){var Li=Er();if(At(Li))return Qt(Li);Be=Ps(Kt,Vt(Li))}function Qt(Li){return Be=D,ft&&me?yt(Li):(me=ve=D,Ae)}function sn(){Be!==D&&Ga(Be),rt=0,me=Ue=ve=Be=D}function Ui(){return Be===D?Ae:Qt(Er())}function rn(){var Li=Er(),bn=At(Li);if(me=arguments,ve=this,Ue=Li,bn){if(Be===D)return Rt(Ue);if(ct)return Ga(Be),Be=Ps(Kt,ne),yt(Ue)}return Be===D&&(Be=Ps(Kt,ne)),Ae}return rn.cancel=sn,rn.flush=Ui,rn}var Sg=Ut(function(ee,ne){return xa(ee,1,ne)}),wg=Ut(function(ee,ne,ce){return xa(ee,gn(ne)||0,ce)});function yg(ee){return In(ee,we)}function Lr(ee,ne){if(typeof ee!="function"||ne!=null&&typeof ne!="function")throw new ln(K);var ce=function(){var me=arguments,ve=ne?ne.apply(this,me):me[0],Le=ce.cache;if(Le.has(ve))return Le.get(ve);var Ae=ee.apply(this,me);return ce.cache=Le.set(ve,Ae)||Le,Ae};return ce.cache=new(Lr.Cache||xn),ce}Lr.Cache=xn;function xr(ee){if(typeof ee!="function")throw new ln(K);return function(){var ne=arguments;switch(ne.length){case 0:return!ee.call(this);case 1:return!ee.call(this,ne[0]);case 2:return!ee.call(this,ne[0],ne[1]);case 3:return!ee.call(this,ne[0],ne[1],ne[2])}return!ee.apply(this,ne)}}function Eg(ee){return Al(2,ee)}var Lg=uu(function(ee,ne){ne=ne.length==1&&Ft(ne[0])?fi(ne[0],en(Dt())):fi($i(ne,1),en(Dt()));var ce=ne.length;return Ut(function(me){for(var ve=-1,Le=Bi(me.length,ce);++ve<Le;)me[ve]=ne[ve].call(this,me[ve]);return Ji(ee,this,me)})}),No=Ut(function(ee,ne){var ce=Wn(ne,bs(No));return In(ee,ue,D,ne,ce)}),$l=Ut(function(ee,ne){var ce=Wn(ne,bs($l));return In(ee,pe,D,ne,ce)}),xg=Tn(function(ee,ne){return In(ee,Ce,D,D,D,ne)});function kg(ee,ne){if(typeof ee!="function")throw new ln(K);return ne=ne===D?ne:Wt(ne),Ut(ee,ne)}function Ig(ee,ne){if(typeof ee!="function")throw new ln(K);return ne=ne==null?0:Ai(Wt(ne),0),Ut(function(ce){var me=ce[ne],ve=Kn(ce,0,ne);return me&&Bn(ve,me),Ji(ee,this,ve)})}function Tg(ee,ne,ce){var me=!0,ve=!0;if(typeof ee!="function")throw new ln(K);return bi(ce)&&(me="leading"in ce?!!ce.leading:me,ve="trailing"in ce?!!ce.trailing:ve),Fl(ee,ne,{leading:me,maxWait:ne,trailing:ve})}function Dg(ee){return Rl(ee,1)}function Ng(ee,ne){return No(po(ne),ee)}function Rg(){if(!arguments.length)return[];var ee=arguments[0];return Ft(ee)?ee:[ee]}function Ag(ee){return dn(ee,te)}function Mg(ee,ne){return ne=typeof ne=="function"?ne:D,dn(ee,te,ne)}function Og(ee){return dn(ee,X|te)}function Pg(ee,ne){return ne=typeof ne=="function"?ne:D,dn(ee,X|te,ne)}function Fg(ee,ne){return ne==null||La(ee,ne,Oi(ne))}function _n(ee,ne){return ee===ne||ee!==ee&&ne!==ne}var $g=br(io),Bg=br(function(ee,ne){return ee>=ne}),ns=Na(function(){return arguments}())?Na:function(ee){return wi(ee)&&ai.call(ee,"callee")&&!ma.call(ee,"callee")},Ft=Ze.isArray,Wg=Zo?en(Zo):jd;function ji(ee){return ee!=null&&kr(ee.length)&&!Nn(ee)}function Ei(ee){return wi(ee)&&ji(ee)}function zg(ee){return ee===!0||ee===!1||wi(ee)&&Vi(ee)==Et}var qn=td||Vo,Vg=Xo?en(Xo):Qd;function Hg(ee){return wi(ee)&&ee.nodeType===1&&!Fs(ee)}function Ug(ee){if(ee==null)return!0;if(ji(ee)&&(Ft(ee)||typeof ee=="string"||typeof ee.splice=="function"||qn(ee)||Cs(ee)||ns(ee)))return!ee.length;var ne=Wi(ee);if(ne==ni||ne==mi)return!ee.size;if(Os(ee))return!ro(ee).length;for(var ce in ee)if(ai.call(ee,ce))return!1;return!0}function Kg(ee,ne){return Rs(ee,ne)}function qg(ee,ne,ce){ce=typeof ce=="function"?ce:D;var me=ce?ce(ee,ne):D;return me===D?Rs(ee,ne,D,ce):!!me}function Ro(ee){if(!wi(ee))return!1;var ne=Vi(ee);return ne==zt||ne==Nt||typeof ee.message=="string"&&typeof ee.name=="string"&&!Fs(ee)}function Gg(ee){return typeof ee=="number"&&Ca(ee)}function Nn(ee){if(!bi(ee))return!1;var ne=Vi(ee);return ne==ii||ne==Ci||ne==Mt||ne==Ki}function Bl(ee){return typeof ee=="number"&&ee==Wt(ee)}function kr(ee){return typeof ee=="number"&&ee>-1&&ee%1==0&&ee<=Je}function bi(ee){var ne=typeof ee;return ee!=null&&(ne=="object"||ne=="function")}function wi(ee){return ee!=null&&typeof ee=="object"}var Wl=Jo?en(Jo):Zd;function jg(ee,ne){return ee===ne||so(ee,ne,wo(ne))}function Qg(ee,ne,ce){return ce=typeof ce=="function"?ce:D,so(ee,ne,wo(ne),ce)}function Yg(ee){return zl(ee)&&ee!=+ee}function Zg(ee){if(Mu(ee))throw new Ot(U);return Ra(ee)}function Xg(ee){return ee===null}function Jg(ee){return ee==null}function zl(ee){return typeof ee=="number"||wi(ee)&&Vi(ee)==vi}function Fs(ee){if(!wi(ee)||Vi(ee)!=jt)return!1;var ne=Js(ee);if(ne===null)return!0;var ce=ai.call(ne,"constructor")&&ne.constructor;return typeof ce=="function"&&ce instanceof ce&&Qs.call(ce)==Qc}var Ao=ea?en(ea):Xd;function ef(ee){return Bl(ee)&&ee>=-9007199254740991&&ee<=Je}var Vl=ta?en(ta):Jd;function Ir(ee){return typeof ee=="string"||!Ft(ee)&&wi(ee)&&Vi(ee)==kt}function nn(ee){return typeof ee=="symbol"||wi(ee)&&Vi(ee)==ki}var Cs=ia?en(ia):eu;function tf(ee){return ee===D}function nf(ee){return wi(ee)&&Wi(ee)==Jt}function sf(ee){return wi(ee)&&Vi(ee)==_i}var rf=br(oo),of=br(function(ee,ne){return ee<=ne});function Hl(ee){if(!ee)return[];if(ji(ee))return Ir(ee)?pn(ee):Gi(ee);if(Es&&ee[Es])return Fc(ee[Es]());var ne=Wi(ee),ce=ne==ni?Gr:ne==mi?qs:Ss;return ce(ee)}function Rn(ee){if(!ee)return ee===0?ee:0;if(ee=gn(ee),ee===Ye||ee===-1/0){var ne=ee<0?-1:1;return ne*at}return ee===ee?ee:0}function Wt(ee){var ne=Rn(ee),ce=ne%1;return ne===ne?ce?ne-ce:ne:0}function Ul(ee){return ee?Jn(Wt(ee),0,lt):0}function gn(ee){if(typeof ee=="number")return ee;if(nn(ee))return st;if(bi(ee)){var ne=typeof ee.valueOf=="function"?ee.valueOf():ee;ee=bi(ne)?ne+"":ne}if(typeof ee!="string")return ee===0?ee:+ee;ee=la(ee);var ce=yn.test(ee);return ce||We.test(ee)?vc(ee.slice(2),ce?2:8):Pi.test(ee)?st:+ee}function Kl(ee){return Sn(ee,Qi(ee))}function af(ee){return ee?Jn(Wt(ee),-9007199254740991,Je):ee===0?ee:0}function oi(ee){return ee==null?"":tn(ee)}var lf=ms(function(ee,ne){if(Os(ne)||ji(ne)){Sn(ne,Oi(ne),ee);return}for(var ce in ne)ai.call(ne,ce)&&Ts(ee,ce,ne[ce])}),ql=ms(function(ee,ne){Sn(ne,Qi(ne),ee)}),Tr=ms(function(ee,ne,ce,me){Sn(ne,Qi(ne),ee,me)}),cf=ms(function(ee,ne,ce,me){Sn(ne,Oi(ne),ee,me)}),df=Tn(Jr);function uf(ee,ne){var ce=ps(ee);return ne==null?ce:Ea(ce,ne)}var hf=Ut(function(ee,ne){ee=li(ee);var ce=-1,me=ne.length,ve=me>2?ne[2]:D;for(ve&&Hi(ne[0],ne[1],ve)&&(me=1);++ce<me;)for(var Le=ne[ce],Ae=Qi(Le),Be=-1,Ue=Ae.length;++Be<Ue;){var rt=Ae[Be],ot=ee[rt];(ot===D||_n(ot,hs[rt])&&!ai.call(ee,rt))&&(ee[rt]=Le[rt])}return ee}),gf=Ut(function(ee){return ee.push(D,cl),Ji(Gl,D,ee)});function ff(ee,ne){return sa(ee,Dt(ne,3),vn)}function pf(ee,ne){return sa(ee,Dt(ne,3),to)}function mf(ee,ne){return ee==null?ee:eo(ee,Dt(ne,3),Qi)}function _f(ee,ne){return ee==null?ee:Ta(ee,Dt(ne,3),Qi)}function bf(ee,ne){return ee&&vn(ee,Dt(ne,3))}function Cf(ee,ne){return ee&&to(ee,Dt(ne,3))}function vf(ee){return ee==null?[]:dr(ee,Oi(ee))}function Sf(ee){return ee==null?[]:dr(ee,Qi(ee))}function Mo(ee,ne,ce){var me=ee==null?D:es(ee,ne);return me===D?ce:me}function wf(ee,ne){return ee!=null&&hl(ee,ne,Ud)}function Oo(ee,ne){return ee!=null&&hl(ee,ne,Kd)}var yf=sl(function(ee,ne,ce){ne!=null&&typeof ne.toString!="function"&&(ne=Ys.call(ne)),ee[ne]=ce},Fo(Yi)),Ef=sl(function(ee,ne,ce){ne!=null&&typeof ne.toString!="function"&&(ne=Ys.call(ne)),ai.call(ee,ne)?ee[ne].push(ce):ee[ne]=[ce]},Dt),Lf=Ut(Ns);function Oi(ee){return ji(ee)?wa(ee):ro(ee)}function Qi(ee){return ji(ee)?wa(ee,!0):tu(ee)}function xf(ee,ne){var ce={};return ne=Dt(ne,3),vn(ee,function(me,ve,Le){kn(ce,ne(me,ve,Le),me)}),ce}function kf(ee,ne){var ce={};return ne=Dt(ne,3),vn(ee,function(me,ve,Le){kn(ce,ve,ne(me,ve,Le))}),ce}var If=ms(function(ee,ne,ce){ur(ee,ne,ce)}),Gl=ms(function(ee,ne,ce,me){ur(ee,ne,ce,me)}),Tf=Tn(function(ee,ne){var ce={};if(ee==null)return ce;var me=!1;ne=fi(ne,function(Le){return Le=Un(Le,ee),me||(me=Le.length>1),Le}),Sn(ee,vo(ee),ce),me&&(ce=dn(ce,X|J|te,wu));for(var ve=ne.length;ve--;)ho(ce,ne[ve]);return ce});function Df(ee,ne){return jl(ee,xr(Dt(ne)))}var Nf=Tn(function(ee,ne){return ee==null?{}:nu(ee,ne)});function jl(ee,ne){if(ee==null)return{};var ce=fi(vo(ee),function(me){return[me]});return ne=Dt(ne),Ba(ee,ce,function(me,ve){return ne(me,ve[0])})}function Rf(ee,ne,ce){ne=Un(ne,ee);var me=-1,ve=ne.length;for(ve||(ve=1,ee=D);++me<ve;){var Le=ee==null?D:ee[wn(ne[me])];Le===D&&(me=ve,Le=ce),ee=Nn(Le)?Le.call(ee):Le}return ee}function Af(ee,ne,ce){return ee==null?ee:As(ee,ne,ce)}function Mf(ee,ne,ce,me){return me=typeof me=="function"?me:D,ee==null?ee:As(ee,ne,ce,me)}var Ql=al(Oi),Yl=al(Qi);function Of(ee,ne,ce){var me=Ft(ee),ve=me||qn(ee)||Cs(ee);if(ne=Dt(ne,4),ce==null){var Le=ee&&ee.constructor;ve?ce=me?new Le:[]:bi(ee)?ce=Nn(Le)?ps(Js(ee)):{}:ce={}}return(ve?an:vn)(ee,function(Ae,Be,Ue){return ne(ce,Ae,Be,Ue)}),ce}function Pf(ee,ne){return ee==null?!0:ho(ee,ne)}function Ff(ee,ne,ce){return ee==null?ee:Ua(ee,ne,po(ce))}function $f(ee,ne,ce,me){return me=typeof me=="function"?me:D,ee==null?ee:Ua(ee,ne,po(ce),me)}function Ss(ee){return ee==null?[]:qr(ee,Oi(ee))}function Bf(ee){return ee==null?[]:qr(ee,Qi(ee))}function Wf(ee,ne,ce){return ce===D&&(ce=ne,ne=D),ce!==D&&(ce=gn(ce),ce=ce===ce?ce:0),ne!==D&&(ne=gn(ne),ne=ne===ne?ne:0),Jn(gn(ee),ne,ce)}function zf(ee,ne,ce){return ne=Rn(ne),ce===D?(ce=ne,ne=0):ce=Rn(ce),ee=gn(ee),qd(ee,ne,ce)}function Vf(ee,ne,ce){if(ce&&typeof ce!="boolean"&&Hi(ee,ne,ce)&&(ne=ce=D),ce===D&&(typeof ne=="boolean"?(ce=ne,ne=D):typeof ee=="boolean"&&(ce=ee,ee=D)),ee===D&&ne===D?(ee=0,ne=1):(ee=Rn(ee),ne===D?(ne=ee,ee=0):ne=Rn(ne)),ee>ne){var me=ee;ee=ne,ne=me}if(ce||ee%1||ne%1){var ve=va();return Bi(ee+ve*(ne-ee+Cc("1e-"+((ve+"").length-1))),ne)}return lo(ee,ne)}var Hf=_s(function(ee,ne,ce){return ne=ne.toLowerCase(),ee+(ce?Zl(ne):ne)});function Zl(ee){return Po(oi(ee).toLowerCase())}function Xl(ee){return ee=oi(ee),ee&&ee.replace(_t,Rc).replace(cc,"")}function Uf(ee,ne,ce){ee=oi(ee),ne=tn(ne);var me=ee.length;ce=ce===D?me:Jn(Wt(ce),0,me);var ve=ce;return ce-=ne.length,ce>=0&&ee.slice(ce,ve)==ne}function Kf(ee){return ee=oi(ee),ee&&On.test(ee)?ee.replace(di,Ac):ee}function qf(ee){return ee=oi(ee),ee&&$e.test(ee)?ee.replace(Pe,"\\$&"):ee}var Gf=_s(function(ee,ne,ce){return ee+(ce?"-":"")+ne.toLowerCase()}),jf=_s(function(ee,ne,ce){return ee+(ce?" ":"")+ne.toLowerCase()}),Qf=tl("toLowerCase");function Yf(ee,ne,ce){ee=oi(ee),ne=Wt(ne);var me=ne?ds(ee):0;if(!ne||me>=ne)return ee;var ve=(ne-me)/2;return _r(nr(ve),ce)+ee+_r(ir(ve),ce)}function Zf(ee,ne,ce){ee=oi(ee),ne=Wt(ne);var me=ne?ds(ee):0;return ne&&me<ne?ee+_r(ne-me,ce):ee}function Xf(ee,ne,ce){ee=oi(ee),ne=Wt(ne);var me=ne?ds(ee):0;return ne&&me<ne?_r(ne-me,ce)+ee:ee}function Jf(ee,ne,ce){return ce||ne==null?ne=0:ne&&(ne=+ne),rd(oi(ee).replace(Ge,""),ne||0)}function ep(ee,ne,ce){return(ce?Hi(ee,ne,ce):ne===D)?ne=1:ne=Wt(ne),co(oi(ee),ne)}function tp(){var ee=arguments,ne=oi(ee[0]);return ee.length<3?ne:ne.replace(ee[1],ee[2])}var ip=_s(function(ee,ne,ce){return ee+(ce?"_":"")+ne.toLowerCase()});function np(ee,ne,ce){return ce&&typeof ce!="number"&&Hi(ee,ne,ce)&&(ne=ce=D),ce=ce===D?lt:ce>>>0,ce?(ee=oi(ee),ee&&(typeof ne=="string"||ne!=null&&!Ao(ne))&&(ne=tn(ne),!ne&&cs(ee))?Kn(pn(ee),0,ce):ee.split(ne,ce)):[]}var sp=_s(function(ee,ne,ce){return ee+(ce?" ":"")+Po(ne)});function rp(ee,ne,ce){return ee=oi(ee),ce=ce==null?0:Jn(Wt(ce),0,ee.length),ne=tn(ne),ee.slice(ce,ce+ne.length)==ne}function ap(ee,ne,ce){var me=ye.templateSettings;ce&&Hi(ee,ne,ce)&&(ne=D),ee=oi(ee),ne=Tr({},ne,me,ll);var ve=Tr({},ne.imports,me.imports,ll),Le=Oi(ve),Ae=qr(ve,Le),Be,Ue,rt=0,ot=ne.interpolate||Zt,ct="__p += '",ft=jr((ne.escape||Zt).source+"|"+ot.source+"|"+(ot===xt?Xt:Zt).source+"|"+(ne.evaluate||Zt).source+"|$","g"),yt="//# sourceURL="+(ai.call(ne,"sourceURL")?(ne.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++fc+"]")+`
`;ee.replace(ft,function(At,Kt,Qt,sn,Ui,rn){return Qt||(Qt=sn),ct+=ee.slice(rt,rn).replace(Ti,Mc),Kt&&(Be=!0,ct+=`' +
__e(`+Kt+`) +
'`),Ui&&(Ue=!0,ct+=`';
`+Ui+`;
__p += '`),Qt&&(ct+=`' +
((__t = (`+Qt+`)) == null ? '' : __t) +
'`),rt=rn+At.length,At}),ct+=`';
`;var Rt=ai.call(ne,"variable")&&ne.variable;if(!Rt)ct=`with (obj) {
`+ct+`
}
`;else if(Pt.test(Rt))throw new Ot(q);ct=(Ue?ct.replace(wt,""):ct).replace(Ht,"$1").replace(ri,"$1;"),ct="function("+(Rt||"obj")+`) {
`+(Rt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Be?", __e = _.escape":"")+(Ue?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ct+`return __p
}`;var Vt=ec(function(){return ti(Le,yt+"return "+ct).apply(D,Ae)});if(Vt.source=ct,Ro(Vt))throw Vt;return Vt}function lp(ee){return oi(ee).toLowerCase()}function cp(ee){return oi(ee).toUpperCase()}function dp(ee,ne,ce){if(ee=oi(ee),ee&&(ce||ne===D))return la(ee);if(!ee||!(ne=tn(ne)))return ee;var me=pn(ee),ve=pn(ne),Le=ca(me,ve),Ae=da(me,ve)+1;return Kn(me,Le,Ae).join("")}function up(ee,ne,ce){if(ee=oi(ee),ee&&(ce||ne===D))return ee.slice(0,ha(ee)+1);if(!ee||!(ne=tn(ne)))return ee;var me=pn(ee),ve=da(me,pn(ne))+1;return Kn(me,0,ve).join("")}function hp(ee,ne,ce){if(ee=oi(ee),ee&&(ce||ne===D))return ee.replace(Ge,"");if(!ee||!(ne=tn(ne)))return ee;var me=pn(ee),ve=ca(me,pn(ne));return Kn(me,ve).join("")}function gp(ee,ne){var ce=Oe,me=Te;if(bi(ne)){var ve="separator"in ne?ne.separator:ve;ce="length"in ne?Wt(ne.length):ce,me="omission"in ne?tn(ne.omission):me}ee=oi(ee);var Le=ee.length;if(cs(ee)){var Ae=pn(ee);Le=Ae.length}if(ce>=Le)return ee;var Be=ce-ds(me);if(Be<1)return me;var Ue=Ae?Kn(Ae,0,Be).join(""):ee.slice(0,Be);if(ve===D)return Ue+me;if(Ae&&(Be+=Ue.length-Be),Ao(ve)){if(ee.slice(Be).search(ve)){var rt,ot=Ue;for(ve.global||(ve=jr(ve.source,oi(Si.exec(ve))+"g")),ve.lastIndex=0;rt=ve.exec(ot);)var ct=rt.index;Ue=Ue.slice(0,ct===D?Be:ct)}}else if(ee.indexOf(tn(ve),Be)!=Be){var ft=Ue.lastIndexOf(ve);ft>-1&&(Ue=Ue.slice(0,ft))}return Ue+me}function fp(ee){return ee=oi(ee),ee&&Zi.test(ee)?ee.replace(qt,zc):ee}var pp=_s(function(ee,ne,ce){return ee+(ce?" ":"")+ne.toUpperCase()}),Po=tl("toUpperCase");function Jl(ee,ne,ce){return ee=oi(ee),ne=ce?D:ne,ne===D?Pc(ee)?Uc(ee):kc(ee):ee.match(ne)||[]}var ec=Ut(function(ee,ne){try{return Ji(ee,D,ne)}catch(ce){return Ro(ce)?ce:new Ot(ce)}}),mp=Tn(function(ee,ne){return an(ne,function(ce){ce=wn(ce),kn(ee,ce,Do(ee[ce],ee))}),ee});function _p(ee){var ne=ee==null?0:ee.length,ce=Dt();return ee=ne?fi(ee,function(me){if(typeof me[1]!="function")throw new ln(K);return[ce(me[0]),me[1]]}):[],Ut(function(me){for(var ve=-1;++ve<ne;){var Le=ee[ve];if(Ji(Le[0],this,me))return Ji(Le[1],this,me)}})}function bp(ee){return zd(dn(ee,X))}function Fo(ee){return function(){return ee}}function Cp(ee,ne){return ee==null||ee!==ee?ne:ee}var vp=nl(),Sp=nl(!0);function Yi(ee){return ee}function $o(ee){return Aa(typeof ee=="function"?ee:dn(ee,X))}function wp(ee){return Oa(dn(ee,X))}function yp(ee,ne){return Pa(ee,dn(ne,X))}var Ep=Ut(function(ee,ne){return function(ce){return Ns(ce,ee,ne)}}),Lp=Ut(function(ee,ne){return function(ce){return Ns(ee,ce,ne)}});function Bo(ee,ne,ce){var me=Oi(ne),ve=dr(ne,me);ce==null&&!(bi(ne)&&(ve.length||!me.length))&&(ce=ne,ne=ee,ee=this,ve=dr(ne,Oi(ne)));var Le=!(bi(ce)&&"chain"in ce)||!!ce.chain,Ae=Nn(ee);return an(ve,function(Be){var Ue=ne[Be];ee[Be]=Ue,Ae&&(ee.prototype[Be]=function(){var rt=this.__chain__;if(Le||rt){var ot=ee(this.__wrapped__),ct=ot.__actions__=Gi(this.__actions__);return ct.push({func:Ue,args:arguments,thisArg:ee}),ot.__chain__=rt,ot}return Ue.apply(ee,Bn([this.value()],arguments))})}),ee}function xp(){return Fi._===this&&(Fi._=Yc),this}function Wo(){}function kp(ee){return ee=Wt(ee),Ut(function(ne){return Fa(ne,ee)})}var Ip=_o(fi),Tp=_o(na),Dp=_o(zr);function tc(ee){return Eo(ee)?Vr(wn(ee)):su(ee)}function Np(ee){return function(ne){return ee==null?D:es(ee,ne)}}var Rp=rl(),Ap=rl(!0);function zo(){return[]}function Vo(){return!1}function Mp(){return{}}function Op(){return""}function Pp(){return!0}function Fp(ee,ne){if(ee=Wt(ee),ee<1||ee>Je)return[];var ce=lt,me=Bi(ee,lt);ne=Dt(ne),ee-=lt;for(var ve=Kr(me,ne);++ce<ee;)ne(ce);return ve}function $p(ee){return Ft(ee)?fi(ee,wn):nn(ee)?[ee]:Gi(Sl(oi(ee)))}function Bp(ee){var ne=++jc;return oi(ee)+ne}var Wp=mr(function(ee,ne){return ee+ne},0),zp=bo("ceil"),Vp=mr(function(ee,ne){return ee/ne},1),Hp=bo("floor");function Up(ee){return ee&&ee.length?cr(ee,Yi,io):D}function Kp(ee,ne){return ee&&ee.length?cr(ee,Dt(ne,2),io):D}function qp(ee){return oa(ee,Yi)}function Gp(ee,ne){return oa(ee,Dt(ne,2))}function jp(ee){return ee&&ee.length?cr(ee,Yi,oo):D}function Qp(ee,ne){return ee&&ee.length?cr(ee,Dt(ne,2),oo):D}var Yp=mr(function(ee,ne){return ee*ne},1),Zp=bo("round"),Xp=mr(function(ee,ne){return ee-ne},0);function Jp(ee){return ee&&ee.length?Ur(ee,Yi):0}function em(ee,ne){return ee&&ee.length?Ur(ee,Dt(ne,2)):0}return ye.after=vg,ye.ary=Rl,ye.assign=lf,ye.assignIn=ql,ye.assignInWith=Tr,ye.assignWith=cf,ye.at=df,ye.before=Al,ye.bind=Do,ye.bindAll=mp,ye.bindKey=Ml,ye.castArray=Rg,ye.chain=Tl,ye.chunk=zu,ye.compact=Vu,ye.concat=Hu,ye.cond=_p,ye.conforms=bp,ye.constant=Fo,ye.countBy=Zh,ye.create=uf,ye.curry=Ol,ye.curryRight=Pl,ye.debounce=Fl,ye.defaults=hf,ye.defaultsDeep=gf,ye.defer=Sg,ye.delay=wg,ye.difference=Uu,ye.differenceBy=Ku,ye.differenceWith=qu,ye.drop=Gu,ye.dropRight=ju,ye.dropRightWhile=Qu,ye.dropWhile=Yu,ye.fill=Zu,ye.filter=Jh,ye.flatMap=ig,ye.flatMapDeep=ng,ye.flatMapDepth=sg,ye.flatten=Ll,ye.flattenDeep=Xu,ye.flattenDepth=Ju,ye.flip=yg,ye.flow=vp,ye.flowRight=Sp,ye.fromPairs=eh,ye.functions=vf,ye.functionsIn=Sf,ye.groupBy=rg,ye.initial=ih,ye.intersection=nh,ye.intersectionBy=sh,ye.intersectionWith=rh,ye.invert=yf,ye.invertBy=Ef,ye.invokeMap=ag,ye.iteratee=$o,ye.keyBy=lg,ye.keys=Oi,ye.keysIn=Qi,ye.map=yr,ye.mapKeys=xf,ye.mapValues=kf,ye.matches=wp,ye.matchesProperty=yp,ye.memoize=Lr,ye.merge=If,ye.mergeWith=Gl,ye.method=Ep,ye.methodOf=Lp,ye.mixin=Bo,ye.negate=xr,ye.nthArg=kp,ye.omit=Tf,ye.omitBy=Df,ye.once=Eg,ye.orderBy=cg,ye.over=Ip,ye.overArgs=Lg,ye.overEvery=Tp,ye.overSome=Dp,ye.partial=No,ye.partialRight=$l,ye.partition=dg,ye.pick=Nf,ye.pickBy=jl,ye.property=tc,ye.propertyOf=Np,ye.pull=ch,ye.pullAll=kl,ye.pullAllBy=dh,ye.pullAllWith=uh,ye.pullAt=hh,ye.range=Rp,ye.rangeRight=Ap,ye.rearg=xg,ye.reject=gg,ye.remove=gh,ye.rest=kg,ye.reverse=Io,ye.sampleSize=pg,ye.set=Af,ye.setWith=Mf,ye.shuffle=mg,ye.slice=fh,ye.sortBy=Cg,ye.sortedUniq=Sh,ye.sortedUniqBy=wh,ye.split=np,ye.spread=Ig,ye.tail=yh,ye.take=Eh,ye.takeRight=Lh,ye.takeRightWhile=xh,ye.takeWhile=kh,ye.tap=Vh,ye.throttle=Tg,ye.thru=wr,ye.toArray=Hl,ye.toPairs=Ql,ye.toPairsIn=Yl,ye.toPath=$p,ye.toPlainObject=Kl,ye.transform=Of,ye.unary=Dg,ye.union=Ih,ye.unionBy=Th,ye.unionWith=Dh,ye.uniq=Nh,ye.uniqBy=Rh,ye.uniqWith=Ah,ye.unset=Pf,ye.unzip=To,ye.unzipWith=Il,ye.update=Ff,ye.updateWith=$f,ye.values=Ss,ye.valuesIn=Bf,ye.without=Mh,ye.words=Jl,ye.wrap=Ng,ye.xor=Oh,ye.xorBy=Ph,ye.xorWith=Fh,ye.zip=$h,ye.zipObject=Bh,ye.zipObjectDeep=Wh,ye.zipWith=zh,ye.entries=Ql,ye.entriesIn=Yl,ye.extend=ql,ye.extendWith=Tr,Bo(ye,ye),ye.add=Wp,ye.attempt=ec,ye.camelCase=Hf,ye.capitalize=Zl,ye.ceil=zp,ye.clamp=Wf,ye.clone=Ag,ye.cloneDeep=Og,ye.cloneDeepWith=Pg,ye.cloneWith=Mg,ye.conformsTo=Fg,ye.deburr=Xl,ye.defaultTo=Cp,ye.divide=Vp,ye.endsWith=Uf,ye.eq=_n,ye.escape=Kf,ye.escapeRegExp=qf,ye.every=Xh,ye.find=eg,ye.findIndex=yl,ye.findKey=ff,ye.findLast=tg,ye.findLastIndex=El,ye.findLastKey=pf,ye.floor=Hp,ye.forEach=Dl,ye.forEachRight=Nl,ye.forIn=mf,ye.forInRight=_f,ye.forOwn=bf,ye.forOwnRight=Cf,ye.get=Mo,ye.gt=$g,ye.gte=Bg,ye.has=wf,ye.hasIn=Oo,ye.head=xl,ye.identity=Yi,ye.includes=og,ye.indexOf=th,ye.inRange=zf,ye.invoke=Lf,ye.isArguments=ns,ye.isArray=Ft,ye.isArrayBuffer=Wg,ye.isArrayLike=ji,ye.isArrayLikeObject=Ei,ye.isBoolean=zg,ye.isBuffer=qn,ye.isDate=Vg,ye.isElement=Hg,ye.isEmpty=Ug,ye.isEqual=Kg,ye.isEqualWith=qg,ye.isError=Ro,ye.isFinite=Gg,ye.isFunction=Nn,ye.isInteger=Bl,ye.isLength=kr,ye.isMap=Wl,ye.isMatch=jg,ye.isMatchWith=Qg,ye.isNaN=Yg,ye.isNative=Zg,ye.isNil=Jg,ye.isNull=Xg,ye.isNumber=zl,ye.isObject=bi,ye.isObjectLike=wi,ye.isPlainObject=Fs,ye.isRegExp=Ao,ye.isSafeInteger=ef,ye.isSet=Vl,ye.isString=Ir,ye.isSymbol=nn,ye.isTypedArray=Cs,ye.isUndefined=tf,ye.isWeakMap=nf,ye.isWeakSet=sf,ye.join=oh,ye.kebabCase=Gf,ye.last=hn,ye.lastIndexOf=ah,ye.lowerCase=jf,ye.lowerFirst=Qf,ye.lt=rf,ye.lte=of,ye.max=Up,ye.maxBy=Kp,ye.mean=qp,ye.meanBy=Gp,ye.min=jp,ye.minBy=Qp,ye.stubArray=zo,ye.stubFalse=Vo,ye.stubObject=Mp,ye.stubString=Op,ye.stubTrue=Pp,ye.multiply=Yp,ye.nth=lh,ye.noConflict=xp,ye.noop=Wo,ye.now=Er,ye.pad=Yf,ye.padEnd=Zf,ye.padStart=Xf,ye.parseInt=Jf,ye.random=Vf,ye.reduce=ug,ye.reduceRight=hg,ye.repeat=ep,ye.replace=tp,ye.result=Rf,ye.round=Zp,ye.runInContext=He,ye.sample=fg,ye.size=_g,ye.snakeCase=ip,ye.some=bg,ye.sortedIndex=ph,ye.sortedIndexBy=mh,ye.sortedIndexOf=_h,ye.sortedLastIndex=bh,ye.sortedLastIndexBy=Ch,ye.sortedLastIndexOf=vh,ye.startCase=sp,ye.startsWith=rp,ye.subtract=Xp,ye.sum=Jp,ye.sumBy=em,ye.template=ap,ye.times=Fp,ye.toFinite=Rn,ye.toInteger=Wt,ye.toLength=Ul,ye.toLower=lp,ye.toNumber=gn,ye.toSafeInteger=af,ye.toString=oi,ye.toUpper=cp,ye.trim=dp,ye.trimEnd=up,ye.trimStart=hp,ye.truncate=gp,ye.unescape=fp,ye.uniqueId=Bp,ye.upperCase=pp,ye.upperFirst=Po,ye.each=Dl,ye.eachRight=Nl,ye.first=xl,Bo(ye,function(){var ee={};return vn(ye,function(ne,ce){ai.call(ye.prototype,ce)||(ee[ce]=ne)}),ee}(),{chain:!1}),ye.VERSION=O,an(["bind","bindKey","curry","curryRight","partial","partialRight"],function(ee){ye[ee].placeholder=ye}),an(["drop","take"],function(ee,ne){Gt.prototype[ee]=function(ce){ce=ce===D?1:Ai(Wt(ce),0);var me=this.__filtered__&&!ne?new Gt(this):this.clone();return me.__filtered__?me.__takeCount__=Bi(ce,me.__takeCount__):me.__views__.push({size:Bi(ce,lt),type:ee+(me.__dir__<0?"Right":"")}),me},Gt.prototype[ee+"Right"]=function(ce){return this.reverse()[ee](ce).reverse()}}),an(["filter","map","takeWhile"],function(ee,ne){var ce=ne+1,me=ce==Ne||ce==Qe;Gt.prototype[ee]=function(ve){var Le=this.clone();return Le.__iteratees__.push({iteratee:Dt(ve,3),type:ce}),Le.__filtered__=Le.__filtered__||me,Le}}),an(["head","last"],function(ee,ne){var ce="take"+(ne?"Right":"");Gt.prototype[ee]=function(){return this[ce](1).value()[0]}}),an(["initial","tail"],function(ee,ne){var ce="drop"+(ne?"":"Right");Gt.prototype[ee]=function(){return this.__filtered__?new Gt(this):this[ce](1)}}),Gt.prototype.compact=function(){return this.filter(Yi)},Gt.prototype.find=function(ee){return this.filter(ee).head()},Gt.prototype.findLast=function(ee){return this.reverse().find(ee)},Gt.prototype.invokeMap=Ut(function(ee,ne){return typeof ee=="function"?new Gt(this):this.map(function(ce){return Ns(ce,ee,ne)})}),Gt.prototype.reject=function(ee){return this.filter(xr(Dt(ee)))},Gt.prototype.slice=function(ee,ne){ee=Wt(ee);var ce=this;return ce.__filtered__&&(ee>0||ne<0)?new Gt(ce):(ee<0?ce=ce.takeRight(-ee):ee&&(ce=ce.drop(ee)),ne!==D&&(ne=Wt(ne),ce=ne<0?ce.dropRight(-ne):ce.take(ne-ee)),ce)},Gt.prototype.takeRightWhile=function(ee){return this.reverse().takeWhile(ee).reverse()},Gt.prototype.toArray=function(){return this.take(lt)},vn(Gt.prototype,function(ee,ne){var ce=/^(?:filter|find|map|reject)|While$/.test(ne),me=/^(?:head|last)$/.test(ne),ve=ye[me?"take"+(ne=="last"?"Right":""):ne],Le=me||/^find/.test(ne);ve&&(ye.prototype[ne]=function(){var Ae=this.__wrapped__,Be=me?[1]:arguments,Ue=Ae instanceof Gt,rt=Be[0],ot=Ue||Ft(Ae),ct=function(Kt){var Qt=ve.apply(ye,Bn([Kt],Be));return me&&ft?Qt[0]:Qt};ot&&ce&&typeof rt=="function"&&rt.length!=1&&(Ue=ot=!1);var ft=this.__chain__,yt=!!this.__actions__.length,Rt=Le&&!ft,Vt=Ue&&!yt;if(!Le&&ot){Ae=Vt?Ae:new Gt(this);var At=ee.apply(Ae,Be);return At.__actions__.push({func:wr,args:[ct],thisArg:D}),new cn(At,ft)}return Rt&&Vt?ee.apply(this,Be):(At=this.thru(ct),Rt?me?At.value()[0]:At.value():At)})}),an(["pop","push","shift","sort","splice","unshift"],function(ee){var ne=Gs[ee],ce=/^(?:push|sort|unshift)$/.test(ee)?"tap":"thru",me=/^(?:pop|shift)$/.test(ee);ye.prototype[ee]=function(){var ve=arguments;if(me&&!this.__chain__){var Le=this.value();return ne.apply(Ft(Le)?Le:[],ve)}return this[ce](function(Ae){return ne.apply(Ft(Ae)?Ae:[],ve)})}}),vn(Gt.prototype,function(ee,ne){var ce=ye[ne];if(ce){var me=ce.name+"";ai.call(fs,me)||(fs[me]=[]),fs[me].push({name:ne,func:ce})}}),fs[pr(D,ae).name]=[{name:"wrapper",func:D}],Gt.prototype.clone=hd,Gt.prototype.reverse=gd,Gt.prototype.value=fd,ye.prototype.at=Hh,ye.prototype.chain=Uh,ye.prototype.commit=Kh,ye.prototype.next=qh,ye.prototype.plant=jh,ye.prototype.reverse=Qh,ye.prototype.toJSON=ye.prototype.valueOf=ye.prototype.value=Yh,ye.prototype.first=ye.prototype.head,Es&&(ye.prototype[Es]=Gh),ye},us=Kc();Qn?((Qn.exports=us)._=us,Fr._=us):Fi._=us}).call(lodash)}(lodash$1,lodash$1.exports)),lodash$1.exports}var lodashExports=requireLodash(),__defProp$2=Object.defineProperty,__getOwnPropDesc$2=Object.getOwnPropertyDescriptor,__decorateClass$2=(F,w,D,O)=>{for(var W=O>1?void 0:O?__getOwnPropDesc$2(w,D):w,U=F.length-1,K;U>=0;U--)(K=F[U])&&(W=(O?K(w,D,W):K(W))||W);return O&&W&&__defProp$2(w,D,W),W};globalThis.monaco=monaco;class SchemaManager{constructor(){this.schemas=["spans","metrics"],this.defaultSchema="spans",this.schemaData={},this.nestedResolver=async(w,D)=>{const O=this.schemaData[w]||this.schemaData[this.defaultSchema];if(!O?.fields)return[];const W=Object.entries(O.fields);if(!D)return W.filter(([q])=>!q.includes(".")).map(([q,G])=>({name:q,type:G.type||"string",examples:G.examples||G.enum||[],fields:W.some(([Q])=>Q.startsWith(`${q}.`))?{}:void 0}));const U=`${D}.`,K=W.filter(([q])=>q.startsWith(U)).reduce((q,[G,Q])=>{const Y=G.substring(U.length).split(".")[0];return q.has(Y)||q.set(Y,{name:Y,type:Q.type||"string",examples:Q.examples||Q.enum||[],fields:W.some(([X])=>X.startsWith(`${U}${Y}.`))?{}:void 0}),q},new Map);return Array.from(K.values())},this.valueResolver=async(w,D)=>{const O=this.schemaData[w]?.fields?.[D]||this.schemaData[this.defaultSchema]?.fields?.[D];return(O?.enum||O?.examples||[]).map(String)},this.setSchemas=w=>{this.schemas=w},this.setDefaultSchema=w=>{this.schemas.includes(w)&&(this.defaultSchema=w)},this.setSchemaData=(w,D)=>{this.schemaData[w]=D},this.getSchemaData=w=>this.schemaData[w],this.setNestedResolver=w=>{this.nestedResolver=w},this.setValueResolver=w=>{this.valueResolver=w},this.getSchemas=()=>this.schemas,this.getDefaultSchema=()=>this.defaultSchema,this.resolveNested=(w,D)=>this.nestedResolver(w,D),this.resolveValues=(w,D)=>this.valueResolver(w,D),this.getRootFields=async()=>(await this.nestedResolver(this.defaultSchema,"")).map(D=>({name:D.name,info:{type:D.type,examples:D.examples,enum:D.examples,fields:D.fields}})),this.resolveNestedFields=async w=>(await this.nestedResolver(this.defaultSchema,w.join("."))).map(O=>({name:O.name,info:{type:O.type,examples:O.examples,enum:O.examples,fields:O.fields}})),this.setSchema=w=>{console.log("Using legacy setSchema method, consider updating to new API")},this.setDynamicResolver=w=>{this.nestedResolver=async(D,O)=>{const W=O?O.split("."):[];return(await w(W)).map(K=>({name:K.name,type:K.info.type,examples:K.info.examples,fields:K.info.fields}))}}}}const schemaManager=new SchemaManager,conf={comments:{lineComment:"//",blockComment:["/_","_/"]},brackets:[["(",")"],["[","]"]],autoClosingPairs:[{open:'"',close:'"'},{open:"[",close:"]"},{open:"(",close:")"}],surroundingPairs:[{open:'"',close:'"'},{open:"[",close:"]"},{open:"(",close:")"}],ignoreCase:!0},language={defaultToken:"",tokenPostfix:".aql",ignoreCase:!0,keywords:["spans","metrics","stats","timechart","by","as","limit","exists","!exists","and","or","not","count","sum","avg","min","max","median","stdev","range","p50","p75","p90","p95","p99","p100"],operators:["==","!=",">","<",">=","<=","=~","|"],tokenizer:{root:[[/\[[0-9]+(?:s|m|h|d|w)\]/,"number.timespan"],[/[0-9]+(?:ns|µs|us|ms|s|m|h|d|w)/,"number.duration"],[/[0-9]+(?:\.[0-9]+)?(?:[eE][+-]?[0-9]+)?/,"number"],[/"([^"\\]|\\.)*"/,"string"],[/\/(\\.|[^\\/])+\/[iIsS]*/,"regexp"],[/[a-zA-Z_][\w]*/,{cases:{"@keywords":"keyword","@default":"identifier"}}],[/[=><!~|]+/,{cases:{"@operators":"operator","@default":""}}],[/[[\]()\.,|]/,"delimiter"],{include:"@whitespace"}],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\/.*$/,"comment"],[/\/_/,"comment","@comment"]],comment:[[/\_\//,"comment","@pop"],[/./,"comment"]]}};editor.defineTheme("transparent-theme",{base:"vs",inherit:!0,rules:[],colors:{"editor.background":"#00000000","editor.lineHighlightBackground":"#00000000","editorGutter.background":"#00000000"}});languages.register({id:"aql"});languages.setMonarchTokensProvider("aql",language);languages.setLanguageConfiguration("aql",conf);console.log("Registering completion provider for aql language");languages.registerCompletionItemProvider("aql",{triggerCharacters:[" ","|",".","[",",",'"'],provideCompletionItems:async(F,w)=>{console.log("Completion provider triggered at position:",w);const D=F.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:w.lineNumber,endColumn:w.column}),O=F.getLineContent(w.lineNumber),W=D.split(/\|/).map(ae=>ae.trim()),U=W[W.length-1];console.log("segments:",W,"last:",JSON.stringify(U));const K=[],q=schemaManager.getSchemas(),G=D.trim().split(/\s+/)[0].toLowerCase(),Q=q.includes(G)?G:schemaManager.getDefaultSchema(),Y=(ae=w.column,le=w.column)=>({startLineNumber:w.lineNumber,startColumn:ae,endLineNumber:w.lineNumber,endColumn:le}),X=O.substring(0,w.column-1);console.log("lineText for analysis:",JSON.stringify(X));const J=X.match(/([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)\.$/)||X.match(/([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)\.[a-zA-Z0-9_]*$/);if(console.log("dotMatch result:",J),J){const ae=J[1];return(await schemaManager.resolveNested(Q,ae)).forEach(de=>K.push({label:de.name,kind:languages.CompletionItemKind.Field,insertText:de.type==="object"?`${de.name}.`:`${de.name} `,range:Y(),detail:de.type,documentation:de.examples?.join(", ")})),{suggestions:K}}const te=X.match(/([\w\.]+)\s*(==|!=|>=|<=|>|<|=~)\s*$/);if(te){const ae=te[1];return(await schemaManager.resolveValues(Q,ae)).forEach(de=>K.push({label:String(de),kind:languages.CompletionItemKind.Value,insertText:typeof de=="string"?`"${de}" `:`${de} `,range:Y()})),{suggestions:K}}if(/".*"\s*$/.test(X)||/\d+\s*$/.test(X))return["and","or","|"].forEach(ae=>K.push({label:ae,kind:languages.CompletionItemKind.Operator,insertText:`${ae} `,range:Y()})),{suggestions:K};const se=X.match(/\b(and|or)\s+$/i);if(se)return(await schemaManager.resolveNested(Q,"")).forEach(le=>K.push({label:le.name,kind:languages.CompletionItemKind.Field,detail:le.type,documentation:le.examples?.join(", "),insertText:le.type==="object"?`${le.name}.`:`${le.name} `,range:Y()})),{suggestions:K};if(X.match(/([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)\s+$/)&&!se)return["==","!=",">","<",">=","<=","=~","and","or","not","exists"].forEach(ae=>K.push({label:ae,kind:languages.CompletionItemKind.Operator,insertText:`${ae} `,range:Y()})),{suggestions:K};if(W.length===1&&(U===""||!q.some(ae=>U.toLowerCase().startsWith(ae)))){if(q.filter(ae=>U===""||ae.toLowerCase().startsWith(U.toLowerCase().trim())).forEach(ae=>K.push({label:ae,kind:languages.CompletionItemKind.Module,insertText:`${ae} `,range:Y()})),U===""||!q.some(ae=>U.toLowerCase().trim().startsWith(ae))){const ae=schemaManager.getDefaultSchema();(await schemaManager.resolveNested(ae,"")).forEach(de=>K.push({label:de.name,kind:languages.CompletionItemKind.Field,detail:de.type,documentation:de.examples?.join(", "),insertText:de.type==="object"?`${de.name}.`:`${de.name} `,range:Y()}))}return{suggestions:K}}return W.length===1&&q.some(ae=>ae.startsWith(U.toLowerCase()))?(q.filter(ae=>ae.startsWith(U.toLowerCase())).forEach(ae=>K.push({label:ae,kind:languages.CompletionItemKind.Module,insertText:`${ae} `,range:Y()})),{suggestions:K}):W.length===1&&q.includes(U.toLowerCase())?(["limit","stats","timechart"].forEach(le=>K.push({label:le,kind:languages.CompletionItemKind.Keyword,insertText:`${le} `,range:Y()})),(await schemaManager.resolveNested(Q,"")).forEach(le=>K.push({label:le.name,kind:languages.CompletionItemKind.Field,insertText:le.type==="object"?`${le.name}.`:`${le.name} `,range:Y()})),{suggestions:K}):/stats|timechart/i.test(U)?/stats\s|timechart\s/i.test(U)?(["count","sum","avg","min","max","median","stdev","range","p50","p75","p90","p95","p99","p100"].forEach(le=>K.push({label:le,kind:languages.CompletionItemKind.Function,insertText:`${le}(`,range:Y()})),/\bby\s*$/i.test(U)?(await schemaManager.resolveNested(Q,"")).forEach(de=>K.push({label:de.name,kind:languages.CompletionItemKind.Field,insertText:de.type==="object"?`${de.name}.`:`${de.name} `,range:Y()})):K.push({label:"by",kind:languages.CompletionItemKind.Keyword,insertText:"by ",range:Y()}),/timechart/i.test(U)&&["[5m]","[1h]"].forEach(le=>K.push({label:le,kind:languages.CompletionItemKind.Value,insertText:le,range:Y()})),{suggestions:K}):{suggestions:K}:(["==","!=",">","<",">=","<=","=~","and","or","not","exists"].forEach(le=>K.push({label:le,kind:languages.CompletionItemKind.Operator,insertText:`${le} `,range:Y()})),(await schemaManager.resolveNested(Q,"")).forEach(le=>K.push({label:le.name,kind:languages.CompletionItemKind.Field,detail:le.type,documentation:le.examples?.join(", "),insertText:le.type==="object"?`${le.name}.`:`${le.name} `,range:Y()})),{suggestions:K})}});let QueryEditorComponent=class extends i$3{constructor(){super(...arguments),this.createRenderRoot=()=>this,this.completionItems=[],this.recentSearches=[],this.savedViews=[],this.popularSearches=[],this.showSuggestions=!1,this.currentQuery="",this.selectedIndex=-1,this.defaultValue="",this.editor=null,this.suggestionListeners=[],this.isProgrammaticUpdate=!1,this.updateHandlers=[],this.KIND_ICONS=["📄","🔢","🔍","#","📊","📋","#","🔢","✅","❓"],this.debouncedTriggerSuggestions=lodashExports.debounce(()=>this.editor?.trigger("auto","editor.action.triggerSuggest",{}),50),this.debouncedUpdateQuery=lodashExports.debounce(F=>{this.dispatchEvent(new CustomEvent("update-query",{detail:{value:F},bubbles:!0}));const w=new URL(window.location.href);F.trim()?w.searchParams.set("query",F):w.searchParams.delete("query"),window.history.replaceState({},"",w.toString())},300),this.handleKeyboardNavigation=F=>{if(!this.showSuggestions)return;const w=this.getTotalVisibleSuggestions();if(w===0)return;const D=()=>{F.preventDefault(),F.stopPropagation()},O=F.browserEvent.key;({ArrowDown:()=>{D(),this.selectedIndex=(this.selectedIndex+1)%w,this.scrollSelectedIntoView()},ArrowUp:()=>{D(),this.selectedIndex=this.selectedIndex<=0?w-1:this.selectedIndex-1,this.scrollSelectedIntoView()},Tab:()=>{F.browserEvent.shiftKey?(D(),this.selectedIndex=this.selectedIndex<=0?w-1:this.selectedIndex-1,this.scrollSelectedIntoView()):(D(),this.selectedIndex=(this.selectedIndex+1)%w,this.scrollSelectedIntoView())},Enter:()=>{if(this.selectedIndex>=0){D();const U=this.getItemAtIndex(this.selectedIndex);U&&this.insertCompletion(U)}else{D(),this.showSuggestions=!1,this.selectedIndex=-1;const U=this.editor?.getModel();U&&this.debouncedUpdateQuery(U.getValue())}},Escape:()=>{D(),this.showSuggestions=!1,this.selectedIndex=-1}})[O]?.()}}setPopularSearches(F){F?.length&&(this.popularSearches=F.map(w=>({kind:"popularSearch",query:w.query,description:w.description||""})))}get serviceSuggestions(){return[...this.completionItems,...this.savedViews,...this.recentSearches,...this.popularSearches]}async firstUpdated(){this._editorContainer&&(this.defaultValue=this.getAttribute("default-value")||"",this.createMonacoEditor(),this.setupSuggestions(),this.addEventListener("keydown",F=>{F.key==="Escape"&&this.showSuggestions&&(this.showSuggestions=!1)}),window.addEventListener("resize",()=>this.editor?.layout()),document.addEventListener("keydown",F=>{if(F.key==="/"&&!F.ctrlKey&&!F.metaKey&&!F.altKey){const w=F.target;w.tagName!=="INPUT"&&w.tagName!=="TEXTAREA"&&w.contentEditable!=="true"&&(F.preventDefault(),this.editor?.focus())}}))}disconnectedCallback(){this.suggestionListeners.forEach(F=>F()),this.suggestionListeners=[],this.updateHandlers.forEach(F=>F.dispose()),this.updateHandlers=[],this.editor?.dispose(),super.disconnectedCallback()}setSchema(F){schemaManager.setSchema(F)}setDynamicResolver(F){schemaManager.setDynamicResolver(F)}setQueryLibrary(F){if(!F?.length)return;const w=O=>O,D=lodashExports.groupBy(F,"queryType");this.recentSearches=(D.history||[]).map(O=>({kind:"recentSearch",query:w(O.queryText),timestamp:this.formatRelativeTime(new Date(O.updatedAt))})),this.savedViews=(D.saved||[]).map(O=>({kind:"savedView",name:O.title||`Query ${O.id.substring(0,8)}`,query:w(O.queryText),owner:{name:O.byMe?"You":"Other",icon:O.byMe?"👤":"👥"}}))}handleAddQuery(F,w=!1){if(!this.editor)return;const D=document.activeElement,O=this.editor.hasTextFocus();this.isProgrammaticUpdate=!0;const W=this.editor.focus,U=this.editor.trigger,K=this.editor.getDomNode();this.editor.focus=()=>{},this.editor.trigger=()=>{};const q=G=>{(G.target===K||K?.contains(G.target))&&(G.preventDefault(),G.stopPropagation(),G.stopImmediatePropagation())};document.addEventListener("focus",q,!0),document.addEventListener("focusin",q,!0);try{const G=this.editor.getValue().trim(),Q=w?F:G?`${G} and ${F}`:F;this.editor.setValue(Q);const Y=this.editor.getModel();if(Y){const J=Y.getLineCount(),te=Y.getLineMaxColumn(J);this.editor.setPosition({lineNumber:J,column:te})}this.showSuggestions=!1,this.selectedIndex=-1;const X=new URL(window.location.href);Q.trim()?X.searchParams.set("query",Q):X.searchParams.delete("query"),window.history.replaceState({},"",X.toString()),this.dispatchEvent(new CustomEvent("update-query",{detail:{value:Q},bubbles:!0})),this.updatePlaceholder()}finally{setTimeout(()=>{this.editor.focus=W.bind(this.editor),this.editor.trigger=U.bind(this.editor),document.removeEventListener("focus",q,!0),document.removeEventListener("focusin",q,!0),this.isProgrammaticUpdate=!1,!O&&D&&D!==K&&!K?.contains(D)&&(D.focus(),setTimeout(()=>{(document.activeElement===K||K?.contains(document.activeElement))&&D.focus()},50))},0)}}formatRelativeTime(F){const w=Math.floor((Date.now()-F.getTime())/1e3),D=[{threshold:60,unit:"just now"},{threshold:3600,unit:"minutes ago",divisor:60},{threshold:86400,unit:"hours ago",divisor:3600},{threshold:1/0,unit:"days ago",divisor:86400}];for(const{threshold:O,unit:W,divisor:U}of D)if(w<O)return U?`${Math.floor(w/U)} ${W}`:W;return""}createMonacoEditor(){this.editor=editor.create(this._editorContainer,{value:this.defaultValue,language:"aql",theme:"transparent-theme",automaticLayout:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"off",roundedSelection:!1,readOnly:!1,cursorStyle:"line",fontLigatures:!0,fontSize:14,"semanticHighlighting.enabled":!0,quickSuggestions:{other:!0,comments:!1,strings:!1},suggestOnTriggerCharacters:!0,suggest:{showIcons:!1,snippetsPreventQuickSuggestions:!1,filterGraceful:!0,showWords:!1},wordWrap:"on",wrappingStrategy:"advanced",wrappingIndent:"indent",glyphMargin:!1,folding:!1,padding:{top:8,bottom:4},renderLineHighlight:"none",overviewRulerBorder:!1,overviewRulerLanes:0,hideCursorInOverviewRuler:!0,scrollbar:{vertical:"hidden",horizontal:"hidden"}}),this.setupEditorEvents(),this.adjustEditorHeight(),setTimeout(()=>this.updatePlaceholder(),100)}setupEditorEvents(){if(!this.editor)return;this.updateHandlers.forEach(D=>D.dispose()),this.updateHandlers=[],this.editor.addCommand(KeyMod.CtrlCmd|KeyCode.Enter,()=>{const D=this.editor?.getPosition();D&&this.editor?.executeEdits("insert-line",[{range:{startLineNumber:D.lineNumber,startColumn:D.column,endLineNumber:D.lineNumber,endColumn:D.column},text:`
`}])});let F=!1;document.addEventListener("mousedown",D=>{F=!!this.querySelector(".suggestions-dropdown")?.contains(D.target)});const w=[this.editor.onDidFocusEditorText(()=>{this.isProgrammaticUpdate||(this.showSuggestions=!0,this.updatePlaceholder(),setTimeout(()=>{this.isProgrammaticUpdate||this.editor?.trigger("focus","editor.action.triggerSuggest",{})},10))}),this.editor.onMouseDown(()=>{this.isProgrammaticUpdate||setTimeout(()=>{!this.isProgrammaticUpdate&&this.editor?.hasTextFocus()&&(this.showSuggestions=!0)},10)}),this.editor.onDidBlurEditorText(()=>{setTimeout(()=>{!this.editor?.hasTextFocus()&&!F&&(this.showSuggestions=!1),this.updatePlaceholder()},300)}),this.editor.onKeyDown(this.handleKeyboardNavigation),this.editor.onDidChangeModelContent(()=>{if(!this.isProgrammaticUpdate){const D=this.editor?.getModel(),O=this.editor?.getPosition();if(!D||!O)return;this.currentQuery=D.getLineContent(O.lineNumber),this.showSuggestions=!0,this.updatePlaceholder(),this.debouncedUpdateQuery(D.getValue()),this.debouncedTriggerSuggestions()}}),this.editor.onDidContentSizeChange(()=>this.editor?.layout())];this.updateHandlers.push(...w)}scrollSelectedIntoView(){requestAnimationFrame(()=>{this.querySelector(`[data-index="${this.selectedIndex}"]`)?.scrollIntoView({block:"nearest"})})}adjustEditorHeight(){this.editor&&this.editor.layout()}updatePlaceholder(){if(!this._placeholderElement||!this.editor)return;const F=this.editor.getModel(),w=!F||F.getValue().trim()==="";this._placeholderElement.style.display=w?"block":"none"}updateSuggestions(F=[],w=!1){console.log("updateSuggestions received:",F.slice(0,3));const D=this.editor?.getPosition(),O=this.editor?.getModel();let W="";if(D&&O){const U=O.getLineContent(D.lineNumber).substring(0,D.column-1),K=U.match(/([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)\.$/)||U.match(/([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)\.[a-zA-Z0-9_]*$/);K&&(W=K[1])}this.completionItems=F.slice(0,20).map(U=>{const K=U.completion||U;return{kind:"completion",label:K.label||K.insertText||"Unknown",insertText:K.insertText||K.label||"",kindCategory:K.kind||languages.CompletionItemKind.Field,detail:K.detail||K.documentation||"",score:U.score||2e3,isContextSpecific:w,parentPath:W||void 0}}),this.selectedIndex=-1}getTotalVisibleSuggestions(){const F=this.getMatches();return this.completionItems.length+F.recent.length+F.saved.length+F.popular.length}getItemAtIndex(F){const w=this.getMatches();return[...this.completionItems,...w.recent,...w.saved,...w.popular][F]||null}getMatches(){const w=(this.currentQuery?.toLowerCase()||"").split("|").pop()?.trim()||"",D=(O,W="query")=>w?O.filter(U=>(W==="query"?U.query:U.name).toLowerCase().includes(w)||U.query.toLowerCase().includes(w)).slice(0,5):O.slice(0,5);return{saved:D(this.savedViews,"name"),recent:D(this.recentSearches),popular:D(this.popularSearches)}}handleSuggestionClick(F,w){w.preventDefault(),w.stopPropagation(),console.log(F),this.insertCompletion(F),this.editor?.focus()}insertCompletion(F){if(!this.editor)return;const w=this.editor.getPosition(),D=this.editor.getModel();if(!w||!D)return;let O="",W;if(F.kind==="recentSearch"||F.kind==="savedView"||F.kind==="popularSearch")O=F.query,W={startLineNumber:w.lineNumber,startColumn:1,endLineNumber:w.lineNumber,endColumn:D.getLineMaxColumn(w.lineNumber)};else{O=F.insertText||F.label;const q=D.getLineContent(w.lineNumber),G=q.substring(0,w.column-1);let Y=w.column-1;if(G.match(/([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)\.$/)||G.match(/([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)\.[a-zA-Z0-9_]*$/))Y=G.lastIndexOf(".")+1;else for(;Y>0;){const J=q.charAt(Y-1);if(/\s/.test(J)||/[^\w\d_=<>!&|+\-*/%^.:]/.test(J))break;Y--}W={startLineNumber:w.lineNumber,startColumn:Y+1,endLineNumber:w.lineNumber,endColumn:w.column}}const U=O.endsWith("(")&&!O.includes(" ");try{this.editor.executeEdits("completion",[{range:W,text:O}])}catch(q){console.error("Error executing edit:",q),D.pushEditOperations([],[{range:W,text:O}],()=>null)}if(this.selectedIndex=-1,U){const q={lineNumber:W.startLineNumber,column:W.startColumn+O.length};setTimeout(()=>{this.editor?.setPosition(q),this.editor?.focus()},10)}else this.editor.focus();const K=O.endsWith(".")?0:100;console.log("Triggering suggestions after insertion of:",O),setTimeout(()=>this.editor?.trigger("keyboard","editor.action.triggerSuggest",{}),K)}setupSuggestions(){if(!this.editor)return;this.editor.addCommand(KeyCode.Space|KeyMod.CtrlCmd,()=>this.editor?.trigger("keyboard","editor.action.triggerSuggest",{}));const F=this.editor.getContribution("editor.contrib.suggestController"),w=F?.model||F?._model;["onDidSuggest","_onDidSuggest","onDidTrigger"].forEach(D=>{const O=w?.[D];if(O&&typeof O=="function"){const W=O(U=>{const K=U?.suggestions||U?.completionModel?.items||U?.items||[];K.length>0&&(this.showSuggestions=!0,this.updateSuggestions(K,!0))});W&&this.suggestionListeners.push(W)}})}getCompletionIcon(F){const w=Math.min(Math.max(0,F%10),this.KIND_ICONS.length-1);return this.KIND_ICONS[w]}getSuggestionUIData(F){return{recentSearch:()=>({icon:"⏱️",primaryText:F.query,secondaryText:F.timestamp}),savedView:()=>({icon:"⭐",primaryText:F.name,secondaryText:x`
          <span class="truncate text-gray-500 mr-2" title="${F.query}">${F.query}</span>
          ${F.owner?x`<span class="flex-shrink-0 rounded-full w-6 h-6 flex items-center justify-center text-xs"
                >${F.owner.icon||""}</span
              >`:""}
        `}),popularSearch:()=>({icon:"🔍",primaryText:F.query,secondaryText:F.description}),completion:()=>{const D=F;return D.parentPath?{icon:this.getCompletionIcon(D.kindCategory),primaryText:x` <span class="text-gray-400">${D.parentPath}.</span><span>${D.label}</span> `,secondaryText:D.detail}:{icon:this.getCompletionIcon(D.kindCategory),primaryText:D.label,secondaryText:D.detail}}}[F.kind]()}renderSuggestionItem(F,w){const D=w===this.selectedIndex,{icon:O,primaryText:W,secondaryText:U}=this.getSuggestionUIData(F),K=D?"bg-blue-50":"",q=F.kind==="completion"?(F.parentPath?`${F.parentPath}.${F.label}`:F.label)||"":F.kind==="savedView"?F.name||"Saved View":F.query||"";return x`
      <div
        class="flex items-center justify-between px-4 py-2 hover:bg-blue-50 cursor-pointer border-b border-gray-100 ${K}"
        @click=${G=>this.handleSuggestionClick(F,G)}
        @mouseover=${()=>this.selectedIndex=w}
        data-index="${w}"
      >
        <div class="flex items-center gap-2 overflow-hidden">
          <span class="text-base">${O}</span>
          <span class="truncate ${D?"font-medium text-blue-600":""}" title="${q}">${W}</span>
        </div>
        ${U?x`<span class="text-xs text-gray-500 ml-2 flex-shrink-0 flex items-center">${U}</span>`:""}
      </div>
    `}renderSuggestionDropdown(){if(!this.showSuggestions)return x``;const F=this.getMatches(),w={completion:this.completionItems,saved:F.saved,recent:F.recent,popular:F.popular},D={completion:null,saved:"Saved Views",recent:"Recent Searches",popular:"Popular Searches"},W=["completion","saved","recent","popular"].filter(q=>w[q]?.length>0).map(q=>({items:w[q],title:D[q]}));if(!W.length)return x`
        <div
          class="suggestions-dropdown absolute top-10 left-0 right-0 bg-white border border-gray-200 shadow-lg z-10 overflow-y-auto rounded-md text-xs"
        >
          <div class="px-4 py-2 text-sm text-gray-400 italic">No suggestions found</div>
        </div>
      `;let U=0;const K=x`
      <div class="sticky bottom-0 bg-white z-50 border-t border-gray-200 px-4 py-2 text-xs text-gray-500">
        <span class="mr-2">
          <kbd class="px-1 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs">↑</kbd>
          <kbd class="px-1 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs">↓</kbd>
          <kbd class="px-1 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs">Tab</kbd> to navigate
        </span>
        <span class="mr-2">• <kbd class="px-1 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs">Enter</kbd> to select</span>
        <span>• <kbd class="px-1 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs">Esc</kbd> to close</span>
      </div>
    `;return x`
      <div
        class="suggestions-dropdown absolute top-10 left-0 right-0 bg-white border border-gray-200 shadow-lg z-50 max-h-[80dvh] overflow-y-auto rounded-md text-xs flex flex-col"
      >
        <div class="overflow-y-auto flex-grow min-h-0">
          ${W.map(q=>x`
              ${q.title?x`<div class="text-xs font-semibold text-gray-500 px-4 py-2 uppercase border-t border-b border-gray-100 bg-gray-50">
                    ${q.title}
                  </div>`:""}
              ${q.items.map(G=>this.renderSuggestionItem(G,U++))}
            `)}
        </div>
        ${K}
      </div>
    `}render(){return x`
      <style>
        .monaco-editor .suggest-widget {
          display: none !important;
          visibility: hidden !important;
        }
        .monaco-editor {
          border-radius: 6px;
          outline-color: var(--color-strokeStrong);
        }
        .monaco-editor:focus-within {
          outline-color: var(--color-strokeBrand-strong);
        }
      </style>
      <div class="relative w-full h-full">
        <div class="relative w-full h-full">
          <div id="editor-container" class="h-full"></div>
          <div
            class="placeholder-overlay absolute top-0 left-0 right-0 bottom-0 pointer-events-auto z-[1] text-gray-400 f/nont-mono text-sm leading-[18px] pt-2 pl-2 hidden cursor-text"
            @click=${()=>this.editor?.focus()}
          >
            Filter logs and events. Press <span class="kbd">/</span> to search or <span class="kbd">?</span>
            to ask in Natural language.
          </div>
        </div>
        <div class="absolute top-1 right-1 z-[2]">
          <label
            class="px-3 py-0.5 inline-flex gap-2 items-center cursor-pointer border border-strokeBrand-strong text-textBrand hover:border-strokeBrand-weak rounded-sm group-has-[.ai-search:checked]/fltr:hidden"
            data-tippy-content="Write queries in natural language with APItoolkit AI"
            for="ai-search-chkbox"
          >
            <svg class="inline-block icon h-4 w-4 text-iconBrand ">
              <use href="/public/assets/svgs/fa-sprites/regular.svg#sparkles"></use>
            </svg>
            ask
          </label>
        </div>
        ${this.renderSuggestionDropdown()}
      </div>
    `}};__decorateClass$2([e$2("#editor-container")],QueryEditorComponent.prototype,"_editorContainer",2);__decorateClass$2([e$2(".placeholder-overlay")],QueryEditorComponent.prototype,"_placeholderElement",2);__decorateClass$2([r$2()],QueryEditorComponent.prototype,"completionItems",2);__decorateClass$2([r$2()],QueryEditorComponent.prototype,"recentSearches",2);__decorateClass$2([r$2()],QueryEditorComponent.prototype,"savedViews",2);__decorateClass$2([r$2()],QueryEditorComponent.prototype,"popularSearches",2);__decorateClass$2([r$2()],QueryEditorComponent.prototype,"showSuggestions",2);__decorateClass$2([r$2()],QueryEditorComponent.prototype,"currentQuery",2);__decorateClass$2([r$2()],QueryEditorComponent.prototype,"selectedIndex",2);__decorateClass$2([r$2()],QueryEditorComponent.prototype,"defaultValue",2);QueryEditorComponent=__decorateClass$2([t$2("query-editor")],QueryEditorComponent);window.schemaManager=schemaManager;function initializeDefaultSchema(){schemaManager.setSchemas(["spans","metrics"]),schemaManager.setDefaultSchema("spans"),schemaManager.setNestedResolver(async(F,w)=>{console.log(`Resolving nested fields for schema: ${F}, prefix: ${w}`);const D=schemaManager.getSchemaData(F)||schemaManager.getSchemaData("spans");if(!D?.fields)return[];if(!w)return Object.entries(D.fields).filter(([K])=>!K.includes(".")).map(([K,q])=>({name:K,type:q.field_type,examples:q.examples,fields:Object.keys(D.fields).some(G=>G.startsWith(K+"."))?{}:void 0}));const O=w+".",W=Object.entries(D.fields).filter(([K])=>K.startsWith(O)).map(([K,q])=>{const G=K.substring(O.length),Q=G.indexOf(".");return{childName:Q===-1?G:G.substring(0,Q),fullName:K,info:q,hasNestedFields:Q!==-1}}),U=new Map;return W.forEach(({childName:K,fullName:q,info:G,hasNestedFields:Q})=>{U.has(K)||U.set(K,{name:K,type:G.field_type,examples:G.examples,fields:Q||W.some(Y=>Y.fullName.startsWith(O+K+"."))?{}:void 0})}),Array.from(U.values())}),schemaManager.setValueResolver(async(F,w)=>{console.log(`Resolving values for field: ${w} in schema: ${F}`);const D=schemaManager.getSchemaData(F)||schemaManager.getSchemaData("spans");if(!D?.fields)return[];const O=D.fields[w];if(O&&O.examples)return O.examples.map(U=>String(U));const W={status_code:["OK","ERROR","UNSET"],"attributes.http.request.method":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS"],"resource.service.name":["frontend","backend","api","auth-service"],level:["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"],"severity.text":["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"],kind:["logs","span","request"],"context.trace_id":["trace-123","trace-456"],"context.span_id":["span-abc","span-def"],"attributes.http.response.status_code":["200","201","400","401","403","404","500","502","503"],"resource.telemetry.sdk.language":["javascript","python","java","go","rust","csharp"],"attributes.user.email":["user@example.com","admin@company.com"]};if(W[w])return W[w];for(const[U,K]of Object.entries(W))if(w.includes(U.split(".").pop()||""))return K;if(O)switch(O.field_type){case"string":return["example-value","test-string","sample-data"];case"number":return["100","200","500","1000"];case"boolean":return["true","false"];default:return["value1","value2","value3"]}return["value1","value2","value3"]})}function getPopularQueries(){return[['level == "ERROR"',"Show all error-level logs"],["attributes.exception.type != null","Find logs with exceptions"],['level == "ERROR" and attributes.http.response.status_code >= 500',"Server errors with HTTP 5xx status codes"],['attributes.http.request.method == "POST"',"All POST requests"],["attributes.http.response.status_code >= 400","HTTP errors (4xx and 5xx)"],["attributes.http.response.status_code == 404","Not found errors"],['attributes.http.request.method == "GET" and attributes.http.response.status_code == 200',"Successful GET requests"],["duration > 5000000000","Slow requests (>5 seconds)"],["duration > 1000000000","Requests taking more than 1 second"],['kind == "span" and duration > 500000000',"Slow spans (>500ms)"],['resource.service.name == "api"',"Logs from API service"],['kind == "span"',"All span data"],['kind == "logs"',"All log entries"],["parent_id != null","Child spans with parent relationships"],["attributes.db.operation.name != null","Database operations"],['attributes.db.system.name == "postgresql"',"PostgreSQL database operations"],['attributes.db.query.text contains "SELECT"',"Database SELECT queries"],["attributes.user.id != null","Logs with user information"],["attributes.session.id != null","Logs with session tracking"],["timestamp > ago(1h)","Logs from the last hour"],['timestamp > ago(24h) and level == "WARN"',"Warnings from the last 24 hours"],['attributes.http.request.method == "POST" and attributes.http.response.status_code < 400',"Successful POST requests"],['resource.service.name == "frontend" and level in ["ERROR", "WARN"]',"Frontend service errors and warnings"],['attributes.url.path contains "/api/" and duration > 2000000000',"Slow API endpoint calls"]].map(([F,w])=>({query:F,description:w}))}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$1={CHILD:2},e$1=F=>(...w)=>({_$litDirective$:F,values:w});let i$1=class{constructor(w){}get _$AU(){return this._$AM._$AU}_$AT(w,D,O){this._$Ct=w,this._$AM=D,this._$Ci=O}_$AS(w,D){return this.update(w,D)}update(w,D){return this.render(...D)}};/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{I:t}=Z,f$1=F=>F.strings===void 0,s$1=()=>document.createComment(""),r$1=(F,w,D)=>{const O=F._$AA.parentNode,W=w===void 0?F._$AB:w._$AA;if(D===void 0){const U=O.insertBefore(s$1(),W),K=O.insertBefore(s$1(),W);D=new t(U,K,F,F.options)}else{const U=D._$AB.nextSibling,K=D._$AM,q=K!==F;if(q){let G;D._$AQ?.(F),D._$AM=F,D._$AP!==void 0&&(G=F._$AU)!==K._$AU&&D._$AP(G)}if(U!==W||q){let G=D._$AA;for(;G!==U;){const Q=G.nextSibling;O.insertBefore(G,W),G=Q}}}return D},v=(F,w,D=F)=>(F._$AI(w,D),F),u$1={},m=(F,w=u$1)=>F._$AH=w,p=F=>F._$AH,M=F=>{F._$AP?.(!1,!0);let w=F._$AA;const D=F._$AB.nextSibling;for(;w!==D;){const O=w.nextSibling;w.remove(),w=O}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const s=(F,w)=>{const D=F._$AN;if(D===void 0)return!1;for(const O of D)O._$AO?.(w,!1),s(O,w);return!0},o$1=F=>{let w,D;do{if((w=F._$AM)===void 0)break;D=w._$AN,D.delete(F),F=w}while(D?.size===0)},r=F=>{for(let w;w=F._$AM;F=w){let D=w._$AN;if(D===void 0)w._$AN=D=new Set;else if(D.has(F))break;D.add(F),c$1(w)}};function h(F){this._$AN!==void 0?(o$1(this),this._$AM=F,r(this)):this._$AM=F}function n(F,w=!1,D=0){const O=this._$AH,W=this._$AN;if(W!==void 0&&W.size!==0)if(w)if(Array.isArray(O))for(let U=D;U<O.length;U++)s(O[U],!1),o$1(O[U]);else O!=null&&(s(O,!1),o$1(O));else s(this,F)}const c$1=F=>{F.type==t$1.CHILD&&(F._$AP??=n,F._$AQ??=h)};class f extends i$1{constructor(){super(...arguments),this._$AN=void 0}_$AT(w,D,O){super._$AT(w,D,O),r(this),this.isConnected=w._$AU}_$AO(w,D=!0){w!==this.isConnected&&(this.isConnected=w,w?this.reconnected?.():this.disconnected?.()),D&&(s(this,w),o$1(this))}setValue(w){if(f$1(this._$Ct))this._$Ct._$AI(w,this);else{const D=[...this._$Ct._$AH];D[this._$Ci]=w,this._$Ct._$AI(D,this,0)}}disconnected(){}reconnected(){}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const u=(F,w,D)=>{const O=new Map;for(let W=w;W<=D;W++)O.set(F[W],W);return O},c=e$1(class extends i$1{constructor(F){if(super(F),F.type!==t$1.CHILD)throw Error("repeat() can only be used in text expressions")}dt(F,w,D){let O;D===void 0?D=w:w!==void 0&&(O=w);const W=[],U=[];let K=0;for(const q of F)W[K]=O?O(q,K):K,U[K]=D(q,K),K++;return{values:U,keys:W}}render(F,w,D){return this.dt(F,w,D).values}update(F,[w,D,O]){const W=p(F),{values:U,keys:K}=this.dt(w,D,O);if(!Array.isArray(W))return this.ut=K,U;const q=this.ut??=[],G=[];let Q,Y,X=0,J=W.length-1,te=0,ie=U.length-1;for(;X<=J&&te<=ie;)if(W[X]===null)X++;else if(W[J]===null)J--;else if(q[X]===K[te])G[te]=v(W[X],U[te]),X++,te++;else if(q[J]===K[ie])G[ie]=v(W[J],U[ie]),J--,ie--;else if(q[X]===K[ie])G[ie]=v(W[X],U[ie]),r$1(F,G[ie+1],W[X]),X++,ie--;else if(q[J]===K[te])G[te]=v(W[J],U[te]),r$1(F,W[X],W[J]),J--,te++;else if(Q===void 0&&(Q=u(K,te,ie),Y=u(q,X,J)),Q.has(q[X]))if(Q.has(q[J])){const se=Y.get(K[te]),re=se!==void 0?W[se]:null;if(re===null){const ae=r$1(F,W[X]);v(ae,U[te]),G[te]=ae}else G[te]=v(re,U[te]),r$1(F,W[X],re),W[se]=null;te++}else M(W[J]),J--;else M(W[X]),X++;for(;te<=ie;){const se=r$1(F,G[ie+1]);v(se,U[te]),G[te++]=se}for(;X<=J;){const se=W[X++];se!==null&&M(se)}return this.ut=K,m(F,G),T}});/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class RangeChangedEvent extends Event{constructor(w){super(RangeChangedEvent.eventName,{bubbles:!1}),this.first=w.first,this.last=w.last}}RangeChangedEvent.eventName="rangeChanged";class VisibilityChangedEvent extends Event{constructor(w){super(VisibilityChangedEvent.eventName,{bubbles:!1}),this.first=w.first,this.last=w.last}}VisibilityChangedEvent.eventName="visibilityChanged";class UnpinnedEvent extends Event{constructor(){super(UnpinnedEvent.eventName,{bubbles:!1})}}UnpinnedEvent.eventName="unpinned";/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class ScrollerShim{constructor(w){this._element=null;const D=w??window;this._node=D,w&&(this._element=w)}get element(){return this._element||document.scrollingElement||document.documentElement}get scrollTop(){return this.element.scrollTop||window.scrollY}get scrollLeft(){return this.element.scrollLeft||window.scrollX}get scrollHeight(){return this.element.scrollHeight}get scrollWidth(){return this.element.scrollWidth}get viewportHeight(){return this._element?this._element.getBoundingClientRect().height:window.innerHeight}get viewportWidth(){return this._element?this._element.getBoundingClientRect().width:window.innerWidth}get maxScrollTop(){return this.scrollHeight-this.viewportHeight}get maxScrollLeft(){return this.scrollWidth-this.viewportWidth}}class ScrollerController extends ScrollerShim{constructor(w,D){super(D),this._clients=new Set,this._retarget=null,this._end=null,this.__destination=null,this.correctingScrollError=!1,this._checkForArrival=this._checkForArrival.bind(this),this._updateManagedScrollTo=this._updateManagedScrollTo.bind(this),this.scrollTo=this.scrollTo.bind(this),this.scrollBy=this.scrollBy.bind(this);const O=this._node;this._originalScrollTo=O.scrollTo,this._originalScrollBy=O.scrollBy,this._originalScroll=O.scroll,this._attach(w)}get _destination(){return this.__destination}get scrolling(){return this._destination!==null}scrollTo(w,D){const O=typeof w=="number"&&typeof D=="number"?{left:w,top:D}:w;this._scrollTo(O)}scrollBy(w,D){const O=typeof w=="number"&&typeof D=="number"?{left:w,top:D}:w;O.top!==void 0&&(O.top+=this.scrollTop),O.left!==void 0&&(O.left+=this.scrollLeft),this._scrollTo(O)}_nativeScrollTo(w){this._originalScrollTo.bind(this._element||window)(w)}_scrollTo(w,D=null,O=null){this._end!==null&&this._end(),w.behavior==="smooth"?(this._setDestination(w),this._retarget=D,this._end=O):this._resetScrollState(),this._nativeScrollTo(w)}_setDestination(w){let{top:D,left:O}=w;return D=D===void 0?void 0:Math.max(0,Math.min(D,this.maxScrollTop)),O=O===void 0?void 0:Math.max(0,Math.min(O,this.maxScrollLeft)),this._destination!==null&&O===this._destination.left&&D===this._destination.top?!1:(this.__destination={top:D,left:O,behavior:"smooth"},!0)}_resetScrollState(){this.__destination=null,this._retarget=null,this._end=null}_updateManagedScrollTo(w){this._destination&&this._setDestination(w)&&this._nativeScrollTo(this._destination)}managedScrollTo(w,D,O){return this._scrollTo(w,D,O),this._updateManagedScrollTo}correctScrollError(w){this.correctingScrollError=!0,requestAnimationFrame(()=>requestAnimationFrame(()=>this.correctingScrollError=!1)),this._nativeScrollTo(w),this._retarget&&this._setDestination(this._retarget()),this._destination&&this._nativeScrollTo(this._destination)}_checkForArrival(){if(this._destination!==null){const{scrollTop:w,scrollLeft:D}=this;let{top:O,left:W}=this._destination;O=Math.min(O||0,this.maxScrollTop),W=Math.min(W||0,this.maxScrollLeft);const U=Math.abs(O-w),K=Math.abs(W-D);U<1&&K<1&&(this._end&&this._end(),this._resetScrollState())}}detach(w){return this._clients.delete(w),this._clients.size===0&&(this._node.scrollTo=this._originalScrollTo,this._node.scrollBy=this._originalScrollBy,this._node.scroll=this._originalScroll,this._node.removeEventListener("scroll",this._checkForArrival)),null}_attach(w){this._clients.add(w),this._clients.size===1&&(this._node.scrollTo=this.scrollTo,this._node.scrollBy=this.scrollBy,this._node.scroll=this.scrollTo,this._node.addEventListener("scroll",this._checkForArrival))}}let _ResizeObserver=typeof window<"u"?window.ResizeObserver:void 0;const virtualizerRef=Symbol("virtualizerRef"),SIZER_ATTRIBUTE="virtualizer-sizer";let DefaultLayoutConstructor;class Virtualizer{constructor(w){if(this._benchmarkStart=null,this._layout=null,this._clippingAncestors=[],this._scrollSize=null,this._scrollError=null,this._childrenPos=null,this._childMeasurements=null,this._toBeMeasured=new Map,this._rangeChanged=!0,this._itemsChanged=!0,this._visibilityChanged=!0,this._scrollerController=null,this._isScroller=!1,this._sizer=null,this._hostElementRO=null,this._childrenRO=null,this._mutationObserver=null,this._scrollEventListeners=[],this._scrollEventListenerOptions={passive:!0},this._loadListener=this._childLoaded.bind(this),this._scrollIntoViewTarget=null,this._updateScrollIntoViewCoordinates=null,this._items=[],this._first=-1,this._last=-1,this._firstVisible=-1,this._lastVisible=-1,this._scheduled=new WeakSet,this._measureCallback=null,this._measureChildOverride=null,this._layoutCompletePromise=null,this._layoutCompleteResolver=null,this._layoutCompleteRejecter=null,this._pendingLayoutComplete=null,this._layoutInitialized=null,this._connected=!1,!w)throw new Error("Virtualizer constructor requires a configuration object");if(w.hostElement)this._init(w);else throw new Error('Virtualizer configuration requires the "hostElement" property')}set items(w){Array.isArray(w)&&w!==this._items&&(this._itemsChanged=!0,this._items=w,this._schedule(this._updateLayout))}_init(w){this._isScroller=!!w.scroller,this._initHostElement(w);const D=w.layout||{};this._layoutInitialized=this._initLayout(D)}_initObservers(){this._mutationObserver=new MutationObserver(this._finishDOMUpdate.bind(this)),this._hostElementRO=new _ResizeObserver(()=>this._hostElementSizeChanged()),this._childrenRO=new _ResizeObserver(this._childrenSizeChanged.bind(this))}_initHostElement(w){const D=this._hostElement=w.hostElement;this._applyVirtualizerStyles(),D[virtualizerRef]=this}connected(){this._initObservers();const w=this._isScroller;this._clippingAncestors=getClippingAncestors(this._hostElement,w),this._scrollerController=new ScrollerController(this,this._clippingAncestors[0]),this._schedule(this._updateLayout),this._observeAndListen(),this._connected=!0}_observeAndListen(){this._mutationObserver.observe(this._hostElement,{childList:!0}),this._hostElementRO.observe(this._hostElement),this._scrollEventListeners.push(window),window.addEventListener("scroll",this,this._scrollEventListenerOptions),this._clippingAncestors.forEach(w=>{w.addEventListener("scroll",this,this._scrollEventListenerOptions),this._scrollEventListeners.push(w),this._hostElementRO.observe(w)}),this._hostElementRO.observe(this._scrollerController.element),this._children.forEach(w=>this._childrenRO.observe(w)),this._scrollEventListeners.forEach(w=>w.addEventListener("scroll",this,this._scrollEventListenerOptions))}disconnected(){this._scrollEventListeners.forEach(w=>w.removeEventListener("scroll",this,this._scrollEventListenerOptions)),this._scrollEventListeners=[],this._clippingAncestors=[],this._scrollerController?.detach(this),this._scrollerController=null,this._mutationObserver?.disconnect(),this._mutationObserver=null,this._hostElementRO?.disconnect(),this._hostElementRO=null,this._childrenRO?.disconnect(),this._childrenRO=null,this._rejectLayoutCompletePromise("disconnected"),this._connected=!1}_applyVirtualizerStyles(){const D=this._hostElement.style;D.display=D.display||"block",D.position=D.position||"relative",D.contain=D.contain||"size layout",this._isScroller&&(D.overflow=D.overflow||"auto",D.minHeight=D.minHeight||"150px")}_getSizer(){const w=this._hostElement;if(!this._sizer){let D=w.querySelector(`[${SIZER_ATTRIBUTE}]`);D||(D=document.createElement("div"),D.setAttribute(SIZER_ATTRIBUTE,""),w.appendChild(D)),Object.assign(D.style,{position:"absolute",margin:"-2px 0 0 0",padding:0,visibility:"hidden",fontSize:"2px"}),D.textContent="&nbsp;",D.setAttribute(SIZER_ATTRIBUTE,""),this._sizer=D}return this._sizer}async updateLayoutConfig(w){await this._layoutInitialized;const D=w.type||DefaultLayoutConstructor;if(typeof D=="function"&&this._layout instanceof D){const O={...w};return delete O.type,this._layout.config=O,!0}return!1}async _initLayout(w){let D,O;if(typeof w.type=="function"){O=w.type;const W={...w};delete W.type,D=W}else D=w;O===void 0&&(DefaultLayoutConstructor=O=(await __vitePreload(()=>import("./flow.Cd2WZlRY.js"),[])).FlowLayout),this._layout=new O(W=>this._handleLayoutMessage(W),D),this._layout.measureChildren&&typeof this._layout.updateItemSizes=="function"&&(typeof this._layout.measureChildren=="function"&&(this._measureChildOverride=this._layout.measureChildren),this._measureCallback=this._layout.updateItemSizes.bind(this._layout)),this._layout.listenForChildLoadEvents&&this._hostElement.addEventListener("load",this._loadListener,!0),this._schedule(this._updateLayout)}startBenchmarking(){this._benchmarkStart===null&&(this._benchmarkStart=window.performance.now())}stopBenchmarking(){if(this._benchmarkStart!==null){const w=window.performance.now(),D=w-this._benchmarkStart,W=performance.getEntriesByName("uv-virtualizing","measure").filter(U=>U.startTime>=this._benchmarkStart&&U.startTime<w).reduce((U,K)=>U+K.duration,0);return this._benchmarkStart=null,{timeElapsed:D,virtualizationTime:W}}return null}_measureChildren(){const w={},D=this._children,O=this._measureChildOverride||this._measureChild;for(let W=0;W<D.length;W++){const U=D[W],K=this._first+W;(this._itemsChanged||this._toBeMeasured.has(U))&&(w[K]=O.call(this,U,this._items[K]))}this._childMeasurements=w,this._schedule(this._updateLayout),this._toBeMeasured.clear()}_measureChild(w){const{width:D,height:O}=w.getBoundingClientRect();return Object.assign({width:D,height:O},getMargins(w))}async _schedule(w){this._scheduled.has(w)||(this._scheduled.add(w),await Promise.resolve(),this._scheduled.delete(w),w.call(this))}async _updateDOM(w){this._scrollSize=w.scrollSize,this._adjustRange(w.range),this._childrenPos=w.childPositions,this._scrollError=w.scrollError||null;const{_rangeChanged:D,_itemsChanged:O}=this;this._visibilityChanged&&(this._notifyVisibility(),this._visibilityChanged=!1),(D||O)&&(this._notifyRange(),this._rangeChanged=!1),this._finishDOMUpdate()}_finishDOMUpdate(){this._connected&&(this._children.forEach(w=>this._childrenRO.observe(w)),this._checkScrollIntoViewTarget(this._childrenPos),this._positionChildren(this._childrenPos),this._sizeHostElement(this._scrollSize),this._correctScrollError(),this._benchmarkStart&&"mark"in window.performance&&window.performance.mark("uv-end"))}_updateLayout(){this._layout&&this._connected&&(this._layout.items=this._items,this._updateView(),this._childMeasurements!==null&&(this._measureCallback&&this._measureCallback(this._childMeasurements),this._childMeasurements=null),this._layout.reflowIfNeeded(),this._benchmarkStart&&"mark"in window.performance&&window.performance.mark("uv-end"))}_handleScrollEvent(){if(this._benchmarkStart&&"mark"in window.performance){try{window.performance.measure("uv-virtualizing","uv-start","uv-end")}catch(w){console.warn("Error measuring performance data: ",w)}window.performance.mark("uv-start")}this._scrollerController.correctingScrollError===!1&&this._layout?.unpin(),this._schedule(this._updateLayout)}handleEvent(w){switch(w.type){case"scroll":(w.currentTarget===window||this._clippingAncestors.includes(w.currentTarget))&&this._handleScrollEvent();break;default:console.warn("event not handled",w)}}_handleLayoutMessage(w){w.type==="stateChanged"?this._updateDOM(w):w.type==="visibilityChanged"?(this._firstVisible=w.firstVisible,this._lastVisible=w.lastVisible,this._notifyVisibility()):w.type==="unpinned"&&this._hostElement.dispatchEvent(new UnpinnedEvent)}get _children(){const w=[];let D=this._hostElement.firstElementChild;for(;D;)D.hasAttribute(SIZER_ATTRIBUTE)||w.push(D),D=D.nextElementSibling;return w}_updateView(){const w=this._hostElement,D=this._scrollerController?.element,O=this._layout;if(w&&D&&O){let W,U,K,q;const G=w.getBoundingClientRect();W=0,U=0,K=window.innerHeight,q=window.innerWidth;const Q=this._clippingAncestors.map(ae=>ae.getBoundingClientRect());Q.unshift(G);for(const ae of Q)W=Math.max(W,ae.top),U=Math.max(U,ae.left),K=Math.min(K,ae.bottom),q=Math.min(q,ae.right);const Y=D.getBoundingClientRect(),X={left:G.left-Y.left,top:G.top-Y.top},J={width:D.scrollWidth,height:D.scrollHeight},te=W-G.top+w.scrollTop,ie=U-G.left+w.scrollLeft,se=Math.max(0,K-W),re=Math.max(0,q-U);O.viewportSize={width:re,height:se},O.viewportScroll={top:te,left:ie},O.totalScrollSize=J,O.offsetWithinScroller=X}}_sizeHostElement(w){const O=w&&w.width!==null?Math.min(82e5,w.width):0,W=w&&w.height!==null?Math.min(82e5,w.height):0;if(this._isScroller)this._getSizer().style.transform=`translate(${O}px, ${W}px)`;else{const U=this._hostElement.style;U.minWidth=O?`${O}px`:"100%",U.minHeight=W?`${W}px`:"100%"}}_positionChildren(w){w&&w.forEach(({top:D,left:O,width:W,height:U,xOffset:K,yOffset:q},G)=>{const Q=this._children[G-this._first];Q&&(Q.style.position="absolute",Q.style.boxSizing="border-box",Q.style.transform=`translate(${O}px, ${D}px)`,W!==void 0&&(Q.style.width=W+"px"),U!==void 0&&(Q.style.height=U+"px"),Q.style.left=K===void 0?null:K+"px",Q.style.top=q===void 0?null:q+"px")})}async _adjustRange(w){const{_first:D,_last:O,_firstVisible:W,_lastVisible:U}=this;this._first=w.first,this._last=w.last,this._firstVisible=w.firstVisible,this._lastVisible=w.lastVisible,this._rangeChanged=this._rangeChanged||this._first!==D||this._last!==O,this._visibilityChanged=this._visibilityChanged||this._firstVisible!==W||this._lastVisible!==U}_correctScrollError(){if(this._scrollError){const{scrollTop:w,scrollLeft:D}=this._scrollerController,{top:O,left:W}=this._scrollError;this._scrollError=null,this._scrollerController.correctScrollError({top:w-O,left:D-W})}}element(w){return w===1/0&&(w=this._items.length-1),this._items?.[w]===void 0?void 0:{scrollIntoView:(D={})=>this._scrollElementIntoView({...D,index:w})}}_scrollElementIntoView(w){if(w.index>=this._first&&w.index<=this._last)this._children[w.index-this._first].scrollIntoView(w);else if(w.index=Math.min(w.index,this._items.length-1),w.behavior==="smooth"){const D=this._layout.getScrollIntoViewCoordinates(w),{behavior:O}=w;this._updateScrollIntoViewCoordinates=this._scrollerController.managedScrollTo(Object.assign(D,{behavior:O}),()=>this._layout.getScrollIntoViewCoordinates(w),()=>this._scrollIntoViewTarget=null),this._scrollIntoViewTarget=w}else this._layout.pin=w}_checkScrollIntoViewTarget(w){const{index:D}=this._scrollIntoViewTarget||{};D&&w?.has(D)&&this._updateScrollIntoViewCoordinates(this._layout.getScrollIntoViewCoordinates(this._scrollIntoViewTarget))}_notifyRange(){this._hostElement.dispatchEvent(new RangeChangedEvent({first:this._first,last:this._last}))}_notifyVisibility(){this._hostElement.dispatchEvent(new VisibilityChangedEvent({first:this._firstVisible,last:this._lastVisible}))}get layoutComplete(){return this._layoutCompletePromise||(this._layoutCompletePromise=new Promise((w,D)=>{this._layoutCompleteResolver=w,this._layoutCompleteRejecter=D})),this._layoutCompletePromise}_rejectLayoutCompletePromise(w){this._layoutCompleteRejecter!==null&&this._layoutCompleteRejecter(w),this._resetLayoutCompleteState()}_scheduleLayoutComplete(){this._layoutCompletePromise&&this._pendingLayoutComplete===null&&(this._pendingLayoutComplete=requestAnimationFrame(()=>requestAnimationFrame(()=>this._resolveLayoutCompletePromise())))}_resolveLayoutCompletePromise(){this._layoutCompleteResolver!==null&&this._layoutCompleteResolver(),this._resetLayoutCompleteState()}_resetLayoutCompleteState(){this._layoutCompletePromise=null,this._layoutCompleteResolver=null,this._layoutCompleteRejecter=null,this._pendingLayoutComplete=null}_hostElementSizeChanged(){this._schedule(this._updateLayout)}_childLoaded(){}_childrenSizeChanged(w){if(this._layout?.measureChildren){for(const D of w)this._toBeMeasured.set(D.target,D.contentRect);this._measureChildren()}this._scheduleLayoutComplete(),this._itemsChanged=!1,this._rangeChanged=!1}}function getMargins(F){const w=window.getComputedStyle(F);return{marginTop:getMarginValue(w.marginTop),marginRight:getMarginValue(w.marginRight),marginBottom:getMarginValue(w.marginBottom),marginLeft:getMarginValue(w.marginLeft)}}function getMarginValue(F){const w=F?parseFloat(F):NaN;return Number.isNaN(w)?0:w}function getParentElement(F){if(F.assignedSlot!==null)return F.assignedSlot;if(F.parentElement!==null)return F.parentElement;const w=F.parentNode;return w&&w.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&w.host||null}function getElementAncestors(F,w=!1){const D=[];let O=w?F:getParentElement(F);for(;O!==null;)D.push(O),O=getParentElement(O);return D}function getClippingAncestors(F,w=!1){let D=!1;return getElementAncestors(F,w).filter(O=>{if(D)return!1;const W=getComputedStyle(O);return D=W.position==="fixed",W.overflow!=="visible"})}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const defaultKeyFunction=F=>F,defaultRenderItem=(F,w)=>x`${w}: ${JSON.stringify(F,null,2)}`;class VirtualizeDirective extends f{constructor(w){if(super(w),this._virtualizer=null,this._first=0,this._last=-1,this._renderItem=(D,O)=>defaultRenderItem(D,O+this._first),this._keyFunction=(D,O)=>defaultKeyFunction(D,O+this._first),this._items=[],w.type!==t$1.CHILD)throw new Error("The virtualize directive can only be used in child expressions")}render(w){w&&this._setFunctions(w);const D=[];if(this._first>=0&&this._last>=this._first)for(let O=this._first;O<=this._last;O++)D.push(this._items[O]);return c(D,this._keyFunction,this._renderItem)}update(w,[D]){this._setFunctions(D);const O=this._items!==D.items;return this._items=D.items||[],this._virtualizer?this._updateVirtualizerConfig(w,D):this._initialize(w,D),O?T:this.render()}async _updateVirtualizerConfig(w,D){if(!await this._virtualizer.updateLayoutConfig(D.layout||{})){const W=w.parentNode;this._makeVirtualizer(W,D)}this._virtualizer.items=this._items}_setFunctions(w){const{renderItem:D,keyFunction:O}=w;D&&(this._renderItem=(W,U)=>D(W,U+this._first)),O&&(this._keyFunction=(W,U)=>O(W,U+this._first))}_makeVirtualizer(w,D){this._virtualizer&&this._virtualizer.disconnected();const{layout:O,scroller:W,items:U}=D;this._virtualizer=new Virtualizer({hostElement:w,layout:O,scroller:W}),this._virtualizer.items=U,this._virtualizer.connected()}_initialize(w,D){const O=w.parentNode;O&&O.nodeType===1&&(O.addEventListener("rangeChanged",W=>{this._first=W.first,this._last=W.last,this.setValue(this.render())}),this._makeVirtualizer(O,D))}disconnected(){this._virtualizer?.disconnected()}reconnected(){this._virtualizer?.connected()}}const virtualize=e$1(VirtualizeDirective);var __defProp$1=Object.defineProperty,__getOwnPropDesc$1=Object.getOwnPropertyDescriptor,__decorateClass$1=(F,w,D,O)=>{for(var W=O>1?void 0:O?__getOwnPropDesc$1(w,D):w,U=F.length-1,K;U>=0;U--)(K=F[U])&&(W=(O?K(w,D,W):K(W))||W);return O&&W&&__defProp$1(w,D,W),W};let LogList=class extends i$3{constructor(){super(),this.expandedTraces={},this.flipDirection=!1,this.isLoadingRecent=!1,this.spanListTree=[],this.recentDataToBeAdded=[],this.isLoading=!1,this.view="tree",this.shouldScrollToBottom=!1,this.logsColumns=[],this.wrapLines=!1,this.hasMore=!1,this.isLiveStreaming=!1,this.resizeTarget=null,this.mouseState={x:0},this.colIdxMap={},this.serviceColors={},this.columnMaxWidthMap={},this.nextFetchUrl="",this.recentFetchUrl="",this.fetchedNew=!1,this.liveStreamInterval=null,this.barChart=null,this.projectId="",this.lineChart=null,this._observer=null,this.updateTableData=(w,D,O,W,U,K)=>{this.logsColumns=[...D],this.colIdxMap={...O},this.hasMore=w.length>0,this.serviceColors={...W},this.nextFetchUrl=U,this.recentFetchUrl=K,this.spanListTree=this.buildSpanListTree(w),this.updateColumnMaxWidthMap(w),this.requestUpdate()},this.toggleWrapLines=()=>{this.wrapLines=!this.wrapLines,this.requestUpdate()},this.logItemRow=this.logItemRow.bind(this),this.fetchData=this.fetchData.bind(this),this.expandTrace=this.expandTrace.bind(this),this.renderLoadMore=this.renderLoadMore.bind(this),this.updateTableData=this.updateTableData.bind(this),this.handleChartZoom=this.handleChartZoom.bind(this),this.updateColumnMaxWidthMap=this.updateColumnMaxWidthMap.bind(this),this.addWithFlipDirection=this.addWithFlipDirection.bind(this),this.toggleLogRow=this.toggleLogRow.bind(this),this.logItemCol=this.logItemCol.bind(this);const F=document.querySelector("#streamLiveData");F&&F.addEventListener("change",()=>{F.checked?(this.isLiveStreaming=!0,this.liveStreamInterval=setInterval(()=>{this.fetchData(this.recentFetchUrl,!0)},5e3)):(this.liveStreamInterval&&clearInterval(this.liveStreamInterval),this.isLiveStreaming=!1),this.requestUpdate()}),window.addEventListener("mouseup",()=>{this.resizeTarget=null,document.body.style.userSelect="auto"}),window.addEventListener("mousemove",w=>{if(this.resizeTarget===null)return;const D=w.clientX-this.mouseState.x;let O=this.columnMaxWidthMap[this.resizeTarget];O||(O=16),O+=D,O>100&&(this.columnMaxWidthMap[this.resizeTarget]=O,this.requestUpdate()),this.mouseState={x:w.clientX}}),window.addEventListener("load",()=>{this.barChart=window.barChart,this.lineChart=window.lineChart,this.barChart&&this.barChart.on("datazoom",this.handleChartZoom),this.lineChart&&this.lineChart.on("datazoom",this.handleChartZoom)})}updateChartDataZoom(F,w){}getTraceMaxMin(F,w,D,O="max"){const W=[],[U,K,q]=this.flipDirection?[length-1,0,-1]:[0,length,1];for(let G=U;this.flipDirection?G>-1:G<K;G+=q){const Q=this.spanListTree[G].data;if(Q[D]===F)W.push(Q[w]);else if(W.length>0)break}}refetchLogs(){const F=new URLSearchParams(window.location.search),w=window.location.pathname,D=`${window.location.origin}${w}?json=true&${F.toString()}`;this.fetchData(D,!1,!0)}handleChartZoom(F){const w=F.batch?F.batch[0]:void 0;if(!w)return;let D=w.startValue,O=w.endValue;if(D===void 0||O===void 0)return;D=new Date(D).toISOString(),O=new Date(O).toISOString();const W=new URLSearchParams(window.location.search);W.set("from",D),W.set("to",O),W.delete("since");const U=`${window.location.pathname}?${W.toString()}${window.location.hash}`;window.history.replaceState({},"",U);const K=document.getElementById("currentRange");K&&(K.innerText=`${D} - ${O}`),this.dispatchEvent(new CustomEvent("update-query",{bubbles:!0,detail:{ast:W.get("queryAST")||""}}))}connectedCallback(){if(super.connectedCallback(),window.virtualListData){const F=window.virtualListData.requestVecs;this.logsColumns=window.virtualListData.cols,this.colIdxMap=window.virtualListData.colIdxMap,this.serviceColors=window.virtualListData.serviceColors,this.nextFetchUrl=window.virtualListData.nextFetchUrl,this.recentFetchUrl=window.virtualListData.recentFetchUrl,this.projectId=window.virtualListData.projectId,this.expandedTraces={},this.spanListTree=this.buildSpanListTree(F),this.updateColumnMaxWidthMap(F),this.hasMore=F.length>0,this.requestUpdate(),this.fetchedNew=!1,window.virtualListData=null}}firstUpdated(){this.scrollToBottom(),this.setupIntersectionObserver(),window.logListTable=document.querySelector("#resultTable")}updated(F){this.shouldScrollToBottom&&this.flipDirection&&this.scrollToBottom(),F.has("spanListTree")&&this.fetchedNew&&setTimeout(()=>{this.spanListTree.forEach(w=>{w.isNew&&(w.isNew=!1)}),this.fetchedNew=!1},10)}scrollToBottom(){const F=document.getElementById("logs_list_container_inner");F&&(F.scrollTop=F.scrollHeight)}setupIntersectionObserver(){this._observer&&this._observer.disconnect();const F=document.querySelector("#loader"),w=document.querySelector("#logs_list_container_inner");if(!F||!w){setTimeout(()=>{this.setupIntersectionObserver()},1e3);return}const D=new IntersectionObserver(([O])=>{O.isIntersecting&&this.fetchData(this.nextFetchUrl)},{root:w,threshold:[0,.2,.4,.6,.8,1]});D.observe(F),this._observer=D}disconnectedCallback(){this._observer&&this._observer.disconnect(),super.disconnectedCallback()}buildSpanListTree(F){return groupSpans(F,this.colIdxMap,this.expandedTraces,this.flipDirection)}expandTrace(F,w){this.shouldScrollToBottom=!1,this.expandedTraces[w]||(this.expandedTraces[w]=!1),this.expandedTraces[w]=!this.expandedTraces[w];const D=this.expandedTraces[w],O=this.spanListTree.filter(W=>W.traceId===F);O.forEach(W=>{W.id===w&&(W.expanded=D,W.show=!0),W.children>0&&O.forEach(U=>{U.parentIds.includes(w)&&(U.expanded=D,U.show=D,this.expandedTraces[U.id]=D)})}),this.requestUpdate()}fetchData(F,w=!1,D=!1){this.isLoading&&!w||this.isLoadingRecent&&w||(w?this.isLoadingRecent=!0:this.isLoading=!0,fetch(F,{method:"GET",headers:{Accept:"application/json"}}).then(O=>O.json()).then(O=>{if(!O.error){let{logsData:W,serviceColors:U,nextUrl:K,recentUrl:q}=O;if(w||(this.hasMore=W.length>0),W.length===0&&D&&(this.spanListTree=[]),W.length>0){w?this.recentFetchUrl=q:this.nextFetchUrl=K,this.serviceColors={...U,...this.serviceColors};let G=this.buildSpanListTree([...W]);if(D)this.nextFetchUrl=K,this.recentFetchUrl=q,this.spanListTree=G;else if(w){this.fetchedNew=!0,G.forEach(X=>X.isNew=!0);const Q=document.querySelector("#logs_list_container_inner"),Y=Q.scrollTop+Q.clientHeight>=Q.scrollHeight-1;Q&&Y&&(this.shouldScrollToBottom=!0),this.isLiveStreaming&&Q&&Q.scrollTop>30&&!this.flipDirection?this.recentDataToBeAdded=this.addWithFlipDirection(this.recentDataToBeAdded,G):this.isLiveStreaming&&!Y&&this.flipDirection?this.recentDataToBeAdded=this.addWithFlipDirection(this.recentDataToBeAdded,G):this.spanListTree=this.addWithFlipDirection(this.spanListTree,G)}else this.spanListTree=this.addWithFlipDirection(G,this.spanListTree);this.updateColumnMaxWidthMap(W)}}}).catch(O=>{console.error("Error fetching logs:",O)}).finally(()=>{w?this.isLoadingRecent=!1:this.isLoading=!1}),this.requestUpdate())}hideColumn(F){this.logsColumns=this.logsColumns.filter(w=>w!==F),this.requestUpdate()}handleColumnsChanged(F){this.logsColumns=F.detail,this.requestUpdate()}updateColumnMaxWidthMap(F){F.forEach(w=>{Object.entries(this.colIdxMap).forEach(([D,O])=>{let W=8.5;if(!["id"].includes(D)){D==="timestamp"&&(W=6.5);let U=String(w[O]).length*W;if(D==="summary"&&!this.columnMaxWidthMap[D]&&(U=450*W,this.columnMaxWidthMap[D]=U),D==="latency_breakdown"&&!this.columnMaxWidthMap[D]&&(U=100),(D==="latency_breakdown"||D==="summary")&&this.columnMaxWidthMap[D])return;this.columnMaxWidthMap[D]===void 0&&(this.columnMaxWidthMap[D]=12*W),this.columnMaxWidthMap[D]<U&&(this.columnMaxWidthMap[D]=U)}})})}toggleLogRow(F,w,D){const O=document.querySelector("#log_details_container"),W=document.querySelector("#logs_list_container"),U=document.querySelector("#resizer"),K=Number(getComputedStyle(O).width.replace("px",""));if(this.shouldScrollToBottom=!1,K<50){const te=Number(getComputedStyle(W).width.replace("px",""));W.style.width=`${te-550}px`,U&&U.classList.remove("hidden"),updateUrlState("details_width",W.style.width)}document.querySelectorAll(".item-row.bg-fillBrand-strong").forEach(te=>te.classList.remove("bg-fillBrand-strong")),F.currentTarget.classList.add("bg-fillBrand-strong");const G=document.querySelector("#details_indicator");G&&G.classList.add("htmx-request");const[Q,Y,X]=w,J=`/p/${D}/log_explorer/${Q}/${Y}/detailed?source=${X}`;updateUrlState("target_event",`${Q}/${Y}/detailed?source=${X}`),htmx.ajax("GET",J,{target:"#log_details_container",swap:"innerHTML",indicator:"#details_indicator"})}moveColumn(F,w){const D=this.logsColumns.indexOf(F);if(D===-1)return;const O=D+w;O<0||O>=this.logsColumns.length||(this.logsColumns[D]=this.logsColumns[O],this.logsColumns[O]=F,this.requestUpdate())}addWithFlipDirection(F,w){return this.flipDirection?[...F,...w]:[...w,...F]}handleRecentClick(){const F=document.querySelector("#logs_list_container_inner");F&&(F.scrollTop=0),this.handleRecentConcatenation()}handleRecentConcatenation(){this.recentDataToBeAdded.length!==0&&(this.spanListTree=this.addWithFlipDirection(this.spanListTree,this.recentDataToBeAdded),this.recentDataToBeAdded=[])}render(){const F=this.view==="tree"?this.spanListTree.filter(w=>w.show):[...this.spanListTree];return F.unshift("start"),F.push("end"),x`
      ${this.options()}
      <div
        @scroll=${w=>{const D=w.target;this.flipDirection?D.scrollTop+D.clientHeight>=D.scrollHeight-1?this.shouldScrollToBottom=!0:(this.shouldScrollToBottom=!1,this.handleRecentConcatenation()):D.scrollTop===0&&this.handleRecentConcatenation()}}
        class="relative h-full shrink-1 min-w-0 p-0 m-0 bg-white w-full c-scroll pb-12 overflow-y-scroll"
        id="logs_list_container_inner"
      >
        ${this.recentDataToBeAdded.length>0&&!this.flipDirection?x` <div class="sticky left-1/2 -translate-y-1/2 top-[30px] z-50">
              <button
                class="cbadge-sm badge-neutral cursor-pointer bg-fillBrand-strong text-textInverse-strong shadow rounded-lg text-sm absolute"
                @click=${this.handleRecentClick}
              >
                ${this.recentDataToBeAdded.length} new
              </button>
            </div>`:E}

        <table class="table-auto w-max relative ctable table-pin-rows table-pin-cols">
          <thead class="z-10 sticky top-0">
            <tr class="text-textStrong border-b flex min-w-0 relative font-medium ">
              ${this.logsColumns.filter(w=>w!=="latency_breakdown").map(w=>this.logTableHeading(w))}
              ${this.logTableHeading("latency_breakdown")}
            </tr>
          </thead>
          ${F.length===1?emptyState(this.logsColumns.length):E}
          <tbody
            class="min-w-0 text-sm"
            id="log-item-table-body"
            @rangeChanged=${w=>{this.setupIntersectionObserver()}}
            @visibilityChanged=${w=>{this.updateChartDataZoom(w.first,w.last)}}
          >
            ${virtualize({items:F,renderItem:this.logItemRow})}
          </tbody>
        </table>

        ${!this.shouldScrollToBottom&&this.flipDirection?x`<div style="position: sticky;bottom: 0px;overflow-anchor: none;">
              <button
                @click=${()=>{this.shouldScrollToBottom=!0,this.scrollToBottom(),this.handleRecentConcatenation()}}
                data-tip="Scroll to bottom"
                class=${`absolute tooltip tooltip-left right-8 bottom-2 group z-50 ${this.recentDataToBeAdded.length>0?"bg-fillBrand-strong":"bg-bgInverse"} text-white flex justify-center items-center rounded-full shadow-lg h-10 w-10`}
              >
                ${faSprite("arrow-down","regular","h-6 w-6 fill-white stroke-white")}
              </button>
            </div> `:E}
      </div>
    `}createRenderRoot(){return this}logItemCol(F,w){const D=F.data,O=this.wrapLines,W=this.columnMaxWidthMap,U=this.serviceColors,K=this.colIdxMap,q=O?"whitespace-break-spaces":"whitespace-nowrap";switch(w){case"id":let[G,Q,Y]=errorClass(D,K);return x`
          <div class="flex items-center justify-between w-3">
            <span class="col-span-1 h-5 rounded-sm flex">
              ${renderIconWithTippy(Y,`${Q} errors attached; status ${G}`,x``)}
            </span>
          </div>
        `;case"created_at":case"timestamp":let X=lookupVecTextByKey(D,K,w);return x`<div>
          <time class="monospace text-textStrong ${q}" data-tippy-content="timestamp" datetime=${X}
            >${displayTimestamp(X)}</time
          >
        </div>`;case"status_code":let J=lookupVecTextByKey(D,K,"status_code"),te=getStatusColor(J);return J=="UNSET"?E:renderBadge(te,J,"status code");case"method":let ie=lookupVecTextByKey(D,K,w),se=getMethodColor(ie);return renderBadge("min-w-[4rem] cbadge "+se,ie,"method");case"request_type":return lookupVecTextByKey(D,K,w)==="Incoming"?renderIconWithTippy("w-4","Incoming Request => Server",faSprite("arrow-down-left","solid"," h-3 fill-slate-500")):renderIconWithTippy("w-4","Outgoing Request => Client",faSprite("arrow-up-right","solid"," h-3 fill-blue-700"));case"duration":let ae=F.type==="log"?"log":getDurationNSMS(lookupVecTextByKey(D,K,w));return renderBadge("cbadge-sm badge-neutral font-normal bg-fillWeak",ae,"latency");case"severity_text":let le=lookupVecTextByKey(D,K,w)||"UNSET",de=getSeverityColor(le);return le==="UNSET"?E:renderBadge("cbadge-sm cbadge "+de,le);case"body":let oe=lookupVecTextByKey(D,K,w);return renderBadge("space-x-2 "+q,oe);case"status":let ue=lookupVecTextByKey(D,K,w),pe=getSpanStatusColor(ue);return!ue||ue.toLowerCase()==="unset"||ue==="ERROR"?E:renderBadge(pe,ue,"status");case"span_name":let fe=lookupVecTextByKey(D,K,w);return renderBadge("cbadge-sm badge-neutral bg-fillWeak "+q,fe,"span name");case"service":let Ce=lookupVecTextByKey(D,K,w);return x` <div class="w-[16ch]">
          ${renderBadge("cbadge-sm badge-neutral bg-fillWeak "+q,Ce,"service name")}
        </div>`;case"kind":return lookupVecTextByKey(D,K,w).toLowerCase()==="internal"?renderIconWithTippy("w-4 ml-2","Internal span",faSprite("function","regular","h-3 w-3 ")):E;case"latency_breakdown":const{traceStart:Oe,traceEnd:Te,startNs:Re,duration:Me,childrenTimeSpans:Ne,depth:ze,hasErrors:Qe}=F,Ye=U[lookupVecTextByKey(D,K,"span_name")]||"bg-black",Je=Ne.map(({startNs:St,duration:si,data:Se})=>({startNs:St-Oe,duration:si,color:U[lookupVecTextByKey(Se,K,"span_name")]||"bg-black"})),at=W.latency_breakdown||200,st=lookupVecObjectByKey(D,K,"db_attributes"),lt=lookupVecObjectByKey(D,K,"http_attributes"),Tt=lookupVecObjectByKey(D,K,"rpc_attributes"),Ke=lookupVecTextByKey(D,K,"status");return x`
          <div class="flex justify-end items-center gap-1 text-textWeak" style="min-width:${at}px">
            ${Ke==="ERROR"||Qe?renderBadge(getSpanStatusColor("ERROR"),"ERROR"):E}
            ${st.system?renderBadge("cbadge-sm badge-neutral bg-fillWeak border border-strokeWeak",st.system):E}
            ${lt.method&&lt.url?renderBadge("cbadge-sm badge-neutral bg-fillWeak border border-strokeWeak","http"):E}
            ${Tt.system?renderBadge("cbadge-sm badge-neutral bg-fillWeak border border-strokeWeak",Tt.system):E}
            <div class="overflow-visible shrink-0 font-normal">${this.logItemCol(F,"duration")}</div>
            ${spanLatencyBreakdown({start:Re-Oe,depth:ze,duration:Me,traceEnd:Te,color:Ye,children:Je,barWidth:at-12})}
            <span class="w-1"></span>
          </div>
        `;case"http_attributes":const je=lookupVecObjectByKey(D,K,w),{method:et,url:mt,status_code:Mt}=je;if(et||mt||Mt){let St=lookupVecTextByKey(D,K,"kind"),si=getMethodColor(et),Se=getStatusColor(Mt),ge=O?"whitespace-break-spaces":"whitespace-nowrap";return x`
            ${St.toLowerCase()==="server"?renderIconWithTippy("w-4 ml-2","Incoming Request => Server",faSprite("arrow-down-left","solid"," h-3 fill-slate-500")):St.toLowerCase()==="client"?renderIconWithTippy("w-4 ml-2","Outgoing Request  => Client",faSprite("arrow-up-right","solid"," h-3 fill-blue-700")):E}
            ${Mt&&Mt!=="UNSET"?renderBadge(Se,Mt,"status code"):E}
            ${et?renderBadge("min-w-[4rem] text-center cbadge cbadge-sm "+si,et,"method"):E}
            ${mt?renderBadge("cbadge-sm badge-neutral bg-fillWeak "+ge,mt,"url"):E}
          `}break;case"db_attributes":const Et=lookupVecObjectByKey(D,K,w),{system:Ct,statement:Nt}=Et;if(Ct||Nt)return x`
            ${renderIconWithTippy("w-4 ml-2",Ct,faSprite("database","regular","h-3 w-3 fill-slate-500"))}
            ${Nt?renderBadge("cbadge-sm badge-neutral bg-fillWeak",Nt):E}
          `;break;case"rpc_attributes":const zt=lookupVecObjectByKey(D,K,w),{system:ii,method:Ci}=zt;let ni=lookupVecTextByKey(D,K,"kind");if(ii||Ci)return x`
            ${ni.toLowerCase()==="server"?renderIconWithTippy("w-4 ml-2","Incoming Request => Server",faSprite("arrow-down-left","solid"," h-3 fill-slate-500")):ni.toLowerCase()==="client"?renderIconWithTippy("w-4 ml-2","Outgoing Request  => Client",faSprite("arrow-up-right","solid"," h-3 fill-blue-700")):E}
            ${Ci?renderBadge("cbadge-sm badge-neutral bg-fillWeak",Ci):E}
          `;break;case"summary":let vi=lookupVecTextByKey(D,K,w);const{depth:hi,children:jt,traceId:zi,childErrors:Ki,hasErrors:pi,expanded:mi,type:kt,id:ki,isLastChild:Ii,siblingsArr:Jt}=F,_i=pi?"bg-fillError-strong text-white fill-white stroke-strokeError-strong":Ki?"border border-strokeError-strong bg-fillWeak text-textWeak fill-textWeak":"border border-strokeWeak bg-fillWeak text-textWeak fill-textWeak";return x`<div class="flex w-full ${O?"items-start":"items-center"} gap-1">
          ${this.view==="tree"?x`
                <div class="flex items-center gap-1">
                  ${hi>1?new Array(hi-1).fill(1).map((St,si)=>x`<div class=${`ml-[15px] w-4 h-5 shrink-0 ${Jt[si]?"border-l":""}`}></div>`):E}
                  ${hi>0?x`<div class=${`border-l ml-[15px] w-4 ${Ii?"h-3":"h-5"} relative shrink-0`}>
                        <span class=${`border-b w-full absolute left-0 ${Ii?"bottom-0":"top-1/2 -translate-y-1/2"}`}></span>
                      </div>`:E}
                  ${jt>0?x`<button
                        @click=${St=>{St.stopPropagation(),this.expandTrace(zi,ki)}}
                        class=${`hover:border-strokeBrand-strong rounded-sm ml-1 cursor-pointer shrink-0 w-8 px-1 flex justify-center gap-[2px] text-xs items-center h-5 ${_i}`}
                      >
                        ${mi?faSprite("minus","regular","w-3 h-1 shrink-0"):faSprite("plus","regular","w-3 h-3 shrink-0")}
                        ${jt}
                      </button>`:hi===0?E:x`<div class=${`rounded-sm ml-1 shrink-0 w-3 h-5 ${_i}`}></div>`}
                </div>
              `:E}
          <div class=${`flex items-center gap-1 ${O?"break-all flex-wrap":"overflow-hidden"}`}>
            ${kt==="log"?["severity_text","body"].map(St=>this.logItemCol(F,St)):["kind","http_attributes","db_attributes","rpc_attributes","status","span_name"].map(St=>this.logItemCol(F,St))}
            <span class=${"fill-slate-700 "+q}>${vi}</span>
          </div>
        </div>`;default:let Lt=lookupVecTextByKey(D,K,w);return renderBadge("cbadge-sm badge-neutral bg-fillWeak "+q,Lt,w)}}renderLoadMore(){return this.hasMore?x`<tr class="w-full flex relative">
          <td colspan=${String(this.logsColumns.length)} class="relative  pl-[calc(40vw-10ch)]">
            <div
              class="absolute -top-[500px] w-[1px] h-[500px] left-0 flex flex-col justify-end bg-transparent items-center"
              id="loader"
            ></div>
            ${this.isLoading?x`<div class="loading loading-dots loading-md"></div>`:x`
                  <button
                    class="cursor-pointer text-textBrand underline font-semibold w-max mx-auto"
                    @click=${()=>this.fetchData(this.nextFetchUrl)}
                  >
                    Load more
                  </button>
                `}
          </td>
        </tr>`:x`<tr></tr>`}fetchRecent(){return x`<tr class="w-full flex relative" id="recent-logs">
      <td colspan=${String(this.logsColumns.length)} class="relative pl-[calc(40vw-10ch)]" id="recent-logs">
        ${this.isLiveStreaming?x`<p>Live streaming latest data...</p>`:this.isLoadingRecent?x`<div class="loading loading-dots loading-md"></div>`:x`
              <button
                class="cursor-pointer text-textBrand underline font-semibold w-max mx-auto"
                @click=${()=>{this.fetchData(this.recentFetchUrl,!0)}}
              >
                Check for recent data
              </button>
            `}
      </td>
    </tr>`}logTableHeading(F){switch(F){case"id":return x`<td class="p-0 m-0 whitespace-nowrap w-3"></td>`;case"timestamp":case"created_at":return this.tableHeadingWrapper("timestamp",F,"w-[17ch] shrink-0");case"latency_breakdown":return this.tableHeadingWrapper("latency",F,"sticky right-0 shrink-0 bg-fillError-strong");case"status_code":return this.tableHeadingWrapper("status",F,"shrink-0 w-[12ch]");case"method":return this.tableHeadingWrapper("method",F,"shrink-0 w-[12ch]");case"raw_url":case"url_path":return this.tableHeadingWrapper(F,F,"w-[25ch] shrink-0");case"service":return this.tableHeadingWrapper("service",F,"w-[16ch] shrink-0");case"summary":return this.tableHeadingWrapper("summary",F,"w-[1400px] shrink-1");default:return this.tableHeadingWrapper(F,F,"w-[16ch] shrink-0")}}logItemRow(F){if(F==="end")return this.flipDirection?this.fetchRecent():this.renderLoadMore();if(F==="start")return this.flipDirection?this.renderLoadMore():this.fetchRecent();const w=F.type==="log"?"logs":"spans",D=requestDumpLogItemUrlPath(F.data,this.colIdxMap,w);let O=F.isNew;return x`
      <tr
        class=${`item-row relative p-0 flex items-center cursor-pointer whitespace-nowrap ${O?"animate-fadeBg":""}`}
        @click=${W=>this.toggleLogRow(W,D,this.projectId)}
      >
        ${this.logsColumns.filter(W=>W!=="latency_breakdown").map(W=>{const U=getColumnWidth(W);let K=this.columnMaxWidthMap[W];return x`<td
              class=${`${this.wrapLines?"break-all whitespace-wrap":""} bg-white relative ${W==="summary"?"":U}`}
              style=${K?`width: ${K}px;`:""}
            >
              ${this.logItemCol(F,W)}
            </td>`})}
        ${this.logsColumns.includes("latency_breakdown")?x`<td
              class="bg-white sticky right-0 overflow-x-hidden"
              style=${this.columnMaxWidthMap.latency_breakdown?"width: ${this.columnMaxWidthMap['latency_breakdown']}px;":""}
            >
              ${this.logItemCol(F,"latency_breakdown")}
            </td>`:E}
      </tr>
    `}tableHeadingWrapper(F,w,D){let O=this.columnMaxWidthMap[w];return w==="latency_breakdown"&&!O&&(O=100),x`
      <td
        class=${`cursor-pointer p-0 m-0 whitespace-nowrap relative flex justify-between items-center pl-1 text-sm font-normal bg-white ${D||""}`}
        style=${O?`width: ${O}px`:""}
      >
        <div class="dropdown font-medium text-base" data-tippy-content=${F}>
          <div tabindex="0" role="button" class="py-1">
            ${F}
            <span class="ml-1 p-0.5 border border-slate-200 rounded-sm inline-flex">
              ${faSprite("chevron-down","regular","w-3 h-3")}
            </span>
          </div>
          <ul
            tabindex="0"
            class="dropdown-content z-1 flex flex-col font-normal bg-white border w-64 border-strokeWeak p-2 text-sm rounded shadow"
          >
            <li class="px-1 cursor-pointer hover:bg-fillWeak">
              <button class="cursor-pointer py-0.5" @click=${()=>this.hideColumn(w)}>Hide column</button>
            </li>
            <li class="px-1 cursor-pointer hover:bg-fillWeak">
              <button class="cursor-pointer py-0.5" @click=${()=>this.moveColumn(w,-1)}>Move column left</button>
            </li>
            <li class="px-1 cursor-pointer hover:bg-fillWeak">
              <button class="cursor-pointer py-0.5" @click=${()=>this.moveColumn(w,1)}>Move column right</button>
            </li>
          </ul>
        </div>
        <div
          @mousedown=${W=>{this.resizeTarget=w,this.mouseState={x:W.clientX},document.body.style.userSelect="none"}}
          class="w-3 text-gray-200 text-right select-none hover:text-textBrand overflow-hidden font-bold absolute right-0 top-1/2 -translate-y-1/2 h-4 cursor-ew-resize"
        >
          |
        </div>
      </td>
    `}options(){return x`
      <div class="w-full flex justify-end px-2 pb-1 gap-3 ">
        ${x`
          <div class="tabs tabs-box tabs-md p-0 tabs-outline items-center border">
            <button
              @click=${()=>this.view="tree"}
              class=${`flex items-center cursor-pointer justify-center gap-1 px-2 py-1 text-xs rounded ${this.view==="tree"?"bg-gray-200 text-gray-800":"text-textWeak  hover:bg-gray-100"}`}
            >
              ${faSprite("tree","regular","h-4 w-4")}
              <span class="sm:inline hidden">Tree</span>
            </button>

            <button
              @click=${()=>this.view="list"}
              class=${`flex items-center cursor-pointer justify-center gap-1 px-2 py-1 text-xs rounded ${this.view==="list"?"bg-gray-200 text-gray-800":"text-textWeak  hover:bg-gray-100"}`}
            >
              ${faSprite("list-view","regular","h-4 w-4")}
              <span class="sm:inline hidden">List</span>
            </button>
          </div>
        `}
        <button
          class=${`flex items-center cursor-pointer justify-center gap-1 px-2 py-1 text-xs rounded ${this.flipDirection?"bg-gray-200 text-gray-800":"text-textWeak  hover:bg-gray-100"}`}
          @click=${()=>{this.flipDirection=!this.flipDirection,this.spanListTree=this.buildSpanListTree(this.spanListTree.map(F=>F.data).reverse()),this.recentDataToBeAdded=this.buildSpanListTree(this.recentDataToBeAdded.map(F=>F.data).reverse()),this.spanListTree=[...this.spanListTree,...this.recentDataToBeAdded],this.recentDataToBeAdded=[],this.requestUpdate()}}
        >
          ${faSprite("flip-vertical","regular","h-4 w-4")}
          <span class="sm:inline hidden">Flip direction</span>
        </button>

        <button
          class=${`flex items-center cursor-pointer justify-center gap-1 px-2 py-1 text-xs rounded ${this.wrapLines?"bg-gray-200 text-gray-800":"text-textWeak  hover:bg-gray-100"}`}
          @click=${()=>{if(this.wrapLines=!this.wrapLines,this.wrapLines){let F=Number(window.getComputedStyle(document.getElementById("logs_list_container_inner")).width.replace("px",""));this.logsColumns.forEach(w=>{w!=="summary"&&this.columnMaxWidthMap[w]&&(F-=this.columnMaxWidthMap[w]+8)}),this.columnMaxWidthMap.summary=F-20}else this.columnMaxWidthMap.summary=450*8;this.requestUpdate()}}
        >
          ${faSprite("wrap-text","regular","h-4 w-4")}
          <span class="sm:inline hidden">Wrap lines</span>
        </button>

        <columns-settings .columns=${this.logsColumns} @columns-changed=${this.handleColumnsChanged}></columns-settings>
      </div>
    `}};__decorateClass$1([r$2()],LogList.prototype,"expandedTraces",2);__decorateClass$1([r$2()],LogList.prototype,"flipDirection",2);__decorateClass$1([r$2()],LogList.prototype,"isLoadingRecent",2);__decorateClass$1([r$2()],LogList.prototype,"spanListTree",2);__decorateClass$1([r$2()],LogList.prototype,"recentDataToBeAdded",2);__decorateClass$1([r$2()],LogList.prototype,"isLoading",2);__decorateClass$1([r$2()],LogList.prototype,"view",2);__decorateClass$1([r$2()],LogList.prototype,"shouldScrollToBottom",2);__decorateClass$1([r$2()],LogList.prototype,"logsColumns",2);__decorateClass$1([r$2()],LogList.prototype,"wrapLines",2);__decorateClass$1([r$2()],LogList.prototype,"hasMore",2);__decorateClass$1([r$2()],LogList.prototype,"isLiveStreaming",2);LogList=__decorateClass$1([t$2("log-list")],LogList);let ColumnsSettings=class extends i$3{constructor(){super(...arguments),this.showModal=!1,this.searchTerm="",this.showSearchResults=!1,this.dragOverIndex=null,this.columns=[],this.defaultColumns=["trace_id","severity_text","parent_span_id","errors","kind","span_name","status","start_time","end_time","duration","timestamp","service","summary","latency_breakdown"],this.dragIndex=null}createRenderRoot(){return this}updated(F){if(F.has("columns")){const w=new Set(this.defaultColumns),D=[...this.defaultColumns,...this.columns.filter(O=>!w.has(O))];this.defaultColumns=D}}render(){return x`
      <div class="relative dropdown dropdown-end">
        <button
          tabindex="0"
          role="button"
          class=${"flex cursor-pointer items-center justify-center gap-1 px-2 py-1 text-xs rounded focus:bg-fillBrand-strong focus:text-white focus:fill-white"}
          @click=${()=>this.showModal=!this.showModal}
        >
          ${faSprite("gear","regular","h-3 w-3 ")}
          <span class="sm:inline hidden">Options</span>
        </button>
        <div tabindex="0" class="dropdown-content  bg-white border w-64 border-strokeWeak p-2 text-sm rounded shadow">
          <div class="relative mb-4">
            <span class="block mb-1 text-sm text-textStrong font-medium">Add column</span>
            <input
              type="text"
              placeholder="Search columns..."
              class="input input-xs w-full max-w-xs focus:outline-none focus:border-textBrand focus:ring-0"
              .value=${this.searchTerm||""}
              @input=${F=>{this.searchTerm=F.target.value}}
            />

            ${this.searchTerm&&this.searchTerm.length>0?x`
                  <ul class="mt-1 w-full text-sm max-h-48 overflow-y-auto">
                    ${this.defaultColumns.concat(this.columns).filter(F=>!this.columns.some(w=>w===F)&&F.toLowerCase().includes(this.searchTerm.toLowerCase())).map(F=>x`
                            <li
                              class="px-1 py-0.5 hover:bg-fillWeak cursor-pointer"
                              @click=${()=>{let w=this.columns.indexOf("summary");w===-1||F==="latency_breakdown"?this.columns.push(F):this.columns.splice(w,0,F),this.searchTerm="",this._emitChanges()}}
                            >
                              ${F}
                            </li>
                          `)}
                    ${this.defaultColumns.filter(F=>!this.columns.some(w=>w===F)&&F.toLowerCase().includes(this.searchTerm.toLowerCase())).length===0?x`<li class="px-3 py-2 text-gray-400">No results</li>`:""}
                  </ul>
                `:E}
          </div>

          <ul class="flex flex-col gap-1 border-t border-strokeWeak py-2">
            ${this.columns.map((F,w)=>x`
                <li
                  class=${`flex items-center group justify-between  px-1 py-0.5 rounded ${F==="latency_breakdown"?"cursor-default select-none":"cursor-move hover:bg-fillWeak"} ${this.dragOverIndex===w?"border border-strokeBrand-strong":""}`}
                  draggable=${F==="latency_breakdown"?"false":"true"}
                  @dragstart=${D=>this._onDragStart(D,w)}
                  @dragover=${D=>this._onDragOver(D,w)}
                  @drop=${D=>this._onDrop(D,w)}
                >
                  <span class="text-textStrong">${F}</span>
                  <div class="flex items-center gap-2">
                    <button class="hidden group-hover:inline-block cursor-pointer" @click=${()=>this._removeColumn(w)}>
                      ${faSprite("trash-can","regular","h-3 w-3 text-iconNeutral fill-red-600")}
                    </button>
                    ${faSprite("grip-dots-vertical","regular","h-4 w-4 text-iconNeutral")}
                  </div>
                </li>
              `)}
          </ul>
        </div>
      </div>
    `}_onDragOver(F,w){if(F.preventDefault(),this.columns[w]==="latency_breakdown"||w===this.dragIndex){this.dragOverIndex=null;return}this.dragOverIndex=w}_removeColumn(F){this.columns.splice(F,1)}_onDragStart(F,w){this.dragIndex=w}_onDrop(F,w){if(w===this.dragIndex||!this.dragIndex||w===this.columns.length-1&&this.columns[w]==="latency_breakdown")return;const D=this.columns[this.dragIndex];D!=="latency_breakdown"&&(this.columns.splice(this.dragIndex,1),this.columns.splice(w,0,D),this.dragIndex=null,this.dragOverIndex=null,this._emitChanges())}_emitChanges(){this.dispatchEvent(new CustomEvent("columns-changed",{detail:this.columns,bubbles:!0,composed:!0}))}};__decorateClass$1([r$2()],ColumnsSettings.prototype,"showModal",2);__decorateClass$1([r$2()],ColumnsSettings.prototype,"searchTerm",2);__decorateClass$1([r$2()],ColumnsSettings.prototype,"showSearchResults",2);__decorateClass$1([r$2()],ColumnsSettings.prototype,"dragOverIndex",2);__decorateClass$1([r$2()],ColumnsSettings.prototype,"columns",2);ColumnsSettings=__decorateClass$1([t$2("columns-settings")],ColumnsSettings);const faSprite=(F,w,D)=>x`<svg class="${D}"><use href="/public/assets/svgs/fa-sprites/${w}.svg#${F}"></use></svg>`;function displayTimestamp(F){const w=new Date(F)||"";if(typeof w=="string"&&w==="")return w;const D={month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"UTC"};return`${w.toLocaleString("en-US",D)}.${String(w.getUTCMilliseconds()).padStart(3,"0")}`.replace(",","")}function renderBadge(F,w,D=""){return x`<span class=${`relative  ${F} ${D?"tooltip tooltip-right":""}`} data-tip=${D}>${w}</span>`}const lookupVecText=(F,w)=>!Array.isArray(F)||w<0||w>=F.length?"":F[w],lookupVecTextByKey=(F,w,D)=>{if(!Object.prototype.hasOwnProperty.call(w,D))return"";const O=w[D];return lookupVecText(F,O)},lookupVecObjectByKey=(F,w,D)=>{if(!Object.prototype.hasOwnProperty.call(w,D))return{};const O=w[D];return lookupVecText(F,O)||{}};function getStatusColor(F){const w=Number(F);if(!Number.isNaN(w)){if(w<200)return"cbadge-sm badge-neutral";if(w<300)return"cbadge-sm badge-2xx";if(w<400)return"cbadge-sm badge-3xx";if(w>=400)return"cbadge-sm badge-4xx"}return getSpanStatusColor(F)}function getMethodColor(F){return{POST:"cbadge-sm badge-pink",PUT:"cbadge-sm badge-lime",DELETE:"cbadge-sm badge-error",PATCH:"cbadge-sm badge-cyan",GET:"cbadge-sm badge-blue"}[F]||"cbadge-sm badge-neutral bg-fillWeak "}function renderIconWithTippy(F,w,D){return x`<span class=${"shrink-0 inline-flex tooltip tooltip-right "+F} data-tip=${w}>${D}</span>`}function getDurationNSMS(F){let w=0;try{w=parseInt(F)}catch{return"0 ns"}return w>=1e9?(w/1e9).toFixed(1)+" s":w>=1e6?(w/1e6).toFixed(1)+" ms":w>=1e3?(w/1e3).toFixed(1)+" µs":w.toFixed(1)+" ns"}function errorClass(F,w){const D=lookupVecTextByKey(F,w,"errors"),O=lookupVecTextByKey(F,w,"http_attributes").status_code||0,W=lookupVecTextByKey(F,w,"status")||0;let U=" w-1 bg-blue-200 status-indicator ";return D||W==="ERROR"?U=" w-1 bg-red-500 ":O>=400&&(U=" w-1 bg-yellow-500 "),[O,D,U]}function getSeverityColor(F){return F=F?F.toLowerCase():"unset",{debug:"text-gray-500 bg-gray-100",info:"text-brand bg-blue-100",warning:"text-yellow-700 bg-yellow-100",error:"text-red-500 bg-red-100",critical:"text-red-700 bg-red-200 font-bold",notice:"text-green-500 bg-green-100",alert:"text-orange-600 bg-orange-100 font-bold"}[F]||"text-black badge-neutral text-textWeak bg-fillWeak"}function getSpanStatusColor(F){return{ERROR:"cbadge-sm badge-error",OK:"cbadge-sm badge-success"}[F]||"cbadge-sm badge-neutral bg-fillWeak"}function spanLatencyBreakdown({start:F,duration:w,traceEnd:D,depth:O,color:W,children:U,barWidth:K}){const q=w/D*K,G=F/D*K;return x`<div class="-mt-1 shrink-0">
    <div class="flex h-5 relative bg-fillWeak overflow-x-hidden" style=${`width:${K}px`}>
      <div
        class=${`h-full absolute top-0 ${O===0||U.length===0?W:""}`}
        style=${`width:${q}px; left:${G}px`}
      ></div>
      ${U.map(Q=>{const Y=Q.duration/D*K,X=Q.startNs/D*K;return x`<div class=${`h-full absolute top-0 ${Q.color}`} style=${`width:${Y}px; left:${X}px`}></div>`})}
    </div>
  </div>`}function emptyState(F){return x`
    <tr class="w-full flex justify-center">
      <td colspan=${String(F)} class="w-full mx-auto">
        <div class="w-max mx-auto my-8 text-center p-5 sm:py-14 sm:px-24 flex flex-col gap-4">
          <div>${faSprite("empty","regular","h-24 w-24 mx-auto stroke-blue-500 fill-blue-500")}</div>
          <div class="flex flex-col gap-2">
            <h2 class="text-xl text-slate-800 font-bold">${"No Events found"}</h2>
            <p class="text-sm max-w-4xl font-medium text-gray-500">${"You're either not sending events to APItoolkit yet or no results matched your query/filter"}</p>
            <a href="https://apitoolkit.io/docs/sdks/" target="_BLANK" class="btn text-sm w-max mx-auto btn-primary"
              >Read integration guides</a
            >
          </div>
        </div>
      </td>
    </tr>
  `}function requestDumpLogItemUrlPath(F,w,D){const O=lookupVecTextByKey(F,w,"id"),W=lookupVecTextByKey(F,w,"created_at")||lookupVecTextByKey(F,w,"timestamp");return[O,W,D]}function groupSpans(F,w,D,O){const W=new Map,U=w.trace_id,K=w.latency_breakdown,q=w.parent_span_id,G=w.timestamp,Q=w.duration,Y=w.start_time_ns,X=w.errors,J=w.body,te=w.kind;F.forEach(se=>{let re=se[U],ae=se[K];const le=se[q];se[J];const de=se[w.id];(re===""||re===null)&&(re=generateStrId(),se[U]=re),(ae===""||ae===null)&&(ae=generateStrId(),se[K]=ae);let oe=W.get(re);oe===void 0&&(oe={traceId:re,spans:new Map,minStart:1/0,duration:0,startTime:0,trace_start_time:null},W.set(re,oe));const ue=new Date(se[G]),pe=se[Q],fe=se[Y];(!oe.trace_start_time||ue<oe.trace_start_time)&&(oe.trace_start_time=ue),oe.minStart=Math.min(oe.minStart,fe),oe.duration=Math.max(oe.duration,pe),se[te]==="log"?oe.spans.set(de,{id:ae,startNs:fe,children:[],hasErrors:!1,duration:0,parent:null,data:se,type:"log"}):oe.spans.set(ae,{id:ae,startNs:fe,hasErrors:se[X],duration:pe,children:[],parent:le,data:se,type:"span"})}),W.forEach(se=>{const re=new Map;se.spans.forEach(ae=>{if(ae.type==="log"){const le=se.spans.get(ae.id);if(le){le.children.push(ae);let de=le.children.length-1;for(;de>0&&le.children[de].startNs<le.children[de-1].startNs;)[le.children[de],le.children[de-1]]=[le.children[de-1],le.children[de]],de--}else re.set(ae.id,ae)}else{const le=se.spans.get(ae.parent||"");if(le){le.children.push(ae);let de=le.children.length-1;for(;de>0&&le.children[de].startNs<le.children[de-1].startNs;)[le.children[de],le.children[de-1]]=[le.children[de-1],le.children[de]],de--}else re.set(ae.id,ae)}}),se.spans=Array.from(re.values()).sort((ae,le)=>ae.startNs-le.startNs)});const ie=Array.from(W.values()).map(se=>({traceId:se.traceId,spans:Object.values(se.spans),startTime:se.minStart,duration:se.duration}));return O&&ie.reverse(),flattenSpanTree(ie,D)}function flattenSpanTree(F,w={}){const D=[];function O(W,U,K,q,G,Q=0,Y=!1,X=[]){let J=W.children.length,te=!1;const ie={depth:Q,traceStart:q,traceEnd:G,traceId:U,childErrors:te,isNew:!1,parentIds:K,show:w[U]||Q===0,expanded:w[U],isLastChild:Y,siblingsArr:X,...W,children:J,childrenTimeSpans:W.children.map(re=>({startNs:re.startNs,duration:re.duration,data:re.data}))};D.push(ie);const se=W.children.length>1;return W.children.forEach((re,ae)=>{te=re.hasErrors||te;const le=ae===W.children.length-1,de=se&&!le?[...X,!0]:[...X,!1],[oe,ue]=O(re,U,[...K,W.id],q,G,Q+1,le,de);J+=oe,te=te||ue}),ie.children=J,ie.childErrors=te,[J,te]}return F.forEach(W=>{W.spans.forEach(U=>{O(U,W.traceId,[],W.startTime,W.duration,0)})}),D}function getColumnWidth(F){if(!["summary","service","id","method","status_code","raw_url","url_path"].includes(F))return"w-[16ch] shrink-0";switch(F){case"status":case"method":case"status_code":return"w-[12ch] shrink-0";case"raw_url":case"url_path":return"w-[25ch] shrink-0 overflow-hidden";case"sumarry":return"w-3/4 shrink-1";default:return""}}function generateStrId(){return Math.random().toString(36).substring(2,15)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class e extends i$1{constructor(w){if(super(w),this.it=E,w.type!==t$1.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(w){if(w===E||w==null)return this._t=void 0,this.it=w;if(w===T)return w;if(typeof w!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(w===this.it)return this._t;this.it=w;const D=[w];return D.raw=D,this._t={_$litType$:this.constructor.resultType,strings:D,values:[]}}}e.directiveName="unsafeHTML",e.resultType=1;const o=e$1(e);/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function isNothing(F){return typeof F>"u"||F===null}function isObject(F){return typeof F=="object"&&F!==null}function toArray(F){return Array.isArray(F)?F:isNothing(F)?[]:[F]}function extend(F,w){var D,O,W,U;if(w)for(U=Object.keys(w),D=0,O=U.length;D<O;D+=1)W=U[D],F[W]=w[W];return F}function repeat(F,w){var D="",O;for(O=0;O<w;O+=1)D+=F;return D}function isNegativeZero(F){return F===0&&Number.NEGATIVE_INFINITY===1/F}var isNothing_1=isNothing,isObject_1=isObject,toArray_1=toArray,repeat_1=repeat,isNegativeZero_1=isNegativeZero,extend_1=extend,common={isNothing:isNothing_1,isObject:isObject_1,toArray:toArray_1,repeat:repeat_1,isNegativeZero:isNegativeZero_1,extend:extend_1};function formatError(F,w){var D="",O=F.reason||"(unknown reason)";return F.mark?(F.mark.name&&(D+='in "'+F.mark.name+'" '),D+="("+(F.mark.line+1)+":"+(F.mark.column+1)+")",!w&&F.mark.snippet&&(D+=`

`+F.mark.snippet),O+" "+D):O}function YAMLException$1(F,w){Error.call(this),this.name="YAMLException",this.reason=F,this.mark=w,this.message=formatError(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}YAMLException$1.prototype=Object.create(Error.prototype);YAMLException$1.prototype.constructor=YAMLException$1;YAMLException$1.prototype.toString=function(w){return this.name+": "+formatError(this,w)};var exception=YAMLException$1;function getLine(F,w,D,O,W){var U="",K="",q=Math.floor(W/2)-1;return O-w>q&&(U=" ... ",w=O-q+U.length),D-O>q&&(K=" ...",D=O+q-K.length),{str:U+F.slice(w,D).replace(/\t/g,"→")+K,pos:O-w+U.length}}function padStart(F,w){return common.repeat(" ",w-F.length)+F}function makeSnippet(F,w){if(w=Object.create(w||null),!F.buffer)return null;w.maxLength||(w.maxLength=79),typeof w.indent!="number"&&(w.indent=1),typeof w.linesBefore!="number"&&(w.linesBefore=3),typeof w.linesAfter!="number"&&(w.linesAfter=2);for(var D=/\r?\n|\r|\0/g,O=[0],W=[],U,K=-1;U=D.exec(F.buffer);)W.push(U.index),O.push(U.index+U[0].length),F.position<=U.index&&K<0&&(K=O.length-2);K<0&&(K=O.length-1);var q="",G,Q,Y=Math.min(F.line+w.linesAfter,W.length).toString().length,X=w.maxLength-(w.indent+Y+3);for(G=1;G<=w.linesBefore&&!(K-G<0);G++)Q=getLine(F.buffer,O[K-G],W[K-G],F.position-(O[K]-O[K-G]),X),q=common.repeat(" ",w.indent)+padStart((F.line-G+1).toString(),Y)+" | "+Q.str+`
`+q;for(Q=getLine(F.buffer,O[K],W[K],F.position,X),q+=common.repeat(" ",w.indent)+padStart((F.line+1).toString(),Y)+" | "+Q.str+`
`,q+=common.repeat("-",w.indent+Y+3+Q.pos)+`^
`,G=1;G<=w.linesAfter&&!(K+G>=W.length);G++)Q=getLine(F.buffer,O[K+G],W[K+G],F.position-(O[K]-O[K+G]),X),q+=common.repeat(" ",w.indent)+padStart((F.line+G+1).toString(),Y)+" | "+Q.str+`
`;return q.replace(/\n$/,"")}var snippet=makeSnippet,TYPE_CONSTRUCTOR_OPTIONS=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],YAML_NODE_KINDS=["scalar","sequence","mapping"];function compileStyleAliases(F){var w={};return F!==null&&Object.keys(F).forEach(function(D){F[D].forEach(function(O){w[String(O)]=D})}),w}function Type$1(F,w){if(w=w||{},Object.keys(w).forEach(function(D){if(TYPE_CONSTRUCTOR_OPTIONS.indexOf(D)===-1)throw new exception('Unknown option "'+D+'" is met in definition of "'+F+'" YAML type.')}),this.options=w,this.tag=F,this.kind=w.kind||null,this.resolve=w.resolve||function(){return!0},this.construct=w.construct||function(D){return D},this.instanceOf=w.instanceOf||null,this.predicate=w.predicate||null,this.represent=w.represent||null,this.representName=w.representName||null,this.defaultStyle=w.defaultStyle||null,this.multi=w.multi||!1,this.styleAliases=compileStyleAliases(w.styleAliases||null),YAML_NODE_KINDS.indexOf(this.kind)===-1)throw new exception('Unknown kind "'+this.kind+'" is specified for "'+F+'" YAML type.')}var type=Type$1;function compileList(F,w){var D=[];return F[w].forEach(function(O){var W=D.length;D.forEach(function(U,K){U.tag===O.tag&&U.kind===O.kind&&U.multi===O.multi&&(W=K)}),D[W]=O}),D}function compileMap(){var F={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},w,D;function O(W){W.multi?(F.multi[W.kind].push(W),F.multi.fallback.push(W)):F[W.kind][W.tag]=F.fallback[W.tag]=W}for(w=0,D=arguments.length;w<D;w+=1)arguments[w].forEach(O);return F}function Schema$1(F){return this.extend(F)}Schema$1.prototype.extend=function(w){var D=[],O=[];if(w instanceof type)O.push(w);else if(Array.isArray(w))O=O.concat(w);else if(w&&(Array.isArray(w.implicit)||Array.isArray(w.explicit)))w.implicit&&(D=D.concat(w.implicit)),w.explicit&&(O=O.concat(w.explicit));else throw new exception("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");D.forEach(function(U){if(!(U instanceof type))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(U.loadKind&&U.loadKind!=="scalar")throw new exception("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(U.multi)throw new exception("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),O.forEach(function(U){if(!(U instanceof type))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var W=Object.create(Schema$1.prototype);return W.implicit=(this.implicit||[]).concat(D),W.explicit=(this.explicit||[]).concat(O),W.compiledImplicit=compileList(W,"implicit"),W.compiledExplicit=compileList(W,"explicit"),W.compiledTypeMap=compileMap(W.compiledImplicit,W.compiledExplicit),W};var schema=Schema$1,str=new type("tag:yaml.org,2002:str",{kind:"scalar",construct:function(F){return F!==null?F:""}}),seq=new type("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(F){return F!==null?F:[]}}),map=new type("tag:yaml.org,2002:map",{kind:"mapping",construct:function(F){return F!==null?F:{}}}),failsafe=new schema({explicit:[str,seq,map]});function resolveYamlNull(F){if(F===null)return!0;var w=F.length;return w===1&&F==="~"||w===4&&(F==="null"||F==="Null"||F==="NULL")}function constructYamlNull(){return null}function isNull(F){return F===null}var _null=new type("tag:yaml.org,2002:null",{kind:"scalar",resolve:resolveYamlNull,construct:constructYamlNull,predicate:isNull,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function resolveYamlBoolean(F){if(F===null)return!1;var w=F.length;return w===4&&(F==="true"||F==="True"||F==="TRUE")||w===5&&(F==="false"||F==="False"||F==="FALSE")}function constructYamlBoolean(F){return F==="true"||F==="True"||F==="TRUE"}function isBoolean(F){return Object.prototype.toString.call(F)==="[object Boolean]"}var bool=new type("tag:yaml.org,2002:bool",{kind:"scalar",resolve:resolveYamlBoolean,construct:constructYamlBoolean,predicate:isBoolean,represent:{lowercase:function(F){return F?"true":"false"},uppercase:function(F){return F?"TRUE":"FALSE"},camelcase:function(F){return F?"True":"False"}},defaultStyle:"lowercase"});function isHexCode(F){return 48<=F&&F<=57||65<=F&&F<=70||97<=F&&F<=102}function isOctCode(F){return 48<=F&&F<=55}function isDecCode(F){return 48<=F&&F<=57}function resolveYamlInteger(F){if(F===null)return!1;var w=F.length,D=0,O=!1,W;if(!w)return!1;if(W=F[D],(W==="-"||W==="+")&&(W=F[++D]),W==="0"){if(D+1===w)return!0;if(W=F[++D],W==="b"){for(D++;D<w;D++)if(W=F[D],W!=="_"){if(W!=="0"&&W!=="1")return!1;O=!0}return O&&W!=="_"}if(W==="x"){for(D++;D<w;D++)if(W=F[D],W!=="_"){if(!isHexCode(F.charCodeAt(D)))return!1;O=!0}return O&&W!=="_"}if(W==="o"){for(D++;D<w;D++)if(W=F[D],W!=="_"){if(!isOctCode(F.charCodeAt(D)))return!1;O=!0}return O&&W!=="_"}}if(W==="_")return!1;for(;D<w;D++)if(W=F[D],W!=="_"){if(!isDecCode(F.charCodeAt(D)))return!1;O=!0}return!(!O||W==="_")}function constructYamlInteger(F){var w=F,D=1,O;if(w.indexOf("_")!==-1&&(w=w.replace(/_/g,"")),O=w[0],(O==="-"||O==="+")&&(O==="-"&&(D=-1),w=w.slice(1),O=w[0]),w==="0")return 0;if(O==="0"){if(w[1]==="b")return D*parseInt(w.slice(2),2);if(w[1]==="x")return D*parseInt(w.slice(2),16);if(w[1]==="o")return D*parseInt(w.slice(2),8)}return D*parseInt(w,10)}function isInteger(F){return Object.prototype.toString.call(F)==="[object Number]"&&F%1===0&&!common.isNegativeZero(F)}var int=new type("tag:yaml.org,2002:int",{kind:"scalar",resolve:resolveYamlInteger,construct:constructYamlInteger,predicate:isInteger,represent:{binary:function(F){return F>=0?"0b"+F.toString(2):"-0b"+F.toString(2).slice(1)},octal:function(F){return F>=0?"0o"+F.toString(8):"-0o"+F.toString(8).slice(1)},decimal:function(F){return F.toString(10)},hexadecimal:function(F){return F>=0?"0x"+F.toString(16).toUpperCase():"-0x"+F.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YAML_FLOAT_PATTERN=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function resolveYamlFloat(F){return!(F===null||!YAML_FLOAT_PATTERN.test(F)||F[F.length-1]==="_")}function constructYamlFloat(F){var w,D;return w=F.replace(/_/g,"").toLowerCase(),D=w[0]==="-"?-1:1,"+-".indexOf(w[0])>=0&&(w=w.slice(1)),w===".inf"?D===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:w===".nan"?NaN:D*parseFloat(w,10)}var SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/;function representYamlFloat(F,w){var D;if(isNaN(F))switch(w){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===F)switch(w){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===F)switch(w){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(common.isNegativeZero(F))return"-0.0";return D=F.toString(10),SCIENTIFIC_WITHOUT_DOT.test(D)?D.replace("e",".e"):D}function isFloat(F){return Object.prototype.toString.call(F)==="[object Number]"&&(F%1!==0||common.isNegativeZero(F))}var float=new type("tag:yaml.org,2002:float",{kind:"scalar",resolve:resolveYamlFloat,construct:constructYamlFloat,predicate:isFloat,represent:representYamlFloat,defaultStyle:"lowercase"}),json=failsafe.extend({implicit:[_null,bool,int,float]}),core=json,YAML_DATE_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),YAML_TIMESTAMP_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function resolveYamlTimestamp(F){return F===null?!1:YAML_DATE_REGEXP.exec(F)!==null||YAML_TIMESTAMP_REGEXP.exec(F)!==null}function constructYamlTimestamp(F){var w,D,O,W,U,K,q,G=0,Q=null,Y,X,J;if(w=YAML_DATE_REGEXP.exec(F),w===null&&(w=YAML_TIMESTAMP_REGEXP.exec(F)),w===null)throw new Error("Date resolve error");if(D=+w[1],O=+w[2]-1,W=+w[3],!w[4])return new Date(Date.UTC(D,O,W));if(U=+w[4],K=+w[5],q=+w[6],w[7]){for(G=w[7].slice(0,3);G.length<3;)G+="0";G=+G}return w[9]&&(Y=+w[10],X=+(w[11]||0),Q=(Y*60+X)*6e4,w[9]==="-"&&(Q=-Q)),J=new Date(Date.UTC(D,O,W,U,K,q,G)),Q&&J.setTime(J.getTime()-Q),J}function representYamlTimestamp(F){return F.toISOString()}var timestamp=new type("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:resolveYamlTimestamp,construct:constructYamlTimestamp,instanceOf:Date,represent:representYamlTimestamp});function resolveYamlMerge(F){return F==="<<"||F===null}var merge=new type("tag:yaml.org,2002:merge",{kind:"scalar",resolve:resolveYamlMerge}),BASE64_MAP=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function resolveYamlBinary(F){if(F===null)return!1;var w,D,O=0,W=F.length,U=BASE64_MAP;for(D=0;D<W;D++)if(w=U.indexOf(F.charAt(D)),!(w>64)){if(w<0)return!1;O+=6}return O%8===0}function constructYamlBinary(F){var w,D,O=F.replace(/[\r\n=]/g,""),W=O.length,U=BASE64_MAP,K=0,q=[];for(w=0;w<W;w++)w%4===0&&w&&(q.push(K>>16&255),q.push(K>>8&255),q.push(K&255)),K=K<<6|U.indexOf(O.charAt(w));return D=W%4*6,D===0?(q.push(K>>16&255),q.push(K>>8&255),q.push(K&255)):D===18?(q.push(K>>10&255),q.push(K>>2&255)):D===12&&q.push(K>>4&255),new Uint8Array(q)}function representYamlBinary(F){var w="",D=0,O,W,U=F.length,K=BASE64_MAP;for(O=0;O<U;O++)O%3===0&&O&&(w+=K[D>>18&63],w+=K[D>>12&63],w+=K[D>>6&63],w+=K[D&63]),D=(D<<8)+F[O];return W=U%3,W===0?(w+=K[D>>18&63],w+=K[D>>12&63],w+=K[D>>6&63],w+=K[D&63]):W===2?(w+=K[D>>10&63],w+=K[D>>4&63],w+=K[D<<2&63],w+=K[64]):W===1&&(w+=K[D>>2&63],w+=K[D<<4&63],w+=K[64],w+=K[64]),w}function isBinary(F){return Object.prototype.toString.call(F)==="[object Uint8Array]"}var binary=new type("tag:yaml.org,2002:binary",{kind:"scalar",resolve:resolveYamlBinary,construct:constructYamlBinary,predicate:isBinary,represent:representYamlBinary}),_hasOwnProperty$3=Object.prototype.hasOwnProperty,_toString$2=Object.prototype.toString;function resolveYamlOmap(F){if(F===null)return!0;var w=[],D,O,W,U,K,q=F;for(D=0,O=q.length;D<O;D+=1){if(W=q[D],K=!1,_toString$2.call(W)!=="[object Object]")return!1;for(U in W)if(_hasOwnProperty$3.call(W,U))if(!K)K=!0;else return!1;if(!K)return!1;if(w.indexOf(U)===-1)w.push(U);else return!1}return!0}function constructYamlOmap(F){return F!==null?F:[]}var omap=new type("tag:yaml.org,2002:omap",{kind:"sequence",resolve:resolveYamlOmap,construct:constructYamlOmap}),_toString$1=Object.prototype.toString;function resolveYamlPairs(F){if(F===null)return!0;var w,D,O,W,U,K=F;for(U=new Array(K.length),w=0,D=K.length;w<D;w+=1){if(O=K[w],_toString$1.call(O)!=="[object Object]"||(W=Object.keys(O),W.length!==1))return!1;U[w]=[W[0],O[W[0]]]}return!0}function constructYamlPairs(F){if(F===null)return[];var w,D,O,W,U,K=F;for(U=new Array(K.length),w=0,D=K.length;w<D;w+=1)O=K[w],W=Object.keys(O),U[w]=[W[0],O[W[0]]];return U}var pairs=new type("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:resolveYamlPairs,construct:constructYamlPairs}),_hasOwnProperty$2=Object.prototype.hasOwnProperty;function resolveYamlSet(F){if(F===null)return!0;var w,D=F;for(w in D)if(_hasOwnProperty$2.call(D,w)&&D[w]!==null)return!1;return!0}function constructYamlSet(F){return F!==null?F:{}}var set=new type("tag:yaml.org,2002:set",{kind:"mapping",resolve:resolveYamlSet,construct:constructYamlSet}),_default=core.extend({implicit:[timestamp,merge],explicit:[binary,omap,pairs,set]}),_hasOwnProperty$1=Object.prototype.hasOwnProperty,CONTEXT_FLOW_IN=1,CONTEXT_FLOW_OUT=2,CONTEXT_BLOCK_IN=3,CONTEXT_BLOCK_OUT=4,CHOMPING_CLIP=1,CHOMPING_STRIP=2,CHOMPING_KEEP=3,PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/,PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/,PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i,PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function _class(F){return Object.prototype.toString.call(F)}function is_EOL(F){return F===10||F===13}function is_WHITE_SPACE(F){return F===9||F===32}function is_WS_OR_EOL(F){return F===9||F===32||F===10||F===13}function is_FLOW_INDICATOR(F){return F===44||F===91||F===93||F===123||F===125}function fromHexCode(F){var w;return 48<=F&&F<=57?F-48:(w=F|32,97<=w&&w<=102?w-97+10:-1)}function escapedHexLen(F){return F===120?2:F===117?4:F===85?8:0}function fromDecimalCode(F){return 48<=F&&F<=57?F-48:-1}function simpleEscapeSequence(F){return F===48?"\0":F===97?"\x07":F===98?"\b":F===116||F===9?"	":F===110?`
`:F===118?"\v":F===102?"\f":F===114?"\r":F===101?"\x1B":F===32?" ":F===34?'"':F===47?"/":F===92?"\\":F===78?"":F===95?" ":F===76?"\u2028":F===80?"\u2029":""}function charFromCodepoint(F){return F<=65535?String.fromCharCode(F):String.fromCharCode((F-65536>>10)+55296,(F-65536&1023)+56320)}var simpleEscapeCheck=new Array(256),simpleEscapeMap=new Array(256);for(var i=0;i<256;i++)simpleEscapeCheck[i]=simpleEscapeSequence(i)?1:0,simpleEscapeMap[i]=simpleEscapeSequence(i);function State$1(F,w){this.input=F,this.filename=w.filename||null,this.schema=w.schema||_default,this.onWarning=w.onWarning||null,this.legacy=w.legacy||!1,this.json=w.json||!1,this.listener=w.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=F.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function generateError(F,w){var D={name:F.filename,buffer:F.input.slice(0,-1),position:F.position,line:F.line,column:F.position-F.lineStart};return D.snippet=snippet(D),new exception(w,D)}function throwError(F,w){throw generateError(F,w)}function throwWarning(F,w){F.onWarning&&F.onWarning.call(null,generateError(F,w))}var directiveHandlers={YAML:function(w,D,O){var W,U,K;w.version!==null&&throwError(w,"duplication of %YAML directive"),O.length!==1&&throwError(w,"YAML directive accepts exactly one argument"),W=/^([0-9]+)\.([0-9]+)$/.exec(O[0]),W===null&&throwError(w,"ill-formed argument of the YAML directive"),U=parseInt(W[1],10),K=parseInt(W[2],10),U!==1&&throwError(w,"unacceptable YAML version of the document"),w.version=O[0],w.checkLineBreaks=K<2,K!==1&&K!==2&&throwWarning(w,"unsupported YAML version of the document")},TAG:function(w,D,O){var W,U;O.length!==2&&throwError(w,"TAG directive accepts exactly two arguments"),W=O[0],U=O[1],PATTERN_TAG_HANDLE.test(W)||throwError(w,"ill-formed tag handle (first argument) of the TAG directive"),_hasOwnProperty$1.call(w.tagMap,W)&&throwError(w,'there is a previously declared suffix for "'+W+'" tag handle'),PATTERN_TAG_URI.test(U)||throwError(w,"ill-formed tag prefix (second argument) of the TAG directive");try{U=decodeURIComponent(U)}catch{throwError(w,"tag prefix is malformed: "+U)}w.tagMap[W]=U}};function captureSegment(F,w,D,O){var W,U,K,q;if(w<D){if(q=F.input.slice(w,D),O)for(W=0,U=q.length;W<U;W+=1)K=q.charCodeAt(W),K===9||32<=K&&K<=1114111||throwError(F,"expected valid JSON character");else PATTERN_NON_PRINTABLE.test(q)&&throwError(F,"the stream contains non-printable characters");F.result+=q}}function mergeMappings(F,w,D,O){var W,U,K,q;for(common.isObject(D)||throwError(F,"cannot merge mappings; the provided source object is unacceptable"),W=Object.keys(D),K=0,q=W.length;K<q;K+=1)U=W[K],_hasOwnProperty$1.call(w,U)||(w[U]=D[U],O[U]=!0)}function storeMappingPair(F,w,D,O,W,U,K,q,G){var Q,Y;if(Array.isArray(W))for(W=Array.prototype.slice.call(W),Q=0,Y=W.length;Q<Y;Q+=1)Array.isArray(W[Q])&&throwError(F,"nested arrays are not supported inside keys"),typeof W=="object"&&_class(W[Q])==="[object Object]"&&(W[Q]="[object Object]");if(typeof W=="object"&&_class(W)==="[object Object]"&&(W="[object Object]"),W=String(W),w===null&&(w={}),O==="tag:yaml.org,2002:merge")if(Array.isArray(U))for(Q=0,Y=U.length;Q<Y;Q+=1)mergeMappings(F,w,U[Q],D);else mergeMappings(F,w,U,D);else!F.json&&!_hasOwnProperty$1.call(D,W)&&_hasOwnProperty$1.call(w,W)&&(F.line=K||F.line,F.lineStart=q||F.lineStart,F.position=G||F.position,throwError(F,"duplicated mapping key")),W==="__proto__"?Object.defineProperty(w,W,{configurable:!0,enumerable:!0,writable:!0,value:U}):w[W]=U,delete D[W];return w}function readLineBreak(F){var w;w=F.input.charCodeAt(F.position),w===10?F.position++:w===13?(F.position++,F.input.charCodeAt(F.position)===10&&F.position++):throwError(F,"a line break is expected"),F.line+=1,F.lineStart=F.position,F.firstTabInLine=-1}function skipSeparationSpace(F,w,D){for(var O=0,W=F.input.charCodeAt(F.position);W!==0;){for(;is_WHITE_SPACE(W);)W===9&&F.firstTabInLine===-1&&(F.firstTabInLine=F.position),W=F.input.charCodeAt(++F.position);if(w&&W===35)do W=F.input.charCodeAt(++F.position);while(W!==10&&W!==13&&W!==0);if(is_EOL(W))for(readLineBreak(F),W=F.input.charCodeAt(F.position),O++,F.lineIndent=0;W===32;)F.lineIndent++,W=F.input.charCodeAt(++F.position);else break}return D!==-1&&O!==0&&F.lineIndent<D&&throwWarning(F,"deficient indentation"),O}function testDocumentSeparator(F){var w=F.position,D;return D=F.input.charCodeAt(w),!!((D===45||D===46)&&D===F.input.charCodeAt(w+1)&&D===F.input.charCodeAt(w+2)&&(w+=3,D=F.input.charCodeAt(w),D===0||is_WS_OR_EOL(D)))}function writeFoldedLines(F,w){w===1?F.result+=" ":w>1&&(F.result+=common.repeat(`
`,w-1))}function readPlainScalar(F,w,D){var O,W,U,K,q,G,Q,Y,X=F.kind,J=F.result,te;if(te=F.input.charCodeAt(F.position),is_WS_OR_EOL(te)||is_FLOW_INDICATOR(te)||te===35||te===38||te===42||te===33||te===124||te===62||te===39||te===34||te===37||te===64||te===96||(te===63||te===45)&&(W=F.input.charCodeAt(F.position+1),is_WS_OR_EOL(W)||D&&is_FLOW_INDICATOR(W)))return!1;for(F.kind="scalar",F.result="",U=K=F.position,q=!1;te!==0;){if(te===58){if(W=F.input.charCodeAt(F.position+1),is_WS_OR_EOL(W)||D&&is_FLOW_INDICATOR(W))break}else if(te===35){if(O=F.input.charCodeAt(F.position-1),is_WS_OR_EOL(O))break}else{if(F.position===F.lineStart&&testDocumentSeparator(F)||D&&is_FLOW_INDICATOR(te))break;if(is_EOL(te))if(G=F.line,Q=F.lineStart,Y=F.lineIndent,skipSeparationSpace(F,!1,-1),F.lineIndent>=w){q=!0,te=F.input.charCodeAt(F.position);continue}else{F.position=K,F.line=G,F.lineStart=Q,F.lineIndent=Y;break}}q&&(captureSegment(F,U,K,!1),writeFoldedLines(F,F.line-G),U=K=F.position,q=!1),is_WHITE_SPACE(te)||(K=F.position+1),te=F.input.charCodeAt(++F.position)}return captureSegment(F,U,K,!1),F.result?!0:(F.kind=X,F.result=J,!1)}function readSingleQuotedScalar(F,w){var D,O,W;if(D=F.input.charCodeAt(F.position),D!==39)return!1;for(F.kind="scalar",F.result="",F.position++,O=W=F.position;(D=F.input.charCodeAt(F.position))!==0;)if(D===39)if(captureSegment(F,O,F.position,!0),D=F.input.charCodeAt(++F.position),D===39)O=F.position,F.position++,W=F.position;else return!0;else is_EOL(D)?(captureSegment(F,O,W,!0),writeFoldedLines(F,skipSeparationSpace(F,!1,w)),O=W=F.position):F.position===F.lineStart&&testDocumentSeparator(F)?throwError(F,"unexpected end of the document within a single quoted scalar"):(F.position++,W=F.position);throwError(F,"unexpected end of the stream within a single quoted scalar")}function readDoubleQuotedScalar(F,w){var D,O,W,U,K,q;if(q=F.input.charCodeAt(F.position),q!==34)return!1;for(F.kind="scalar",F.result="",F.position++,D=O=F.position;(q=F.input.charCodeAt(F.position))!==0;){if(q===34)return captureSegment(F,D,F.position,!0),F.position++,!0;if(q===92){if(captureSegment(F,D,F.position,!0),q=F.input.charCodeAt(++F.position),is_EOL(q))skipSeparationSpace(F,!1,w);else if(q<256&&simpleEscapeCheck[q])F.result+=simpleEscapeMap[q],F.position++;else if((K=escapedHexLen(q))>0){for(W=K,U=0;W>0;W--)q=F.input.charCodeAt(++F.position),(K=fromHexCode(q))>=0?U=(U<<4)+K:throwError(F,"expected hexadecimal character");F.result+=charFromCodepoint(U),F.position++}else throwError(F,"unknown escape sequence");D=O=F.position}else is_EOL(q)?(captureSegment(F,D,O,!0),writeFoldedLines(F,skipSeparationSpace(F,!1,w)),D=O=F.position):F.position===F.lineStart&&testDocumentSeparator(F)?throwError(F,"unexpected end of the document within a double quoted scalar"):(F.position++,O=F.position)}throwError(F,"unexpected end of the stream within a double quoted scalar")}function readFlowCollection(F,w){var D=!0,O,W,U,K=F.tag,q,G=F.anchor,Q,Y,X,J,te,ie=Object.create(null),se,re,ae,le;if(le=F.input.charCodeAt(F.position),le===91)Y=93,te=!1,q=[];else if(le===123)Y=125,te=!0,q={};else return!1;for(F.anchor!==null&&(F.anchorMap[F.anchor]=q),le=F.input.charCodeAt(++F.position);le!==0;){if(skipSeparationSpace(F,!0,w),le=F.input.charCodeAt(F.position),le===Y)return F.position++,F.tag=K,F.anchor=G,F.kind=te?"mapping":"sequence",F.result=q,!0;D?le===44&&throwError(F,"expected the node content, but found ','"):throwError(F,"missed comma between flow collection entries"),re=se=ae=null,X=J=!1,le===63&&(Q=F.input.charCodeAt(F.position+1),is_WS_OR_EOL(Q)&&(X=J=!0,F.position++,skipSeparationSpace(F,!0,w))),O=F.line,W=F.lineStart,U=F.position,composeNode(F,w,CONTEXT_FLOW_IN,!1,!0),re=F.tag,se=F.result,skipSeparationSpace(F,!0,w),le=F.input.charCodeAt(F.position),(J||F.line===O)&&le===58&&(X=!0,le=F.input.charCodeAt(++F.position),skipSeparationSpace(F,!0,w),composeNode(F,w,CONTEXT_FLOW_IN,!1,!0),ae=F.result),te?storeMappingPair(F,q,ie,re,se,ae,O,W,U):X?q.push(storeMappingPair(F,null,ie,re,se,ae,O,W,U)):q.push(se),skipSeparationSpace(F,!0,w),le=F.input.charCodeAt(F.position),le===44?(D=!0,le=F.input.charCodeAt(++F.position)):D=!1}throwError(F,"unexpected end of the stream within a flow collection")}function readBlockScalar(F,w){var D,O,W=CHOMPING_CLIP,U=!1,K=!1,q=w,G=0,Q=!1,Y,X;if(X=F.input.charCodeAt(F.position),X===124)O=!1;else if(X===62)O=!0;else return!1;for(F.kind="scalar",F.result="";X!==0;)if(X=F.input.charCodeAt(++F.position),X===43||X===45)CHOMPING_CLIP===W?W=X===43?CHOMPING_KEEP:CHOMPING_STRIP:throwError(F,"repeat of a chomping mode identifier");else if((Y=fromDecimalCode(X))>=0)Y===0?throwError(F,"bad explicit indentation width of a block scalar; it cannot be less than one"):K?throwError(F,"repeat of an indentation width identifier"):(q=w+Y-1,K=!0);else break;if(is_WHITE_SPACE(X)){do X=F.input.charCodeAt(++F.position);while(is_WHITE_SPACE(X));if(X===35)do X=F.input.charCodeAt(++F.position);while(!is_EOL(X)&&X!==0)}for(;X!==0;){for(readLineBreak(F),F.lineIndent=0,X=F.input.charCodeAt(F.position);(!K||F.lineIndent<q)&&X===32;)F.lineIndent++,X=F.input.charCodeAt(++F.position);if(!K&&F.lineIndent>q&&(q=F.lineIndent),is_EOL(X)){G++;continue}if(F.lineIndent<q){W===CHOMPING_KEEP?F.result+=common.repeat(`
`,U?1+G:G):W===CHOMPING_CLIP&&U&&(F.result+=`
`);break}for(O?is_WHITE_SPACE(X)?(Q=!0,F.result+=common.repeat(`
`,U?1+G:G)):Q?(Q=!1,F.result+=common.repeat(`
`,G+1)):G===0?U&&(F.result+=" "):F.result+=common.repeat(`
`,G):F.result+=common.repeat(`
`,U?1+G:G),U=!0,K=!0,G=0,D=F.position;!is_EOL(X)&&X!==0;)X=F.input.charCodeAt(++F.position);captureSegment(F,D,F.position,!1)}return!0}function readBlockSequence(F,w){var D,O=F.tag,W=F.anchor,U=[],K,q=!1,G;if(F.firstTabInLine!==-1)return!1;for(F.anchor!==null&&(F.anchorMap[F.anchor]=U),G=F.input.charCodeAt(F.position);G!==0&&(F.firstTabInLine!==-1&&(F.position=F.firstTabInLine,throwError(F,"tab characters must not be used in indentation")),!(G!==45||(K=F.input.charCodeAt(F.position+1),!is_WS_OR_EOL(K))));){if(q=!0,F.position++,skipSeparationSpace(F,!0,-1)&&F.lineIndent<=w){U.push(null),G=F.input.charCodeAt(F.position);continue}if(D=F.line,composeNode(F,w,CONTEXT_BLOCK_IN,!1,!0),U.push(F.result),skipSeparationSpace(F,!0,-1),G=F.input.charCodeAt(F.position),(F.line===D||F.lineIndent>w)&&G!==0)throwError(F,"bad indentation of a sequence entry");else if(F.lineIndent<w)break}return q?(F.tag=O,F.anchor=W,F.kind="sequence",F.result=U,!0):!1}function readBlockMapping(F,w,D){var O,W,U,K,q,G,Q=F.tag,Y=F.anchor,X={},J=Object.create(null),te=null,ie=null,se=null,re=!1,ae=!1,le;if(F.firstTabInLine!==-1)return!1;for(F.anchor!==null&&(F.anchorMap[F.anchor]=X),le=F.input.charCodeAt(F.position);le!==0;){if(!re&&F.firstTabInLine!==-1&&(F.position=F.firstTabInLine,throwError(F,"tab characters must not be used in indentation")),O=F.input.charCodeAt(F.position+1),U=F.line,(le===63||le===58)&&is_WS_OR_EOL(O))le===63?(re&&(storeMappingPair(F,X,J,te,ie,null,K,q,G),te=ie=se=null),ae=!0,re=!0,W=!0):re?(re=!1,W=!0):throwError(F,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),F.position+=1,le=O;else{if(K=F.line,q=F.lineStart,G=F.position,!composeNode(F,D,CONTEXT_FLOW_OUT,!1,!0))break;if(F.line===U){for(le=F.input.charCodeAt(F.position);is_WHITE_SPACE(le);)le=F.input.charCodeAt(++F.position);if(le===58)le=F.input.charCodeAt(++F.position),is_WS_OR_EOL(le)||throwError(F,"a whitespace character is expected after the key-value separator within a block mapping"),re&&(storeMappingPair(F,X,J,te,ie,null,K,q,G),te=ie=se=null),ae=!0,re=!1,W=!1,te=F.tag,ie=F.result;else if(ae)throwError(F,"can not read an implicit mapping pair; a colon is missed");else return F.tag=Q,F.anchor=Y,!0}else if(ae)throwError(F,"can not read a block mapping entry; a multiline key may not be an implicit key");else return F.tag=Q,F.anchor=Y,!0}if((F.line===U||F.lineIndent>w)&&(re&&(K=F.line,q=F.lineStart,G=F.position),composeNode(F,w,CONTEXT_BLOCK_OUT,!0,W)&&(re?ie=F.result:se=F.result),re||(storeMappingPair(F,X,J,te,ie,se,K,q,G),te=ie=se=null),skipSeparationSpace(F,!0,-1),le=F.input.charCodeAt(F.position)),(F.line===U||F.lineIndent>w)&&le!==0)throwError(F,"bad indentation of a mapping entry");else if(F.lineIndent<w)break}return re&&storeMappingPair(F,X,J,te,ie,null,K,q,G),ae&&(F.tag=Q,F.anchor=Y,F.kind="mapping",F.result=X),ae}function readTagProperty(F){var w,D=!1,O=!1,W,U,K;if(K=F.input.charCodeAt(F.position),K!==33)return!1;if(F.tag!==null&&throwError(F,"duplication of a tag property"),K=F.input.charCodeAt(++F.position),K===60?(D=!0,K=F.input.charCodeAt(++F.position)):K===33?(O=!0,W="!!",K=F.input.charCodeAt(++F.position)):W="!",w=F.position,D){do K=F.input.charCodeAt(++F.position);while(K!==0&&K!==62);F.position<F.length?(U=F.input.slice(w,F.position),K=F.input.charCodeAt(++F.position)):throwError(F,"unexpected end of the stream within a verbatim tag")}else{for(;K!==0&&!is_WS_OR_EOL(K);)K===33&&(O?throwError(F,"tag suffix cannot contain exclamation marks"):(W=F.input.slice(w-1,F.position+1),PATTERN_TAG_HANDLE.test(W)||throwError(F,"named tag handle cannot contain such characters"),O=!0,w=F.position+1)),K=F.input.charCodeAt(++F.position);U=F.input.slice(w,F.position),PATTERN_FLOW_INDICATORS.test(U)&&throwError(F,"tag suffix cannot contain flow indicator characters")}U&&!PATTERN_TAG_URI.test(U)&&throwError(F,"tag name cannot contain such characters: "+U);try{U=decodeURIComponent(U)}catch{throwError(F,"tag name is malformed: "+U)}return D?F.tag=U:_hasOwnProperty$1.call(F.tagMap,W)?F.tag=F.tagMap[W]+U:W==="!"?F.tag="!"+U:W==="!!"?F.tag="tag:yaml.org,2002:"+U:throwError(F,'undeclared tag handle "'+W+'"'),!0}function readAnchorProperty(F){var w,D;if(D=F.input.charCodeAt(F.position),D!==38)return!1;for(F.anchor!==null&&throwError(F,"duplication of an anchor property"),D=F.input.charCodeAt(++F.position),w=F.position;D!==0&&!is_WS_OR_EOL(D)&&!is_FLOW_INDICATOR(D);)D=F.input.charCodeAt(++F.position);return F.position===w&&throwError(F,"name of an anchor node must contain at least one character"),F.anchor=F.input.slice(w,F.position),!0}function readAlias(F){var w,D,O;if(O=F.input.charCodeAt(F.position),O!==42)return!1;for(O=F.input.charCodeAt(++F.position),w=F.position;O!==0&&!is_WS_OR_EOL(O)&&!is_FLOW_INDICATOR(O);)O=F.input.charCodeAt(++F.position);return F.position===w&&throwError(F,"name of an alias node must contain at least one character"),D=F.input.slice(w,F.position),_hasOwnProperty$1.call(F.anchorMap,D)||throwError(F,'unidentified alias "'+D+'"'),F.result=F.anchorMap[D],skipSeparationSpace(F,!0,-1),!0}function composeNode(F,w,D,O,W){var U,K,q,G=1,Q=!1,Y=!1,X,J,te,ie,se,re;if(F.listener!==null&&F.listener("open",F),F.tag=null,F.anchor=null,F.kind=null,F.result=null,U=K=q=CONTEXT_BLOCK_OUT===D||CONTEXT_BLOCK_IN===D,O&&skipSeparationSpace(F,!0,-1)&&(Q=!0,F.lineIndent>w?G=1:F.lineIndent===w?G=0:F.lineIndent<w&&(G=-1)),G===1)for(;readTagProperty(F)||readAnchorProperty(F);)skipSeparationSpace(F,!0,-1)?(Q=!0,q=U,F.lineIndent>w?G=1:F.lineIndent===w?G=0:F.lineIndent<w&&(G=-1)):q=!1;if(q&&(q=Q||W),(G===1||CONTEXT_BLOCK_OUT===D)&&(CONTEXT_FLOW_IN===D||CONTEXT_FLOW_OUT===D?se=w:se=w+1,re=F.position-F.lineStart,G===1?q&&(readBlockSequence(F,re)||readBlockMapping(F,re,se))||readFlowCollection(F,se)?Y=!0:(K&&readBlockScalar(F,se)||readSingleQuotedScalar(F,se)||readDoubleQuotedScalar(F,se)?Y=!0:readAlias(F)?(Y=!0,(F.tag!==null||F.anchor!==null)&&throwError(F,"alias node should not have any properties")):readPlainScalar(F,se,CONTEXT_FLOW_IN===D)&&(Y=!0,F.tag===null&&(F.tag="?")),F.anchor!==null&&(F.anchorMap[F.anchor]=F.result)):G===0&&(Y=q&&readBlockSequence(F,re))),F.tag===null)F.anchor!==null&&(F.anchorMap[F.anchor]=F.result);else if(F.tag==="?"){for(F.result!==null&&F.kind!=="scalar"&&throwError(F,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+F.kind+'"'),X=0,J=F.implicitTypes.length;X<J;X+=1)if(ie=F.implicitTypes[X],ie.resolve(F.result)){F.result=ie.construct(F.result),F.tag=ie.tag,F.anchor!==null&&(F.anchorMap[F.anchor]=F.result);break}}else if(F.tag!=="!"){if(_hasOwnProperty$1.call(F.typeMap[F.kind||"fallback"],F.tag))ie=F.typeMap[F.kind||"fallback"][F.tag];else for(ie=null,te=F.typeMap.multi[F.kind||"fallback"],X=0,J=te.length;X<J;X+=1)if(F.tag.slice(0,te[X].tag.length)===te[X].tag){ie=te[X];break}ie||throwError(F,"unknown tag !<"+F.tag+">"),F.result!==null&&ie.kind!==F.kind&&throwError(F,"unacceptable node kind for !<"+F.tag+'> tag; it should be "'+ie.kind+'", not "'+F.kind+'"'),ie.resolve(F.result,F.tag)?(F.result=ie.construct(F.result,F.tag),F.anchor!==null&&(F.anchorMap[F.anchor]=F.result)):throwError(F,"cannot resolve a node with !<"+F.tag+"> explicit tag")}return F.listener!==null&&F.listener("close",F),F.tag!==null||F.anchor!==null||Y}function readDocument(F){var w=F.position,D,O,W,U=!1,K;for(F.version=null,F.checkLineBreaks=F.legacy,F.tagMap=Object.create(null),F.anchorMap=Object.create(null);(K=F.input.charCodeAt(F.position))!==0&&(skipSeparationSpace(F,!0,-1),K=F.input.charCodeAt(F.position),!(F.lineIndent>0||K!==37));){for(U=!0,K=F.input.charCodeAt(++F.position),D=F.position;K!==0&&!is_WS_OR_EOL(K);)K=F.input.charCodeAt(++F.position);for(O=F.input.slice(D,F.position),W=[],O.length<1&&throwError(F,"directive name must not be less than one character in length");K!==0;){for(;is_WHITE_SPACE(K);)K=F.input.charCodeAt(++F.position);if(K===35){do K=F.input.charCodeAt(++F.position);while(K!==0&&!is_EOL(K));break}if(is_EOL(K))break;for(D=F.position;K!==0&&!is_WS_OR_EOL(K);)K=F.input.charCodeAt(++F.position);W.push(F.input.slice(D,F.position))}K!==0&&readLineBreak(F),_hasOwnProperty$1.call(directiveHandlers,O)?directiveHandlers[O](F,O,W):throwWarning(F,'unknown document directive "'+O+'"')}if(skipSeparationSpace(F,!0,-1),F.lineIndent===0&&F.input.charCodeAt(F.position)===45&&F.input.charCodeAt(F.position+1)===45&&F.input.charCodeAt(F.position+2)===45?(F.position+=3,skipSeparationSpace(F,!0,-1)):U&&throwError(F,"directives end mark is expected"),composeNode(F,F.lineIndent-1,CONTEXT_BLOCK_OUT,!1,!0),skipSeparationSpace(F,!0,-1),F.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(F.input.slice(w,F.position))&&throwWarning(F,"non-ASCII line breaks are interpreted as content"),F.documents.push(F.result),F.position===F.lineStart&&testDocumentSeparator(F)){F.input.charCodeAt(F.position)===46&&(F.position+=3,skipSeparationSpace(F,!0,-1));return}if(F.position<F.length-1)throwError(F,"end of the stream or a document separator is expected");else return}function loadDocuments(F,w){F=String(F),w=w||{},F.length!==0&&(F.charCodeAt(F.length-1)!==10&&F.charCodeAt(F.length-1)!==13&&(F+=`
`),F.charCodeAt(0)===65279&&(F=F.slice(1)));var D=new State$1(F,w),O=F.indexOf("\0");for(O!==-1&&(D.position=O,throwError(D,"null byte is not allowed in input")),D.input+="\0";D.input.charCodeAt(D.position)===32;)D.lineIndent+=1,D.position+=1;for(;D.position<D.length-1;)readDocument(D);return D.documents}function loadAll$1(F,w,D){w!==null&&typeof w=="object"&&typeof D>"u"&&(D=w,w=null);var O=loadDocuments(F,D);if(typeof w!="function")return O;for(var W=0,U=O.length;W<U;W+=1)w(O[W])}function load$1(F,w){var D=loadDocuments(F,w);if(D.length!==0){if(D.length===1)return D[0];throw new exception("expected a single document in the stream, but found more")}}var loadAll_1=loadAll$1,load_1=load$1,loader={loadAll:loadAll_1,load:load_1},_toString=Object.prototype.toString,_hasOwnProperty=Object.prototype.hasOwnProperty,CHAR_BOM=65279,CHAR_TAB=9,CHAR_LINE_FEED=10,CHAR_CARRIAGE_RETURN=13,CHAR_SPACE=32,CHAR_EXCLAMATION=33,CHAR_DOUBLE_QUOTE=34,CHAR_SHARP=35,CHAR_PERCENT=37,CHAR_AMPERSAND=38,CHAR_SINGLE_QUOTE=39,CHAR_ASTERISK=42,CHAR_COMMA=44,CHAR_MINUS=45,CHAR_COLON=58,CHAR_EQUALS=61,CHAR_GREATER_THAN=62,CHAR_QUESTION=63,CHAR_COMMERCIAL_AT=64,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_GRAVE_ACCENT=96,CHAR_LEFT_CURLY_BRACKET=123,CHAR_VERTICAL_LINE=124,CHAR_RIGHT_CURLY_BRACKET=125,ESCAPE_SEQUENCES={};ESCAPE_SEQUENCES[0]="\\0";ESCAPE_SEQUENCES[7]="\\a";ESCAPE_SEQUENCES[8]="\\b";ESCAPE_SEQUENCES[9]="\\t";ESCAPE_SEQUENCES[10]="\\n";ESCAPE_SEQUENCES[11]="\\v";ESCAPE_SEQUENCES[12]="\\f";ESCAPE_SEQUENCES[13]="\\r";ESCAPE_SEQUENCES[27]="\\e";ESCAPE_SEQUENCES[34]='\\"';ESCAPE_SEQUENCES[92]="\\\\";ESCAPE_SEQUENCES[133]="\\N";ESCAPE_SEQUENCES[160]="\\_";ESCAPE_SEQUENCES[8232]="\\L";ESCAPE_SEQUENCES[8233]="\\P";var DEPRECATED_BOOLEANS_SYNTAX=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],DEPRECATED_BASE60_SYNTAX=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function compileStyleMap(F,w){var D,O,W,U,K,q,G;if(w===null)return{};for(D={},O=Object.keys(w),W=0,U=O.length;W<U;W+=1)K=O[W],q=String(w[K]),K.slice(0,2)==="!!"&&(K="tag:yaml.org,2002:"+K.slice(2)),G=F.compiledTypeMap.fallback[K],G&&_hasOwnProperty.call(G.styleAliases,q)&&(q=G.styleAliases[q]),D[K]=q;return D}function encodeHex(F){var w,D,O;if(w=F.toString(16).toUpperCase(),F<=255)D="x",O=2;else if(F<=65535)D="u",O=4;else if(F<=4294967295)D="U",O=8;else throw new exception("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+D+common.repeat("0",O-w.length)+w}var QUOTING_TYPE_SINGLE=1,QUOTING_TYPE_DOUBLE=2;function State(F){this.schema=F.schema||_default,this.indent=Math.max(1,F.indent||2),this.noArrayIndent=F.noArrayIndent||!1,this.skipInvalid=F.skipInvalid||!1,this.flowLevel=common.isNothing(F.flowLevel)?-1:F.flowLevel,this.styleMap=compileStyleMap(this.schema,F.styles||null),this.sortKeys=F.sortKeys||!1,this.lineWidth=F.lineWidth||80,this.noRefs=F.noRefs||!1,this.noCompatMode=F.noCompatMode||!1,this.condenseFlow=F.condenseFlow||!1,this.quotingType=F.quotingType==='"'?QUOTING_TYPE_DOUBLE:QUOTING_TYPE_SINGLE,this.forceQuotes=F.forceQuotes||!1,this.replacer=typeof F.replacer=="function"?F.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function indentString(F,w){for(var D=common.repeat(" ",w),O=0,W=-1,U="",K,q=F.length;O<q;)W=F.indexOf(`
`,O),W===-1?(K=F.slice(O),O=q):(K=F.slice(O,W+1),O=W+1),K.length&&K!==`
`&&(U+=D),U+=K;return U}function generateNextLine(F,w){return`
`+common.repeat(" ",F.indent*w)}function testImplicitResolving(F,w){var D,O,W;for(D=0,O=F.implicitTypes.length;D<O;D+=1)if(W=F.implicitTypes[D],W.resolve(w))return!0;return!1}function isWhitespace(F){return F===CHAR_SPACE||F===CHAR_TAB}function isPrintable(F){return 32<=F&&F<=126||161<=F&&F<=55295&&F!==8232&&F!==8233||57344<=F&&F<=65533&&F!==CHAR_BOM||65536<=F&&F<=1114111}function isNsCharOrWhitespace(F){return isPrintable(F)&&F!==CHAR_BOM&&F!==CHAR_CARRIAGE_RETURN&&F!==CHAR_LINE_FEED}function isPlainSafe(F,w,D){var O=isNsCharOrWhitespace(F),W=O&&!isWhitespace(F);return(D?O:O&&F!==CHAR_COMMA&&F!==CHAR_LEFT_SQUARE_BRACKET&&F!==CHAR_RIGHT_SQUARE_BRACKET&&F!==CHAR_LEFT_CURLY_BRACKET&&F!==CHAR_RIGHT_CURLY_BRACKET)&&F!==CHAR_SHARP&&!(w===CHAR_COLON&&!W)||isNsCharOrWhitespace(w)&&!isWhitespace(w)&&F===CHAR_SHARP||w===CHAR_COLON&&W}function isPlainSafeFirst(F){return isPrintable(F)&&F!==CHAR_BOM&&!isWhitespace(F)&&F!==CHAR_MINUS&&F!==CHAR_QUESTION&&F!==CHAR_COLON&&F!==CHAR_COMMA&&F!==CHAR_LEFT_SQUARE_BRACKET&&F!==CHAR_RIGHT_SQUARE_BRACKET&&F!==CHAR_LEFT_CURLY_BRACKET&&F!==CHAR_RIGHT_CURLY_BRACKET&&F!==CHAR_SHARP&&F!==CHAR_AMPERSAND&&F!==CHAR_ASTERISK&&F!==CHAR_EXCLAMATION&&F!==CHAR_VERTICAL_LINE&&F!==CHAR_EQUALS&&F!==CHAR_GREATER_THAN&&F!==CHAR_SINGLE_QUOTE&&F!==CHAR_DOUBLE_QUOTE&&F!==CHAR_PERCENT&&F!==CHAR_COMMERCIAL_AT&&F!==CHAR_GRAVE_ACCENT}function isPlainSafeLast(F){return!isWhitespace(F)&&F!==CHAR_COLON}function codePointAt(F,w){var D=F.charCodeAt(w),O;return D>=55296&&D<=56319&&w+1<F.length&&(O=F.charCodeAt(w+1),O>=56320&&O<=57343)?(D-55296)*1024+O-56320+65536:D}function needIndentIndicator(F){var w=/^\n* /;return w.test(F)}var STYLE_PLAIN=1,STYLE_SINGLE=2,STYLE_LITERAL=3,STYLE_FOLDED=4,STYLE_DOUBLE=5;function chooseScalarStyle(F,w,D,O,W,U,K,q){var G,Q=0,Y=null,X=!1,J=!1,te=O!==-1,ie=-1,se=isPlainSafeFirst(codePointAt(F,0))&&isPlainSafeLast(codePointAt(F,F.length-1));if(w||K)for(G=0;G<F.length;Q>=65536?G+=2:G++){if(Q=codePointAt(F,G),!isPrintable(Q))return STYLE_DOUBLE;se=se&&isPlainSafe(Q,Y,q),Y=Q}else{for(G=0;G<F.length;Q>=65536?G+=2:G++){if(Q=codePointAt(F,G),Q===CHAR_LINE_FEED)X=!0,te&&(J=J||G-ie-1>O&&F[ie+1]!==" ",ie=G);else if(!isPrintable(Q))return STYLE_DOUBLE;se=se&&isPlainSafe(Q,Y,q),Y=Q}J=J||te&&G-ie-1>O&&F[ie+1]!==" "}return!X&&!J?se&&!K&&!W(F)?STYLE_PLAIN:U===QUOTING_TYPE_DOUBLE?STYLE_DOUBLE:STYLE_SINGLE:D>9&&needIndentIndicator(F)?STYLE_DOUBLE:K?U===QUOTING_TYPE_DOUBLE?STYLE_DOUBLE:STYLE_SINGLE:J?STYLE_FOLDED:STYLE_LITERAL}function writeScalar(F,w,D,O,W){F.dump=function(){if(w.length===0)return F.quotingType===QUOTING_TYPE_DOUBLE?'""':"''";if(!F.noCompatMode&&(DEPRECATED_BOOLEANS_SYNTAX.indexOf(w)!==-1||DEPRECATED_BASE60_SYNTAX.test(w)))return F.quotingType===QUOTING_TYPE_DOUBLE?'"'+w+'"':"'"+w+"'";var U=F.indent*Math.max(1,D),K=F.lineWidth===-1?-1:Math.max(Math.min(F.lineWidth,40),F.lineWidth-U),q=O||F.flowLevel>-1&&D>=F.flowLevel;function G(Q){return testImplicitResolving(F,Q)}switch(chooseScalarStyle(w,q,F.indent,K,G,F.quotingType,F.forceQuotes&&!O,W)){case STYLE_PLAIN:return w;case STYLE_SINGLE:return"'"+w.replace(/'/g,"''")+"'";case STYLE_LITERAL:return"|"+blockHeader(w,F.indent)+dropEndingNewline(indentString(w,U));case STYLE_FOLDED:return">"+blockHeader(w,F.indent)+dropEndingNewline(indentString(foldString(w,K),U));case STYLE_DOUBLE:return'"'+escapeString(w)+'"';default:throw new exception("impossible error: invalid scalar style")}}()}function blockHeader(F,w){var D=needIndentIndicator(F)?String(w):"",O=F[F.length-1]===`
`,W=O&&(F[F.length-2]===`
`||F===`
`),U=W?"+":O?"":"-";return D+U+`
`}function dropEndingNewline(F){return F[F.length-1]===`
`?F.slice(0,-1):F}function foldString(F,w){for(var D=/(\n+)([^\n]*)/g,O=function(){var Q=F.indexOf(`
`);return Q=Q!==-1?Q:F.length,D.lastIndex=Q,foldLine(F.slice(0,Q),w)}(),W=F[0]===`
`||F[0]===" ",U,K;K=D.exec(F);){var q=K[1],G=K[2];U=G[0]===" ",O+=q+(!W&&!U&&G!==""?`
`:"")+foldLine(G,w),W=U}return O}function foldLine(F,w){if(F===""||F[0]===" ")return F;for(var D=/ [^ ]/g,O,W=0,U,K=0,q=0,G="";O=D.exec(F);)q=O.index,q-W>w&&(U=K>W?K:q,G+=`
`+F.slice(W,U),W=U+1),K=q;return G+=`
`,F.length-W>w&&K>W?G+=F.slice(W,K)+`
`+F.slice(K+1):G+=F.slice(W),G.slice(1)}function escapeString(F){for(var w="",D=0,O,W=0;W<F.length;D>=65536?W+=2:W++)D=codePointAt(F,W),O=ESCAPE_SEQUENCES[D],!O&&isPrintable(D)?(w+=F[W],D>=65536&&(w+=F[W+1])):w+=O||encodeHex(D);return w}function writeFlowSequence(F,w,D){var O="",W=F.tag,U,K,q;for(U=0,K=D.length;U<K;U+=1)q=D[U],F.replacer&&(q=F.replacer.call(D,String(U),q)),(writeNode(F,w,q,!1,!1)||typeof q>"u"&&writeNode(F,w,null,!1,!1))&&(O!==""&&(O+=","+(F.condenseFlow?"":" ")),O+=F.dump);F.tag=W,F.dump="["+O+"]"}function writeBlockSequence(F,w,D,O){var W="",U=F.tag,K,q,G;for(K=0,q=D.length;K<q;K+=1)G=D[K],F.replacer&&(G=F.replacer.call(D,String(K),G)),(writeNode(F,w+1,G,!0,!0,!1,!0)||typeof G>"u"&&writeNode(F,w+1,null,!0,!0,!1,!0))&&((!O||W!=="")&&(W+=generateNextLine(F,w)),F.dump&&CHAR_LINE_FEED===F.dump.charCodeAt(0)?W+="-":W+="- ",W+=F.dump);F.tag=U,F.dump=W||"[]"}function writeFlowMapping(F,w,D){var O="",W=F.tag,U=Object.keys(D),K,q,G,Q,Y;for(K=0,q=U.length;K<q;K+=1)Y="",O!==""&&(Y+=", "),F.condenseFlow&&(Y+='"'),G=U[K],Q=D[G],F.replacer&&(Q=F.replacer.call(D,G,Q)),writeNode(F,w,G,!1,!1)&&(F.dump.length>1024&&(Y+="? "),Y+=F.dump+(F.condenseFlow?'"':"")+":"+(F.condenseFlow?"":" "),writeNode(F,w,Q,!1,!1)&&(Y+=F.dump,O+=Y));F.tag=W,F.dump="{"+O+"}"}function writeBlockMapping(F,w,D,O){var W="",U=F.tag,K=Object.keys(D),q,G,Q,Y,X,J;if(F.sortKeys===!0)K.sort();else if(typeof F.sortKeys=="function")K.sort(F.sortKeys);else if(F.sortKeys)throw new exception("sortKeys must be a boolean or a function");for(q=0,G=K.length;q<G;q+=1)J="",(!O||W!=="")&&(J+=generateNextLine(F,w)),Q=K[q],Y=D[Q],F.replacer&&(Y=F.replacer.call(D,Q,Y)),writeNode(F,w+1,Q,!0,!0,!0)&&(X=F.tag!==null&&F.tag!=="?"||F.dump&&F.dump.length>1024,X&&(F.dump&&CHAR_LINE_FEED===F.dump.charCodeAt(0)?J+="?":J+="? "),J+=F.dump,X&&(J+=generateNextLine(F,w)),writeNode(F,w+1,Y,!0,X)&&(F.dump&&CHAR_LINE_FEED===F.dump.charCodeAt(0)?J+=":":J+=": ",J+=F.dump,W+=J));F.tag=U,F.dump=W||"{}"}function detectType(F,w,D){var O,W,U,K,q,G;for(W=D?F.explicitTypes:F.implicitTypes,U=0,K=W.length;U<K;U+=1)if(q=W[U],(q.instanceOf||q.predicate)&&(!q.instanceOf||typeof w=="object"&&w instanceof q.instanceOf)&&(!q.predicate||q.predicate(w))){if(D?q.multi&&q.representName?F.tag=q.representName(w):F.tag=q.tag:F.tag="?",q.represent){if(G=F.styleMap[q.tag]||q.defaultStyle,_toString.call(q.represent)==="[object Function]")O=q.represent(w,G);else if(_hasOwnProperty.call(q.represent,G))O=q.represent[G](w,G);else throw new exception("!<"+q.tag+'> tag resolver accepts not "'+G+'" style');F.dump=O}return!0}return!1}function writeNode(F,w,D,O,W,U,K){F.tag=null,F.dump=D,detectType(F,D,!1)||detectType(F,D,!0);var q=_toString.call(F.dump),G=O,Q;O&&(O=F.flowLevel<0||F.flowLevel>w);var Y=q==="[object Object]"||q==="[object Array]",X,J;if(Y&&(X=F.duplicates.indexOf(D),J=X!==-1),(F.tag!==null&&F.tag!=="?"||J||F.indent!==2&&w>0)&&(W=!1),J&&F.usedDuplicates[X])F.dump="*ref_"+X;else{if(Y&&J&&!F.usedDuplicates[X]&&(F.usedDuplicates[X]=!0),q==="[object Object]")O&&Object.keys(F.dump).length!==0?(writeBlockMapping(F,w,F.dump,W),J&&(F.dump="&ref_"+X+F.dump)):(writeFlowMapping(F,w,F.dump),J&&(F.dump="&ref_"+X+" "+F.dump));else if(q==="[object Array]")O&&F.dump.length!==0?(F.noArrayIndent&&!K&&w>0?writeBlockSequence(F,w-1,F.dump,W):writeBlockSequence(F,w,F.dump,W),J&&(F.dump="&ref_"+X+F.dump)):(writeFlowSequence(F,w,F.dump),J&&(F.dump="&ref_"+X+" "+F.dump));else if(q==="[object String]")F.tag!=="?"&&writeScalar(F,F.dump,w,U,G);else{if(q==="[object Undefined]")return!1;if(F.skipInvalid)return!1;throw new exception("unacceptable kind of an object to dump "+q)}F.tag!==null&&F.tag!=="?"&&(Q=encodeURI(F.tag[0]==="!"?F.tag.slice(1):F.tag).replace(/!/g,"%21"),F.tag[0]==="!"?Q="!"+Q:Q.slice(0,18)==="tag:yaml.org,2002:"?Q="!!"+Q.slice(18):Q="!<"+Q+">",F.dump=Q+" "+F.dump)}return!0}function getDuplicateReferences(F,w){var D=[],O=[],W,U;for(inspectNode(F,D,O),W=0,U=O.length;W<U;W+=1)w.duplicates.push(D[O[W]]);w.usedDuplicates=new Array(U)}function inspectNode(F,w,D){var O,W,U;if(F!==null&&typeof F=="object")if(W=w.indexOf(F),W!==-1)D.indexOf(W)===-1&&D.push(W);else if(w.push(F),Array.isArray(F))for(W=0,U=F.length;W<U;W+=1)inspectNode(F[W],w,D);else for(O=Object.keys(F),W=0,U=O.length;W<U;W+=1)inspectNode(F[O[W]],w,D)}function dump$1(F,w){w=w||{};var D=new State(w);D.noRefs||getDuplicateReferences(F,D);var O=F;return D.replacer&&(O=D.replacer.call({"":O},"",O)),writeNode(D,0,O,!0,!0)?D.dump+`
`:""}var dump_1=dump$1,dumper={dump:dump_1};function renamed(F,w){return function(){throw new Error("Function yaml."+F+" is removed in js-yaml 4. Use yaml."+w+" instead, which is now safe by default.")}}var Type=type,Schema=schema,FAILSAFE_SCHEMA=failsafe,JSON_SCHEMA=json,CORE_SCHEMA=core,DEFAULT_SCHEMA=_default,load=loader.load,loadAll=loader.loadAll,dump=dumper.dump,YAMLException=exception,types={binary,float,map,null:_null,pairs,set,timestamp,bool,int,merge,omap,seq,str},safeLoad=renamed("safeLoad","load"),safeLoadAll=renamed("safeLoadAll","loadAll"),safeDump=renamed("safeDump","dump"),jsYaml={Type,Schema,FAILSAFE_SCHEMA,JSON_SCHEMA,CORE_SCHEMA,DEFAULT_SCHEMA,load,loadAll,dump,YAMLException,types,safeLoad,safeLoadAll,safeDump};function commonjsRequire(F){throw new Error('Could not dynamically require "'+F+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var jsonpath$1={exports:{}};/*! jsonpath 1.1.1 */var hasRequiredJsonpath;function requireJsonpath(){return hasRequiredJsonpath||(hasRequiredJsonpath=1,function(F,w){(function(D){F.exports=D()})(function(){return function D(O,W,U){function K(Q,Y){if(!W[Q]){if(!O[Q]){var X=typeof commonjsRequire=="function"&&commonjsRequire;if(!Y&&X)return X(Q,!0);if(q)return q(Q,!0);var J=new Error("Cannot find module '"+Q+"'");throw J.code="MODULE_NOT_FOUND",J}var te=W[Q]={exports:{}};O[Q][0].call(te.exports,function(ie){var se=O[Q][1][ie];return K(se||ie)},te,te.exports,D,O,W,U)}return W[Q].exports}for(var q=typeof commonjsRequire=="function"&&commonjsRequire,G=0;G<U.length;G++)K(U[G]);return K}({"./aesprim":[function(D,O,W){(function(U,K){K(typeof W<"u"?W:U.esprima={})})(this,function(U){var K,q,G,Q,Y,X,J,te,ie,se,re,ae,le,de,oe,ue,pe,fe;K={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9},q={},q[K.BooleanLiteral]="Boolean",q[K.EOF]="<end>",q[K.Identifier]="Identifier",q[K.Keyword]="Keyword",q[K.NullLiteral]="Null",q[K.NumericLiteral]="Numeric",q[K.Punctuator]="Punctuator",q[K.StringLiteral]="String",q[K.RegularExpression]="RegularExpression",G=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],Q={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"},Y={Data:1,Get:2,Set:4},X={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},J={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")};function Ce(he,be){if(!he)throw new Error("ASSERT: "+be)}function we(he){return he>=48&&he<=57}function Oe(he){return"0123456789abcdefABCDEF".indexOf(he)>=0}function Te(he){return"01234567".indexOf(he)>=0}function Re(he){return he===32||he===9||he===11||he===12||he===160||he>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(he)>=0}function Me(he){return he===10||he===13||he===8232||he===8233}function Ne(he){return he==64||he===36||he===95||he>=65&&he<=90||he>=97&&he<=122||he===92||he>=128&&J.NonAsciiIdentifierStart.test(String.fromCharCode(he))}function ze(he){return he===36||he===95||he>=65&&he<=90||he>=97&&he<=122||he>=48&&he<=57||he===92||he>=128&&J.NonAsciiIdentifierPart.test(String.fromCharCode(he))}function Qe(he){switch(he){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function Ye(he){switch(he){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function Je(he){return he==="eval"||he==="arguments"}function at(he){if(se&&Ye(he))return!0;switch(he.length){case 2:return he==="if"||he==="in"||he==="do";case 3:return he==="var"||he==="for"||he==="new"||he==="try"||he==="let";case 4:return he==="this"||he==="else"||he==="case"||he==="void"||he==="with"||he==="enum";case 5:return he==="while"||he==="break"||he==="catch"||he==="throw"||he==="const"||he==="yield"||he==="class"||he==="super";case 6:return he==="return"||he==="typeof"||he==="delete"||he==="switch"||he==="export"||he==="import";case 7:return he==="default"||he==="finally"||he==="extends";case 8:return he==="function"||he==="continue"||he==="debugger";case 10:return he==="instanceof";default:return!1}}function st(he,be,De,Ve,nt){var gt;Ce(typeof De=="number","Comment must have valid position"),!(pe.lastCommentStart>=De)&&(pe.lastCommentStart=De,gt={type:he,value:be},fe.range&&(gt.range=[De,Ve]),fe.loc&&(gt.loc=nt),fe.comments.push(gt),fe.attachComment&&(fe.leadingComments.push(gt),fe.trailingComments.push(gt)))}function lt(he){var be,De,Ve,nt;for(be=re-he,De={start:{line:ae,column:re-le-he}};re<de;)if(Ve=ie.charCodeAt(re),++re,Me(Ve)){fe.comments&&(nt=ie.slice(be+he,re-1),De.end={line:ae,column:re-le-1},st("Line",nt,be,re-1,De)),Ve===13&&ie.charCodeAt(re)===10&&++re,++ae,le=re;return}fe.comments&&(nt=ie.slice(be+he,re),De.end={line:ae,column:re-le},st("Line",nt,be,re,De))}function Tt(){var he,be,De,Ve;for(fe.comments&&(he=re-2,be={start:{line:ae,column:re-le-2}});re<de;)if(De=ie.charCodeAt(re),Me(De))De===13&&ie.charCodeAt(re+1)===10&&++re,++ae,++re,le=re,re>=de&&Lt({},X.UnexpectedToken,"ILLEGAL");else if(De===42){if(ie.charCodeAt(re+1)===47){++re,++re,fe.comments&&(Ve=ie.slice(he+2,re-2),be.end={line:ae,column:re-le},st("Block",Ve,he,re,be));return}++re}else++re;Lt({},X.UnexpectedToken,"ILLEGAL")}function Ke(){var he,be;for(be=re===0;re<de;)if(he=ie.charCodeAt(re),Re(he))++re;else if(Me(he))++re,he===13&&ie.charCodeAt(re)===10&&++re,++ae,le=re,be=!0;else if(he===47)if(he=ie.charCodeAt(re+1),he===47)++re,++re,lt(2),be=!0;else if(he===42)++re,++re,Tt();else break;else if(be&&he===45)if(ie.charCodeAt(re+1)===45&&ie.charCodeAt(re+2)===62)re+=3,lt(3);else break;else if(he===60)if(ie.slice(re+1,re+4)==="!--")++re,++re,++re,++re,lt(4);else break;else break}function je(he){var be,De,Ve,nt=0;for(De=he==="u"?4:2,be=0;be<De;++be)if(re<de&&Oe(ie[re]))Ve=ie[re++],nt=nt*16+"0123456789abcdef".indexOf(Ve.toLowerCase());else return"";return String.fromCharCode(nt)}function et(){var he,be;for(he=ie.charCodeAt(re++),be=String.fromCharCode(he),he===92&&(ie.charCodeAt(re)!==117&&Lt({},X.UnexpectedToken,"ILLEGAL"),++re,he=je("u"),(!he||he==="\\"||!Ne(he.charCodeAt(0)))&&Lt({},X.UnexpectedToken,"ILLEGAL"),be=he);re<de&&(he=ie.charCodeAt(re),!!ze(he));)++re,be+=String.fromCharCode(he),he===92&&(be=be.substr(0,be.length-1),ie.charCodeAt(re)!==117&&Lt({},X.UnexpectedToken,"ILLEGAL"),++re,he=je("u"),(!he||he==="\\"||!ze(he.charCodeAt(0)))&&Lt({},X.UnexpectedToken,"ILLEGAL"),be+=he);return be}function mt(){var he,be;for(he=re++;re<de;){if(be=ie.charCodeAt(re),be===92)return re=he,et();if(ze(be))++re;else break}return ie.slice(he,re)}function Mt(){var he,be,De;return he=re,be=ie.charCodeAt(re)===92?et():mt(),be.length===1?De=K.Identifier:at(be)?De=K.Keyword:be==="null"?De=K.NullLiteral:be==="true"||be==="false"?De=K.BooleanLiteral:De=K.Identifier,{type:De,value:be,lineNumber:ae,lineStart:le,start:he,end:re}}function Et(){var he=re,be=ie.charCodeAt(re),De,Ve=ie[re],nt,gt,Bt;switch(be){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++re,fe.tokenize&&(be===40?fe.openParenToken=fe.tokens.length:be===123&&(fe.openCurlyToken=fe.tokens.length)),{type:K.Punctuator,value:String.fromCharCode(be),lineNumber:ae,lineStart:le,start:he,end:re};default:if(De=ie.charCodeAt(re+1),De===61)switch(be){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return re+=2,{type:K.Punctuator,value:String.fromCharCode(be)+String.fromCharCode(De),lineNumber:ae,lineStart:le,start:he,end:re};case 33:case 61:return re+=2,ie.charCodeAt(re)===61&&++re,{type:K.Punctuator,value:ie.slice(he,re),lineNumber:ae,lineStart:le,start:he,end:re}}}if(Bt=ie.substr(re,4),Bt===">>>=")return re+=4,{type:K.Punctuator,value:Bt,lineNumber:ae,lineStart:le,start:he,end:re};if(gt=Bt.substr(0,3),gt===">>>"||gt==="<<="||gt===">>=")return re+=3,{type:K.Punctuator,value:gt,lineNumber:ae,lineStart:le,start:he,end:re};if(nt=gt.substr(0,2),Ve===nt[1]&&"+-<>&|".indexOf(Ve)>=0||nt==="=>")return re+=2,{type:K.Punctuator,value:nt,lineNumber:ae,lineStart:le,start:he,end:re};if("<>=!+-*%&|^/".indexOf(Ve)>=0)return++re,{type:K.Punctuator,value:Ve,lineNumber:ae,lineStart:le,start:he,end:re};Lt({},X.UnexpectedToken,"ILLEGAL")}function Ct(he){for(var be="";re<de&&Oe(ie[re]);)be+=ie[re++];return be.length===0&&Lt({},X.UnexpectedToken,"ILLEGAL"),Ne(ie.charCodeAt(re))&&Lt({},X.UnexpectedToken,"ILLEGAL"),{type:K.NumericLiteral,value:parseInt("0x"+be,16),lineNumber:ae,lineStart:le,start:he,end:re}}function Nt(he){for(var be="0"+ie[re++];re<de&&Te(ie[re]);)be+=ie[re++];return(Ne(ie.charCodeAt(re))||we(ie.charCodeAt(re)))&&Lt({},X.UnexpectedToken,"ILLEGAL"),{type:K.NumericLiteral,value:parseInt(be,8),octal:!0,lineNumber:ae,lineStart:le,start:he,end:re}}function zt(){var he,be,De;if(De=ie[re],Ce(we(De.charCodeAt(0))||De===".","Numeric literal must start with a decimal digit or a decimal point"),be=re,he="",De!=="."){if(he=ie[re++],De=ie[re],he==="0"){if(De==="x"||De==="X")return++re,Ct(be);if(Te(De))return Nt(be);De&&we(De.charCodeAt(0))&&Lt({},X.UnexpectedToken,"ILLEGAL")}for(;we(ie.charCodeAt(re));)he+=ie[re++];De=ie[re]}if(De==="."){for(he+=ie[re++];we(ie.charCodeAt(re));)he+=ie[re++];De=ie[re]}if(De==="e"||De==="E")if(he+=ie[re++],De=ie[re],(De==="+"||De==="-")&&(he+=ie[re++]),we(ie.charCodeAt(re)))for(;we(ie.charCodeAt(re));)he+=ie[re++];else Lt({},X.UnexpectedToken,"ILLEGAL");return Ne(ie.charCodeAt(re))&&Lt({},X.UnexpectedToken,"ILLEGAL"),{type:K.NumericLiteral,value:parseFloat(he),lineNumber:ae,lineStart:le,start:be,end:re}}function ii(){var he="",be,De,Ve,nt,gt,Bt,ei=!1,Ni,yi;for(Ni=ae,yi=le,be=ie[re],Ce(be==="'"||be==='"',"String literal must starts with a quote"),De=re,++re;re<de;)if(Ve=ie[re++],Ve===be){be="";break}else if(Ve==="\\")if(Ve=ie[re++],!Ve||!Me(Ve.charCodeAt(0)))switch(Ve){case"u":case"x":Bt=re,gt=je(Ve),gt?he+=gt:(re=Bt,he+=Ve);break;case"n":he+=`
`;break;case"r":he+="\r";break;case"t":he+="	";break;case"b":he+="\b";break;case"f":he+="\f";break;case"v":he+="\v";break;default:Te(Ve)?(nt="01234567".indexOf(Ve),nt!==0&&(ei=!0),re<de&&Te(ie[re])&&(ei=!0,nt=nt*8+"01234567".indexOf(ie[re++]),"0123".indexOf(Ve)>=0&&re<de&&Te(ie[re])&&(nt=nt*8+"01234567".indexOf(ie[re++]))),he+=String.fromCharCode(nt)):he+=Ve;break}else++ae,Ve==="\r"&&ie[re]===`
`&&++re,le=re;else{if(Me(Ve.charCodeAt(0)))break;he+=Ve}return be!==""&&Lt({},X.UnexpectedToken,"ILLEGAL"),{type:K.StringLiteral,value:he,octal:ei,startLineNumber:Ni,startLineStart:yi,lineNumber:ae,lineStart:le,start:De,end:re}}function Ci(he,be){var De;try{De=new RegExp(he,be)}catch{Lt({},X.InvalidRegExp)}return De}function ni(){var he,be,De,Ve,nt;for(he=ie[re],Ce(he==="/","Regular expression literal must start with a slash"),be=ie[re++],De=!1,Ve=!1;re<de;)if(he=ie[re++],be+=he,he==="\\")he=ie[re++],Me(he.charCodeAt(0))&&Lt({},X.UnterminatedRegExp),be+=he;else if(Me(he.charCodeAt(0)))Lt({},X.UnterminatedRegExp);else if(De)he==="]"&&(De=!1);else if(he==="/"){Ve=!0;break}else he==="["&&(De=!0);return Ve||Lt({},X.UnterminatedRegExp),nt=be.substr(1,be.length-2),{value:nt,literal:be}}function vi(){var he,be,De,Ve;for(be="",De="";re<de&&(he=ie[re],!!ze(he.charCodeAt(0)));)if(++re,he==="\\"&&re<de)if(he=ie[re],he==="u"){if(++re,Ve=re,he=je("u"),he)for(De+=he,be+="\\u";Ve<re;++Ve)be+=ie[Ve];else re=Ve,De+="u",be+="\\u";St({},X.UnexpectedToken,"ILLEGAL")}else be+="\\",St({},X.UnexpectedToken,"ILLEGAL");else De+=he,be+=he;return{value:De,literal:be}}function hi(){var he,be,De,Ve;return ue=null,Ke(),he=re,be=ni(),De=vi(),Ve=Ci(be.value,De.value),fe.tokenize?{type:K.RegularExpression,value:Ve,lineNumber:ae,lineStart:le,start:he,end:re}:{literal:be.literal+De.literal,value:Ve,start:he,end:re}}function jt(){var he,be,De,Ve;return Ke(),he=re,be={start:{line:ae,column:re-le}},De=hi(),be.end={line:ae,column:re-le},fe.tokenize||(fe.tokens.length>0&&(Ve=fe.tokens[fe.tokens.length-1],Ve.range[0]===he&&Ve.type==="Punctuator"&&(Ve.value==="/"||Ve.value==="/=")&&fe.tokens.pop()),fe.tokens.push({type:"RegularExpression",value:De.literal,range:[he,re],loc:be})),De}function zi(he){return he.type===K.Identifier||he.type===K.Keyword||he.type===K.BooleanLiteral||he.type===K.NullLiteral}function Ki(){var he,be;if(he=fe.tokens[fe.tokens.length-1],!he)return jt();if(he.type==="Punctuator"){if(he.value==="]")return Et();if(he.value===")")return be=fe.tokens[fe.openParenToken-1],be&&be.type==="Keyword"&&(be.value==="if"||be.value==="while"||be.value==="for"||be.value==="with")?jt():Et();if(he.value==="}"){if(fe.tokens[fe.openCurlyToken-3]&&fe.tokens[fe.openCurlyToken-3].type==="Keyword"){if(be=fe.tokens[fe.openCurlyToken-4],!be)return Et()}else if(fe.tokens[fe.openCurlyToken-4]&&fe.tokens[fe.openCurlyToken-4].type==="Keyword"){if(be=fe.tokens[fe.openCurlyToken-5],!be)return jt()}else return Et();return G.indexOf(be.value)>=0?Et():jt()}return jt()}return he.type==="Keyword"?jt():Et()}function pi(){var he;return Ke(),re>=de?{type:K.EOF,lineNumber:ae,lineStart:le,start:re,end:re}:(he=ie.charCodeAt(re),Ne(he)?Mt():he===40||he===41||he===59?Et():he===39||he===34?ii():he===46?we(ie.charCodeAt(re+1))?zt():Et():we(he)?zt():fe.tokenize&&he===47?Ki():Et())}function mi(){var he,be,De;return Ke(),he={start:{line:ae,column:re-le}},be=pi(),he.end={line:ae,column:re-le},be.type!==K.EOF&&(De=ie.slice(be.start,be.end),fe.tokens.push({type:q[be.type],value:De,range:[be.start,be.end],loc:he})),be}function kt(){var he;return he=ue,re=he.end,ae=he.lineNumber,le=he.lineStart,ue=typeof fe.tokens<"u"?mi():pi(),re=he.end,ae=he.lineNumber,le=he.lineStart,he}function ki(){var he,be,De;he=re,be=ae,De=le,ue=typeof fe.tokens<"u"?mi():pi(),re=he,ae=be,le=De}function Ii(he,be){this.line=he,this.column=be}function Jt(he,be,De,Ve){this.start=new Ii(he,be),this.end=new Ii(De,Ve)}te={name:"SyntaxTree",processComment:function(he){var be,De;if(!(he.type===Q.Program&&he.body.length>0)){for(fe.trailingComments.length>0?fe.trailingComments[0].range[0]>=he.range[1]?(De=fe.trailingComments,fe.trailingComments=[]):fe.trailingComments.length=0:fe.bottomRightStack.length>0&&fe.bottomRightStack[fe.bottomRightStack.length-1].trailingComments&&fe.bottomRightStack[fe.bottomRightStack.length-1].trailingComments[0].range[0]>=he.range[1]&&(De=fe.bottomRightStack[fe.bottomRightStack.length-1].trailingComments,delete fe.bottomRightStack[fe.bottomRightStack.length-1].trailingComments);fe.bottomRightStack.length>0&&fe.bottomRightStack[fe.bottomRightStack.length-1].range[0]>=he.range[0];)be=fe.bottomRightStack.pop();be?be.leadingComments&&be.leadingComments[be.leadingComments.length-1].range[1]<=he.range[0]&&(he.leadingComments=be.leadingComments,delete be.leadingComments):fe.leadingComments.length>0&&fe.leadingComments[fe.leadingComments.length-1].range[1]<=he.range[0]&&(he.leadingComments=fe.leadingComments,fe.leadingComments=[]),De&&(he.trailingComments=De),fe.bottomRightStack.push(he)}},markEnd:function(he,be){return fe.range&&(he.range=[be.start,re]),fe.loc&&(he.loc=new Jt(be.startLineNumber===void 0?be.lineNumber:be.startLineNumber,be.start-(be.startLineStart===void 0?be.lineStart:be.startLineStart),ae,re-le),this.postProcess(he)),fe.attachComment&&this.processComment(he),he},postProcess:function(he){return fe.source&&(he.loc.source=fe.source),he},createArrayExpression:function(he){return{type:Q.ArrayExpression,elements:he}},createAssignmentExpression:function(he,be,De){return{type:Q.AssignmentExpression,operator:he,left:be,right:De}},createBinaryExpression:function(he,be,De){var Ve=he==="||"||he==="&&"?Q.LogicalExpression:Q.BinaryExpression;return{type:Ve,operator:he,left:be,right:De}},createBlockStatement:function(he){return{type:Q.BlockStatement,body:he}},createBreakStatement:function(he){return{type:Q.BreakStatement,label:he}},createCallExpression:function(he,be){return{type:Q.CallExpression,callee:he,arguments:be}},createCatchClause:function(he,be){return{type:Q.CatchClause,param:he,body:be}},createConditionalExpression:function(he,be,De){return{type:Q.ConditionalExpression,test:he,consequent:be,alternate:De}},createContinueStatement:function(he){return{type:Q.ContinueStatement,label:he}},createDebuggerStatement:function(){return{type:Q.DebuggerStatement}},createDoWhileStatement:function(he,be){return{type:Q.DoWhileStatement,body:he,test:be}},createEmptyStatement:function(){return{type:Q.EmptyStatement}},createExpressionStatement:function(he){return{type:Q.ExpressionStatement,expression:he}},createForStatement:function(he,be,De,Ve){return{type:Q.ForStatement,init:he,test:be,update:De,body:Ve}},createForInStatement:function(he,be,De){return{type:Q.ForInStatement,left:he,right:be,body:De,each:!1}},createFunctionDeclaration:function(he,be,De,Ve){return{type:Q.FunctionDeclaration,id:he,params:be,defaults:De,body:Ve,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(he,be,De,Ve){return{type:Q.FunctionExpression,id:he,params:be,defaults:De,body:Ve,rest:null,generator:!1,expression:!1}},createIdentifier:function(he){return{type:Q.Identifier,name:he}},createIfStatement:function(he,be,De){return{type:Q.IfStatement,test:he,consequent:be,alternate:De}},createLabeledStatement:function(he,be){return{type:Q.LabeledStatement,label:he,body:be}},createLiteral:function(he){return{type:Q.Literal,value:he.value,raw:ie.slice(he.start,he.end)}},createMemberExpression:function(he,be,De){return{type:Q.MemberExpression,computed:he==="[",object:be,property:De}},createNewExpression:function(he,be){return{type:Q.NewExpression,callee:he,arguments:be}},createObjectExpression:function(he){return{type:Q.ObjectExpression,properties:he}},createPostfixExpression:function(he,be){return{type:Q.UpdateExpression,operator:he,argument:be,prefix:!1}},createProgram:function(he){return{type:Q.Program,body:he}},createProperty:function(he,be,De){return{type:Q.Property,key:be,value:De,kind:he}},createReturnStatement:function(he){return{type:Q.ReturnStatement,argument:he}},createSequenceExpression:function(he){return{type:Q.SequenceExpression,expressions:he}},createSwitchCase:function(he,be){return{type:Q.SwitchCase,test:he,consequent:be}},createSwitchStatement:function(he,be){return{type:Q.SwitchStatement,discriminant:he,cases:be}},createThisExpression:function(){return{type:Q.ThisExpression}},createThrowStatement:function(he){return{type:Q.ThrowStatement,argument:he}},createTryStatement:function(he,be,De,Ve){return{type:Q.TryStatement,block:he,guardedHandlers:be,handlers:De,finalizer:Ve}},createUnaryExpression:function(he,be){return he==="++"||he==="--"?{type:Q.UpdateExpression,operator:he,argument:be,prefix:!0}:{type:Q.UnaryExpression,operator:he,argument:be,prefix:!0}},createVariableDeclaration:function(he,be){return{type:Q.VariableDeclaration,declarations:he,kind:be}},createVariableDeclarator:function(he,be){return{type:Q.VariableDeclarator,id:he,init:be}},createWhileStatement:function(he,be){return{type:Q.WhileStatement,test:he,body:be}},createWithStatement:function(he,be){return{type:Q.WithStatement,object:he,body:be}}};function _i(){var he,be,De,Ve;return he=re,be=ae,De=le,Ke(),Ve=ae!==be,re=he,ae=be,le=De,Ve}function Lt(he,be){var De,Ve=Array.prototype.slice.call(arguments,2),nt=be.replace(/%(\d)/g,function(gt,Bt){return Ce(Bt<Ve.length,"Message reference must be in range"),Ve[Bt]});throw typeof he.lineNumber=="number"?(De=new Error("Line "+he.lineNumber+": "+nt),De.index=he.start,De.lineNumber=he.lineNumber,De.column=he.start-le+1):(De=new Error("Line "+ae+": "+nt),De.index=re,De.lineNumber=ae,De.column=re-le+1),De.description=nt,De}function St(){try{Lt.apply(null,arguments)}catch(he){if(fe.errors)fe.errors.push(he);else throw he}}function si(he){if(he.type===K.EOF&&Lt(he,X.UnexpectedEOS),he.type===K.NumericLiteral&&Lt(he,X.UnexpectedNumber),he.type===K.StringLiteral&&Lt(he,X.UnexpectedString),he.type===K.Identifier&&Lt(he,X.UnexpectedIdentifier),he.type===K.Keyword){if(Qe(he.value))Lt(he,X.UnexpectedReserved);else if(se&&Ye(he.value)){St(he,X.StrictReservedWord);return}Lt(he,X.UnexpectedToken,he.value)}Lt(he,X.UnexpectedToken,he.value)}function Se(he){var be=kt();(be.type!==K.Punctuator||be.value!==he)&&si(be)}function ge(he){var be=kt();(be.type!==K.Keyword||be.value!==he)&&si(be)}function _e(he){return ue.type===K.Punctuator&&ue.value===he}function ke(he){return ue.type===K.Keyword&&ue.value===he}function Fe(){var he;return ue.type!==K.Punctuator?!1:(he=ue.value,he==="="||he==="*="||he==="/="||he==="%="||he==="+="||he==="-="||he==="<<="||he===">>="||he===">>>="||he==="&="||he==="^="||he==="|=")}function qe(){var he;if(ie.charCodeAt(re)===59||_e(";")){kt();return}he=ae,Ke(),ae===he&&ue.type!==K.EOF&&!_e("}")&&si(ue)}function tt(he){return he.type===Q.Identifier||he.type===Q.MemberExpression}function It(){var he=[],be;for(be=ue,Se("[");!_e("]");)_e(",")?(kt(),he.push(null)):(he.push(ht()),_e("]")||Se(","));return kt(),oe.markEnd(oe.createArrayExpression(he),be)}function wt(he,be){var De,Ve,nt;return De=se,nt=ue,Ve=rs(),be&&se&&Je(he[0].name)&&St(be,X.StrictParamName),se=De,oe.markEnd(oe.createFunctionExpression(null,he,[],Ve),nt)}function Ht(){var he,be;return be=ue,he=kt(),he.type===K.StringLiteral||he.type===K.NumericLiteral?(se&&he.octal&&St(he,X.StrictOctalLiteral),oe.markEnd(oe.createLiteral(he),be)):oe.markEnd(oe.createIdentifier(he.value),be)}function ri(){var he,be,De,Ve,nt,gt;if(he=ue,gt=ue,he.type===K.Identifier)return De=Ht(),he.value==="get"&&!_e(":")?(be=Ht(),Se("("),Se(")"),Ve=wt([]),oe.markEnd(oe.createProperty("get",be,Ve),gt)):he.value==="set"&&!_e(":")?(be=Ht(),Se("("),he=ue,he.type!==K.Identifier?(Se(")"),St(he,X.UnexpectedToken,he.value),Ve=wt([])):(nt=[Yt()],Se(")"),Ve=wt(nt,he)),oe.markEnd(oe.createProperty("set",be,Ve),gt)):(Se(":"),Ve=ht(),oe.markEnd(oe.createProperty("init",De,Ve),gt));if(he.type===K.EOF||he.type===K.Punctuator)si(he);else return be=Ht(),Se(":"),Ve=ht(),oe.markEnd(oe.createProperty("init",be,Ve),gt)}function qt(){var he=[],be,De,Ve,nt,gt={},Bt=String,ei;for(ei=ue,Se("{");!_e("}");)be=ri(),be.key.type===Q.Identifier?De=be.key.name:De=Bt(be.key.value),nt=be.kind==="init"?Y.Data:be.kind==="get"?Y.Get:Y.Set,Ve="$"+De,Object.prototype.hasOwnProperty.call(gt,Ve)?(gt[Ve]===Y.Data?se&&nt===Y.Data?St({},X.StrictDuplicateProperty):nt!==Y.Data&&St({},X.AccessorDataProperty):nt===Y.Data?St({},X.AccessorDataProperty):gt[Ve]&nt&&St({},X.AccessorGetSet),gt[Ve]|=nt):gt[Ve]=nt,he.push(be),_e("}")||Se(",");return Se("}"),oe.markEnd(oe.createObjectExpression(he),ei)}function di(){var he;return Se("("),he=pt(),Se(")"),he}function Zi(){var he,be,De,Ve;if(_e("("))return di();if(_e("["))return It();if(_e("{"))return qt();if(he=ue.type,Ve=ue,he===K.Identifier)De=oe.createIdentifier(kt().value);else if(he===K.StringLiteral||he===K.NumericLiteral)se&&ue.octal&&St(ue,X.StrictOctalLiteral),De=oe.createLiteral(kt());else if(he===K.Keyword){if(ke("function"))return Or();ke("this")?(kt(),De=oe.createThisExpression()):si(kt())}else he===K.BooleanLiteral?(be=kt(),be.value=be.value==="true",De=oe.createLiteral(be)):he===K.NullLiteral?(be=kt(),be.value=null,De=oe.createLiteral(be)):_e("/")||_e("/=")?(typeof fe.tokens<"u"?De=oe.createLiteral(jt()):De=oe.createLiteral(hi()),ki()):si(kt());return oe.markEnd(De,Ve)}function On(){var he=[];if(Se("("),!_e(")"))for(;re<de&&(he.push(ht()),!_e(")"));)Se(",");return Se(")"),he}function Pn(){var he,be;return be=ue,he=kt(),zi(he)||si(he),oe.markEnd(oe.createIdentifier(he.value),be)}function Cn(){return Se("."),Pn()}function xt(){var he;return Se("["),he=pt(),Se("]"),he}function Ee(){var he,be,De;return De=ue,ge("new"),he=Ie(),be=_e("(")?On():[],oe.markEnd(oe.createNewExpression(he,be),De)}function xe(){var he,be,De,Ve,nt;for(nt=ue,he=pe.allowIn,pe.allowIn=!0,be=ke("new")?Ee():Zi(),pe.allowIn=he;;){if(_e("."))Ve=Cn(),be=oe.createMemberExpression(".",be,Ve);else if(_e("("))De=On(),be=oe.createCallExpression(be,De);else if(_e("["))Ve=xt(),be=oe.createMemberExpression("[",be,Ve);else break;oe.markEnd(be,nt)}return be}function Ie(){var he,be,De,Ve;for(Ve=ue,he=pe.allowIn,be=ke("new")?Ee():Zi(),pe.allowIn=he;_e(".")||_e("[");)_e("[")?(De=xt(),be=oe.createMemberExpression("[",be,De)):(De=Cn(),be=oe.createMemberExpression(".",be,De)),oe.markEnd(be,Ve);return be}function Pe(){var he,be,De=ue;return he=xe(),ue.type===K.Punctuator&&(_e("++")||_e("--"))&&!_i()&&(se&&he.type===Q.Identifier&&Je(he.name)&&St({},X.StrictLHSPostfix),tt(he)||St({},X.InvalidLHSInAssignment),be=kt(),he=oe.markEnd(oe.createPostfixExpression(be.value,he),De)),he}function $e(){var he,be,De;return ue.type!==K.Punctuator&&ue.type!==K.Keyword?be=Pe():_e("++")||_e("--")?(De=ue,he=kt(),be=$e(),se&&be.type===Q.Identifier&&Je(be.name)&&St({},X.StrictLHSPrefix),tt(be)||St({},X.InvalidLHSInAssignment),be=oe.createUnaryExpression(he.value,be),be=oe.markEnd(be,De)):_e("+")||_e("-")||_e("~")||_e("!")?(De=ue,he=kt(),be=$e(),be=oe.createUnaryExpression(he.value,be),be=oe.markEnd(be,De)):ke("delete")||ke("void")||ke("typeof")?(De=ue,he=kt(),be=$e(),be=oe.createUnaryExpression(he.value,be),be=oe.markEnd(be,De),se&&be.operator==="delete"&&be.argument.type===Q.Identifier&&St({},X.StrictDelete)):be=Pe(),be}function Ge(he,be){var De=0;if(he.type!==K.Punctuator&&he.type!==K.Keyword)return 0;switch(he.value){case"||":De=1;break;case"&&":De=2;break;case"|":De=3;break;case"^":De=4;break;case"&":De=5;break;case"==":case"!=":case"===":case"!==":De=6;break;case"<":case">":case"<=":case">=":case"instanceof":De=7;break;case"in":De=be?7:0;break;case"<<":case">>":case">>>":De=8;break;case"+":case"-":De=9;break;case"*":case"/":case"%":De=11;break}return De}function Xe(){var he,be,De,Ve,nt,gt,Bt,ei,Ni,yi;if(he=ue,Ni=$e(),Ve=ue,nt=Ge(Ve,pe.allowIn),nt===0)return Ni;for(Ve.prec=nt,kt(),be=[he,ue],Bt=$e(),gt=[Ni,Ve,Bt];(nt=Ge(ue,pe.allowIn))>0;){for(;gt.length>2&&nt<=gt[gt.length-2].prec;)Bt=gt.pop(),ei=gt.pop().value,Ni=gt.pop(),De=oe.createBinaryExpression(ei,Ni,Bt),be.pop(),he=be[be.length-1],oe.markEnd(De,he),gt.push(De);Ve=kt(),Ve.prec=nt,gt.push(Ve),be.push(ue),De=$e(),gt.push(De)}for(yi=gt.length-1,De=gt[yi],be.pop();yi>1;)De=oe.createBinaryExpression(gt[yi-1].value,gt[yi-2],De),yi-=2,he=be.pop(),oe.markEnd(De,he);return De}function ut(){var he,be,De,Ve,nt;return nt=ue,he=Xe(),_e("?")&&(kt(),be=pe.allowIn,pe.allowIn=!0,De=ht(),pe.allowIn=be,Se(":"),Ve=ht(),he=oe.createConditionalExpression(he,De,Ve),oe.markEnd(he,nt)),he}function ht(){var he,be,De,Ve,nt;return he=ue,nt=ue,Ve=be=ut(),Fe()&&(tt(be)||St({},X.InvalidLHSInAssignment),se&&be.type===Q.Identifier&&Je(be.name)&&St(he,X.StrictLHSAssignment),he=kt(),De=ht(),Ve=oe.markEnd(oe.createAssignmentExpression(he.value,be,De),nt)),Ve}function pt(){var he,be=ue;if(he=ht(),_e(",")){for(he=oe.createSequenceExpression([he]);re<de&&_e(",");)kt(),he.expressions.push(ht());oe.markEnd(he,be)}return he}function $t(){for(var he=[],be;re<de&&!(_e("}")||(be=Fn(),typeof be>"u"));)he.push(be);return he}function Pt(){var he,be;return be=ue,Se("{"),he=$t(),Se("}"),oe.markEnd(oe.createBlockStatement(he),be)}function Yt(){var he,be;return be=ue,he=kt(),he.type!==K.Identifier&&si(he),oe.markEnd(oe.createIdentifier(he.value),be)}function Xt(he){var be=null,De,Ve;return Ve=ue,De=Yt(),se&&Je(De.name)&&St({},X.StrictVarName),he==="const"?(Se("="),be=ht()):_e("=")&&(kt(),be=ht()),oe.markEnd(oe.createVariableDeclarator(De,be),Ve)}function Si(he){var be=[];do{if(be.push(Xt(he)),!_e(","))break;kt()}while(re<de);return be}function Pi(){var he;return ge("var"),he=Si(),qe(),oe.createVariableDeclaration(he,"var")}function yn(he){var be,De;return De=ue,ge(he),be=Si(he),qe(),oe.markEnd(oe.createVariableDeclaration(be,he),De)}function vt(){return Se(";"),oe.createEmptyStatement()}function We(){var he=pt();return qe(),oe.createExpressionStatement(he)}function dt(){var he,be,De;return ge("if"),Se("("),he=pt(),Se(")"),be=Xi(),ke("else")?(kt(),De=Xi()):De=null,oe.createIfStatement(he,be,De)}function _t(){var he,be,De;return ge("do"),De=pe.inIteration,pe.inIteration=!0,he=Xi(),pe.inIteration=De,ge("while"),Se("("),be=pt(),Se(")"),_e(";")&&kt(),oe.createDoWhileStatement(he,be)}function Zt(){var he,be,De;return ge("while"),Se("("),he=pt(),Se(")"),De=pe.inIteration,pe.inIteration=!0,be=Xi(),pe.inIteration=De,oe.createWhileStatement(he,be)}function Ti(){var he,be,De;return De=ue,he=kt(),be=Si(),oe.markEnd(oe.createVariableDeclaration(be,he.value),De)}function gi(){var he,be,De,Ve,nt,gt,Bt;return he=be=De=null,ge("for"),Se("("),_e(";")?kt():(ke("var")||ke("let")?(pe.allowIn=!1,he=Ti(),pe.allowIn=!0,he.declarations.length===1&&ke("in")&&(kt(),Ve=he,nt=pt(),he=null)):(pe.allowIn=!1,he=pt(),pe.allowIn=!0,ke("in")&&(tt(he)||St({},X.InvalidLHSInForIn),kt(),Ve=he,nt=pt(),he=null)),typeof Ve>"u"&&Se(";")),typeof Ve>"u"&&(_e(";")||(be=pt()),Se(";"),_e(")")||(De=pt())),Se(")"),Bt=pe.inIteration,pe.inIteration=!0,gt=Xi(),pe.inIteration=Bt,typeof Ve>"u"?oe.createForStatement(he,be,De,gt):oe.createForInStatement(Ve,nt,gt)}function Mi(){var he=null,be;return ge("continue"),ie.charCodeAt(re)===59?(kt(),pe.inIteration||Lt({},X.IllegalContinue),oe.createContinueStatement(null)):_i()?(pe.inIteration||Lt({},X.IllegalContinue),oe.createContinueStatement(null)):(ue.type===K.Identifier&&(he=Yt(),be="$"+he.name,Object.prototype.hasOwnProperty.call(pe.labelSet,be)||Lt({},X.UnknownLabel,he.name)),qe(),he===null&&!pe.inIteration&&Lt({},X.IllegalContinue),oe.createContinueStatement(he))}function qi(){var he=null,be;return ge("break"),ie.charCodeAt(re)===59?(kt(),pe.inIteration||pe.inSwitch||Lt({},X.IllegalBreak),oe.createBreakStatement(null)):_i()?(pe.inIteration||pe.inSwitch||Lt({},X.IllegalBreak),oe.createBreakStatement(null)):(ue.type===K.Identifier&&(he=Yt(),be="$"+he.name,Object.prototype.hasOwnProperty.call(pe.labelSet,be)||Lt({},X.UnknownLabel,he.name)),qe(),he===null&&!(pe.inIteration||pe.inSwitch)&&Lt({},X.IllegalBreak),oe.createBreakStatement(he))}function En(){var he=null;return ge("return"),pe.inFunctionBody||St({},X.IllegalReturn),ie.charCodeAt(re)===32&&Ne(ie.charCodeAt(re+1))?(he=pt(),qe(),oe.createReturnStatement(he)):_i()?oe.createReturnStatement(null):(_e(";")||!_e("}")&&ue.type!==K.EOF&&(he=pt()),qe(),oe.createReturnStatement(he))}function Di(){var he,be;return se&&(Ke(),St({},X.StrictModeWith)),ge("with"),Se("("),he=pt(),Se(")"),be=Xi(),oe.createWithStatement(he,be)}function Gn(){var he,be=[],De,Ve;for(Ve=ue,ke("default")?(kt(),he=null):(ge("case"),he=pt()),Se(":");re<de&&!(_e("}")||ke("default")||ke("case"));)De=Xi(),be.push(De);return oe.markEnd(oe.createSwitchCase(he,be),Ve)}function jn(){var he,be,De,Ve,nt;if(ge("switch"),Se("("),he=pt(),Se(")"),Se("{"),be=[],_e("}"))return kt(),oe.createSwitchStatement(he,be);for(Ve=pe.inSwitch,pe.inSwitch=!0,nt=!1;re<de&&!_e("}");)De=Gn(),De.test===null&&(nt&&Lt({},X.MultipleDefaultsInSwitch),nt=!0),be.push(De);return pe.inSwitch=Ve,Se("}"),oe.createSwitchStatement(he,be)}function Nr(){var he;return ge("throw"),_i()&&Lt({},X.NewlineAfterThrow),he=pt(),qe(),oe.createThrowStatement(he)}function Rr(){var he,be,De;return De=ue,ge("catch"),Se("("),_e(")")&&si(ue),he=Yt(),se&&Je(he.name)&&St({},X.StrictCatchVariable),Se(")"),be=Pt(),oe.markEnd(oe.createCatchClause(he,be),De)}function Ar(){var he,be=[],De=null;return ge("try"),he=Pt(),ke("catch")&&be.push(Rr()),ke("finally")&&(kt(),De=Pt()),be.length===0&&!De&&Lt({},X.NoCatchOrFinally),oe.createTryStatement(he,[],be,De)}function Mr(){return ge("debugger"),qe(),oe.createDebuggerStatement()}function Xi(){var he=ue.type,be,De,Ve,nt;if(he===K.EOF&&si(ue),he===K.Punctuator&&ue.value==="{")return Pt();if(nt=ue,he===K.Punctuator)switch(ue.value){case";":return oe.markEnd(vt(),nt);case"(":return oe.markEnd(We(),nt)}if(he===K.Keyword)switch(ue.value){case"break":return oe.markEnd(qi(),nt);case"continue":return oe.markEnd(Mi(),nt);case"debugger":return oe.markEnd(Mr(),nt);case"do":return oe.markEnd(_t(),nt);case"for":return oe.markEnd(gi(),nt);case"function":return oe.markEnd(os(),nt);case"if":return oe.markEnd(dt(),nt);case"return":return oe.markEnd(En(),nt);case"switch":return oe.markEnd(jn(),nt);case"throw":return oe.markEnd(Nr(),nt);case"try":return oe.markEnd(Ar(),nt);case"var":return oe.markEnd(Pi(),nt);case"while":return oe.markEnd(Zt(),nt);case"with":return oe.markEnd(Di(),nt)}return be=pt(),be.type===Q.Identifier&&_e(":")?(kt(),Ve="$"+be.name,Object.prototype.hasOwnProperty.call(pe.labelSet,Ve)&&Lt({},X.Redeclaration,"Label",be.name),pe.labelSet[Ve]=!0,De=Xi(),delete pe.labelSet[Ve],oe.markEnd(oe.createLabeledStatement(be,De),nt)):(qe(),oe.markEnd(oe.createExpressionStatement(be),nt))}function rs(){var he,be=[],De,Ve,nt,gt,Bt,ei,Ni,yi;for(yi=ue,Se("{");re<de&&!(ue.type!==K.StringLiteral||(De=ue,he=Fn(),be.push(he),he.expression.type!==Q.Literal));)Ve=ie.slice(De.start+1,De.end-1),Ve==="use strict"?(se=!0,nt&&St(nt,X.StrictOctalLiteral)):!nt&&De.octal&&(nt=De);for(gt=pe.labelSet,Bt=pe.inIteration,ei=pe.inSwitch,Ni=pe.inFunctionBody,pe.labelSet={},pe.inIteration=!1,pe.inSwitch=!1,pe.inFunctionBody=!0;re<de&&!(_e("}")||(he=Fn(),typeof he>"u"));)be.push(he);return Se("}"),pe.labelSet=gt,pe.inIteration=Bt,pe.inSwitch=ei,pe.inFunctionBody=Ni,oe.markEnd(oe.createBlockStatement(be),yi)}function ws(he){var be,De=[],Ve,nt,gt,Bt,ei;if(Se("("),!_e(")"))for(gt={};re<de&&(Ve=ue,be=Yt(),Bt="$"+Ve.value,se?(Je(Ve.value)&&(nt=Ve,ei=X.StrictParamName),Object.prototype.hasOwnProperty.call(gt,Bt)&&(nt=Ve,ei=X.StrictParamDupe)):he||(Je(Ve.value)?(he=Ve,ei=X.StrictParamName):Ye(Ve.value)?(he=Ve,ei=X.StrictReservedWord):Object.prototype.hasOwnProperty.call(gt,Bt)&&(he=Ve,ei=X.StrictParamDupe)),De.push(be),gt[Bt]=!0,!_e(")"));)Se(",");return Se(")"),{params:De,stricted:nt,firstRestricted:he,message:ei}}function os(){var he,be=[],De,Ve,nt,gt,Bt,ei,Ni,yi;return yi=ue,ge("function"),Ve=ue,he=Yt(),se?Je(Ve.value)&&St(Ve,X.StrictFunctionName):Je(Ve.value)?(Bt=Ve,ei=X.StrictFunctionName):Ye(Ve.value)&&(Bt=Ve,ei=X.StrictReservedWord),gt=ws(Bt),be=gt.params,nt=gt.stricted,Bt=gt.firstRestricted,gt.message&&(ei=gt.message),Ni=se,De=rs(),se&&Bt&&Lt(Bt,ei),se&&nt&&St(nt,ei),se=Ni,oe.markEnd(oe.createFunctionDeclaration(he,be,[],De),yi)}function Or(){var he,be=null,De,Ve,nt,gt,Bt=[],ei,Ni,yi;return yi=ue,ge("function"),_e("(")||(he=ue,be=Yt(),se?Je(he.value)&&St(he,X.StrictFunctionName):Je(he.value)?(Ve=he,nt=X.StrictFunctionName):Ye(he.value)&&(Ve=he,nt=X.StrictReservedWord)),gt=ws(Ve),Bt=gt.params,De=gt.stricted,Ve=gt.firstRestricted,gt.message&&(nt=gt.message),Ni=se,ei=rs(),se&&Ve&&Lt(Ve,nt),se&&De&&St(De,nt),se=Ni,oe.markEnd(oe.createFunctionExpression(be,Bt,[],ei),yi)}function Fn(){if(ue.type===K.Keyword)switch(ue.value){case"const":case"let":return yn(ue.value);case"function":return os();default:return Xi()}if(ue.type!==K.EOF)return Xi()}function as(){for(var he,be=[],De,Ve,nt;re<de&&(De=ue,!(De.type!==K.StringLiteral||(he=Fn(),be.push(he),he.expression.type!==Q.Literal)));)Ve=ie.slice(De.start+1,De.end-1),Ve==="use strict"?(se=!0,nt&&St(nt,X.StrictOctalLiteral)):!nt&&De.octal&&(nt=De);for(;re<de&&(he=Fn(),!(typeof he>"u"));)be.push(he);return be}function Ws(){var he,be;return Ke(),ki(),be=ue,se=!1,he=as(),oe.markEnd(oe.createProgram(he),be)}function zs(){var he,be,De,Ve=[];for(he=0;he<fe.tokens.length;++he)be=fe.tokens[he],De={type:be.type,value:be.value},fe.range&&(De.range=be.range),fe.loc&&(De.loc=be.loc),Ve.push(De);fe.tokens=Ve}function Vs(he,be){var De,Ve,nt;De=String,typeof he!="string"&&!(he instanceof String)&&(he=De(he)),oe=te,ie=he,re=0,ae=ie.length>0?1:0,le=0,de=ie.length,ue=null,pe={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},fe={},be=be||{},be.tokens=!0,fe.tokens=[],fe.tokenize=!0,fe.openParenToken=-1,fe.openCurlyToken=-1,fe.range=typeof be.range=="boolean"&&be.range,fe.loc=typeof be.loc=="boolean"&&be.loc,typeof be.comment=="boolean"&&be.comment&&(fe.comments=[]),typeof be.tolerant=="boolean"&&be.tolerant&&(fe.errors=[]);try{if(ki(),ue.type===K.EOF)return fe.tokens;for(Ve=kt();ue.type!==K.EOF;)try{Ve=kt()}catch(gt){if(Ve=ue,fe.errors){fe.errors.push(gt);break}else throw gt}zs(),nt=fe.tokens,typeof fe.comments<"u"&&(nt.comments=fe.comments),typeof fe.errors<"u"&&(nt.errors=fe.errors)}catch(gt){throw gt}finally{fe={}}return nt}function Hs(he,be){var De,Ve;Ve=String,typeof he!="string"&&!(he instanceof String)&&(he=Ve(he)),oe=te,ie=he,re=0,ae=ie.length>0?1:0,le=0,de=ie.length,ue=null,pe={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},fe={},typeof be<"u"&&(fe.range=typeof be.range=="boolean"&&be.range,fe.loc=typeof be.loc=="boolean"&&be.loc,fe.attachComment=typeof be.attachComment=="boolean"&&be.attachComment,fe.loc&&be.source!==null&&be.source!==void 0&&(fe.source=Ve(be.source)),typeof be.tokens=="boolean"&&be.tokens&&(fe.tokens=[]),typeof be.comment=="boolean"&&be.comment&&(fe.comments=[]),typeof be.tolerant=="boolean"&&be.tolerant&&(fe.errors=[]),fe.attachComment&&(fe.range=!0,fe.comments=[],fe.bottomRightStack=[],fe.trailingComments=[],fe.leadingComments=[]));try{De=Ws(),typeof fe.comments<"u"&&(De.comments=fe.comments),typeof fe.tokens<"u"&&(zs(),De.tokens=fe.tokens),typeof fe.errors<"u"&&(De.errors=fe.errors)}catch(nt){throw nt}finally{fe={}}return De}U.version="1.2.2",U.tokenize=Vs,U.parse=Hs,U.Syntax=function(){var he,be={};typeof Object.create=="function"&&(be=Object.create(null));for(he in Q)Q.hasOwnProperty(he)&&(be[he]=Q[he]);return typeof Object.freeze=="function"&&Object.freeze(be),be}()})},{}],1:[function(D,O,W){(function(U){var K=function(){var q={trace:function(){},yy:{},symbols_:{error:2,JSON_PATH:3,DOLLAR:4,PATH_COMPONENTS:5,LEADING_CHILD_MEMBER_EXPRESSION:6,PATH_COMPONENT:7,MEMBER_COMPONENT:8,SUBSCRIPT_COMPONENT:9,CHILD_MEMBER_COMPONENT:10,DESCENDANT_MEMBER_COMPONENT:11,DOT:12,MEMBER_EXPRESSION:13,DOT_DOT:14,STAR:15,IDENTIFIER:16,SCRIPT_EXPRESSION:17,INTEGER:18,END:19,CHILD_SUBSCRIPT_COMPONENT:20,DESCENDANT_SUBSCRIPT_COMPONENT:21,"[":22,SUBSCRIPT:23,"]":24,SUBSCRIPT_EXPRESSION:25,SUBSCRIPT_EXPRESSION_LIST:26,SUBSCRIPT_EXPRESSION_LISTABLE:27,",":28,STRING_LITERAL:29,ARRAY_SLICE:30,FILTER_EXPRESSION:31,QQ_STRING:32,Q_STRING:33,$accept:0,$end:1},terminals_:{2:"error",4:"DOLLAR",12:"DOT",14:"DOT_DOT",15:"STAR",16:"IDENTIFIER",17:"SCRIPT_EXPRESSION",18:"INTEGER",19:"END",22:"[",24:"]",28:",",30:"ARRAY_SLICE",31:"FILTER_EXPRESSION",32:"QQ_STRING",33:"Q_STRING"},productions_:[0,[3,1],[3,2],[3,1],[3,2],[5,1],[5,2],[7,1],[7,1],[8,1],[8,1],[10,2],[6,1],[11,2],[13,1],[13,1],[13,1],[13,1],[13,1],[9,1],[9,1],[20,3],[21,4],[23,1],[23,1],[26,1],[26,3],[27,1],[27,1],[27,1],[25,1],[25,1],[25,1],[29,1],[29,1]],performAction:function(J,te,ie,se,re,ae,le){se.ast||(se.ast=G,G.initialize());var de=ae.length-1;switch(re){case 1:return se.ast.set({expression:{type:"root",value:ae[de]}}),se.ast.unshift(),se.ast.yield();case 2:return se.ast.set({expression:{type:"root",value:ae[de-1]}}),se.ast.unshift(),se.ast.yield();case 3:return se.ast.unshift(),se.ast.yield();case 4:return se.ast.set({operation:"member",scope:"child",expression:{type:"identifier",value:ae[de-1]}}),se.ast.unshift(),se.ast.yield();case 5:break;case 6:break;case 7:se.ast.set({operation:"member"}),se.ast.push();break;case 8:se.ast.set({operation:"subscript"}),se.ast.push();break;case 9:se.ast.set({scope:"child"});break;case 10:se.ast.set({scope:"descendant"});break;case 11:break;case 12:se.ast.set({scope:"child",operation:"member"});break;case 13:break;case 14:se.ast.set({expression:{type:"wildcard",value:ae[de]}});break;case 15:se.ast.set({expression:{type:"identifier",value:ae[de]}});break;case 16:se.ast.set({expression:{type:"script_expression",value:ae[de]}});break;case 17:se.ast.set({expression:{type:"numeric_literal",value:parseInt(ae[de])}});break;case 18:break;case 19:se.ast.set({scope:"child"});break;case 20:se.ast.set({scope:"descendant"});break;case 21:break;case 22:break;case 23:break;case 24:ae[de].length>1?se.ast.set({expression:{type:"union",value:ae[de]}}):this.$=ae[de];break;case 25:this.$=[ae[de]];break;case 26:this.$=ae[de-2].concat(ae[de]);break;case 27:this.$={expression:{type:"numeric_literal",value:parseInt(ae[de])}},se.ast.set(this.$);break;case 28:this.$={expression:{type:"string_literal",value:ae[de]}},se.ast.set(this.$);break;case 29:this.$={expression:{type:"slice",value:ae[de]}},se.ast.set(this.$);break;case 30:this.$={expression:{type:"wildcard",value:ae[de]}},se.ast.set(this.$);break;case 31:this.$={expression:{type:"script_expression",value:ae[de]}},se.ast.set(this.$);break;case 32:this.$={expression:{type:"filter_expression",value:ae[de]}},se.ast.set(this.$);break;case 33:this.$=ae[de];break;case 34:this.$=ae[de];break}},table:[{3:1,4:[1,2],6:3,13:4,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{1:[3]},{1:[2,1],5:10,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,3],5:21,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,12],12:[2,12],14:[2,12],22:[2,12]},{1:[2,14],12:[2,14],14:[2,14],22:[2,14]},{1:[2,15],12:[2,15],14:[2,15],22:[2,15]},{1:[2,16],12:[2,16],14:[2,16],22:[2,16]},{1:[2,17],12:[2,17],14:[2,17],22:[2,17]},{1:[2,18],12:[2,18],14:[2,18],22:[2,18]},{1:[2,2],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,5],12:[2,5],14:[2,5],22:[2,5]},{1:[2,7],12:[2,7],14:[2,7],22:[2,7]},{1:[2,8],12:[2,8],14:[2,8],22:[2,8]},{1:[2,9],12:[2,9],14:[2,9],22:[2,9]},{1:[2,10],12:[2,10],14:[2,10],22:[2,10]},{1:[2,19],12:[2,19],14:[2,19],22:[2,19]},{1:[2,20],12:[2,20],14:[2,20],22:[2,20]},{13:23,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{13:24,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9],22:[1,25]},{15:[1,29],17:[1,30],18:[1,33],23:26,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{1:[2,4],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,6],12:[2,6],14:[2,6],22:[2,6]},{1:[2,11],12:[2,11],14:[2,11],22:[2,11]},{1:[2,13],12:[2,13],14:[2,13],22:[2,13]},{15:[1,29],17:[1,30],18:[1,33],23:38,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{24:[1,39]},{24:[2,23]},{24:[2,24],28:[1,40]},{24:[2,30]},{24:[2,31]},{24:[2,32]},{24:[2,25],28:[2,25]},{24:[2,27],28:[2,27]},{24:[2,28],28:[2,28]},{24:[2,29],28:[2,29]},{24:[2,33],28:[2,33]},{24:[2,34],28:[2,34]},{24:[1,41]},{1:[2,21],12:[2,21],14:[2,21],22:[2,21]},{18:[1,33],27:42,29:34,30:[1,35],32:[1,36],33:[1,37]},{1:[2,22],12:[2,22],14:[2,22],22:[2,22]},{24:[2,26],28:[2,26]}],defaultActions:{27:[2,23],29:[2,30],30:[2,31],31:[2,32]},parseError:function(J,te){if(te.recoverable)this.trace(J);else throw new Error(J)},parse:function(J){var te=this,ie=[0],se=[null],re=[],ae=this.table,le="",de=0,oe=0,ue=2,pe=1,fe=re.slice.call(arguments,1);this.lexer.setInput(J),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc>"u"&&(this.lexer.yylloc={});var Ce=this.lexer.yylloc;re.push(Ce);var we=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"?this.parseError=this.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function Oe(){var lt;return lt=te.lexer.lex()||pe,typeof lt!="number"&&(lt=te.symbols_[lt]||lt),lt}for(var Te,Re,Me,Ne,ze={},Qe,Ye,Je,at;;){if(Re=ie[ie.length-1],this.defaultActions[Re]?Me=this.defaultActions[Re]:((Te===null||typeof Te>"u")&&(Te=Oe()),Me=ae[Re]&&ae[Re][Te]),typeof Me>"u"||!Me.length||!Me[0]){var st="";at=[];for(Qe in ae[Re])this.terminals_[Qe]&&Qe>ue&&at.push("'"+this.terminals_[Qe]+"'");this.lexer.showPosition?st="Parse error on line "+(de+1)+`:
`+this.lexer.showPosition()+`
Expecting `+at.join(", ")+", got '"+(this.terminals_[Te]||Te)+"'":st="Parse error on line "+(de+1)+": Unexpected "+(Te==pe?"end of input":"'"+(this.terminals_[Te]||Te)+"'"),this.parseError(st,{text:this.lexer.match,token:this.terminals_[Te]||Te,line:this.lexer.yylineno,loc:Ce,expected:at})}if(Me[0]instanceof Array&&Me.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Re+", token: "+Te);switch(Me[0]){case 1:ie.push(Te),se.push(this.lexer.yytext),re.push(this.lexer.yylloc),ie.push(Me[1]),Te=null,oe=this.lexer.yyleng,le=this.lexer.yytext,de=this.lexer.yylineno,Ce=this.lexer.yylloc;break;case 2:if(Ye=this.productions_[Me[1]][1],ze.$=se[se.length-Ye],ze._$={first_line:re[re.length-(Ye||1)].first_line,last_line:re[re.length-1].last_line,first_column:re[re.length-(Ye||1)].first_column,last_column:re[re.length-1].last_column},we&&(ze._$.range=[re[re.length-(Ye||1)].range[0],re[re.length-1].range[1]]),Ne=this.performAction.apply(ze,[le,oe,de,this.yy,Me[1],se,re].concat(fe)),typeof Ne<"u")return Ne;Ye&&(ie=ie.slice(0,-1*Ye*2),se=se.slice(0,-1*Ye),re=re.slice(0,-1*Ye)),ie.push(this.productions_[Me[1]][0]),se.push(ze.$),re.push(ze._$),Je=ae[ie[ie.length-2]][ie[ie.length-1]],ie.push(Je);break;case 3:return!0}}return!0}},G={initialize:function(){this._nodes=[],this._node={},this._stash=[]},set:function(X){for(var J in X)this._node[J]=X[J];return this._node},node:function(X){return arguments.length&&(this._node=X),this._node},push:function(){this._nodes.push(this._node),this._node={}},unshift:function(){this._nodes.unshift(this._node),this._node={}},yield:function(){var X=this._nodes;return this.initialize(),X}},Q=function(){var X={EOF:1,parseError:function(te,ie){if(this.yy.parser)this.yy.parser.parseError(te,ie);else throw new Error(te)},setInput:function(J){return this._input=J,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var J=this._input[0];this.yytext+=J,this.yyleng++,this.offset++,this.match+=J,this.matched+=J;var te=J.match(/(?:\r\n?|\n).*/g);return te?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),J},unput:function(J){var te=J.length,ie=J.split(/(?:\r\n?|\n)/g);this._input=J+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-te-1),this.offset-=te;var se=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),ie.length-1&&(this.yylineno-=ie.length-1);var re=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:ie?(ie.length===se.length?this.yylloc.first_column:0)+se[se.length-ie.length].length-ie[0].length:this.yylloc.first_column-te},this.options.ranges&&(this.yylloc.range=[re[0],re[0]+this.yyleng-te]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(J){this.unput(this.match.slice(J))},pastInput:function(){var J=this.matched.substr(0,this.matched.length-this.match.length);return(J.length>20?"...":"")+J.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var J=this.match;return J.length<20&&(J+=this._input.substr(0,20-J.length)),(J.substr(0,20)+(J.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var J=this.pastInput(),te=new Array(J.length+1).join("-");return J+this.upcomingInput()+`
`+te+"^"},test_match:function(J,te){var ie,se,re;if(this.options.backtrack_lexer&&(re={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(re.yylloc.range=this.yylloc.range.slice(0))),se=J[0].match(/(?:\r\n?|\n).*/g),se&&(this.yylineno+=se.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:se?se[se.length-1].length-se[se.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+J[0].length},this.yytext+=J[0],this.match+=J[0],this.matches=J,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(J[0].length),this.matched+=J[0],ie=this.performAction.call(this,this.yy,this,te,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),ie)return ie;if(this._backtrack){for(var ae in re)this[ae]=re[ae];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var J,te,ie,se;this._more||(this.yytext="",this.match="");for(var re=this._currentRules(),ae=0;ae<re.length;ae++)if(ie=this._input.match(this.rules[re[ae]]),ie&&(!te||ie[0].length>te[0].length)){if(te=ie,se=ae,this.options.backtrack_lexer){if(J=this.test_match(ie,re[ae]),J!==!1)return J;if(this._backtrack){te=!1;continue}else return!1}else if(!this.options.flex)break}return te?(J=this.test_match(te,re[se]),J!==!1?J:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var te=this.next();return te||this.lex()},begin:function(te){this.conditionStack.push(te)},popState:function(){var te=this.conditionStack.length-1;return te>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(te){return te=this.conditionStack.length-1-Math.abs(te||0),te>=0?this.conditionStack[te]:"INITIAL"},pushState:function(te){this.begin(te)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(te,ie,se,re){switch(se){case 0:return 4;case 1:return 14;case 2:return 12;case 3:return 15;case 4:return 16;case 5:return 22;case 6:return 24;case 7:return 28;case 8:return 30;case 9:return 18;case 10:return ie.yytext=ie.yytext.substr(1,ie.yyleng-2),32;case 11:return ie.yytext=ie.yytext.substr(1,ie.yyleng-2),33;case 12:return 17;case 13:return 31}},rules:[/^(?:\$)/,/^(?:\.\.)/,/^(?:\.)/,/^(?:\*)/,/^(?:[a-zA-Z_]+[a-zA-Z0-9_]*)/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?:((-?(?:0|[1-9][0-9]*)))?\:((-?(?:0|[1-9][0-9]*)))?(\:((-?(?:0|[1-9][0-9]*)))?)?)/,/^(?:(-?(?:0|[1-9][0-9]*)))/,/^(?:"(?:\\["bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^"\\])*")/,/^(?:'(?:\\['bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^'\\])*')/,/^(?:\(.+?\)(?=\]))/,/^(?:\?\(.+?\)(?=\]))/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return X}();q.lexer=Q;function Y(){this.yy={}}return Y.prototype=q,q.Parser=Y,new Y}();typeof D<"u"&&typeof W<"u"&&(W.parser=K,W.Parser=K.Parser,W.parse=function(){return K.parse.apply(K,arguments)},W.main=function(G){G[1]||(console.log("Usage: "+G[0]+" FILE"),U.exit(1));var Q=D("fs").readFileSync(D("path").normalize(G[1]),"utf8");return W.parser.parse(Q)},typeof O<"u"&&D.main===O&&W.main(U.argv.slice(1)))}).call(this,D("_process"))},{_process:14,fs:12,path:13}],2:[function(D,O,W){O.exports={identifier:"[a-zA-Z_]+[a-zA-Z0-9_]*",integer:"-?(?:0|[1-9][0-9]*)",qq_string:'"(?:\\\\["bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^"\\\\])*"',q_string:"'(?:\\\\['bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^'\\\\])*'"}},{}],3:[function(D,O,W){var U=D("./dict"),K=D("fs"),q={lex:{macros:{esc:"\\\\",int:U.integer},rules:[["\\$","return 'DOLLAR'"],["\\.\\.","return 'DOT_DOT'"],["\\.","return 'DOT'"],["\\*","return 'STAR'"],[U.identifier,"return 'IDENTIFIER'"],["\\[","return '['"],["\\]","return ']'"],[",","return ','"],["({int})?\\:({int})?(\\:({int})?)?","return 'ARRAY_SLICE'"],["{int}","return 'INTEGER'"],[U.qq_string,"yytext = yytext.substr(1,yyleng-2); return 'QQ_STRING';"],[U.q_string,"yytext = yytext.substr(1,yyleng-2); return 'Q_STRING';"],["\\(.+?\\)(?=\\])","return 'SCRIPT_EXPRESSION'"],["\\?\\(.+?\\)(?=\\])","return 'FILTER_EXPRESSION'"]]},start:"JSON_PATH",bnf:{JSON_PATH:[["DOLLAR",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["DOLLAR PATH_COMPONENTS",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["LEADING_CHILD_MEMBER_EXPRESSION","yy.ast.unshift(); return yy.ast.yield()"],["LEADING_CHILD_MEMBER_EXPRESSION PATH_COMPONENTS",'yy.ast.set({ operation: "member", scope: "child", expression: { type: "identifier", value: $1 }}); yy.ast.unshift(); return yy.ast.yield()']],PATH_COMPONENTS:[["PATH_COMPONENT",""],["PATH_COMPONENTS PATH_COMPONENT",""]],PATH_COMPONENT:[["MEMBER_COMPONENT",'yy.ast.set({ operation: "member" }); yy.ast.push()'],["SUBSCRIPT_COMPONENT",'yy.ast.set({ operation: "subscript" }); yy.ast.push() ']],MEMBER_COMPONENT:[["CHILD_MEMBER_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_MEMBER_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_MEMBER_COMPONENT:[["DOT MEMBER_EXPRESSION",""]],LEADING_CHILD_MEMBER_EXPRESSION:[["MEMBER_EXPRESSION",'yy.ast.set({ scope: "child", operation: "member" })']],DESCENDANT_MEMBER_COMPONENT:[["DOT_DOT MEMBER_EXPRESSION",""]],MEMBER_EXPRESSION:[["STAR",'yy.ast.set({ expression: { type: "wildcard", value: $1 } })'],["IDENTIFIER",'yy.ast.set({ expression: { type: "identifier", value: $1 } })'],["SCRIPT_EXPRESSION",'yy.ast.set({ expression: { type: "script_expression", value: $1 } })'],["INTEGER",'yy.ast.set({ expression: { type: "numeric_literal", value: parseInt($1) } })'],["END",""]],SUBSCRIPT_COMPONENT:[["CHILD_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_SUBSCRIPT_COMPONENT:[["[ SUBSCRIPT ]",""]],DESCENDANT_SUBSCRIPT_COMPONENT:[["DOT_DOT [ SUBSCRIPT ]",""]],SUBSCRIPT:[["SUBSCRIPT_EXPRESSION",""],["SUBSCRIPT_EXPRESSION_LIST",'$1.length > 1? yy.ast.set({ expression: { type: "union", value: $1 } }) : $$ = $1']],SUBSCRIPT_EXPRESSION_LIST:[["SUBSCRIPT_EXPRESSION_LISTABLE","$$ = [$1]"],["SUBSCRIPT_EXPRESSION_LIST , SUBSCRIPT_EXPRESSION_LISTABLE","$$ = $1.concat($3)"]],SUBSCRIPT_EXPRESSION_LISTABLE:[["INTEGER",'$$ = { expression: { type: "numeric_literal", value: parseInt($1) } }; yy.ast.set($$)'],["STRING_LITERAL",'$$ = { expression: { type: "string_literal", value: $1 } }; yy.ast.set($$)'],["ARRAY_SLICE",'$$ = { expression: { type: "slice", value: $1 } }; yy.ast.set($$)']],SUBSCRIPT_EXPRESSION:[["STAR",'$$ = { expression: { type: "wildcard", value: $1 } }; yy.ast.set($$)'],["SCRIPT_EXPRESSION",'$$ = { expression: { type: "script_expression", value: $1 } }; yy.ast.set($$)'],["FILTER_EXPRESSION",'$$ = { expression: { type: "filter_expression", value: $1 } }; yy.ast.set($$)']],STRING_LITERAL:[["QQ_STRING","$$ = $1"],["Q_STRING","$$ = $1"]]}};K.readFileSync&&(q.moduleInclude=K.readFileSync(D.resolve("../include/module.js")),q.actionInclude=K.readFileSync(D.resolve("../include/action.js"))),O.exports=q},{"./dict":2,fs:12}],4:[function(D,O,W){var U=D("./aesprim"),K=D("./slice"),q=D("static-eval"),G=D("underscore").uniq,Q=function(){return this.initialize.apply(this,arguments)};Q.prototype.initialize=function(){this.traverse=te(!0),this.descend=te()},Q.prototype.keys=Object.keys,Q.prototype.resolve=function(de){var oe=[de.operation,de.scope,de.expression.type].join("-"),ue=this._fns[oe];if(!ue)throw new Error("couldn't resolve key: "+oe);return ue.bind(this)},Q.prototype.register=function(de,oe){if(!oe instanceof Function)throw new Error("handler must be a function");this._fns[de]=oe},Q.prototype._fns={"member-child-identifier":function(de,oe){var ue=de.expression.value,pe=oe.value;if(pe instanceof Object&&ue in pe)return[{value:pe[ue],path:oe.path.concat(ue)}]},"member-descendant-identifier":se(function(de,oe,ue){return de==ue}),"subscript-child-numeric_literal":ie(function(de,oe,ue){return de===ue}),"member-child-numeric_literal":ie(function(de,oe,ue){return String(de)===String(ue)}),"subscript-descendant-numeric_literal":se(function(de,oe,ue){return de===ue}),"member-child-wildcard":ie(function(){return!0}),"member-descendant-wildcard":se(function(){return!0}),"subscript-descendant-wildcard":se(function(){return!0}),"subscript-child-wildcard":ie(function(){return!0}),"subscript-child-slice":function(de,oe){if(X(oe.value)){var ue=de.expression.value.split(":").map(le),pe=oe.value.map(function(fe,Ce){return{value:fe,path:oe.path.concat(Ce)}});return K.apply(null,[pe].concat(ue))}},"subscript-child-union":function(de,oe){var ue=[];return de.expression.value.forEach(function(pe){var fe={operation:"subscript",scope:"child",expression:pe.expression},Ce=this.resolve(fe),we=Ce(fe,oe);we&&(ue=ue.concat(we))},this),ae(ue)},"subscript-descendant-union":function(de,oe,ue){var pe=D(".."),fe=this,Ce=[],we=pe.nodes(oe,"$..*").slice(1);return we.forEach(function(Oe){Ce.length>=ue||de.expression.value.forEach(function(Te){var Re={operation:"subscript",scope:"child",expression:Te.expression},Me=fe.resolve(Re),Ne=Me(Re,Oe);Ce=Ce.concat(Ne)})}),ae(Ce)},"subscript-child-filter_expression":function(de,oe,ue){var pe=de.expression.value.slice(2,-1),fe=U.parse(pe).body[0].expression,Ce=function(we,Oe){return re(fe,{"@":Oe})};return this.descend(oe,null,Ce,ue)},"subscript-descendant-filter_expression":function(de,oe,ue){var pe=de.expression.value.slice(2,-1),fe=U.parse(pe).body[0].expression,Ce=function(we,Oe){return re(fe,{"@":Oe})};return this.traverse(oe,null,Ce,ue)},"subscript-child-script_expression":function(de,oe){var ue=de.expression.value.slice(1,-1);return Y(oe,ue,"$[{{value}}]")},"member-child-script_expression":function(de,oe){var ue=de.expression.value.slice(1,-1);return Y(oe,ue,"$.{{value}}")},"member-descendant-script_expression":function(de,oe){var ue=de.expression.value.slice(1,-1);return Y(oe,ue,"$..value")}},Q.prototype._fns["subscript-child-string_literal"]=Q.prototype._fns["member-child-identifier"],Q.prototype._fns["member-descendant-numeric_literal"]=Q.prototype._fns["subscript-descendant-string_literal"]=Q.prototype._fns["member-descendant-identifier"];function Y(de,oe,ue){var pe=D("./index"),fe=U.parse(oe).body[0].expression,Ce=re(fe,{"@":de.value}),we=ue.replace(/\{\{\s*value\s*\}\}/g,Ce),Oe=pe.nodes(de.value,we);return Oe.forEach(function(Te){Te.path=de.path.concat(Te.path.slice(1))}),Oe}function X(de){return Array.isArray(de)}function J(de){return de&&!(de instanceof Array)&&de instanceof Object}function te(de){return function(oe,ue,pe,fe){var Ce=oe.value,we=oe.path,Oe=[],Te=function(Re,Me){X(Re)?(Re.forEach(function(Ne,ze){Oe.length>=fe||pe(ze,Ne,ue)&&Oe.push({path:Me.concat(ze),value:Ne})}),Re.forEach(function(Ne,ze){Oe.length>=fe||de&&Te(Ne,Me.concat(ze))})):J(Re)&&(this.keys(Re).forEach(function(Ne){Oe.length>=fe||pe(Ne,Re[Ne],ue)&&Oe.push({path:Me.concat(Ne),value:Re[Ne]})}),this.keys(Re).forEach(function(Ne){Oe.length>=fe||de&&Te(Re[Ne],Me.concat(Ne))}))}.bind(this);return Te(Ce,we),Oe}}function ie(de){return function(oe,ue,pe){return this.descend(ue,oe.expression.value,de,pe)}}function se(de){return function(oe,ue,pe){return this.traverse(ue,oe.expression.value,de,pe)}}function re(){try{return q.apply(this,arguments)}catch{}}function ae(de){return de=de.filter(function(oe){return oe}),G(de,function(oe){return oe.path.map(function(ue){return String(ue).replace("-","--")}).join("-")})}function le(de){var oe=String(de);return oe.match(/^-?[0-9]+$/)?parseInt(oe):null}O.exports=Q},{"..":"jsonpath","./aesprim":"./aesprim","./index":5,"./slice":7,"static-eval":15,underscore:12}],5:[function(D,O,W){var U=D("assert"),K=D("./dict"),q=D("./parser"),G=D("./handlers"),Q=function(){this.initialize.apply(this,arguments)};Q.prototype.initialize=function(){this.parser=new q,this.handlers=new G},Q.prototype.parse=function(J){return U.ok(Y(J),"we need a path"),this.parser.parse(J)},Q.prototype.parent=function(J,te){U.ok(J instanceof Object,"obj needs to be an object"),U.ok(te,"we need a path");var ie=this.nodes(J,te)[0];return ie.path.pop(),this.value(J,ie.path)},Q.prototype.apply=function(J,te,ie){U.ok(J instanceof Object,"obj needs to be an object"),U.ok(te,"we need a path"),U.equal(typeof ie,"function","fn needs to be function");var se=this.nodes(J,te).sort(function(re,ae){return ae.path.length-re.path.length});return se.forEach(function(re){var ae=re.path.pop(),le=this.value(J,this.stringify(re.path)),de=re.value=ie.call(J,le[ae]);le[ae]=de},this),se},Q.prototype.value=function(J,te,ie){if(U.ok(J instanceof Object,"obj needs to be an object"),U.ok(te,"we need a path"),arguments.length>=3){var se=this.nodes(J,te).shift();if(!se)return this._vivify(J,te,ie);var re=se.path.slice(-1).shift(),ae=this.parent(J,this.stringify(se.path));ae[re]=ie}return this.query(J,this.stringify(te),1).shift()},Q.prototype._vivify=function(J,te,ie){var se=this;U.ok(J instanceof Object,"obj needs to be an object"),U.ok(te,"we need a path");var re=this.parser.parse(te).map(function(le){return le.expression.value}),ae=function(le,de){var oe=le.pop(),ue=se.value(J,le);ue||(ae(le.concat(),typeof oe=="string"?{}:[]),ue=se.value(J,le)),ue[oe]=de};return ae(re,ie),this.query(J,te)[0]},Q.prototype.query=function(J,te,ie){U.ok(J instanceof Object,"obj needs to be an object"),U.ok(Y(te),"we need a path");var se=this.nodes(J,te,ie).map(function(re){return re.value});return se},Q.prototype.paths=function(J,te,ie){U.ok(J instanceof Object,"obj needs to be an object"),U.ok(te,"we need a path");var se=this.nodes(J,te,ie).map(function(re){return re.path});return se},Q.prototype.nodes=function(J,te,ie){if(U.ok(J instanceof Object,"obj needs to be an object"),U.ok(te,"we need a path"),ie===0)return[];var se=this.parser.parse(te),re=this.handlers,ae=[{path:["$"],value:J}],le=[];return se.length&&se[0].expression.type=="root"&&se.shift(),se.length?(se.forEach(function(de,oe){if(!(le.length>=ie)){var ue=re.resolve(de),pe=[];ae.forEach(function(fe){if(!(le.length>=ie)){var Ce=ue(de,fe,ie);oe==se.length-1?le=le.concat(Ce||[]):pe=pe.concat(Ce||[])}}),ae=pe}}),ie?le.slice(0,ie):le):ae},Q.prototype.stringify=function(J){U.ok(J,"we need a path");var te="$",ie={"descendant-member":"..{{value}}","child-member":".{{value}}","descendant-subscript":"..[{{value}}]","child-subscript":"[{{value}}]"};return J=this._normalize(J),J.forEach(function(se){if(se.expression.type!="root"){var re=[se.scope,se.operation].join("-"),ae=ie[re],le;if(se.expression.type=="string_literal"?le=JSON.stringify(se.expression.value):le=se.expression.value,!ae)throw new Error("couldn't find template "+re);te+=ae.replace(/{{value}}/,le)}}),te},Q.prototype._normalize=function(J){if(U.ok(J,"we need a path"),typeof J=="string")return this.parser.parse(J);if(Array.isArray(J)&&typeof J[0]=="string"){var te=[{expression:{type:"root",value:"$"}}];return J.forEach(function(ie,se){if(!(ie=="$"&&se===0))if(typeof ie=="string"&&ie.match("^"+K.identifier+"$"))te.push({operation:"member",scope:"child",expression:{value:ie,type:"identifier"}});else{var re=typeof ie=="number"?"numeric_literal":"string_literal";te.push({operation:"subscript",scope:"child",expression:{value:ie,type:re}})}}),te}else if(Array.isArray(J)&&typeof J[0]=="object")return J;throw new Error("couldn't understand path "+J)};function Y(J){return Object.prototype.toString.call(J)=="[object String]"}Q.Handlers=G,Q.Parser=q;var X=new Q;X.JSONPath=Q,O.exports=X},{"./dict":2,"./handlers":4,"./parser":6,assert:8}],6:[function(D,O,W){var U=D("./grammar"),K=D("../generated/parser"),q=function(){var G=new K.Parser,Q=G.parseError;return G.yy.parseError=function(){G.yy.ast&&G.yy.ast.initialize(),Q.apply(G,arguments)},G};q.grammar=U,O.exports=q},{"../generated/parser":1,"./grammar":3}],7:[function(D,O,W){O.exports=function(K,q,G,Q){if(typeof q=="string")throw new Error("start cannot be a string");if(typeof G=="string")throw new Error("end cannot be a string");if(typeof Q=="string")throw new Error("step cannot be a string");var Y=K.length;if(Q===0)throw new Error("step cannot be zero");if(Q=Q?U(Q):1,q=q<0?Y+q:q,G=G<0?Y+G:G,q=U(q===0?0:q||(Q>0?0:Y-1)),G=U(G===0?0:G||(Q>0?Y:-1)),q=Q>0?Math.max(0,q):Math.min(Y,q),G=Q>0?Math.min(G,Y):Math.max(-1,G),Q>0&&G<=q)return[];if(Q<0&&q<=G)return[];for(var X=[],J=q;J!=G&&!(Q<0&&J<=G||Q>0&&J>=G);J+=Q)X.push(K[J]);return X};function U(K){return String(K).match(/^[0-9]+$/)?parseInt(K):Number.isFinite(K)?parseInt(K,10):0}},{}],8:[function(D,O,W){var U=D("util/"),K=Array.prototype.slice,q=Object.prototype.hasOwnProperty,G=O.exports=te;G.AssertionError=function(ue){this.name="AssertionError",this.actual=ue.actual,this.expected=ue.expected,this.operator=ue.operator,ue.message?(this.message=ue.message,this.generatedMessage=!1):(this.message=X(this),this.generatedMessage=!0);var pe=ue.stackStartFunction||J;if(Error.captureStackTrace)Error.captureStackTrace(this,pe);else{var fe=new Error;if(fe.stack){var Ce=fe.stack,we=pe.name,Oe=Ce.indexOf(`
`+we);if(Oe>=0){var Te=Ce.indexOf(`
`,Oe+1);Ce=Ce.substring(Te+1)}this.stack=Ce}}},U.inherits(G.AssertionError,Error);function Q(oe,ue){return U.isUndefined(ue)?""+ue:U.isNumber(ue)&&!isFinite(ue)||U.isFunction(ue)||U.isRegExp(ue)?ue.toString():ue}function Y(oe,ue){return U.isString(oe)?oe.length<ue?oe:oe.slice(0,ue):oe}function X(oe){return Y(JSON.stringify(oe.actual,Q),128)+" "+oe.operator+" "+Y(JSON.stringify(oe.expected,Q),128)}function J(oe,ue,pe,fe,Ce){throw new G.AssertionError({message:pe,actual:oe,expected:ue,operator:fe,stackStartFunction:Ce})}G.fail=J;function te(oe,ue){oe||J(oe,!0,ue,"==",G.ok)}G.ok=te,G.equal=function(ue,pe,fe){ue!=pe&&J(ue,pe,fe,"==",G.equal)},G.notEqual=function(ue,pe,fe){ue==pe&&J(ue,pe,fe,"!=",G.notEqual)},G.deepEqual=function(ue,pe,fe){ie(ue,pe)||J(ue,pe,fe,"deepEqual",G.deepEqual)};function ie(oe,ue){if(oe===ue)return!0;if(U.isBuffer(oe)&&U.isBuffer(ue)){if(oe.length!=ue.length)return!1;for(var pe=0;pe<oe.length;pe++)if(oe[pe]!==ue[pe])return!1;return!0}else return U.isDate(oe)&&U.isDate(ue)?oe.getTime()===ue.getTime():U.isRegExp(oe)&&U.isRegExp(ue)?oe.source===ue.source&&oe.global===ue.global&&oe.multiline===ue.multiline&&oe.lastIndex===ue.lastIndex&&oe.ignoreCase===ue.ignoreCase:!U.isObject(oe)&&!U.isObject(ue)?oe==ue:re(oe,ue)}function se(oe){return Object.prototype.toString.call(oe)=="[object Arguments]"}function re(oe,ue){if(U.isNullOrUndefined(oe)||U.isNullOrUndefined(ue)||oe.prototype!==ue.prototype)return!1;if(U.isPrimitive(oe)||U.isPrimitive(ue))return oe===ue;var pe=se(oe),fe=se(ue);if(pe&&!fe||!pe&&fe)return!1;if(pe)return oe=K.call(oe),ue=K.call(ue),ie(oe,ue);var Ce=de(oe),we=de(ue),Oe,Te;if(Ce.length!=we.length)return!1;for(Ce.sort(),we.sort(),Te=Ce.length-1;Te>=0;Te--)if(Ce[Te]!=we[Te])return!1;for(Te=Ce.length-1;Te>=0;Te--)if(Oe=Ce[Te],!ie(oe[Oe],ue[Oe]))return!1;return!0}G.notDeepEqual=function(ue,pe,fe){ie(ue,pe)&&J(ue,pe,fe,"notDeepEqual",G.notDeepEqual)},G.strictEqual=function(ue,pe,fe){ue!==pe&&J(ue,pe,fe,"===",G.strictEqual)},G.notStrictEqual=function(ue,pe,fe){ue===pe&&J(ue,pe,fe,"!==",G.notStrictEqual)};function ae(oe,ue){return!oe||!ue?!1:Object.prototype.toString.call(ue)=="[object RegExp]"?ue.test(oe):oe instanceof ue?!0:ue.call({},oe)===!0}function le(oe,ue,pe,fe){var Ce;U.isString(pe)&&(fe=pe,pe=null);try{ue()}catch(we){Ce=we}if(fe=(pe&&pe.name?" ("+pe.name+").":".")+(fe?" "+fe:"."),oe&&!Ce&&J(Ce,pe,"Missing expected exception"+fe),!oe&&ae(Ce,pe)&&J(Ce,pe,"Got unwanted exception"+fe),oe&&Ce&&pe&&!ae(Ce,pe)||!oe&&Ce)throw Ce}G.throws=function(oe,ue,pe){le.apply(this,[!0].concat(K.call(arguments)))},G.doesNotThrow=function(oe,ue){le.apply(this,[!1].concat(K.call(arguments)))},G.ifError=function(oe){if(oe)throw oe};var de=Object.keys||function(oe){var ue=[];for(var pe in oe)q.call(oe,pe)&&ue.push(pe);return ue}},{"util/":11}],9:[function(D,O,W){typeof Object.create=="function"?O.exports=function(K,q){K.super_=q,K.prototype=Object.create(q.prototype,{constructor:{value:K,enumerable:!1,writable:!0,configurable:!0}})}:O.exports=function(K,q){K.super_=q;var G=function(){};G.prototype=q.prototype,K.prototype=new G,K.prototype.constructor=K}},{}],10:[function(D,O,W){O.exports=function(K){return K&&typeof K=="object"&&typeof K.copy=="function"&&typeof K.fill=="function"&&typeof K.readUInt8=="function"}},{}],11:[function(D,O,W){(function(U,K){var q=/%[sdj%]/g;W.format=function(Ke){if(!we(Ke)){for(var je=[],et=0;et<arguments.length;et++)je.push(Y(arguments[et]));return je.join(" ")}for(var et=1,mt=arguments,Mt=mt.length,Et=String(Ke).replace(q,function(Nt){if(Nt==="%%")return"%";if(et>=Mt)return Nt;switch(Nt){case"%s":return String(mt[et++]);case"%d":return Number(mt[et++]);case"%j":try{return JSON.stringify(mt[et++])}catch{return"[Circular]"}default:return Nt}}),Ct=mt[et];et<Mt;Ct=mt[++et])pe(Ct)||!Me(Ct)?Et+=" "+Ct:Et+=" "+Y(Ct);return Et},W.deprecate=function(Ke,je){if(Te(K.process))return function(){return W.deprecate(Ke,je).apply(this,arguments)};if(U.noDeprecation===!0)return Ke;var et=!1;function mt(){if(!et){if(U.throwDeprecation)throw new Error(je);U.traceDeprecation?console.trace(je):console.error(je),et=!0}return Ke.apply(this,arguments)}return mt};var G={},Q;W.debuglog=function(Ke){if(Te(Q)&&(Q=U.env.NODE_DEBUG||""),Ke=Ke.toUpperCase(),!G[Ke])if(new RegExp("\\b"+Ke+"\\b","i").test(Q)){var je=U.pid;G[Ke]=function(){var et=W.format.apply(W,arguments);console.error("%s %d: %s",Ke,je,et)}}else G[Ke]=function(){};return G[Ke]};function Y(Ke,je){var et={seen:[],stylize:J};return arguments.length>=3&&(et.depth=arguments[2]),arguments.length>=4&&(et.colors=arguments[3]),ue(je)?et.showHidden=je:je&&W._extend(et,je),Te(et.showHidden)&&(et.showHidden=!1),Te(et.depth)&&(et.depth=2),Te(et.colors)&&(et.colors=!1),Te(et.customInspect)&&(et.customInspect=!0),et.colors&&(et.stylize=X),ie(et,Ke,et.depth)}W.inspect=Y,Y.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Y.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function X(Ke,je){var et=Y.styles[je];return et?"\x1B["+Y.colors[et][0]+"m"+Ke+"\x1B["+Y.colors[et][1]+"m":Ke}function J(Ke,je){return Ke}function te(Ke){var je={};return Ke.forEach(function(et,mt){je[et]=!0}),je}function ie(Ke,je,et){if(Ke.customInspect&&je&&Qe(je.inspect)&&je.inspect!==W.inspect&&!(je.constructor&&je.constructor.prototype===je)){var mt=je.inspect(et,Ke);return we(mt)||(mt=ie(Ke,mt,et)),mt}var Mt=se(Ke,je);if(Mt)return Mt;var Et=Object.keys(je),Ct=te(Et);if(Ke.showHidden&&(Et=Object.getOwnPropertyNames(je)),ze(je)&&(Et.indexOf("message")>=0||Et.indexOf("description")>=0))return re(je);if(Et.length===0){if(Qe(je)){var Nt=je.name?": "+je.name:"";return Ke.stylize("[Function"+Nt+"]","special")}if(Re(je))return Ke.stylize(RegExp.prototype.toString.call(je),"regexp");if(Ne(je))return Ke.stylize(Date.prototype.toString.call(je),"date");if(ze(je))return re(je)}var zt="",ii=!1,Ci=["{","}"];if(oe(je)&&(ii=!0,Ci=["[","]"]),Qe(je)){var ni=je.name?": "+je.name:"";zt=" [Function"+ni+"]"}if(Re(je)&&(zt=" "+RegExp.prototype.toString.call(je)),Ne(je)&&(zt=" "+Date.prototype.toUTCString.call(je)),ze(je)&&(zt=" "+re(je)),Et.length===0&&(!ii||je.length==0))return Ci[0]+zt+Ci[1];if(et<0)return Re(je)?Ke.stylize(RegExp.prototype.toString.call(je),"regexp"):Ke.stylize("[Object]","special");Ke.seen.push(je);var vi;return ii?vi=ae(Ke,je,et,Ct,Et):vi=Et.map(function(hi){return le(Ke,je,et,Ct,hi,ii)}),Ke.seen.pop(),de(vi,zt,Ci)}function se(Ke,je){if(Te(je))return Ke.stylize("undefined","undefined");if(we(je)){var et="'"+JSON.stringify(je).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Ke.stylize(et,"string")}if(Ce(je))return Ke.stylize(""+je,"number");if(ue(je))return Ke.stylize(""+je,"boolean");if(pe(je))return Ke.stylize("null","null")}function re(Ke){return"["+Error.prototype.toString.call(Ke)+"]"}function ae(Ke,je,et,mt,Mt){for(var Et=[],Ct=0,Nt=je.length;Ct<Nt;++Ct)Tt(je,String(Ct))?Et.push(le(Ke,je,et,mt,String(Ct),!0)):Et.push("");return Mt.forEach(function(zt){zt.match(/^\d+$/)||Et.push(le(Ke,je,et,mt,zt,!0))}),Et}function le(Ke,je,et,mt,Mt,Et){var Ct,Nt,zt;if(zt=Object.getOwnPropertyDescriptor(je,Mt)||{value:je[Mt]},zt.get?zt.set?Nt=Ke.stylize("[Getter/Setter]","special"):Nt=Ke.stylize("[Getter]","special"):zt.set&&(Nt=Ke.stylize("[Setter]","special")),Tt(mt,Mt)||(Ct="["+Mt+"]"),Nt||(Ke.seen.indexOf(zt.value)<0?(pe(et)?Nt=ie(Ke,zt.value,null):Nt=ie(Ke,zt.value,et-1),Nt.indexOf(`
`)>-1&&(Et?Nt=Nt.split(`
`).map(function(ii){return"  "+ii}).join(`
`).substr(2):Nt=`
`+Nt.split(`
`).map(function(ii){return"   "+ii}).join(`
`))):Nt=Ke.stylize("[Circular]","special")),Te(Ct)){if(Et&&Mt.match(/^\d+$/))return Nt;Ct=JSON.stringify(""+Mt),Ct.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Ct=Ct.substr(1,Ct.length-2),Ct=Ke.stylize(Ct,"name")):(Ct=Ct.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Ct=Ke.stylize(Ct,"string"))}return Ct+": "+Nt}function de(Ke,je,et){var mt=Ke.reduce(function(Mt,Et){return Et.indexOf(`
`)>=0,Mt+Et.replace(/\u001b\[\d\d?m/g,"").length+1},0);return mt>60?et[0]+(je===""?"":je+`
 `)+" "+Ke.join(`,
  `)+" "+et[1]:et[0]+je+" "+Ke.join(", ")+" "+et[1]}function oe(Ke){return Array.isArray(Ke)}W.isArray=oe;function ue(Ke){return typeof Ke=="boolean"}W.isBoolean=ue;function pe(Ke){return Ke===null}W.isNull=pe;function fe(Ke){return Ke==null}W.isNullOrUndefined=fe;function Ce(Ke){return typeof Ke=="number"}W.isNumber=Ce;function we(Ke){return typeof Ke=="string"}W.isString=we;function Oe(Ke){return typeof Ke=="symbol"}W.isSymbol=Oe;function Te(Ke){return Ke===void 0}W.isUndefined=Te;function Re(Ke){return Me(Ke)&&Je(Ke)==="[object RegExp]"}W.isRegExp=Re;function Me(Ke){return typeof Ke=="object"&&Ke!==null}W.isObject=Me;function Ne(Ke){return Me(Ke)&&Je(Ke)==="[object Date]"}W.isDate=Ne;function ze(Ke){return Me(Ke)&&(Je(Ke)==="[object Error]"||Ke instanceof Error)}W.isError=ze;function Qe(Ke){return typeof Ke=="function"}W.isFunction=Qe;function Ye(Ke){return Ke===null||typeof Ke=="boolean"||typeof Ke=="number"||typeof Ke=="string"||typeof Ke=="symbol"||typeof Ke>"u"}W.isPrimitive=Ye,W.isBuffer=D("./support/isBuffer");function Je(Ke){return Object.prototype.toString.call(Ke)}function at(Ke){return Ke<10?"0"+Ke.toString(10):Ke.toString(10)}var st=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function lt(){var Ke=new Date,je=[at(Ke.getHours()),at(Ke.getMinutes()),at(Ke.getSeconds())].join(":");return[Ke.getDate(),st[Ke.getMonth()],je].join(" ")}W.log=function(){console.log("%s - %s",lt(),W.format.apply(W,arguments))},W.inherits=D("inherits"),W._extend=function(Ke,je){if(!je||!Me(je))return Ke;for(var et=Object.keys(je),mt=et.length;mt--;)Ke[et[mt]]=je[et[mt]];return Ke};function Tt(Ke,je){return Object.prototype.hasOwnProperty.call(Ke,je)}}).call(this,D("_process"),typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":10,_process:14,inherits:9}],12:[function(D,O,W){},{}],13:[function(D,O,W){(function(U){function K(Y,X){for(var J=0,te=Y.length-1;te>=0;te--){var ie=Y[te];ie==="."?Y.splice(te,1):ie===".."?(Y.splice(te,1),J++):J&&(Y.splice(te,1),J--)}if(X)for(;J--;J)Y.unshift("..");return Y}W.resolve=function(){for(var Y="",X=!1,J=arguments.length-1;J>=-1&&!X;J--){var te=J>=0?arguments[J]:U.cwd();if(typeof te!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!te)continue;Y=te+"/"+Y,X=te.charAt(0)==="/"}return Y=K(G(Y.split("/"),function(ie){return!!ie}),!X).join("/"),(X?"/":"")+Y||"."},W.normalize=function(Y){var X=W.isAbsolute(Y),J=Q(Y,-1)==="/";return Y=K(G(Y.split("/"),function(te){return!!te}),!X).join("/"),!Y&&!X&&(Y="."),Y&&J&&(Y+="/"),(X?"/":"")+Y},W.isAbsolute=function(Y){return Y.charAt(0)==="/"},W.join=function(){var Y=Array.prototype.slice.call(arguments,0);return W.normalize(G(Y,function(X,J){if(typeof X!="string")throw new TypeError("Arguments to path.join must be strings");return X}).join("/"))},W.relative=function(Y,X){Y=W.resolve(Y).substr(1),X=W.resolve(X).substr(1);function J(de){for(var oe=0;oe<de.length&&de[oe]==="";oe++);for(var ue=de.length-1;ue>=0&&de[ue]==="";ue--);return oe>ue?[]:de.slice(oe,ue-oe+1)}for(var te=J(Y.split("/")),ie=J(X.split("/")),se=Math.min(te.length,ie.length),re=se,ae=0;ae<se;ae++)if(te[ae]!==ie[ae]){re=ae;break}for(var le=[],ae=re;ae<te.length;ae++)le.push("..");return le=le.concat(ie.slice(re)),le.join("/")},W.sep="/",W.delimiter=":",W.dirname=function(Y){if(typeof Y!="string"&&(Y=Y+""),Y.length===0)return".";for(var X=Y.charCodeAt(0),J=X===47,te=-1,ie=!0,se=Y.length-1;se>=1;--se)if(X=Y.charCodeAt(se),X===47){if(!ie){te=se;break}}else ie=!1;return te===-1?J?"/":".":J&&te===1?"/":Y.slice(0,te)};function q(Y){typeof Y!="string"&&(Y=Y+"");var X=0,J=-1,te=!0,ie;for(ie=Y.length-1;ie>=0;--ie)if(Y.charCodeAt(ie)===47){if(!te){X=ie+1;break}}else J===-1&&(te=!1,J=ie+1);return J===-1?"":Y.slice(X,J)}W.basename=function(Y,X){var J=q(Y);return X&&J.substr(-1*X.length)===X&&(J=J.substr(0,J.length-X.length)),J},W.extname=function(Y){typeof Y!="string"&&(Y=Y+"");for(var X=-1,J=0,te=-1,ie=!0,se=0,re=Y.length-1;re>=0;--re){var ae=Y.charCodeAt(re);if(ae===47){if(!ie){J=re+1;break}continue}te===-1&&(ie=!1,te=re+1),ae===46?X===-1?X=re:se!==1&&(se=1):X!==-1&&(se=-1)}return X===-1||te===-1||se===0||se===1&&X===te-1&&X===J+1?"":Y.slice(X,te)};function G(Y,X){if(Y.filter)return Y.filter(X);for(var J=[],te=0;te<Y.length;te++)X(Y[te],te,Y)&&J.push(Y[te]);return J}var Q="ab".substr(-1)==="b"?function(Y,X,J){return Y.substr(X,J)}:function(Y,X,J){return X<0&&(X=Y.length+X),Y.substr(X,J)}}).call(this,D("_process"))},{_process:14}],14:[function(D,O,W){var U=O.exports={},K,q;function G(){throw new Error("setTimeout has not been defined")}function Q(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?K=setTimeout:K=G}catch{K=G}try{typeof clearTimeout=="function"?q=clearTimeout:q=Q}catch{q=Q}})();function Y(oe){if(K===setTimeout)return setTimeout(oe,0);if((K===G||!K)&&setTimeout)return K=setTimeout,setTimeout(oe,0);try{return K(oe,0)}catch{try{return K.call(null,oe,0)}catch{return K.call(this,oe,0)}}}function X(oe){if(q===clearTimeout)return clearTimeout(oe);if((q===Q||!q)&&clearTimeout)return q=clearTimeout,clearTimeout(oe);try{return q(oe)}catch{try{return q.call(null,oe)}catch{return q.call(this,oe)}}}var J=[],te=!1,ie,se=-1;function re(){!te||!ie||(te=!1,ie.length?J=ie.concat(J):se=-1,J.length&&ae())}function ae(){if(!te){var oe=Y(re);te=!0;for(var ue=J.length;ue;){for(ie=J,J=[];++se<ue;)ie&&ie[se].run();se=-1,ue=J.length}ie=null,te=!1,X(oe)}}U.nextTick=function(oe){var ue=new Array(arguments.length-1);if(arguments.length>1)for(var pe=1;pe<arguments.length;pe++)ue[pe-1]=arguments[pe];J.push(new le(oe,ue)),J.length===1&&!te&&Y(ae)};function le(oe,ue){this.fun=oe,this.array=ue}le.prototype.run=function(){this.fun.apply(null,this.array)},U.title="browser",U.browser=!0,U.env={},U.argv=[],U.version="",U.versions={};function de(){}U.on=de,U.addListener=de,U.once=de,U.off=de,U.removeListener=de,U.removeAllListeners=de,U.emit=de,U.prependListener=de,U.prependOnceListener=de,U.listeners=function(oe){return[]},U.binding=function(oe){throw new Error("process.binding is not supported")},U.cwd=function(){return"/"},U.chdir=function(oe){throw new Error("process.chdir is not supported")},U.umask=function(){return 0}},{}],15:[function(D,O,W){var U=D("escodegen").generate;O.exports=function(K,q){q||(q={});var G={},Q=function Y(X,J){if(X.type==="Literal")return X.value;if(X.type==="UnaryExpression"){var te=Y(X.argument);return X.operator==="+"?+te:X.operator==="-"?-te:X.operator==="~"?~te:X.operator==="!"?!te:G}else if(X.type==="ArrayExpression"){for(var ie=[],se=0,re=X.elements.length;se<re;se++){var ae=Y(X.elements[se]);if(ae===G)return G;ie.push(ae)}return ie}else if(X.type==="ObjectExpression"){for(var le={},se=0;se<X.properties.length;se++){var de=X.properties[se],oe=de.value===null?de.value:Y(de.value);if(oe===G)return G;le[de.key.value||de.key.name]=oe}return le}else if(X.type==="BinaryExpression"||X.type==="LogicalExpression"){var re=Y(X.left);if(re===G)return G;var ue=Y(X.right);if(ue===G)return G;var pe=X.operator;return pe==="=="?re==ue:pe==="==="?re===ue:pe==="!="?re!=ue:pe==="!=="?re!==ue:pe==="+"?re+ue:pe==="-"?re-ue:pe==="*"?re*ue:pe==="/"?re/ue:pe==="%"?re%ue:pe==="<"?re<ue:pe==="<="?re<=ue:pe===">"?re>ue:pe===">="?re>=ue:pe==="|"?re|ue:pe==="&"?re&ue:pe==="^"?re^ue:pe==="&&"?re&&ue:pe==="||"?re||ue:G}else{if(X.type==="Identifier")return{}.hasOwnProperty.call(q,X.name)?q[X.name]:G;if(X.type==="ThisExpression")return{}.hasOwnProperty.call(q,"this")?q.this:G;if(X.type==="CallExpression"){var fe=Y(X.callee);if(fe===G||typeof fe!="function")return G;var Ce=X.callee.object?Y(X.callee.object):G;Ce===G&&(Ce=null);for(var we=[],se=0,re=X.arguments.length;se<re;se++){var ae=Y(X.arguments[se]);if(ae===G)return G;we.push(ae)}return fe.apply(Ce,we)}else if(X.type==="MemberExpression"){var le=Y(X.object);if(le===G||typeof le=="function")return G;if(X.property.type==="Identifier")return le[X.property.name];var de=Y(X.property);return de===G?G:le[de]}else if(X.type==="ConditionalExpression"){var te=Y(X.test);return te===G?G:Y(te?X.consequent:X.alternate)}else if(X.type==="ExpressionStatement"){var te=Y(X.expression);return te===G?G:te}else{if(X.type==="ReturnStatement")return Y(X.argument);if(X.type==="FunctionExpression"){var Oe=X.body.body,Te={};Object.keys(q).forEach(function(st){Te[st]=q[st]});for(var se=0;se<X.params.length;se++){var Re=X.params[se];if(Re.type=="Identifier")q[Re.name]=null;else return G}for(var se in Oe)if(Y(Oe[se])===G)return G;q=Te;var Me=Object.keys(q),Ne=Me.map(function(st){return q[st]});return Function(Me.join(", "),"return "+U(X)).apply(null,Ne)}else if(X.type==="TemplateLiteral"){for(var ze="",se=0;se<X.expressions.length;se++)ze+=Y(X.quasis[se]),ze+=Y(X.expressions[se]);return ze+=Y(X.quasis[se]),ze}else if(X.type==="TaggedTemplateExpression"){var Qe=Y(X.tag),Ye=X.quasi,Je=Ye.quasis.map(Y),at=Ye.expressions.map(Y);return Qe.apply(null,[Je].concat(at))}else return X.type==="TemplateElement"?X.value.cooked:G}}}(K);return Q===G?void 0:Q}},{escodegen:12}],jsonpath:[function(D,O,W){O.exports=D("./lib/index")},{"./lib/index":5}]},{},["jsonpath"])("jsonpath")})}(jsonpath$1)),jsonpath$1.exports}var jsonpathExports=requireJsonpath();const jsonpath=getDefaultExportFromCjs(jsonpathExports);function faSprite_(F,w,D){return x`<svg class="${D}"><use href="/public/assets/svgs/fa-sprites/${w}.svg#${F}"></use></svg>`}const METHODS=["GET","POST","PATCH","PUT","DELETE","HEAD","OPTIONS","CONNECT","TRACE"];function getStepMethod(F){return Object.keys(F).filter(D=>METHODS.includes(D))[0]||"GET"}function getTextOperation(F){switch(F){case"==":return"equals";case"!=":return"notEquals";case">":return"greaterThan";case"<":return"lessThan";case">=":return"greaterThanOrEqual";case"<=":return"lessThanOrEqual"}}function getOperationFromText$1(F){switch(F){case"equals":return"==";case"notEquals":return"!=";case"greaterThan":return">";case"lessThan":return"<";case"greaterThanOrEqual":return">=";case"lessThanOrEqual":return"<=";default:return"=="}}function convertTestkitToCollectionSteps(F){const w=[];return Array.isArray(F)&&F.forEach(D=>{const O=[];D.asserts&&Array.isArray(D.asserts)&&D.asserts.forEach(q=>{const G=convertTestkitAssertions(q);G&&O.push(G)});const W=Object.entries(D.exports||{}).map(([q,G])=>{let Q="body",Y="$.resp.json";return G&&(G.startsWith("$.resp.headers")&&(Q="header",Y="$.resp.headers."),G.startsWith("$.resp.status")&&(Q="status",Y="$.resp.status"),G.startsWith("$.resp.responseTime")&&(Q="responseTime",Y="$.resp.responseTime")),{key:q,value:G.replace(Y,""),category:Q}}),U=getStepMethod(D),K={title:D.title||"",_method:U,_url:D[U],headers:D.headers||{},params:D.params||{},_assertions:O,exports:W,_json:D.json,_requestBody:D.requestBody,disabled:D.disabled||!1,followRedirects:D.followRedirects||!0,allowRedirects:D.allowRedirects||!0,ignoreSSLErrors:D.ignoreSSLErrors||!1,timeout:D.timeout||60,httpVersion:D.httpVersion||"http1"};w.push(K)}),w}function convertCollectionStepsToTestkitFormat(F){const w=[];return Array.isArray(F)&&F.forEach(D=>{const O=[];D._assertions?.forEach(K=>{O.push(convertToTestkitAssertion(K))});const W=(D.exports||[]).reduce((K,q)=>{let G="$.resp.json";q.category==="header"&&(G="$.resp.headers."),q.category==="status"&&(G="$.resp.status"),q.category==="responseTime"&&(G="$.resp.responseTime");const Q=q.value||"";return{...K,[q.key]:G+Q}},{}),U={title:D.title||"",[D._method||"GET"]:D._url||"",headers:D.headers||{},exports:W,asserts:O||[],params:D.params||{},disabled:D.disabled||!1,timeout:30,followRedirect:!1,ignoreSSLErrors:!1,requestBody:{}};if(D._requestType||(D._requestType="application/json"),D._requestType==="application/json")U.json=D._json;else if(D._requestType==="application/x-www-form-urlencoded"){let K={};const q=Object.keys(D._requestBody?D._requestBody:{});q.length>0&&(q.forEach(G=>{K[G]=D._requestBody[G]}),U.requestBody=K)}D.followRedirects&&(U.followRedirects=!0),D.ignoreSSLErrors&&(U.ignoreSSLErrors=!0),D.timeout&&D.timeout!==60&&(U.timeout=D.timeout),D.httpVersion&&D.httpVersion!=="http2-http1"&&(U.httpVersion=D.httpVersion),w.push(U)}),w}function convertTestkitAssertions(F){const w=Object.keys(F);if(w.length===0)return;const D=w[0],O=F[D];if(D==="ok"){const[W,U,K]=O.split(" "),q=getTextOperation(U);return W.startsWith("$.resp.json")?{type:"body",operation:"jsonpath",jsonpath:W.replace(".resp.json",""),subOperation:q,value:K}:W.startsWith("$.resp.headers")?{type:"header",operation:q,headerName:W.replace("$.resp.headers.",""),value:K}:{type:"statusCode",operation:q,value:K}}else{const W=D,U=O;return U.startsWith("$.resp.json")?{type:"body",operation:"jsonpath",jsonpath:U.replace(".resp.json",""),subOperation:W,value:""}:U.startsWith("$.resp.headers")?{type:"header",operation:W,headerName:U.replace("$.resp.headers.",""),value:""}:{type:"statusCode",operation:W,value:""}}}function convertToTestkitAssertion(F){let w="",D="ok";if(F.type==="header"?w=`$.resp.headers.${F.headerName}`:F.type==="body"&&F.jsonpath?w=`$.resp.json.${F.jsonpath.substring(2)}`:F.type==="statusCode"?w="$.resp.status":F.type==="responseTime"&&(w="$.resp.duration_ms"),["equals","notEquals","greaterThan","lessThan","greaterThanOrEqual","lessThanOrEqual"].includes(F.operation==="jsonpath"?F.subOperation:F.operation)){const O=getOperationFromText$1(F.operation==="jsonpath"?F.subOperation:F.operation);return{[D]:`${w} ${O} ${F.value}`}}else{const O=F.operation;return{[O==="jsonpath"?F.subOperation:O]:`${w}`}}}function replaceVariables(F){const w=/{{(.*?)}}/g,D=F.match(w),O=window.testVariables||[];if(D)for(const W of D){const U=W.replace("{{","").replace("}}","");if(O&&Array.isArray(O)){const K=O.find(q=>q.variableName===U);K&&(F=F.replace(W,K.variableValue))}}return F}const baseOperations=[{value:"equals",label:"equals"},{value:"notEquals",label:"does not equal"},{value:"greaterThan",label:"is greater than"},{value:"lessThan",label:"is less than"},{value:"greaterThanOrEqual",label:"is greater than"},{value:"lessThanOrEqual",label:"is less than"},{value:"contains",label:"contains"},{value:"notContains",label:"does not contain"},{value:"null",label:"is null"},{value:"exists",label:"exists"},{value:"empty",label:"is empty"},{value:"notEmpty",label:"is not empty"},{value:"boolean",label:"is boolean"},{value:"number",label:"is number"},{value:"string",label:"is string"},{value:"array",label:"is array"},{value:"date",label:"is date"}],bodyAdditionalOperations=[{value:"jsonpath",label:"jsonpath"}],renderInput=(F,w,D,O,W="")=>x`
  <input type=${F} placeholder=${O} class="input input-sm grow shadow-none ${W}" .value=${w} @input=${D} />
`,renderTextarea=(F,w,D)=>x`
  <textarea placeholder=${D} class="textarea textarea-sm h-24 grow shadow-none" .value=${F} @input=${w}></textarea>
`,renderDropdown=(F,w,D,O="")=>x`
  <select class="select select-sm max-w-xs shadow-none ${O}" .value=${w} @change=${D}>
    ${F.map(W=>x`<option value=${W.value} ?selected=${W.value===w}>${W.label}</option>`)}
  </select>
`;function renderInputs(F,w,D){const O=U=>K=>D(w,{[U]:K.target.value}),W=[];if(F.type==="responseTime"&&W.push(renderDropdown([{value:"includeDNS",label:"Including DNS"},{value:"excludeDNS",label:"Excluding DNS"}],F.includeDNS?"includeDNS":"excludeDNS",U=>D(w,{includeDNS:U.target.value==="includeDNS"}),"select w-48")),F.operation==="jsonpath")W.push(renderInput("text",F.jsonpath||"",O("jsonpath"),"JSON path"),renderDropdown(baseOperations,F.subOperation||"",O("subOperation"))),F.subOperation!=="isUndefined"&&W.push(renderInput("text",F.value||"",O("value"),"Value"));else if(F.operation==="jsonschema")W.push(renderTextarea(F.value||"",O("value"),"JSON Schema"));else if(F.operation!=="isUndefined"){const U={header:{type:"text",placeholder:"Header Value",className:"w-5"},statusCode:{type:"number",placeholder:"Status Code",className:"w-5"},responseTime:{type:"number",placeholder:"Time (ms)",className:"w-32"},default:{type:"text",placeholder:"Value",className:"w-64"}},K=U[F.type]||U.default;W.push(F.type=="body"?renderTextarea(F.value||"",O("value"),"Body content"):renderInput(K.type,F.value||"",O("value"),K.placeholder,K.className))}return x`<div class="${F.type==="body"?"basis-full":""} grow inline-flex gap-2">${W}</div>`}function renderAssertionContent(F,w,D){const W=F.type==="body"?[...baseOperations,...bodyAdditionalOperations]:baseOperations,U=[];return F.type==="header"&&U.push(renderInput("text",F.headerName||"",K=>D(w,{headerName:K.target.value}),"Header name")),U.push(renderDropdown(W,F.operation||"",K=>D(w,{operation:K.target.value}))),U.push(renderInputs(F,w,D)),x`${U}`}function evaluateAssertion(assertion,result,response){try{if(response){const getOp=F=>getOperationFromText(F||"equals");if(assertion.type==="statusCode")return eval(`${response.status} ${getOp(assertion.operation)} ${assertion.value}`);if(assertion.type==="header")return eval(`"${response.headers[assertion.headerName??""]}" ${getOp(assertion.operation)} "${assertion.value}"`);if(assertion.type==="body"){if(assertion.operation==="jsonpath"){const op=getOp(assertion.subOperation),val=jsonpath.query(response.json,assertion.jsonpath||"$");return val.some(v=>eval(`${v} ${op} ${assertion.value}`))}return eval(`${response.raw} ${getOp(assertion.operation)} ${assertion.value}`)}if(assertion.type==="responseTime")return eval(`${response.duration_ms} ${getOp(assertion.operation)} ${assertion.value}`)}return result?.ok===!0?!0:assertion.status==="PASSED"}catch{return!1}}function renderAssertionBuilder({assertions:F,result:w,updateAssertion:D,addAssertion:O,removeAssertion:W}){return x`
    <div>
      ${F.map((U,K)=>{const q=w?.assert_results?.[K],G=evaluateAssertion(U,q,w?.resp),Q=G?"":q?.err?.advice??"";return x`
          <div class="pt-2">
            <div class="flex gap-2 items-center">
              <span class="block w-12 shrink-0 pt-2">${K===0?"When":"And"}</span>
              <div class="flex flex-wrap items-center gap-2 grow">
                ${renderDropdown([{value:"body",label:"body"},{value:"header",label:"header"},{value:"statusCode",label:"status code"},{value:"responseTime",label:"response time"}],U.type,Y=>D(K,{type:Y.target.value,operation:"",jsonpath:void 0,subOperation:void 0,value:void 0}))}
                ${renderAssertionContent(U,K,D)}
              </div>
              <div class="shrink-0">
                <div class="flex gap-3 pt-2 items-center">
                  ${G?x`<span class="badge badge-success">Passed</span>`:x`<span class="badge badge-error">Failed</span>`}
                  <a class="cursor-pointer text-slate-600" @click=${()=>W(K)}>
                    ${faSprite_("trash","regular","rounded-full border bg-white shadow-sm p-1 w-5 h-5 stroke-red-500")}
                  </a>
                </div>
              </div>
            </div>
            <p class="text-sm text-red-500 text-center">${Q}</p>
          </div>
        `})}
      <button class="flex items-center gap-1 mt-4 text-sm" @click=${O}>
        ${faSprite_("plus","regular","w-4 h-4 text-textWeak")}
        <span class="underline text-textWeak font-semibold">New assertion</span>
      </button>
    </div>
  `}function getOperationFromText(F){switch(F){case"equals":return"==";case"notEquals":return"!=";case"greaterThan":return">";case"lessThan":return"<";case"greaterThanOrEqual":return">=";case"lessThanOrEqual":return"<=";case"contains":return".includes";default:return"=="}}async function makeRequestAndProcessResponse(F){try{const w=new URL(replaceVariables(F._url||"")),D=F._method,O=F.headers||{},W=F._requestBody??F._json??null,U={method:D,headers:{...O,contentType:F._requestType??""},redirect:F.followRedirects?"follow":"manual"};D!=="GET"&&(U.body=W);const K={"user-agent":navigator.userAgent||"CustomAgent/1.0",accept:"*/*",connection:"keep-alive",host:w.host},q=performance.now(),G=await fetch(w,U),Y=performance.now()-q,X=G.status,J={};G.headers.forEach((se,re)=>{J[re]=se});const te=await G.text();let ie={};try{ie=JSON.parse(te)}catch{}return{resp:{status:X,duration_ms:Y.toFixed(2),headers:J,json:ie,raw:te},req:{http_method:D,headers:O,json:W?JSON.parse(W):null,raw:W}}}catch(w){return Promise.reject(w)}}function generateRequestPreviewFromObject(F){let w="";try{w=new URL(replaceVariables(F._url||""))}catch{w=F._url||""}const D=F._requestType==="raw"?"POST":"GET",O=F.headers||{},W=F.httpVersion||"HTTP/1.1";let U=`<p>${D.toUpperCase()} ${typeof w=="string"?w:w.href} ${W}<p/>`,K="";W==="HTTP/2.0"&&typeof w!="string"&&(K+=`<p>:authority: ${w.host}<p/>`,K+=`<p>:method: ${D.toUpperCase()}<p/>`,K+=`<p>:path: ${w.pathname}<p/>`);const G={...{"user-agent":navigator.userAgent||"CustomAgent/1.0",accept:"*/*",connection:"keep-alive",host:typeof w=="string"?"":w.host},...O};for(const[Q,Y]of Object.entries(G))K+=`<p>${Q.toLowerCase()}: ${Y}<p/>`;return U+K}function renderJsonWithIndentation(F,w,D="",O=0){const W=`${O*20}px`;return x`
    ${Object.entries(F).map(([U,K])=>{const q=Array.isArray(F)?`${D}.[${U}]`:`${D}.${U}`,G={type:"body",operation:"jsonpath",jsonpath:q,subOperation:"equals",value:typeof K!="object"?K:"",status:"PASSED"};return x`
        <div style="padding-left: ${W};">
          <div class="flex items-center gap-4">
            <span> ${U}: ${typeof K=="object"&&K?"":JSON.stringify(K)} </span>
            <button
              class="rounded-full border fill-textDisabled shadow-[0px_4px_4px_0px_rgba(0,0,0,0.06)] border-strokeWeak shadown-sm p-1.5 bg-bgBase"
              @click="${Q=>w(Q,G)}"
            >
              ${faSprite_("plus","regular","w-3 h-3")}
            </button>
          </div>
          ${typeof K=="object"&&K?renderJsonWithIndentation(K,w,q,O+1):""}
        </div>
      `})}
  `}var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__decorateClass=(F,w,D,O)=>{for(var W=O>1?void 0:O?__getOwnPropDesc(w,D):w,U=F.length-1,K;U>=0;U--)(K=F[U])&&(W=(O?K(w,D,W):K(W))||W);return O&&W&&__defProp(w,D,W),W};const validMethods=["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","TRACE","CONNECT"];let StepsEditor=class extends i$3{constructor(){super(),this.collectionSteps=[],this.collectionResults=[],this.saveErrors=[],this.isSendingRequest=[],this.sendRequestErrors=[],this.isOnboarding=!1,this.editor=null,this.response={},this.createRenderRoot=()=>this,this.collectionSteps=convertTestkitToCollectionSteps(window.collectionSteps)||[],this.collectionResults=window.collectionResults||[],this.isSendingRequest=this.collectionSteps.map(()=>!1),this.sendRequestErrors=this.collectionSteps.map(()=>null),this.collectionSteps.length===0?this.collectionSteps=[{_expanded:!0,_method:"GET",assertions:[{equal:["$.resp.status",200]}],_assertions:[{type:"statusCode",operation:"equals",value:200,status:"PASSED"}]}]:this.collectionSteps.length==1&&(this.collectionSteps[0]._expanded=!0),window.updateStepAssertions=(F,w,D)=>{const O=this.collectionSteps[D],W=O.asserts||[];W.push({[F]:w}),O.asserts=W,this.collectionSteps[D]=O,window.collectionSteps=this.collectionSteps,this.requestUpdate()},window.updateCollectionResults=F=>{F&&Array.isArray(F)&&(this.collectionResults=F),this.requestUpdate()},window.updateStepsWithErrors=F=>{F&&Array.isArray(F)&&(this.saveErrors=F),this.requestUpdate()},window.updateEditorVal=()=>{},window.addCollectionStep=()=>{this.addStep()}}addStep(){this.collectionSteps=[...this.collectionSteps,{_expanded:!1,_method:"GET",_url:"",assertions:[{equal:["$.resp.status",200]}],_assertions:[{type:"statusCode",operation:"equals",value:200,status:"PASSED"}]}]}initializeEditor(F){this.querySelector("#reqBodyContainer"),F.editor.defineTheme("nightOwl",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"#6A9955"},{token:"keyword",foreground:"#C586C0"},{token:"number",foreground:"#B5CEA8"},{token:"string",foreground:"#CE9178"},{token:"operator",foreground:"#D4D4D4"},{token:"identifier",foreground:"#D4D4D4"},{token:"type",foreground:"#4EC9B0"},{token:"delimiter",foreground:"#D4D4D4"},{token:"punctuation",foreground:"#D4D4D4"},{token:"namespace",foreground:"#9CDCFE"},{token:"function",foreground:"#DCDCAA"},{token:"class",foreground:"#4EC9B0"},{token:"variable",foreground:"#D4D4D4"}],colors:{"editor.foreground":"#D4D4D4","editor.background":"#011627","editor.selectionBackground":"#2D3643","editor.lineHighlightBackground":"#202B33","editorCursor.foreground":"#D4D4D4","editorWhitespace.foreground":"#404040"}}),this.editor=F.editor.create(this.editorContainer,{value:jsYaml.dump(convertCollectionStepsToTestkitFormat(this.collectionSteps),{indent:2}),language:"yaml",theme:"nightOwl",fontSize:14,lineHeight:20,lineNumbersMinChars:3,automaticLayout:!0,minimap:{enabled:!1},fontFamily:"JetBrains Mono, monospace",fontLigatures:!0,fontWeight:"400"});const w=this.editor.getModel();w.onDidChangeContent(()=>{try{const D=jsYaml.load(w.getValue()),O=document.querySelector("#test-code-toggle");this.collectionSteps!=convertTestkitToCollectionSteps(D)&&O&&O.checked&&(this.collectionSteps=convertTestkitToCollectionSteps(D))}catch(D){console.error("Invalid YAML input",D)}})}updateEditorContent(){const F=convertCollectionStepsToTestkitFormat(this.collectionSteps),w=jsYaml.dump(F,{indent:2});this.editor&&this.editor.getModel().setValue(w)}_onDragOver(F){F.preventDefault();const w=document.querySelectorAll(".draggable");let D=null,O=Number.MAX_SAFE_INTEGER;w.forEach(W=>{const U=W.getBoundingClientRect(),K=U.top+U.height/2,q=Math.abs(F.clientY-K);q<O&&(D=W,O=q)}),w.forEach(W=>{W===D?W.classList.add("active-drop-target"):W.classList.remove("active-drop-target")})}_onDragEnter(F){F.target.hasAttribute("data-index")&&(F.preventDefault(),F.target.classList.add("over"))}_onDragLeave(F){F.target.hasAttribute("data-index")&&(F.target.classList.remove("over"),F.target.classList.remove("active-drop-target"))}_onDrop(F){const w=document.querySelector(".active-drop-target");if(w){F.preventDefault(),w.classList.remove("over"),w.classList.remove("active-drop-target");const D=parseInt(F.dataTransfer.getData("text/plain")),O=parseInt(w.dataset.index||"0");if(O!==D){const W=[...this.collectionSteps],U=W.splice(D,1)[0];W.splice(O,0,U),this.collectionSteps=[...W],this.requestUpdate()}}}toggleExpanded(F){this.collectionSteps[F]._expanded=!this.collectionSteps[F]._expanded,this.requestUpdate()}async sendStepRequest(F,w){F.preventDefault(),this.isSendingRequest[w]=!0,this.requestUpdate(),this.sendRequestErrors[w]=null;try{const D=await makeRequestAndProcessResponse(this.collectionSteps[w]),O=this.collectionResults[w];O?this.collectionResults[w]={...O,...D}:this.collectionResults[w]={...D}}catch(D){let O=D.message;O==="Failed to fetch"&&(navigator.onLine?O+=": This could be due to a CORS restriction, DNS failure, server being unreachable.":O+=": Please check your network connection"),this.sendRequestErrors[w]=`Send request error: 
`+O}finally{this.isSendingRequest[w]=!1,this.requestUpdate()}}renderCollectionStep(F,w,D,O){const W=this.collectionResults[w],U=!!D,K=D?.assert_results?.some(ie=>ie.ok===void 0||ie.ok===!1)||!1,q=O!==void 0,G=!F.disabled&&(K||q),Q=!F.disabled&&U&&!K&&!q;O=O||{};const Y={"request-options":(F.headers?Object.keys(F.headers):[]).length,"query-params":(F.params?Object.keys(F.params):[]).length,"request-body":F.json||F.raw||F._requestBody?1:0,ignoreSSLErrors:F.ignoreSSLErrors?1:0,followRedirects:F.followRedirects?1:0,timeout:F.timeout!==60?1:0},X=this.collectionSteps[w].activeTab||"request-options",J=ie=>{this.collectionSteps[w].activeTab=ie,this.requestUpdate()},te=Object.values(Y).reduce((ie,se)=>ie+se,0);return x`
      <div
        class="rounded-2xl overflow-hidden group/item  bg-fillWeak collectionStep border draggable  ${G?"border-red-500":Q?"border-green-500":"border-strokeWeak"}"
        data-index="${w}"
      >
        <div class="flex flex-row items-center">
          <div class="h-full shrink p-3 cursor-move"
            draggable="true"
            @dragstart="${ie=>ie.dataTransfer.setData("text/plain",ie.target.dataset.index)}"
          >${faSprite_("grip-dots-vertical","solid","h-4 w-4")}</div>
          <div class="flex-1 flex flex-row items-center gap-1 pr-5 py-3" @click="${()=>this.toggleExpanded(w)}">
            <label
             for="stepState-${w}" class="flex items-center whitespace-nowrap gap-1 py-1 w-max text-xs bg-fillStrong badge text-textInverse-strong">Step ${w+1}</label>
            <div class="w-full space-y-1 shrink" @click="${ie=>ie.stopPropagation()}">
              <input
              class="text-lg w-full pl-2 bg-transparent outline-hidden focus:outline-hidden" placeholder="Give your step a name*"
               .value="${F.title||""}" id="title-${w}" @change=${ie=>this.updateValue(ie,w,null,null,"title")} />
            </div>
            <div class="items-center w-max shrink-0 gap-3 text-xs text-slate-600 flex">
                <input
                  @click="${ie=>ie.stopPropagation()}"
                  @change="${ie=>{this.collectionSteps[w].disabled=!ie.target.checked,this.requestUpdate()}}"
                  ?checked="${F.disabled===void 0?!0:!F.disabled}"
                  type="checkbox"
                  class="toggle toggle-sm  ${F.disabled?"border-red-500  text-[#ef4444]":"border-green-500 text-[#22c55e]"}"
                   />
                <button class="text-red-700 cursor-pointer" @click="${ie=>{ie.preventDefault(),ie.stopPropagation(),this.collectionSteps=this.collectionSteps.filter((se,re)=>re!=w),this.collectionResults=this.collectionResults.filter((se,re)=>re!=w)}}">
                  ${faSprite_("trash","regular","w-4 h-4 stroke-red-700")}
                </button>
                <button type="button" class="text-slate-400 transition-all ${F._expanded?"rotate-90":""}">
                  ${faSprite_("f-chevron-right","solid","w-4 h-4")}
                </button>
              </div>
          </div>
        </div>
        <div class="p-4 pt-0 bg-fillWeaker ${F._expanded?"block":"hidden"} ">
        <div class="rounded-xl p-4 bg-slate-50">
          <div>
            <div class="p-0 m-0s">
              <div class="">
                <div class="text-sm text-slate-700"><div>URL<span class="text-error">*</span></div></div>
                <div class="relative flex flex-row gap-2 items-center">
                  <label for="actions-list-input-${w}" class="w-28 shrink text-sm font-medium form-control">
                    <select id="actions-list-input-${w}" class="select select-sm shadow-none w-full" @change=${ie=>this.updateValue(ie,w,null,null,"_method")}>
                      ${validMethods.map(ie=>x`<option ?selected=${ie==F._method}>${ie}</option>`)}
                    </select>
                    ${O.method?x`<span class="text-red-700 text-xs">${O.method}</span>`:""}
                  </label>
                  <label for="actions-data-${w}" class="flex-1 text-sm font-medium form-control w-full flex flex-row items-center gap-1">
                    <input
                      placeholder="https://example.com/api/users"
                      type="text" id="actions-data-${w}" .value=${F._url||""} class="input input-sm shadow-none w-full" @change=${ie=>this.updateValue(ie,w,null,null,"_url")}
                    />
                    ${O.url?x`<span class="text-red-700 text-xs">${O.url}</span>`:""}
                  </label>
                </div>
              </div>
              <details class="mt-4">
                <summary class="cursor-pointer text-sm text-slate-700 font-medium">Advanced Options (${te} configured)</summary
                 <div>
                  <div class="mt-4 pb-3 border rounded-xl">
                    <div role="tablist" class="tabs tabs-bordered pt-1">
                      <a role="tab" class="tab  ${X==="request-options"?"tab-active [--bc:var(--brand-color)] text-brand font-bold":""}" @click=${()=>J("request-options")}>
                        Request Options ${Y["request-options"]>0?x`<span class="badge badge-sm badge-ghost">${Y["request-options"]}</span>`:""}
                      </a>
                      <a role="tab" class="tab ${X==="query-params"?"tab-active [--bc:var(--brand-color)] text-brand font-bold":""}" @click=${()=>J("query-params")}>
                        Query Params ${Y["query-params"]>0?x`<span class="badge badge-sm badge-ghost">${Y["query-params"]}</span>`:""}
                      </a>
                      <a role="tab" class="tab ${X==="request-body"?"tab-active [--bc:var(--brand-color)] text-brand font-bold":""}" @click=${()=>J("request-body")}>
                        Request Body ${Y["request-body"]>0?x`<span class="badge badge-sm badge-ghost">${Y["request-body"]}</span>`:""}
                      </a>
                    </div>
                    <div class="p-4 space-y-3">
                      ${X==="request-options"?x`
                              <div class="form-control w-full">
                                <div class="label"><span class="label-text">HTTP Version</span></div>
                                <select
                                  class="select select-sm max-w-xs shadow-none"
                                  .value=${this.collectionSteps[w].httpVersion}
                                  @change=${ie=>{this.collectionSteps[w].httpVersion=ie.target.value}}
                                >
                                  <option value="http2-http1">HTTP/2 fallback to HTTP/1.1</option>
                                  <option value="http2">HTTP/2 Only</option>
                                  <option value="http1">HTTP/1.1</option>
                                </select>
                              </div>
                              <div class="flex gap-4 items-center">
                                <div class="form-control">
                                  <label class="label cursor-pointer justify-start gap-3">
                                    <input
                                      type="checkbox"
                                      class="checkbox checkbox-sm"
                                      ?checked=${F.followRedirects}
                                      @change=${ie=>this.collectionSteps[w].followRedirects=ie.target.value=="on"}
                                    />
                                    <span class="text-slate-700 font-medium">Follow redirects</span>
                                  </label>
                                </div>
                                <div class="form-control">
                                  <label class="label cursor-pointer justify-start gap-3">
                                    <input
                                      type="checkbox"
                                      class="checkbox checkbox-sm"
                                      ?checked=${F.ignoreSSLErrors}
                                      @change=${ie=>this.collectionSteps[w].ignoreSSLErrors=ie.target.value=="on"}
                                    />
                                    <span class="text-slate-700 font-medium">Ignore server certificate error</span>
                                  </label>
                                </div>
                              </div>

                              <div class="flex items-center gap-2 text-slate-700 font-medium">
                                <span class="">Time out after</span>
                                <input
                                  type="number"
                                  value=${F.timeout||60}
                                  class="input input-sm w-20 shadow-none"
                                  @change=${ie=>this.collectionSteps[w].timeout=parseInt(ie.target.value)}
                                />
                                <span>seconds</span>
                              </div>
                              <div class="form-control w-full">
                                <div class="label"><span class="label-text">Request Headers</span></div>
                                <div class="space-y-2 paramRows" id="[${w}][headers]">
                                  ${this.renderParamsRows(F,w,"headers")}
                                </div>
                              </div>
                              <div class="form-control w-full">
                                <div class="label"><span class="label-text">Cookies</span></div>
                                <textarea
                                  class="textarea"
                                  placeholder="cookie-name-1=value; cookie-name-2=value"
                                  @change=${ie=>(this.collectionSteps[w].headers??={}).Cookie=ie.target.value}
                                >
${F?.headers?.Cookie||""}</textarea
                                >
                              </div>
                            `:E}
                      ${X==="query-params"?x`
                              <div class="form-control">
                                <div class="label flex-col items-start gap-2">
                                  <p class="label-text">Parameters to encode</p>
                                  <p class="label-text text-xs">
                                    Add all parameters that require encoding to the below fields. Query parameters that do not require
                                    encoding can be added to the URL field directly.
                                  </p>
                                </div>
                                <div class="space-y-2 paramRows" id="[${w}][params]">
                                  ${this.renderParamsRows(F,w,"params")}
                                </div>
                              </div>
                            `:E}
                      ${X==="request-body"?x`
                              <div class="form-control">
                                <div class="label items-start gap-2"><span class="label-text">Body Type</span></div>
                                <select
                                  class="select select-sm max-w-xs"
                                  .value=${F._requestType||"application/json"}
                                  @change=${ie=>{this.collectionSteps[w]._requestType=ie.target.value,this.requestUpdate()}}
                                >
                                  <option>application/json</option>
                                  <option>application/x-www-form-urlencoded</option>
                                  <option>text/html</option>
                                  <option>raw</option>
                                </select>
                              </div>

                              <div class="form-control">
                                <div class="label flex-col items-start gap-2">
                                  <span class="label-text">Request Body</span>
                                  <p class="label-text text-xs">Insert variables using the syntax {{variableName}}</p>
                                </div>
                                ${this.collectionSteps[w]._requestType==="application/x-www-form-urlencoded"?x`<div class="flex flex-col gap-1">${this.renderParamsRows(F,w,"_requestBody")}</div>`:x` <textarea
                                      class="w-full border border-slate-200 textarea"
                                      name="[${w}][json]"
                                      @change=${ie=>{this.collectionSteps[w]._json=ie.target.value}}
                                    >
${F._json}</textarea
                                    >`}
                              </div>
                            `:E}
                    </div>
                  </div>
                </details>
              </div>
              <button class="mt-5 btn btn-sm btn-primary px-2 py-1" @click=${ie=>this.sendStepRequest(ie,w)}>
              ${this.isSendingRequest[w]?x`<span class="loading loading-dots loading-sm"></span>`:"Send request"}
              </button>
              ${this.sendRequestErrors[w]!==null?x`<div class="mt-2 text-textError">${this.sendRequestErrors[w]}</div>`:E}
              ${W&&W.resp?x`
                      <h3 class=" text-textStrong text-lg font-medium py-2 mt-10">
                        Request Preview
                        <span class="font-normal  text-textWeak"
                          >(took <strong>${W.resp.duration_ms}ms</strong> with status
                          <strong>${W.resp.status}</strong>)</span
                        >
                      </h3>
                      <div class="rounded-xl border border-weak p-4  text-textStrong flex flex-col gap-1">
                        ${o(generateRequestPreviewFromObject(this.collectionSteps[w]))}
                      </div>
                      <div role="tablist" class="tabs tabs-bordered max-h-96 overflow-y-auto border border-slate-200 rounded-xl mt-6">
                        <input
                          type="radio"
                          name="resp-items"
                          role="tab"
                          class="tab checked:[--bc:var(--brand-color)] checked:text-[var(--brand-color)] checked:font-bold"
                          aria-label="Response Headers"
                          checked
                        />
                        <div role="tabpanel" class="tab-content p-4">
                          <div class="flex rounded-sm  bg-fillWeak px-2 py-1 mb-2 items-center gap-2">
                            ${faSprite_("circle-info","regular","w-4 h-4 fill-none stroke-slate-600")}
                            <span class=" text-textWeak">Click below to add field as an assertion</span>
                          </div>
                          ${Object.entries(W.resp.headers).map(([ie,se])=>{let re={type:"header",operation:"equals",headerName:ie,value:se,status:"PASSED"};return x`
                              <div class="flex items-center gap-2">
                                <span class=" text-textStrong">${ie}:</span>
                                <span class=" text-textWeak">${se}</span>
                                <button
                                  data-tippy-content="Add as an assertion"
                                  class="rounded-full border fill-textDisabled shadow-[0px_4px_4px_0px_rgba(0,0,0,0.06)] border-strokeWeak shadown-sm p-1.5 bg-bgBase"
                                  @click="${ae=>this.addAssertion(ae,w,re)}"
                                >
                                  ${faSprite_("plus","regular","w-3 h-3")}
                                </button>
                              </div>
                            `})}
                        </div>

                        <input
                          type="radio"
                          name="resp-items"
                          role="tab"
                          class="tab checked:[--bc:var(--brand-color)] checked:text-[var(--brand-color)] checked:font-bold"
                          aria-label="Response Body"
                        />
                        <div role="tabpanel" class="tab-content p-4">
                          <div>{</div>
                          <div class="pl-3">
                            ${renderJsonWithIndentation(W.resp.json,(ie,se)=>this.addAssertion(ie,w,se),"$")}
                          </div>
                          <div>}</div>
                        </div>

                        <input
                          type="radio"
                          name="resp-items"
                          role="tab"
                          class="tab checked:[--bc:var(--brand-color)] checked:text-[var(--brand-color)] checked:font-bold"
                          aria-label="Response Status Code"
                        />
                        <div role="tabpanel" class="tab-content p-4">${W.resp.status}</div>
                      </div>
                    `:E}
            </div>

            <details class="mt-10" ?open=${W&&W.resp}>
              <summary class="label-text text-lg mb-2 cursor-pointer">
                <div class="inline-flex text-lg gap-2 items-center cursor-pointer  text-textStrong font-medium">
                  Add Assertions <span class="font-normal  text-textWeak">(optional)</span>
                  <a href="https://apitoolkit.io/docs/dashboard/dashboard-pages/api-tests/#test-definition-syntax" class="" target="_blank">
                    ${faSprite_("circle-info","regular","w-3 h-3 text-slate-700")}
                  </a>
                </div>
              </summary>
              <div class=" text-textStrong space-y-2 px-2 paramRows [&_.assertIndicator]:inline-block" id="[${w}][asserts]">
                <p class="">Your step is successful;</p>
          ${renderAssertionBuilder({assertions:this.collectionSteps[w]._assertions||[],result:this.collectionResults[w],updateAssertion:(ie,se)=>this.updateAssertion(w,ie,se),addAssertion:ie=>this.addAssertion(ie,w,{type:"body",operation:"equals",value:""}),removeAssertion:ie=>se=>this.removeAssertion(w,ie)})}
              </div>
            </details>
            <details class="mt-10">
              <summary class="label-text text-lg mb-2 cursor-pointer">
                <div class="inline-flex gap-2 items-center cursor-pointer text-lg  text-textStrong font-medium">Extract variables from the response <span class="font-normal  text-textWeak">(optional)</span></div></summary>
              <div class="text-sm space-y-2 px-2 paramRows" id="[${w}][exports]">
                <p class=" text-textStrong">Variables consist of a variable name and a json path pointing to the variable in the response.</p>
                ${this.renderParamsRows(F,w,"exports")}
                <button class="flex items-center gap-1 mt-4" type="button" @click=${()=>{}}>
                ${faSprite_("plus","regular","w-4 h-4  text-textWeak")}
                <span class="underline  text-textWeak font-semibold">New variable<span>
                </button>
              </div>
            </div>
          </div>
        </div>
        </div>
      </div>
    `}renderAssertResult(F){let w=F?.ok===!0||!1,D=!F,O=F?.err?.advice||"";return w?x` <svg class="icon w-3 h-3 text-green-500"><use href="/public/assets/svgs/fa-sprites/solid.svg#check"></use></svg>`:!w&&!D?x`<span title="${O}"
        ><svg class="icon w-3 h-3 text-red-500"><use href="/public/assets/svgs/fa-sprites/regular.svg#trash"></use></svg><span></span
      ></span>`:x`<span title="${O}" class="opacity-0"
      ><svg class="icon w-3 h-3 text-red-500"><use href="/public/assets/svgs/fa-sprites/regular.svg#trash"></use></svg><span></span
    ></span>`}renderParamRow(F,w,D,O,W,U,K=void 0,q=null){let G=K?.err?.advice||"",Q="";q&&(G=q.value?q.value:G,Q=q.key?q.key:"");const Y=[{value:"body",label:"Body"},{value:"header",label:"Header"},{value:"status",label:"Status Code"},{value:"responseTime",label:"Response Time"}],X=U=="status"||U=="responseTime";return x`
      <div class="flex flex-row gap-2 w-full paramRow">
        <span class="shrink hidden assertIndicator"> ${this.renderAssertResult(K)} </span>
        <div class="flex flex-col w-1/3">
          <input
            class="input input-sm shadow-none w-full"
            list="${D}DataList"
            placeholder="Key"
            .value="${F}"
            @change=${J=>this.updateKey(J,O,D,W)}
          />
          <span class="text-xs text-red-500 w-full">${Q}</span>
        </div>
        ${D==="exports"?x`
              <div class="flex flex-col w-1/3">
                <select class="select select-sm max-w-xs shadow-none" @change=${J=>this.updateExportCategory(J,O,D,W)}>
                  ${Y.map(J=>x` <option value=${J.value} ?selected=${J.value===U}>${J.label}</option> `)}
                </select>
              </div>
            `:E}
        ${D!="exports"||!X?x`<div class="shrink w-full flex flex-col">
          <input
            list="${D==="asserts"?"assertAutocomplete-"+O:""}"
            class="input shadow-none ${G?"input-error":""} input-sm w-full"
            placeholder="Value"
            .value="${w}"
            @input=${J=>this.updateValue(J,O,D,W,F)}
          />
          <span class="text-xs text-red-500">${G}</span>
        </div>
        <a class="cursor-pointer text-slate-600" @click=${J=>this.deleteKey(J,O,D,W,F)}>
          <svg class="inline-block icon w-5 h-5 p-1 rounded-full shadow-sm border stroke-red-500"><use href="/public/assets/svgs/fa-sprites/regular.svg#trash"></use></svg>
        </a>
      </div>`:E}
      </div>
    `}renderParamsRows(F,w,D,O){let W=[];const U=this.saveErrors[w]?this.saveErrors[w][D]||[]:[];if(D==="asserts"){let K=[],q=new Set,G=document.querySelector("#res-container-"+w),Q;G&&(Q=G.querySelectorAll("[data-field-path]"),Q.forEach(X=>{let J=X.getAttribute("data-field-path");J&&q.add(("$.resp.json."+J.replace(/\.?(\d+)\.?/g,".[$1].")).replace("..","."))})),K=Array.from(q);const Y=F[D]||[];Y.forEach((X,J)=>Object.entries(X).map(([te,ie])=>W.push(this.renderParamRow(te,ie,D,w,J,"",O?O[J]:void 0,U[J])))),(W.length===0||!Y.some(X=>X.key.trim()===""&&X.value.trim()===""))&&W.push(this.renderParamRow("","",D,w,W.length,"")),W.push(x`
        <datalist id=${"assertAutocomplete-"+w}>
          ${K.map(X=>x`<option class="w-full  text-left text-xs px-3 py-1 hover:bg-gray-200">${X}</option>`)}
        </datalist>
      `)}else if(D==="exports"){const K=F[D]||[];W=K.map((q,G)=>this.renderParamRow(q.key,q.value,D,w,G,q.category,void 0,U[G])),(W.length===0||K.some(q=>q.key.trim()===""&&q.value.trim()===""))&&W.push(this.renderParamRow("","",D,w,W.length,"body",void 0,U[W.length-1]))}else{const K=F[D]||{};W=Object.entries(K).filter(([q,G])=>q!="Cookie").map(([q,G],Q)=>this.renderParamRow(q,G,D,w,Q,"",void 0,U[Q])),(W.length===0||!Object.entries(K).some(([q,G])=>q.trim()===""&&G.trim()===""))&&W.push(this.renderParamRow("","",D,w,W.length,"",void 0,null))}return x`${W}`}updateKey(F,w,D,O){const W=F.target.value,U=F.target.defaultValue,K=this.collectionSteps[w],q=(G,Q,Y)=>{const X=G[Q];delete G[Q],G[Y]=X||""};if(D==null)q(K,U,W);else if(K[D]=K[D]||(O===null?{}:[]),O!=null)if(D==="exports"){if(this.collectionSteps[w][D]){const G=this.collectionSteps[w][D][O]||{key:"",value:"",category:""};this.collectionSteps[w][D][O]={...G,key:W}}}else{const G=K[D][O]||{},Q=Object.entries(G);if(Q.length>0){const Y=Q[0][1];K[D][O]={[W]:Y}}else K[D][O]={[W]:""}}else q(K[D],U,W);this.requestUpdate()}deleteKey(F,w,D,O,W){const U=this.collectionSteps[w];U[D]=U[D]||(O!=null?[]:{}),O!=null?U[D].splice(O,1):delete U[D][W],this.requestUpdate()}updateExportCategory(F,w,D,O){if(D!=="exports")return;const W=F.target.value,U=this.collectionSteps[w];U[D]=U[D]||[],U[D][O]=U[D][O]||{},U[D][O].category=W,this.requestUpdate()}updateValue(F,w,D,O,W){const U=F.target.value;if(D==null){this.collectionSteps[w][W]=U,this.requestUpdate();return}if(O!=null){if(W==="")if(D==="asserts"){const K=this.collectionSteps[w][D];K&&(K[O]={ok:U})}else if(D==="exports"){if(this.collectionSteps[w][D]){const K=this.collectionSteps[w][D][O];this.collectionSteps[w][D][O]={...K,value:U}}}else if(D==="exports"){if(this.collectionSteps[w][D]){const K=this.collectionSteps[w][D][O];this.collectionSteps[w][D][O]={...K,value:U}}}else this.collectionSteps[w][D][O][W]=U;else this.collectionSteps[w][D][W]=U;this.requestUpdate()}}render(){const F=document.querySelector("#test-code-toggle");return F&&!F.checked&&this.updateEditorContent(),x`
      <style>
        .draggable {
          transition: transform 0.4s ease;
        }
        .over {
          border: 2px solid blue;
        }
        .active-drop-target {
          background-color: lightblue !important;
          border: 2px solid blue;
          transform: translateY(-20px);
        }
      </style>
      <div id="collectionStepsContainer" class="overflow-y-auto">
        <div id="steps-codeEditor" class="min-h-[28rem] max-h-screen hidden group-has-[.editormode:checked]/colform:block"></div>
        <div class="group-has-[.editormode:checked]/colform:hidden">
          <div
            id="collectionStepsContainer"
            class="collectionSteps draggable-container space-y-4"
            @dragover="${this._onDragOver}"
            @drop="${this._onDrop}"
            @dragenter="${this._onDragEnter}"
            @dragleave="${this._onDragLeave}"
          >
            ${this.collectionSteps.map((w,D)=>this.renderCollectionStep(w,D,this.collectionResults[D],this.saveErrors[D])||void 0)}
          </div>
          ${this.isOnboarding?E:x`<div class="p-4 pt-4">
                <a
                  class="btn btn-sm blue-outline-btn bg-transparent border-[var(--brand-color)] items-center cursor-pointer"
                  @click=${()=>this.addStep()}
                >
                  <svg class="inline-block icon w-3 h-3"><use href="/public/assets/svgs/fa-sprites/solid.svg#plus"></use></svg>
                  Add new step
                </a>
              </div>`}
        </div>
      </div>
    `}updateAssertion(F,w,D){this.collectionSteps[F]._assertions===void 0&&(this.collectionSteps[F]._assertions=[]),this.collectionSteps[F]._assertions=this.collectionSteps[F]._assertions.map((U,K)=>K===w?{...U,...D}:U);const O=this.collectionSteps[F]._assertions[w],W=this.evaluateAssertion(O)?"PASSED":"FAILED";this.collectionSteps[F]._assertions=this.collectionSteps[F]._assertions.map((U,K)=>K===w?{...U,status:W}:U),this.requestUpdate()}addAssertion(F,w,D){F.preventDefault(),this.collectionSteps[w]._assertions=[...this.collectionSteps[w]._assertions||[],D],this.requestUpdate()}removeAssertion(F,w){this.collectionSteps[F]._assertions===void 0&&(this.collectionSteps[F]._assertions=[]),this.collectionSteps[F]._assertions.splice(w,1),this.collectionResults&&this.collectionResults[F]&&this.collectionResults[F].assert_results?.splice(w,1),this.requestUpdate()}evaluateAssertion(F){return F.type==="body"&&F.operation==="contains"?this.response.body.includes(F.value):!1}};__decorateClass([r$2()],StepsEditor.prototype,"collectionSteps",2);__decorateClass([r$2()],StepsEditor.prototype,"collectionResults",2);__decorateClass([r$2()],StepsEditor.prototype,"saveErrors",2);__decorateClass([r$2()],StepsEditor.prototype,"isSendingRequest",2);__decorateClass([r$2()],StepsEditor.prototype,"sendRequestErrors",2);__decorateClass([r$2()],StepsEditor.prototype,"isOnboarding",2);__decorateClass([e$2("#editor-container")],StepsEditor.prototype,"editorContainer",2);StepsEditor=__decorateClass([t$2("steps-editor")],StepsEditor);window.getPopularQueries=getPopularQueries;document.addEventListener("DOMContentLoaded",()=>{const F=document.getElementById("kusto-editor");setTimeout(()=>{initializeDefaultSchema();const w=[{id:"1234abcd",projectId:"project1",createdAt:"2023-04-15T10:30:00Z",updatedAt:"2023-04-15T10:30:00Z",userId:"user123",queryType:"history",queryText:'resource.service.name == "checkout"',queryAst:{},byMe:!0},{id:"5678efgh",projectId:"project1",createdAt:"2023-04-14T14:45:00Z",updatedAt:"2023-04-14T14:45:00Z",userId:"user123",queryType:"history",queryText:'attributes.http.request.method == "GET" and status_code == "ERROR"',queryAst:{},byMe:!0},{id:"abcd1234",projectId:"project1",createdAt:"2023-04-10T09:15:00Z",updatedAt:"2023-04-10T09:15:00Z",userId:"user123",queryType:"saved",queryText:"stats avg(duration) by resource.service.name",queryAst:{},title:"Average Duration by Service",byMe:!0},{id:"efgh5678",projectId:"project1",createdAt:"2023-04-05T16:20:00Z",updatedAt:"2023-04-05T16:20:00Z",userId:"user456",queryType:"saved",queryText:"metrics | timechart [5m] avg(duration) by resource.service.name",queryAst:{},title:"Service Metrics Over Time",byMe:!1}];F&&F.setQueryLibrary(w);const D=[{query:"stats p95(duration) by resource.service.name",description:"P95 latency by service"},{query:"attributes.http.response.status_code >= 400",description:"HTTP errors"},{query:'resource.service.name == "auth-service"',description:"Auth service logs"},{query:"timechart [5m] count() by resource.service.name",description:"Request volume over time"},{query:"duration > 500ms",description:"Slow requests"}];F&&F.setPopularSearches(D)},1e3)})});export default im();
