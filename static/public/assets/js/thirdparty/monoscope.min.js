var Monoscope=function(){"use strict";var e,t=Object.defineProperty,n=(e,n,r)=>((e,n,r)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r)(e,"symbol"!=typeof n?n+"":n,r),r=Object.defineProperty,s=(e,t,n)=>((e,t,n)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n),o=Object.defineProperty,i=(e,t,n)=>((e,t,n)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);const a={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},l={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},c={};function u(e){if(c[e])return c[e];const t=globalThis[e],n=t.prototype,r=e in a?a[e]:void 0,s=Boolean(r&&r.every(e=>{var t,r;return Boolean(null==(r=null==(t=Object.getOwnPropertyDescriptor(n,e))?void 0:t.get)?void 0:r.toString().includes("[native code]"))})),o=e in l?l[e]:void 0,i=Boolean(o&&o.every(e=>{var t;return"function"==typeof n[e]&&(null==(t=n[e])?void 0:t.toString().includes("[native code]"))}));if(s&&i&&!globalThis.Zone)return c[e]=t.prototype,t.prototype;try{const r=document.createElement("iframe");document.body.appendChild(r);const s=r.contentWindow;if(!s)return t.prototype;const o=s[e].prototype;return document.body.removeChild(r),o?c[e]=o:n}catch{return n}}const h={};function p(e,t,n){var r;const s=`${e}.${String(n)}`;if(h[s])return h[s].call(t);const o=u(e),i=null==(r=Object.getOwnPropertyDescriptor(o,n))?void 0:r.get;return i?(h[s]=i,i.call(t)):t[n]}const d={};function f(e,t,n){const r=`${e}.${String(n)}`;if(d[r])return d[r].bind(t);const s=u(e)[n];return"function"!=typeof s?t[n]:(d[r]=s,s.bind(t))}const m={childNodes:function(e){return p("Node",e,"childNodes")},parentNode:function(e){return p("Node",e,"parentNode")},parentElement:function(e){return p("Node",e,"parentElement")},textContent:function(e){return p("Node",e,"textContent")},contains:function(e,t){return f("Node",e,"contains")(t)},getRootNode:function(e){return f("Node",e,"getRootNode")()},host:function(e){return e&&"host"in e?p("ShadowRoot",e,"host"):null},styleSheets:function(e){return e.styleSheets},shadowRoot:function(e){return e&&"shadowRoot"in e?p("Element",e,"shadowRoot"):null},querySelector:function(e,t){return p("Element",e,"querySelector")(t)},querySelectorAll:function(e,t){return p("Element",e,"querySelectorAll")(t)},mutationObserver:function(){return u("MutationObserver").constructor}};let g=class{constructor(){i(this,"idNodeMap",new Map),i(this,"nodeMetaMap",new WeakMap)}getId(e){var t;if(!e)return-1;return(null==(t=this.getMeta(e))?void 0:t.id)??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(e=>this.removeNodeFromMap(e))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){const n=this.getNode(e);if(n){const e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function y(e,t,n){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!n&&y(m.parentNode(e),t,n);for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!!n&&y(m.parentNode(e),t,n)}function v(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function b(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}),n}var w={exports:{}},C=String,S=function(){return{isColorSupported:!1,reset:C,bold:C,dim:C,italic:C,underline:C,inverse:C,hidden:C,strikethrough:C,black:C,red:C,green:C,yellow:C,blue:C,magenta:C,cyan:C,white:C,gray:C,bgBlack:C,bgRed:C,bgGreen:C,bgYellow:C,bgBlue:C,bgMagenta:C,bgCyan:C,bgWhite:C}};w.exports=S(),w.exports.createColors=S;var _=w.exports;const I=b(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));let A=_,E=I,k=class e extends Error{constructor(t,n,r,s,o,i){super(t),this.name="CssSyntaxError",this.reason=t,o&&(this.file=o),s&&(this.source=s),i&&(this.plugin=i),void 0!==n&&void 0!==r&&("number"==typeof n?(this.line=n,this.column=r):(this.line=n.line,this.column=n.column,this.endLine=r.line,this.endColumn=r.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,e)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",void 0!==this.line&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(e){if(!this.source)return"";let t=this.source;null==e&&(e=A.isColorSupported),E&&e&&(t=E(t));let n,r,s=t.split(/\r?\n/),o=Math.max(this.line-3,0),i=Math.min(this.line+2,s.length),a=String(i).length;if(e){let{bold:e,gray:t,red:s}=A.createColors(!0);n=t=>e(s(t)),r=e=>t(e)}else n=r=e=>e;return s.slice(o,i).map((e,t)=>{let s=o+1+t,i=" "+(" "+s).slice(-a)+" | ";if(s===this.line){let t=r(i.replace(/\d/g," "))+e.slice(0,this.column-1).replace(/[^\t]/g," ");return n(">")+r(i)+e+"\n "+t+n("^")}return" "+r(i)+e}).join("\n")}toString(){let e=this.showSourceCode();return e&&(e="\n\n"+e+"\n"),this.name+": "+this.message+e}};var T=k;k.default=k;var O={};O.isClean=Symbol("isClean"),O.my=Symbol("my");const R={after:"\n",beforeClose:"\n",beforeComment:"\n",beforeDecl:"\n",beforeOpen:" ",beforeRule:"\n",colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};let x=class{constructor(e){this.builder=e}atrule(e,t){let n="@"+e.name,r=e.params?this.rawValue(e,"params"):"";if(void 0!==e.raws.afterName?n+=e.raws.afterName:r&&(n+=" "),e.nodes)this.block(e,n+r);else{let s=(e.raws.between||"")+(t?";":"");this.builder(n+r+s,e)}}beforeAfter(e,t){let n;n="decl"===e.type?this.raw(e,null,"beforeDecl"):"comment"===e.type?this.raw(e,null,"beforeComment"):"before"===t?this.raw(e,null,"beforeRule"):this.raw(e,null,"beforeClose");let r=e.parent,s=0;for(;r&&"root"!==r.type;)s+=1,r=r.parent;if(n.includes("\n")){let t=this.raw(e,null,"indent");if(t.length)for(let e=0;e<s;e++)n+=t}return n}block(e,t){let n,r=this.raw(e,"between","beforeOpen");this.builder(t+r+"{",e,"start"),e.nodes&&e.nodes.length?(this.body(e),n=this.raw(e,"after")):n=this.raw(e,"after","emptyBody"),n&&this.builder(n),this.builder("}",e,"end")}body(e){let t=e.nodes.length-1;for(;t>0&&"comment"===e.nodes[t].type;)t-=1;let n=this.raw(e,"semicolon");for(let r=0;r<e.nodes.length;r++){let s=e.nodes[r],o=this.raw(s,"before");o&&this.builder(o),this.stringify(s,t!==r||n)}}comment(e){let t=this.raw(e,"left","commentLeft"),n=this.raw(e,"right","commentRight");this.builder("/*"+t+e.text+n+"*/",e)}decl(e,t){let n=this.raw(e,"between","colon"),r=e.prop+n+this.rawValue(e,"value");e.important&&(r+=e.raws.important||" !important"),t&&(r+=";"),this.builder(r,e)}document(e){this.body(e)}raw(e,t,n){let r;if(n||(n=t),t&&(r=e.raws[t],void 0!==r))return r;let s=e.parent;if("before"===n){if(!s||"root"===s.type&&s.first===e)return"";if(s&&"document"===s.type)return""}if(!s)return R[n];let o=e.root();if(o.rawCache||(o.rawCache={}),void 0!==o.rawCache[n])return o.rawCache[n];if("before"===n||"after"===n)return this.beforeAfter(e,n);{let s="raw"+((i=n)[0].toUpperCase()+i.slice(1));this[s]?r=this[s](o,e):o.walk(e=>{if(r=e.raws[t],void 0!==r)return!1})}var i;return void 0===r&&(r=R[n]),o.rawCache[n]=r,r}rawBeforeClose(e){let t;return e.walk(e=>{if(e.nodes&&e.nodes.length>0&&void 0!==e.raws.after)return t=e.raws.after,t.includes("\n")&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawBeforeComment(e,t){let n;return e.walkComments(e=>{if(void 0!==e.raws.before)return n=e.raws.before,n.includes("\n")&&(n=n.replace(/[^\n]+$/,"")),!1}),void 0===n?n=this.raw(t,null,"beforeDecl"):n&&(n=n.replace(/\S/g,"")),n}rawBeforeDecl(e,t){let n;return e.walkDecls(e=>{if(void 0!==e.raws.before)return n=e.raws.before,n.includes("\n")&&(n=n.replace(/[^\n]+$/,"")),!1}),void 0===n?n=this.raw(t,null,"beforeRule"):n&&(n=n.replace(/\S/g,"")),n}rawBeforeOpen(e){let t;return e.walk(e=>{if("decl"!==e.type&&(t=e.raws.between,void 0!==t))return!1}),t}rawBeforeRule(e){let t;return e.walk(n=>{if(n.nodes&&(n.parent!==e||e.first!==n)&&void 0!==n.raws.before)return t=n.raws.before,t.includes("\n")&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawColon(e){let t;return e.walkDecls(e=>{if(void 0!==e.raws.between)return t=e.raws.between.replace(/[^\s:]/g,""),!1}),t}rawEmptyBody(e){let t;return e.walk(e=>{if(e.nodes&&0===e.nodes.length&&(t=e.raws.after,void 0!==t))return!1}),t}rawIndent(e){if(e.raws.indent)return e.raws.indent;let t;return e.walk(n=>{let r=n.parent;if(r&&r!==e&&r.parent&&r.parent===e&&void 0!==n.raws.before){let e=n.raws.before.split("\n");return t=e[e.length-1],t=t.replace(/\S/g,""),!1}}),t}rawSemicolon(e){let t;return e.walk(e=>{if(e.nodes&&e.nodes.length&&"decl"===e.last.type&&(t=e.raws.semicolon,void 0!==t))return!1}),t}rawValue(e,t){let n=e[t],r=e.raws[t];return r&&r.value===n?r.raw:n}root(e){this.body(e),e.raws.after&&this.builder(e.raws.after)}rule(e){this.block(e,this.rawValue(e,"selector")),e.raws.ownSemicolon&&this.builder(e.raws.ownSemicolon,e,"end")}stringify(e,t){if(!this[e.type])throw new Error("Unknown AST node type "+e.type+". Maybe you need to change PostCSS stringifier.");this[e.type](e,t)}};var N=x;x.default=x;let M=N;function L(e,t){new M(t).stringify(e)}var D=L;L.default=L;let{isClean:P,my:F}=O,B=T,U=N,Z=D;function j(e,t){let n=new e.constructor;for(let r in e){if(!Object.prototype.hasOwnProperty.call(e,r))continue;if("proxyCache"===r)continue;let s=e[r],o=typeof s;"parent"===r&&"object"===o?t&&(n[r]=t):"source"===r?n[r]=s:Array.isArray(s)?n[r]=s.map(e=>j(e,n)):("object"===o&&null!==s&&(s=j(s)),n[r]=s)}return n}let z=class{constructor(e={}){this.raws={},this[P]=!1,this[F]=!0;for(let t in e)if("nodes"===t){this.nodes=[];for(let n of e[t])"function"==typeof n.clone?this.append(n.clone()):this.append(n)}else this[t]=e[t]}addToError(e){if(e.postcssNode=this,e.stack&&this.source&&/\n\s{4}at /.test(e.stack)){let t=this.source;e.stack=e.stack.replace(/\n\s{4}at /,`$&${t.input.from}:${t.start.line}:${t.start.column}$&`)}return e}after(e){return this.parent.insertAfter(this,e),this}assign(e={}){for(let t in e)this[t]=e[t];return this}before(e){return this.parent.insertBefore(this,e),this}cleanRaws(e){delete this.raws.before,delete this.raws.after,e||delete this.raws.between}clone(e={}){let t=j(this);for(let n in e)t[n]=e[n];return t}cloneAfter(e={}){let t=this.clone(e);return this.parent.insertAfter(this,t),t}cloneBefore(e={}){let t=this.clone(e);return this.parent.insertBefore(this,t),t}error(e,t={}){if(this.source){let{end:n,start:r}=this.rangeBy(t);return this.source.input.error(e,{column:r.column,line:r.line},{column:n.column,line:n.line},t)}return new B(e)}getProxyProcessor(){return{get:(e,t)=>"proxyOf"===t?e:"root"===t?()=>e.root().toProxy():e[t],set:(e,t,n)=>(e[t]===n||(e[t]=n,"prop"!==t&&"value"!==t&&"name"!==t&&"params"!==t&&"important"!==t&&"text"!==t||e.markDirty()),!0)}}markDirty(){if(this[P]){this[P]=!1;let e=this;for(;e=e.parent;)e[P]=!1}}next(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e+1]}positionBy(e,t){let n=this.source.start;if(e.index)n=this.positionInside(e.index,t);else if(e.word){let r=(t=this.toString()).indexOf(e.word);-1!==r&&(n=this.positionInside(r,t))}return n}positionInside(e,t){let n=t||this.toString(),r=this.source.start.column,s=this.source.start.line;for(let t=0;t<e;t++)"\n"===n[t]?(r=1,s+=1):r+=1;return{column:r,line:s}}prev(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e-1]}rangeBy(e){let t={column:this.source.start.column,line:this.source.start.line},n=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:t.column+1,line:t.line};if(e.word){let r=this.toString(),s=r.indexOf(e.word);-1!==s&&(t=this.positionInside(s,r),n=this.positionInside(s+e.word.length,r))}else e.start?t={column:e.start.column,line:e.start.line}:e.index&&(t=this.positionInside(e.index)),e.end?n={column:e.end.column,line:e.end.line}:"number"==typeof e.endIndex?n=this.positionInside(e.endIndex):e.index&&(n=this.positionInside(e.index+1));return(n.line<t.line||n.line===t.line&&n.column<=t.column)&&(n={column:t.column+1,line:t.line}),{end:n,start:t}}raw(e,t){return(new U).raw(this,e,t)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...e){if(this.parent){let t=this,n=!1;for(let r of e)r===this?n=!0:n?(this.parent.insertAfter(t,r),t=r):this.parent.insertBefore(t,r);n||this.remove()}return this}root(){let e=this;for(;e.parent&&"document"!==e.parent.type;)e=e.parent;return e}toJSON(e,t){let n={},r=null==t;t=t||new Map;let s=0;for(let e in this){if(!Object.prototype.hasOwnProperty.call(this,e))continue;if("parent"===e||"proxyCache"===e)continue;let r=this[e];if(Array.isArray(r))n[e]=r.map(e=>"object"==typeof e&&e.toJSON?e.toJSON(null,t):e);else if("object"==typeof r&&r.toJSON)n[e]=r.toJSON(null,t);else if("source"===e){let o=t.get(r.input);null==o&&(o=s,t.set(r.input,s),s++),n[e]={end:r.end,inputId:o,start:r.start}}else n[e]=r}return r&&(n.inputs=[...t.keys()].map(e=>e.toJSON())),n}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(e=Z){e.stringify&&(e=e.stringify);let t="";return e(this,e=>{t+=e}),t}warn(e,t,n){let r={node:this};for(let e in n)r[e]=n[e];return e.warn(t,r)}get proxyOf(){return this}};var V=z;z.default=z;let G=V,W=class extends G{constructor(e){e&&void 0!==e.value&&"string"!=typeof e.value&&(e={...e,value:String(e.value)}),super(e),this.type="decl"}get variable(){return this.prop.startsWith("--")||"$"===this.prop[0]}};var H=W;W.default=W;var Y={nanoid:(e=21)=>{let t="",n=e;for(;n--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t}};let{SourceMapConsumer:K,SourceMapGenerator:J}=I,{existsSync:X,readFileSync:q}=I,{dirname:Q,join:$}=I;let ee=class{constructor(e,t){if(!1===t.map)return;this.loadAnnotation(e),this.inline=this.startWith(this.annotation,"data:");let n=t.map?t.map.prev:void 0,r=this.loadMap(t.from,n);!this.mapFile&&t.from&&(this.mapFile=t.from),this.mapFile&&(this.root=Q(this.mapFile)),r&&(this.text=r)}consumer(){return this.consumerCache||(this.consumerCache=new K(this.text)),this.consumerCache}decodeInline(e){if(/^data:application\/json;charset=utf-?8,/.test(e)||/^data:application\/json,/.test(e))return decodeURIComponent(e.substr(RegExp.lastMatch.length));if(/^data:application\/json;charset=utf-?8;base64,/.test(e)||/^data:application\/json;base64,/.test(e))return t=e.substr(RegExp.lastMatch.length),Buffer?Buffer.from(t,"base64").toString():window.atob(t);var t;let n=e.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+n)}getAnnotationURL(e){return e.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(e){return"object"==typeof e&&("string"==typeof e.mappings||"string"==typeof e._mappings||Array.isArray(e.sections))}loadAnnotation(e){let t=e.match(/\/\*\s*# sourceMappingURL=/gm);if(!t)return;let n=e.lastIndexOf(t.pop()),r=e.indexOf("*/",n);n>-1&&r>-1&&(this.annotation=this.getAnnotationURL(e.substring(n,r)))}loadFile(e){if(this.root=Q(e),X(e))return this.mapFile=e,q(e,"utf-8").toString().trim()}loadMap(e,t){if(!1===t)return!1;if(t){if("string"==typeof t)return t;if("function"!=typeof t){if(t instanceof K)return J.fromSourceMap(t).toString();if(t instanceof J)return t.toString();if(this.isMap(t))return JSON.stringify(t);throw new Error("Unsupported previous source map format: "+t.toString())}{let n=t(e);if(n){let e=this.loadFile(n);if(!e)throw new Error("Unable to load previous source map: "+n.toString());return e}}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let t=this.annotation;return e&&(t=$(Q(e),t)),this.loadFile(t)}}}startWith(e,t){return!!e&&e.substr(0,t.length)===t}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}};var te=ee;ee.default=ee;let{SourceMapConsumer:ne,SourceMapGenerator:re}=I,{fileURLToPath:se,pathToFileURL:oe}=I,{isAbsolute:ie,resolve:ae}=I,{nanoid:le}=Y,ce=I,ue=T,he=te,pe=Symbol("fromOffsetCache"),de=Boolean(ne&&re),fe=Boolean(ae&&ie),me=class{constructor(e,t={}){if(null==e||"object"==typeof e&&!e.toString)throw new Error(`PostCSS received ${e} instead of CSS string`);if(this.css=e.toString(),"\ufeff"===this.css[0]||"ï¿¾"===this.css[0]?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,t.from&&(!fe||/^\w+:\/\//.test(t.from)||ie(t.from)?this.file=t.from:this.file=ae(t.from)),fe&&de){let e=new he(this.css,t);if(e.text){this.map=e;let t=e.consumer().file;!this.file&&t&&(this.file=this.mapResolve(t))}}this.file||(this.id="<input css "+le(6)+">"),this.map&&(this.map.file=this.from)}error(e,t,n,r={}){let s,o,i;if(t&&"object"==typeof t){let e=t,r=n;if("number"==typeof e.offset){let r=this.fromOffset(e.offset);t=r.line,n=r.col}else t=e.line,n=e.column;if("number"==typeof r.offset){let e=this.fromOffset(r.offset);o=e.line,i=e.col}else o=r.line,i=r.column}else if(!n){let e=this.fromOffset(t);t=e.line,n=e.col}let a=this.origin(t,n,o,i);return s=a?new ue(e,void 0===a.endLine?a.line:{column:a.column,line:a.line},void 0===a.endLine?a.column:{column:a.endColumn,line:a.endLine},a.source,a.file,r.plugin):new ue(e,void 0===o?t:{column:n,line:t},void 0===o?n:{column:i,line:o},this.css,this.file,r.plugin),s.input={column:n,endColumn:i,endLine:o,line:t,source:this.css},this.file&&(oe&&(s.input.url=oe(this.file).toString()),s.input.file=this.file),s}fromOffset(e){let t,n;if(this[pe])n=this[pe];else{let e=this.css.split("\n");n=new Array(e.length);let t=0;for(let r=0,s=e.length;r<s;r++)n[r]=t,t+=e[r].length+1;this[pe]=n}t=n[n.length-1];let r=0;if(e>=t)r=n.length-1;else{let t,s=n.length-2;for(;r<s;)if(t=r+(s-r>>1),e<n[t])s=t-1;else{if(!(e>=n[t+1])){r=t;break}r=t+1}}return{col:e-n[r]+1,line:r+1}}mapResolve(e){return/^\w+:\/\//.test(e)?e:ae(this.map.consumer().sourceRoot||this.map.root||".",e)}origin(e,t,n,r){if(!this.map)return!1;let s,o,i=this.map.consumer(),a=i.originalPositionFor({column:t,line:e});if(!a.source)return!1;"number"==typeof n&&(s=i.originalPositionFor({column:r,line:n})),o=ie(a.source)?oe(a.source):new URL(a.source,this.map.consumer().sourceRoot||oe(this.map.mapFile));let l={column:a.column,endColumn:s&&s.column,endLine:s&&s.line,line:a.line,url:o.toString()};if("file:"===o.protocol){if(!se)throw new Error("file: protocol is not available in this PostCSS build");l.file=se(o)}let c=i.sourceContentFor(a.source);return c&&(l.source=c),l}toJSON(){let e={};for(let t of["hasBOM","css","file","id"])null!=this[t]&&(e[t]=this[t]);return this.map&&(e.map={...this.map},e.map.consumerCache&&(e.map.consumerCache=void 0)),e}get from(){return this.file||this.id}};var ge=me;me.default=me,ce&&ce.registerInput&&ce.registerInput(me);let{SourceMapConsumer:ye,SourceMapGenerator:ve}=I,{dirname:be,relative:we,resolve:Ce,sep:Se}=I,{pathToFileURL:_e}=I,Ie=ge,Ae=Boolean(ye&&ve),Ee=Boolean(be&&Ce&&we&&Se);var ke=class{constructor(e,t,n,r){this.stringify=e,this.mapOpts=n.map||{},this.root=t,this.opts=n,this.css=r,this.originalCSS=r,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let e;e=this.isInline()?"data:application/json;base64,"+this.toBase64(this.map.toString()):"string"==typeof this.mapOpts.annotation?this.mapOpts.annotation:"function"==typeof this.mapOpts.annotation?this.mapOpts.annotation(this.opts.to,this.root):this.outputFile()+".map";let t="\n";this.css.includes("\r\n")&&(t="\r\n"),this.css+=t+"/*# sourceMappingURL="+e+" */"}applyPrevMaps(){for(let e of this.previous()){let t,n=this.toUrl(this.path(e.file)),r=e.root||be(e.file);!1===this.mapOpts.sourcesContent?(t=new ye(e.text),t.sourcesContent&&(t.sourcesContent=null)):t=e.consumer(),this.map.applySourceMap(t,n,this.toUrl(this.path(r)))}}clearAnnotation(){if(!1!==this.mapOpts.annotation)if(this.root){let e;for(let t=this.root.nodes.length-1;t>=0;t--)e=this.root.nodes[t],"comment"===e.type&&0===e.text.indexOf("# sourceMappingURL=")&&this.root.removeChild(t)}else this.css&&(this.css=this.css.replace(/\n*?\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),Ee&&Ae&&this.isMap())return this.generateMap();{let e="";return this.stringify(this.root,t=>{e+=t}),[e]}}generateMap(){if(this.root)this.generateString();else if(1===this.previous().length){let e=this.previous()[0].consumer();e.file=this.outputFile(),this.map=ve.fromSourceMap(e,{ignoreInvalidMapping:!0})}else this.map=new ve({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new ve({file:this.outputFile(),ignoreInvalidMapping:!0});let e,t,n=1,r=1,s="<no source>",o={generated:{column:0,line:0},original:{column:0,line:0},source:""};this.stringify(this.root,(i,a,l)=>{if(this.css+=i,a&&"end"!==l&&(o.generated.line=n,o.generated.column=r-1,a.source&&a.source.start?(o.source=this.sourcePath(a),o.original.line=a.source.start.line,o.original.column=a.source.start.column-1,this.map.addMapping(o)):(o.source=s,o.original.line=1,o.original.column=0,this.map.addMapping(o))),e=i.match(/\n/g),e?(n+=e.length,t=i.lastIndexOf("\n"),r=i.length-t):r+=i.length,a&&"start"!==l){let e=a.parent||{raws:{}};("decl"===a.type||"atrule"===a.type&&!a.nodes)&&a===e.last&&!e.raws.semicolon||(a.source&&a.source.end?(o.source=this.sourcePath(a),o.original.line=a.source.end.line,o.original.column=a.source.end.column-1,o.generated.line=n,o.generated.column=r-2,this.map.addMapping(o)):(o.source=s,o.original.line=1,o.original.column=0,o.generated.line=n,o.generated.column=r-1,this.map.addMapping(o)))}})}isAnnotation(){return!!this.isInline()||(void 0!==this.mapOpts.annotation?this.mapOpts.annotation:!this.previous().length||this.previous().some(e=>e.annotation))}isInline(){if(void 0!==this.mapOpts.inline)return this.mapOpts.inline;let e=this.mapOpts.annotation;return(void 0===e||!0===e)&&(!this.previous().length||this.previous().some(e=>e.inline))}isMap(){return void 0!==this.opts.map?!!this.opts.map:this.previous().length>0}isSourcesContent(){return void 0!==this.mapOpts.sourcesContent?this.mapOpts.sourcesContent:!this.previous().length||this.previous().some(e=>e.withContent())}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(e){if(this.mapOpts.absolute)return e;if(60===e.charCodeAt(0))return e;if(/^\w+:\/\//.test(e))return e;let t=this.memoizedPaths.get(e);if(t)return t;let n=this.opts.to?be(this.opts.to):".";"string"==typeof this.mapOpts.annotation&&(n=be(Ce(n,this.mapOpts.annotation)));let r=we(n,e);return this.memoizedPaths.set(e,r),r}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(e=>{if(e.source&&e.source.input.map){let t=e.source.input.map;this.previousMaps.includes(t)||this.previousMaps.push(t)}});else{let e=new Ie(this.originalCSS,this.opts);e.map&&this.previousMaps.push(e.map)}return this.previousMaps}setSourcesContent(){let e={};if(this.root)this.root.walk(t=>{if(t.source){let n=t.source.input.from;if(n&&!e[n]){e[n]=!0;let r=this.usesFileUrls?this.toFileUrl(n):this.toUrl(this.path(n));this.map.setSourceContent(r,t.source.input.css)}}});else if(this.css){let e=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(e,this.css)}}sourcePath(e){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(e.source.input.from):this.toUrl(this.path(e.source.input.from))}toBase64(e){return Buffer?Buffer.from(e).toString("base64"):window.btoa(unescape(encodeURIComponent(e)))}toFileUrl(e){let t=this.memoizedFileURLs.get(e);if(t)return t;if(_e){let t=_e(e).toString();return this.memoizedFileURLs.set(e,t),t}throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(e){let t=this.memoizedURLs.get(e);if(t)return t;"\\"===Se&&(e=e.replace(/\\/g,"/"));let n=encodeURI(e).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(e,n),n}};let Te=V,Oe=class extends Te{constructor(e){super(e),this.type="comment"}};var Re=Oe;Oe.default=Oe;let xe,Ne,Me,Le,{isClean:De,my:Pe}=O,Fe=H,Be=Re,Ue=V;function Ze(e){return e.map(e=>(e.nodes&&(e.nodes=Ze(e.nodes)),delete e.source,e))}function je(e){if(e[De]=!1,e.proxyOf.nodes)for(let t of e.proxyOf.nodes)je(t)}let ze=class e extends Ue{append(...e){for(let t of e){let e=this.normalize(t,this.last);for(let t of e)this.proxyOf.nodes.push(t)}return this.markDirty(),this}cleanRaws(e){if(super.cleanRaws(e),this.nodes)for(let t of this.nodes)t.cleanRaws(e)}each(e){if(!this.proxyOf.nodes)return;let t,n,r=this.getIterator();for(;this.indexes[r]<this.proxyOf.nodes.length&&(t=this.indexes[r],n=e(this.proxyOf.nodes[t],t),!1!==n);)this.indexes[r]+=1;return delete this.indexes[r],n}every(e){return this.nodes.every(e)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let e=this.lastEach;return this.indexes[e]=0,e}getProxyProcessor(){return{get:(e,t)=>"proxyOf"===t?e:e[t]?"each"===t||"string"==typeof t&&t.startsWith("walk")?(...n)=>e[t](...n.map(e=>"function"==typeof e?(t,n)=>e(t.toProxy(),n):e)):"every"===t||"some"===t?n=>e[t]((e,...t)=>n(e.toProxy(),...t)):"root"===t?()=>e.root().toProxy():"nodes"===t?e.nodes.map(e=>e.toProxy()):"first"===t||"last"===t?e[t].toProxy():e[t]:e[t],set:(e,t,n)=>(e[t]===n||(e[t]=n,"name"!==t&&"params"!==t&&"selector"!==t||e.markDirty()),!0)}}index(e){return"number"==typeof e?e:(e.proxyOf&&(e=e.proxyOf),this.proxyOf.nodes.indexOf(e))}insertAfter(e,t){let n,r=this.index(e),s=this.normalize(t,this.proxyOf.nodes[r]).reverse();r=this.index(e);for(let e of s)this.proxyOf.nodes.splice(r+1,0,e);for(let e in this.indexes)n=this.indexes[e],r<n&&(this.indexes[e]=n+s.length);return this.markDirty(),this}insertBefore(e,t){let n,r=this.index(e),s=0===r&&"prepend",o=this.normalize(t,this.proxyOf.nodes[r],s).reverse();r=this.index(e);for(let e of o)this.proxyOf.nodes.splice(r,0,e);for(let e in this.indexes)n=this.indexes[e],r<=n&&(this.indexes[e]=n+o.length);return this.markDirty(),this}normalize(t,n){if("string"==typeof t)t=Ze(xe(t).nodes);else if(void 0===t)t=[];else if(Array.isArray(t)){t=t.slice(0);for(let e of t)e.parent&&e.parent.removeChild(e,"ignore")}else if("root"===t.type&&"document"!==this.type){t=t.nodes.slice(0);for(let e of t)e.parent&&e.parent.removeChild(e,"ignore")}else if(t.type)t=[t];else if(t.prop){if(void 0===t.value)throw new Error("Value field is missed in node creation");"string"!=typeof t.value&&(t.value=String(t.value)),t=[new Fe(t)]}else if(t.selector)t=[new Ne(t)];else if(t.name)t=[new Me(t)];else{if(!t.text)throw new Error("Unknown node type in node creation");t=[new Be(t)]}return t.map(t=>(t[Pe]||e.rebuild(t),(t=t.proxyOf).parent&&t.parent.removeChild(t),t[De]&&je(t),void 0===t.raws.before&&n&&void 0!==n.raws.before&&(t.raws.before=n.raws.before.replace(/\S/g,"")),t.parent=this.proxyOf,t))}prepend(...e){e=e.reverse();for(let t of e){let e=this.normalize(t,this.first,"prepend").reverse();for(let t of e)this.proxyOf.nodes.unshift(t);for(let t in this.indexes)this.indexes[t]=this.indexes[t]+e.length}return this.markDirty(),this}push(e){return e.parent=this,this.proxyOf.nodes.push(e),this}removeAll(){for(let e of this.proxyOf.nodes)e.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(e){let t;e=this.index(e),this.proxyOf.nodes[e].parent=void 0,this.proxyOf.nodes.splice(e,1);for(let n in this.indexes)t=this.indexes[n],t>=e&&(this.indexes[n]=t-1);return this.markDirty(),this}replaceValues(e,t,n){return n||(n=t,t={}),this.walkDecls(r=>{t.props&&!t.props.includes(r.prop)||t.fast&&!r.value.includes(t.fast)||(r.value=r.value.replace(e,n))}),this.markDirty(),this}some(e){return this.nodes.some(e)}walk(e){return this.each((t,n)=>{let r;try{r=e(t,n)}catch(e){throw t.addToError(e)}return!1!==r&&t.walk&&(r=t.walk(e)),r})}walkAtRules(e,t){return t?e instanceof RegExp?this.walk((n,r)=>{if("atrule"===n.type&&e.test(n.name))return t(n,r)}):this.walk((n,r)=>{if("atrule"===n.type&&n.name===e)return t(n,r)}):(t=e,this.walk((e,n)=>{if("atrule"===e.type)return t(e,n)}))}walkComments(e){return this.walk((t,n)=>{if("comment"===t.type)return e(t,n)})}walkDecls(e,t){return t?e instanceof RegExp?this.walk((n,r)=>{if("decl"===n.type&&e.test(n.prop))return t(n,r)}):this.walk((n,r)=>{if("decl"===n.type&&n.prop===e)return t(n,r)}):(t=e,this.walk((e,n)=>{if("decl"===e.type)return t(e,n)}))}walkRules(e,t){return t?e instanceof RegExp?this.walk((n,r)=>{if("rule"===n.type&&e.test(n.selector))return t(n,r)}):this.walk((n,r)=>{if("rule"===n.type&&n.selector===e)return t(n,r)}):(t=e,this.walk((e,n)=>{if("rule"===e.type)return t(e,n)}))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}};ze.registerParse=e=>{xe=e},ze.registerRule=e=>{Ne=e},ze.registerAtRule=e=>{Me=e},ze.registerRoot=e=>{Le=e};var Ve=ze;ze.default=ze,ze.rebuild=e=>{"atrule"===e.type?Object.setPrototypeOf(e,Me.prototype):"rule"===e.type?Object.setPrototypeOf(e,Ne.prototype):"decl"===e.type?Object.setPrototypeOf(e,Fe.prototype):"comment"===e.type?Object.setPrototypeOf(e,Be.prototype):"root"===e.type&&Object.setPrototypeOf(e,Le.prototype),e[Pe]=!0,e.nodes&&e.nodes.forEach(e=>{ze.rebuild(e)})};let Ge,We,He=Ve,Ye=class extends He{constructor(e){super({type:"document",...e}),this.nodes||(this.nodes=[])}toResult(e={}){return new Ge(new We,this,e).stringify()}};Ye.registerLazyResult=e=>{Ge=e},Ye.registerProcessor=e=>{We=e};var Ke=Ye;Ye.default=Ye;let Je={};var Xe=function(e){Je[e]||(Je[e]=!0,"undefined"!=typeof console&&console.warn&&console.warn(e))};let qe=class{constructor(e,t={}){if(this.type="warning",this.text=e,t.node&&t.node.source){let e=t.node.rangeBy(t);this.line=e.start.line,this.column=e.start.column,this.endLine=e.end.line,this.endColumn=e.end.column}for(let e in t)this[e]=t[e]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}};var Qe=qe;qe.default=qe;let $e=Qe,et=class{constructor(e,t,n){this.processor=e,this.messages=[],this.root=t,this.opts=n,this.css=void 0,this.map=void 0}toString(){return this.css}warn(e,t={}){t.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(t.plugin=this.lastPlugin.postcssPlugin);let n=new $e(e,t);return this.messages.push(n),n}warnings(){return this.messages.filter(e=>"warning"===e.type)}get content(){return this.css}};var tt=et;et.default=et;const nt="'".charCodeAt(0),rt='"'.charCodeAt(0),st="\\".charCodeAt(0),ot="/".charCodeAt(0),it="\n".charCodeAt(0),at=" ".charCodeAt(0),lt="\f".charCodeAt(0),ct="\t".charCodeAt(0),ut="\r".charCodeAt(0),ht="[".charCodeAt(0),pt="]".charCodeAt(0),dt="(".charCodeAt(0),ft=")".charCodeAt(0),mt="{".charCodeAt(0),gt="}".charCodeAt(0),yt=";".charCodeAt(0),vt="*".charCodeAt(0),bt=":".charCodeAt(0),wt="@".charCodeAt(0),Ct=/[\t\n\f\r "#'()/;[\\\]{}]/g,St=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,_t=/.[\r\n"'(/\\]/,It=/[\da-f]/i;let At=Ve,Et=class extends At{constructor(e){super(e),this.type="atrule"}append(...e){return this.proxyOf.nodes||(this.nodes=[]),super.append(...e)}prepend(...e){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...e)}};var kt=Et;Et.default=Et,At.registerAtRule(Et);let Tt,Ot,Rt=Ve,xt=class extends Rt{constructor(e){super(e),this.type="root",this.nodes||(this.nodes=[])}normalize(e,t,n){let r=super.normalize(e);if(t)if("prepend"===n)this.nodes.length>1?t.raws.before=this.nodes[1].raws.before:delete t.raws.before;else if(this.first!==t)for(let e of r)e.raws.before=t.raws.before;return r}removeChild(e,t){let n=this.index(e);return!t&&0===n&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[n].raws.before),super.removeChild(e)}toResult(e={}){return new Tt(new Ot,this,e).stringify()}};xt.registerLazyResult=e=>{Tt=e},xt.registerProcessor=e=>{Ot=e};var Nt=xt;xt.default=xt,Rt.registerRoot(xt);let Mt={comma:e=>Mt.split(e,[","],!0),space:e=>Mt.split(e,[" ","\n","\t"]),split(e,t,n){let r=[],s="",o=!1,i=0,a=!1,l="",c=!1;for(let n of e)c?c=!1:"\\"===n?c=!0:a?n===l&&(a=!1):'"'===n||"'"===n?(a=!0,l=n):"("===n?i+=1:")"===n?i>0&&(i-=1):0===i&&t.includes(n)&&(o=!0),o?(""!==s&&r.push(s.trim()),s="",o=!1):s+=n;return(n||""!==s)&&r.push(s.trim()),r}};var Lt=Mt;Mt.default=Mt;let Dt=Ve,Pt=Lt,Ft=class extends Dt{constructor(e){super(e),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return Pt.comma(this.selector)}set selectors(e){let t=this.selector?this.selector.match(/,\s*/):null,n=t?t[0]:","+this.raw("between","beforeOpen");this.selector=e.join(n)}};var Bt=Ft;Ft.default=Ft,Dt.registerRule(Ft);let Ut=H,Zt=function(e,t={}){let n,r,s,o,i,a,l,c,u,h,p=e.css.valueOf(),d=t.ignoreErrors,f=p.length,m=0,g=[],y=[];function v(t){throw e.error("Unclosed "+t,m)}return{back:function(e){y.push(e)},endOfFile:function(){return 0===y.length&&m>=f},nextToken:function(e){if(y.length)return y.pop();if(m>=f)return;let t=!!e&&e.ignoreUnclosed;switch(n=p.charCodeAt(m),n){case it:case at:case ct:case ut:case lt:r=m;do{r+=1,n=p.charCodeAt(r)}while(n===at||n===it||n===ct||n===ut||n===lt);h=["space",p.slice(m,r)],m=r-1;break;case ht:case pt:case mt:case gt:case bt:case yt:case ft:{let e=String.fromCharCode(n);h=[e,e,m];break}case dt:if(c=g.length?g.pop()[1]:"",u=p.charCodeAt(m+1),"url"===c&&u!==nt&&u!==rt&&u!==at&&u!==it&&u!==ct&&u!==lt&&u!==ut){r=m;do{if(a=!1,r=p.indexOf(")",r+1),-1===r){if(d||t){r=m;break}v("bracket")}for(l=r;p.charCodeAt(l-1)===st;)l-=1,a=!a}while(a);h=["brackets",p.slice(m,r+1),m,r],m=r}else r=p.indexOf(")",m+1),o=p.slice(m,r+1),-1===r||_t.test(o)?h=["(","(",m]:(h=["brackets",o,m,r],m=r);break;case nt:case rt:s=n===nt?"'":'"',r=m;do{if(a=!1,r=p.indexOf(s,r+1),-1===r){if(d||t){r=m+1;break}v("string")}for(l=r;p.charCodeAt(l-1)===st;)l-=1,a=!a}while(a);h=["string",p.slice(m,r+1),m,r],m=r;break;case wt:Ct.lastIndex=m+1,Ct.test(p),r=0===Ct.lastIndex?p.length-1:Ct.lastIndex-2,h=["at-word",p.slice(m,r+1),m,r],m=r;break;case st:for(r=m,i=!0;p.charCodeAt(r+1)===st;)r+=1,i=!i;if(n=p.charCodeAt(r+1),i&&n!==ot&&n!==at&&n!==it&&n!==ct&&n!==ut&&n!==lt&&(r+=1,It.test(p.charAt(r)))){for(;It.test(p.charAt(r+1));)r+=1;p.charCodeAt(r+1)===at&&(r+=1)}h=["word",p.slice(m,r+1),m,r],m=r;break;default:n===ot&&p.charCodeAt(m+1)===vt?(r=p.indexOf("*/",m+2)+1,0===r&&(d||t?r=p.length:v("comment")),h=["comment",p.slice(m,r+1),m,r],m=r):(St.lastIndex=m+1,St.test(p),r=0===St.lastIndex?p.length-1:St.lastIndex-2,h=["word",p.slice(m,r+1),m,r],g.push(h),m=r)}return m++,h},position:function(){return m}}},jt=Re,zt=kt,Vt=Nt,Gt=Bt;const Wt={empty:!0,space:!0};let Ht=Ve,Yt=class{constructor(e){this.input=e,this.root=new Vt,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:e,start:{column:1,line:1,offset:0}}}atrule(e){let t,n,r,s=new zt;s.name=e[1].slice(1),""===s.name&&this.unnamedAtrule(s,e),this.init(s,e[2]);let o=!1,i=!1,a=[],l=[];for(;!this.tokenizer.endOfFile();){if(t=(e=this.tokenizer.nextToken())[0],"("===t||"["===t?l.push("("===t?")":"]"):"{"===t&&l.length>0?l.push("}"):t===l[l.length-1]&&l.pop(),0===l.length){if(";"===t){s.source.end=this.getPosition(e[2]),s.source.end.offset++,this.semicolon=!0;break}if("{"===t){i=!0;break}if("}"===t){if(a.length>0){for(r=a.length-1,n=a[r];n&&"space"===n[0];)n=a[--r];n&&(s.source.end=this.getPosition(n[3]||n[2]),s.source.end.offset++)}this.end(e);break}a.push(e)}else a.push(e);if(this.tokenizer.endOfFile()){o=!0;break}}s.raws.between=this.spacesAndCommentsFromEnd(a),a.length?(s.raws.afterName=this.spacesAndCommentsFromStart(a),this.raw(s,"params",a),o&&(e=a[a.length-1],s.source.end=this.getPosition(e[3]||e[2]),s.source.end.offset++,this.spaces=s.raws.between,s.raws.between="")):(s.raws.afterName="",s.params=""),i&&(s.nodes=[],this.current=s)}checkMissedSemicolon(e){let t=this.colon(e);if(!1===t)return;let n,r=0;for(let s=t-1;s>=0&&(n=e[s],"space"===n[0]||(r+=1,2!==r));s--);throw this.input.error("Missed semicolon","word"===n[0]?n[3]+1:n[2])}colon(e){let t,n,r,s=0;for(let[o,i]of e.entries()){if(t=i,n=t[0],"("===n&&(s+=1),")"===n&&(s-=1),0===s&&":"===n){if(r){if("word"===r[0]&&"progid"===r[1])continue;return o}this.doubleColon(t)}r=t}return!1}comment(e){let t=new jt;this.init(t,e[2]),t.source.end=this.getPosition(e[3]||e[2]),t.source.end.offset++;let n=e[1].slice(2,-2);if(/^\s*$/.test(n))t.text="",t.raws.left=n,t.raws.right="";else{let e=n.match(/^(\s*)([^]*\S)(\s*)$/);t.text=e[2],t.raws.left=e[1],t.raws.right=e[3]}}createTokenizer(){this.tokenizer=Zt(this.input)}decl(e,t){let n=new Ut;this.init(n,e[0][2]);let r,s=e[e.length-1];for(";"===s[0]&&(this.semicolon=!0,e.pop()),n.source.end=this.getPosition(s[3]||s[2]||function(e){for(let t=e.length-1;t>=0;t--){let n=e[t],r=n[3]||n[2];if(r)return r}}(e)),n.source.end.offset++;"word"!==e[0][0];)1===e.length&&this.unknownWord(e),n.raws.before+=e.shift()[1];for(n.source.start=this.getPosition(e[0][2]),n.prop="";e.length;){let t=e[0][0];if(":"===t||"space"===t||"comment"===t)break;n.prop+=e.shift()[1]}for(n.raws.between="";e.length;){if(r=e.shift(),":"===r[0]){n.raws.between+=r[1];break}"word"===r[0]&&/\w/.test(r[1])&&this.unknownWord([r]),n.raws.between+=r[1]}"_"!==n.prop[0]&&"*"!==n.prop[0]||(n.raws.before+=n.prop[0],n.prop=n.prop.slice(1));let o,i=[];for(;e.length&&(o=e[0][0],"space"===o||"comment"===o);)i.push(e.shift());this.precheckMissedSemicolon(e);for(let t=e.length-1;t>=0;t--){if(r=e[t],"!important"===r[1].toLowerCase()){n.important=!0;let r=this.stringFrom(e,t);r=this.spacesFromEnd(e)+r," !important"!==r&&(n.raws.important=r);break}if("important"===r[1].toLowerCase()){let r=e.slice(0),s="";for(let e=t;e>0;e--){let t=r[e][0];if(0===s.trim().indexOf("!")&&"space"!==t)break;s=r.pop()[1]+s}0===s.trim().indexOf("!")&&(n.important=!0,n.raws.important=s,e=r)}if("space"!==r[0]&&"comment"!==r[0])break}e.some(e=>"space"!==e[0]&&"comment"!==e[0])&&(n.raws.between+=i.map(e=>e[1]).join(""),i=[]),this.raw(n,"value",i.concat(e),t),n.value.includes(":")&&!t&&this.checkMissedSemicolon(e)}doubleColon(e){throw this.input.error("Double colon",{offset:e[2]},{offset:e[2]+e[1].length})}emptyRule(e){let t=new Gt;this.init(t,e[2]),t.selector="",t.raws.between="",this.current=t}end(e){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(e[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(e)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(e){if(this.spaces+=e[1],this.current.nodes){let e=this.current.nodes[this.current.nodes.length-1];e&&"rule"===e.type&&!e.raws.ownSemicolon&&(e.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(e){let t=this.input.fromOffset(e);return{column:t.col,line:t.line,offset:e}}init(e,t){this.current.push(e),e.source={input:this.input,start:this.getPosition(t)},e.raws.before=this.spaces,this.spaces="","comment"!==e.type&&(this.semicolon=!1)}other(e){let t=!1,n=null,r=!1,s=null,o=[],i=e[1].startsWith("--"),a=[],l=e;for(;l;){if(n=l[0],a.push(l),"("===n||"["===n)s||(s=l),o.push("("===n?")":"]");else if(i&&r&&"{"===n)s||(s=l),o.push("}");else if(0===o.length){if(";"===n){if(r)return void this.decl(a,i);break}if("{"===n)return void this.rule(a);if("}"===n){this.tokenizer.back(a.pop()),t=!0;break}":"===n&&(r=!0)}else n===o[o.length-1]&&(o.pop(),0===o.length&&(s=null));l=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(t=!0),o.length>0&&this.unclosedBracket(s),t&&r){if(!i)for(;a.length&&(l=a[a.length-1][0],"space"===l||"comment"===l);)this.tokenizer.back(a.pop());this.decl(a,i)}else this.unknownWord(a)}parse(){let e;for(;!this.tokenizer.endOfFile();)switch(e=this.tokenizer.nextToken(),e[0]){case"space":this.spaces+=e[1];break;case";":this.freeSemicolon(e);break;case"}":this.end(e);break;case"comment":this.comment(e);break;case"at-word":this.atrule(e);break;case"{":this.emptyRule(e);break;default:this.other(e)}this.endFile()}precheckMissedSemicolon(){}raw(e,t,n,r){let s,o,i,a,l=n.length,c="",u=!0;for(let e=0;e<l;e+=1)s=n[e],o=s[0],"space"!==o||e!==l-1||r?"comment"===o?(a=n[e-1]?n[e-1][0]:"empty",i=n[e+1]?n[e+1][0]:"empty",Wt[a]||Wt[i]||","===c.slice(-1)?u=!1:c+=s[1]):c+=s[1]:u=!1;if(!u){let r=n.reduce((e,t)=>e+t[1],"");e.raws[t]={raw:r,value:c}}e[t]=c}rule(e){e.pop();let t=new Gt;this.init(t,e[0][2]),t.raws.between=this.spacesAndCommentsFromEnd(e),this.raw(t,"selector",e),this.current=t}spacesAndCommentsFromEnd(e){let t,n="";for(;e.length&&(t=e[e.length-1][0],"space"===t||"comment"===t);)n=e.pop()[1]+n;return n}spacesAndCommentsFromStart(e){let t,n="";for(;e.length&&(t=e[0][0],"space"===t||"comment"===t);)n+=e.shift()[1];return n}spacesFromEnd(e){let t,n="";for(;e.length&&(t=e[e.length-1][0],"space"===t);)n=e.pop()[1]+n;return n}stringFrom(e,t){let n="";for(let r=t;r<e.length;r++)n+=e[r][1];return e.splice(t,e.length-t),n}unclosedBlock(){let e=this.current.source.start;throw this.input.error("Unclosed block",e.line,e.column)}unclosedBracket(e){throw this.input.error("Unclosed bracket",{offset:e[2]},{offset:e[2]+1})}unexpectedClose(e){throw this.input.error("Unexpected }",{offset:e[2]},{offset:e[2]+1})}unknownWord(e){throw this.input.error("Unknown word",{offset:e[0][2]},{offset:e[0][2]+e[0][1].length})}unnamedAtrule(e,t){throw this.input.error("At-rule without name",{offset:t[2]},{offset:t[2]+t[1].length})}},Kt=ge;function Jt(e,t){let n=new Kt(e,t),r=new Yt(n);try{r.parse()}catch(e){throw"production"!==process.env.NODE_ENV&&"CssSyntaxError"===e.name&&t&&t.from&&(/\.scss$/i.test(t.from)?e.message+="\nYou tried to parse SCSS with the standard CSS parser; try again with the postcss-scss parser":/\.sass/i.test(t.from)?e.message+="\nYou tried to parse Sass with the standard CSS parser; try again with the postcss-sass parser":/\.less$/i.test(t.from)&&(e.message+="\nYou tried to parse Less with the standard CSS parser; try again with the postcss-less parser")),e}return r.root}var Xt=Jt;Jt.default=Jt,Ht.registerParse(Jt);let{isClean:qt,my:Qt}=O,$t=ke,en=D,tn=Ve,nn=Ke,rn=Xe,sn=tt,on=Xt,an=Nt;const ln={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},cn={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},un={Once:!0,postcssPlugin:!0,prepare:!0};function hn(e){return"object"==typeof e&&"function"==typeof e.then}function pn(e){let t=!1,n=ln[e.type];return"decl"===e.type?t=e.prop.toLowerCase():"atrule"===e.type&&(t=e.name.toLowerCase()),t&&e.append?[n,n+"-"+t,0,n+"Exit",n+"Exit-"+t]:t?[n,n+"-"+t,n+"Exit",n+"Exit-"+t]:e.append?[n,0,n+"Exit"]:[n,n+"Exit"]}function dn(e){let t;return t="document"===e.type?["Document",0,"DocumentExit"]:"root"===e.type?["Root",0,"RootExit"]:pn(e),{eventIndex:0,events:t,iterator:0,node:e,visitorIndex:0,visitors:[]}}function fn(e){return e[qt]=!1,e.nodes&&e.nodes.forEach(e=>fn(e)),e}let mn={},gn=class e{constructor(t,n,r){let s;if(this.stringified=!1,this.processed=!1,"object"!=typeof n||null===n||"root"!==n.type&&"document"!==n.type)if(n instanceof e||n instanceof sn)s=fn(n.root),n.map&&(void 0===r.map&&(r.map={}),r.map.inline||(r.map.inline=!1),r.map.prev=n.map);else{let e=on;r.syntax&&(e=r.syntax.parse),r.parser&&(e=r.parser),e.parse&&(e=e.parse);try{s=e(n,r)}catch(e){this.processed=!0,this.error=e}s&&!s[Qt]&&tn.rebuild(s)}else s=fn(n);this.result=new sn(t,s,r),this.helpers={...mn,postcss:mn,result:this.result},this.plugins=this.processor.plugins.map(e=>"object"==typeof e&&e.prepare?{...e,...e.prepare(this.result)}:e)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(e,t){let n=this.result.lastPlugin;try{if(t&&t.addToError(e),this.error=e,"CssSyntaxError"!==e.name||e.plugin){if(n.postcssVersion&&"production"!==process.env.NODE_ENV){let e=n.postcssPlugin,t=n.postcssVersion,r=this.result.processor.version,s=t.split("."),o=r.split(".");(s[0]!==o[0]||parseInt(s[1])>parseInt(o[1]))&&console.error("Unknown error from PostCSS plugin. Your current PostCSS version is "+r+", but "+e+" uses "+t+". Perhaps this is the source of the error below.")}}else e.plugin=n.postcssPlugin,e.setMessage()}catch(e){console&&console.error&&console.error(e)}return e}prepareVisitors(){this.listeners={};let e=(e,t,n)=>{this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push([e,n])};for(let t of this.plugins)if("object"==typeof t)for(let n in t){if(!cn[n]&&/^[A-Z]/.test(n))throw new Error(`Unknown event ${n} in ${t.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!un[n])if("object"==typeof t[n])for(let r in t[n])e(t,"*"===r?n:n+"-"+r.toLowerCase(),t[n][r]);else"function"==typeof t[n]&&e(t,n,t[n])}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let e=0;e<this.plugins.length;e++){let t=this.plugins[e],n=this.runOnRoot(t);if(hn(n))try{await n}catch(e){throw this.handleError(e)}}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[qt];){e[qt]=!0;let t=[dn(e)];for(;t.length>0;){let e=this.visitTick(t);if(hn(e))try{await e}catch(e){let n=t[t.length-1].node;throw this.handleError(e,n)}}}if(this.listeners.OnceExit)for(let[t,n]of this.listeners.OnceExit){this.result.lastPlugin=t;try{if("document"===e.type){let t=e.nodes.map(e=>n(e,this.helpers));await Promise.all(t)}else await n(e,this.helpers)}catch(e){throw this.handleError(e)}}}return this.processed=!0,this.stringify()}runOnRoot(e){this.result.lastPlugin=e;try{if("object"==typeof e&&e.Once){if("document"===this.result.root.type){let t=this.result.root.nodes.map(t=>e.Once(t,this.helpers));return hn(t[0])?Promise.all(t):t}return e.Once(this.result.root,this.helpers)}if("function"==typeof e)return e(this.result.root,this.result)}catch(e){throw this.handleError(e)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let e=this.result.opts,t=en;e.syntax&&(t=e.syntax.stringify),e.stringifier&&(t=e.stringifier),t.stringify&&(t=t.stringify);let n=new $t(t,this.result.root,this.result.opts).generate();return this.result.css=n[0],this.result.map=n[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let e of this.plugins){if(hn(this.runOnRoot(e)))throw this.getAsyncError()}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[qt];)e[qt]=!0,this.walkSync(e);if(this.listeners.OnceExit)if("document"===e.type)for(let t of e.nodes)this.visitSync(this.listeners.OnceExit,t);else this.visitSync(this.listeners.OnceExit,e)}return this.result}then(e,t){return"production"!==process.env.NODE_ENV&&("from"in this.opts||rn("Without `from` option PostCSS could generate wrong source map and will not find Browserslist config. Set it to CSS file path or to `undefined` to prevent this warning.")),this.async().then(e,t)}toString(){return this.css}visitSync(e,t){for(let[n,r]of e){let e;this.result.lastPlugin=n;try{e=r(t,this.helpers)}catch(e){throw this.handleError(e,t.proxyOf)}if("root"!==t.type&&"document"!==t.type&&!t.parent)return!0;if(hn(e))throw this.getAsyncError()}}visitTick(e){let t=e[e.length-1],{node:n,visitors:r}=t;if("root"!==n.type&&"document"!==n.type&&!n.parent)return void e.pop();if(r.length>0&&t.visitorIndex<r.length){let[e,s]=r[t.visitorIndex];t.visitorIndex+=1,t.visitorIndex===r.length&&(t.visitors=[],t.visitorIndex=0),this.result.lastPlugin=e;try{return s(n.toProxy(),this.helpers)}catch(e){throw this.handleError(e,n)}}if(0!==t.iterator){let r,s=t.iterator;for(;r=n.nodes[n.indexes[s]];)if(n.indexes[s]+=1,!r[qt])return r[qt]=!0,void e.push(dn(r));t.iterator=0,delete n.indexes[s]}let s=t.events;for(;t.eventIndex<s.length;){let e=s[t.eventIndex];if(t.eventIndex+=1,0===e)return void(n.nodes&&n.nodes.length&&(n[qt]=!0,t.iterator=n.getIterator()));if(this.listeners[e])return void(t.visitors=this.listeners[e])}e.pop()}walkSync(e){e[qt]=!0;let t=pn(e);for(let n of t)if(0===n)e.nodes&&e.each(e=>{e[qt]||this.walkSync(e)});else{let t=this.listeners[n];if(t&&this.visitSync(t,e.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}};gn.registerPostcss=e=>{mn=e};var yn=gn;gn.default=gn,an.registerLazyResult(gn),nn.registerLazyResult(gn);let vn=ke,bn=D,wn=Xe,Cn=Xt;const Sn=tt;let _n=class{constructor(e,t,n){let r;t=t.toString(),this.stringified=!1,this._processor=e,this._css=t,this._opts=n,this._map=void 0;let s=bn;this.result=new Sn(this._processor,r,this._opts),this.result.css=t;let o=this;Object.defineProperty(this.result,"root",{get:()=>o.root});let i=new vn(s,r,this._opts,t);if(i.isMap()){let[e,t]=i.generate();e&&(this.result.css=e),t&&(this.result.map=t)}else i.clearAnnotation(),this.result.css=i.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}sync(){if(this.error)throw this.error;return this.result}then(e,t){return"production"!==process.env.NODE_ENV&&("from"in this._opts||wn("Without `from` option PostCSS could generate wrong source map and will not find Browserslist config. Set it to CSS file path or to `undefined` to prevent this warning.")),this.async().then(e,t)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let e,t=Cn;try{e=t(this._css,this._opts)}catch(e){this.error=e}if(this.error)throw this.error;return this._root=e,e}get[Symbol.toStringTag](){return"NoWorkResult"}};var In=_n;_n.default=_n;let An=In,En=yn,kn=Ke,Tn=Nt,On=class{constructor(e=[]){this.version="8.4.38",this.plugins=this.normalize(e)}normalize(e){let t=[];for(let n of e)if(!0===n.postcss?n=n():n.postcss&&(n=n.postcss),"object"==typeof n&&Array.isArray(n.plugins))t=t.concat(n.plugins);else if("object"==typeof n&&n.postcssPlugin)t.push(n);else if("function"==typeof n)t.push(n);else{if("object"!=typeof n||!n.parse&&!n.stringify)throw new Error(n+" is not a PostCSS plugin");if("production"!==process.env.NODE_ENV)throw new Error("PostCSS syntaxes cannot be used as plugins. Instead, please use one of the syntax/parser/stringifier options as outlined in your PostCSS runner documentation.")}return t}process(e,t={}){return this.plugins.length||t.parser||t.stringifier||t.syntax?new En(this,e,t):new An(this,e,t)}use(e){return this.plugins=this.plugins.concat(this.normalize([e])),this}};var Rn=On;On.default=On,Tn.registerProcessor(On),kn.registerProcessor(On);let xn=H,Nn=te,Mn=Re,Ln=kt,Dn=ge,Pn=Nt,Fn=Bt;function Bn(e,t){if(Array.isArray(e))return e.map(e=>Bn(e));let{inputs:n,...r}=e;if(n){t=[];for(let e of n){let n={...e,__proto__:Dn.prototype};n.map&&(n.map={...n.map,__proto__:Nn.prototype}),t.push(n)}}if(r.nodes&&(r.nodes=e.nodes.map(e=>Bn(e,t))),r.source){let{inputId:e,...n}=r.source;r.source=n,null!=e&&(r.source.input=t[e])}if("root"===r.type)return new Pn(r);if("decl"===r.type)return new xn(r);if("rule"===r.type)return new Fn(r);if("comment"===r.type)return new Mn(r);if("atrule"===r.type)return new Ln(r);throw new Error("Unknown node type: "+e.type)}var Un=Bn;Bn.default=Bn;let Zn=T,jn=H,zn=yn,Vn=Ve,Gn=Rn,Wn=D,Hn=Un,Yn=Ke,Kn=Qe,Jn=Re,Xn=kt,qn=tt,Qn=ge,$n=Xt,er=Lt,tr=Bt,nr=Nt,rr=V;function sr(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),new Gn(e)}sr.plugin=function(e,t){let n,r=!1;function s(...n){console&&console.warn&&!r&&(r=!0,console.warn(e+": postcss.plugin was deprecated. Migration guide:\nhttps://evilmartians.com/chronicles/postcss-8-plugin-migration"),process.env.LANG&&process.env.LANG.startsWith("cn")&&console.warn(e+": éé¢ postcss.plugin è¢«å¼ç¨. è¿ç§»æå:\nhttps://www.w3ctech.com/topic/2226"));let s=t(...n);return s.postcssPlugin=e,s.postcssVersion=(new Gn).version,s}return Object.defineProperty(s,"postcss",{get:()=>(n||(n=s()),n)}),s.process=function(e,t,n){return sr([s(n)]).process(e,t)},s},sr.stringify=Wn,sr.parse=$n,sr.fromJSON=Hn,sr.list=er,sr.comment=e=>new Jn(e),sr.atRule=e=>new Xn(e),sr.decl=e=>new jn(e),sr.rule=e=>new tr(e),sr.root=e=>new nr(e),sr.document=e=>new Yn(e),sr.CssSyntaxError=Zn,sr.Declaration=jn,sr.Container=Vn,sr.Processor=Gn,sr.Document=Yn,sr.Comment=Jn,sr.Warning=Kn,sr.AtRule=Xn,sr.Result=qn,sr.Input=Qn,sr.Rule=tr,sr.Root=nr,sr.Node=rr,zn.registerPostcss(sr);var or=sr;sr.default=sr;const ir=v(or);ir.stringify,ir.fromJSON,ir.plugin,ir.parse,ir.list,ir.document,ir.comment,ir.atRule,ir.rule,ir.decl,ir.root,ir.CssSyntaxError,ir.Declaration,ir.Container,ir.Processor,ir.Document,ir.Comment,ir.Warning,ir.AtRule,ir.Result,ir.Input,ir.Rule,ir.Root,ir.Node;var ar=Object.defineProperty,lr=(e,t,n)=>((e,t,n)=>t in e?ar(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);function cr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ur(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}),n}var hr={exports:{}},pr=String,dr=function(){return{isColorSupported:!1,reset:pr,bold:pr,dim:pr,italic:pr,underline:pr,inverse:pr,hidden:pr,strikethrough:pr,black:pr,red:pr,green:pr,yellow:pr,blue:pr,magenta:pr,cyan:pr,white:pr,gray:pr,bgBlack:pr,bgRed:pr,bgGreen:pr,bgYellow:pr,bgBlue:pr,bgMagenta:pr,bgCyan:pr,bgWhite:pr}};hr.exports=dr(),hr.exports.createColors=dr;var fr=hr.exports;const mr=ur(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));let gr=fr,yr=mr,vr=class e extends Error{constructor(t,n,r,s,o,i){super(t),this.name="CssSyntaxError",this.reason=t,o&&(this.file=o),s&&(this.source=s),i&&(this.plugin=i),void 0!==n&&void 0!==r&&("number"==typeof n?(this.line=n,this.column=r):(this.line=n.line,this.column=n.column,this.endLine=r.line,this.endColumn=r.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,e)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",void 0!==this.line&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(e){if(!this.source)return"";let t=this.source;null==e&&(e=gr.isColorSupported),yr&&e&&(t=yr(t));let n,r,s=t.split(/\r?\n/),o=Math.max(this.line-3,0),i=Math.min(this.line+2,s.length),a=String(i).length;if(e){let{bold:e,gray:t,red:s}=gr.createColors(!0);n=t=>e(s(t)),r=e=>t(e)}else n=r=e=>e;return s.slice(o,i).map((e,t)=>{let s=o+1+t,i=" "+(" "+s).slice(-a)+" | ";if(s===this.line){let t=r(i.replace(/\d/g," "))+e.slice(0,this.column-1).replace(/[^\t]/g," ");return n(">")+r(i)+e+"\n "+t+n("^")}return" "+r(i)+e}).join("\n")}toString(){let e=this.showSourceCode();return e&&(e="\n\n"+e+"\n"),this.name+": "+this.message+e}};var br=vr;vr.default=vr;var wr={};wr.isClean=Symbol("isClean"),wr.my=Symbol("my");const Cr={after:"\n",beforeClose:"\n",beforeComment:"\n",beforeDecl:"\n",beforeOpen:" ",beforeRule:"\n",colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};let Sr=class{constructor(e){this.builder=e}atrule(e,t){let n="@"+e.name,r=e.params?this.rawValue(e,"params"):"";if(void 0!==e.raws.afterName?n+=e.raws.afterName:r&&(n+=" "),e.nodes)this.block(e,n+r);else{let s=(e.raws.between||"")+(t?";":"");this.builder(n+r+s,e)}}beforeAfter(e,t){let n;n="decl"===e.type?this.raw(e,null,"beforeDecl"):"comment"===e.type?this.raw(e,null,"beforeComment"):"before"===t?this.raw(e,null,"beforeRule"):this.raw(e,null,"beforeClose");let r=e.parent,s=0;for(;r&&"root"!==r.type;)s+=1,r=r.parent;if(n.includes("\n")){let t=this.raw(e,null,"indent");if(t.length)for(let e=0;e<s;e++)n+=t}return n}block(e,t){let n,r=this.raw(e,"between","beforeOpen");this.builder(t+r+"{",e,"start"),e.nodes&&e.nodes.length?(this.body(e),n=this.raw(e,"after")):n=this.raw(e,"after","emptyBody"),n&&this.builder(n),this.builder("}",e,"end")}body(e){let t=e.nodes.length-1;for(;t>0&&"comment"===e.nodes[t].type;)t-=1;let n=this.raw(e,"semicolon");for(let r=0;r<e.nodes.length;r++){let s=e.nodes[r],o=this.raw(s,"before");o&&this.builder(o),this.stringify(s,t!==r||n)}}comment(e){let t=this.raw(e,"left","commentLeft"),n=this.raw(e,"right","commentRight");this.builder("/*"+t+e.text+n+"*/",e)}decl(e,t){let n=this.raw(e,"between","colon"),r=e.prop+n+this.rawValue(e,"value");e.important&&(r+=e.raws.important||" !important"),t&&(r+=";"),this.builder(r,e)}document(e){this.body(e)}raw(e,t,n){let r;if(n||(n=t),t&&(r=e.raws[t],void 0!==r))return r;let s=e.parent;if("before"===n){if(!s||"root"===s.type&&s.first===e)return"";if(s&&"document"===s.type)return""}if(!s)return Cr[n];let o=e.root();if(o.rawCache||(o.rawCache={}),void 0!==o.rawCache[n])return o.rawCache[n];if("before"===n||"after"===n)return this.beforeAfter(e,n);{let s="raw"+((i=n)[0].toUpperCase()+i.slice(1));this[s]?r=this[s](o,e):o.walk(e=>{if(r=e.raws[t],void 0!==r)return!1})}var i;return void 0===r&&(r=Cr[n]),o.rawCache[n]=r,r}rawBeforeClose(e){let t;return e.walk(e=>{if(e.nodes&&e.nodes.length>0&&void 0!==e.raws.after)return t=e.raws.after,t.includes("\n")&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawBeforeComment(e,t){let n;return e.walkComments(e=>{if(void 0!==e.raws.before)return n=e.raws.before,n.includes("\n")&&(n=n.replace(/[^\n]+$/,"")),!1}),void 0===n?n=this.raw(t,null,"beforeDecl"):n&&(n=n.replace(/\S/g,"")),n}rawBeforeDecl(e,t){let n;return e.walkDecls(e=>{if(void 0!==e.raws.before)return n=e.raws.before,n.includes("\n")&&(n=n.replace(/[^\n]+$/,"")),!1}),void 0===n?n=this.raw(t,null,"beforeRule"):n&&(n=n.replace(/\S/g,"")),n}rawBeforeOpen(e){let t;return e.walk(e=>{if("decl"!==e.type&&(t=e.raws.between,void 0!==t))return!1}),t}rawBeforeRule(e){let t;return e.walk(n=>{if(n.nodes&&(n.parent!==e||e.first!==n)&&void 0!==n.raws.before)return t=n.raws.before,t.includes("\n")&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawColon(e){let t;return e.walkDecls(e=>{if(void 0!==e.raws.between)return t=e.raws.between.replace(/[^\s:]/g,""),!1}),t}rawEmptyBody(e){let t;return e.walk(e=>{if(e.nodes&&0===e.nodes.length&&(t=e.raws.after,void 0!==t))return!1}),t}rawIndent(e){if(e.raws.indent)return e.raws.indent;let t;return e.walk(n=>{let r=n.parent;if(r&&r!==e&&r.parent&&r.parent===e&&void 0!==n.raws.before){let e=n.raws.before.split("\n");return t=e[e.length-1],t=t.replace(/\S/g,""),!1}}),t}rawSemicolon(e){let t;return e.walk(e=>{if(e.nodes&&e.nodes.length&&"decl"===e.last.type&&(t=e.raws.semicolon,void 0!==t))return!1}),t}rawValue(e,t){let n=e[t],r=e.raws[t];return r&&r.value===n?r.raw:n}root(e){this.body(e),e.raws.after&&this.builder(e.raws.after)}rule(e){this.block(e,this.rawValue(e,"selector")),e.raws.ownSemicolon&&this.builder(e.raws.ownSemicolon,e,"end")}stringify(e,t){if(!this[e.type])throw new Error("Unknown AST node type "+e.type+". Maybe you need to change PostCSS stringifier.");this[e.type](e,t)}};var _r=Sr;Sr.default=Sr;let Ir=_r;function Ar(e,t){new Ir(t).stringify(e)}var Er=Ar;Ar.default=Ar;let{isClean:kr,my:Tr}=wr,Or=br,Rr=_r,xr=Er;function Nr(e,t){let n=new e.constructor;for(let r in e){if(!Object.prototype.hasOwnProperty.call(e,r))continue;if("proxyCache"===r)continue;let s=e[r],o=typeof s;"parent"===r&&"object"===o?t&&(n[r]=t):"source"===r?n[r]=s:Array.isArray(s)?n[r]=s.map(e=>Nr(e,n)):("object"===o&&null!==s&&(s=Nr(s)),n[r]=s)}return n}let Mr=class{constructor(e={}){this.raws={},this[kr]=!1,this[Tr]=!0;for(let t in e)if("nodes"===t){this.nodes=[];for(let n of e[t])"function"==typeof n.clone?this.append(n.clone()):this.append(n)}else this[t]=e[t]}addToError(e){if(e.postcssNode=this,e.stack&&this.source&&/\n\s{4}at /.test(e.stack)){let t=this.source;e.stack=e.stack.replace(/\n\s{4}at /,`$&${t.input.from}:${t.start.line}:${t.start.column}$&`)}return e}after(e){return this.parent.insertAfter(this,e),this}assign(e={}){for(let t in e)this[t]=e[t];return this}before(e){return this.parent.insertBefore(this,e),this}cleanRaws(e){delete this.raws.before,delete this.raws.after,e||delete this.raws.between}clone(e={}){let t=Nr(this);for(let n in e)t[n]=e[n];return t}cloneAfter(e={}){let t=this.clone(e);return this.parent.insertAfter(this,t),t}cloneBefore(e={}){let t=this.clone(e);return this.parent.insertBefore(this,t),t}error(e,t={}){if(this.source){let{end:n,start:r}=this.rangeBy(t);return this.source.input.error(e,{column:r.column,line:r.line},{column:n.column,line:n.line},t)}return new Or(e)}getProxyProcessor(){return{get:(e,t)=>"proxyOf"===t?e:"root"===t?()=>e.root().toProxy():e[t],set:(e,t,n)=>(e[t]===n||(e[t]=n,"prop"!==t&&"value"!==t&&"name"!==t&&"params"!==t&&"important"!==t&&"text"!==t||e.markDirty()),!0)}}markDirty(){if(this[kr]){this[kr]=!1;let e=this;for(;e=e.parent;)e[kr]=!1}}next(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e+1]}positionBy(e,t){let n=this.source.start;if(e.index)n=this.positionInside(e.index,t);else if(e.word){let r=(t=this.toString()).indexOf(e.word);-1!==r&&(n=this.positionInside(r,t))}return n}positionInside(e,t){let n=t||this.toString(),r=this.source.start.column,s=this.source.start.line;for(let t=0;t<e;t++)"\n"===n[t]?(r=1,s+=1):r+=1;return{column:r,line:s}}prev(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e-1]}rangeBy(e){let t={column:this.source.start.column,line:this.source.start.line},n=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:t.column+1,line:t.line};if(e.word){let r=this.toString(),s=r.indexOf(e.word);-1!==s&&(t=this.positionInside(s,r),n=this.positionInside(s+e.word.length,r))}else e.start?t={column:e.start.column,line:e.start.line}:e.index&&(t=this.positionInside(e.index)),e.end?n={column:e.end.column,line:e.end.line}:"number"==typeof e.endIndex?n=this.positionInside(e.endIndex):e.index&&(n=this.positionInside(e.index+1));return(n.line<t.line||n.line===t.line&&n.column<=t.column)&&(n={column:t.column+1,line:t.line}),{end:n,start:t}}raw(e,t){return(new Rr).raw(this,e,t)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...e){if(this.parent){let t=this,n=!1;for(let r of e)r===this?n=!0:n?(this.parent.insertAfter(t,r),t=r):this.parent.insertBefore(t,r);n||this.remove()}return this}root(){let e=this;for(;e.parent&&"document"!==e.parent.type;)e=e.parent;return e}toJSON(e,t){let n={},r=null==t;t=t||new Map;let s=0;for(let e in this){if(!Object.prototype.hasOwnProperty.call(this,e))continue;if("parent"===e||"proxyCache"===e)continue;let r=this[e];if(Array.isArray(r))n[e]=r.map(e=>"object"==typeof e&&e.toJSON?e.toJSON(null,t):e);else if("object"==typeof r&&r.toJSON)n[e]=r.toJSON(null,t);else if("source"===e){let o=t.get(r.input);null==o&&(o=s,t.set(r.input,s),s++),n[e]={end:r.end,inputId:o,start:r.start}}else n[e]=r}return r&&(n.inputs=[...t.keys()].map(e=>e.toJSON())),n}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(e=xr){e.stringify&&(e=e.stringify);let t="";return e(this,e=>{t+=e}),t}warn(e,t,n){let r={node:this};for(let e in n)r[e]=n[e];return e.warn(t,r)}get proxyOf(){return this}};var Lr=Mr;Mr.default=Mr;let Dr=Lr,Pr=class extends Dr{constructor(e){e&&void 0!==e.value&&"string"!=typeof e.value&&(e={...e,value:String(e.value)}),super(e),this.type="decl"}get variable(){return this.prop.startsWith("--")||"$"===this.prop[0]}};var Fr=Pr;Pr.default=Pr;var Br={nanoid:(e=21)=>{let t="",n=e;for(;n--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t}};let{SourceMapConsumer:Ur,SourceMapGenerator:Zr}=mr,{existsSync:jr,readFileSync:zr}=mr,{dirname:Vr,join:Gr}=mr;let Wr=class{constructor(e,t){if(!1===t.map)return;this.loadAnnotation(e),this.inline=this.startWith(this.annotation,"data:");let n=t.map?t.map.prev:void 0,r=this.loadMap(t.from,n);!this.mapFile&&t.from&&(this.mapFile=t.from),this.mapFile&&(this.root=Vr(this.mapFile)),r&&(this.text=r)}consumer(){return this.consumerCache||(this.consumerCache=new Ur(this.text)),this.consumerCache}decodeInline(e){if(/^data:application\/json;charset=utf-?8,/.test(e)||/^data:application\/json,/.test(e))return decodeURIComponent(e.substr(RegExp.lastMatch.length));if(/^data:application\/json;charset=utf-?8;base64,/.test(e)||/^data:application\/json;base64,/.test(e))return t=e.substr(RegExp.lastMatch.length),Buffer?Buffer.from(t,"base64").toString():window.atob(t);var t;let n=e.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+n)}getAnnotationURL(e){return e.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(e){return"object"==typeof e&&("string"==typeof e.mappings||"string"==typeof e._mappings||Array.isArray(e.sections))}loadAnnotation(e){let t=e.match(/\/\*\s*# sourceMappingURL=/gm);if(!t)return;let n=e.lastIndexOf(t.pop()),r=e.indexOf("*/",n);n>-1&&r>-1&&(this.annotation=this.getAnnotationURL(e.substring(n,r)))}loadFile(e){if(this.root=Vr(e),jr(e))return this.mapFile=e,zr(e,"utf-8").toString().trim()}loadMap(e,t){if(!1===t)return!1;if(t){if("string"==typeof t)return t;if("function"!=typeof t){if(t instanceof Ur)return Zr.fromSourceMap(t).toString();if(t instanceof Zr)return t.toString();if(this.isMap(t))return JSON.stringify(t);throw new Error("Unsupported previous source map format: "+t.toString())}{let n=t(e);if(n){let e=this.loadFile(n);if(!e)throw new Error("Unable to load previous source map: "+n.toString());return e}}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let t=this.annotation;return e&&(t=Gr(Vr(e),t)),this.loadFile(t)}}}startWith(e,t){return!!e&&e.substr(0,t.length)===t}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}};var Hr=Wr;Wr.default=Wr;let{SourceMapConsumer:Yr,SourceMapGenerator:Kr}=mr,{fileURLToPath:Jr,pathToFileURL:Xr}=mr,{isAbsolute:qr,resolve:Qr}=mr,{nanoid:$r}=Br,es=mr,ts=br,ns=Hr,rs=Symbol("fromOffsetCache"),ss=Boolean(Yr&&Kr),os=Boolean(Qr&&qr),is=class{constructor(e,t={}){if(null==e||"object"==typeof e&&!e.toString)throw new Error(`PostCSS received ${e} instead of CSS string`);if(this.css=e.toString(),"\ufeff"===this.css[0]||"ï¿¾"===this.css[0]?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,t.from&&(!os||/^\w+:\/\//.test(t.from)||qr(t.from)?this.file=t.from:this.file=Qr(t.from)),os&&ss){let e=new ns(this.css,t);if(e.text){this.map=e;let t=e.consumer().file;!this.file&&t&&(this.file=this.mapResolve(t))}}this.file||(this.id="<input css "+$r(6)+">"),this.map&&(this.map.file=this.from)}error(e,t,n,r={}){let s,o,i;if(t&&"object"==typeof t){let e=t,r=n;if("number"==typeof e.offset){let r=this.fromOffset(e.offset);t=r.line,n=r.col}else t=e.line,n=e.column;if("number"==typeof r.offset){let e=this.fromOffset(r.offset);o=e.line,i=e.col}else o=r.line,i=r.column}else if(!n){let e=this.fromOffset(t);t=e.line,n=e.col}let a=this.origin(t,n,o,i);return s=a?new ts(e,void 0===a.endLine?a.line:{column:a.column,line:a.line},void 0===a.endLine?a.column:{column:a.endColumn,line:a.endLine},a.source,a.file,r.plugin):new ts(e,void 0===o?t:{column:n,line:t},void 0===o?n:{column:i,line:o},this.css,this.file,r.plugin),s.input={column:n,endColumn:i,endLine:o,line:t,source:this.css},this.file&&(Xr&&(s.input.url=Xr(this.file).toString()),s.input.file=this.file),s}fromOffset(e){let t,n;if(this[rs])n=this[rs];else{let e=this.css.split("\n");n=new Array(e.length);let t=0;for(let r=0,s=e.length;r<s;r++)n[r]=t,t+=e[r].length+1;this[rs]=n}t=n[n.length-1];let r=0;if(e>=t)r=n.length-1;else{let t,s=n.length-2;for(;r<s;)if(t=r+(s-r>>1),e<n[t])s=t-1;else{if(!(e>=n[t+1])){r=t;break}r=t+1}}return{col:e-n[r]+1,line:r+1}}mapResolve(e){return/^\w+:\/\//.test(e)?e:Qr(this.map.consumer().sourceRoot||this.map.root||".",e)}origin(e,t,n,r){if(!this.map)return!1;let s,o,i=this.map.consumer(),a=i.originalPositionFor({column:t,line:e});if(!a.source)return!1;"number"==typeof n&&(s=i.originalPositionFor({column:r,line:n})),o=qr(a.source)?Xr(a.source):new URL(a.source,this.map.consumer().sourceRoot||Xr(this.map.mapFile));let l={column:a.column,endColumn:s&&s.column,endLine:s&&s.line,line:a.line,url:o.toString()};if("file:"===o.protocol){if(!Jr)throw new Error("file: protocol is not available in this PostCSS build");l.file=Jr(o)}let c=i.sourceContentFor(a.source);return c&&(l.source=c),l}toJSON(){let e={};for(let t of["hasBOM","css","file","id"])null!=this[t]&&(e[t]=this[t]);return this.map&&(e.map={...this.map},e.map.consumerCache&&(e.map.consumerCache=void 0)),e}get from(){return this.file||this.id}};var as=is;is.default=is,es&&es.registerInput&&es.registerInput(is);let{SourceMapConsumer:ls,SourceMapGenerator:cs}=mr,{dirname:us,relative:hs,resolve:ps,sep:ds}=mr,{pathToFileURL:fs}=mr,ms=as,gs=Boolean(ls&&cs),ys=Boolean(us&&ps&&hs&&ds);var vs=class{constructor(e,t,n,r){this.stringify=e,this.mapOpts=n.map||{},this.root=t,this.opts=n,this.css=r,this.originalCSS=r,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let e;e=this.isInline()?"data:application/json;base64,"+this.toBase64(this.map.toString()):"string"==typeof this.mapOpts.annotation?this.mapOpts.annotation:"function"==typeof this.mapOpts.annotation?this.mapOpts.annotation(this.opts.to,this.root):this.outputFile()+".map";let t="\n";this.css.includes("\r\n")&&(t="\r\n"),this.css+=t+"/*# sourceMappingURL="+e+" */"}applyPrevMaps(){for(let e of this.previous()){let t,n=this.toUrl(this.path(e.file)),r=e.root||us(e.file);!1===this.mapOpts.sourcesContent?(t=new ls(e.text),t.sourcesContent&&(t.sourcesContent=null)):t=e.consumer(),this.map.applySourceMap(t,n,this.toUrl(this.path(r)))}}clearAnnotation(){if(!1!==this.mapOpts.annotation)if(this.root){let e;for(let t=this.root.nodes.length-1;t>=0;t--)e=this.root.nodes[t],"comment"===e.type&&0===e.text.indexOf("# sourceMappingURL=")&&this.root.removeChild(t)}else this.css&&(this.css=this.css.replace(/\n*?\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),ys&&gs&&this.isMap())return this.generateMap();{let e="";return this.stringify(this.root,t=>{e+=t}),[e]}}generateMap(){if(this.root)this.generateString();else if(1===this.previous().length){let e=this.previous()[0].consumer();e.file=this.outputFile(),this.map=cs.fromSourceMap(e,{ignoreInvalidMapping:!0})}else this.map=new cs({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new cs({file:this.outputFile(),ignoreInvalidMapping:!0});let e,t,n=1,r=1,s="<no source>",o={generated:{column:0,line:0},original:{column:0,line:0},source:""};this.stringify(this.root,(i,a,l)=>{if(this.css+=i,a&&"end"!==l&&(o.generated.line=n,o.generated.column=r-1,a.source&&a.source.start?(o.source=this.sourcePath(a),o.original.line=a.source.start.line,o.original.column=a.source.start.column-1,this.map.addMapping(o)):(o.source=s,o.original.line=1,o.original.column=0,this.map.addMapping(o))),e=i.match(/\n/g),e?(n+=e.length,t=i.lastIndexOf("\n"),r=i.length-t):r+=i.length,a&&"start"!==l){let e=a.parent||{raws:{}};("decl"===a.type||"atrule"===a.type&&!a.nodes)&&a===e.last&&!e.raws.semicolon||(a.source&&a.source.end?(o.source=this.sourcePath(a),o.original.line=a.source.end.line,o.original.column=a.source.end.column-1,o.generated.line=n,o.generated.column=r-2,this.map.addMapping(o)):(o.source=s,o.original.line=1,o.original.column=0,o.generated.line=n,o.generated.column=r-1,this.map.addMapping(o)))}})}isAnnotation(){return!!this.isInline()||(void 0!==this.mapOpts.annotation?this.mapOpts.annotation:!this.previous().length||this.previous().some(e=>e.annotation))}isInline(){if(void 0!==this.mapOpts.inline)return this.mapOpts.inline;let e=this.mapOpts.annotation;return(void 0===e||!0===e)&&(!this.previous().length||this.previous().some(e=>e.inline))}isMap(){return void 0!==this.opts.map?!!this.opts.map:this.previous().length>0}isSourcesContent(){return void 0!==this.mapOpts.sourcesContent?this.mapOpts.sourcesContent:!this.previous().length||this.previous().some(e=>e.withContent())}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(e){if(this.mapOpts.absolute)return e;if(60===e.charCodeAt(0))return e;if(/^\w+:\/\//.test(e))return e;let t=this.memoizedPaths.get(e);if(t)return t;let n=this.opts.to?us(this.opts.to):".";"string"==typeof this.mapOpts.annotation&&(n=us(ps(n,this.mapOpts.annotation)));let r=hs(n,e);return this.memoizedPaths.set(e,r),r}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(e=>{if(e.source&&e.source.input.map){let t=e.source.input.map;this.previousMaps.includes(t)||this.previousMaps.push(t)}});else{let e=new ms(this.originalCSS,this.opts);e.map&&this.previousMaps.push(e.map)}return this.previousMaps}setSourcesContent(){let e={};if(this.root)this.root.walk(t=>{if(t.source){let n=t.source.input.from;if(n&&!e[n]){e[n]=!0;let r=this.usesFileUrls?this.toFileUrl(n):this.toUrl(this.path(n));this.map.setSourceContent(r,t.source.input.css)}}});else if(this.css){let e=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(e,this.css)}}sourcePath(e){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(e.source.input.from):this.toUrl(this.path(e.source.input.from))}toBase64(e){return Buffer?Buffer.from(e).toString("base64"):window.btoa(unescape(encodeURIComponent(e)))}toFileUrl(e){let t=this.memoizedFileURLs.get(e);if(t)return t;if(fs){let t=fs(e).toString();return this.memoizedFileURLs.set(e,t),t}throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(e){let t=this.memoizedURLs.get(e);if(t)return t;"\\"===ds&&(e=e.replace(/\\/g,"/"));let n=encodeURI(e).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(e,n),n}};let bs=Lr,ws=class extends bs{constructor(e){super(e),this.type="comment"}};var Cs=ws;ws.default=ws;let Ss,_s,Is,As,{isClean:Es,my:ks}=wr,Ts=Fr,Os=Cs,Rs=Lr;function xs(e){return e.map(e=>(e.nodes&&(e.nodes=xs(e.nodes)),delete e.source,e))}function Ns(e){if(e[Es]=!1,e.proxyOf.nodes)for(let t of e.proxyOf.nodes)Ns(t)}let Ms=class e extends Rs{append(...e){for(let t of e){let e=this.normalize(t,this.last);for(let t of e)this.proxyOf.nodes.push(t)}return this.markDirty(),this}cleanRaws(e){if(super.cleanRaws(e),this.nodes)for(let t of this.nodes)t.cleanRaws(e)}each(e){if(!this.proxyOf.nodes)return;let t,n,r=this.getIterator();for(;this.indexes[r]<this.proxyOf.nodes.length&&(t=this.indexes[r],n=e(this.proxyOf.nodes[t],t),!1!==n);)this.indexes[r]+=1;return delete this.indexes[r],n}every(e){return this.nodes.every(e)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let e=this.lastEach;return this.indexes[e]=0,e}getProxyProcessor(){return{get:(e,t)=>"proxyOf"===t?e:e[t]?"each"===t||"string"==typeof t&&t.startsWith("walk")?(...n)=>e[t](...n.map(e=>"function"==typeof e?(t,n)=>e(t.toProxy(),n):e)):"every"===t||"some"===t?n=>e[t]((e,...t)=>n(e.toProxy(),...t)):"root"===t?()=>e.root().toProxy():"nodes"===t?e.nodes.map(e=>e.toProxy()):"first"===t||"last"===t?e[t].toProxy():e[t]:e[t],set:(e,t,n)=>(e[t]===n||(e[t]=n,"name"!==t&&"params"!==t&&"selector"!==t||e.markDirty()),!0)}}index(e){return"number"==typeof e?e:(e.proxyOf&&(e=e.proxyOf),this.proxyOf.nodes.indexOf(e))}insertAfter(e,t){let n,r=this.index(e),s=this.normalize(t,this.proxyOf.nodes[r]).reverse();r=this.index(e);for(let e of s)this.proxyOf.nodes.splice(r+1,0,e);for(let e in this.indexes)n=this.indexes[e],r<n&&(this.indexes[e]=n+s.length);return this.markDirty(),this}insertBefore(e,t){let n,r=this.index(e),s=0===r&&"prepend",o=this.normalize(t,this.proxyOf.nodes[r],s).reverse();r=this.index(e);for(let e of o)this.proxyOf.nodes.splice(r,0,e);for(let e in this.indexes)n=this.indexes[e],r<=n&&(this.indexes[e]=n+o.length);return this.markDirty(),this}normalize(t,n){if("string"==typeof t)t=xs(Ss(t).nodes);else if(void 0===t)t=[];else if(Array.isArray(t)){t=t.slice(0);for(let e of t)e.parent&&e.parent.removeChild(e,"ignore")}else if("root"===t.type&&"document"!==this.type){t=t.nodes.slice(0);for(let e of t)e.parent&&e.parent.removeChild(e,"ignore")}else if(t.type)t=[t];else if(t.prop){if(void 0===t.value)throw new Error("Value field is missed in node creation");"string"!=typeof t.value&&(t.value=String(t.value)),t=[new Ts(t)]}else if(t.selector)t=[new _s(t)];else if(t.name)t=[new Is(t)];else{if(!t.text)throw new Error("Unknown node type in node creation");t=[new Os(t)]}return t.map(t=>(t[ks]||e.rebuild(t),(t=t.proxyOf).parent&&t.parent.removeChild(t),t[Es]&&Ns(t),void 0===t.raws.before&&n&&void 0!==n.raws.before&&(t.raws.before=n.raws.before.replace(/\S/g,"")),t.parent=this.proxyOf,t))}prepend(...e){e=e.reverse();for(let t of e){let e=this.normalize(t,this.first,"prepend").reverse();for(let t of e)this.proxyOf.nodes.unshift(t);for(let t in this.indexes)this.indexes[t]=this.indexes[t]+e.length}return this.markDirty(),this}push(e){return e.parent=this,this.proxyOf.nodes.push(e),this}removeAll(){for(let e of this.proxyOf.nodes)e.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(e){let t;e=this.index(e),this.proxyOf.nodes[e].parent=void 0,this.proxyOf.nodes.splice(e,1);for(let n in this.indexes)t=this.indexes[n],t>=e&&(this.indexes[n]=t-1);return this.markDirty(),this}replaceValues(e,t,n){return n||(n=t,t={}),this.walkDecls(r=>{t.props&&!t.props.includes(r.prop)||t.fast&&!r.value.includes(t.fast)||(r.value=r.value.replace(e,n))}),this.markDirty(),this}some(e){return this.nodes.some(e)}walk(e){return this.each((t,n)=>{let r;try{r=e(t,n)}catch(e){throw t.addToError(e)}return!1!==r&&t.walk&&(r=t.walk(e)),r})}walkAtRules(e,t){return t?e instanceof RegExp?this.walk((n,r)=>{if("atrule"===n.type&&e.test(n.name))return t(n,r)}):this.walk((n,r)=>{if("atrule"===n.type&&n.name===e)return t(n,r)}):(t=e,this.walk((e,n)=>{if("atrule"===e.type)return t(e,n)}))}walkComments(e){return this.walk((t,n)=>{if("comment"===t.type)return e(t,n)})}walkDecls(e,t){return t?e instanceof RegExp?this.walk((n,r)=>{if("decl"===n.type&&e.test(n.prop))return t(n,r)}):this.walk((n,r)=>{if("decl"===n.type&&n.prop===e)return t(n,r)}):(t=e,this.walk((e,n)=>{if("decl"===e.type)return t(e,n)}))}walkRules(e,t){return t?e instanceof RegExp?this.walk((n,r)=>{if("rule"===n.type&&e.test(n.selector))return t(n,r)}):this.walk((n,r)=>{if("rule"===n.type&&n.selector===e)return t(n,r)}):(t=e,this.walk((e,n)=>{if("rule"===e.type)return t(e,n)}))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}};Ms.registerParse=e=>{Ss=e},Ms.registerRule=e=>{_s=e},Ms.registerAtRule=e=>{Is=e},Ms.registerRoot=e=>{As=e};var Ls=Ms;Ms.default=Ms,Ms.rebuild=e=>{"atrule"===e.type?Object.setPrototypeOf(e,Is.prototype):"rule"===e.type?Object.setPrototypeOf(e,_s.prototype):"decl"===e.type?Object.setPrototypeOf(e,Ts.prototype):"comment"===e.type?Object.setPrototypeOf(e,Os.prototype):"root"===e.type&&Object.setPrototypeOf(e,As.prototype),e[ks]=!0,e.nodes&&e.nodes.forEach(e=>{Ms.rebuild(e)})};let Ds,Ps,Fs=Ls,Bs=class extends Fs{constructor(e){super({type:"document",...e}),this.nodes||(this.nodes=[])}toResult(e={}){return new Ds(new Ps,this,e).stringify()}};Bs.registerLazyResult=e=>{Ds=e},Bs.registerProcessor=e=>{Ps=e};var Us=Bs;Bs.default=Bs;let Zs={};var js=function(e){Zs[e]||(Zs[e]=!0,"undefined"!=typeof console&&console.warn&&console.warn(e))};let zs=class{constructor(e,t={}){if(this.type="warning",this.text=e,t.node&&t.node.source){let e=t.node.rangeBy(t);this.line=e.start.line,this.column=e.start.column,this.endLine=e.end.line,this.endColumn=e.end.column}for(let e in t)this[e]=t[e]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}};var Vs=zs;zs.default=zs;let Gs=Vs,Ws=class{constructor(e,t,n){this.processor=e,this.messages=[],this.root=t,this.opts=n,this.css=void 0,this.map=void 0}toString(){return this.css}warn(e,t={}){t.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(t.plugin=this.lastPlugin.postcssPlugin);let n=new Gs(e,t);return this.messages.push(n),n}warnings(){return this.messages.filter(e=>"warning"===e.type)}get content(){return this.css}};var Hs=Ws;Ws.default=Ws;const Ys="'".charCodeAt(0),Ks='"'.charCodeAt(0),Js="\\".charCodeAt(0),Xs="/".charCodeAt(0),qs="\n".charCodeAt(0),Qs=" ".charCodeAt(0),$s="\f".charCodeAt(0),eo="\t".charCodeAt(0),to="\r".charCodeAt(0),no="[".charCodeAt(0),ro="]".charCodeAt(0),so="(".charCodeAt(0),oo=")".charCodeAt(0),io="{".charCodeAt(0),ao="}".charCodeAt(0),lo=";".charCodeAt(0),co="*".charCodeAt(0),uo=":".charCodeAt(0),ho="@".charCodeAt(0),po=/[\t\n\f\r "#'()/;[\\\]{}]/g,fo=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,mo=/.[\r\n"'(/\\]/,go=/[\da-f]/i;let yo=Ls,vo=class extends yo{constructor(e){super(e),this.type="atrule"}append(...e){return this.proxyOf.nodes||(this.nodes=[]),super.append(...e)}prepend(...e){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...e)}};var bo=vo;vo.default=vo,yo.registerAtRule(vo);let wo,Co,So=Ls,_o=class extends So{constructor(e){super(e),this.type="root",this.nodes||(this.nodes=[])}normalize(e,t,n){let r=super.normalize(e);if(t)if("prepend"===n)this.nodes.length>1?t.raws.before=this.nodes[1].raws.before:delete t.raws.before;else if(this.first!==t)for(let e of r)e.raws.before=t.raws.before;return r}removeChild(e,t){let n=this.index(e);return!t&&0===n&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[n].raws.before),super.removeChild(e)}toResult(e={}){return new wo(new Co,this,e).stringify()}};_o.registerLazyResult=e=>{wo=e},_o.registerProcessor=e=>{Co=e};var Io=_o;_o.default=_o,So.registerRoot(_o);let Ao={comma:e=>Ao.split(e,[","],!0),space:e=>Ao.split(e,[" ","\n","\t"]),split(e,t,n){let r=[],s="",o=!1,i=0,a=!1,l="",c=!1;for(let n of e)c?c=!1:"\\"===n?c=!0:a?n===l&&(a=!1):'"'===n||"'"===n?(a=!0,l=n):"("===n?i+=1:")"===n?i>0&&(i-=1):0===i&&t.includes(n)&&(o=!0),o?(""!==s&&r.push(s.trim()),s="",o=!1):s+=n;return(n||""!==s)&&r.push(s.trim()),r}};var Eo=Ao;Ao.default=Ao;let ko=Ls,To=Eo,Oo=class extends ko{constructor(e){super(e),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return To.comma(this.selector)}set selectors(e){let t=this.selector?this.selector.match(/,\s*/):null,n=t?t[0]:","+this.raw("between","beforeOpen");this.selector=e.join(n)}};var Ro=Oo;Oo.default=Oo,ko.registerRule(Oo);let xo=Fr,No=function(e,t={}){let n,r,s,o,i,a,l,c,u,h,p=e.css.valueOf(),d=t.ignoreErrors,f=p.length,m=0,g=[],y=[];function v(t){throw e.error("Unclosed "+t,m)}return{back:function(e){y.push(e)},endOfFile:function(){return 0===y.length&&m>=f},nextToken:function(e){if(y.length)return y.pop();if(m>=f)return;let t=!!e&&e.ignoreUnclosed;switch(n=p.charCodeAt(m),n){case qs:case Qs:case eo:case to:case $s:r=m;do{r+=1,n=p.charCodeAt(r)}while(n===Qs||n===qs||n===eo||n===to||n===$s);h=["space",p.slice(m,r)],m=r-1;break;case no:case ro:case io:case ao:case uo:case lo:case oo:{let e=String.fromCharCode(n);h=[e,e,m];break}case so:if(c=g.length?g.pop()[1]:"",u=p.charCodeAt(m+1),"url"===c&&u!==Ys&&u!==Ks&&u!==Qs&&u!==qs&&u!==eo&&u!==$s&&u!==to){r=m;do{if(a=!1,r=p.indexOf(")",r+1),-1===r){if(d||t){r=m;break}v("bracket")}for(l=r;p.charCodeAt(l-1)===Js;)l-=1,a=!a}while(a);h=["brackets",p.slice(m,r+1),m,r],m=r}else r=p.indexOf(")",m+1),o=p.slice(m,r+1),-1===r||mo.test(o)?h=["(","(",m]:(h=["brackets",o,m,r],m=r);break;case Ys:case Ks:s=n===Ys?"'":'"',r=m;do{if(a=!1,r=p.indexOf(s,r+1),-1===r){if(d||t){r=m+1;break}v("string")}for(l=r;p.charCodeAt(l-1)===Js;)l-=1,a=!a}while(a);h=["string",p.slice(m,r+1),m,r],m=r;break;case ho:po.lastIndex=m+1,po.test(p),r=0===po.lastIndex?p.length-1:po.lastIndex-2,h=["at-word",p.slice(m,r+1),m,r],m=r;break;case Js:for(r=m,i=!0;p.charCodeAt(r+1)===Js;)r+=1,i=!i;if(n=p.charCodeAt(r+1),i&&n!==Xs&&n!==Qs&&n!==qs&&n!==eo&&n!==to&&n!==$s&&(r+=1,go.test(p.charAt(r)))){for(;go.test(p.charAt(r+1));)r+=1;p.charCodeAt(r+1)===Qs&&(r+=1)}h=["word",p.slice(m,r+1),m,r],m=r;break;default:n===Xs&&p.charCodeAt(m+1)===co?(r=p.indexOf("*/",m+2)+1,0===r&&(d||t?r=p.length:v("comment")),h=["comment",p.slice(m,r+1),m,r],m=r):(fo.lastIndex=m+1,fo.test(p),r=0===fo.lastIndex?p.length-1:fo.lastIndex-2,h=["word",p.slice(m,r+1),m,r],g.push(h),m=r)}return m++,h},position:function(){return m}}},Mo=Cs,Lo=bo,Do=Io,Po=Ro;const Fo={empty:!0,space:!0};let Bo=Ls,Uo=class{constructor(e){this.input=e,this.root=new Do,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:e,start:{column:1,line:1,offset:0}}}atrule(e){let t,n,r,s=new Lo;s.name=e[1].slice(1),""===s.name&&this.unnamedAtrule(s,e),this.init(s,e[2]);let o=!1,i=!1,a=[],l=[];for(;!this.tokenizer.endOfFile();){if(t=(e=this.tokenizer.nextToken())[0],"("===t||"["===t?l.push("("===t?")":"]"):"{"===t&&l.length>0?l.push("}"):t===l[l.length-1]&&l.pop(),0===l.length){if(";"===t){s.source.end=this.getPosition(e[2]),s.source.end.offset++,this.semicolon=!0;break}if("{"===t){i=!0;break}if("}"===t){if(a.length>0){for(r=a.length-1,n=a[r];n&&"space"===n[0];)n=a[--r];n&&(s.source.end=this.getPosition(n[3]||n[2]),s.source.end.offset++)}this.end(e);break}a.push(e)}else a.push(e);if(this.tokenizer.endOfFile()){o=!0;break}}s.raws.between=this.spacesAndCommentsFromEnd(a),a.length?(s.raws.afterName=this.spacesAndCommentsFromStart(a),this.raw(s,"params",a),o&&(e=a[a.length-1],s.source.end=this.getPosition(e[3]||e[2]),s.source.end.offset++,this.spaces=s.raws.between,s.raws.between="")):(s.raws.afterName="",s.params=""),i&&(s.nodes=[],this.current=s)}checkMissedSemicolon(e){let t=this.colon(e);if(!1===t)return;let n,r=0;for(let s=t-1;s>=0&&(n=e[s],"space"===n[0]||(r+=1,2!==r));s--);throw this.input.error("Missed semicolon","word"===n[0]?n[3]+1:n[2])}colon(e){let t,n,r,s=0;for(let[o,i]of e.entries()){if(t=i,n=t[0],"("===n&&(s+=1),")"===n&&(s-=1),0===s&&":"===n){if(r){if("word"===r[0]&&"progid"===r[1])continue;return o}this.doubleColon(t)}r=t}return!1}comment(e){let t=new Mo;this.init(t,e[2]),t.source.end=this.getPosition(e[3]||e[2]),t.source.end.offset++;let n=e[1].slice(2,-2);if(/^\s*$/.test(n))t.text="",t.raws.left=n,t.raws.right="";else{let e=n.match(/^(\s*)([^]*\S)(\s*)$/);t.text=e[2],t.raws.left=e[1],t.raws.right=e[3]}}createTokenizer(){this.tokenizer=No(this.input)}decl(e,t){let n=new xo;this.init(n,e[0][2]);let r,s=e[e.length-1];for(";"===s[0]&&(this.semicolon=!0,e.pop()),n.source.end=this.getPosition(s[3]||s[2]||function(e){for(let t=e.length-1;t>=0;t--){let n=e[t],r=n[3]||n[2];if(r)return r}}(e)),n.source.end.offset++;"word"!==e[0][0];)1===e.length&&this.unknownWord(e),n.raws.before+=e.shift()[1];for(n.source.start=this.getPosition(e[0][2]),n.prop="";e.length;){let t=e[0][0];if(":"===t||"space"===t||"comment"===t)break;n.prop+=e.shift()[1]}for(n.raws.between="";e.length;){if(r=e.shift(),":"===r[0]){n.raws.between+=r[1];break}"word"===r[0]&&/\w/.test(r[1])&&this.unknownWord([r]),n.raws.between+=r[1]}"_"!==n.prop[0]&&"*"!==n.prop[0]||(n.raws.before+=n.prop[0],n.prop=n.prop.slice(1));let o,i=[];for(;e.length&&(o=e[0][0],"space"===o||"comment"===o);)i.push(e.shift());this.precheckMissedSemicolon(e);for(let t=e.length-1;t>=0;t--){if(r=e[t],"!important"===r[1].toLowerCase()){n.important=!0;let r=this.stringFrom(e,t);r=this.spacesFromEnd(e)+r," !important"!==r&&(n.raws.important=r);break}if("important"===r[1].toLowerCase()){let r=e.slice(0),s="";for(let e=t;e>0;e--){let t=r[e][0];if(0===s.trim().indexOf("!")&&"space"!==t)break;s=r.pop()[1]+s}0===s.trim().indexOf("!")&&(n.important=!0,n.raws.important=s,e=r)}if("space"!==r[0]&&"comment"!==r[0])break}e.some(e=>"space"!==e[0]&&"comment"!==e[0])&&(n.raws.between+=i.map(e=>e[1]).join(""),i=[]),this.raw(n,"value",i.concat(e),t),n.value.includes(":")&&!t&&this.checkMissedSemicolon(e)}doubleColon(e){throw this.input.error("Double colon",{offset:e[2]},{offset:e[2]+e[1].length})}emptyRule(e){let t=new Po;this.init(t,e[2]),t.selector="",t.raws.between="",this.current=t}end(e){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(e[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(e)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(e){if(this.spaces+=e[1],this.current.nodes){let e=this.current.nodes[this.current.nodes.length-1];e&&"rule"===e.type&&!e.raws.ownSemicolon&&(e.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(e){let t=this.input.fromOffset(e);return{column:t.col,line:t.line,offset:e}}init(e,t){this.current.push(e),e.source={input:this.input,start:this.getPosition(t)},e.raws.before=this.spaces,this.spaces="","comment"!==e.type&&(this.semicolon=!1)}other(e){let t=!1,n=null,r=!1,s=null,o=[],i=e[1].startsWith("--"),a=[],l=e;for(;l;){if(n=l[0],a.push(l),"("===n||"["===n)s||(s=l),o.push("("===n?")":"]");else if(i&&r&&"{"===n)s||(s=l),o.push("}");else if(0===o.length){if(";"===n){if(r)return void this.decl(a,i);break}if("{"===n)return void this.rule(a);if("}"===n){this.tokenizer.back(a.pop()),t=!0;break}":"===n&&(r=!0)}else n===o[o.length-1]&&(o.pop(),0===o.length&&(s=null));l=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(t=!0),o.length>0&&this.unclosedBracket(s),t&&r){if(!i)for(;a.length&&(l=a[a.length-1][0],"space"===l||"comment"===l);)this.tokenizer.back(a.pop());this.decl(a,i)}else this.unknownWord(a)}parse(){let e;for(;!this.tokenizer.endOfFile();)switch(e=this.tokenizer.nextToken(),e[0]){case"space":this.spaces+=e[1];break;case";":this.freeSemicolon(e);break;case"}":this.end(e);break;case"comment":this.comment(e);break;case"at-word":this.atrule(e);break;case"{":this.emptyRule(e);break;default:this.other(e)}this.endFile()}precheckMissedSemicolon(){}raw(e,t,n,r){let s,o,i,a,l=n.length,c="",u=!0;for(let e=0;e<l;e+=1)s=n[e],o=s[0],"space"!==o||e!==l-1||r?"comment"===o?(a=n[e-1]?n[e-1][0]:"empty",i=n[e+1]?n[e+1][0]:"empty",Fo[a]||Fo[i]||","===c.slice(-1)?u=!1:c+=s[1]):c+=s[1]:u=!1;if(!u){let r=n.reduce((e,t)=>e+t[1],"");e.raws[t]={raw:r,value:c}}e[t]=c}rule(e){e.pop();let t=new Po;this.init(t,e[0][2]),t.raws.between=this.spacesAndCommentsFromEnd(e),this.raw(t,"selector",e),this.current=t}spacesAndCommentsFromEnd(e){let t,n="";for(;e.length&&(t=e[e.length-1][0],"space"===t||"comment"===t);)n=e.pop()[1]+n;return n}spacesAndCommentsFromStart(e){let t,n="";for(;e.length&&(t=e[0][0],"space"===t||"comment"===t);)n+=e.shift()[1];return n}spacesFromEnd(e){let t,n="";for(;e.length&&(t=e[e.length-1][0],"space"===t);)n=e.pop()[1]+n;return n}stringFrom(e,t){let n="";for(let r=t;r<e.length;r++)n+=e[r][1];return e.splice(t,e.length-t),n}unclosedBlock(){let e=this.current.source.start;throw this.input.error("Unclosed block",e.line,e.column)}unclosedBracket(e){throw this.input.error("Unclosed bracket",{offset:e[2]},{offset:e[2]+1})}unexpectedClose(e){throw this.input.error("Unexpected }",{offset:e[2]},{offset:e[2]+1})}unknownWord(e){throw this.input.error("Unknown word",{offset:e[0][2]},{offset:e[0][2]+e[0][1].length})}unnamedAtrule(e,t){throw this.input.error("At-rule without name",{offset:t[2]},{offset:t[2]+t[1].length})}},Zo=as;function jo(e,t){let n=new Zo(e,t),r=new Uo(n);try{r.parse()}catch(e){throw"production"!==process.env.NODE_ENV&&"CssSyntaxError"===e.name&&t&&t.from&&(/\.scss$/i.test(t.from)?e.message+="\nYou tried to parse SCSS with the standard CSS parser; try again with the postcss-scss parser":/\.sass/i.test(t.from)?e.message+="\nYou tried to parse Sass with the standard CSS parser; try again with the postcss-sass parser":/\.less$/i.test(t.from)&&(e.message+="\nYou tried to parse Less with the standard CSS parser; try again with the postcss-less parser")),e}return r.root}var zo=jo;jo.default=jo,Bo.registerParse(jo);let{isClean:Vo,my:Go}=wr,Wo=vs,Ho=Er,Yo=Ls,Ko=Us,Jo=js,Xo=Hs,qo=zo,Qo=Io;const $o={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},ei={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},ti={Once:!0,postcssPlugin:!0,prepare:!0};function ni(e){return"object"==typeof e&&"function"==typeof e.then}function ri(e){let t=!1,n=$o[e.type];return"decl"===e.type?t=e.prop.toLowerCase():"atrule"===e.type&&(t=e.name.toLowerCase()),t&&e.append?[n,n+"-"+t,0,n+"Exit",n+"Exit-"+t]:t?[n,n+"-"+t,n+"Exit",n+"Exit-"+t]:e.append?[n,0,n+"Exit"]:[n,n+"Exit"]}function si(e){let t;return t="document"===e.type?["Document",0,"DocumentExit"]:"root"===e.type?["Root",0,"RootExit"]:ri(e),{eventIndex:0,events:t,iterator:0,node:e,visitorIndex:0,visitors:[]}}function oi(e){return e[Vo]=!1,e.nodes&&e.nodes.forEach(e=>oi(e)),e}let ii={},ai=class e{constructor(t,n,r){let s;if(this.stringified=!1,this.processed=!1,"object"!=typeof n||null===n||"root"!==n.type&&"document"!==n.type)if(n instanceof e||n instanceof Xo)s=oi(n.root),n.map&&(void 0===r.map&&(r.map={}),r.map.inline||(r.map.inline=!1),r.map.prev=n.map);else{let e=qo;r.syntax&&(e=r.syntax.parse),r.parser&&(e=r.parser),e.parse&&(e=e.parse);try{s=e(n,r)}catch(e){this.processed=!0,this.error=e}s&&!s[Go]&&Yo.rebuild(s)}else s=oi(n);this.result=new Xo(t,s,r),this.helpers={...ii,postcss:ii,result:this.result},this.plugins=this.processor.plugins.map(e=>"object"==typeof e&&e.prepare?{...e,...e.prepare(this.result)}:e)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(e,t){let n=this.result.lastPlugin;try{if(t&&t.addToError(e),this.error=e,"CssSyntaxError"!==e.name||e.plugin){if(n.postcssVersion&&"production"!==process.env.NODE_ENV){let e=n.postcssPlugin,t=n.postcssVersion,r=this.result.processor.version,s=t.split("."),o=r.split(".");(s[0]!==o[0]||parseInt(s[1])>parseInt(o[1]))&&console.error("Unknown error from PostCSS plugin. Your current PostCSS version is "+r+", but "+e+" uses "+t+". Perhaps this is the source of the error below.")}}else e.plugin=n.postcssPlugin,e.setMessage()}catch(e){console&&console.error&&console.error(e)}return e}prepareVisitors(){this.listeners={};let e=(e,t,n)=>{this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push([e,n])};for(let t of this.plugins)if("object"==typeof t)for(let n in t){if(!ei[n]&&/^[A-Z]/.test(n))throw new Error(`Unknown event ${n} in ${t.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!ti[n])if("object"==typeof t[n])for(let r in t[n])e(t,"*"===r?n:n+"-"+r.toLowerCase(),t[n][r]);else"function"==typeof t[n]&&e(t,n,t[n])}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let e=0;e<this.plugins.length;e++){let t=this.plugins[e],n=this.runOnRoot(t);if(ni(n))try{await n}catch(e){throw this.handleError(e)}}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[Vo];){e[Vo]=!0;let t=[si(e)];for(;t.length>0;){let e=this.visitTick(t);if(ni(e))try{await e}catch(e){let n=t[t.length-1].node;throw this.handleError(e,n)}}}if(this.listeners.OnceExit)for(let[t,n]of this.listeners.OnceExit){this.result.lastPlugin=t;try{if("document"===e.type){let t=e.nodes.map(e=>n(e,this.helpers));await Promise.all(t)}else await n(e,this.helpers)}catch(e){throw this.handleError(e)}}}return this.processed=!0,this.stringify()}runOnRoot(e){this.result.lastPlugin=e;try{if("object"==typeof e&&e.Once){if("document"===this.result.root.type){let t=this.result.root.nodes.map(t=>e.Once(t,this.helpers));return ni(t[0])?Promise.all(t):t}return e.Once(this.result.root,this.helpers)}if("function"==typeof e)return e(this.result.root,this.result)}catch(e){throw this.handleError(e)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let e=this.result.opts,t=Ho;e.syntax&&(t=e.syntax.stringify),e.stringifier&&(t=e.stringifier),t.stringify&&(t=t.stringify);let n=new Wo(t,this.result.root,this.result.opts).generate();return this.result.css=n[0],this.result.map=n[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let e of this.plugins){if(ni(this.runOnRoot(e)))throw this.getAsyncError()}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[Vo];)e[Vo]=!0,this.walkSync(e);if(this.listeners.OnceExit)if("document"===e.type)for(let t of e.nodes)this.visitSync(this.listeners.OnceExit,t);else this.visitSync(this.listeners.OnceExit,e)}return this.result}then(e,t){return"production"!==process.env.NODE_ENV&&("from"in this.opts||Jo("Without `from` option PostCSS could generate wrong source map and will not find Browserslist config. Set it to CSS file path or to `undefined` to prevent this warning.")),this.async().then(e,t)}toString(){return this.css}visitSync(e,t){for(let[n,r]of e){let e;this.result.lastPlugin=n;try{e=r(t,this.helpers)}catch(e){throw this.handleError(e,t.proxyOf)}if("root"!==t.type&&"document"!==t.type&&!t.parent)return!0;if(ni(e))throw this.getAsyncError()}}visitTick(e){let t=e[e.length-1],{node:n,visitors:r}=t;if("root"!==n.type&&"document"!==n.type&&!n.parent)return void e.pop();if(r.length>0&&t.visitorIndex<r.length){let[e,s]=r[t.visitorIndex];t.visitorIndex+=1,t.visitorIndex===r.length&&(t.visitors=[],t.visitorIndex=0),this.result.lastPlugin=e;try{return s(n.toProxy(),this.helpers)}catch(e){throw this.handleError(e,n)}}if(0!==t.iterator){let r,s=t.iterator;for(;r=n.nodes[n.indexes[s]];)if(n.indexes[s]+=1,!r[Vo])return r[Vo]=!0,void e.push(si(r));t.iterator=0,delete n.indexes[s]}let s=t.events;for(;t.eventIndex<s.length;){let e=s[t.eventIndex];if(t.eventIndex+=1,0===e)return void(n.nodes&&n.nodes.length&&(n[Vo]=!0,t.iterator=n.getIterator()));if(this.listeners[e])return void(t.visitors=this.listeners[e])}e.pop()}walkSync(e){e[Vo]=!0;let t=ri(e);for(let n of t)if(0===n)e.nodes&&e.each(e=>{e[Vo]||this.walkSync(e)});else{let t=this.listeners[n];if(t&&this.visitSync(t,e.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}};ai.registerPostcss=e=>{ii=e};var li=ai;ai.default=ai,Qo.registerLazyResult(ai),Ko.registerLazyResult(ai);let ci=vs,ui=Er,hi=js,pi=zo;const di=Hs;let fi=class{constructor(e,t,n){let r;t=t.toString(),this.stringified=!1,this._processor=e,this._css=t,this._opts=n,this._map=void 0;let s=ui;this.result=new di(this._processor,r,this._opts),this.result.css=t;let o=this;Object.defineProperty(this.result,"root",{get:()=>o.root});let i=new ci(s,r,this._opts,t);if(i.isMap()){let[e,t]=i.generate();e&&(this.result.css=e),t&&(this.result.map=t)}else i.clearAnnotation(),this.result.css=i.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}sync(){if(this.error)throw this.error;return this.result}then(e,t){return"production"!==process.env.NODE_ENV&&("from"in this._opts||hi("Without `from` option PostCSS could generate wrong source map and will not find Browserslist config. Set it to CSS file path or to `undefined` to prevent this warning.")),this.async().then(e,t)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let e,t=pi;try{e=t(this._css,this._opts)}catch(e){this.error=e}if(this.error)throw this.error;return this._root=e,e}get[Symbol.toStringTag](){return"NoWorkResult"}};var mi=fi;fi.default=fi;let gi=mi,yi=li,vi=Us,bi=Io,wi=class{constructor(e=[]){this.version="8.4.38",this.plugins=this.normalize(e)}normalize(e){let t=[];for(let n of e)if(!0===n.postcss?n=n():n.postcss&&(n=n.postcss),"object"==typeof n&&Array.isArray(n.plugins))t=t.concat(n.plugins);else if("object"==typeof n&&n.postcssPlugin)t.push(n);else if("function"==typeof n)t.push(n);else{if("object"!=typeof n||!n.parse&&!n.stringify)throw new Error(n+" is not a PostCSS plugin");if("production"!==process.env.NODE_ENV)throw new Error("PostCSS syntaxes cannot be used as plugins. Instead, please use one of the syntax/parser/stringifier options as outlined in your PostCSS runner documentation.")}return t}process(e,t={}){return this.plugins.length||t.parser||t.stringifier||t.syntax?new yi(this,e,t):new gi(this,e,t)}use(e){return this.plugins=this.plugins.concat(this.normalize([e])),this}};var Ci=wi;wi.default=wi,bi.registerProcessor(wi),vi.registerProcessor(wi);let Si=Fr,_i=Hr,Ii=Cs,Ai=bo,Ei=as,ki=Io,Ti=Ro;function Oi(e,t){if(Array.isArray(e))return e.map(e=>Oi(e));let{inputs:n,...r}=e;if(n){t=[];for(let e of n){let n={...e,__proto__:Ei.prototype};n.map&&(n.map={...n.map,__proto__:_i.prototype}),t.push(n)}}if(r.nodes&&(r.nodes=e.nodes.map(e=>Oi(e,t))),r.source){let{inputId:e,...n}=r.source;r.source=n,null!=e&&(r.source.input=t[e])}if("root"===r.type)return new ki(r);if("decl"===r.type)return new Si(r);if("rule"===r.type)return new Ti(r);if("comment"===r.type)return new Ii(r);if("atrule"===r.type)return new Ai(r);throw new Error("Unknown node type: "+e.type)}var Ri=Oi;Oi.default=Oi;let xi=br,Ni=Fr,Mi=li,Li=Ls,Di=Ci,Pi=Er,Fi=Ri,Bi=Us,Ui=Vs,Zi=Cs,ji=bo,zi=Hs,Vi=as,Gi=zo,Wi=Eo,Hi=Ro,Yi=Io,Ki=Lr;function Ji(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),new Di(e)}Ji.plugin=function(e,t){let n,r=!1;function s(...n){console&&console.warn&&!r&&(r=!0,console.warn(e+": postcss.plugin was deprecated. Migration guide:\nhttps://evilmartians.com/chronicles/postcss-8-plugin-migration"),process.env.LANG&&process.env.LANG.startsWith("cn")&&console.warn(e+": éé¢ postcss.plugin è¢«å¼ç¨. è¿ç§»æå:\nhttps://www.w3ctech.com/topic/2226"));let s=t(...n);return s.postcssPlugin=e,s.postcssVersion=(new Di).version,s}return Object.defineProperty(s,"postcss",{get:()=>(n||(n=s()),n)}),s.process=function(e,t,n){return Ji([s(n)]).process(e,t)},s},Ji.stringify=Pi,Ji.parse=Gi,Ji.fromJSON=Fi,Ji.list=Wi,Ji.comment=e=>new Zi(e),Ji.atRule=e=>new ji(e),Ji.decl=e=>new Ni(e),Ji.rule=e=>new Hi(e),Ji.root=e=>new Yi(e),Ji.document=e=>new Bi(e),Ji.CssSyntaxError=xi,Ji.Declaration=Ni,Ji.Container=Li,Ji.Processor=Di,Ji.Document=Bi,Ji.Comment=Zi,Ji.Warning=Ui,Ji.AtRule=ji,Ji.Result=zi,Ji.Input=Vi,Ji.Rule=Hi,Ji.Root=Yi,Ji.Node=Ki,Mi.registerPostcss(Ji);var Xi=Ji;Ji.default=Ji;const qi=cr(Xi);qi.stringify,qi.fromJSON,qi.plugin,qi.parse,qi.list,qi.document,qi.comment,qi.atRule,qi.rule,qi.decl,qi.root,qi.CssSyntaxError,qi.Declaration,qi.Container,qi.Processor,qi.Document,qi.Comment,qi.Warning,qi.AtRule,qi.Result,qi.Input,qi.Rule,qi.Root,qi.Node;class Qi{constructor(...e){lr(this,"parentElement",null),lr(this,"parentNode",null),lr(this,"ownerDocument"),lr(this,"firstChild",null),lr(this,"lastChild",null),lr(this,"previousSibling",null),lr(this,"nextSibling",null),lr(this,"ELEMENT_NODE",1),lr(this,"TEXT_NODE",3),lr(this,"nodeType"),lr(this,"nodeName"),lr(this,"RRNodeType")}get childNodes(){const e=[];let t=this.firstChild;for(;t;)e.push(t),t=t.nextSibling;return e}contains(e){if(!(e instanceof Qi))return!1;if(e.ownerDocument!==this.ownerDocument)return!1;if(e===this)return!0;for(;e.parentNode;){if(e.parentNode===this)return!0;e=e.parentNode}return!1}appendChild(e){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(e,t){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(e){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}const $i={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},ea={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},ta={};function na(e){if(ta[e])return ta[e];const t=globalThis[e],n=t.prototype,r=e in $i?$i[e]:void 0,s=Boolean(r&&r.every(e=>{var t,r;return Boolean(null==(r=null==(t=Object.getOwnPropertyDescriptor(n,e))?void 0:t.get)?void 0:r.toString().includes("[native code]"))})),o=e in ea?ea[e]:void 0,i=Boolean(o&&o.every(e=>{var t;return"function"==typeof n[e]&&(null==(t=n[e])?void 0:t.toString().includes("[native code]"))}));if(s&&i&&!globalThis.Zone)return ta[e]=t.prototype,t.prototype;try{const r=document.createElement("iframe");document.body.appendChild(r);const s=r.contentWindow;if(!s)return t.prototype;const o=s[e].prototype;return document.body.removeChild(r),o?ta[e]=o:n}catch{return n}}const ra={};function sa(e,t,n){var r;const s=`${e}.${String(n)}`;if(ra[s])return ra[s].call(t);const o=na(e),i=null==(r=Object.getOwnPropertyDescriptor(o,n))?void 0:r.get;return i?(ra[s]=i,i.call(t)):t[n]}const oa={};function ia(e,t,n){const r=`${e}.${String(n)}`;if(oa[r])return oa[r].bind(t);const s=na(e)[n];return"function"!=typeof s?t[n]:(oa[r]=s,s.bind(t))}const aa={childNodes:function(e){return sa("Node",e,"childNodes")},parentNode:function(e){return sa("Node",e,"parentNode")},parentElement:function(e){return sa("Node",e,"parentElement")},textContent:function(e){return sa("Node",e,"textContent")},contains:function(e,t){return ia("Node",e,"contains")(t)},getRootNode:function(e){return ia("Node",e,"getRootNode")()},host:function(e){return e&&"host"in e?sa("ShadowRoot",e,"host"):null},styleSheets:function(e){return e.styleSheets},shadowRoot:function(e){return e&&"shadowRoot"in e?sa("Element",e,"shadowRoot"):null},querySelector:function(e,t){return sa("Element",e,"querySelector")(t)},querySelectorAll:function(e,t){return sa("Element",e,"querySelectorAll")(t)},mutationObserver:function(){return na("MutationObserver").constructor}};const la="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let ca={map:{},getId:()=>(console.error(la),-1),getNode:()=>(console.error(la),null),removeNodeFromMap(){console.error(la)},has:()=>(console.error(la),!1),reset(){console.error(la)}};"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(ca=new Proxy(ca,{get:(e,t,n)=>("map"===t&&console.error(la),Reflect.get(e,t,n))}));let ua=Date.now;function ha(e){if(!e)return null;return e.nodeType===e.ELEMENT_NODE?e:aa.parentElement(e)}/[1-9][0-9]{12}/.test(Date.now().toString())||(ua=()=>(new Date).getTime());function pa(e){var t;let n=null;return"getRootNode"in e&&(null==(t=aa.getRootNode(e))?void 0:t.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&aa.host(aa.getRootNode(e))&&(n=aa.host(aa.getRootNode(e))),n}function da(e){let t,n=e;for(;t=pa(n);)n=t;return n}function fa(e){const t=e.ownerDocument;if(!t)return!1;const n=da(e);return aa.contains(t,n)}const ma=Object.freeze(Object.defineProperty({__proto__:null,StyleSheetMirror:class{constructor(){s(this,"id",1),s(this,"styleIDMap",new WeakMap),s(this,"idStyleMap",new Map)}getId(e){return this.styleIDMap.get(e)??-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let n;return n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}},get _mirror(){return ca},closestElementOfNode:ha,getBaseDimension:function e(t,n){var r,s;const o=null==(s=null==(r=t.ownerDocument)?void 0:r.defaultView)?void 0:s.frameElement;if(!o||o===n)return{x:0,y:0,relativeScale:1,absoluteScale:1};const i=o.getBoundingClientRect(),a=e(o,n),l=i.height/o.clientHeight;return{x:i.x*a.relativeScale+a.x,y:i.y*a.relativeScale+a.y,relativeScale:l,absoluteScale:a.absoluteScale*l}},getNestedRule:function e(t,n){const r=t[n[0]];return 1===n.length?r:e(r.cssRules[n[1]].cssRules,n.slice(2))},getPositionsAndIndex:function(e){const t=[...e],n=t.pop();return{positions:t,index:n}},getRootShadowHost:da,getShadowHost:pa,getWindowHeight:function(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight},getWindowScroll:function(e){var t,n,r,s;const o=e.document;return{left:o.scrollingElement?o.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:o.documentElement.scrollLeft||(null==o?void 0:o.body)&&(null==(t=aa.parentElement(o.body))?void 0:t.scrollLeft)||(null==(n=null==o?void 0:o.body)?void 0:n.scrollLeft)||0,top:o.scrollingElement?o.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:(null==o?void 0:o.documentElement.scrollTop)||(null==o?void 0:o.body)&&(null==(r=aa.parentElement(o.body))?void 0:r.scrollTop)||(null==(s=null==o?void 0:o.body)?void 0:s.scrollTop)||0}},getWindowWidth:function(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth},hasShadowRoot:function(e){return!!e&&(e instanceof Qi&&"shadowRoot"in e?Boolean(e.shadowRoot):Boolean(aa.shadowRoot(e)))},hookSetter:function e(t,n,r,s,o=window){const i=o.Object.getOwnPropertyDescriptor(t,n);return o.Object.defineProperty(t,n,s?r:{set(e){setTimeout(()=>{r.set.call(this,e)},0),i&&i.set&&i.set.call(this,e)}}),()=>e(t,n,i||{},!0)},inDom:function(e){const t=e.ownerDocument;return!!t&&(aa.contains(t,e)||fa(e))},isAncestorRemoved:function e(t,n){if(function(e){const t=e&&"host"in e&&"mode"in e&&m.host(e)||null;return Boolean(t&&"shadowRoot"in t&&m.shadowRoot(t)===e)}(t))return!1;const r=n.getId(t);if(!n.has(r))return!0;const s=aa.parentNode(t);return(!s||s.nodeType!==t.DOCUMENT_NODE)&&(!s||e(s,n))},isBlocked:function(e,t,n,r){if(!e)return!1;const s=ha(e);if(!s)return!1;try{if("string"==typeof t){if(s.classList.contains(t))return!0;if(r&&null!==s.closest("."+t))return!0}else if(y(s,t,r))return!0}catch(e){}if(n){if(s.matches(n))return!0;if(r&&null!==s.closest(n))return!0}return!1},isIgnored:function(e,t,n){return!("TITLE"!==e.tagName||!n.headTitleMutations)||-2===t.getId(e)},isSerialized:function(e,t){return-1!==t.getId(e)},isSerializedIframe:function(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))},isSerializedStylesheet:function(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))},iterateResolveTree:function e(t,n){n(t.value);for(let r=t.children.length-1;r>=0;r--)e(t.children[r],n)},legacy_isTouchEvent:function(e){return Boolean(e.changedTouches)},get nowTimestamp(){return ua},on:function(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)},patch:function(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],s=n(r);return"function"==typeof s&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=s,()=>{e[t]=r}}catch{return()=>{}}},polyfill:function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach)},queueToResolveTrees:function(e){const t={},n=(e,n)=>{const r={value:e,parent:n,children:[]};return t[e.node.id]=r,r},r=[];for(const s of e){const{nextId:e,parentId:o}=s;if(e&&e in t){const o=t[e];if(o.parent){const e=o.parent.children.indexOf(o);o.parent.children.splice(e,0,n(s,o.parent))}else{const e=r.indexOf(o);r.splice(e,0,n(s,null))}continue}if(o in t){const e=t[o];e.children.push(n(s,e));continue}r.push(n(s,null))}return r},shadowHostInDom:fa,throttle:function(e,t,n={}){let r=null,s=0;return function(...o){const i=Date.now();s||!1!==n.leading||(s=i);const a=t-(i-s),l=this;a<=0||a>t?(r&&(clearTimeout(r),r=null),s=i,e.apply(l,o)):r||!1===n.trailing||(r=setTimeout(()=>{s=!1===n.leading?0:Date.now(),r=null,e.apply(l,o)},a))}},uniqueTextMutations:function(e){const t=new Set,n=[];for(let r=e.length;r--;){const s=e[r];t.has(s.id)||(n.push(s),t.add(s.id))}return n}},Symbol.toStringTag,{value:"Module"}));for(var ga="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ya="undefined"==typeof Uint8Array?[]:new Uint8Array(256),va=0;va<64;va++)ya[ga.charCodeAt(va)]=va;var ba,wa,Ca;"undefined"!=typeof window&&window.Blob&&new Blob([(ba="KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpIHJldHVybiB0cmFuc3BhcmVudEJsb2JNYXAuZ2V0KGlkKTsKICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsKICAgICAgb2Zmc2NyZWVuLmdldENvbnRleHQoIjJkIik7CiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBvZmZzY3JlZW4uY29udmVydFRvQmxvYihkYXRhVVJMT3B0aW9ucyk7CiAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpOwogICAgICBjb25zdCBiYXNlNjQgPSBlbmNvZGUoYXJyYXlCdWZmZXIpOwogICAgICB0cmFuc3BhcmVudEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICByZXR1cm4gYmFzZTY0OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuICIiOwogICAgfQogIH0KICBjb25zdCB3b3JrZXIgPSBzZWxmOwogIHdvcmtlci5vbm1lc3NhZ2UgPSBhc3luYyBmdW5jdGlvbihlKSB7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBjb25zdCB7IGlkLCBiaXRtYXAsIHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zIH0gPSBlLmRhdGE7CiAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBkYXRhVVJMT3B0aW9ucwogICAgICApOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBjb25zdCBjdHggPSBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY3R4LmRyYXdJbWFnZShiaXRtYXAsIDAsIDApOwogICAgICBiaXRtYXAuY2xvc2UoKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgdHlwZSA9IGJsb2IudHlwZTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIGlmICghbGFzdEJsb2JNYXAuaGFzKGlkKSAmJiBhd2FpdCB0cmFuc3BhcmVudEJhc2U2NCA9PT0gYmFzZTY0KSB7CiAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICAgIHJldHVybiB3b3JrZXIucG9zdE1lc3NhZ2UoeyBpZCB9KTsKICAgICAgfQogICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KSByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7CiAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7CiAgICAgICAgaWQsCiAgICAgICAgdHlwZSwKICAgICAgICBiYXNlNjQsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0CiAgICAgIH0pOwogICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsKICAgIH0KICB9Owp9KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1iaXRtYXAtZGF0YS11cmwtd29ya2VyLUlKcEM3Z19iLmpzLm1hcAo=",Uint8Array.from(atob(ba),e=>e.charCodeAt(0)))],{type:"text/javascript;charset=utf-8"});try{if(2!==Array.from([1],e=>2*e)[0]){const t=document.createElement("iframe");document.body.appendChild(t),Array.from=(null==(e=t.contentWindow)?void 0:e.Array.from)||Array.from,document.body.removeChild(t)}}catch(e){console.debug("Unable to override Array.from",e)}new g,(Ca=wa||(wa={}))[Ca.NotStarted=0]="NotStarted",Ca[Ca.Running=1]="Running",Ca[Ca.Stopped=2]="Stopped";class Sa{constructor(e){n(this,"fileName"),n(this,"functionName"),n(this,"lineNumber"),n(this,"columnNumber"),this.fileName=e.fileName||"",this.functionName=e.functionName||"",this.lineNumber=e.lineNumber,this.columnNumber=e.columnNumber}toString(){const e=this.lineNumber||"",t=this.columnNumber||"";return this.functionName?`${this.functionName} (${this.fileName}:${e}:${t})`:`${this.fileName}:${e}:${t}`}}const _a=/(^|@)\S+:\d+/,Ia=/^\s*at .*(\S+:\d+|\(native\))/m,Aa=/^(eval@)?(\[native code])?$/,Ea={parse:function(e){return e?void 0!==e.stacktrace||void 0!==e["opera#sourceloc"]?this.parseOpera(e):e.stack&&e.stack.match(Ia)?this.parseV8OrIE(e):e.stack?this.parseFFOrSafari(e):(console.warn("[console-record-plugin]: Failed to parse error object:",e),[]):[]},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];const t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));if(!t)throw new Error(`Cannot parse given url: ${e}`);return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(Ia)},this).map(function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let t=e.replace(/^\s+/,"").replace(/\(eval code/g,"(");const n=t.match(/ (\((.+):(\d+):(\d+)\)$)/);t=n?t.replace(n[0],""):t;const r=t.split(/\s+/).slice(1),s=this.extractLocation(n?n[1]:r.pop()),o=r.join(" ")||void 0,i=["eval","<anonymous>"].indexOf(s[0])>-1?void 0:s[0];return new Sa({functionName:o,fileName:i,lineNumber:s[1],columnNumber:s[2]})},this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter(function(e){return!e.match(Aa)},this).map(function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new Sa({functionName:e});{const t=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=e.match(t),r=n&&n[1]?n[1]:void 0,s=this.extractLocation(e.replace(t,""));return new Sa({functionName:r,fileName:s[0],lineNumber:s[1],columnNumber:s[2]})}},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){const t=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split("\n"),r=[];for(let e=2,s=n.length;e<s;e+=2){const s=t.exec(n[e]);s&&r.push(new Sa({fileName:s[2],lineNumber:parseFloat(s[1])}))}return r},parseOpera10:function(e){const t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split("\n"),r=[];for(let e=0,s=n.length;e<s;e+=2){const s=t.exec(n[e]);s&&r.push(new Sa({functionName:s[3]||void 0,fileName:s[2],lineNumber:parseFloat(s[1])}))}return r},parseOpera11:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(_a)&&!e.match(/^Error created at/)},this).map(function(e){const t=e.split("@"),n=this.extractLocation(t.pop()),r=(t.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new Sa({functionName:r,fileName:n[0],lineNumber:n[1],columnNumber:n[2]})},this)}};function ka(e){if(!e||!e.outerHTML)return"";let t="";for(;e.parentElement;){let n=e.localName;if(!n)break;n=n.toLowerCase();const r=e.parentElement,s=[];if(r.children&&r.children.length>0)for(let e=0;e<r.children.length;e++){const t=r.children[e];t.localName&&t.localName.toLowerCase&&t.localName.toLowerCase()===n&&s.push(t)}s.length>1&&(n+=`:eq(${s.indexOf(e)})`),t=n+(t?">"+t:""),e=r}return t}function Ta(e){return"[object Object]"===Object.prototype.toString.call(e)}function Oa(e,t){if(0===t)return!0;const n=Object.keys(e);for(const r of n)if(Ta(e[r])&&Oa(e[r],t-1))return!0;return!1}function Ra(e,t){const n={numOfKeysLimit:50,depthOfLimit:4};Object.assign(n,t);const r=[],s=[];return JSON.stringify(e,function(e,t){if(r.length>0){const n=r.indexOf(this);~n?r.splice(n+1):r.push(this),~n?s.splice(n,1/0,e):s.push(e),~r.indexOf(t)&&(t=r[0]===t?"[Circular ~]":"[Circular ~."+s.slice(0,r.indexOf(t)).join(".")+"]")}else r.push(t);if(null===t)return t;if(void 0===t)return"undefined";if(function(e){if(Ta(e)&&Object.keys(e).length>n.numOfKeysLimit)return!0;if("function"==typeof e)return!0;if(Ta(e)&&Oa(e,n.depthOfLimit))return!0;return!1}(t))return function(e){let t=e.toString();n.stringLengthLimit&&t.length>n.stringLengthLimit&&(t=`${t.slice(0,n.stringLengthLimit)}...`);return t}(t);if("bigint"==typeof t)return t.toString()+"n";if(t instanceof Event){const e={};for(const n in t){const r=t[n];Array.isArray(r)?e[n]=ka(r.length?r[0]:null):e[n]=r}return e}return t instanceof Node?t instanceof HTMLElement?t?t.outerHTML:"":t.nodeName:t instanceof Error?t.stack?t.stack+"\nEnd of stack for Error object":t.name+": "+t.message:t})}const xa={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function Na(e,t,n){const r=n?Object.assign({},xa,n):xa,s=r.logger;if(!s)return()=>{};let o;o="string"==typeof s?t[s]:s;let i=0,a=!1;const l=[];if(r.level.includes("error")){const n=t=>{const n=t.message,s=t.error,o=Ea.parse(s).map(e=>e.toString()),i=[Ra(n,r.stringifyOptions)];e({level:"error",trace:o,payload:i})};t.addEventListener("error",n),l.push(()=>{t.removeEventListener("error",n)});const s=t=>{let n,s;t.reason instanceof Error?(n=t.reason,s=[Ra(`Uncaught (in promise) ${n.name}: ${n.message}`,r.stringifyOptions)]):(n=new Error,s=[Ra("Uncaught (in promise)",r.stringifyOptions),Ra(t.reason,r.stringifyOptions)]);const o=Ea.parse(n).map(e=>e.toString());e({level:"error",trace:o,payload:s})};t.addEventListener("unhandledrejection",s),l.push(()=>{t.removeEventListener("unhandledrejection",s)})}for(const e of r.level)l.push(c(o,e));return()=>{l.forEach(e=>e())};function c(t,n){return t[n]?ma.patch(t,n,t=>(...s)=>{if(t.apply(this,s),!("assert"===n&&s[0]||a)){a=!0;try{const t=Ea.parse(new Error).map(e=>e.toString()).splice(1),o=("assert"===n?s.slice(1):s).map(e=>Ra(e,r.stringifyOptions));i++,i<r.lengthThreshold?e({level:n,trace:t,payload:o}):i===r.lengthThreshold&&e({level:"warn",trace:[],payload:[Ra("The number of log records reached the threshold.")]})}catch(e){t("rrweb logger error:",e,...s)}finally{a=!1}}}):()=>{}}}var Ma;function La(e){var t=null==e?void 0:e.host;return Boolean((null==t?void 0:t.shadowRoot)===e)}function Da(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function Pa(e){try{var t=e.rules||e.cssRules;return t?((n=Array.from(t).map(Fa).join("")).includes(" background-clip: text;")&&!n.includes(" -webkit-background-clip: text;")&&(n=n.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),n):null}catch(e){return null}var n}function Fa(e){var t=e.cssText;if(function(e){return"styleSheet"in e}(e))try{t=Pa(e.styleSheet)||t}catch(e){}return t}!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(Ma||(Ma={}));var Ba=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(e){var t;if(!e)return-1;var n=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!=n?n:-1},e.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},e.prototype.removeNodeFromMap=function(e){var t=this,n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(function(e){return t.removeNodeFromMap(e)})},e.prototype.has=function(e){return this.idNodeMap.has(e)},e.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},e.prototype.add=function(e,t){var n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)},e.prototype.replace=function(e,t){var n=this.getNode(e);if(n){var r=this.nodeMetaMap.get(n);r&&this.nodeMetaMap.set(t,r)}this.idNodeMap.set(e,t)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function Ua(e){var t=e.maskInputOptions,n=e.tagName,r=e.type,s=e.value,o=e.maskInputFn,i=s||"";return(t[n.toLowerCase()]||t[r])&&(i=o?o(i):"*".repeat(i.length)),i}var Za="__rrweb_original__";var ja,za,Va=1,Ga=new RegExp("[^a-z0-9-_:]");function Wa(){return Va++}var Ha=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Ya=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,Ka=/^(data:)([^,]*),(.*)/i;function Ja(e,t){return(e||"").replace(Ha,function(e,n,r,s,o,i){var a,l=r||o||i,c=n||s||"";if(!l)return e;if(!Ya.test(l))return"url(".concat(c).concat(l).concat(c,")");if(Ka.test(l))return"url(".concat(c).concat(l).concat(c,")");if("/"===l[0])return"url(".concat(c).concat((a=t,(a.indexOf("//")>-1?a.split("/").slice(0,3).join("/"):a.split("/")[0]).split("?")[0]+l)).concat(c,")");var u=t.split("/"),h=l.split("/");u.pop();for(var p=0,d=h;p<d.length;p++){var f=d[p];"."!==f&&(".."===f?u.pop():u.push(f))}return"url(".concat(c).concat(u.join("/")).concat(c,")")})}var Xa=/^[^ \t\n\r\u000c]+/,qa=/^[, \t\n\r\u000c]+/;function Qa(e,t){if(!t||""===t.trim())return t;var n=e.createElement("a");return n.href=t,n.href}function $a(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}function el(){var e=document.createElement("a");return e.href="",e.href}function tl(e,t,n,r){return"src"===n||"href"===n&&r&&("use"!==t||"#"!==r[0])||"xlink:href"===n&&r&&"#"!==r[0]?Qa(e,r):"background"!==n||!r||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n&&r?function(e,t){if(""===t.trim())return t;var n=0;function r(e){var r,s=e.exec(t.substring(n));return s?(r=s[0],n+=r.length,r):""}for(var s=[];r(qa),!(n>=t.length);){var o=r(Xa);if(","===o.slice(-1))o=Qa(e,o.substring(0,o.length-1)),s.push(o);else{var i="";o=Qa(e,o);for(var a=!1;;){var l=t.charAt(n);if(""===l){s.push((o+i).trim());break}if(a)")"===l&&(a=!1);else{if(","===l){n+=1,s.push((o+i).trim());break}"("===l&&(a=!0)}i+=l,n+=1}}}return s.join(", ")}(e,r):"style"===n&&r?Ja(r,el()):"object"===t&&"data"===n&&r?Qa(e,r):r:Qa(e,r)}function nl(e,t,n){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!n&&nl(e.parentNode,t,n);for(var r=e.classList.length;r--;){var s=e.classList[r];if(t.test(s))return!0}return!!n&&nl(e.parentNode,t,n)}function rl(e,t,n){var r=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===r)return!1;if("string"==typeof t){if(r.classList.contains(t))return!0;if(r.closest(".".concat(t)))return!0}else if(nl(r,t,!0))return!0;if(n){if(r.matches(n))return!0;if(r.closest(n))return!0}return!1}function sl(e,t){var n=t.doc,r=t.mirror,s=t.blockClass,o=t.blockSelector,i=t.maskTextClass,a=t.maskTextSelector,l=t.inlineStylesheet,c=t.maskInputOptions,u=void 0===c?{}:c,h=t.maskTextFn,p=t.maskInputFn,d=t.dataURLOptions,f=void 0===d?{}:d,m=t.inlineImages,g=t.recordCanvas,y=t.keepIframeSrcFn,v=t.newlyAddedElement,b=void 0!==v&&v,w=function(e,t){if(!t.hasNode(e))return;var n=t.getId(e);return 1===n?void 0:n}(n,r);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:Ma.Document,childNodes:[],compatMode:e.compatMode}:{type:Ma.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:Ma.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:w};case e.ELEMENT_NODE:return function(e,t){for(var n=t.doc,r=t.blockClass,s=t.blockSelector,o=t.inlineStylesheet,i=t.maskInputOptions,a=void 0===i?{}:i,l=t.maskInputFn,c=t.dataURLOptions,u=void 0===c?{}:c,h=t.inlineImages,p=t.recordCanvas,d=t.keepIframeSrcFn,f=t.newlyAddedElement,m=void 0!==f&&f,g=t.rootId,y=function(e,t,n){if("string"==typeof t){if(e.classList.contains(t))return!0}else for(var r=e.classList.length;r--;){var s=e.classList[r];if(t.test(s))return!0}return!!n&&e.matches(n)}(e,r,s),v=function(e){if(e instanceof HTMLFormElement)return"form";var t=e.tagName.toLowerCase().trim();return Ga.test(t)?"div":t}(e),b={},w=e.attributes.length,C=0;C<w;C++){var S=e.attributes[C];b[S.name]=tl(n,v,S.name,S.value)}if("link"===v&&o){var _=Array.from(n.styleSheets).find(function(t){return t.href===e.href}),I=null;_&&(I=Pa(_)),I&&(delete b.rel,delete b.href,b._cssText=Ja(I,_.href))}if("style"===v&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){(I=Pa(e.sheet))&&(b._cssText=Ja(I,el()))}if("input"===v||"textarea"===v||"select"===v){var A=e.value,E=e.checked;"radio"!==b.type&&"checkbox"!==b.type&&"submit"!==b.type&&"button"!==b.type&&A?b.value=Ua({type:b.type,tagName:v,value:A,maskInputOptions:a,maskInputFn:l}):E&&(b.checked=E)}"option"===v&&(e.selected&&!a.select?b.selected=!0:delete b.selected);if("canvas"===v&&p)if("2d"===e.__context)(function(e){var t=e.getContext("2d");if(!t)return!0;for(var n=0;n<e.width;n+=50)for(var r=0;r<e.height;r+=50){var s=t.getImageData,o=Za in s?s[Za]:s;if(new Uint32Array(o.call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some(function(e){return 0!==e}))return!1}return!0})(e)||(b.rr_dataURL=e.toDataURL(u.type,u.quality));else if(!("__context"in e)){var k=e.toDataURL(u.type,u.quality),T=document.createElement("canvas");T.width=e.width,T.height=e.height,k!==T.toDataURL(u.type,u.quality)&&(b.rr_dataURL=k)}if("img"===v&&h){ja||(ja=n.createElement("canvas"),za=ja.getContext("2d"));var O=e,R=O.crossOrigin;O.crossOrigin="anonymous";var x=function(){try{ja.width=O.naturalWidth,ja.height=O.naturalHeight,za.drawImage(O,0,0),b.rr_dataURL=ja.toDataURL(u.type,u.quality)}catch(e){console.warn("Cannot inline img src=".concat(O.currentSrc,"! Error: ").concat(e))}R?b.crossOrigin=R:O.removeAttribute("crossorigin")};O.complete&&0!==O.naturalWidth?x():O.onload=x}"audio"!==v&&"video"!==v||(b.rr_mediaState=e.paused?"paused":"played",b.rr_mediaCurrentTime=e.currentTime);m||(e.scrollLeft&&(b.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(b.rr_scrollTop=e.scrollTop));if(y){var N=e.getBoundingClientRect(),M=N.width,L=N.height;b={class:b.class,rr_width:"".concat(M,"px"),rr_height:"".concat(L,"px")}}"iframe"!==v||d(b.src)||(e.contentDocument||(b.rr_src=b.src),delete b.src);return{type:Ma.Element,tagName:v,attributes:b,childNodes:[],isSVG:$a(e)||void 0,needBlock:y,rootId:g}}(e,{doc:n,blockClass:s,blockSelector:o,inlineStylesheet:l,maskInputOptions:u,maskInputFn:p,dataURLOptions:f,inlineImages:m,recordCanvas:g,keepIframeSrcFn:y,newlyAddedElement:b,rootId:w});case e.TEXT_NODE:return function(e,t){var n,r=t.maskTextClass,s=t.maskTextSelector,o=t.maskTextFn,i=t.rootId,a=e.parentNode&&e.parentNode.tagName,l=e.textContent,c="STYLE"===a||void 0,u="SCRIPT"===a||void 0;if(c&&l){try{e.nextSibling||e.previousSibling||(null===(n=e.parentNode.sheet)||void 0===n?void 0:n.cssRules)&&(l=(h=e.parentNode.sheet).cssRules?Array.from(h.cssRules).map(function(e){return e.cssText||""}).join(""):"")}catch(t){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(t),e)}l=Ja(l,el())}var h;u&&(l="SCRIPT_PLACEHOLDER");!c&&!u&&l&&rl(e,r,s)&&(l=o?o(l):l.replace(/[\S]/g,"*"));return{type:Ma.Text,textContent:l||"",isStyle:c,rootId:i}}(e,{maskTextClass:i,maskTextSelector:a,maskTextFn:h,rootId:w});case e.CDATA_SECTION_NODE:return{type:Ma.CDATA,textContent:"",rootId:w};case e.COMMENT_NODE:return{type:Ma.Comment,textContent:e.textContent||"",rootId:w};default:return!1}}function ol(e){return void 0===e?"":e.toLowerCase()}function il(e,t){var n,r=t.doc,s=t.mirror,o=t.blockClass,i=t.blockSelector,a=t.maskTextClass,l=t.maskTextSelector,c=t.skipChild,u=void 0!==c&&c,h=t.inlineStylesheet,p=void 0===h||h,d=t.maskInputOptions,f=void 0===d?{}:d,m=t.maskTextFn,g=t.maskInputFn,y=t.slimDOMOptions,v=t.dataURLOptions,b=void 0===v?{}:v,w=t.inlineImages,C=void 0!==w&&w,S=t.recordCanvas,_=void 0!==S&&S,I=t.onSerialize,A=t.onIframeLoad,E=t.iframeLoadTimeout,k=void 0===E?5e3:E,T=t.onStylesheetLoad,O=t.stylesheetLoadTimeout,R=void 0===O?5e3:O,x=t.keepIframeSrcFn,N=void 0===x?function(){return!1}:x,M=t.newlyAddedElement,L=void 0!==M&&M,D=t.preserveWhiteSpace,P=void 0===D||D,F=sl(e,{doc:r,mirror:s,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:l,inlineStylesheet:p,maskInputOptions:f,maskTextFn:m,maskInputFn:g,dataURLOptions:b,inlineImages:C,recordCanvas:_,keepIframeSrcFn:N,newlyAddedElement:L});if(!F)return console.warn(e,"not serialized"),null;n=s.hasNode(e)?s.getId(e):!function(e,t){if(t.comment&&e.type===Ma.Comment)return!0;if(e.type===Ma.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&"preload"===e.attributes.rel&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(ol(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===ol(e.attributes.name)||"icon"===ol(e.attributes.rel)||"apple-touch-icon"===ol(e.attributes.rel)||"shortcut icon"===ol(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&ol(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(ol(e.attributes.property).match(/^(og|twitter|fb):/)||ol(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===ol(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===ol(e.attributes.name)||"googlebot"===ol(e.attributes.name)||"bingbot"===ol(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===ol(e.attributes.name)||"generator"===ol(e.attributes.name)||"framework"===ol(e.attributes.name)||"publisher"===ol(e.attributes.name)||"progid"===ol(e.attributes.name)||ol(e.attributes.property).match(/^article:/)||ol(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===ol(e.attributes.name)||"yandex-verification"===ol(e.attributes.name)||"csrf-token"===ol(e.attributes.name)||"p:domain_verify"===ol(e.attributes.name)||"verify-v1"===ol(e.attributes.name)||"verification"===ol(e.attributes.name)||"shopify-checkout-api-token"===ol(e.attributes.name)))return!0}}return!1}(F,y)&&(P||F.type!==Ma.Text||F.isStyle||F.textContent.replace(/^\s+|\s+$/gm,"").length)?Wa():-2;var B=Object.assign(F,{id:n});if(s.add(e,B),-2===n)return null;I&&I(e);var U=!u;if(B.type===Ma.Element){U=U&&!B.needBlock,delete B.needBlock;var Z=e.shadowRoot;Z&&Da(Z)&&(B.isShadowHost=!0)}if((B.type===Ma.Document||B.type===Ma.Element)&&U){y.headWhitespace&&B.type===Ma.Element&&"head"===B.tagName&&(P=!1);for(var j={doc:r,mirror:s,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:l,skipChild:u,inlineStylesheet:p,maskInputOptions:f,maskTextFn:m,maskInputFn:g,slimDOMOptions:y,dataURLOptions:b,inlineImages:C,recordCanvas:_,preserveWhiteSpace:P,onSerialize:I,onIframeLoad:A,iframeLoadTimeout:k,onStylesheetLoad:T,stylesheetLoadTimeout:R,keepIframeSrcFn:N},z=0,V=Array.from(e.childNodes);z<V.length;z++){(H=il(V[z],j))&&B.childNodes.push(H)}if(function(e){return e.nodeType===e.ELEMENT_NODE}(e)&&e.shadowRoot)for(var G=0,W=Array.from(e.shadowRoot.childNodes);G<W.length;G++){var H;(H=il(W[G],j))&&(Da(e.shadowRoot)&&(H.isShadow=!0),B.childNodes.push(H))}}return e.parentNode&&La(e.parentNode)&&Da(e.parentNode)&&(B.isShadow=!0),B.type===Ma.Element&&"iframe"===B.tagName&&function(e,t,n){var r=e.contentWindow;if(r){var s,o=!1;try{s=r.document.readyState}catch(e){return}if("complete"===s){var i="about:blank";if(r.location.href!==i||e.src===i||""===e.src)return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}else{var a=setTimeout(function(){o||(t(),o=!0)},n);e.addEventListener("load",function(){clearTimeout(a),o=!0,t()})}}}(e,function(){var t=e.contentDocument;if(t&&A){var n=il(t,{doc:t,mirror:s,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:l,skipChild:!1,inlineStylesheet:p,maskInputOptions:f,maskTextFn:m,maskInputFn:g,slimDOMOptions:y,dataURLOptions:b,inlineImages:C,recordCanvas:_,preserveWhiteSpace:P,onSerialize:I,onIframeLoad:A,iframeLoadTimeout:k,onStylesheetLoad:T,stylesheetLoadTimeout:R,keepIframeSrcFn:N});n&&A(e,n)}},k),B.type===Ma.Element&&"link"===B.tagName&&"stylesheet"===B.attributes.rel&&function(e,t,n){var r,s=!1;try{r=e.sheet}catch(e){return}if(!r){var o=setTimeout(function(){s||(t(),s=!0)},n);e.addEventListener("load",function(){clearTimeout(o),s=!0,t()})}}(e,function(){if(T){var t=il(e,{doc:r,mirror:s,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:l,skipChild:!1,inlineStylesheet:p,maskInputOptions:f,maskTextFn:m,maskInputFn:g,slimDOMOptions:y,dataURLOptions:b,inlineImages:C,recordCanvas:_,preserveWhiteSpace:P,onSerialize:I,onIframeLoad:A,iframeLoadTimeout:k,onStylesheetLoad:T,stylesheetLoadTimeout:R,keepIframeSrcFn:N});t&&T(e,t)}},R),B}function al(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}const ll="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let cl={map:{},getId:()=>(console.error(ll),-1),getNode:()=>(console.error(ll),null),removeNodeFromMap(){console.error(ll)},has:()=>(console.error(ll),!1),reset(){console.error(ll)}};function ul(e,t,n={}){let r=null,s=0;return function(...o){const i=Date.now();s||!1!==n.leading||(s=i);const a=t-(i-s),l=this;a<=0||a>t?(r&&(clearTimeout(r),r=null),s=i,e.apply(l,o)):r||!1===n.trailing||(r=setTimeout(()=>{s=!1===n.leading?0:Date.now(),r=null,e.apply(l,o)},a))}}function hl(e,t,n,r,s=window){const o=s.Object.getOwnPropertyDescriptor(e,t);return s.Object.defineProperty(e,t,r?n:{set(e){setTimeout(()=>{n.set.call(this,e)},0),o&&o.set&&o.set.call(this,e)}}),()=>hl(e,t,o||{},!0)}function pl(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],s=n(r);return"function"==typeof s&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=s,()=>{e[t]=r}}catch(e){return()=>{}}}function dl(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function fl(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function ml(e,t,n,r){if(!e)return!1;const s=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(!s)return!1;if("string"==typeof t){if(s.classList.contains(t))return!0;if(r&&null!==s.closest("."+t))return!0}else if(nl(s,t,r))return!0;if(n){if(e.matches(n))return!0;if(r&&null!==s.closest(n))return!0}return!1}function gl(e,t){return-2===t.getId(e)}function yl(e,t){if(La(e))return!1;const n=t.getId(e);return!t.has(n)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||yl(e.parentNode,t))}function vl(e){return Boolean(e.changedTouches)}function bl(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function wl(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function Cl(e){return Boolean(null==e?void 0:e.shadowRoot)}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(cl=new Proxy(cl,{get:(e,t,n)=>("map"===t&&console.error(ll),Reflect.get(e,t,n))}));class Sl{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var t;return null!==(t=this.styleIDMap.get(e))&&void 0!==t?t:-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let n;return n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}var _l=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(_l||{}),Il=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e))(Il||{}),Al=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(Al||{}),El=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(El||{});function kl(e){return"__ln"in e}class Tl{constructor(){this.length=0,this.head=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let t=this.head;for(let n=0;n<e;n++)t=(null==t?void 0:t.next)||null;return t}addNode(e){const t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&kl(e.previousSibling)){const n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&kl(e.nextSibling)&&e.nextSibling.__ln.previous){const n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;this.length++}removeNode(e){const t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next&&(t.next.previous=t.previous)):(this.head=t.next,this.head&&(this.head.previous=null)),e.__ln&&delete e.__ln,this.length--)}}const Ol=(e,t)=>`${e}@${t}`;class Rl{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],t=new Tl,n=e=>{let t=e,n=-2;for(;-2===n;)t=t&&t.nextSibling,n=t&&this.mirror.getId(t);return n},r=r=>{var s,o,i,a;let l=null;(null===(o=null===(s=r.getRootNode)||void 0===s?void 0:s.call(r))||void 0===o?void 0:o.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&r.getRootNode().host&&(l=r.getRootNode().host);let c=l;for(;(null===(a=null===(i=null==c?void 0:c.getRootNode)||void 0===i?void 0:i.call(c))||void 0===a?void 0:a.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&c.getRootNode().host;)c=c.getRootNode().host;const u=!(this.doc.contains(r)||c&&this.doc.contains(c));if(!r.parentNode||u)return;const h=La(r.parentNode)?this.mirror.getId(l):this.mirror.getId(r.parentNode),p=n(r);if(-1===h||-1===p)return t.addNode(r);const d=il(r,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{bl(e,this.mirror)&&this.iframeManager.addIframe(e),wl(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),Cl(r)&&this.shadowDomManager.addShadowRoot(r.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}});d&&e.push({parentId:h,nextId:p,node:d})};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const e of Array.from(this.movedSet.values()))Nl(this.removes,e,this.mirror)&&!this.movedSet.has(e.parentNode)||r(e);for(const e of Array.from(this.addedSet.values()))Ll(this.droppedSet,e)||Nl(this.removes,e,this.mirror)?Ll(this.movedSet,e)?r(e):this.droppedSet.add(e):r(e);let s=null;for(;t.length;){let e=null;if(s){const t=this.mirror.getId(s.value.parentNode),r=n(s.value);-1!==t&&-1!==r&&(e=s)}if(!e)for(let r=t.length-1;r>=0;r--){const s=t.get(r);if(s){const t=this.mirror.getId(s.value.parentNode);if(-1===n(s.value))continue;if(-1!==t){e=s;break}{const t=s.value;if(t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const n=t.parentNode.host;if(-1!==this.mirror.getId(n)){e=s;break}}}}}if(!e){for(;t.head;)t.removeNode(t.head.value);break}s=e.previous,t.removeNode(e.value),r(e.value)}const o={texts:this.texts.map(e=>({id:this.mirror.getId(e.node),value:e.value})).filter(e=>this.mirror.has(e.id)),attributes:this.attributes.map(e=>({id:this.mirror.getId(e.node),attributes:e.attributes})).filter(e=>this.mirror.has(e.id)),removes:this.removes,adds:e};(o.texts.length||o.attributes.length||o.removes.length||o.adds.length)&&(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(o))},this.processMutation=e=>{if(!gl(e.target,this.mirror))switch(e.type){case"characterData":{const t=e.target.textContent;ml(e.target,this.blockClass,this.blockSelector,!1)||t===e.oldValue||this.texts.push({value:rl(e.target,this.maskTextClass,this.maskTextSelector)&&t?this.maskTextFn?this.maskTextFn(t):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{const t=e.target;let n=e.target.getAttribute(e.attributeName);if("value"===e.attributeName&&(n=Ua({maskInputOptions:this.maskInputOptions,tagName:e.target.tagName,type:e.target.getAttribute("type"),value:n,maskInputFn:this.maskInputFn})),ml(e.target,this.blockClass,this.blockSelector,!1)||n===e.oldValue)return;let r=this.attributes.find(t=>t.node===e.target);if("IFRAME"===t.tagName&&"src"===e.attributeName&&!this.keepIframeSrcFn(n)){if(t.contentDocument)return;e.attributeName="rr_src"}if(r||(r={node:e.target,attributes:{}},this.attributes.push(r)),"style"===e.attributeName){const n=this.doc.createElement("span");e.oldValue&&n.setAttribute("style",e.oldValue),void 0!==r.attributes.style&&null!==r.attributes.style||(r.attributes.style={});const s=r.attributes.style;for(const e of Array.from(t.style)){const r=t.style.getPropertyValue(e),o=t.style.getPropertyPriority(e);r===n.style.getPropertyValue(e)&&o===n.style.getPropertyPriority(e)||(s[e]=""===o?r:[r,o])}for(const e of Array.from(n.style))""===t.style.getPropertyValue(e)&&(s[e]=!1)}else r.attributes[e.attributeName]=tl(this.doc,t.tagName,e.attributeName,n);break}case"childList":if(ml(e.target,this.blockClass,this.blockSelector,!0))return;e.addedNodes.forEach(t=>this.genAdds(t,e.target)),e.removedNodes.forEach(t=>{const n=this.mirror.getId(t),r=La(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);ml(e.target,this.blockClass,this.blockSelector,!1)||gl(t,this.mirror)||!function(e,t){return-1!==t.getId(e)}(t,this.mirror)||(this.addedSet.has(t)?(xl(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===n||yl(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[Ol(n,r)]?xl(this.movedSet,t):this.removes.push({parentId:r,id:n,isShadow:!(!La(e.target)||!Da(e.target))||void 0})),this.mapRemoves.push(t))})}},this.genAdds=(e,t)=>{if(this.mirror.hasNode(e)){if(gl(e,this.mirror))return;this.movedSet.add(e);let n=null;t&&this.mirror.hasNode(t)&&(n=this.mirror.getId(t)),n&&-1!==n&&(this.movedMap[Ol(this.mirror.getId(e),n)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);ml(e,this.blockClass,this.blockSelector,!1)||e.childNodes.forEach(e=>this.genAdds(e))}}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager"].forEach(t=>{this[t]=e[t]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function xl(e,t){e.delete(t),t.childNodes.forEach(t=>xl(e,t))}function Nl(e,t,n){return 0!==e.length&&Ml(e,t,n)}function Ml(e,t,n){const{parentNode:r}=t;if(!r)return!1;const s=n.getId(r);return!!e.some(e=>e.id===s)||Ml(e,r,n)}function Ll(e,t){return 0!==e.size&&Dl(e,t)}function Dl(e,t){const{parentNode:n}=t;return!!n&&(!!e.has(n)||Dl(e,n))}const Pl=[],Fl="undefined"!=typeof CSSGroupingRule,Bl="undefined"!=typeof CSSMediaRule,Ul="undefined"!=typeof CSSSupportsRule,Zl="undefined"!=typeof CSSConditionRule;function jl(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0];return e.target}catch(t){return e.target}}function zl(e,t){var n,r;const s=new Rl;Pl.push(s),s.init(e);let o=window.MutationObserver||window.__rrMutationObserver;const i=null===(r=null===(n=null===window||void 0===window?void 0:window.Zone)||void 0===n?void 0:n.__symbol__)||void 0===r?void 0:r.call(n,"MutationObserver");i&&window[i]&&(o=window[i]);const a=new o(s.processMutations.bind(s));return a.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function Vl({mouseInteractionCb:e,doc:t,mirror:n,blockClass:r,blockSelector:s,sampling:o}){if(!1===o.mouseInteraction)return()=>{};const i=!0===o.mouseInteraction||void 0===o.mouseInteraction?{}:o.mouseInteraction,a=[];return Object.keys(Al).filter(e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==i[e]).forEach(o=>{const i=o.toLowerCase(),l=(t=>o=>{const i=jl(o);if(ml(i,r,s,!0))return;const a=vl(o)?o.changedTouches[0]:o;if(!a)return;const l=n.getId(i),{clientX:c,clientY:u}=a;e({type:Al[t],id:l,x:c,y:u})})(o);a.push(al(i,l,t))}),()=>{a.forEach(e=>e())}}function Gl({scrollCb:e,doc:t,mirror:n,blockClass:r,blockSelector:s,sampling:o}){return al("scroll",ul(o=>{const i=jl(o);if(!i||ml(i,r,s,!0))return;const a=n.getId(i);if(i===t){const n=t.scrollingElement||t.documentElement;e({id:a,x:n.scrollLeft,y:n.scrollTop})}else e({id:a,x:i.scrollLeft,y:i.scrollTop})},o.scroll||100),t)}function Wl(e,t){const n=Object.assign({},e);return t||delete n.userTriggered,n}const Hl=["INPUT","TEXTAREA","SELECT"],Yl=new WeakMap;function Kl(e){return function(e,t){if(Fl&&e.parentRule instanceof CSSGroupingRule||Bl&&e.parentRule instanceof CSSMediaRule||Ul&&e.parentRule instanceof CSSSupportsRule||Zl&&e.parentRule instanceof CSSConditionRule){const n=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(n)}else if(e.parentStyleSheet){const n=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(n)}return t}(e,[])}function Jl(e,t,n){let r,s;return e?(e.ownerNode?r=t.getId(e.ownerNode):s=n.getId(e),{styleId:s,id:r}):{}}function Xl({mirror:e,stylesheetManager:t},n){var r,s,o;let i=null;i="#document"===n.nodeName?e.getId(n):e.getId(n.host);const a="#document"===n.nodeName?null===(r=n.defaultView)||void 0===r?void 0:r.Document:null===(o=null===(s=n.ownerDocument)||void 0===s?void 0:s.defaultView)||void 0===o?void 0:o.ShadowRoot,l=Object.getOwnPropertyDescriptor(null==a?void 0:a.prototype,"adoptedStyleSheets");return null!==i&&-1!==i&&a&&l?(Object.defineProperty(n,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get(){var e;return null===(e=l.get)||void 0===e?void 0:e.call(this)},set(e){var n;const r=null===(n=l.set)||void 0===n?void 0:n.call(this,e);if(null!==i&&-1!==i)try{t.adoptStyleSheets(e,i)}catch(e){}return r}}),()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get:l.get,set:l.set})}):()=>{}}function ql(e,t={}){const n=e.doc.defaultView;if(!n)return()=>{};!function(e,t){const{mutationCb:n,mousemoveCb:r,mouseInteractionCb:s,scrollCb:o,viewportResizeCb:i,inputCb:a,mediaInteractionCb:l,styleSheetRuleCb:c,styleDeclarationCb:u,canvasMutationCb:h,fontCb:p,selectionCb:d}=e;e.mutationCb=(...e)=>{t.mutation&&t.mutation(...e),n(...e)},e.mousemoveCb=(...e)=>{t.mousemove&&t.mousemove(...e),r(...e)},e.mouseInteractionCb=(...e)=>{t.mouseInteraction&&t.mouseInteraction(...e),s(...e)},e.scrollCb=(...e)=>{t.scroll&&t.scroll(...e),o(...e)},e.viewportResizeCb=(...e)=>{t.viewportResize&&t.viewportResize(...e),i(...e)},e.inputCb=(...e)=>{t.input&&t.input(...e),a(...e)},e.mediaInteractionCb=(...e)=>{t.mediaInteaction&&t.mediaInteaction(...e),l(...e)},e.styleSheetRuleCb=(...e)=>{t.styleSheetRule&&t.styleSheetRule(...e),c(...e)},e.styleDeclarationCb=(...e)=>{t.styleDeclaration&&t.styleDeclaration(...e),u(...e)},e.canvasMutationCb=(...e)=>{t.canvasMutation&&t.canvasMutation(...e),h(...e)},e.fontCb=(...e)=>{t.font&&t.font(...e),p(...e)},e.selectionCb=(...e)=>{t.selection&&t.selection(...e),d(...e)}}(e,t);const r=zl(e,e.doc),s=function({mousemoveCb:e,sampling:t,doc:n,mirror:r}){if(!1===t.mousemove)return()=>{};const s="number"==typeof t.mousemove?t.mousemove:50,o="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500;let i,a=[];const l=ul(t=>{const n=Date.now()-i;e(a.map(e=>(e.timeOffset-=n,e)),t),a=[],i=null},o),c=ul(e=>{const t=jl(e),{clientX:n,clientY:s}=vl(e)?e.changedTouches[0]:e;i||(i=Date.now()),a.push({x:n,y:s,id:r.getId(t),timeOffset:Date.now()-i}),l("undefined"!=typeof DragEvent&&e instanceof DragEvent?Il.Drag:e instanceof MouseEvent?Il.MouseMove:Il.TouchMove)},s,{trailing:!1}),u=[al("mousemove",c,n),al("touchmove",c,n),al("drag",c,n)];return()=>{u.forEach(e=>e())}}(e),o=Vl(e),i=Gl(e),a=function({viewportResizeCb:e}){let t=-1,n=-1;return al("resize",ul(()=>{const r=dl(),s=fl();t===r&&n===s||(e({width:Number(s),height:Number(r)}),t=r,n=s)},200),window)}(e),l=function({inputCb:e,doc:t,mirror:n,blockClass:r,blockSelector:s,ignoreClass:o,maskInputOptions:i,maskInputFn:a,sampling:l,userTriggeredOnInput:c}){function u(e){let n=jl(e);const l=e.isTrusted;if(n&&"OPTION"===n.tagName&&(n=n.parentElement),!n||!n.tagName||Hl.indexOf(n.tagName)<0||ml(n,r,s,!0))return;const u=n.type;if(n.classList.contains(o))return;let p=n.value,d=!1;"radio"===u||"checkbox"===u?d=n.checked:(i[n.tagName.toLowerCase()]||i[u])&&(p=Ua({maskInputOptions:i,tagName:n.tagName,type:u,value:p,maskInputFn:a})),h(n,Wl({text:p,isChecked:d,userTriggered:l},c));const f=n.name;"radio"===u&&f&&d&&t.querySelectorAll(`input[type="radio"][name="${f}"]`).forEach(e=>{e!==n&&h(e,Wl({text:e.value,isChecked:!d,userTriggered:!1},c))})}function h(t,r){const s=Yl.get(t);if(!s||s.text!==r.text||s.isChecked!==r.isChecked){Yl.set(t,r);const s=n.getId(t);e(Object.assign(Object.assign({},r),{id:s}))}}const p=("last"===l.input?["change"]:["input","change"]).map(e=>al(e,u,t)),d=t.defaultView;if(!d)return()=>{p.forEach(e=>e())};const f=d.Object.getOwnPropertyDescriptor(d.HTMLInputElement.prototype,"value"),m=[[d.HTMLInputElement.prototype,"value"],[d.HTMLInputElement.prototype,"checked"],[d.HTMLSelectElement.prototype,"value"],[d.HTMLTextAreaElement.prototype,"value"],[d.HTMLSelectElement.prototype,"selectedIndex"],[d.HTMLOptionElement.prototype,"selected"]];return f&&f.set&&p.push(...m.map(e=>hl(e[0],e[1],{set(){u({target:this})}},!1,d))),()=>{p.forEach(e=>e())}}(e),c=function({mediaInteractionCb:e,blockClass:t,blockSelector:n,mirror:r,sampling:s}){const o=o=>ul(s=>{const i=jl(s);if(!i||ml(i,t,n,!0))return;const{currentTime:a,volume:l,muted:c,playbackRate:u}=i;e({type:o,id:r.getId(i),currentTime:a,volume:l,muted:c,playbackRate:u})},s.media||500),i=[al("play",o(0)),al("pause",o(1)),al("seeked",o(2)),al("volumechange",o(3)),al("ratechange",o(4))];return()=>{i.forEach(e=>e())}}(e),u=function({styleSheetRuleCb:e,mirror:t,stylesheetManager:n},{win:r}){const s=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=function(r,o){const{id:i,styleId:a}=Jl(this,t,n.styleMirror);return(i&&-1!==i||a&&-1!==a)&&e({id:i,styleId:a,adds:[{rule:r,index:o}]}),s.apply(this,[r,o])};const o=r.CSSStyleSheet.prototype.deleteRule;let i,a;r.CSSStyleSheet.prototype.deleteRule=function(r){const{id:s,styleId:i}=Jl(this,t,n.styleMirror);return(s&&-1!==s||i&&-1!==i)&&e({id:s,styleId:i,removes:[{index:r}]}),o.apply(this,[r])},r.CSSStyleSheet.prototype.replace&&(i=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=function(r){const{id:s,styleId:o}=Jl(this,t,n.styleMirror);return(s&&-1!==s||o&&-1!==o)&&e({id:s,styleId:o,replace:r}),i.apply(this,[r])}),r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=function(r){const{id:s,styleId:o}=Jl(this,t,n.styleMirror);return(s&&-1!==s||o&&-1!==o)&&e({id:s,styleId:o,replaceSync:r}),a.apply(this,[r])});const l={};Fl?l.CSSGroupingRule=r.CSSGroupingRule:(Bl&&(l.CSSMediaRule=r.CSSMediaRule),Zl&&(l.CSSConditionRule=r.CSSConditionRule),Ul&&(l.CSSSupportsRule=r.CSSSupportsRule));const c={};return Object.entries(l).forEach(([r,s])=>{c[r]={insertRule:s.prototype.insertRule,deleteRule:s.prototype.deleteRule},s.prototype.insertRule=function(s,o){const{id:i,styleId:a}=Jl(this.parentStyleSheet,t,n.styleMirror);return(i&&-1!==i||a&&-1!==a)&&e({id:i,styleId:a,adds:[{rule:s,index:[...Kl(this),o||0]}]}),c[r].insertRule.apply(this,[s,o])},s.prototype.deleteRule=function(s){const{id:o,styleId:i}=Jl(this.parentStyleSheet,t,n.styleMirror);return(o&&-1!==o||i&&-1!==i)&&e({id:o,styleId:i,removes:[{index:[...Kl(this),s]}]}),c[r].deleteRule.apply(this,[s])}}),()=>{r.CSSStyleSheet.prototype.insertRule=s,r.CSSStyleSheet.prototype.deleteRule=o,i&&(r.CSSStyleSheet.prototype.replace=i),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(l).forEach(([e,t])=>{t.prototype.insertRule=c[e].insertRule,t.prototype.deleteRule=c[e].deleteRule})}}(e,{win:n}),h=Xl(e,e.doc),p=function({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:n,stylesheetManager:r},{win:s}){const o=s.CSSStyleDeclaration.prototype.setProperty;s.CSSStyleDeclaration.prototype.setProperty=function(s,i,a){var l;if(n.has(s))return o.apply(this,[s,i,a]);const{id:c,styleId:u}=Jl(null===(l=this.parentRule)||void 0===l?void 0:l.parentStyleSheet,t,r.styleMirror);return(c&&-1!==c||u&&-1!==u)&&e({id:c,styleId:u,set:{property:s,value:i,priority:a},index:Kl(this.parentRule)}),o.apply(this,[s,i,a])};const i=s.CSSStyleDeclaration.prototype.removeProperty;return s.CSSStyleDeclaration.prototype.removeProperty=function(s){var o;if(n.has(s))return i.apply(this,[s]);const{id:a,styleId:l}=Jl(null===(o=this.parentRule)||void 0===o?void 0:o.parentStyleSheet,t,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&e({id:a,styleId:l,remove:{property:s},index:Kl(this.parentRule)}),i.apply(this,[s])},()=>{s.CSSStyleDeclaration.prototype.setProperty=o,s.CSSStyleDeclaration.prototype.removeProperty=i}}(e,{win:n}),d=e.collectFonts?function({fontCb:e,doc:t}){const n=t.defaultView;if(!n)return()=>{};const r=[],s=new WeakMap,o=n.FontFace;n.FontFace=function(e,t,n){const r=new o(e,t,n);return s.set(r,{family:e,buffer:"string"!=typeof t,descriptors:n,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r};const i=pl(t.fonts,"add",function(t){return function(n){return setTimeout(()=>{const t=s.get(n);t&&(e(t),s.delete(n))},0),t.apply(this,[n])}});return r.push(()=>{n.FontFace=o}),r.push(i),()=>{r.forEach(e=>e())}}(e):()=>{},f=function(e){const{doc:t,mirror:n,blockClass:r,blockSelector:s,selectionCb:o}=e;let i=!0;const a=()=>{const e=t.getSelection();if(!e||i&&(null==e?void 0:e.isCollapsed))return;i=e.isCollapsed||!1;const a=[],l=e.rangeCount||0;for(let t=0;t<l;t++){const o=e.getRangeAt(t),{startContainer:i,startOffset:l,endContainer:c,endOffset:u}=o;ml(i,r,s,!0)||ml(c,r,s,!0)||a.push({start:n.getId(i),startOffset:l,end:n.getId(c),endOffset:u})}o({ranges:a})};return a(),al("selectionchange",a)}(e),m=[];for(const t of e.plugins)m.push(t.observer(t.callback,n,t.options));return()=>{Pl.forEach(e=>e.reset()),r.disconnect(),s(),o(),i(),a(),l(),c(),u(),h(),p(),d(),f(),m.forEach(e=>e())}}class Ql{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,n,r){const s=n||this.getIdToRemoteIdMap(e),o=r||this.getRemoteIdToIdMap(e);let i=s.get(t);return i||(i=this.generateIdFn(),s.set(t,i),o.set(i,t)),i}getIds(e,t){const n=this.getIdToRemoteIdMap(e),r=this.getRemoteIdToIdMap(e);return t.map(t=>this.getId(e,t,n,r))}getRemoteId(e,t,n){const r=n||this.getRemoteIdToIdMap(e);if("number"!=typeof t)return t;const s=r.get(t);return s||-1}getRemoteIds(e,t){const n=this.getRemoteIdToIdMap(e);return t.map(t=>this.getRemoteId(e,t,n))}reset(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class $l{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Ql(Wa),this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Ql(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){var n;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(n=this.loadListener)||void 0===n||n.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){if("rrweb"===e.data.type){if(!e.source)return;const t=this.crossOriginIframeMap.get(e.source);if(!t)return;const n=this.transformCrossOriginEvent(t,e.data.event);n&&this.wrappedEmit(n,e.data.isCheckout)}}transformCrossOriginEvent(e,t){var n;switch(t.type){case _l.FullSnapshot:return this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e),{timestamp:t.timestamp,type:_l.IncrementalSnapshot,data:{source:Il.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}};case _l.Meta:case _l.Load:case _l.DomContentLoaded:return!1;case _l.Plugin:return t;case _l.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case _l.IncrementalSnapshot:switch(t.data.source){case Il.Mutation:return t.data.adds.forEach(t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e)}),t.data.removes.forEach(t=>{this.replaceIds(t,e,["parentId","id"])}),t.data.attributes.forEach(t=>{this.replaceIds(t,e,["id"])}),t.data.texts.forEach(t=>{this.replaceIds(t,e,["id"])}),t;case Il.Drag:case Il.TouchMove:case Il.MouseMove:return t.data.positions.forEach(t=>{this.replaceIds(t,e,["id"])}),t;case Il.ViewportResize:return!1;case Il.MediaInteraction:case Il.MouseInteraction:case Il.Scroll:case Il.CanvasMutation:case Il.Input:return this.replaceIds(t.data,e,["id"]),t;case Il.StyleSheetRule:case Il.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case Il.Font:return t;case Il.Selection:return t.data.ranges.forEach(t=>{this.replaceIds(t,e,["start","end"])}),t;case Il.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),null===(n=t.data.styles)||void 0===n||n.forEach(t=>{this.replaceStyleIds(t,e,["styleId"])}),t}}}replace(e,t,n,r){for(const s of r)(Array.isArray(t[s])||"number"==typeof t[s])&&(Array.isArray(t[s])?t[s]=e.getIds(n,t[s]):t[s]=e.getId(n,t[s]));return t}replaceIds(e,t,n){return this.replace(this.crossOriginIframeMirror,e,t,n)}replaceStyleIds(e,t,n){return this.replace(this.crossOriginIframeStyleMirror,e,t,n)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id"]),"childNodes"in e&&e.childNodes.forEach(e=>{this.replaceIdOnNode(e,t)})}}class ec{constructor(e){this.shadowDoms=new WeakSet,this.restorePatches=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror;const t=this;this.restorePatches.push(pl(Element.prototype,"attachShadow",function(e){return function(n){const r=e.call(this,n);return this.shadowRoot&&t.addShadowRoot(this.shadowRoot,this.ownerDocument),r}}))}addShadowRoot(e,t){Da(e)&&(this.shadowDoms.has(e)||(this.shadowDoms.add(e),zl(Object.assign(Object.assign({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e),Gl(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),Xl({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e)},0)))}observeAttachShadow(e){if(e.contentWindow){const t=this;this.restorePatches.push(pl(e.contentWindow.HTMLElement.prototype,"attachShadow",function(n){return function(r){const s=n.call(this,r);return this.shadowRoot&&t.addShadowRoot(this.shadowRoot,e.contentDocument),s}}))}}reset(){this.restorePatches.forEach(e=>e()),this.shadowDoms=new WeakSet}}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */function tc(e,t,n,r){return new(n||(n=Promise))(function(t,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function i(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n(function(e){e(r)})).then(o,i)}a((r=r.apply(e,[])).next())})}for(var nc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rc="undefined"==typeof Uint8Array?[]:new Uint8Array(256),sc=0;sc<64;sc++)rc[nc.charCodeAt(sc)]=sc;const oc=new Map;const ic=(e,t,n)=>{if(!e||!cc(e,t)&&"object"!=typeof e)return;const r=function(e,t){let n=oc.get(e);return n||(n=new Map,oc.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}(n,e.constructor.name);let s=r.indexOf(e);return-1===s&&(s=r.length,r.push(e)),s};function ac(e,t,n){if(e instanceof Array)return e.map(e=>ac(e,t,n));if(null===e)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray){return{rr_type:e.constructor.name,args:[Object.values(e)]}}if(e instanceof ArrayBuffer){const t=e.constructor.name,n=function(e){var t,n=new Uint8Array(e),r=n.length,s="";for(t=0;t<r;t+=3)s+=nc[n[t]>>2],s+=nc[(3&n[t])<<4|n[t+1]>>4],s+=nc[(15&n[t+1])<<2|n[t+2]>>6],s+=nc[63&n[t+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s}(e);return{rr_type:t,base64:n}}if(e instanceof DataView){return{rr_type:e.constructor.name,args:[ac(e.buffer,t,n),e.byteOffset,e.byteLength]}}if(e instanceof HTMLImageElement){const t=e.constructor.name,{src:n}=e;return{rr_type:t,src:n}}if(e instanceof HTMLCanvasElement){return{rr_type:"HTMLImageElement",src:e.toDataURL()}}if(e instanceof ImageData){return{rr_type:e.constructor.name,args:[ac(e.data,t,n),e.width,e.height]}}if(cc(e,t)||"object"==typeof e){return{rr_type:e.constructor.name,index:ic(e,t,n)}}return e}const lc=(e,t,n)=>[...e].map(e=>ac(e,t,n)),cc=(e,t)=>{const n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(e=>"function"==typeof t[e]);return Boolean(n.find(n=>e instanceof t[n]))};function uc(e,t,n){const r=[];try{const s=pl(e.HTMLCanvasElement.prototype,"getContext",function(e){return function(r,...s){return ml(this,t,n,!0)||"__context"in this||(this.__context=r),e.apply(this,[r,...s])}});r.push(s)}catch(e){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{r.forEach(e=>e())}}function hc(e,t,n,r,s,o,i){const a=[],l=Object.getOwnPropertyNames(e);for(const o of l)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(o))try{if("function"!=typeof e[o])continue;const l=pl(e,o,function(e){return function(...a){const l=e.apply(this,a);if(ic(l,i,this),!ml(this.canvas,r,s,!0)){const e=lc([...a],i,this),r={type:t,property:o,args:e};n(this.canvas,r)}return l}});a.push(l)}catch(r){const s=hl(e,o,{set(e){n(this.canvas,{type:t,property:o,args:[e],setter:!0})}});a.push(s)}return a}var pc=null;try{var dc="undefined"!=typeof module&&"function"==typeof module.require&&module.require("worker_threads")||"function"==typeof __non_webpack_require__&&__non_webpack_require__("worker_threads")||"function"==typeof require&&require("worker_threads");pc=dc.Worker}catch(e){}function fc(e,t,n){var r=function(e){return Buffer.from(e,"base64").toString("utf8")}(e),s=r.indexOf("\n",10)+1,o=r.substring(s)+"";return function(e){return new pc(o,Object.assign({},e,{eval:!0}))}}function mc(e,t,n){var r=function(e){return atob(e)}(e),s=r.indexOf("\n",10)+1,o=r.substring(s)+"",i=new Blob([o],{type:"application/javascript"});return URL.createObjectURL(i)}var gc="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);var yc=function(e){return gc?fc(e):function(e){var t;return function(n){return t=t||mc(e),new Worker(t,n)}}(e)}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLg0KDQogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55DQogICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgNCiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCiAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NDQogICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1INCiAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KDQogICAgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgew0KICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH0NCiAgICAgICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOw0KICAgICAgICB9KTsNCiAgICB9CgogICAgLyoKICAgICAqIGJhc2U2NC1hcnJheWJ1ZmZlciAxLjAuMSA8aHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlcj4KICAgICAqIENvcHlyaWdodCAoYykgMjAyMSBOaWtsYXMgdm9uIEhlcnR6ZW4gPGh0dHBzOi8vaGVydHplbi5jb20+CiAgICAgKiBSZWxlYXNlZCB1bmRlciBNSVQgTGljZW5zZQogICAgICovCiAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICAvLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguCiAgICB2YXIgbG9va3VwID0gdHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnID8gW10gOiBuZXcgVWludDhBcnJheSgyNTYpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGxvb2t1cFtjaGFycy5jaGFyQ29kZUF0KGkpXSA9IGk7CiAgICB9CiAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyKSB7CiAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLCBpLCBsZW4gPSBieXRlcy5sZW5ndGgsIGJhc2U2NCA9ICcnOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykgewogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgJz0nOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgJz09JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJhc2U2NDsKICAgIH07CgogICAgY29uc3QgbGFzdEJsb2JNYXAgPSBuZXcgTWFwKCk7DQogICAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucykgew0KICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgew0KICAgICAgICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50QmxvYk1hcC5oYXMoaWQpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0geWllbGQgYmxvYi5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsNCiAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBiaXRtYXAuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSB5aWVsZCBibG9iLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgKHlpZWxkIHRyYW5zcGFyZW50QmFzZTY0KSA9PT0gYmFzZTY0KSB7DQogICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUsDQogICAgICAgICAgICAgICAgICAgIGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=");class vc{constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(e,t)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};const{sampling:t="all",win:n,blockClass:r,blockSelector:s,recordCanvas:o,dataURLOptions:i}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,o&&"all"===t&&this.initCanvasMutationObserver(n,r,s),o&&"number"==typeof t&&this.initCanvasFPSObserver(t,n,r,s,{dataURLOptions:i})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(e,t,n,r,s){const o=uc(t,n,r),i=new Map,a=new yc;a.onmessage=e=>{const{id:t}=e.data;if(i.set(t,!1),!("base64"in e.data))return;const{base64:n,type:r,width:s,height:o}=e.data;this.mutationCb({id:t,type:El["2D"],commands:[{property:"clearRect",args:[0,0,s,o]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:n}],type:r}]},0,0]}]})};const l=1e3/e;let c,u=0;const h=e=>{u&&e-u<l||(u=e,(()=>{const e=[];return t.document.querySelectorAll("canvas").forEach(t=>{ml(t,n,r,!0)||e.push(t)}),e})().forEach(e=>tc(this,0,void 0,function*(){var t;const n=this.mirror.getId(e);if(i.get(n))return;if(i.set(n,!0),["webgl","webgl2"].includes(e.__context)){const n=e.getContext(e.__context);!1===(null===(t=null==n?void 0:n.getContextAttributes())||void 0===t?void 0:t.preserveDrawingBuffer)&&(null==n||n.clear(n.COLOR_BUFFER_BIT))}const r=yield createImageBitmap(e);a.postMessage({id:n,bitmap:r,width:e.width,height:e.height,dataURLOptions:s.dataURLOptions},[r])}))),c=requestAnimationFrame(h)};c=requestAnimationFrame(h),this.resetObservers=()=>{o(),cancelAnimationFrame(c)}}initCanvasMutationObserver(e,t,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const r=uc(e,t,n),s=function(e,t,n,r){const s=[],o=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const i of o)try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[i])continue;const o=pl(t.CanvasRenderingContext2D.prototype,i,function(s){return function(...o){return ml(this.canvas,n,r,!0)||setTimeout(()=>{const n=lc([...o],t,this);e(this.canvas,{type:El["2D"],property:i,args:n})},0),s.apply(this,o)}});s.push(o)}catch(n){const r=hl(t.CanvasRenderingContext2D.prototype,i,{set(t){e(this.canvas,{type:El["2D"],property:i,args:[t],setter:!0})}});s.push(r)}return()=>{s.forEach(e=>e())}}(this.processMutation.bind(this),e,t,n),o=function(e,t,n,r){const s=[];return s.push(...hc(t.WebGLRenderingContext.prototype,El.WebGL,e,n,r,0,t)),void 0!==t.WebGL2RenderingContext&&s.push(...hc(t.WebGL2RenderingContext.prototype,El.WebGL2,e,n,r,0,t)),()=>{s.forEach(e=>e())}}(this.processMutation.bind(this),e,t,n,this.mirror);this.resetObservers=()=>{r(),s(),o()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const e=t=>{this.rafStamps.latestId=t,requestAnimationFrame(e)};requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,t)=>{const n=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,n)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(e);if(!n||-1===t)return;const r=n.map(e=>{const t=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n}(e,["type"]);return t}),{type:s}=n[0];this.mutationCb({id:t,type:s,commands:r}),this.pendingCanvasMutations.delete(e)}}class bc{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new Sl,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;const n={id:t,styleIds:[]},r=[];for(const t of e){let e;if(this.styleMirror.has(t))e=this.styleMirror.getId(t);else{e=this.styleMirror.add(t);const n=Array.from(t.rules||CSSRule);r.push({styleId:e,rules:n.map((e,t)=>({rule:Fa(e),index:t}))})}n.styleIds.push(e)}r.length>0&&(n.styles=r),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}function wc(e){return Object.assign(Object.assign({},e),{timestamp:Date.now()})}let Cc,Sc,_c,Ic=!1;const Ac=new Ba;function Ec(e={}){const{emit:t,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:s="rr-block",blockSelector:o=null,ignoreClass:i="rr-ignore",maskTextClass:a="rr-mask",maskTextSelector:l=null,inlineStylesheet:c=!0,maskAllInputs:u,maskInputOptions:h,slimDOMOptions:p,maskInputFn:d,maskTextFn:f,hooks:m,packFn:g,sampling:y={},dataURLOptions:v={},mousemoveWait:b,recordCanvas:w=!1,recordCrossOriginIframes:C=!1,userTriggeredOnInput:S=!1,collectFonts:_=!1,inlineImages:I=!1,plugins:A,keepIframeSrcFn:E=()=>!1,ignoreCSSAttributes:k=new Set([])}=e,T=!C||window.parent===window;let O=!1;if(!T)try{window.parent.document,O=!1}catch(e){O=!0}if(T&&!t)throw new Error("emit function is required");void 0!==b&&void 0===y.mousemove&&(y.mousemove=b),Ac.reset();const R=!0===u?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==h?h:{password:!0},x=!0===p||"all"===p?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===p,headMetaDescKeywords:"all"===p}:p||{};let N;!function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}();let M=0;const L=e=>{for(const t of A||[])t.eventProcessor&&(e=t.eventProcessor(e));return g&&(e=g(e)),e};Cc=(e,s)=>{var o;if(!(null===(o=Pl[0])||void 0===o?void 0:o.isFrozen())||e.type===_l.FullSnapshot||e.type===_l.IncrementalSnapshot&&e.data.source===Il.Mutation||Pl.forEach(e=>e.unfreeze()),T)null==t||t(L(e),s);else if(O){const t={type:"rrweb",event:L(e),isCheckout:s};window.parent.postMessage(t,"*")}if(e.type===_l.FullSnapshot)N=e,M=0;else if(e.type===_l.IncrementalSnapshot){if(e.data.source===Il.Mutation&&e.data.isAttachIframe)return;M++;const t=r&&M>=r,s=n&&e.timestamp-N.timestamp>n;(t||s)&&Sc(!0)}};const D=e=>{Cc(wc({type:_l.IncrementalSnapshot,data:Object.assign({source:Il.Mutation},e)}))},P=e=>Cc(wc({type:_l.IncrementalSnapshot,data:Object.assign({source:Il.Scroll},e)})),F=e=>Cc(wc({type:_l.IncrementalSnapshot,data:Object.assign({source:Il.CanvasMutation},e)})),B=new bc({mutationCb:D,adoptedStyleSheetCb:e=>Cc(wc({type:_l.IncrementalSnapshot,data:Object.assign({source:Il.AdoptedStyleSheet},e)}))}),U=new $l({mirror:Ac,mutationCb:D,stylesheetManager:B,recordCrossOriginIframes:C,wrappedEmit:Cc});for(const e of A||[])e.getMirror&&e.getMirror({nodeMirror:Ac,crossOriginIframeMirror:U.crossOriginIframeMirror,crossOriginIframeStyleMirror:U.crossOriginIframeStyleMirror});_c=new vc({recordCanvas:w,mutationCb:F,win:window,blockClass:s,blockSelector:o,mirror:Ac,sampling:y.canvas,dataURLOptions:v});const Z=new ec({mutationCb:D,scrollCb:P,bypassOptions:{blockClass:s,blockSelector:o,maskTextClass:a,maskTextSelector:l,inlineStylesheet:c,maskInputOptions:R,dataURLOptions:v,maskTextFn:f,maskInputFn:d,recordCanvas:w,inlineImages:I,sampling:y,slimDOMOptions:x,iframeManager:U,stylesheetManager:B,canvasManager:_c,keepIframeSrcFn:E},mirror:Ac});Sc=(e=!1)=>{var t,n,r,i,u,h;Cc(wc({type:_l.Meta,data:{href:window.location.href,width:fl(),height:dl()}}),e),B.reset(),Pl.forEach(e=>e.lock());const p=function(e,t){var n=t||{},r=n.mirror,s=void 0===r?new Ba:r,o=n.blockClass,i=void 0===o?"rr-block":o,a=n.blockSelector,l=void 0===a?null:a,c=n.maskTextClass,u=void 0===c?"rr-mask":c,h=n.maskTextSelector,p=void 0===h?null:h,d=n.inlineStylesheet,f=void 0===d||d,m=n.inlineImages,g=void 0!==m&&m,y=n.recordCanvas,v=void 0!==y&&y,b=n.maskAllInputs,w=void 0!==b&&b,C=n.maskTextFn,S=n.maskInputFn,_=n.slimDOM,I=void 0!==_&&_,A=n.dataURLOptions,E=n.preserveWhiteSpace,k=n.onSerialize,T=n.onIframeLoad,O=n.iframeLoadTimeout,R=n.onStylesheetLoad,x=n.stylesheetLoadTimeout,N=n.keepIframeSrcFn;return il(e,{doc:e,mirror:s,blockClass:i,blockSelector:l,maskTextClass:u,maskTextSelector:p,skipChild:!1,inlineStylesheet:f,maskInputOptions:!0===w?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===w?{password:!0}:w,maskTextFn:C,maskInputFn:S,slimDOMOptions:!0===I||"all"===I?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===I,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===I?{}:I,dataURLOptions:A,inlineImages:g,recordCanvas:v,preserveWhiteSpace:E,onSerialize:k,onIframeLoad:T,iframeLoadTimeout:O,onStylesheetLoad:R,stylesheetLoadTimeout:x,keepIframeSrcFn:void 0===N?function(){return!1}:N,newlyAddedElement:!1})}(document,{mirror:Ac,blockClass:s,blockSelector:o,maskTextClass:a,maskTextSelector:l,inlineStylesheet:c,maskAllInputs:R,maskTextFn:f,slimDOM:x,dataURLOptions:v,recordCanvas:w,inlineImages:I,onSerialize:e=>{bl(e,Ac)&&U.addIframe(e),wl(e,Ac)&&B.trackLinkElement(e),Cl(e)&&Z.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{U.attachIframe(e,t),Z.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{B.attachLinkElement(e,t)},keepIframeSrcFn:E});if(!p)return console.warn("Failed to snapshot the document");Cc(wc({type:_l.FullSnapshot,data:{node:p,initialOffset:{left:void 0!==window.pageXOffset?window.pageXOffset:(null===document||void 0===document?void 0:document.documentElement.scrollLeft)||(null===(n=null===(t=null===document||void 0===document?void 0:document.body)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.scrollLeft)||(null===(r=null===document||void 0===document?void 0:document.body)||void 0===r?void 0:r.scrollLeft)||0,top:void 0!==window.pageYOffset?window.pageYOffset:(null===document||void 0===document?void 0:document.documentElement.scrollTop)||(null===(u=null===(i=null===document||void 0===document?void 0:document.body)||void 0===i?void 0:i.parentElement)||void 0===u?void 0:u.scrollTop)||(null===(h=null===document||void 0===document?void 0:document.body)||void 0===h?void 0:h.scrollTop)||0}}})),Pl.forEach(e=>e.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&B.adoptStyleSheets(document.adoptedStyleSheets,Ac.getId(document))};try{const e=[];e.push(al("DOMContentLoaded",()=>{Cc(wc({type:_l.DomContentLoaded,data:{}}))}));const t=e=>{var t;return ql({mutationCb:D,mousemoveCb:(e,t)=>Cc(wc({type:_l.IncrementalSnapshot,data:{source:t,positions:e}})),mouseInteractionCb:e=>Cc(wc({type:_l.IncrementalSnapshot,data:Object.assign({source:Il.MouseInteraction},e)})),scrollCb:P,viewportResizeCb:e=>Cc(wc({type:_l.IncrementalSnapshot,data:Object.assign({source:Il.ViewportResize},e)})),inputCb:e=>Cc(wc({type:_l.IncrementalSnapshot,data:Object.assign({source:Il.Input},e)})),mediaInteractionCb:e=>Cc(wc({type:_l.IncrementalSnapshot,data:Object.assign({source:Il.MediaInteraction},e)})),styleSheetRuleCb:e=>Cc(wc({type:_l.IncrementalSnapshot,data:Object.assign({source:Il.StyleSheetRule},e)})),styleDeclarationCb:e=>Cc(wc({type:_l.IncrementalSnapshot,data:Object.assign({source:Il.StyleDeclaration},e)})),canvasMutationCb:F,fontCb:e=>Cc(wc({type:_l.IncrementalSnapshot,data:Object.assign({source:Il.Font},e)})),selectionCb:e=>{Cc(wc({type:_l.IncrementalSnapshot,data:Object.assign({source:Il.Selection},e)}))},blockClass:s,ignoreClass:i,maskTextClass:a,maskTextSelector:l,maskInputOptions:R,inlineStylesheet:c,sampling:y,recordCanvas:w,inlineImages:I,userTriggeredOnInput:S,collectFonts:_,doc:e,maskInputFn:d,maskTextFn:f,keepIframeSrcFn:E,blockSelector:o,slimDOMOptions:x,dataURLOptions:v,mirror:Ac,iframeManager:U,stylesheetManager:B,shadowDomManager:Z,canvasManager:_c,ignoreCSSAttributes:k,plugins:(null===(t=null==A?void 0:A.filter(e=>e.observer))||void 0===t?void 0:t.map(e=>({observer:e.observer,options:e.options,callback:t=>Cc(wc({type:_l.Plugin,data:{plugin:e.name,payload:t}}))})))||[]},m)};U.addLoadListener(n=>{e.push(t(n.contentDocument))});const n=()=>{Sc(),e.push(t(document)),Ic=!0};return"interactive"===document.readyState||"complete"===document.readyState?n():e.push(al("load",()=>{Cc(wc({type:_l.Load,data:{}})),n()},window)),()=>{e.forEach(e=>e()),Ic=!1}}catch(e){console.warn(e)}}Ec.addCustomEvent=(e,t)=>{if(!Ic)throw new Error("please add custom event after start recording");Cc(wc({type:_l.Custom,data:{tag:e,payload:t}}))},Ec.freezePage=()=>{Pl.forEach(e=>e.freeze())},Ec.takeFullSnapshot=e=>{if(!Ic)throw new Error("please take full snapshot after start recording");Sc(e)},Ec.mirror=Ac;const kc=5e3;class Tc{constructor(e,t){this.events=[],this.stopRecording=void 0,this.saveInterval=null,this.isSaving=!1,this.isConfigured=!1,this.sessionId=t,this.config=e,this.events=[],this.save=this.save.bind(this),this.configure=this.configure.bind(this),this.handleUnload=this.handleUnload.bind(this),this.handleVisibilityChange=this.handleVisibilityChange.bind(this),this.setupEventListeners()}setupEventListeners(){window.addEventListener("beforeunload",this.handleUnload),document.addEventListener("visibilitychange",this.handleVisibilityChange),window.addEventListener("pagehide",this.handleUnload)}handleUnload(){this.save(!0)}handleVisibilityChange(){"hidden"===document.visibilityState&&this.save()}configure(){var e;if(this.isConfigured)console.warn("MonoscopeReplay already configured");else try{this.stopRecording=Ec({emit:e=>{this.events.push(e),this.events.length>=50&&this.save()},blockClass:"rr-block",maskAllInputs:!0,maskInputOptions:{password:!0,email:!0,tel:!0},maskTextClass:"rr-mask",checkoutEveryNms:15e3,sampling:{mouseInteraction:{MouseUp:!1,MouseDown:!1,Click:!0,ContextMenu:!1,DblClick:!0,Focus:!1,Blur:!1,TouchStart:!0,TouchEnd:!1},mousemove:!0,scroll:150,media:800,input:"last"},plugins:[(e={level:["info","log","warn","error"],lengthThreshold:1e4,stringifyOptions:{stringLengthLimit:1e3,numOfKeysLimit:100,depthOfLimit:2}},{name:"rrweb/console@1",observer:Na,options:e})]}),this.saveInterval=setInterval(()=>{this.save()},2e3),this.isConfigured=!0,console.log("MonoscopeReplay configured successfully")}catch(e){throw console.error("Failed to configure MonoscopeReplay:",e),e}}async save(e=!1){if(this.isSaving&&!e)return;if(0===this.events.length)return;if(this.events.length>kc){console.warn("Event queue exceeded 5000, dropping middle events (preserving snapshots)");const e=this.events.filter(e=>2===e.type),t=this.events.filter(e=>2!==e.type),n=kc-e.length;this.events=[...e,...t.slice(-n)],this.events.sort((e,t)=>e.timestamp-t.timestamp)}this.isSaving=!0;const{replayEventsBaseUrl:t,projectId:n}=this.config;let r=t||"https://app.monoscope.tech";r=`${r}/rrweb/${n}`;const s=[...this.events];this.events=[];const o={events:s,sessionId:this.sessionId,timestamp:(new Date).toISOString(),eventCount:s.length};try{if(e&&navigator.sendBeacon){const e=new Blob([JSON.stringify(o)],{type:"application/json"});navigator.sendBeacon(r,e)||console.warn("sendBeacon failed, events may be lost")}else{const e=JSON.stringify(o),t=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:e,keepalive:e.length<63e3});if(!t.ok)throw new Error(`Failed to save replay events: ${t.status} ${t.statusText}`);console.log(`Successfully saved ${s.length} replay events`)}}catch(e){if(console.error("Failed to save replay events:",e),this.events=[...s,...this.events],this.events.length>kc){const e=this.events.filter(e=>2===e.type),t=this.events.filter(e=>2!==e.type),n=kc-e.length;this.events=[...e,...t.slice(-n)],this.events.sort((e,t)=>e.timestamp-t.timestamp)}}finally{this.isSaving=!1}}stop(){this.save(!0),this.stopRecording&&(this.stopRecording(),this.stopRecording=void 0),this.saveInterval&&(clearInterval(this.saveInterval),this.saveInterval=null),window.removeEventListener("beforeunload",this.handleUnload),window.removeEventListener("pagehide",this.handleUnload),document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.isConfigured=!1,console.log("MonoscopeReplay stopped")}getEventCount(){return this.events.length}getSessionId(){return this.sessionId}isRecording(){return this.isConfigured&&null!==this.stopRecording}}var Oc="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},Rc="1.9.0",xc=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;var Nc=function(e){var t=new Set([e]),n=new Set,r=e.match(xc);if(!r)return function(){return!1};var s=+r[1],o=+r[2],i=+r[3];if(null!=r[4])return function(t){return t===e};function a(e){return n.add(e),!1}function l(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(n.has(e))return!1;var r=e.match(xc);if(!r)return a(e);var c=+r[1],u=+r[2],h=+r[3];return null!=r[4]||s!==c?a(e):0===s?o===u&&i<=h?l(e):a(e):o<=u?l(e):a(e)}}(Rc),Mc=Rc.split(".")[0],Lc=Symbol.for("opentelemetry.js.api."+Mc),Dc=Oc;function Pc(e,t,n,r){var s;void 0===r&&(r=!1);var o=Dc[Lc]=null!==(s=Dc[Lc])&&void 0!==s?s:{version:Rc};if(!r&&o[e]){var i=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(i.stack||i.message),!1}if(o.version!==Rc){i=new Error("@opentelemetry/api: Registration of version v"+o.version+" for "+e+" does not match previously registered API v"+Rc);return n.error(i.stack||i.message),!1}return o[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+Rc+"."),!0}function Fc(e){var t,n,r=null===(t=Dc[Lc])||void 0===t?void 0:t.version;if(r&&Nc(r))return null===(n=Dc[Lc])||void 0===n?void 0:n[e]}function Bc(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+Rc+".");var n=Dc[Lc];n&&delete n[e]}var Uc,Zc=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,s,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(s)throw s.error}}return i},jc=function(e,t,n){if(n||2===arguments.length)for(var r,s=0,o=t.length;s<o;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))},zc=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Vc("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Vc("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Vc("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Vc("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Vc("verbose",this._namespace,e)},e}();function Vc(e,t,n){var r=Fc("diag");if(r)return n.unshift(t),r[e].apply(r,jc([],Zc(n),!1))}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(Uc||(Uc={}));var Gc=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,s,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(s)throw s.error}}return i},Wc=function(e,t,n){if(n||2===arguments.length)for(var r,s=0,o=t.length;s<o;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))},Hc=function(){function e(){function e(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Fc("diag");if(r)return r[e].apply(r,Wc([],Gc(t),!1))}}var t=this;t.setLogger=function(e,n){var r,s,o;if(void 0===n&&(n={logLevel:Uc.INFO}),e===t){var i=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(r=i.stack)&&void 0!==r?r:i.message),!1}"number"==typeof n&&(n={logLevel:n});var a=Fc("diag"),l=function(e,t){function n(n,r){var s=t[n];return"function"==typeof s&&e>=r?s.bind(t):function(){}}return e<Uc.NONE?e=Uc.NONE:e>Uc.ALL&&(e=Uc.ALL),t=t||{},{error:n("error",Uc.ERROR),warn:n("warn",Uc.WARN),info:n("info",Uc.INFO),debug:n("debug",Uc.DEBUG),verbose:n("verbose",Uc.VERBOSE)}}(null!==(s=n.logLevel)&&void 0!==s?s:Uc.INFO,e);if(a&&!n.suppressOverrideMessage){var c=null!==(o=(new Error).stack)&&void 0!==o?o:"<failed to generate stacktrace>";a.warn("Current logger will be overwritten from "+c),l.warn("Current logger will overwrite one already registered from "+c)}return Pc("diag",l,t,!0)},t.disable=function(){Bc("diag",t)},t.createComponentLogger=function(e){return new zc(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),Yc=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,s,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(s)throw s.error}}return i},Kc=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Jc=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(e){var t=Yc(e,2);return[t[0],t[1]]})},e.prototype.setEntry=function(t,n){var r=new e(this._entries);return r._entries.set(t,n),r},e.prototype.removeEntry=function(t){var n=new e(this._entries);return n._entries.delete(t),n},e.prototype.removeEntries=function(){for(var t,n,r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];var o=new e(this._entries);try{for(var i=Kc(r),a=i.next();!a.done;a=i.next()){var l=a.value;o._entries.delete(l)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o},e.prototype.clear=function(){return new e},e}(),Xc=Symbol("BaggageEntryMetadata"),qc=Hc.instance();function Qc(e){return void 0===e&&(e={}),new Jc(new Map(Object.entries(e)))}function $c(e){return Symbol.for(e)}var eu,tu,nu=function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(e){return n._currentContext.get(e)},n.setValue=function(t,r){var s=new e(n._currentContext);return s._currentContext.set(t,r),s},n.deleteValue=function(t){var r=new e(n._currentContext);return r._currentContext.delete(t),r}},ru=new nu,su=(eu=function(e,t){return eu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},eu(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}eu(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),ou=function(){function e(){}return e.prototype.createGauge=function(e,t){return yu},e.prototype.createHistogram=function(e,t){return vu},e.prototype.createCounter=function(e,t){return gu},e.prototype.createUpDownCounter=function(e,t){return bu},e.prototype.createObservableGauge=function(e,t){return Cu},e.prototype.createObservableCounter=function(e,t){return wu},e.prototype.createObservableUpDownCounter=function(e,t){return Su},e.prototype.addBatchObservableCallback=function(e,t){},e.prototype.removeBatchObservableCallback=function(e){},e}(),iu=function(){},au=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return su(t,e),t.prototype.add=function(e,t){},t}(iu),lu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return su(t,e),t.prototype.add=function(e,t){},t}(iu),cu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return su(t,e),t.prototype.record=function(e,t){},t}(iu),uu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return su(t,e),t.prototype.record=function(e,t){},t}(iu),hu=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.removeCallback=function(e){},e}(),pu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return su(t,e),t}(hu),du=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return su(t,e),t}(hu),fu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return su(t,e),t}(hu),mu=new ou,gu=new au,yu=new cu,vu=new uu,bu=new lu,wu=new pu,Cu=new du,Su=new fu,_u={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},Iu={set:function(e,t,n){null!=e&&(e[t]=n)}},Au=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,s,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(s)throw s.error}}return i},Eu=function(e,t,n){if(n||2===arguments.length)for(var r,s=0,o=t.length;s<o;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))},ku=function(){function e(){}return e.prototype.active=function(){return ru},e.prototype.with=function(e,t,n){for(var r=[],s=3;s<arguments.length;s++)r[s-3]=arguments[s];return t.call.apply(t,Eu([n],Au(r),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),Tu=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,s,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(s)throw s.error}}return i},Ou=function(e,t,n){if(n||2===arguments.length)for(var r,s=0,o=t.length;s<o;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))},Ru="context",xu=new ku,Nu=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return Pc(Ru,e,Hc.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,n){for(var r,s=[],o=3;o<arguments.length;o++)s[o-3]=arguments[o];return(r=this._getContextManager()).with.apply(r,Ou([e,t,n],Tu(s),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return Fc(Ru)||xu},e.prototype.disable=function(){this._getContextManager().disable(),Bc(Ru,Hc.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(tu||(tu={}));var Mu="0000000000000000",Lu="00000000000000000000000000000000",Du={traceId:Lu,spanId:Mu,traceFlags:tu.NONE},Pu=function(){function e(e){void 0===e&&(e=Du),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.addLink=function(e){return this},e.prototype.addLinks=function(e){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),Fu=$c("OpenTelemetry Context Key SPAN");function Bu(e){return e.getValue(Fu)||void 0}function Uu(){return Bu(Nu.getInstance().active())}function Zu(e,t){return e.setValue(Fu,t)}function ju(e){return e.deleteValue(Fu)}function zu(e,t){return Zu(e,new Pu(t))}function Vu(e){var t;return null===(t=Bu(e))||void 0===t?void 0:t.spanContext()}var Gu=/^([0-9a-f]{32})$/i,Wu=/^[0-9a-f]{16}$/i;function Hu(e){return Gu.test(e)&&e!==Lu}function Yu(e){return Hu(e.traceId)&&(t=e.spanId,Wu.test(t)&&t!==Mu);var t}function Ku(e){return new Pu(e)}var Ju=Nu.getInstance(),Xu=function(){function e(){}return e.prototype.startSpan=function(e,t,n){if(void 0===n&&(n=Ju.active()),Boolean(null==t?void 0:t.root))return new Pu;var r,s=n&&Vu(n);return"object"==typeof(r=s)&&"string"==typeof r.spanId&&"string"==typeof r.traceId&&"number"==typeof r.traceFlags&&Yu(s)?new Pu(s):new Pu},e.prototype.startActiveSpan=function(e,t,n,r){var s,o,i;if(!(arguments.length<2)){2===arguments.length?i=t:3===arguments.length?(s=t,i=n):(s=t,o=n,i=r);var a=null!=o?o:Ju.active(),l=this.startSpan(e,s,a),c=Zu(a,l);return Ju.with(c,i,void 0,l)}},e}();var qu,Qu,$u,eh=new Xu,th=function(){function e(e,t,n,r){this._provider=e,this.name=t,this.version=n,this.options=r}return e.prototype.startSpan=function(e,t,n){return this._getTracer().startSpan(e,t,n)},e.prototype.startActiveSpan=function(e,t,n,r){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):eh},e}(),nh=new(function(){function e(){}return e.prototype.getTracer=function(e,t,n){return new Xu},e}()),rh=function(){function e(){}return e.prototype.getTracer=function(e,t,n){var r;return null!==(r=this.getDelegateTracer(e,t,n))&&void 0!==r?r:new th(this,e,t,n)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:nh},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(e,t,n)},e}();!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(qu||(qu={})),function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(Qu||(Qu={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}($u||($u={}));var sh=Nu.getInstance(),oh=Hc.instance(),ih=new(function(){function e(){}return e.prototype.getMeter=function(e,t,n){return mu},e}()),ah="metrics",lh=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalMeterProvider=function(e){return Pc(ah,e,Hc.instance())},e.prototype.getMeterProvider=function(){return Fc(ah)||ih},e.prototype.getMeter=function(e,t,n){return this.getMeterProvider().getMeter(e,t,n)},e.prototype.disable=function(){Bc(ah,Hc.instance())},e}().getInstance(),ch=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}(),uh=$c("OpenTelemetry Baggage Key");function hh(e){return e.getValue(uh)||void 0}function ph(){return hh(Nu.getInstance().active())}function dh(e,t){return e.setValue(uh,t)}function fh(e){return e.deleteValue(uh)}var mh="propagation",gh=new ch,yh=function(){function e(){this.createBaggage=Qc,this.getBaggage=hh,this.getActiveBaggage=ph,this.setBaggage=dh,this.deleteBaggage=fh}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return Pc(mh,e,Hc.instance())},e.prototype.inject=function(e,t,n){return void 0===n&&(n=Iu),this._getGlobalPropagator().inject(e,t,n)},e.prototype.extract=function(e,t,n){return void 0===n&&(n=_u),this._getGlobalPropagator().extract(e,t,n)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){Bc(mh,Hc.instance())},e.prototype._getGlobalPropagator=function(){return Fc(mh)||gh},e}(),vh=yh.getInstance(),bh="trace",wh=function(){function e(){this._proxyTracerProvider=new rh,this.wrapSpanContext=Ku,this.isSpanContextValid=Yu,this.deleteSpan=ju,this.getSpan=Bu,this.getActiveSpan=Uu,this.getSpanContext=Vu,this.setSpan=Zu,this.setSpanContext=zu}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=Pc(bh,this._proxyTracerProvider,Hc.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return Fc(bh)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){Bc(bh,Hc.instance()),this._proxyTracerProvider=new rh},e}().getInstance();const Ch=$c("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function Sh(e){return!0===e.getValue(Ch)}const _h="baggage";function Ih(e){const t=e.split(";");if(t.length<=0)return;const n=t.shift();if(!n)return;const r=n.indexOf("=");if(r<=0)return;const s=decodeURIComponent(n.substring(0,r).trim()),o=decodeURIComponent(n.substring(r+1).trim());let i;var a;return t.length>0&&("string"!=typeof(a=t.join(";"))&&(qc.error("Cannot create baggage metadata from unknown type: "+typeof a),a=""),i={__TYPE__:Xc,toString:function(){return a}}),{key:s,value:o,metadata:i}}class Ah{inject(e,t,n){const r=vh.getBaggage(e);if(!r||Sh(e))return;const s=function(e){return e.getAllEntries().map(([e,t])=>{let n=`${encodeURIComponent(e)}=${encodeURIComponent(t.value)}`;return void 0!==t.metadata&&(n+=";"+t.metadata.toString()),n})}(r).filter(e=>e.length<=4096).slice(0,180),o=function(e){return e.reduce((e,t)=>{const n=`${e}${""!==e?",":""}${t}`;return n.length>8192?e:n},"")}(s);o.length>0&&n.set(t,_h,o)}extract(e,t,n){const r=n.get(t,_h),s=Array.isArray(r)?r.join(","):r;if(!s)return e;const o={};if(0===s.length)return e;return s.split(",").forEach(e=>{const t=Ih(e);if(t){const e={value:t.value};t.metadata&&(e.metadata=t.metadata),o[t.key]=e}}),0===Object.entries(o).length?e:vh.setBaggage(e,vh.createBaggage(o))}fields(){return[_h]}}function Eh(e){const t={};if("object"!=typeof e||null==e)return t;for(const[n,r]of Object.entries(e))kh(n)?Th(r)?Array.isArray(r)?t[n]=r.slice():t[n]=r:oh.warn(`Invalid attribute value set for key: ${n}`):oh.warn(`Invalid attribute key: ${n}`);return t}function kh(e){return"string"==typeof e&&e.length>0}function Th(e){return null==e||(Array.isArray(e)?function(e){let t;for(const n of e)if(null!=n){if(!t){if(Oh(n)){t=typeof n;continue}return!1}if(typeof n!==t)return!1}return!0}(e):Oh(e))}function Oh(e){switch(typeof e){case"number":case"boolean":case"string":return!0}return!1}let Rh=e=>{oh.error(function(e){return"string"==typeof e?e:JSON.stringify(function(e){const t={};let n=e;for(;null!==n;)Object.getOwnPropertyNames(n).forEach(e=>{if(t[e])return;const r=n[e];r&&(t[e]=String(r))}),n=Object.getPrototypeOf(n);return t}(e))}(e))};function xh(e){try{Rh(e)}catch{}}const Nh="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},Mh=performance,Lh="http.url",Dh="error.type",Ph="exception.message",Fh="exception.type",Bh="http.request.method",Uh="http.request.method_original",Zh="http.response.status_code",jh="server.address",zh="server.port",Vh="service.name",Gh="telemetry.sdk.language",Wh="telemetry.sdk.name",Hh="telemetry.sdk.version",Yh="url.full",Kh="process.runtime.name",Jh={[Wh]:"opentelemetry",[Kh]:"browser",[Gh]:"webjs",[Hh]:"2.0.1"};const Xh=Math.pow(10,6),qh=Math.pow(10,9);function Qh(e){const t=e/1e3;return[Math.trunc(t),Math.round(e%1e3*Xh)]}function $h(){let e=Mh.timeOrigin;if("number"!=typeof e){const t=Mh;e=t.timing&&t.timing.fetchStart}return e}function ep(e){return op(Qh($h()),Qh("number"==typeof e?e:Mh.now()))}function tp(e){if(rp(e))return e;if("number"==typeof e)return e<$h()?ep(e):Qh(e);if(e instanceof Date)return Qh(e.getTime());throw TypeError("Invalid input type")}function np(e){return e[0]*qh+e[1]}function rp(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}function sp(e){return rp(e)||"number"==typeof e||e instanceof Date}function op(e,t){const n=[e[0]+t[0],e[1]+t[1]];return n[1]>=qh&&(n[1]-=qh,n[0]+=1),n}var ip;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILED=1]="FAILED"}(ip||(ip={}));class ap{_propagators;_fields;constructor(e={}){this._propagators=e.propagators??[],this._fields=Array.from(new Set(this._propagators.map(e=>"function"==typeof e.fields?e.fields():[]).reduce((e,t)=>e.concat(t),[])))}inject(e,t,n){for(const r of this._propagators)try{r.inject(e,t,n)}catch(e){oh.warn(`Failed to inject with ${r.constructor.name}. Err: ${e.message}`)}}extract(e,t,n){return this._propagators.reduce((e,r)=>{try{return r.extract(e,t,n)}catch(e){oh.warn(`Failed to extract with ${r.constructor.name}. Err: ${e.message}`)}return e},e)}fields(){return this._fields.slice()}}const lp="[_0-9a-z-*/]",cp=new RegExp(`^(?:${`[a-z]${lp}{0,255}`}|${`[a-z0-9]${lp}{0,240}@[a-z]${lp}{0,13}`})$`),up=/^[ -~]{0,255}[!-~]$/,hp=/,|=/;class pp{_internalState=new Map;constructor(e){e&&this._parse(e)}set(e,t){const n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,t),n}unset(e){const t=this._clone();return t._internalState.delete(e),t}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,t)=>(e.push(t+"="+this.get(t)),e),[]).join(",")}_parse(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((e,t)=>{const n=t.trim(),r=n.indexOf("=");if(-1!==r){const s=n.slice(0,r),o=n.slice(r+1,t.length);(function(e){return cp.test(e)})(s)&&function(e){return up.test(e)&&!hp.test(e)}(o)&&e.set(s,o)}return e},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){const e=new pp;return e._internalState=new Map(this._internalState),e}}const dp="traceparent",fp="tracestate",mp=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");class gp{inject(e,t,n){const r=wh.getSpanContext(e);if(!r||Sh(e)||!Yu(r))return;const s=`00-${r.traceId}-${r.spanId}-0${Number(r.traceFlags||tu.NONE).toString(16)}`;n.set(t,dp,s),r.traceState&&n.set(t,fp,r.traceState.serialize())}extract(e,t,n){const r=n.get(t,dp);if(!r)return e;const s=Array.isArray(r)?r[0]:r;if("string"!=typeof s)return e;const o=function(e){const t=mp.exec(e);return t?"00"===t[1]&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}:null}(s);if(!o)return e;o.isRemote=!0;const i=n.get(t,fp);if(i){const e=Array.isArray(i)?i.join(","):i;o.traceState=new pp("string"==typeof e?e:void 0)}return wh.setSpanContext(e,o)}fields(){return[dp,fp]}}const yp="[object Null]",vp="[object Undefined]",bp=Function.prototype.toString,wp=bp.call(Object),Cp=Object.getPrototypeOf,Sp=Object.prototype,_p=Sp.hasOwnProperty,Ip=Symbol?Symbol.toStringTag:void 0,Ap=Sp.toString;function Ep(e){if(!function(e){return null!=e&&"object"==typeof e}(e)||"[object Object]"!==function(e){if(null==e)return void 0===e?vp:yp;return Ip&&Ip in Object(e)?function(e){const t=_p.call(e,Ip),n=e[Ip];let r=!1;try{e[Ip]=void 0,r=!0}catch(e){}const s=Ap.call(e);r&&(t?e[Ip]=n:delete e[Ip]);return s}(e):function(e){return Ap.call(e)}(e)}(e))return!1;const t=Cp(e);if(null===t)return!0;const n=_p.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&bp.call(n)===wp}function kp(e){return Rp(e)?e.slice():e}function Tp(e,t,n=0,r){let s;if(!(n>20)){if(n++,Mp(e)||Mp(t)||xp(t))s=kp(t);else if(Rp(e)){if(s=e.slice(),Rp(t))for(let e=0,n=t.length;e<n;e++)s.push(kp(t[e]));else if(Np(t)){const e=Object.keys(t);for(let n=0,r=e.length;n<r;n++){const r=e[n];s[r]=kp(t[r])}}}else if(Np(e))if(Np(t)){if(!function(e,t){if(!Ep(e)||!Ep(t))return!1;return!0}(e,t))return t;s=Object.assign({},e);const o=Object.keys(t);for(let i=0,a=o.length;i<a;i++){const a=o[i],l=t[a];if(Mp(l))void 0===l?delete s[a]:s[a]=l;else{const o=s[a],i=l;if(Op(e,a,r)||Op(t,a,r))delete s[a];else{if(Np(o)&&Np(i)){const n=r.get(o)||[],s=r.get(i)||[];n.push({obj:e,key:a}),s.push({obj:t,key:a}),r.set(o,n),r.set(i,s)}s[a]=Tp(s[a],l,n,r)}}}}else s=t;return s}}function Op(e,t,n){const r=n.get(e[t])||[];for(let n=0,s=r.length;n<s;n++){const s=r[n];if(s.key===t&&s.obj===e)return!0}return!1}function Rp(e){return Array.isArray(e)}function xp(e){return"function"==typeof e}function Np(e){return!Mp(e)&&!Rp(e)&&!xp(e)&&"object"==typeof e}function Mp(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||void 0===e||e instanceof Date||e instanceof RegExp||null===e}function Lp(e,t){return"string"==typeof t?e===t:!!e.match(t)}function Dp(e,t){if(!t)return!1;for(const n of t)if(Lp(e,n))return!0;return!1}class Pp{_promise;_resolve;_reject;constructor(){this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}get promise(){return this._promise}resolve(e){this._resolve(e)}reject(e){this._reject(e)}}class Fp{_callback;_that;_isCalled=!1;_deferred=new Pp;constructor(e,t){this._callback=e,this._that=t}get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...e){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...e)).then(e=>this._deferred.resolve(e),e=>this._deferred.reject(e))}catch(e){this._deferred.reject(e)}}return this._deferred.promise}}const Bp=e=>null!==e&&"object"==typeof e&&"function"==typeof e.then;class Up{_rawAttributes;_asyncAttributesPending=!1;_memoizedAttributes;static FromAttributeList(e){const t=new Up({});return t._rawAttributes=jp(e),t._asyncAttributesPending=e.filter(([e,t])=>Bp(t)).length>0,t}constructor(e){const t=e.attributes??{};this._rawAttributes=Object.entries(t).map(([e,t])=>(Bp(t)&&(this._asyncAttributesPending=!0),[e,t])),this._rawAttributes=jp(this._rawAttributes)}get asyncAttributesPending(){return this._asyncAttributesPending}async waitForAsyncAttributes(){if(this.asyncAttributesPending){for(let e=0;e<this._rawAttributes.length;e++){const[t,n]=this._rawAttributes[e];this._rawAttributes[e]=[t,Bp(n)?await n:n]}this._asyncAttributesPending=!1}}get attributes(){if(this.asyncAttributesPending&&oh.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;const e={};for(const[t,n]of this._rawAttributes)Bp(n)?oh.debug(`Unsettled resource attribute ${t} skipped`):null!=n&&(e[t]??=n);return this._asyncAttributesPending||(this._memoizedAttributes=e),e}getRawAttributes(){return this._rawAttributes}merge(e){return null==e?this:Up.FromAttributeList([...e.getRawAttributes(),...this.getRawAttributes()])}}function Zp(e){return Up.FromAttributeList(Object.entries(e))}function jp(e){return e.map(([e,t])=>Bp(t)?[e,t.catch(t=>{oh.debug("promise rejection for resource attribute: %s - %s",e,t)})]:[e,t])}class zp{_spanContext;kind;parentSpanContext;attributes={};links=[];events=[];startTime;resource;instrumentationScope;_droppedAttributesCount=0;_droppedEventsCount=0;_droppedLinksCount=0;name;status={code:$u.UNSET};endTime=[0,0];_ended=!1;_duration=[-1,-1];_spanProcessor;_spanLimits;_attributeValueLengthLimit;_performanceStartTime;_performanceOffset;_startTimeProvided;constructor(e){const t=Date.now();this._spanContext=e.spanContext,this._performanceStartTime=Mh.now(),this._performanceOffset=t-(this._performanceStartTime+$h()),this._startTimeProvided=null!=e.startTime,this._spanLimits=e.spanLimits,this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,this._spanProcessor=e.spanProcessor,this.name=e.name,this.parentSpanContext=e.parentSpanContext,this.kind=e.kind,this.links=e.links||[],this.startTime=this._getTime(e.startTime??t),this.resource=e.resource,this.instrumentationScope=e.scope,null!=e.attributes&&this.setAttributes(e.attributes),this._spanProcessor.onStart(this,e.context)}spanContext(){return this._spanContext}setAttribute(e,t){if(null==t||this._isSpanEnded())return this;if(0===e.length)return oh.warn(`Invalid attribute key: ${e}`),this;if(!Th(t))return oh.warn(`Invalid attribute value set for key: ${e}`),this;const{attributeCountLimit:n}=this._spanLimits;return void 0!==n&&Object.keys(this.attributes).length>=n&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this._droppedAttributesCount++,this):(this.attributes[e]=this._truncateToSize(t),this)}setAttributes(e){for(const[t,n]of Object.entries(e))this.setAttribute(t,n);return this}addEvent(e,t,n){if(this._isSpanEnded())return this;const{eventCountLimit:r}=this._spanLimits;if(0===r)return oh.warn("No events allowed."),this._droppedEventsCount++,this;void 0!==r&&this.events.length>=r&&(0===this._droppedEventsCount&&oh.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),sp(t)&&(sp(n)||(n=t),t=void 0);const s=Eh(t);return this.events.push({name:e,attributes:s,time:this._getTime(n),droppedAttributesCount:0}),this}addLink(e){return this.links.push(e),this}addLinks(e){return this.links.push(...e),this}setStatus(e){return this._isSpanEnded()||(this.status={...e},null!=this.status.message&&"string"!=typeof e.message&&(oh.warn(`Dropping invalid status.message of type '${typeof e.message}', expected 'string'`),delete this.status.message)),this}updateName(e){return this._isSpanEnded()||(this.name=e),this}end(e){this._isSpanEnded()?oh.error(`${this.name} ${this._spanContext.traceId}-${this._spanContext.spanId} - You can only call end() on a span once.`):(this._ended=!0,this.endTime=this._getTime(e),this._duration=function(e,t){let n=t[0]-e[0],r=t[1]-e[1];return r<0&&(n-=1,r+=qh),[n,r]}(this.startTime,this.endTime),this._duration[0]<0&&(oh.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&oh.warn(`Dropped ${this._droppedEventsCount} events because eventCountLimit reached`),this._spanProcessor.onEnd(this))}_getTime(e){if("number"==typeof e&&e<=Mh.now())return ep(e+this._performanceOffset);if("number"==typeof e)return Qh(e);if(e instanceof Date)return Qh(e.getTime());if(rp(e))return e;if(this._startTimeProvided)return Qh(Date.now());const t=Mh.now()-this._performanceStartTime;return op(this.startTime,Qh(t))}isRecording(){return!1===this._ended}recordException(e,t){const n={};"string"==typeof e?n[Ph]=e:e&&(e.code?n[Fh]=e.code.toString():e.name&&(n[Fh]=e.name),e.message&&(n[Ph]=e.message),e.stack&&(n["exception.stacktrace"]=e.stack)),n[Fh]||n[Ph]?this.addEvent("exception",n,t):oh.warn(`Failed to record an exception ${e}`)}get duration(){return this._duration}get ended(){return this._ended}get droppedAttributesCount(){return this._droppedAttributesCount}get droppedEventsCount(){return this._droppedEventsCount}get droppedLinksCount(){return this._droppedLinksCount}_isSpanEnded(){if(this._ended){const e=new Error(`Operation attempted on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`);oh.warn(`Cannot execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`,e)}return this._ended}_truncateToLimitUtil(e,t){return e.length<=t?e:e.substring(0,t)}_truncateToSize(e){const t=this._attributeValueLengthLimit;return t<=0?(oh.warn(`Attribute value limit must be positive, got ${t}`),e):"string"==typeof e?this._truncateToLimitUtil(e,t):Array.isArray(e)?e.map(e=>"string"==typeof e?this._truncateToLimitUtil(e,t):e):e}}var Vp;!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Vp||(Vp={}));class Gp{shouldSample(){return{decision:Vp.NOT_RECORD}}toString(){return"AlwaysOffSampler"}}class Wp{shouldSample(){return{decision:Vp.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}}class Hp{_root;_remoteParentSampled;_remoteParentNotSampled;_localParentSampled;_localParentNotSampled;constructor(e){this._root=e.root,this._root||(xh(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new Wp),this._remoteParentSampled=e.remoteParentSampled??new Wp,this._remoteParentNotSampled=e.remoteParentNotSampled??new Gp,this._localParentSampled=e.localParentSampled??new Wp,this._localParentNotSampled=e.localParentNotSampled??new Gp}shouldSample(e,t,n,r,s,o){const i=wh.getSpanContext(e);return i&&Yu(i)?i.isRemote?i.traceFlags&tu.SAMPLED?this._remoteParentSampled.shouldSample(e,t,n,r,s,o):this._remoteParentNotSampled.shouldSample(e,t,n,r,s,o):i.traceFlags&tu.SAMPLED?this._localParentSampled.shouldSample(e,t,n,r,s,o):this._localParentNotSampled.shouldSample(e,t,n,r,s,o):this._root.shouldSample(e,t,n,r,s,o)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}}class Yp{_ratio;_upperBound;constructor(e=0){this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(4294967295*this._ratio)}shouldSample(e,t){return{decision:Hu(t)&&this._accumulate(t)<this._upperBound?Vp.RECORD_AND_SAMPLED:Vp.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(e){return"number"!=typeof e||isNaN(e)?0:e>=1?1:e<=0?0:e}_accumulate(e){let t=0;for(let n=0;n<e.length/8;n++){const r=8*n;t=(t^parseInt(e.slice(r,r+8),16))>>>0}return t}}function Kp(){return{sampler:Jp(),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128},spanLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128,linkCountLimit:128,eventCountLimit:128,attributePerEventCountLimit:128,attributePerLinkCountLimit:128}}}function Jp(){const e="parentbased_always_on";switch(e){case"always_on":return new Wp;case"always_off":return new Gp;case"parentbased_always_on":return new Hp({root:new Wp});case"parentbased_always_off":return new Hp({root:new Gp});case"traceidratio":return new Yp(Xp());case"parentbased_traceidratio":return new Hp({root:new Yp(Xp())});default:return oh.error(`OTEL_TRACES_SAMPLER value "${e}" invalid, defaulting to "parentbased_always_on".`),new Hp({root:new Wp})}}function Xp(){return oh.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to 1."),1}const qp=1/0;class Qp{_exporter;_maxExportBatchSize;_maxQueueSize;_scheduledDelayMillis;_exportTimeoutMillis;_isExporting=!1;_finishedSpans=[];_timer;_shutdownOnce;_droppedSpansCount=0;constructor(e,t){this._exporter=e,this._maxExportBatchSize="number"==typeof t?.maxExportBatchSize?t.maxExportBatchSize:512,this._maxQueueSize="number"==typeof t?.maxQueueSize?t.maxQueueSize:2048,this._scheduledDelayMillis="number"==typeof t?.scheduledDelayMillis?t.scheduledDelayMillis:5e3,this._exportTimeoutMillis="number"==typeof t?.exportTimeoutMillis?t.exportTimeoutMillis:3e4,this._shutdownOnce=new Fp(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(oh.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}onStart(e,t){}onEnd(e){this._shutdownOnce.isCalled||0!==(e.spanContext().traceFlags&tu.SAMPLED)&&this._addToBuffer(e)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown())}_addToBuffer(e){if(this._finishedSpans.length>=this._maxQueueSize)return 0===this._droppedSpansCount&&oh.debug("maxQueueSize reached, dropping spans"),void this._droppedSpansCount++;this._droppedSpansCount>0&&(oh.warn(`Dropped ${this._droppedSpansCount} spans because maxQueueSize reached`),this._droppedSpansCount=0),this._finishedSpans.push(e),this._maybeStartTimer()}_flushAll(){return new Promise((e,t)=>{const n=[];for(let e=0,t=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);e<t;e++)n.push(this._flushOneBatch());Promise.all(n).then(()=>{e()}).catch(t)})}_flushOneBatch(){return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise((e,t)=>{const n=setTimeout(()=>{t(new Error("Timeout"))},this._exportTimeoutMillis);sh.with(function(e){return e.setValue(Ch,!0)}(sh.active()),()=>{let r;this._finishedSpans.length<=this._maxExportBatchSize?(r=this._finishedSpans,this._finishedSpans=[]):r=this._finishedSpans.splice(0,this._maxExportBatchSize);const s=()=>this._exporter.export(r,r=>{clearTimeout(n),r.code===ip.SUCCESS?e():t(r.error??new Error("BatchSpanProcessor: span export failed"))});let o=null;for(let e=0,t=r.length;e<t;e++){const t=r[e];t.resource.asyncAttributesPending&&t.resource.waitForAsyncAttributes&&(o??=[],o.push(t.resource.waitForAsyncAttributes()))}null===o?s():Promise.all(o).then(s,e=>{xh(e),t(e)})})})}_maybeStartTimer(){if(this._isExporting)return;const e=()=>{this._isExporting=!0,this._flushOneBatch().finally(()=>{this._isExporting=!1,this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(e=>{this._isExporting=!1,xh(e)})};if(this._finishedSpans.length>=this._maxExportBatchSize)return e();void 0===this._timer&&(this._timer=setTimeout(()=>e(),this._scheduledDelayMillis),this._timer)}_clearTimer(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)}}class $p extends Qp{_visibilityChangeListener;_pageHideListener;constructor(e,t){super(e,t),this.onInit(t)}onInit(e){!0!==e?.disableAutoFlushOnDocumentHide&&"undefined"!=typeof document&&(this._visibilityChangeListener=()=>{"hidden"===document.visibilityState&&this.forceFlush().catch(e=>{xh(e)})},this._pageHideListener=()=>{this.forceFlush().catch(e=>{xh(e)})},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))}onShutdown(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))}}class ed{generateTraceId=nd(16);generateSpanId=nd(8)}const td=Array(32);function nd(e){return function(){for(let t=0;t<2*e;t++)td[t]=Math.floor(16*Math.random())+48,td[t]>=58&&(td[t]+=39);return String.fromCharCode.apply(null,td.slice(0,2*e))}}class rd{_sampler;_generalLimits;_spanLimits;_idGenerator;instrumentationScope;_resource;_spanProcessor;constructor(e,t,n,r){const s=function(e){const t={sampler:Jp()},n=Kp(),r=Object.assign({},n,t,e);return r.generalLimits=Object.assign({},n.generalLimits,e.generalLimits||{}),r.spanLimits=Object.assign({},n.spanLimits,e.spanLimits||{}),r}(t);this._sampler=s.sampler,this._generalLimits=s.generalLimits,this._spanLimits=s.spanLimits,this._idGenerator=t.idGenerator||new ed,this._resource=n,this._spanProcessor=r,this.instrumentationScope=e}startSpan(e,t={},n=sh.active()){t.root&&(n=wh.deleteSpan(n));const r=wh.getSpan(n);if(Sh(n)){oh.debug("Instrumentation suppressed, returning Noop Span");return wh.wrapSpanContext(Du)}const s=r?.spanContext(),o=this._idGenerator.generateSpanId();let i,a,l;s&&wh.isSpanContextValid(s)?(a=s.traceId,l=s.traceState,i=s):a=this._idGenerator.generateTraceId();const c=t.kind??Qu.INTERNAL,u=(t.links??[]).map(e=>({context:e.context,attributes:Eh(e.attributes)})),h=Eh(t.attributes),p=this._sampler.shouldSample(n,a,e,c,h,u);l=p.traceState??l;const d={traceId:a,spanId:o,traceFlags:p.decision===qu.RECORD_AND_SAMPLED?tu.SAMPLED:tu.NONE,traceState:l};if(p.decision===qu.NOT_RECORD){oh.debug("Recording is off, propagating context in a non-recording span");return wh.wrapSpanContext(d)}const f=Eh(Object.assign(h,p.attributes));return new zp({resource:this._resource,scope:this.instrumentationScope,context:n,spanContext:d,name:e,kind:c,links:u,parentSpanContext:i,attributes:f,startTime:t.startTime,spanProcessor:this._spanProcessor,spanLimits:this._spanLimits})}startActiveSpan(e,t,n,r){let s,o,i;if(arguments.length<2)return;2===arguments.length?i=t:3===arguments.length?(s=t,i=n):(s=t,o=n,i=r);const a=o??sh.active(),l=this.startSpan(e,s,a),c=wh.setSpan(a,l);return sh.with(c,i,void 0,l)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}}class sd{_spanProcessors;constructor(e){this._spanProcessors=e}forceFlush(){const e=[];for(const t of this._spanProcessors)e.push(t.forceFlush());return new Promise(t=>{Promise.all(e).then(()=>{t()}).catch(e=>{xh(e||new Error("MultiSpanProcessor: forceFlush failed")),t()})})}onStart(e,t){for(const n of this._spanProcessors)n.onStart(e,t)}onEnd(e){for(const t of this._spanProcessors)t.onEnd(e)}shutdown(){const e=[];for(const t of this._spanProcessors)e.push(t.shutdown());return new Promise((t,n)=>{Promise.all(e).then(()=>{t()},n)})}}var od,id;!function(e){e[e.resolved=0]="resolved",e[e.timeout=1]="timeout",e[e.error=2]="error",e[e.unresolved=3]="unresolved"}(od||(od={}));class ad{_config;_tracers=new Map;_resource;_activeSpanProcessor;constructor(e={}){const t=function(...e){let t=e.shift();const n=new WeakMap;for(;e.length>0;)t=Tp(t,e.shift(),0,n);return t}({},Kp(),function(e){const t=Object.assign({},e.spanLimits);return t.attributeCountLimit=e.spanLimits?.attributeCountLimit??e.generalLimits?.attributeCountLimit??void 0??void 0??128,t.attributeValueLengthLimit=e.spanLimits?.attributeValueLengthLimit??e.generalLimits?.attributeValueLengthLimit??void 0??void 0??qp,Object.assign({},e,{spanLimits:t})}(e));this._resource=t.resource??Zp({[Vh]:"unknown_service",[Gh]:Jh[Gh],[Wh]:Jh[Wh],[Hh]:Jh[Hh]}),this._config=Object.assign({},t,{resource:this._resource});const n=[];e.spanProcessors?.length&&n.push(...e.spanProcessors),this._activeSpanProcessor=new sd(n)}getTracer(e,t,n){const r=`${e}@${t||""}:${n?.schemaUrl||""}`;return this._tracers.has(r)||this._tracers.set(r,new rd({name:e,version:t,schemaUrl:n?.schemaUrl},this._config,this._resource,this._activeSpanProcessor)),this._tracers.get(r)}forceFlush(){const e=this._config.forceFlushTimeoutMillis,t=this._activeSpanProcessor._spanProcessors.map(t=>new Promise(n=>{let r;const s=setTimeout(()=>{n(new Error(`Span processor did not completed within timeout period of ${e} ms`)),r=od.timeout},e);t.forceFlush().then(()=>{clearTimeout(s),r!==od.timeout&&(r=od.resolved,n(r))}).catch(e=>{clearTimeout(s),r=od.error,n(e)})}));return new Promise((e,n)=>{Promise.all(t).then(t=>{const r=t.filter(e=>e!==od.resolved);r.length>0?n(r):e()}).catch(e=>n([e]))})}shutdown(){return this._activeSpanProcessor.shutdown()}}class ld{_enabled=!1;_currentContext=ru;_bindFunction(e=ru,t){const n=this,r=function(...r){return n.with(e,()=>t.apply(this,r))};return Object.defineProperty(r,"length",{enumerable:!1,configurable:!0,writable:!1,value:t.length}),r}active(){return this._currentContext}bind(e,t){return void 0===e&&(e=this.active()),"function"==typeof t?this._bindFunction(e,t):t}disable(){return this._currentContext=ru,this._enabled=!1,this}enable(){return this._enabled||(this._enabled=!0,this._currentContext=ru),this}with(e,t,n,...r){const s=this._currentContext;this._currentContext=e||ru;try{return t.call(n,...r)}finally{this._currentContext=s}}}class cd extends ad{constructor(e={}){super(e)}register(e={}){var t;wh.setGlobalTracerProvider(this),null!==(t=e.propagator)&&(void 0!==t?vh.setGlobalPropagator(t):vh.setGlobalPropagator(new ap({propagators:[new gp,new Ah]}))),function(e){if(null!==e){if(void 0===e){const e=new ld;return e.enable(),void sh.setGlobalContextManager(e)}e.enable(),sh.setGlobalContextManager(e)}}(e.contextManager)}}!function(e){e.CONNECT_END="connectEnd",e.CONNECT_START="connectStart",e.DECODED_BODY_SIZE="decodedBodySize",e.DOM_COMPLETE="domComplete",e.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",e.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",e.DOM_INTERACTIVE="domInteractive",e.DOMAIN_LOOKUP_END="domainLookupEnd",e.DOMAIN_LOOKUP_START="domainLookupStart",e.ENCODED_BODY_SIZE="encodedBodySize",e.FETCH_START="fetchStart",e.LOAD_EVENT_END="loadEventEnd",e.LOAD_EVENT_START="loadEventStart",e.NAVIGATION_START="navigationStart",e.REDIRECT_END="redirectEnd",e.REDIRECT_START="redirectStart",e.REQUEST_START="requestStart",e.RESPONSE_END="responseEnd",e.RESPONSE_START="responseStart",e.SECURE_CONNECTION_START="secureConnectionStart",e.START_TIME="startTime",e.UNLOAD_EVENT_END="unloadEventEnd",e.UNLOAD_EVENT_START="unloadEventStart"}(id||(id={}));let ud;function hd(e,t){return t in e}function pd(e,t,n,r=!0){if(hd(n,t)&&"number"==typeof n[t]&&(!r||0!==n[t]))return e.addEvent(t,n[t])}function dd(e,t,n=!1,r,s){if(void 0===r&&(r=0!==t[id.START_TIME]),n||(pd(e,id.FETCH_START,t,r),pd(e,id.DOMAIN_LOOKUP_START,t,r),pd(e,id.DOMAIN_LOOKUP_END,t,r),pd(e,id.CONNECT_START,t,r),pd(e,id.SECURE_CONNECTION_START,t,r),pd(e,id.CONNECT_END,t,r),pd(e,id.REQUEST_START,t,r),pd(e,id.RESPONSE_START,t,r),pd(e,id.RESPONSE_END,t,r)),!s){const n=t[id.ENCODED_BODY_SIZE];void 0!==n&&e.setAttribute("http.response_content_length",n);const r=t[id.DECODED_BODY_SIZE];void 0!==r&&n!==r&&e.setAttribute("http.response_content_length_uncompressed",r)}}function fd(){return"undefined"!=typeof location?location.origin:void 0}function md(e,t,n,r,s=new WeakSet,o){const i=gd(e),a=function(e,t,n,r,s,o){const i=np(t),a=np(n);let l=r.filter(t=>{const n=np(tp(t[id.FETCH_START])),r=np(tp(t[id.RESPONSE_END]));return t.initiatorType.toLowerCase()===(o||"xmlhttprequest")&&t.name===e&&n>=i&&r<=a});l.length>0&&(l=l.filter(e=>!s.has(e)));return l}(e=i.toString(),t,n,r,s,o);if(0===a.length)return{mainRequest:void 0};if(1===a.length)return{mainRequest:a[0]};const l=function(e){return e.slice().sort((e,t)=>{const n=e[id.FETCH_START],r=t[id.FETCH_START];return n>r?1:n<r?-1:0})}(a);if(i.origin!==fd()&&l.length>1){let e=l[0],t=function(e,t,n){const r=np(n),s=np(tp(t));let o,i=e[1];const a=e.length;for(let t=1;t<a;t++){const n=e[t],a=np(tp(n[id.FETCH_START])),l=r-np(tp(n[id.RESPONSE_END]));a>=s&&(!o||l<o)&&(o=l,i=n)}return i}(l,e[id.RESPONSE_END],n);const r=e[id.RESPONSE_END];return t[id.FETCH_START]<r&&(t=e,e=void 0),{corsPreFlightRequest:e,mainRequest:t}}return{mainRequest:a[0]}}function gd(e){if("function"==typeof URL)return new URL(e,"undefined"!=typeof document?document.baseURI:"undefined"!=typeof location?location.href:void 0);const t=(ud||(ud=document.createElement("a")),ud);return t.href=e,t}function yd(e,t){let n=t||[];("string"==typeof n||n instanceof RegExp)&&(n=[n]);return gd(e).origin===fd()||n.some(t=>Lp(e,t))}class vd{emit(e){}}const bd=new vd;const wd=new class{getLogger(e,t,n){return new vd}};class Cd{constructor(e,t,n,r){this._provider=e,this.name=t,this.version=n,this.options=r}emit(e){this._getLogger().emit(e)}_getLogger(){if(this._delegate)return this._delegate;const e=this._provider.getDelegateLogger(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):bd}}class Sd{getLogger(e,t,n){var r;return null!==(r=this.getDelegateLogger(e,t,n))&&void 0!==r?r:new Cd(this,e,t,n)}getDelegate(){var e;return null!==(e=this._delegate)&&void 0!==e?e:wd}setDelegate(e){this._delegate=e}getDelegateLogger(e,t,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getLogger(e,t,n)}}const _d="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},Id=Symbol.for("io.opentelemetry.js.api.logs"),Ad=_d;class Ed{constructor(){this._proxyLoggerProvider=new Sd}static getInstance(){return this._instance||(this._instance=new Ed),this._instance}setGlobalLoggerProvider(e){return Ad[Id]?this.getLoggerProvider():(Ad[Id]=(t=1,n=e,r=wd,e=>e===t?n:r),this._proxyLoggerProvider.setDelegate(e),e);var t,n,r}getLoggerProvider(){var e,t;return null!==(t=null===(e=Ad[Id])||void 0===e?void 0:e.call(Ad,1))&&void 0!==t?t:this._proxyLoggerProvider}getLogger(e,t,n){return this.getLoggerProvider().getLogger(e,t,n)}disable(){delete Ad[Id],this._proxyLoggerProvider=new Sd}}const kd=Ed.getInstance();let Td=console.error.bind(console);function Od(e,t,n){const r=!!e[t]&&Object.prototype.propertyIsEnumerable.call(e,t);Object.defineProperty(e,t,{configurable:!0,enumerable:r,writable:!0,value:n})}const Rd=(e,t,n)=>{if(!e||!e[t])return void Td("no original function "+String(t)+" to wrap");if(!n)return Td("no wrapper function"),void Td((new Error).stack);const r=e[t];if("function"!=typeof r||"function"!=typeof n)return void Td("original object and wrapper must be functions");const s=n(r,t);return Od(s,"__original",r),Od(s,"__unwrap",()=>{e[t]===s&&Od(e,t,r)}),Od(s,"__wrapped",!0),Od(e,t,s),s},xd=(e,t,n)=>{if(!e)return Td("must provide one or more modules to patch"),void Td((new Error).stack);Array.isArray(e)||(e=[e]),t&&Array.isArray(t)?e.forEach(e=>{t.forEach(t=>{Rd(e,t,n)})}):Td("must provide one or more functions to wrap on modules")},Nd=(e,t)=>{if(!e||!e[t])return Td("no function to unwrap."),void Td((new Error).stack);const n=e[t];n.__unwrap?n.__unwrap():Td("no original to unwrap to -- has "+String(t)+" already been unwrapped?")},Md=(e,t)=>{if(!e)return Td("must provide one or more modules to patch"),void Td((new Error).stack);Array.isArray(e)||(e=[e]),t&&Array.isArray(t)?e.forEach(e=>{t.forEach(t=>{Nd(e,t)})}):Td("must provide one or more functions to unwrap on modules")};class Ld{instrumentationName;instrumentationVersion;_config={};_tracer;_meter;_logger;_diag;constructor(e,t,n){this.instrumentationName=e,this.instrumentationVersion=t,this.setConfig(n),this._diag=oh.createComponentLogger({namespace:e}),this._tracer=wh.getTracer(e,t),this._meter=lh.getMeter(e,t),this._logger=kd.getLogger(e,t),this._updateMetricInstruments()}_wrap=Rd;_unwrap=Nd;_massWrap=xd;_massUnwrap=Md;get meter(){return this._meter}setMeterProvider(e){this._meter=e.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()}get logger(){return this._logger}setLoggerProvider(e){this._logger=e.getLogger(this.instrumentationName,this.instrumentationVersion)}getModuleDefinitions(){const e=this.init()??[];return Array.isArray(e)?e:[e]}_updateMetricInstruments(){}getConfig(){return this._config}setConfig(e){this._config={enabled:!0,...e}}setTracerProvider(e){this._tracer=e.getTracer(this.instrumentationName,this.instrumentationVersion)}get tracer(){return this._tracer}_runSpanCustomizationHook(e,t,n,r){if(e)try{e(n,r)}catch(e){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:t},e)}}}class Dd extends Ld{constructor(e,t,n){super(e,t,n),this._config.enabled&&this.enable()}}function Pd(e,t,n){let r,s;try{s=e()}catch(e){r=e}finally{return t(r,s),s}}function Fd(e){return"function"==typeof e&&"function"==typeof e.__original&&"function"==typeof e.__unwrap&&!0===e.__wrapped}var Bd,Ud;function Zd(e,t){let n=Bd.OLD;const r=t?.split(",").map(e=>e.trim()).filter(e=>""!==e);for(const t of r??[]){if(t.toLowerCase()===e+"/dup"){n=Bd.DUPLICATE;break}t.toLowerCase()===e&&(n=Bd.STABLE)}return n}!function(e){e[e.STABLE=1]="STABLE",e[e.OLD=2]="OLD",e[e.DUPLICATE=3]="DUPLICATE"}(Bd||(Bd={})),function(e){e.DOCUMENT_LOAD="documentLoad",e.DOCUMENT_FETCH="documentFetch",e.RESOURCE_FETCH="resourceFetch"}(Ud||(Ud={}));var jd;!function(e){e.FIRST_PAINT="firstPaint",e.FIRST_CONTENTFUL_PAINT="firstContentfulPaint"}(jd||(jd={}));const zd={"first-paint":jd.FIRST_PAINT,"first-contentful-paint":jd.FIRST_CONTENTFUL_PAINT};class Vd extends Dd{component="document-load";version="1";moduleName=this.component;constructor(e={}){super("@opentelemetry/instrumentation-document-load","0.48.0",e)}init(){}_onDocumentLoaded(){window.setTimeout(()=>{this._collectPerformance()})}_addResourcesSpans(e){const t=Mh.getEntriesByType?.("resource");t&&t.forEach(t=>{this._initResourceSpan(t,e)})}_collectPerformance(){const e=Array.from(document.getElementsByTagName("meta")).find(e=>e.getAttribute("name")===dp),t=(()=>{const e={},t=Mh.getEntriesByType?.("navigation")[0];if(t)Object.values(id).forEach(n=>{if(hd(t,n)){const r=t[n];"number"==typeof r&&(e[n]=r)}});else{const t=Mh.timing;t&&Object.values(id).forEach(n=>{if(hd(t,n)){const r=t[n];"number"==typeof r&&(e[n]=r)}})}return e})(),n=e&&e.content||"";sh.with(vh.extract(ru,{traceparent:n}),()=>{const e=this._startSpan(Ud.DOCUMENT_LOAD,id.FETCH_START,t);e&&(sh.with(wh.setSpan(sh.active(),e),()=>{const e=this._startSpan(Ud.DOCUMENT_FETCH,id.FETCH_START,t);e&&(e.setAttribute(Lh,location.href),sh.with(wh.setSpan(sh.active(),e),()=>{dd(e,t,this.getConfig().ignoreNetworkEvents),this._addCustomAttributesOnSpan(e,this.getConfig().applyCustomAttributesOnSpan?.documentFetch),this._endSpan(e,id.RESPONSE_END,t)}))}),e.setAttribute(Lh,location.href),e.setAttribute("http.user_agent",navigator.userAgent),this._addResourcesSpans(e),this.getConfig().ignoreNetworkEvents||(pd(e,id.FETCH_START,t),pd(e,id.UNLOAD_EVENT_START,t),pd(e,id.UNLOAD_EVENT_END,t),pd(e,id.DOM_INTERACTIVE,t),pd(e,id.DOM_CONTENT_LOADED_EVENT_START,t),pd(e,id.DOM_CONTENT_LOADED_EVENT_END,t),pd(e,id.DOM_COMPLETE,t),pd(e,id.LOAD_EVENT_START,t),pd(e,id.LOAD_EVENT_END,t)),this.getConfig().ignorePerformancePaintEvents||(e=>{const t=Mh.getEntriesByType?.("paint");t&&t.forEach(({name:t,startTime:n})=>{hd(zd,t)&&e.addEvent(zd[t],n)})})(e),this._addCustomAttributesOnSpan(e,this.getConfig().applyCustomAttributesOnSpan?.documentLoad),this._endSpan(e,id.LOAD_EVENT_END,t))})}_endSpan(e,t,n){e&&(hd(n,t)?e.end(n[t]):e.end())}_initResourceSpan(e,t){const n=this._startSpan(Ud.RESOURCE_FETCH,id.FETCH_START,e,t);n&&(n.setAttribute(Lh,e.name),dd(n,e,this.getConfig().ignoreNetworkEvents),this._addCustomAttributesOnResourceSpan(n,e,this.getConfig().applyCustomAttributesOnSpan?.resourceFetch),this._endSpan(n,id.RESPONSE_END,e))}_startSpan(e,t,n,r){if(hd(n,t)&&"number"==typeof n[t]){return this.tracer.startSpan(e,{startTime:n[t]},r?wh.setSpan(sh.active(),r):void 0)}}_waitForPageLoad(){"complete"===window.document.readyState?this._onDocumentLoaded():(this._onDocumentLoaded=this._onDocumentLoaded.bind(this),window.addEventListener("load",this._onDocumentLoaded))}_addCustomAttributesOnSpan(e,t){t&&Pd(()=>t(e),e=>{e&&this._diag.error("addCustomAttributesOnSpan",e)})}_addCustomAttributesOnResourceSpan(e,t,n){n&&Pd(()=>n(e,t),e=>{e&&this._diag.error("addCustomAttributesOnResourceSpan",e)})}enable(){window.removeEventListener("load",this._onDocumentLoaded),this._waitForPageLoad()}disable(){window.removeEventListener("load",this._onDocumentLoaded)}}const Gd="OT_ZONE_CONTEXT";class Wd{_enabled=!1;_zoneCounter=0;_activeContextFromZone(e){return e&&e.get(Gd)||ru}_bindFunction(e,t){const n=this,r=function(...r){return n.with(e,()=>t.apply(this,r))};return Object.defineProperty(r,"length",{enumerable:!1,configurable:!0,writable:!1,value:t.length}),r}_bindListener(e,t){const n=t;return void 0!==n.__ot_listeners||(n.__ot_listeners={},"function"==typeof n.addEventListener&&(n.addEventListener=this._patchAddEventListener(n,n.addEventListener,e)),"function"==typeof n.removeEventListener&&(n.removeEventListener=this._patchRemoveEventListener(n,n.removeEventListener))),t}_createZoneName(){this._zoneCounter++;const e=Math.random();return`${this._zoneCounter}-${e}`}_createZone(e,t){return Zone.current.fork({name:e,properties:{[Gd]:t}})}_getActiveZone(){return Zone.current}_patchAddEventListener(e,t,n){const r=this;return function(s,o,i){void 0===e.__ot_listeners&&(e.__ot_listeners={});let a=e.__ot_listeners[s];void 0===a&&(a=new WeakMap,e.__ot_listeners[s]=a);const l=r.bind(n,o);return a.set(o,l),t.call(this,s,l,i)}}_patchRemoveEventListener(e,t){return function(n,r){if(void 0===e.__ot_listeners||void 0===e.__ot_listeners[n])return t.call(this,n,r);const s=e.__ot_listeners[n],o=s.get(r);return s.delete(r),t.call(this,n,o||r)}}active(){if(!this._enabled)return ru;const e=this._getActiveZone(),t=this._activeContextFromZone(e);return t||ru}bind(e,t){return void 0===e&&(e=this.active()),"function"==typeof t?this._bindFunction(e,t):("object"==typeof(n=t)&&null!==n&&"addEventListener"in n&&"function"==typeof n.addEventListener&&"removeEventListener"in n&&"function"==typeof n.removeEventListener&&this._bindListener(e,t),t);var n}disable(){return this._enabled=!1,this}enable(){return this._enabled=!0,this}with(e,t,n,...r){const s=this._createZoneName();return this._createZone(s,e).run(t,n,r)}}
/**
   * @license Angular v<unknown>
   * (c) 2010-2025 Google LLC. https://angular.io/
   * License: MIT
   */const Hd=globalThis;function Yd(e){return(Hd.__Zone_symbol_prefix||"__zone_symbol__")+e}const Kd=Object.getOwnPropertyDescriptor,Jd=Object.defineProperty,Xd=Object.getPrototypeOf,qd=Object.create,Qd=Array.prototype.slice,$d="addEventListener",ef="removeEventListener",tf=Yd($d),nf=Yd(ef),rf="true",sf="false",of=Yd("");function af(e,t){return Zone.current.wrap(e,t)}function lf(e,t,n,r,s){return Zone.current.scheduleMacroTask(e,t,n,r,s)}const cf=Yd,uf="undefined"!=typeof window,hf=uf?window:void 0,pf=uf&&hf||globalThis;function df(e,t){for(let n=e.length-1;n>=0;n--)"function"==typeof e[n]&&(e[n]=af(e[n],t+"_"+n));return e}function ff(e){return!e||!1!==e.writable&&!("function"==typeof e.get&&void 0===e.set)}const mf="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,gf=!("nw"in pf)&&void 0!==pf.process&&"[object process]"===pf.process.toString(),yf=!gf&&!mf&&!(!uf||!hf.HTMLElement),vf=void 0!==pf.process&&"[object process]"===pf.process.toString()&&!mf&&!(!uf||!hf.HTMLElement),bf={},wf=cf("enable_beforeunload"),Cf=function(e){if(!(e=e||pf.event))return;let t=bf[e.type];t||(t=bf[e.type]=cf("ON_PROPERTY"+e.type));const n=this||e.target||pf,r=n[t];let s;if(yf&&n===hf&&"error"===e.type){const t=e;s=r&&r.call(this,t.message,t.filename,t.lineno,t.colno,t.error),!0===s&&e.preventDefault()}else s=r&&r.apply(this,arguments),"beforeunload"===e.type&&pf[wf]&&"string"==typeof s?e.returnValue=s:null==s||s||e.preventDefault();return s};function Sf(e,t,n){let r=Kd(e,t);if(!r&&n){Kd(n,t)&&(r={enumerable:!0,configurable:!0})}if(!r||!r.configurable)return;const s=cf("on"+t+"patched");if(e.hasOwnProperty(s)&&e[s])return;delete r.writable,delete r.value;const o=r.get,i=r.set,a=t.slice(2);let l=bf[a];l||(l=bf[a]=cf("ON_PROPERTY"+a)),r.set=function(t){let n=this;if(n||e!==pf||(n=pf),!n)return;"function"==typeof n[l]&&n.removeEventListener(a,Cf),i?.call(n,null),n[l]=t,"function"==typeof t&&n.addEventListener(a,Cf,!1)},r.get=function(){let n=this;if(n||e!==pf||(n=pf),!n)return null;const s=n[l];if(s)return s;if(o){let e=o.call(this);if(e)return r.set.call(this,e),"function"==typeof n.removeAttribute&&n.removeAttribute(t),e}return null},Jd(e,t,r),e[s]=!0}function _f(e,t,n){if(t)for(let r=0;r<t.length;r++)Sf(e,"on"+t[r],n);else{const t=[];for(const n in e)"on"==n.slice(0,2)&&t.push(n);for(let r=0;r<t.length;r++)Sf(e,t[r],n)}}const If=cf("originalInstance");function Af(e){const t=pf[e];if(!t)return;pf[cf(e)]=t,pf[e]=function(){const n=df(arguments,e);switch(n.length){case 0:this[If]=new t;break;case 1:this[If]=new t(n[0]);break;case 2:this[If]=new t(n[0],n[1]);break;case 3:this[If]=new t(n[0],n[1],n[2]);break;case 4:this[If]=new t(n[0],n[1],n[2],n[3]);break;default:throw new Error("Arg list too long.")}},Tf(pf[e],t);const n=new t(function(){});let r;for(r in n)"XMLHttpRequest"===e&&"responseBlob"===r||function(t){"function"==typeof n[t]?pf[e].prototype[t]=function(){return this[If][t].apply(this[If],arguments)}:Jd(pf[e].prototype,t,{set:function(n){"function"==typeof n?(this[If][t]=af(n,e+"."+t),Tf(this[If][t],n)):this[If][t]=n},get:function(){return this[If][t]}})}(r);for(r in t)"prototype"!==r&&t.hasOwnProperty(r)&&(pf[e][r]=t[r])}function Ef(e,t,n){let r=e;for(;r&&!r.hasOwnProperty(t);)r=Xd(r);!r&&e[t]&&(r=e);const s=cf(t);let o=null;if(r&&(!(o=r[s])||!r.hasOwnProperty(s))){o=r[s]=r[t];if(ff(r&&Kd(r,t))){const e=n(o,s,t);r[t]=function(){return e(this,arguments)},Tf(r[t],o)}}return o}function kf(e,t,n){let r=null;function s(e){const t=e.data;return t.args[t.cbIdx]=function(){e.invoke.apply(this,arguments)},r.apply(t.target,t.args),e}r=Ef(e,t,e=>function(t,r){const o=n(t,r);return o.cbIdx>=0&&"function"==typeof r[o.cbIdx]?lf(o.name,r[o.cbIdx],o,s):e.apply(t,r)})}function Tf(e,t){e[cf("OriginalDelegate")]=t}let Of=!1,Rf=!1;function xf(){if(Of)return Rf;Of=!0;try{const e=hf.navigator.userAgent;-1===e.indexOf("MSIE ")&&-1===e.indexOf("Trident/")&&-1===e.indexOf("Edge/")||(Rf=!0)}catch(e){}return Rf}function Nf(e){return"function"==typeof e}function Mf(e){return"number"==typeof e}const Lf={useG:!0},Df={},Pf={},Ff=new RegExp("^"+of+"(\\w+)(true|false)$"),Bf=cf("propagationStopped");function Uf(e,t){const n=(t?t(e):e)+sf,r=(t?t(e):e)+rf,s=of+n,o=of+r;Df[e]={},Df[e][sf]=s,Df[e][rf]=o}function Zf(e,t,n,r){const s=r&&r.add||$d,o=r&&r.rm||ef,i=r&&r.listeners||"eventListeners",a=r&&r.rmAll||"removeAllListeners",l=cf(s),c="."+s+":",u="prependListener",h="."+u+":",p=function(e,t,n){if(e.isRemoved)return;const r=e.callback;let s;"object"==typeof r&&r.handleEvent&&(e.callback=e=>r.handleEvent(e),e.originalDelegate=r);try{e.invoke(e,t,[n])}catch(e){s=e}const i=e.options;if(i&&"object"==typeof i&&i.once){const r=e.originalDelegate?e.originalDelegate:e.callback;t[o].call(t,n.type,r,i)}return s};function d(n,r,s){if(!(r=r||e.event))return;const o=n||r.target||e,i=o[Df[r.type][s?rf:sf]];if(i){const e=[];if(1===i.length){const t=p(i[0],o,r);t&&e.push(t)}else{const t=i.slice();for(let n=0;n<t.length&&(!r||!0!==r[Bf]);n++){const s=p(t[n],o,r);s&&e.push(s)}}if(1===e.length)throw e[0];for(let n=0;n<e.length;n++){const r=e[n];t.nativeScheduleMicroTask(()=>{throw r})}}}const f=function(e){return d(this,e,!1)},m=function(e){return d(this,e,!0)};function g(t,n){if(!t)return!1;let r=!0;n&&void 0!==n.useG&&(r=n.useG);const p=n&&n.vh;let d=!0;n&&void 0!==n.chkDup&&(d=n.chkDup);let g=!1;n&&void 0!==n.rt&&(g=n.rt);let y=t;for(;y&&!y.hasOwnProperty(s);)y=Xd(y);if(!y&&t[s]&&(y=t),!y)return!1;if(y[l])return!1;const v=n&&n.eventNameToString,b={},w=y[l]=y[s],C=y[cf(o)]=y[o],S=y[cf(i)]=y[i],_=y[cf(a)]=y[a];let I;n&&n.prepend&&(I=y[cf(n.prepend)]=y[n.prepend]);const A=function(e){return I.call(b.target,b.eventName,e.invoke,b.options)},E=r?function(e){if(!b.isExisting)return w.call(b.target,b.eventName,b.capture?m:f,b.options)}:function(e){return w.call(b.target,b.eventName,e.invoke,b.options)},k=r?function(e){if(!e.isRemoved){const t=Df[e.eventName];let n;t&&(n=t[e.capture?rf:sf]);const r=n&&e.target[n];if(r)for(let t=0;t<r.length;t++){if(r[t]===e){r.splice(t,1),e.isRemoved=!0,e.removeAbortListener&&(e.removeAbortListener(),e.removeAbortListener=null),0===r.length&&(e.allRemoved=!0,e.target[n]=null);break}}}if(e.allRemoved)return C.call(e.target,e.eventName,e.capture?m:f,e.options)}:function(e){return C.call(e.target,e.eventName,e.invoke,e.options)},T=n?.diff||function(e,t){const n=typeof t;return"function"===n&&e.callback===t||"object"===n&&e.originalDelegate===t},O=Zone[cf("UNPATCHED_EVENTS")],R=e[cf("PASSIVE_EVENTS")];const x=function(t,s,o,i,a=!1,l=!1){return function(){const c=this||e;let u=arguments[0];n&&n.transferEventName&&(u=n.transferEventName(u));let h=arguments[1];if(!h)return t.apply(this,arguments);if(gf&&"uncaughtException"===u)return t.apply(this,arguments);let f=!1;if("function"!=typeof h){if(!h.handleEvent)return t.apply(this,arguments);f=!0}if(p&&!p(t,h,c,arguments))return;const m=!!R&&-1!==R.indexOf(u),g=function(e){if("object"==typeof e&&null!==e){const t={...e};return e.signal&&(t.signal=e.signal),t}return e}(function(e,t){return t?"boolean"==typeof e?{capture:e,passive:!0}:e?"object"==typeof e&&!1!==e.passive?{...e,passive:!0}:e:{passive:!0}:e}(arguments[2],m)),y=g?.signal;if(y?.aborted)return;if(O)for(let e=0;e<O.length;e++)if(u===O[e])return m?t.call(c,u,h,g):t.apply(this,arguments);const w=!!g&&("boolean"==typeof g||g.capture),C=!(!g||"object"!=typeof g)&&g.once,S=Zone.current;let _=Df[u];_||(Uf(u,v),_=Df[u]);const I=_[w?rf:sf];let A,E=c[I],k=!1;if(E){if(k=!0,d)for(let e=0;e<E.length;e++)if(T(E[e],h))return}else E=c[I]=[];const x=c.constructor.name,N=Pf[x];N&&(A=N[u]),A||(A=x+s+(v?v(u):u)),b.options=g,C&&(b.options.once=!1),b.target=c,b.capture=w,b.eventName=u,b.isExisting=k;const M=r?Lf:void 0;M&&(M.taskData=b),y&&(b.options.signal=void 0);const L=S.scheduleEventTask(A,h,M,o,i);if(y){b.options.signal=y;const e=()=>L.zone.cancelTask(L);t.call(y,"abort",e,{once:!0}),L.removeAbortListener=()=>y.removeEventListener("abort",e)}return b.target=null,M&&(M.taskData=null),C&&(b.options.once=!0),"boolean"!=typeof L.options&&(L.options=g),L.target=c,L.capture=w,L.eventName=u,f&&(L.originalDelegate=h),l?E.unshift(L):E.push(L),a?c:void 0}};return y[s]=x(w,c,E,k,g),I&&(y[u]=x(I,h,A,k,g,!0)),y[o]=function(){const t=this||e;let r=arguments[0];n&&n.transferEventName&&(r=n.transferEventName(r));const s=arguments[2],o=!!s&&("boolean"==typeof s||s.capture),i=arguments[1];if(!i)return C.apply(this,arguments);if(p&&!p(C,i,t,arguments))return;const a=Df[r];let l;a&&(l=a[o?rf:sf]);const c=l&&t[l];if(c)for(let e=0;e<c.length;e++){const n=c[e];if(T(n,i)){if(c.splice(e,1),n.isRemoved=!0,0===c.length&&(n.allRemoved=!0,t[l]=null,!o&&"string"==typeof r)){t[of+"ON_PROPERTY"+r]=null}return n.zone.cancelTask(n),g?t:void 0}}return C.apply(this,arguments)},y[i]=function(){const t=this||e;let r=arguments[0];n&&n.transferEventName&&(r=n.transferEventName(r));const s=[],o=jf(t,v?v(r):r);for(let e=0;e<o.length;e++){const t=o[e];let n=t.originalDelegate?t.originalDelegate:t.callback;s.push(n)}return s},y[a]=function(){const t=this||e;let r=arguments[0];if(r){n&&n.transferEventName&&(r=n.transferEventName(r));const e=Df[r];if(e){const n=e[sf],s=e[rf],i=t[n],a=t[s];if(i){const e=i.slice();for(let t=0;t<e.length;t++){const n=e[t];let s=n.originalDelegate?n.originalDelegate:n.callback;this[o].call(this,r,s,n.options)}}if(a){const e=a.slice();for(let t=0;t<e.length;t++){const n=e[t];let s=n.originalDelegate?n.originalDelegate:n.callback;this[o].call(this,r,s,n.options)}}}}else{const e=Object.keys(t);for(let t=0;t<e.length;t++){const n=e[t],r=Ff.exec(n);let s=r&&r[1];s&&"removeListener"!==s&&this[a].call(this,s)}this[a].call(this,"removeListener")}if(g)return this},Tf(y[s],w),Tf(y[o],C),_&&Tf(y[a],_),S&&Tf(y[i],S),!0}let y=[];for(let e=0;e<n.length;e++)y[e]=g(n[e],r);return y}function jf(e,t){if(!t){const n=[];for(let r in e){const s=Ff.exec(r);let o=s&&s[1];if(o&&(!t||o===t)){const t=e[r];if(t)for(let e=0;e<t.length;e++)n.push(t[e])}}return n}let n=Df[t];n||(Uf(t),n=Df[t]);const r=e[n[sf]],s=e[n[rf]];return r?s?r.concat(s):r.slice():s?s.slice():[]}function zf(e,t){const n=e.Event;n&&n.prototype&&t.patchMethod(n.prototype,"stopImmediatePropagation",e=>function(t,n){t[Bf]=!0,e&&e.apply(t,n)})}function Vf(e,t){t.patchMethod(e,"queueMicrotask",e=>function(e,t){Zone.current.scheduleMicroTask("queueMicrotask",t[0])})}const Gf=cf("zoneTask");function Wf(e,t,n,r){let s=null,o=null;n+=r;const i={};function a(t){const n=t.data;n.args[0]=function(){return t.invoke.apply(this,arguments)};const r=s.apply(e,n.args);return Mf(r)?n.handleId=r:(n.handle=r,n.isRefreshable=Nf(r.refresh)),t}function l(t){const{handle:n,handleId:r}=t.data;return o.call(e,n??r)}s=Ef(e,t+=r,n=>function(s,o){if(Nf(o[0])){const e={isRefreshable:!1,isPeriodic:"Interval"===r,delay:"Timeout"===r||"Interval"===r?o[1]||0:void 0,args:o},n=o[0];o[0]=function(){try{return n.apply(this,arguments)}finally{const{handle:t,handleId:n,isPeriodic:r,isRefreshable:s}=e;r||s||(n?delete i[n]:t&&(t[Gf]=null))}};const s=lf(t,o[0],e,a,l);if(!s)return s;const{handleId:c,handle:u,isRefreshable:h,isPeriodic:p}=s.data;if(c)i[c]=s;else if(u&&(u[Gf]=s,h&&!p)){const e=u.refresh;u.refresh=function(){const{zone:t,state:n}=s;return"notScheduled"===n?(s._state="scheduled",t._updateTaskCount(s,1)):"running"===n&&(s._state="scheduling"),e.call(this)}}return u??c??s}return n.apply(e,o)}),o=Ef(e,n,t=>function(n,r){const s=r[0];let o;Mf(s)?(o=i[s],delete i[s]):(o=s?.[Gf],o?s[Gf]=null:o=s),o?.type?o.cancelFn&&o.zone.cancelTask(o):t.apply(e,r)})}function Hf(e,t){if(Zone[t.symbol("patchEventTarget")])return;const{eventNames:n,zoneSymbolEventNames:r,TRUE_STR:s,FALSE_STR:o,ZONE_SYMBOL_PREFIX:i}=t.getGlobalObjects();for(let e=0;e<n.length;e++){const t=n[e],a=i+(t+o),l=i+(t+s);r[t]={},r[t][o]=a,r[t][s]=l}const a=e.EventTarget;return a&&a.prototype?(t.patchEventTarget(e,t,[a&&a.prototype]),!0):void 0}function Yf(e,t,n){if(!n||0===n.length)return t;const r=n.filter(t=>t.target===e);if(0===r.length)return t;const s=r[0].ignoreProperties;return t.filter(e=>-1===s.indexOf(e))}function Kf(e,t,n,r){if(!e)return;_f(e,Yf(e,t,n),r)}function Jf(e){return Object.getOwnPropertyNames(e).filter(e=>e.startsWith("on")&&e.length>2).map(e=>e.substring(2))}function Xf(e,t){if(gf&&!vf)return;if(Zone[e.symbol("patchEvents")])return;const n=t.__Zone_ignore_on_properties;let r=[];if(yf){const e=window;r=r.concat(["Document","SVGElement","Element","HTMLElement","HTMLBodyElement","HTMLMediaElement","HTMLFrameSetElement","HTMLFrameElement","HTMLIFrameElement","HTMLMarqueeElement","Worker"]);const t=[];Kf(e,Jf(e),n?n.concat(t):n,Xd(e))}r=r.concat(["XMLHttpRequest","XMLHttpRequestEventTarget","IDBIndex","IDBRequest","IDBOpenDBRequest","IDBDatabase","IDBTransaction","IDBCursor","WebSocket"]);for(let e=0;e<r.length;e++){const s=t[r[e]];s?.prototype&&Kf(s.prototype,Jf(s.prototype),n)}}function qf(e){e.__load_patch("ZoneAwarePromise",(e,t,n)=>{const r=Object.getOwnPropertyDescriptor,s=Object.defineProperty;const o=n.symbol,i=[],a=!1!==e[o("DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION")],l=o("Promise"),c=o("then");n.onUnhandledError=e=>{if(n.showUncaughtError()){const t=e&&e.rejection;t?console.error("Unhandled Promise rejection:",t instanceof Error?t.message:t,"; Zone:",e.zone.name,"; Task:",e.task&&e.task.source,"; Value:",t,t instanceof Error?t.stack:void 0):console.error(e)}},n.microtaskDrainDone=()=>{for(;i.length;){const e=i.shift();try{e.zone.runGuarded(()=>{if(e.throwOriginal)throw e.rejection;throw e})}catch(e){h(e)}}};const u=o("unhandledPromiseRejectionHandler");function h(e){n.onUnhandledError(e);try{const n=t[u];"function"==typeof n&&n.call(this,e)}catch(e){}}function p(e){return e&&"function"==typeof e.then}function d(e){return e}function f(e){return M.reject(e)}const m=o("state"),g=o("value"),y=o("finally"),v=o("parentPromiseValue"),b=o("parentPromiseState"),w=null,C=!0,S=!1;function _(e,t){return n=>{try{k(e,t,n)}catch(t){k(e,!1,t)}}}const I=function(){let e=!1;return function(t){return function(){e||(e=!0,t.apply(null,arguments))}}},A="Promise resolved with itself",E=o("currentTaskTrace");function k(e,r,o){const l=I();if(e===o)throw new TypeError(A);if(e[m]===w){let c=null;try{"object"!=typeof o&&"function"!=typeof o||(c=o&&o.then)}catch(t){return l(()=>{k(e,!1,t)})(),e}if(r!==S&&o instanceof M&&o.hasOwnProperty(m)&&o.hasOwnProperty(g)&&o[m]!==w)O(o),k(e,o[m],o[g]);else if(r!==S&&"function"==typeof c)try{c.call(o,l(_(e,r)),l(_(e,!1)))}catch(t){l(()=>{k(e,!1,t)})()}else{e[m]=r;const l=e[g];if(e[g]=o,e[y]===y&&r===C&&(e[m]=e[b],e[g]=e[v]),r===S&&o instanceof Error){const e=t.currentTask&&t.currentTask.data&&t.currentTask.data.__creationTrace__;e&&s(o,E,{configurable:!0,enumerable:!1,writable:!0,value:e})}for(let t=0;t<l.length;)R(e,l[t++],l[t++],l[t++],l[t++]);if(0==l.length&&r==S){e[m]=0;let r=o;try{throw new Error("Uncaught (in promise): "+function(e){if(e&&e.toString===Object.prototype.toString){return(e.constructor&&e.constructor.name||"")+": "+JSON.stringify(e)}return e?e.toString():Object.prototype.toString.call(e)}(o)+(o&&o.stack?"\n"+o.stack:""))}catch(e){r=e}a&&(r.throwOriginal=!0),r.rejection=o,r.promise=e,r.zone=t.current,r.task=t.currentTask,i.push(r),n.scheduleMicroTask()}}}return e}const T=o("rejectionHandledHandler");function O(e){if(0===e[m]){try{const n=t[T];n&&"function"==typeof n&&n.call(this,{rejection:e[g],promise:e})}catch(e){}e[m]=S;for(let t=0;t<i.length;t++)e===i[t].promise&&i.splice(t,1)}}function R(e,t,n,r,s){O(e);const o=e[m],i=o?"function"==typeof r?r:d:"function"==typeof s?s:f;t.scheduleMicroTask("Promise.then",()=>{try{const r=e[g],s=!!n&&y===n[y];s&&(n[v]=r,n[b]=o);const a=t.run(i,void 0,s&&i!==f&&i!==d?[]:[r]);k(n,!0,a)}catch(e){k(n,!1,e)}},n)}const x=function(){},N=e.AggregateError;class M{static toString(){return"function ZoneAwarePromise() { [native code] }"}static resolve(e){return e instanceof M?e:k(new this(null),C,e)}static reject(e){return k(new this(null),S,e)}static withResolvers(){const e={};return e.promise=new M((t,n)=>{e.resolve=t,e.reject=n}),e}static any(e){if(!e||"function"!=typeof e[Symbol.iterator])return Promise.reject(new N([],"All promises were rejected"));const t=[];let n=0;try{for(let r of e)n++,t.push(M.resolve(r))}catch(e){return Promise.reject(new N([],"All promises were rejected"))}if(0===n)return Promise.reject(new N([],"All promises were rejected"));let r=!1;const s=[];return new M((e,o)=>{for(let i=0;i<t.length;i++)t[i].then(t=>{r||(r=!0,e(t))},e=>{s.push(e),n--,0===n&&(r=!0,o(new N(s,"All promises were rejected")))})})}static race(e){let t,n,r=new this((e,r)=>{t=e,n=r});function s(e){t(e)}function o(e){n(e)}for(let t of e)p(t)||(t=this.resolve(t)),t.then(s,o);return r}static all(e){return M.allWithCallback(e)}static allSettled(e){return(this&&this.prototype instanceof M?this:M).allWithCallback(e,{thenCallback:e=>({status:"fulfilled",value:e}),errorCallback:e=>({status:"rejected",reason:e})})}static allWithCallback(e,t){let n,r,s=new this((e,t)=>{n=e,r=t}),o=2,i=0;const a=[];for(let s of e){p(s)||(s=this.resolve(s));const e=i;try{s.then(r=>{a[e]=t?t.thenCallback(r):r,o--,0===o&&n(a)},s=>{t?(a[e]=t.errorCallback(s),o--,0===o&&n(a)):r(s)})}catch(e){r(e)}o++,i++}return o-=2,0===o&&n(a),s}constructor(e){const t=this;if(!(t instanceof M))throw new Error("Must be an instanceof Promise.");t[m]=w,t[g]=[];try{const n=I();e&&e(n(_(t,C)),n(_(t,S)))}catch(e){k(t,!1,e)}}get[Symbol.toStringTag](){return"Promise"}get[Symbol.species](){return M}then(e,n){let r=this.constructor?.[Symbol.species];r&&"function"==typeof r||(r=this.constructor||M);const s=new r(x),o=t.current;return this[m]==w?this[g].push(o,s,e,n):R(this,o,s,e,n),s}catch(e){return this.then(null,e)}finally(e){let n=this.constructor?.[Symbol.species];n&&"function"==typeof n||(n=M);const r=new n(x);r[y]=y;const s=t.current;return this[m]==w?this[g].push(s,r,e,e):R(this,s,r,e,e),r}}M.resolve=M.resolve,M.reject=M.reject,M.race=M.race,M.all=M.all;const L=e[l]=e.Promise;e.Promise=M;const D=o("thenPatched");function P(e){const t=e.prototype,n=r(t,"then");if(n&&(!1===n.writable||!n.configurable))return;const s=t.then;t[c]=s,e.prototype.then=function(e,t){const n=new M((e,t)=>{s.call(this,e,t)});return n.then(e,t)},e[D]=!0}return n.patchThen=P,L&&(P(L),Ef(e,"fetch",e=>{return t=e,function(e,n){let r=t.apply(e,n);if(r instanceof M)return r;let s=r.constructor;return s[D]||P(s),r};var t})),Promise[t.__symbol__("uncaughtPromiseErrors")]=i,M})}function Qf(e,t,n,r,s){const o=Zone.__symbol__(r);if(t[o])return;const i=t[o]=t[r];t[r]=function(o,a,l){return a&&a.prototype&&s.forEach(function(t){const s=`${n}.${r}::`+t,o=a.prototype;try{if(o.hasOwnProperty(t)){const n=e.ObjectGetOwnPropertyDescriptor(o,t);n&&n.value?(n.value=e.wrapWithCurrentZone(n.value,s),e._redefineProperty(a.prototype,t,n)):o[t]&&(o[t]=e.wrapWithCurrentZone(o[t],s))}else o[t]&&(o[t]=e.wrapWithCurrentZone(o[t],s))}catch{}}),i.call(t,o,a,l)},e.attachOriginToPatched(t[r],i)}const $f=function(){const e=globalThis,t=!0===e[Yd("forceDuplicateZoneCheck")];if(e.Zone&&(t||"function"!=typeof e.Zone.__symbol__))throw new Error("Zone already loaded.");return e.Zone??=function(){const e=Hd.performance;function t(t){e&&e.mark&&e.mark(t)}function n(t,n){e&&e.measure&&e.measure(t,n)}t("Zone");class r{static __symbol__=Yd;static assertZonePatched(){if(Hd.Promise!==E.ZoneAwarePromise)throw new Error("Zone.js has detected that ZoneAwarePromise `(window|global).Promise` has been overwritten.\nMost likely cause is that a Promise polyfill has been loaded after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. If you must load one, do so before loading zone.js.)")}static get root(){let e=r.current;for(;e.parent;)e=e.parent;return e}static get current(){return T.zone}static get currentTask(){return O}static __load_patch(e,s,o=!1){if(E.hasOwnProperty(e)){const t=!0===Hd[Yd("forceDuplicateZoneCheck")];if(!o&&t)throw Error("Already loaded patch: "+e)}else if(!Hd["__Zone_disable_"+e]){const o="Zone:"+e;t(o),E[e]=s(Hd,r,k),n(o,o)}}get parent(){return this._parent}get name(){return this._name}_parent;_name;_properties;_zoneDelegate;constructor(e,t){this._parent=e,this._name=t?t.name||"unnamed":"<root>",this._properties=t&&t.properties||{},this._zoneDelegate=new o(this,this._parent&&this._parent._zoneDelegate,t)}get(e){const t=this.getZoneWith(e);if(t)return t._properties[e]}getZoneWith(e){let t=this;for(;t;){if(t._properties.hasOwnProperty(e))return t;t=t._parent}return null}fork(e){if(!e)throw new Error("ZoneSpec required!");return this._zoneDelegate.fork(this,e)}wrap(e,t){if("function"!=typeof e)throw new Error("Expecting function got: "+e);const n=this._zoneDelegate.intercept(this,e,t),r=this;return function(){return r.runGuarded(n,this,arguments,t)}}run(e,t,n,r){T={parent:T,zone:this};try{return this._zoneDelegate.invoke(this,e,t,n,r)}finally{T=T.parent}}runGuarded(e,t=null,n,r){T={parent:T,zone:this};try{try{return this._zoneDelegate.invoke(this,e,t,n,r)}catch(e){if(this._zoneDelegate.handleError(this,e))throw e}}finally{T=T.parent}}runTask(e,t,n){if(e.zone!=this)throw new Error("A task can only be run in the zone of creation! (Creation: "+(e.zone||g).name+"; Execution: "+this.name+")");const r=e,{type:s,data:{isPeriodic:o=!1,isRefreshable:i=!1}={}}=e;if(e.state===y&&(s===A||s===I))return;const a=e.state!=w;a&&r._transitionTo(w,b);const l=O;O=r,T={parent:T,zone:this};try{s!=I||!e.data||o||i||(e.cancelFn=void 0);try{return this._zoneDelegate.invokeTask(this,r,t,n)}catch(e){if(this._zoneDelegate.handleError(this,e))throw e}}finally{const t=e.state;if(t!==y&&t!==S)if(s==A||o||i&&t===v)a&&r._transitionTo(b,w,v);else{const e=r._zoneDelegates;this._updateTaskCount(r,-1),a&&r._transitionTo(y,w,y),i&&(r._zoneDelegates=e)}T=T.parent,O=l}}scheduleTask(e){if(e.zone&&e.zone!==this){let t=this;for(;t;){if(t===e.zone)throw Error(`can not reschedule task to ${this.name} which is descendants of the original zone ${e.zone.name}`);t=t.parent}}e._transitionTo(v,y);const t=[];e._zoneDelegates=t,e._zone=this;try{e=this._zoneDelegate.scheduleTask(this,e)}catch(t){throw e._transitionTo(S,v,y),this._zoneDelegate.handleError(this,t),t}return e._zoneDelegates===t&&this._updateTaskCount(e,1),e.state==v&&e._transitionTo(b,v),e}scheduleMicroTask(e,t,n,r){return this.scheduleTask(new i(_,e,t,n,r,void 0))}scheduleMacroTask(e,t,n,r,s){return this.scheduleTask(new i(I,e,t,n,r,s))}scheduleEventTask(e,t,n,r,s){return this.scheduleTask(new i(A,e,t,n,r,s))}cancelTask(e){if(e.zone!=this)throw new Error("A task can only be cancelled in the zone of creation! (Creation: "+(e.zone||g).name+"; Execution: "+this.name+")");if(e.state===b||e.state===w){e._transitionTo(C,b,w);try{this._zoneDelegate.cancelTask(this,e)}catch(t){throw e._transitionTo(S,C),this._zoneDelegate.handleError(this,t),t}return this._updateTaskCount(e,-1),e._transitionTo(y,C),e.runCount=-1,e}}_updateTaskCount(e,t){const n=e._zoneDelegates;-1==t&&(e._zoneDelegates=null);for(let r=0;r<n.length;r++)n[r]._updateTaskCount(e.type,t)}}const s={name:"",onHasTask:(e,t,n,r)=>e.hasTask(n,r),onScheduleTask:(e,t,n,r)=>e.scheduleTask(n,r),onInvokeTask:(e,t,n,r,s,o)=>e.invokeTask(n,r,s,o),onCancelTask:(e,t,n,r)=>e.cancelTask(n,r)};class o{get zone(){return this._zone}_zone;_taskCounts={microTask:0,macroTask:0,eventTask:0};_parentDelegate;_forkDlgt;_forkZS;_forkCurrZone;_interceptDlgt;_interceptZS;_interceptCurrZone;_invokeDlgt;_invokeZS;_invokeCurrZone;_handleErrorDlgt;_handleErrorZS;_handleErrorCurrZone;_scheduleTaskDlgt;_scheduleTaskZS;_scheduleTaskCurrZone;_invokeTaskDlgt;_invokeTaskZS;_invokeTaskCurrZone;_cancelTaskDlgt;_cancelTaskZS;_cancelTaskCurrZone;_hasTaskDlgt;_hasTaskDlgtOwner;_hasTaskZS;_hasTaskCurrZone;constructor(e,t,n){this._zone=e,this._parentDelegate=t,this._forkZS=n&&(n&&n.onFork?n:t._forkZS),this._forkDlgt=n&&(n.onFork?t:t._forkDlgt),this._forkCurrZone=n&&(n.onFork?this._zone:t._forkCurrZone),this._interceptZS=n&&(n.onIntercept?n:t._interceptZS),this._interceptDlgt=n&&(n.onIntercept?t:t._interceptDlgt),this._interceptCurrZone=n&&(n.onIntercept?this._zone:t._interceptCurrZone),this._invokeZS=n&&(n.onInvoke?n:t._invokeZS),this._invokeDlgt=n&&(n.onInvoke?t:t._invokeDlgt),this._invokeCurrZone=n&&(n.onInvoke?this._zone:t._invokeCurrZone),this._handleErrorZS=n&&(n.onHandleError?n:t._handleErrorZS),this._handleErrorDlgt=n&&(n.onHandleError?t:t._handleErrorDlgt),this._handleErrorCurrZone=n&&(n.onHandleError?this._zone:t._handleErrorCurrZone),this._scheduleTaskZS=n&&(n.onScheduleTask?n:t._scheduleTaskZS),this._scheduleTaskDlgt=n&&(n.onScheduleTask?t:t._scheduleTaskDlgt),this._scheduleTaskCurrZone=n&&(n.onScheduleTask?this._zone:t._scheduleTaskCurrZone),this._invokeTaskZS=n&&(n.onInvokeTask?n:t._invokeTaskZS),this._invokeTaskDlgt=n&&(n.onInvokeTask?t:t._invokeTaskDlgt),this._invokeTaskCurrZone=n&&(n.onInvokeTask?this._zone:t._invokeTaskCurrZone),this._cancelTaskZS=n&&(n.onCancelTask?n:t._cancelTaskZS),this._cancelTaskDlgt=n&&(n.onCancelTask?t:t._cancelTaskDlgt),this._cancelTaskCurrZone=n&&(n.onCancelTask?this._zone:t._cancelTaskCurrZone),this._hasTaskZS=null,this._hasTaskDlgt=null,this._hasTaskDlgtOwner=null,this._hasTaskCurrZone=null;const r=n&&n.onHasTask,o=t&&t._hasTaskZS;(r||o)&&(this._hasTaskZS=r?n:s,this._hasTaskDlgt=t,this._hasTaskDlgtOwner=this,this._hasTaskCurrZone=this._zone,n.onScheduleTask||(this._scheduleTaskZS=s,this._scheduleTaskDlgt=t,this._scheduleTaskCurrZone=this._zone),n.onInvokeTask||(this._invokeTaskZS=s,this._invokeTaskDlgt=t,this._invokeTaskCurrZone=this._zone),n.onCancelTask||(this._cancelTaskZS=s,this._cancelTaskDlgt=t,this._cancelTaskCurrZone=this._zone))}fork(e,t){return this._forkZS?this._forkZS.onFork(this._forkDlgt,this.zone,e,t):new r(e,t)}intercept(e,t,n){return this._interceptZS?this._interceptZS.onIntercept(this._interceptDlgt,this._interceptCurrZone,e,t,n):t}invoke(e,t,n,r,s){return this._invokeZS?this._invokeZS.onInvoke(this._invokeDlgt,this._invokeCurrZone,e,t,n,r,s):t.apply(n,r)}handleError(e,t){return!this._handleErrorZS||this._handleErrorZS.onHandleError(this._handleErrorDlgt,this._handleErrorCurrZone,e,t)}scheduleTask(e,t){let n=t;if(this._scheduleTaskZS)this._hasTaskZS&&n._zoneDelegates.push(this._hasTaskDlgtOwner),n=this._scheduleTaskZS.onScheduleTask(this._scheduleTaskDlgt,this._scheduleTaskCurrZone,e,t),n||(n=t);else if(t.scheduleFn)t.scheduleFn(t);else{if(t.type!=_)throw new Error("Task is missing scheduleFn.");f(t)}return n}invokeTask(e,t,n,r){return this._invokeTaskZS?this._invokeTaskZS.onInvokeTask(this._invokeTaskDlgt,this._invokeTaskCurrZone,e,t,n,r):t.callback.apply(n,r)}cancelTask(e,t){let n;if(this._cancelTaskZS)n=this._cancelTaskZS.onCancelTask(this._cancelTaskDlgt,this._cancelTaskCurrZone,e,t);else{if(!t.cancelFn)throw Error("Task is not cancelable");n=t.cancelFn(t)}return n}hasTask(e,t){try{this._hasTaskZS&&this._hasTaskZS.onHasTask(this._hasTaskDlgt,this._hasTaskCurrZone,e,t)}catch(t){this.handleError(e,t)}}_updateTaskCount(e,t){const n=this._taskCounts,r=n[e],s=n[e]=r+t;if(s<0)throw new Error("More tasks executed then were scheduled.");if(0==r||0==s){const t={microTask:n.microTask>0,macroTask:n.macroTask>0,eventTask:n.eventTask>0,change:e};this.hasTask(this._zone,t)}}}class i{type;source;invoke;callback;data;scheduleFn;cancelFn;_zone=null;runCount=0;_zoneDelegates=null;_state="notScheduled";constructor(e,t,n,r,s,o){if(this.type=e,this.source=t,this.data=r,this.scheduleFn=s,this.cancelFn=o,!n)throw new Error("callback is not defined");this.callback=n;const a=this;e===A&&r&&r.useG?this.invoke=i.invokeTask:this.invoke=function(){return i.invokeTask.call(Hd,a,this,arguments)}}static invokeTask(e,t,n){e||(e=this),R++;try{return e.runCount++,e.zone.runTask(e,t,n)}finally{1==R&&m(),R--}}get zone(){return this._zone}get state(){return this._state}cancelScheduleRequest(){this._transitionTo(y,v)}_transitionTo(e,t,n){if(this._state!==t&&this._state!==n)throw new Error(`${this.type} '${this.source}': can not transition to '${e}', expecting state '${t}'${n?" or '"+n+"'":""}, was '${this._state}'.`);this._state=e,e==y&&(this._zoneDelegates=null)}toString(){return this.data&&void 0!==this.data.handleId?this.data.handleId.toString():Object.prototype.toString.call(this)}toJSON(){return{type:this.type,state:this.state,source:this.source,zone:this.zone.name,runCount:this.runCount}}}const a=Yd("setTimeout"),l=Yd("Promise"),c=Yd("then");let u,h=[],p=!1;function d(e){if(u||Hd[l]&&(u=Hd[l].resolve(0)),u){let t=u[c];t||(t=u.then),t.call(u,e)}else Hd[a](e,0)}function f(e){0===R&&0===h.length&&d(m),e&&h.push(e)}function m(){if(!p){for(p=!0;h.length;){const e=h;h=[];for(let t=0;t<e.length;t++){const n=e[t];try{n.zone.runTask(n,null,null)}catch(e){k.onUnhandledError(e)}}}k.microtaskDrainDone(),p=!1}}const g={name:"NO ZONE"},y="notScheduled",v="scheduling",b="scheduled",w="running",C="canceling",S="unknown",_="microTask",I="macroTask",A="eventTask",E={},k={symbol:Yd,currentZoneFrame:()=>T,onUnhandledError:x,microtaskDrainDone:x,scheduleMicroTask:f,showUncaughtError:()=>!r[Yd("ignoreConsoleErrorUncaughtError")],patchEventTarget:()=>[],patchOnProperties:x,patchMethod:()=>x,bindArguments:()=>[],patchThen:()=>x,patchMacroTask:()=>x,patchEventPrototype:()=>x,isIEOrEdge:()=>!1,getGlobalObjects:()=>{},ObjectDefineProperty:()=>x,ObjectGetOwnPropertyDescriptor:()=>{},ObjectCreate:()=>{},ArraySlice:()=>[],patchClass:()=>x,wrapWithCurrentZone:()=>x,filterProperties:()=>[],attachOriginToPatched:()=>x,_redefineProperty:()=>x,patchCallbacks:()=>x,nativeScheduleMicroTask:d};let T={parent:null,zone:new r(null,null)},O=null,R=0;function x(){}return n("Zone","Zone"),r}(),e.Zone}();!function(e){qf(e),function(e){e.__load_patch("toString",e=>{const t=Function.prototype.toString,n=cf("OriginalDelegate"),r=cf("Promise"),s=cf("Error"),o=function(){if("function"==typeof this){const o=this[n];if(o)return"function"==typeof o?t.call(o):Object.prototype.toString.call(o);if(this===Promise){const n=e[r];if(n)return t.call(n)}if(this===Error){const n=e[s];if(n)return t.call(n)}}return t.call(this)};o[n]=t,Function.prototype.toString=o;const i=Object.prototype.toString;Object.prototype.toString=function(){return"function"==typeof Promise&&this instanceof Promise?"[object Promise]":i.call(this)}})}(e),function(e){e.__load_patch("util",(e,t,n)=>{const r=Jf(e);n.patchOnProperties=_f,n.patchMethod=Ef,n.bindArguments=df,n.patchMacroTask=kf;const s=t.__symbol__("BLACK_LISTED_EVENTS"),o=t.__symbol__("UNPATCHED_EVENTS");e[o]&&(e[s]=e[o]),e[s]&&(t[s]=t[o]=e[s]),n.patchEventPrototype=zf,n.patchEventTarget=Zf,n.isIEOrEdge=xf,n.ObjectDefineProperty=Jd,n.ObjectGetOwnPropertyDescriptor=Kd,n.ObjectCreate=qd,n.ArraySlice=Qd,n.patchClass=Af,n.wrapWithCurrentZone=af,n.filterProperties=Yf,n.attachOriginToPatched=Tf,n._redefineProperty=Object.defineProperty,n.patchCallbacks=Qf,n.getGlobalObjects=()=>({globalSources:Pf,zoneSymbolEventNames:Df,eventNames:r,isBrowser:yf,isMix:vf,isNode:gf,TRUE_STR:rf,FALSE_STR:sf,ZONE_SYMBOL_PREFIX:of,ADD_EVENT_LISTENER_STR:$d,REMOVE_EVENT_LISTENER_STR:ef})})}(e)}($f),function(e){e.__load_patch("legacy",t=>{const n=t[e.__symbol__("legacyPatch")];n&&n()}),e.__load_patch("timers",e=>{const t="set",n="clear";Wf(e,t,n,"Timeout"),Wf(e,t,n,"Interval"),Wf(e,t,n,"Immediate")}),e.__load_patch("requestAnimationFrame",e=>{Wf(e,"request","cancel","AnimationFrame"),Wf(e,"mozRequest","mozCancel","AnimationFrame"),Wf(e,"webkitRequest","webkitCancel","AnimationFrame")}),e.__load_patch("blocking",(e,t)=>{const n=["alert","prompt","confirm"];for(let r=0;r<n.length;r++){Ef(e,n[r],(n,r,s)=>function(r,o){return t.current.run(n,e,o,s)})}}),e.__load_patch("EventTarget",(e,t,n)=>{!function(e,t){t.patchEventPrototype(e,t)}(e,n),Hf(e,n);const r=e.XMLHttpRequestEventTarget;r&&r.prototype&&n.patchEventTarget(e,n,[r.prototype])}),e.__load_patch("MutationObserver",(e,t,n)=>{Af("MutationObserver"),Af("WebKitMutationObserver")}),e.__load_patch("IntersectionObserver",(e,t,n)=>{Af("IntersectionObserver")}),e.__load_patch("FileReader",(e,t,n)=>{Af("FileReader")}),e.__load_patch("on_property",(e,t,n)=>{Xf(n,e)}),e.__load_patch("customElements",(e,t,n)=>{!function(e,t){const{isBrowser:n,isMix:r}=t.getGlobalObjects();if(!n&&!r||!e.customElements||!("customElements"in e))return;t.patchCallbacks(t,e.customElements,"customElements","define",["connectedCallback","disconnectedCallback","adoptedCallback","attributeChangedCallback","formAssociatedCallback","formDisabledCallback","formResetCallback","formStateRestoreCallback"])}(e,n)}),e.__load_patch("XHR",(e,t)=>{!function(e){const l=e.XMLHttpRequest;if(!l)return;const c=l.prototype;let u=c[tf],h=c[nf];if(!u){const t=e.XMLHttpRequestEventTarget;if(t){const e=t.prototype;u=e[tf],h=e[nf]}}const p="readystatechange",d="scheduled";function f(e){const r=e.data,i=r.target;i[o]=!1,i[a]=!1;const l=i[s];u||(u=i[tf],h=i[nf]),l&&h.call(i,p,l);const c=i[s]=()=>{if(i.readyState===i.DONE)if(!r.aborted&&i[o]&&e.state===d){const n=i[t.__symbol__("loadfalse")];if(0!==i.status&&n&&n.length>0){const s=e.invoke;e.invoke=function(){const n=i[t.__symbol__("loadfalse")];for(let t=0;t<n.length;t++)n[t]===e&&n.splice(t,1);r.aborted||e.state!==d||s.call(e)},n.push(e)}else e.invoke()}else r.aborted||!1!==i[o]||(i[a]=!0)};u.call(i,p,c);return i[n]||(i[n]=e),w.apply(i,r.args),i[o]=!0,e}function m(){}function g(e){const t=e.data;return t.aborted=!0,C.apply(t.target,t.args)}const y=Ef(c,"open",()=>function(e,t){return e[r]=0==t[2],e[i]=t[1],y.apply(e,t)}),v=cf("fetchTaskAborting"),b=cf("fetchTaskScheduling"),w=Ef(c,"send",()=>function(e,n){if(!0===t.current[b])return w.apply(e,n);if(e[r])return w.apply(e,n);{const t={target:e,url:e[i],isPeriodic:!1,args:n,aborted:!1},r=lf("XMLHttpRequest.send",m,t,f,g);e&&!0===e[a]&&!t.aborted&&r.state===d&&r.invoke()}}),C=Ef(c,"abort",()=>function(e,r){const s=e[n];if(s&&"string"==typeof s.type){if(null==s.cancelFn||s.data&&s.data.aborted)return;s.zone.cancelTask(s)}else if(!0===t.current[v])return C.apply(e,r)})}(e);const n=cf("xhrTask"),r=cf("xhrSync"),s=cf("xhrListener"),o=cf("xhrScheduled"),i=cf("xhrURL"),a=cf("xhrErrorBeforeScheduled")}),e.__load_patch("geolocation",e=>{e.navigator&&e.navigator.geolocation&&function(e,t){const n=e.constructor.name;for(let r=0;r<t.length;r++){const s=t[r],o=e[s];if(o){if(!ff(Kd(e,s)))continue;e[s]=(e=>{const t=function(){return e.apply(this,df(arguments,n+"."+s))};return Tf(t,e),t})(o)}}}(e.navigator.geolocation,["getCurrentPosition","watchPosition"])}),e.__load_patch("PromiseRejectionEvent",(e,t)=>{function n(t){return function(n){jf(e,t).forEach(r=>{const s=e.PromiseRejectionEvent;if(s){const e=new s(t,{promise:n.promise,reason:n.rejection});r.invoke(e)}})}}e.PromiseRejectionEvent&&(t[cf("unhandledPromiseRejectionHandler")]=n("unhandledrejection"),t[cf("rejectionHandledHandler")]=n("rejectionhandled"))}),e.__load_patch("queueMicrotask",(e,t,n)=>{Vf(e,n)})}($f);var em;!function(e){e.METHOD_OPEN="open",e.METHOD_SEND="send",e.EVENT_ABORT="abort",e.EVENT_ERROR="error",e.EVENT_LOAD="loaded",e.EVENT_TIMEOUT="timeout"}(em||(em={}));const tm=oh.createComponentLogger({namespace:"@opentelemetry/opentelemetry-instrumentation-xml-http-request/utils"});function nm(e){return t=e,"undefined"!=typeof Document&&t instanceof Document?(new XMLSerializer).serializeToString(document).length:"string"==typeof e?sm(e):e instanceof Blob?e.size:e instanceof FormData?function(e){let t=0;for(const[n,r]of e.entries())t+=n.length,r instanceof Blob?t+=r.size:t+=r.length;return t}(e):e instanceof URLSearchParams?sm(e.toString()):void 0!==e.byteLength?e.byteLength:void tm.warn("unknown body type");var t}const rm=new TextEncoder;function sm(e){return rm.encode(e).byteLength}function om(e){const t=function(){void 0===am&&(am=im);return am}(),n=e.toUpperCase();return n in t?n:"_OTHER"}const im={CONNECT:!0,DELETE:!0,GET:!0,HEAD:!0,OPTIONS:!0,PATCH:!0,POST:!0,PUT:!0,TRACE:!0};let am;const lm={"https:":"443","http:":"80"};const cm="0.203.0";var um;!function(e){e.HTTP_STATUS_TEXT="http.status_text"}(um||(um={}));class hm extends Dd{component="xml-http-request";version=cm;moduleName=this.component;_tasksCount=0;_xhrMem=new WeakMap;_usedResources=new WeakSet;_semconvStability;constructor(e={}){super("@opentelemetry/instrumentation-xml-http-request",cm,e),this._semconvStability=Zd("http",e?.semconvStabilityOptIn)}init(){}_addHeaders(e,t){if(!yd(gd(t).href,this.getConfig().propagateTraceHeaderCorsUrls)){const e={};return vh.inject(sh.active(),e),void(Object.keys(e).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}const n={};vh.inject(sh.active(),n),Object.keys(n).forEach(t=>{e.setRequestHeader(t,String(n[t]))})}_addChildSpan(e,t){sh.with(wh.setSpan(sh.active(),e),()=>{const e=this.tracer.startSpan("CORS Preflight",{startTime:t[id.FETCH_START]}),n=!(this._semconvStability&Bd.OLD);dd(e,t,this.getConfig().ignoreNetworkEvents,void 0,n),e.end(t[id.RESPONSE_END])})}_addFinalSpanAttributes(e,t,n){if(this._semconvStability&Bd.OLD){if(void 0!==t.status&&e.setAttribute("http.status_code",t.status),void 0!==t.statusText&&e.setAttribute(um.HTTP_STATUS_TEXT,t.statusText),"string"==typeof n){const t=gd(n);e.setAttribute("http.host",t.host),e.setAttribute("http.scheme",t.protocol.replace(":",""))}e.setAttribute("http.user_agent",navigator.userAgent)}this._semconvStability&Bd.STABLE&&t.status&&e.setAttribute(Zh,t.status)}_applyAttributesAfterXHR(e,t){const n=this.getConfig().applyCustomAttributesOnSpan;"function"==typeof n&&Pd(()=>n(e,t),e=>{e&&this._diag.error("applyCustomAttributesOnSpan",e)})}_addResourceObserver(e,t){const n=this._xhrMem.get(e);n&&"function"==typeof PerformanceObserver&&"function"==typeof PerformanceResourceTiming&&(n.createdResources={observer:new PerformanceObserver(e=>{const r=e.getEntries(),s=gd(t);r.forEach(e=>{"xmlhttprequest"===e.initiatorType&&e.name===s.href&&n.createdResources&&n.createdResources.entries.push(e)})}),entries:[]},n.createdResources.observer.observe({entryTypes:["resource"]}))}_clearResources(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(Mh.clearResourceTimings(),this._xhrMem=new WeakMap,this._usedResources=new WeakSet)}_findResourceAndAddNetworkEvents(e,t,n,r,s){if(!(n&&r&&s&&e.createdResources))return;let o=e.createdResources.entries;o&&o.length||(o=Mh.getEntriesByType("resource"));const i=md(gd(n).href,r,s,o,this._usedResources);if(i.mainRequest){const e=i.mainRequest;this._markResourceAsUsed(e);const n=i.corsPreFlightRequest;n&&(this._addChildSpan(t,n),this._markResourceAsUsed(n));const r=!(this._semconvStability&Bd.OLD);dd(t,e,this.getConfig().ignoreNetworkEvents,void 0,r)}}_cleanPreviousSpanInformation(e){const t=this._xhrMem.get(e);if(t){const n=t.callbackToRemoveEvents;n&&n(),this._xhrMem.delete(e)}}_createSpan(e,t,n){if(Dp(t,this.getConfig().ignoreUrls))return void this._diag.debug("ignoring span as url matches ignored url");let r="";const s=gd(t),o={};if(this._semconvStability&Bd.OLD&&(r=n.toUpperCase(),o["http.method"]=n,o["http.url"]=s.toString()),this._semconvStability&Bd.STABLE){const e=n,t=om(n);r||(r=t),o[Bh]=t,t!==e&&(o[Uh]=e),o[Yh]=s.toString(),o[jh]=s.hostname;const i=function(e){const t=Number(e.port||lm[e.protocol]);return t&&!isNaN(t)?t:void 0}(s);i&&(o[zh]=i)}const i=this.tracer.startSpan(r,{kind:Qu.CLIENT,attributes:o});return i.addEvent(em.METHOD_OPEN),this._cleanPreviousSpanInformation(e),this._xhrMem.set(e,{span:i,spanUrl:t}),i}_markResourceAsUsed(e){this._usedResources.add(e)}_patchOpen(){return e=>{const t=this;return function(...n){const r=n[0],s=n[1];return t._createSpan(this,s,r),e.apply(this,n)}}}_patchSend(){const e=this;function t(t,n,r,s){const o=e._xhrMem.get(n);if(!o)return;if(o.status=n.status,o.statusText=n.statusText,e._xhrMem.delete(n),o.span){const t=o.span;e._applyAttributesAfterXHR(t,n),e._semconvStability&Bd.STABLE&&(r?s&&(t.setStatus({code:$u.ERROR,message:s}),t.setAttribute(Dh,s)):o.status&&o.status>=400&&(t.setStatus({code:$u.ERROR}),t.setAttribute(Dh,String(o.status))))}const i=ep(),a=Date.now();setTimeout(()=>{!function(t,n,r,s){const o=n.callbackToRemoveEvents;"function"==typeof o&&o();const{span:i,spanUrl:a,sendStartTime:l}=n;i&&(e._findResourceAndAddNetworkEvents(n,i,a,l,r),i.addEvent(t,s),e._addFinalSpanAttributes(i,n,a),i.end(s),e._tasksCount--),e._clearResources()}(t,o,i,a)},300)}function n(){t(em.EVENT_ERROR,this,!0,"error")}function r(){t(em.EVENT_ABORT,this,!1)}function s(){t(em.EVENT_TIMEOUT,this,!0,"timeout")}function o(){this.status<299?t(em.EVENT_LOAD,this,!1):t(em.EVENT_ERROR,this,!1)}return t=>function(...i){const a=e._xhrMem.get(this);if(!a)return t.apply(this,i);const l=a.span,c=a.spanUrl;if(l&&c){if(e.getConfig().measureRequestSize&&i?.[0]){const t=nm(i[0]);void 0!==t&&(e._semconvStability&Bd.OLD&&l.setAttribute("http.request_content_length_uncompressed",t),e._semconvStability&Bd.STABLE&&l.setAttribute("http.request.body.size",t))}sh.with(wh.setSpan(sh.active(),l),()=>{e._tasksCount++,a.sendStartTime=ep(),l.addEvent(em.METHOD_SEND),this.addEventListener("abort",r),this.addEventListener("error",n),this.addEventListener("load",o),this.addEventListener("timeout",s),a.callbackToRemoveEvents=()=>{!function(t){t.removeEventListener("abort",r),t.removeEventListener("error",n),t.removeEventListener("load",o),t.removeEventListener("timeout",s);const i=e._xhrMem.get(t);i&&(i.callbackToRemoveEvents=void 0)}(this),a.createdResources&&a.createdResources.observer.disconnect()},e._addHeaders(this,c),e._addResourceObserver(this,c)})}return t.apply(this,i)}}enable(){this._diag.debug("applying patch to",this.moduleName,this.version),Fd(XMLHttpRequest.prototype.open)&&(this._unwrap(XMLHttpRequest.prototype,"open"),this._diag.debug("removing previous patch from method open")),Fd(XMLHttpRequest.prototype.send)&&(this._unwrap(XMLHttpRequest.prototype,"send"),this._diag.debug("removing previous patch from method send")),this._wrap(XMLHttpRequest.prototype,"open",this._patchOpen()),this._wrap(XMLHttpRequest.prototype,"send",this._patchSend())}disable(){this._diag.debug("removing patch from",this.moduleName,this.version),this._unwrap(XMLHttpRequest.prototype,"open"),this._unwrap(XMLHttpRequest.prototype,"send"),this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet}}var pm;!function(e){e.COMPONENT="component",e.HTTP_STATUS_TEXT="http.status_text"}(pm||(pm={}));var dm={};Object.defineProperty(dm,"__esModule",{value:!0});var fm=dm.ATTR_HTTP_USER_AGENT=dm.ATTR_HTTP_URL=dm.ATTR_HTTP_STATUS_CODE=dm.ATTR_HTTP_SCHEME=dm.ATTR_HTTP_RESPONSE_CONTENT_LENGTH=dm.ATTR_HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED=dm.ATTR_HTTP_REQUEST_BODY_SIZE=dm.ATTR_HTTP_METHOD=dm.ATTR_HTTP_HOST=void 0,mm=dm.ATTR_HTTP_HOST="http.host",gm=dm.ATTR_HTTP_METHOD="http.method",ym=dm.ATTR_HTTP_REQUEST_BODY_SIZE="http.request.body.size",vm=dm.ATTR_HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED="http.request_content_length_uncompressed";dm.ATTR_HTTP_RESPONSE_CONTENT_LENGTH="http.response_content_length";var bm=dm.ATTR_HTTP_SCHEME="http.scheme",wm=dm.ATTR_HTTP_STATUS_CODE="http.status_code",Cm=dm.ATTR_HTTP_URL="http.url";fm=dm.ATTR_HTTP_USER_AGENT="http.user_agent";const Sm=oh.createComponentLogger({namespace:"@opentelemetry/opentelemetry-instrumentation-fetch/utils"});function _m(...e){if(e[0]instanceof URL||"string"==typeof e[0]){const t=e[1];if(!t?.body)return Promise.resolve();if(t.body instanceof ReadableStream){const{body:e,length:n}=function(e){if(!e.pipeThrough)return Sm.warn("Platform has ReadableStream but not pipeThrough!"),{body:e,length:Promise.resolve(void 0)};let t,n=0;const r=new Promise(e=>{t=e}),s=new TransformStream({start(){},async transform(e,t){const r=await e;n+=r.byteLength,t.enqueue(e)},flush(){t(n)}});return{body:e.pipeThrough(s),length:r}}(t.body);return t.body=e,n}return Promise.resolve(function(e){if(t=e,"undefined"!=typeof Document&&t instanceof Document)return(new XMLSerializer).serializeToString(document).length;var t;if("string"==typeof e)return Am(e);if(e instanceof Blob)return e.size;if(e instanceof FormData)return function(e){let t=0;for(const[n,r]of e.entries())t+=n.length,r instanceof Blob?t+=r.size:t+=r.length;return t}(e);if(e instanceof URLSearchParams)return Am(e.toString());if(void 0!==e.byteLength)return e.byteLength;return void Sm.warn("unknown body type")}(t.body))}{const t=e[0];return t?.body?t.clone().text().then(e=>Am(e)):Promise.resolve()}}const Im=new TextEncoder;function Am(e){return Im.encode(e).byteLength}const Em={CONNECT:!0,DELETE:!0,GET:!0,HEAD:!0,OPTIONS:!0,PATCH:!0,POST:!0,PUT:!0,TRACE:!0};let km;function Tm(){return void 0===km&&(km=Em),km}const Om={"https:":"443","http:":"80"};const Rm="0.203.0",xm="object"==typeof process&&"node"===process.release?.name;class Nm extends Dd{component="fetch";version=Rm;moduleName=this.component;_usedResources=new WeakSet;_tasksCount=0;_semconvStability;constructor(e={}){super("@opentelemetry/instrumentation-fetch",Rm,e),this._semconvStability=Zd("http",e?.semconvStabilityOptIn)}init(){}_addChildSpan(e,t){const n=this.tracer.startSpan("CORS Preflight",{startTime:t[id.FETCH_START]},wh.setSpan(sh.active(),e)),r=!(this._semconvStability&Bd.OLD);dd(n,t,this.getConfig().ignoreNetworkEvents,void 0,r),n.end(t[id.RESPONSE_END])}_addFinalSpanAttributes(e,t){const n=gd(t.url);if(this._semconvStability&Bd.OLD&&(e.setAttribute(wm,t.status),null!=t.statusText&&e.setAttribute(pm.HTTP_STATUS_TEXT,t.statusText),e.setAttribute(mm,n.host),e.setAttribute(bm,n.protocol.replace(":","")),"undefined"!=typeof navigator&&e.setAttribute(fm,navigator.userAgent)),this._semconvStability&Bd.STABLE){e.setAttribute(Zh,t.status),e.setAttribute(jh,n.hostname);const r=function(e){const t=Number(e.port||Om[e.protocol]);return t&&!isNaN(t)?t:void 0}(n);r&&e.setAttribute(zh,r)}}_addHeaders(e,t){if(!yd(t,this.getConfig().propagateTraceHeaderCorsUrls)){const e={};return vh.inject(sh.active(),e),void(Object.keys(e).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}if(e instanceof Request)vh.inject(sh.active(),e.headers,{set:(e,t,n)=>e.set(t,"string"==typeof n?n:String(n))});else if(e.headers instanceof Headers)vh.inject(sh.active(),e.headers,{set:(e,t,n)=>e.set(t,"string"==typeof n?n:String(n))});else if(e.headers instanceof Map)vh.inject(sh.active(),e.headers,{set:(e,t,n)=>e.set(t,"string"==typeof n?n:String(n))});else{const t={};vh.inject(sh.active(),t),e.headers=Object.assign({},t,e.headers||{})}}_clearResources(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(performance.clearResourceTimings(),this._usedResources=new WeakSet)}_createSpan(e,t={}){if(Dp(e,this.getConfig().ignoreUrls))return void this._diag.debug("ignoring span as url matches ignored url");let n="";const r={};if(this._semconvStability&Bd.OLD){const s=(t.method||"GET").toUpperCase();n=`HTTP ${s}`,r[pm.COMPONENT]=this.moduleName,r[gm]=s,r[Cm]=e}if(this._semconvStability&Bd.STABLE){const s=t.method,o=function(e){const t=Tm(),n=e.toUpperCase();return n in t?n:"_OTHER"}(t.method||"GET");n||(n=o),r[Bh]=o,o!==s&&(r[Uh]=s),r[Yh]=e}return this.tracer.startSpan(n,{kind:Qu.CLIENT,attributes:r})}_findResourceAndAddNetworkEvents(e,t,n){let r=t.entries;if(!r.length){if(!performance.getEntriesByType)return;r=performance.getEntriesByType("resource")}const s=md(t.spanUrl,t.startTime,n,r,this._usedResources,"fetch");if(s.mainRequest){const t=s.mainRequest;this._markResourceAsUsed(t);const n=s.corsPreFlightRequest;n&&(this._addChildSpan(e,n),this._markResourceAsUsed(n));const r=!(this._semconvStability&Bd.OLD);dd(e,t,this.getConfig().ignoreNetworkEvents,void 0,r)}}_markResourceAsUsed(e){this._usedResources.add(e)}_endSpan(e,t,n){const r=Qh(Date.now()),s=ep();this._addFinalSpanAttributes(e,n),this._semconvStability&Bd.STABLE&&n.status>=400&&(e.setStatus({code:$u.ERROR}),e.setAttribute(Dh,String(n.status))),setTimeout(()=>{t.observer?.disconnect(),this._findResourceAndAddNetworkEvents(e,t,s),this._tasksCount--,this._clearResources(),e.end(r)},300)}_patchConstructor(){return e=>{const t=this;return function(...n){const r=this,s=gd(n[0]instanceof Request?n[0].url:String(n[0])).href,o=n[0]instanceof Request?n[0]:n[1]||{},i=t._createSpan(s,o);if(!i)return e.apply(this,n);const a=t._prepareSpanData(s);function l(e,n){t._applyAttributesAfterFetch(e,o,n),t._endSpan(e,a,{status:n.status||0,statusText:n.message,url:s})}function c(e,n){t._applyAttributesAfterFetch(e,o,n),n.status>=200&&n.status<400?t._endSpan(e,a,n):t._endSpan(e,a,{status:n.status,statusText:n.statusText,url:s})}function u(e,t,n){try{const t=n.clone().body;if(t){const r=t.getReader(),s=()=>{r.read().then(({done:t})=>{t?c(e,n):s()},t=>{l(e,t)})};s()}else c(e,n)}finally{t(n)}}function h(e,t,n){try{l(e,n)}finally{t(n)}}return t.getConfig().measureRequestSize&&_m(...n).then(e=>{e&&(t._semconvStability&Bd.OLD&&i.setAttribute(vm,e),t._semconvStability&Bd.STABLE&&i.setAttribute(ym,e))}).catch(e=>{t._diag.warn("getFetchBodyLength",e)}),new Promise((n,a)=>sh.with(wh.setSpan(sh.active(),i),()=>(t._addHeaders(o,s),t._callRequestHook(i,o),t._tasksCount++,e.apply(r,o instanceof Request?[o]:[s,o]).then(u.bind(r,i,n),h.bind(r,i,a)))))}}}_applyAttributesAfterFetch(e,t,n){const r=this.getConfig().applyCustomAttributesOnSpan;r&&Pd(()=>r(e,t,n),e=>{e&&this._diag.error("applyCustomAttributesOnSpan",e)})}_callRequestHook(e,t){const n=this.getConfig().requestHook;n&&Pd(()=>n(e,t),e=>{e&&this._diag.error("requestHook",e)})}_prepareSpanData(e){const t=ep(),n=[];if("function"!=typeof PerformanceObserver)return{entries:n,startTime:t,spanUrl:e};const r=new PerformanceObserver(t=>{t.getEntries().forEach(t=>{"fetch"===t.initiatorType&&t.name===e&&n.push(t)})});return r.observe({entryTypes:["resource"]}),{entries:n,observer:r,startTime:t,spanUrl:e}}enable(){xm?this._diag.warn("this instrumentation is intended for web usage only, it does not instrument Node.js's fetch()"):(Fd(fetch)&&(this._unwrap(Nh,"fetch"),this._diag.debug("removing previous patch for constructor")),this._wrap(Nh,"fetch",this._patchConstructor()))}disable(){xm||(this._unwrap(Nh,"fetch"),this._usedResources=new WeakSet)}}class Mm{_delegate;constructor(e){this._delegate=e}export(e,t){this._delegate.export(e,t)}forceFlush(){return this._delegate.forceFlush()}shutdown(){return this._delegate.shutdown()}}class Lm extends Error{code;name="OTLPExporterError";data;constructor(e,t,n){super(e),this.data=n,this.code=t}}function Dm(e){if(Number.isFinite(e)&&e>0)return e;throw new Error(`Configuration: timeoutMillis is invalid, expected number greater than 0 (actual: '${e}')`)}function Pm(e){if(null!=e)return()=>e}function Fm(e,t,n){return{timeoutMillis:Dm(e.timeoutMillis??t.timeoutMillis??n.timeoutMillis),concurrencyLimit:e.concurrencyLimit??t.concurrencyLimit??n.concurrencyLimit,compression:e.compression??t.compression??n.compression}}class Bm{_concurrencyLimit;_sendingPromises=[];constructor(e){this._concurrencyLimit=e}pushPromise(e){if(this.hasReachedLimit())throw new Error("Concurrency Limit reached");this._sendingPromises.push(e);const t=()=>{const t=this._sendingPromises.indexOf(e);this._sendingPromises.splice(t,1)};e.then(t,t)}hasReachedLimit(){return this._sendingPromises.length>=this._concurrencyLimit}async awaitAll(){await Promise.all(this._sendingPromises)}}function Um(e){return new Bm(e.concurrencyLimit)}function Zm(){return{handleResponse(e){null!=e&&function(e){return Object.prototype.hasOwnProperty.call(e,"partialSuccess")}(e)&&null!=e.partialSuccess&&0!==Object.keys(e.partialSuccess).length&&oh.warn("Received Partial Success response:",JSON.stringify(e.partialSuccess))}}}class jm{_transport;_serializer;_responseHandler;_promiseQueue;_timeout;_diagLogger;constructor(e,t,n,r,s){this._transport=e,this._serializer=t,this._responseHandler=n,this._promiseQueue=r,this._timeout=s,this._diagLogger=oh.createComponentLogger({namespace:"OTLPExportDelegate"})}export(e,t){if(this._diagLogger.debug("items to be sent",e),this._promiseQueue.hasReachedLimit())return void t({code:ip.FAILED,error:new Error("Concurrent export limit reached")});const n=this._serializer.serializeRequest(e);null!=n?this._promiseQueue.pushPromise(this._transport.send(n,this._timeout).then(e=>{if("success"!==e.status)"failure"===e.status&&e.error?t({code:ip.FAILED,error:e.error}):"retryable"===e.status?t({code:ip.FAILED,error:new Lm("Export failed with retryable status")}):t({code:ip.FAILED,error:new Lm("Export failed with unknown error")});else{if(null!=e.data)try{this._responseHandler.handleResponse(this._serializer.deserializeResponse(e.data))}catch(t){this._diagLogger.warn("Export succeeded but could not deserialize response - is the response specification compliant?",t,e.data)}t({code:ip.SUCCESS})}},e=>t({code:ip.FAILED,error:e}))):t({code:ip.FAILED,error:new Error("Nothing to send")})}forceFlush(){return this._promiseQueue.awaitAll()}async shutdown(){this._diagLogger.debug("shutdown started"),await this.forceFlush(),this._transport.shutdown()}}function zm(e,t,n){return r={transport:n,serializer:t,promiseHandler:Um(e)},s={timeout:e.timeoutMillis},new jm(r.transport,r.serializer,Zm(),r.promiseHandler,s.timeout);var r,s}function Vm(e){return e>=48&&e<=57?e-48:e>=97&&e<=102?e-87:e-55}function Gm(e){const t=new Uint8Array(e.length/2);let n=0;for(let r=0;r<e.length;r+=2){const s=Vm(e.charCodeAt(r)),o=Vm(e.charCodeAt(r+1));t[n++]=s<<4|o}return t}function Wm(e){const t=BigInt(1e9);return BigInt(e[0])*t+BigInt(e[1])}const Hm="undefined"!=typeof BigInt?function(e){return Wm(e).toString()}:np;function Ym(e){return e}const Km={encodeHrTime:function(e){const t=Wm(e);return n=t,{low:Number(BigInt.asUintN(32,n)),high:Number(BigInt.asUintN(32,n>>BigInt(32)))};var n},encodeSpanContext:Gm,encodeOptionalSpanContext:function(e){if(void 0!==e)return Gm(e)}};function Jm(e){return{attributes:qm(e.attributes),droppedAttributesCount:0}}function Xm(e){return{name:e.name,version:e.version}}function qm(e){return Object.keys(e).map(t=>Qm(t,e[t]))}function Qm(e,t){return{key:e,value:$m(t)}}function $m(e){const t=typeof e;return"string"===t?{stringValue:e}:"number"===t?Number.isInteger(e)?{intValue:e}:{doubleValue:e}:"boolean"===t?{boolValue:e}:e instanceof Uint8Array?{bytesValue:e}:Array.isArray(e)?{arrayValue:{values:e.map($m)}}:"object"===t&&null!=e?{kvlistValue:{values:Object.entries(e).map(([e,t])=>Qm(e,t))}}:{}}function eg(e,t){const n=e.spanContext(),r=e.status,s=e.parentSpanContext?.spanId?t.encodeSpanContext(e.parentSpanContext?.spanId):void 0;return{traceId:t.encodeSpanContext(n.traceId),spanId:t.encodeSpanContext(n.spanId),parentSpanId:s,traceState:n.traceState?.serialize(),name:e.name,kind:null==e.kind?0:e.kind+1,startTimeUnixNano:t.encodeHrTime(e.startTime),endTimeUnixNano:t.encodeHrTime(e.endTime),attributes:qm(e.attributes),droppedAttributesCount:e.droppedAttributesCount,events:e.events.map(e=>function(e,t){return{attributes:e.attributes?qm(e.attributes):[],name:e.name,timeUnixNano:t.encodeHrTime(e.time),droppedAttributesCount:e.droppedAttributesCount||0}}(e,t)),droppedEventsCount:e.droppedEventsCount,status:{code:r.code,message:r.message},links:e.links.map(e=>function(e,t){return{attributes:e.attributes?qm(e.attributes):[],spanId:t.encodeSpanContext(e.context.spanId),traceId:t.encodeSpanContext(e.context.traceId),traceState:e.context.traceState?.serialize(),droppedAttributesCount:e.droppedAttributesCount||0}}(e,t)),droppedLinksCount:e.droppedLinksCount}}function tg(e,t){const n=function(e){return void 0===e?Km:{encodeHrTime:Hm,encodeSpanContext:Ym,encodeOptionalSpanContext:Ym}}(t);return{resourceSpans:ng(e,n)}}function ng(e,t){const n=function(e){const t=new Map;for(const n of e){let e=t.get(n.resource);e||(e=new Map,t.set(n.resource,e));const r=`${n.instrumentationScope.name}@${n.instrumentationScope.version||""}:${n.instrumentationScope.schemaUrl||""}`;let s=e.get(r);s||(s=[],e.set(r,s)),s.push(n)}return t}(e),r=[],s=n.entries();let o=s.next();for(;!o.done;){const[e,n]=o.value,i=[],a=n.values();let l=a.next();for(;!l.done;){const e=l.value;if(e.length>0){const n=e.map(e=>eg(e,t));i.push({scope:Xm(e[0].instrumentationScope),spans:n,schemaUrl:e[0].instrumentationScope.schemaUrl})}l=a.next()}const c={resource:Jm(e),scopeSpans:i,schemaUrl:void 0};r.push(c),o=s.next()}return r}const rg={serializeRequest:e=>{const t=tg(e,{});return(new TextEncoder).encode(JSON.stringify(t))},deserializeResponse:e=>{if(0===e.length)return{};const t=new TextDecoder;return JSON.parse(t.decode(e))}};function sg(){return.4*Math.random()-.2}class og{_transport;constructor(e){this._transport=e}retry(e,t,n){return new Promise((r,s)=>{setTimeout(()=>{this._transport.send(e,t).then(r,s)},n)})}async send(e,t){const n=Date.now()+t;let r=await this._transport.send(e,t),s=5,o=1e3;for(;"retryable"===r.status&&s>0;){s--;const t=Math.max(Math.min(o,5e3)+sg(),0);o*=1.5;const i=r.retryInMillis??t,a=n-Date.now();if(i>a)return r;r=await this.retry(e,a,i)}return r}shutdown(){return this._transport.shutdown()}}function ig(e){return new og(e.transport)}function ag(e){if(null==e)return;const t=Number.parseInt(e,10);if(Number.isInteger(t))return t>0?1e3*t:-1;const n=new Date(e).getTime()-Date.now();return n>=0?n:0}class lg{_parameters;constructor(e){this._parameters=e}send(e,t){return new Promise(n=>{const r=new XMLHttpRequest;r.timeout=t,r.open("POST",this._parameters.url);const s=this._parameters.headers();Object.entries(s).forEach(([e,t])=>{r.setRequestHeader(e,t)}),r.ontimeout=e=>{n({status:"failure",error:new Error("XHR request timed out")})},r.onreadystatechange=()=>{var e;r.status>=200&&r.status<=299?(oh.debug("XHR success"),n({status:"success"})):r.status&&(e=r.status,[429,502,503,504].includes(e))?n({status:"retryable",retryInMillis:ag(r.getResponseHeader("Retry-After"))}):0!==r.status&&n({status:"failure",error:new Error("XHR request failed with non-retryable status")})},r.onabort=()=>{n({status:"failure",error:new Error("XHR request aborted")})},r.onerror=()=>{n({status:"failure",error:new Error("XHR request errored")})},r.send(e)})}shutdown(){}}class cg{_params;constructor(e){this._params=e}send(e){return new Promise(t=>{navigator.sendBeacon(this._params.url,new Blob([e],{type:this._params.blobType}))?(oh.debug("SendBeacon success"),t({status:"success"})):t({status:"failure",error:new Error("SendBeacon failed")})})}shutdown(){}}function ug(e,t,n){const r={...n()},s={};return()=>(null!=t&&Object.assign(s,t()),null!=e&&Object.assign(s,e()),Object.assign(s,r))}function hg(e){if(null!=e)try{return new URL(e),e}catch{throw new Error(`Configuration: Could not parse user-provided export URL: '${e}'`)}}function pg(e,t,n){return r={url:e.url,timeoutMillis:e.timeoutMillis,headers:Pm(e.headers),concurrencyLimit:e.concurrencyLimit},s={},o=function(e,t){return{timeoutMillis:1e4,concurrencyLimit:30,compression:"none",headers:()=>e,url:"http://localhost:4318/"+t,agentOptions:{keepAlive:!0}}}(n,t),{...Fm(r,s,o),headers:ug((i=r.headers,()=>{const e={};return Object.entries(i?.()??{}).forEach(([t,n])=>{void 0!==n?e[t]=String(n):oh.warn(`Header "${t}" has invalid value (${n}) and will be ignored`)}),e}),s.headers,o.headers),url:hg(r.url)??s.url??o.url,agentOptions:r.agentOptions??s.agentOptions??o.agentOptions};var r,s,o,i}function dg(e,t,n,r){const s=!!e.headers||"function"!=typeof navigator.sendBeacon,o=pg(e,n,r);return s?function(e,t){return zm(e,t,ig({transport:(n=e,new lg(n))}));var n}(o,t):function(e,t){return zm(e,t,ig({transport:(n={url:e.url,blobType:e.headers()["Content-Type"]},new cg(n))}));var n}(o,t)}class fg extends Mm{constructor(e={}){super(dg(e,rg,"v1/traces",{"Content-Type":"application/json"}))}}class mg{constructor(e,t){this.config=e,this.sessionId=t,this.provider=this.createProvider()}createProvider(){const{serviceName:e,resourceAttributes:t,exporterEndpoint:n,projectId:r}=this.config,s=Zp({[Vh]:e,"at-project-id":r,...t||{}}),o=new fg({url:n||"https://otelcol.apitoolkit.io/v1/traces",headers:{}});return new cd({resource:s,spanProcessors:[new $p(o)]})}configure(){this.provider.register({contextManager:new Wd,propagator:new gp});const e=this.config.propagateTraceHeaderCorsUrls||[/^https?:\/\/.*/],t=[/^https?:\/\/(?:[^\/]+\.)?apitoolkit\.io\//,/^https?:\/\/(?:[^\/]+\.)?monoscope\.tech\//];!function(e){const t=e.tracerProvider||wh.getTracerProvider(),n=e.meterProvider||lh.getMeterProvider(),r=e.loggerProvider||kd.getLoggerProvider(),s=e.instrumentations?.flat()??[];(function(e,t,n,r){for(let s=0,o=e.length;s<o;s++){const o=e[s];t&&o.setTracerProvider(t),n&&o.setMeterProvider(n),r&&o.setLoggerProvider&&o.setLoggerProvider(r),o.getConfig().enabled||o.enable()}})(s,t,n,r)}({tracerProvider:this.provider,instrumentations:[...this.config.instrumentations||[],new Vd({ignoreNetworkEvents:!this.config.enableNetworkEvents,applyCustomAttributesOnSpan:{documentLoad:e=>{e.setAttribute("session.id",this.sessionId),this.setUserAttributes(e)}}}),new hm({propagateTraceHeaderCorsUrls:e,ignoreUrls:t,applyCustomAttributesOnSpan:e=>{e.setAttribute("session.id",this.sessionId),this.setUserAttributes(e)}}),new Nm({propagateTraceHeaderCorsUrls:e,ignoreUrls:t,applyCustomAttributesOnSpan:e=>{e.setAttribute("session.id",this.sessionId),this.setUserAttributes(e)}})]})}setUserAttributes(e){if(this.config.user)for(let t in this.config.user)e.setAttribute(`user.${t}`,this.config.user[t])}async shutdown(){await this.provider.shutdown()}setUser(e){this.config={...this.config,user:{...this.config.user,...e}}}}const gg=[];for(let e=0;e<256;++e)gg.push((e+256).toString(16).slice(1));let yg;const vg=new Uint8Array(16);var bg={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function wg(e,t,n){if(bg.randomUUID&&!e)return bg.randomUUID();const r=(e=e||{}).random??e.rng?.()??function(){if(!yg){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");yg=crypto.getRandomValues.bind(crypto)}return yg(vg)}();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=15&r[6]|64,r[8]=63&r[8]|128,function(e,t=0){return(gg[e[t+0]]+gg[e[t+1]]+gg[e[t+2]]+gg[e[t+3]]+"-"+gg[e[t+4]]+gg[e[t+5]]+"-"+gg[e[t+6]]+gg[e[t+7]]+"-"+gg[e[t+8]]+gg[e[t+9]]+"-"+gg[e[t+10]]+gg[e[t+11]]+gg[e[t+12]]+gg[e[t+13]]+gg[e[t+14]]+gg[e[t+15]]).toLowerCase()}(r)}return class{constructor(e){if(!e.projectId)throw new Error("MonoscopeConfig must include projectId");const t=sessionStorage.getItem("monoscope-session-id");t?this.sessionId=t:(this.sessionId=wg(),sessionStorage.setItem("monoscope-session-id",this.sessionId)),this.config=e,this.replay=new Tc(e,this.sessionId),this.otel=new mg(e,this.sessionId),this.otel.configure(),this.replay.configure()}getSessionId(){return this.sessionId}setUser(e){this.otel.setUser(e)}}}();
//# sourceMappingURL=monoscope.min.js.map
